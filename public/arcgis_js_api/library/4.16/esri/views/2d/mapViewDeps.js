// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/LabelManager":function(){define("require exports tslib ../../core/Accessor ../../core/Error ../../core/HandleOwner ../../core/Logger ../../core/throttle ../../core/accessorSupport/decorators ./engine".split(" "),function(v,a,h,p,m,r,f,l,d,k){Object.defineProperty(a,"__esModule",{value:!0});var t=f.getLogger("esri.views.2d.layers.labels.LabelManager");v=function(a){function f(b){b=a.call(this,b)||this;b._applyVisibilityPassThrottled=l.throttle(b._applyVisibilityPass,
64,b);b.lastUpdateId=-1;b.updateRequested=!1;b.view=null;return b}h.__extends(f,a);f.prototype.initialize=function(){var b=this;this.collisionEngine=new k.CollisionEngine(this.view.featuresTilingScheme);this._layerViewSorter=new k.LayerViewSorter(function(a,c){b.collisionEngine.registerLayerView(a,c);(c=a.tileRenderer)&&c.forEachTile(function(c){c.isDirty=!0;b.addTile(a,c)});b.requestUpdate()},function(a){b.collisionEngine.unregisterLayerView(a);b.requestUpdate()});this.handles.add(this.view.allLayerViews.on("change",
function(a){b._layerViewSorter.update(a)}))};f.prototype.destroy=function(){this._layerViewSorter.destroy();this.collisionEngine=this._layerViewSorter=null;this._applyVisibilityPassThrottled.remove()};Object.defineProperty(f.prototype,"updating",{get:function(){return this.updateRequested},enumerable:!0,configurable:!0});f.prototype.update=function(b){this._applyVisibilityPassThrottled(b)};f.prototype.viewChange=function(){this.requestUpdate()};f.prototype.requestUpdate=function(){this.updateRequested||
(this.updateRequested=!0,this.view.requestUpdate())};f.prototype.processUpdate=function(b){this._set("updateParameters",b);this.updateRequested&&(this.updateRequested=!1,this.update(b))};f.prototype.addTile=function(b,a){this.collisionEngine.addTile(b,a)};f.prototype.removeTile=function(b,a){this.collisionEngine.removeTile(b,a)};f.prototype._applyVisibilityPass=function(b){try{var a=this.view.featuresTilingScheme.getClosestInfoForScale(b.state.scale).level;this.collisionEngine.run(b,a)}catch(c){t.error(new m("mapview-labeling",
"Encountered an error during label decluttering",c))}};h.__decorate([d.property()],f.prototype,"updateRequested",void 0);h.__decorate([d.property({readOnly:!0})],f.prototype,"updateParameters",void 0);h.__decorate([d.property({dependsOn:["updateRequested"]})],f.prototype,"updating",null);h.__decorate([d.property()],f.prototype,"view",void 0);return f=h.__decorate([d.subclass("esri.views.2d.layers.labels.LabelManager")],f)}(r.HandleOwnerMixin(p));a.default=v})},"esri/views/2d/layers/graphics/GraphicsView2D":function(){define("require exports tslib ../../../../core/Accessor ../../../../core/HandleOwner ../../../../core/Identifiable ../../../../core/MapPool ../../../../core/MapUtils ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../core/accessorSupport/decorators ../../../../geometry/Polygon ../../../../geometry/SpatialReference ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/coordsUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/spatialReferenceUtils ../../../../layers/graphics/data/projectionSupport ../../../../symbols/cim/cimSymbolUtils ../../../../symbols/support/defaults ../../engine ../../engine/webgl/definitions ../features/support/AttributeStore ../features/support/TileStore ./GraphicContainer ./GraphicProcessingQueue ./GraphicStore ./graphicsUtils ../../../layers/GraphicsView".split(" "),
function(v,a,h,p,m,r,f,l,d,k,t,w,u,b,g,c,y,e,n,z,x,C,A,I,F,J,H,G,D,E,q){function K(b,e,a){if(a.has(b))return a.get(b);e={tile:e,addedOrModified:[],removed:[]};a.set(b,e);return e}Object.defineProperty(a,"__esModule",{value:!0});v=function(a){function q(b){b=a.call(this,b)||this;b._tiles=new Map;b._graphicStoreUpdate=!1;b._graphicsSet=new Set;b._matcher=k.resolve(null);b._tileUpdateSet=new Set;b._tilesToUpdate=new Map;b._graphicIdToAbortController=new Map;b._attached=!1;b._highlightIds=new Map;b._updatingGraphicsTimer=
null;b.lastUpdateId=-1;b.updateRequested=!1;b.graphicUpdateHandler=b.graphicUpdateHandler.bind(b);b.addOrUpdateGraphic=b.addOrUpdateGraphic.bind(b);b._processAnalyzedGraphics=b._processAnalyzedGraphics.bind(b);b._graphicsChangeHandler=b._graphicsChangeHandler.bind(b);return b}h.__extends(q,a);q.prototype.initialize=function(){var b=this;this._tileStore=new J.default(this.view.featuresTilingScheme);this.container=new H.default(this.view.featuresTilingScheme);this._attributeStore=new F.default({type:"local",
initialize:function(e){return k.resolve(b.container.attributeView.initialize(e))},update:function(e){return b.container.attributeView.requestUpdate(e)},render:function(){return b.container.requestRender()}});this._graphicStore=new D.default(this.view.featuresTilingScheme,this.view.state.scale,this.uid,this.graphics,function(e){b._attributeStore.createLocalId(e.uid);b._setFilterState(e.uid,e.visible)},function(e){b._attributeStore.freeLocalId(e.uid)});this._graphicProcessingQueue=new G.default({process:this.addOrUpdateGraphic});
var e=new A.WGLTemplateStore(this.container.getMaterialItems.bind(this.container),!0);this._matcher=d.isSome(this.renderer)?A.createMatcher(e,null,this.renderer):A.createMatcher(e,null);this._meshFactory=new A.WGLMeshFactory(null,this.uid,null,e);this._templateStore=e;this.watch("renderer",function(a){a&&(b._matcher=d.isSome(b.renderer)?A.createMatcher(e,null,b.renderer):A.createMatcher(e,null))});this._tileStore.on("update",this._onTileUpdate.bind(this));this.container.on("attach",function(){0<b.graphics.items.length&&
b._graphicsChangeHandler({target:b.graphics,added:b.graphics.items,removed:[],moved:[]});b.handles.add(b.graphics.on("change",b._graphicsChangeHandler),"graphics");b._attached=!0;b.notifyChange("updating")});this.container.on("detach",function(){b._graphicProcessingQueue&&b._graphicProcessingQueue.clear()})};q.prototype.destroy=function(){this._updatingGraphicsTimer&&(clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=null,this.notifyChange("updating"));this.container.destroy();
this._set("graphics",null);this._graphicProcessingQueue&&(this._graphicProcessingQueue.destroy(),this._graphicProcessingQueue=null);this._graphicStore.clear();this._tileStore.destroy();this._attributeStore=null};Object.defineProperty(q.prototype,"updating",{get:function(){return!this._attached||null!==this._updatingGraphicsTimer||this._graphicProcessingQueue.updating||0<this._tileUpdateSet.size||0<this._tilesToUpdate.size},enumerable:!0,configurable:!0});q.prototype.hitTest=function(b,e){if(!this.view||
!this.view.position)return k.resolve();b=this.view.toMap(w.createScreenPoint(b,e));return this.searchFeatures(b).then(function(b){return b&&b.length?b[0]:null})};q.prototype.searchFeatures=function(b,e){var a=this;void 0===e&&(e=2);return k.create(function(c){c(a._graphicStore.hitTest(b.x,b.y,e,a.view.state.resolution,a.view.state.rotation))})};q.prototype.update=function(b){b=b.state;var e=this.view.featuresTilingScheme.getClosestInfoForScale(b.scale).level;this._graphicStore.updateLevel(e);this._tileStore.setViewState(b);
this._graphicStoreUpdate=!0;this.updateRequested=!1};q.prototype.viewChange=function(){this.requestUpdate()};q.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.requestUpdateCallback())};q.prototype.processUpdate=function(b){this.updateRequested&&(this.updateRequested=!1,this.update(b))};q.prototype.graphicUpdateHandler=function(b){var e=b.newValue,a=b.graphic;switch(b.property){case "geometry":case "symbol":this._graphicProcessingQueue.push(a,"update");break;
case "visible":this._setFilterState(a.uid,e),this._attributeStore.sendUpdates()}};q.prototype.addHighlight=function(b){for(var e=0;e<b.length;e++){var a=b[e];if(this._highlightIds.has(a)){var c=this._highlightIds.get(a);this._highlightIds.set(a,c+1)}else this._highlightIds.set(a,1)}this._updateHighlight()};q.prototype.removeHighlight=function(b){for(var e=0;e<b.length;e++){var a=b[e];if(this._highlightIds.has(a)){var c=this._highlightIds.get(a)-1;0===c?this._highlightIds.delete(a):this._highlightIds.set(a,
c)}}this._updateHighlight()};q.prototype._updateHighlight=function(){this._attributeStore.setHighlight(l.keysOfMap(this._highlightIds))};q.prototype._getIntersectingTiles=function(b){return(b=this._graphicStore.getBounds(b))&&0!==c.width(b)&&0!==c.height(b)?this._tileStore.boundsIntersections(b):[]};q.prototype._updateTile=function(b){var e=this,a=b.tile,c=this._getGraphicsData(this._templateStore,a,b.addedOrModified);return this._processGraphics(a.key,c).then(function(c){e._patchTile(a.key,{addOrUpdate:c,
remove:b.removed});return c})};q.prototype._patchTile=function(b,e){this._tiles.has(b)&&(b=this._tiles.get(b),this.container.onTileData(b,e),this.container.requestRender())};q.prototype._graphicsChangeHandler=function(b){var e=this;if(!this._graphicStoreUpdate){var a=this.view.state,c=this.view.featuresTilingScheme.getClosestInfoForScale(a.scale).level;this._graphicStore.updateLevel(c);this._tileStore.setViewState(a)}var n=b.added,c=b.removed;b=b.moved;for(var g=this._tilesToUpdate,q,a=[],d=Array(n.length),
x=0;x<n.length;x++){var l=n[x];d[x]=l;this._graphicsSet.add(l);a.push(this.addGraphic(l))}for(x=0;x<c.length;x++){l=c[x];this._abortProcessingGraphic(l.uid);for(var n=this._getIntersectingTiles(l),z=0,A=n;z<A.length;z++)n=A[z],q=n.key.id,n=K(q,n,g),n.removed.push(this._attributeStore.getLocalId(l.uid));this._graphicsSet.delete(l);this._graphicStore.remove(l)}for(c=0;c<b.length;c++)for(x=b[c],n=this._getIntersectingTiles(x),l=0,z=n;l<z.length;l++)n=z[l],q=n.key.id,n=K(q,n,g),n.addedOrModified.push(x);
this._flipUpdatingGraphics();k.all(a).then(function(){for(var b,a=0;a<d.length;a++){b=d[a];for(var c=0,n=e._getIntersectingTiles(b);c<n.length;c++){var x=n[c];q=x.key.id;K(q,x,g).addedOrModified.push(b)}}e._graphicStore.updateZ();var l=[];g.forEach(function(b){return l.push(e._updateTile(b))});return k.all(l).then(function(){g.clear();e.notifyChange("updating")})}).catch(function(){g.clear();e.notifyChange("updating")})};q.prototype._getArcadeInfo=function(b){var a=(b.attributes?Object.keys(b.attributes):
[]).map(function(e){return{name:e,alias:e,type:"string"===typeof b.attributes[e]?"esriFieldTypeString":"esriFieldTypeDouble"}});return d.isNone(b.geometry)?null:{geometryType:e.getJsonType(b.geometry),spatialReference:g.fromJSON(b.geometry.spatialReference),fields:a}};q.prototype._getSymbolForGraphic=function(b,e){return h.__awaiter(this,void 0,void 0,function(){return h.__generator(this,function(a){return d.isSome(b.symbol)?[2,b.symbol]:d.isSome(this.renderer)?[2,this.renderer.getSymbolAsync(b,{scale:this.view.scale,
abortOptions:e})]:[2,this._getNullSymbol(b)]})})};q.prototype._getSymbolResources=function(b,e){return h.__awaiter(this,void 0,void 0,function(){var a,c,n,g,q,d,l,z,f;return h.__generator(this,function(F){switch(F.label){case 0:if(!this.container.stage)return[2,k.resolve(null)];a=this._getArcadeInfo(b);n=x.expandSymbol;return[4,this._getSymbolForGraphic(b,e)];case 1:return[4,n.apply(void 0,[F.sent(),a,e])];case 2:c=F.sent();if("text"!==c.type)return[3,4];g=[];q=c;d=A.bidiText(q.text)[0];for(l=0;l<
d.length;l++)g.push(d.charCodeAt(l));z={symbol:c.toJSON(),id:0,glyphIds:g};return[4,this.container.getMaterialItems([z])];case 3:return f=F.sent()[0].mosaicItem,[2,{symbol:c,mosaicItem:f}];case 4:return[2,{symbol:c,mosaicItem:null}]}})})};q.prototype._projectAndNormalizeGeometry=function(a){return h.__awaiter(this,void 0,void 0,function(){var c,n,g,q=this;return h.__generator(this,function(l){if(d.isNone(a.geometry))return[2,k.resolve(null)];c=a.geometry;e.isPolygon(c)?(n=c.rings,c.rings=n):e.isPolyline(c)?
(g=c.paths,c.paths=g):e.isExtent(c)&&(c=b.fromExtent(c));return[2,z.checkProjectionSupport(c.spatialReference,this.view.spatialReference).then(function(){var b=E.normalizeCentralMeridian(c),b=z.project(b,c.spatialReference,q.view.spatialReference);y.closeRingsAndFixWinding(b);return b})]})})};q.prototype._onTileUpdate=function(b){var e=n.getInfo(this.view.spatialReference);if(b.added&&0<b.added.length)for(var a=0,c=b.added;a<c.length;a++)this._addNewTile(c[a],e);if(b.removed&&0<b.removed.length)for(e=
0,b=b.removed;e<b.length;e++)this._removeTile(b[e].key)};q.prototype.addOrUpdateGraphic=function(b,e,a){return this._addOrUpdateGraphic(b,e,a)};q.prototype.addGraphic=function(b){var e=this;this._abortProcessingGraphic(b.uid);var a=t.createAbortController();this._graphicIdToAbortController.set(b.uid,a);return this._addOrUpdateGraphic(b,"add",{signal:a.signal}).then(function(){e._graphicIdToAbortController.delete(b.uid)}).catch(function(a){e._graphicIdToAbortController.delete(b.uid);if(!k.isAbortError(a))throw a;
})};q.prototype._addOrUpdateGraphic=function(b,e,a){var c=this,n=this._projectAndNormalizeGeometry(b),g=this._getSymbolResources(b,a);return k.all([n,g]).then(function(n){var g=n[0];n=n[1];return"add"===e?c._addProjectedGraphic(b,n,g):c._updateGraphic(b,n,g,a)})};q.prototype._addProjectedGraphic=function(b,e,a){this._graphicsSet.has(b)&&this._graphicStore.add(b,e,a)};q.prototype._updateGraphic=function(b,e,a,n){var g=this;if(!this._graphicStore.has(b)||k.isAborted(n))return k.resolve();a=this._graphicStore.update(b,
e,a);e=a.oldBounds;a=a.newBounds;var q=0===c.width(e)&&0===c.height(e),d=0===c.width(a)&&0===c.height(a),q=q?[]:this._tileStore.boundsIntersections(e);e=d?[]:this._tileStore.boundsIntersections(a);a=f.acquire();for(var l=0;l<q.length;l++)d=q[l],a.set(d.key,{addOrUpdate:null,remove:[this._attributeStore.getLocalId(b.uid)]});for(q=0;q<e.length;q++)d=e[q],l=this._getGraphicData(this._templateStore,d,b),a.has(d.key)?(d=a.get(d.key),d.remove.length=0,d.addOrUpdate=l):a.set(d.key,{addOrUpdate:l,remove:null});
var x=[];a.forEach(function(b,e){var a=g._processGraphics(e,b.addOrUpdate,n).then(function(a){g._patchTile(e,{addOrUpdate:a,remove:b.remove})});x.push(a)});f.release(a);return k.all(x).then(function(){})};q.prototype._addTile=function(b,e){var a=c.create();this.view.featuresTilingScheme.getTileBounds(a,b);a=new A.WGLTile(b,a,!0);e={clear:!0,addOrUpdate:e,remove:[]};this._tiles.set(b,a);this.container.addChild(a);a.setData(e,!1,!1)};q.prototype._addNewTile=function(b,a){var c=this,n=this._graphicStore.queryTileData(this._templateStore,
b);if(a){a=Math.round((a.valid[1]-a.valid[0])/b.resolution);for(var g=0;g<n.length;g++){var q=n[g];q.geometry&&e.isPoint(q.geometry)&&this._wrapPoints(q,a)}}var d=b.key;this._tileUpdateSet.add(b.key);this.notifyChange("updating");this._processGraphics(d,n).then(function(b){c._addTile(d,b);c._tileUpdateSet.delete(d);c.notifyChange("updating")}).catch(function(b){c._tileUpdateSet.delete(d);c.notifyChange("updating");if(!k.isAbortError(b))throw b;})};q.prototype._removeTile=function(b){if(this._tiles.has(b)){var a=
this._tiles.get(b);this.container.removeChild(a);a.destroy();this._tiles.delete(b)}};q.prototype._setFilterState=function(b,a){var e=this._attributeStore.getLocalId(b);b=this._attributeStore.getHighlightFlag(b);this._attributeStore.setData(e,0,0,b|(a?I.FILTER_FLAG_0:0))};q.prototype._getGraphicsData=function(b,a,c){var g=n.getInfo(this.view.spatialReference);b=this._graphicStore.getGraphicsData(b,a,c);if(g)for(a=Math.round((g.valid[1]-g.valid[0])/a.resolution),g=0;g<b.length;g++)c=b[g],c.geometry&&
e.isPoint(c.geometry)&&this._wrapPoints(c,a);b.sort(function(b,a){return b.insertAfter-a.insertAfter});return b};q.prototype._getGraphicData=function(b,a,c){b=this._graphicStore.getGraphicData(b,a,c);c=[b];var g=n.getInfo(this.view.spatialReference);g&&(a=Math.round((g.valid[1]-g.valid[0])/a.resolution),b.geometry&&e.isPoint(b.geometry)&&this._wrapPoints(b,a));return c};q.prototype._wrapPoints=function(b,a){var e=b.geometry;512===a?20>e.x?b.geometry={points:[[e.x,e.y],[a,0]]}:492<e.x&&(b.geometry=
{points:[[e.x,e.y],[-a,0]]}):-20>e.x?b.geometry={points:[[e.x,e.y],[a,0]]}:532<e.x&&(b.geometry={points:[[e.x,e.y],[-a,0]]})};q.prototype._processGraphics=function(b,a,e){return h.__awaiter(this,void 0,void 0,function(){var c,n,g;return h.__generator(this,function(q){switch(q.label){case 0:c=a&&a.length;if(!c||!this._meshFactory)return[2,null];n=this._meshFactory;return[4,this._matcher.then(function(b){return n.analyze(a,b,null,null,e)})];case 1:return g=q.sent(),this._attributeStore.sendUpdates(),
[2,this._processAnalyzedGraphics(b,g)]}})})};q.prototype._processAnalyzedGraphics=function(b,a){for(var e=this._meshFactory,c=e.createMeshData(a.length),n=this._attributeStore,g=0;g<a.length;g++){var q=a[g];q.insertAfter=-1===q.insertAfter?-1:n.getLocalId(q.insertAfter);q.localId=n.getLocalId(q.attributes[this.uid]);e.write(c,q,null,null,b.level,null)}return A.TileData.fromMeshData(c)};q.prototype._abortProcessingGraphic=function(b){this._graphicIdToAbortController.has(b)&&this._graphicIdToAbortController.get(b).abort()};
q.prototype._getNullSymbol=function(b){b=b.geometry;return e.isPolyline(b)?C.errorPolylineSymbol2D:e.isPolygon(b)||e.isExtent(b)?C.errorPolygonSymbol2D:C.errorPointSymbol2D};q.prototype._flipUpdatingGraphics=function(){var b=this;this._updatingGraphicsTimer&&clearTimeout(this._updatingGraphicsTimer);this._updatingGraphicsTimer=setTimeout(function(){b._updatingGraphicsTimer=null;b.notifyChange("updating")},160);this.notifyChange("updating")};h.__decorate([u.property()],q.prototype,"_graphicProcessingQueue",
void 0);h.__decorate([u.property({constructOnly:!0})],q.prototype,"requestUpdateCallback",void 0);h.__decorate([u.property({constructOnly:!0})],q.prototype,"graphics",void 0);h.__decorate([u.property({dependsOn:["_graphicProcessingQueue.updating"]})],q.prototype,"updating",null);h.__decorate([u.property()],q.prototype,"view",void 0);h.__decorate([u.property()],q.prototype,"updateRequested",void 0);return q=h.__decorate([u.subclass("esri.views.2d.layers.support.GraphicsView2D")],q)}(q.GraphicsView(m.HandleOwnerMixin(r.IdentifiableMixin(p))));
a.default=v})},"esri/core/MapPool":function(){define(["require","exports","./ObjectPool"],function(v,a,h){v=function(){function a(a,f){void 0===a&&(a=50);void 0===f&&(f=50);this._pool=new h(Map,null,function(a){return a.clear()},f,a)}a.prototype.acquire=function(){return this._pool.acquire()};a.prototype.release=function(a){this._pool.release(a)};a.acquire=function(){return p.acquire()};a.release=function(a){return p.release(a)};return a}();var p=new v(100);return v})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports tslib ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(v,a,h,p,m,r,f,l,d){function k(a,c){var e;if(!c)return null;if("x"in c){var n={x:0,y:0};a=a(c.x,c.y,b);n.x=a[0];n.y=a[1];null!=c.z&&(n.z=c.z);null!=c.m&&(n.m=c.m);return n}if("xmin"in c)return n={xmin:0,ymin:0,xmax:0,ymax:0},e=a(c.xmin,c.ymin,b),n.xmin=e[0],n.ymin=e[1],a=a(c.xmax,c.ymax,b),n.xmax=a[0],n.ymax=a[1],c.hasZ&&(n.zmin=c.zmin,n.zmax=c.zmax,n.hasZ=!0),c.hasM&&(n.mmin=c.mmin,n.mmax=c.mmax,n.hasM=!0),n;if("rings"in c)return{rings:t(c.rings,a),hasM:c.hasM,hasZ:c.hasZ};if("paths"in c)return{paths:t(c.paths,
a),hasM:c.hasM,hasZ:c.hasZ};if("points"in c)return{points:w(c.points,a),hasM:c.hasM,hasZ:c.hasZ}}function t(b,a){for(var e=[],c=0;c<b.length;c++)e.push(w(b[c],a));return e}function w(b,a){for(var e=[],c=0;c<b.length;c++){var n=b[c],g=a(n[0],n[1],[0,0]);e.push(g);2<n.length&&g.push(n[2]);3<n.length&&g.push(n[3])}return e}function u(b,a){return!l.isValid(b)||!l.isValid(a)||l.equals(b,a)||d.canProject(b,a)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});var b=[0,0];a.doesBrowserSupportProjection=
function(b,a){return u(b,a)?r.isSupported():!0};a.checkProjectionSupport=function(b,a){return h.__awaiter(this,void 0,void 0,function(){var e,c,n;return h.__generator(this,function(g){if(!a)return[2];if(Array.isArray(b)){e=0;for(c=b;e<c.length;e++)if(n=c[e],u(n.geometry&&n.geometry.spatialReference,a)){if(r.isSupported())return[2,r.load()];throw new p("feature-store:unsupported-query","projection not supported",{inSpatialReference:b,outSpatialReference:a});}return[2]}if(!u(b,a))return[2];if(r.isSupported())return[2,
r.load()];throw new p("feature-store:unsupported-query","projection not supported",{inSpatialReference:b,outSpatialReference:a});})})};var g=k.bind(null,d.lngLatToXY),c=k.bind(null,d.xyToLngLat);a.project=function(b,a,k){if(!b)return b;k||(k=a,a=b.spatialReference);return l.isValid(a)&&l.isValid(k)&&!l.equals(a,k)?d.canProject(a,k)?l.isWebMercator(k)?g(b):c(b):r.projectMany(f.jsonAdapter,[b],a,k,null)[0]:b};var y=new (function(){function b(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}
b.prototype.push=function(b,a,c){return h.__awaiter(this,void 0,void 0,function(){var e,n=this;return h.__generator(this,function(g){b&&b.length&&a&&c&&!l.equals(a,c)||m.resolve(b);e={geometries:b,inSpatialReference:a,outSpatialReference:c,resolve:null};this._jobs.push(e);return[2,m.create(function(b){e.resolve=b;null===n._timer&&(n._timer=setTimeout(n._process,10))})]})})};b.prototype._process=function(){this._timer=null;var b=this._jobs.shift();if(b){var a=b.geometries,e=b.inSpatialReference,k=
b.outSpatialReference,b=b.resolve;d.canProject(e,k)?l.isWebMercator(k)?b(a.map(g)):b(a.map(c)):b(r.projectMany(f.jsonAdapter,a,e,k,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return b}());a.projectMany=function(b,a,c){return h.__awaiter(this,void 0,void 0,function(){return h.__generator(this,function(e){return[2,y.push(b,a,c)]})})}})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./support/GeographicTransformation @dojo/framework/shim/Promise".split(" "),
function(v,a,h,p,m){function r(a,d,b,g,c){void 0===c&&(c=null);if(null===c){var k=m.cacheKey(b,g);void 0!==t[k]?c=t[k]:(c=f(b,g,null),null===c&&(c=new m),t[k]=c)}return l._project(a,d,b,g,c)}function f(a,k,b){void 0===b&&(b=null);a=l._getTransformation(d,a,k,b,null===b||void 0===b?void 0:b.spatialReference);return null!==a?m.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});var l=null,d=null;a.isLoaded=function(){return!!l&&p.isLoaded()};a.isSupported=function(){return p.isSupported()};
var k=null;a.load=function(){return k?k:k=h.all([p.load(),new Promise(function(a,d){v(["./geometryEngineBase"],a,d)}),new Promise(function(a,d){v(["./geometryAdapters/hydrated"],a,d)})]).then(function(a){var k=a[1];d=a[2].hydratedAdapter;l=k;l._enableProjection(p)})};a.project=function(a,k,b){void 0===b&&(b=null);return a instanceof Array?0===a.length?[]:r(d,a,a[0].spatialReference,k,b):r(d,[a],a.spatialReference,k,b)[0]};var t={};a.projectMany=r;a.getTransformation=f;a.getTransformations=function(a,
k,b){void 0===b&&(b=null);a=l._getTransformationBySuitability(d,a,k,b,null===b||void 0===b?void 0:b.spatialReference);if(null!==a){k=[];for(b=0;b<a.length;b++)k.push(m.fromGE(a[b]));return k}return[]}})},"esri/geometry/pe":function(){define("require exports tslib ../assets ../core/has ../core/promiseUtils @dojo/framework/shim/Promise".split(" "),function(v,a,h,p,m,r){function f(e){function n(b,a,c){b[a]=c(b[a])}a._pe=e;u.init();b.init();g.init();c.init();y.init();a.PeGCSExtent=function(b){function c(){return null!==
b&&b.apply(this,arguments)||this}h.__extends(c,b);c.prototype.destroy=function(){a._pe.destroy(this)};return c}(a._pe.PeGCSExtent);for(var d=0,k=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,a._pe.PeUnit];d<k.length;d++)e=k[d],n(e.prototype,"getName",function(b){return function(){return b.call(this,Array(u.PE_NAME_MAX))}});d=0;for(k=[a._pe.PeGeogtran,a._pe.PeProjcs];d<k.length;d++)e=k[d],n(e.prototype,"getParameters",
function(b){return function(){for(var c=Array(u.PE_PARM_MAX),e=b.call(this),g=0;g<c.length;g++){var n=a._pe.getValue(e,"*");c[g]=n?a._pe.wrapPointer(n,a._pe.PeParameter):null;e+=Int32Array.BYTES_PER_ELEMENT}return c}});n(a._pe.PeHorizon.prototype,"getCoord",function(b){return function(){var a=this.getSize();if(!a)return null;var c=[],e=b.call(this);t(c,a,e);return c}});n(a._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(b){var c=a._pe._pe_getPeGTlistExtendedGTsSize();return function(){var e=
null,g=b.call(this);if(!a._pe.compare(g,a._pe.NULL)){var e=[g],n=this.getSteps();if(1<n)for(var g=a._pe.getPointer(g),d=1;d<n;d++)e.push(a._pe.wrapPointer(g+c*d,a._pe.PeGTlistExtendedGTs))}return e}});var l=a._pe._pe_getPeHorizonSize();e=function(b){return function(){var c=this._cache;c||(this._cache=c=new Map);if(c.has(b))return c.get(b);var e=null,g=b.call(this);if(!a._pe.compare(g,a._pe.NULL)){var e=[g],n=g.getNump();if(1<n)for(var g=a._pe.getPointer(g),d=1;d<n;d++)e.push(a._pe.wrapPointer(g+l*
d,a._pe.PeHorizon))}c.set(b,e);return e}};n(a._pe.PeProjcs.prototype,"horizonGcsGenerate",e);n(a._pe.PeProjcs.prototype,"horizonPcsGenerate",e);a._pe.PeObject.prototype.toString=function(b){void 0===b&&(b=u.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var c=a._pe.getPointer(this),e=a._pe.ensureInt8(Array(u.PE_BUFFER_MAX));return a._pe.UTF8ToString(a._pe._pe_object_to_string_ext(c,b,e))}}function l(b){if(b){var c=a._pe.getClass(b);c&&(c=a._pe.getCache(c))&&(b=a._pe.getPointer(b))&&delete c[b]}}function d(b,
c){var e=[];c=Array(c);for(var g=0;g<b;g++)e.push(a._pe.ensureInt8(c));return e}function k(b){var a;Array.isArray(b[0])?(a=[],b.forEach(function(b){a.push(b[0],b[1])})):a=b;return a}function t(b,c,g,d){void 0===d&&(d=!1);if(d)for(d=0;d<2*c;d++)b[d]=a._pe.getValue(g+d*Float64Array.BYTES_PER_ELEMENT,"double");else{var e=0===b.length;for(d=0;d<c;d++)e&&(b[d]=Array(2)),b[d][0]=a._pe.getValue(g,"double"),b[d][1]=a._pe.getValue(g+Float64Array.BYTES_PER_ELEMENT,"double"),g+=2*Float64Array.BYTES_PER_ELEMENT}}
Object.defineProperty(a,"__esModule",{value:!0});var w;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!m("esri-wasm")};a.load=function(){return w?w:w=r.create(function(b,a){(new Promise(function(b,a){v(["./support/pe-wasm"],b,a)})).then(function(c){c({locateFile:function(b){return p.getAssetUrl("esri/geometry/support/"+b)},onAbort:function(b){a(Error(b))}}).then(function(a){f(a);b()})})})};(function(b){function c(b,c,e){a._pe.ensureCache.prepare();var g=k(e),d=e===
g,g=a._pe.ensureFloat64(g);(b=a._pe._pe_geog_to_proj(a._pe.getPointer(b),c,g))&&t(e,c,g,d);return b}function e(b,a,c){return g(b,a,c,0)}function g(b,c,e,g){a._pe.ensureCache.prepare();var d=k(e),n=e===d,d=a._pe.ensureFloat64(d);(b=a._pe._pe_proj_to_geog_center(a._pe.getPointer(b),c,d,g))&&t(e,c,d,n);return b}b.geogToProj=c;b.projGeog=function(b,a,g,d){switch(d){case u.PE_TRANSFORM_P_TO_G:return e(b,a,g);case u.PE_TRANSFORM_G_TO_P:return c(b,a,g)}return 0};b.projToGeog=e;b.projToGeogCenter=g})(a.PeCSTransformations||
(a.PeCSTransformations={}));var u;(function(b){b.init=function(){b.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;b.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;b.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;b.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;b.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;b.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;b.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;b.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;b.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;b.PE_TYPE_NONE=
a._pe.PeDefs.prototype.PE_TYPE_NONE;b.PE_TYPE_GEOGCS=a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;b.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;b.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;b.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;b.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;b.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;b.PE_STR_AUTH_NONE=a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;b.PE_STR_AUTH_TOP=a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;b.PE_STR_NAME_CANON=
a._pe.PeDefs.prototype.PE_STR_NAME_CANON;b.PE_PARM_X0=a._pe.PeDefs.prototype.PE_PARM_X0;b.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;b.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;b.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;b.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;b.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;b.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;b.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;
b.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;b.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(u=a.PeDefs||(a.PeDefs={}));(function(b){function c(b,c){var d=null,n=g[b];n||(n={},g[b]=n);n.hasOwnProperty(String(c))?d=n[c]:(b=a._pe.PeFactory.prototype.factoryByType(b,c),a._pe.compare(b,a._pe.NULL)||(d=b,n[c]=d));return d=e(d)}function e(b){if(b){var c=b.getType();switch(c){case u.PE_TYPE_GEOGCS:b=a._pe.castObject(b,a._pe.PeGeogcs);break;case u.PE_TYPE_PROJCS:b=a._pe.castObject(b,
a._pe.PeProjcs);break;case u.PE_TYPE_GEOGTRAN:b=a._pe.castObject(b,a._pe.PeGeogtran);break;default:c&u.PE_TYPE_UNIT&&(b=a._pe.castObject(b,a._pe.PeUnit))}}return b}var g={},d={};b.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};b.coordsys=function(b){return c(u.PE_TYPE_COORDSYS,b)};b.factoryByType=c;b.fromString=function(b,c){var g=null,n=d[b];n||(n={},d[b]=n);n.hasOwnProperty(c)?g=n[c]:(b=a._pe.PeFactory.prototype.fromString(b,c),a._pe.compare(b,a._pe.NULL)||(g=b,n[c]=g));return g=
e(g)};b.geogcs=function(b){return c(u.PE_TYPE_GEOGCS,b)};b.geogtran=function(b){return c(u.PE_TYPE_GEOGTRAN,b)};b.getCode=function(b){return a._pe.PeFactory.prototype.getCode(b)};b.projcs=function(b){return c(u.PE_TYPE_PROJCS,b)};b.unit=function(b){return c(u.PE_TYPE_UNIT,b)}})(a.PeFactory||(a.PeFactory={}));a.PeGCSExtent=null;var b;(function(b){var c;b.init=function(){b.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;c=a._pe._pe_getPeGTlistExtendedEntrySize()};b.getGTlist=
function(b,e,g,d,n,k){var l=null,f=new a._pe.PeInteger(k);try{var h=a._pe.PeGTlistExtended.prototype.getGTlist(b,e,g,d,n,f);if(k=f.val)if(l=[h],1<k){var t=a._pe.getPointer(h);for(b=1;b<k;b++)l.push(a._pe.wrapPointer(t+c*b,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(f)}return l}})(b=a.PeGTlistExtended||(a.PeGTlistExtended={}));(function(b){b.destroy=function(b){if(b&&b.length){for(var c=0;c<b.length;c++){var e=b[c];l(e);e.getEntries().forEach(function(b){l(b);b=b.getGeogtran();l(b);b.getParameters().forEach(l);
[b.getGeogcs1(),b.getGeogcs2()].forEach(function(b){l(b);var a=b.getDatum();l(a);l(a.getSpheroid());l(b.getPrimem());l(b.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(b[0])}}})(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));(function(b){b.geogToGeog=function(b,c,e,g,d){a._pe.ensureCache.prepare();var n=k(e),l=e===n,n=a._pe.ensureFloat64(n),f=0;g&&(f=a._pe.ensureFloat64(g));(b=a._pe._pe_geog_to_geog(a._pe.getPointer(b),c,n,f,d))&&t(e,c,n,l);return b}})(a.PeGTTransformations||
(a.PeGTTransformations={}));(function(b){function c(b,c,e,g,n,l){a._pe.ensureCache.prepare();var f,h;switch(b){case "dd":f=a._pe._pe_geog_to_dd;h=u.PE_DD_MAX;break;case "ddm":f=a._pe._pe_geog_to_ddm;h=u.PE_DDM_MAX;break;case "dms":f=a._pe._pe_geog_to_dms,h=u.PE_DMS_MAX}b=0;c&&(b=a._pe.getPointer(c));c=k(g);c=a._pe.ensureFloat64(c);h=d(e,h);g=a._pe.ensureInt32(h);if(n=f(b,e,c,n,g))for(f=0;f<e;f++)l[f]=a._pe.UTF8ToString(h[f]);return n}function e(b,c,e,g,d){a._pe.ensureCache.prepare();var n;switch(b){case "dd":n=
a._pe._pe_dd_to_geog;break;case "ddm":n=a._pe._pe_ddm_to_geog;break;case "dms":n=a._pe._pe_dms_to_geog}b=0;c&&(b=a._pe.getPointer(c));c=g.map(function(b){return a._pe.ensureString(b)});g=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*e));(n=n(b,e,g,c))&&t(d,e,c);return n}b.geog_to_dms=function(b,a,e,g,d){return c("dms",b,a,e,g,d)};b.dms_to_geog=function(b,a,c,g){return e("dms",b,a,c,g)};b.geog_to_ddm=function(b,a,e,g,d){return c("ddm",b,a,e,g,d)};b.ddm_to_geog=function(b,a,c,g){return e("ddm",
b,a,c,g)};b.geog_to_dd=function(b,a,e,g,d){return c("dd",b,a,e,g,d)};b.dd_to_geog=function(b,a,c,g){return e("dd",b,a,c,g)}})(a.PeNotationDms||(a.PeNotationDms={}));var g;(function(b){b.init=function(){b.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;b.PE_MGRS_STYLE_OLD=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;b.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;b.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;b.PE_MGRS_ADD_SPACES=
a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};b.geog_to_mgrs_extended=function(b,c,e,g,l,f,h){a._pe.ensureCache.prepare();var n=0;b&&(n=a._pe.getPointer(b));b=k(e);e=a._pe.ensureFloat64(b);b=d(c,u.PE_MGRS_MAX);var t=a._pe.ensureInt32(b);if(g=a._pe._pe_geog_to_mgrs_extended(n,c,e,g,l,f,t))for(l=0;l<c;l++)h[l]=a._pe.UTF8ToString(b[l]);return g};b.mgrs_to_geog_extended=function(b,c,e,g,d){a._pe.ensureCache.prepare();var n=0;b&&(n=a._pe.getPointer(b));b=e.map(function(b){return a._pe.ensureString(b)});
e=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(g=a._pe._pe_mgrs_to_geog_extended(n,c,e,g,b))&&t(d,c,b);return g}})(g=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(b){b.geog_to_usng=function(b,c,e,g,l,f,h){a._pe.ensureCache.prepare();var n=0;b&&(n=a._pe.getPointer(b));b=k(e);e=a._pe.ensureFloat64(b);b=d(c,u.PE_MGRS_MAX);var t=a._pe.ensureInt32(b);if(g=a._pe._pe_geog_to_usng(n,c,e,g,l,f,t))for(l=0;l<c;l++)h[l]=a._pe.UTF8ToString(b[l]);return g};b.usng_to_geog=function(b,c,e,g){a._pe.ensureCache.prepare();
var d=0;b&&(d=a._pe.getPointer(b));b=e.map(function(b){return a._pe.ensureString(b)});e=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(d=a._pe._pe_usng_to_geog(d,c,e,b))&&t(g,c,b);return d}})(a.PeNotationUsng||(a.PeNotationUsng={}));var c;(function(b){b.init=function(){b.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;b.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;b.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};b.geog_to_utm=function(b,
c,e,g,l){a._pe.ensureCache.prepare();var n=0;b&&(n=a._pe.getPointer(b));b=k(e);e=a._pe.ensureFloat64(b);b=d(c,u.PE_UTM_MAX);var f=a._pe.ensureInt32(b);if(g=a._pe._pe_geog_to_utm(n,c,e,g,f))for(n=0;n<c;n++)l[n]=a._pe.UTF8ToString(b[n]);return g};b.utm_to_geog=function(b,c,e,g,d){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));b=e.map(function(b){return a._pe.ensureString(b)});e=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(g=a._pe._pe_utm_to_geog(k,c,e,g,b))&&t(d,c,b);return g}})(c=
a.PeNotationUtm||(a.PeNotationUtm={}));var y;(function(b){var c=new Map;b.init=function(){b.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;b.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;b.PE_POLE_OUTSIDE_BOUNDARY=a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;b.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};b.generate=function(e,g){void 0===g&&(g=b.PE_PCSINFO_OPTION_DOMAIN);var d,k;c.has(e)&&(k=c.get(e),k[g]&&(d=k[g]));d||(d=a._pe.PePCSInfo.prototype.generate(e,
g),k||(k=[],c.set(e,k)),k[g]=d);return d}})(y=a.PePCSInfo||(a.PePCSInfo={}));(function(b){b.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||(a.PeVersion={}));a._init=f})},"esri/geometry/support/GeographicTransformation":function(){define(["require","exports","./GeographicTransformationStep"],function(v,a,h){return function(){function a(a){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(a&&a.steps){var m=0;for(a=a.steps;m<
a.length;m++){var f=a[m];f instanceof h?this.steps.push(f):this.steps.push(new h({wkid:f.wkid,wkt:f.wkt,isInverse:f.isInverse}))}}}a.cacheKey=function(a,h){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==h.wkid&&null!==h.wkid?h.wkid.toString():"-1",void 0!==h.wkt&&null!==h.wkt?h.wkt.toString():""].join()};a.fromGE=function(m){var p=new a,f="",l=0;for(m=m.steps;l<m.length;l++){var d=h.fromGE(m[l]);p.steps.push(d);f+=d.uid.toString()+
","}p._cached_projection={};p._gtlistentry=null;p._chain=f;return p};a.prototype.getInverse=function(){var h=new a;h.steps=[];for(var p=this.steps.length-1;0<=p;p--)h.steps.push(this.steps[p].getInverse());return h};a.prototype.getGTListEntry=function(){for(var a="",h=0,f=this.steps;h<f.length;h++)a+=f[h].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};a.prototype.assignCachedGe=function(h,p,f){this._cached_projection[a.cacheKey(h,
p)]=f};a.prototype.getCachedGeTransformation=function(h,p){for(var f="",l=0,d=this.steps;l<d.length;l++)f+=d[l].uid.toString()+",";f!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=f);h=this._cached_projection[a.cacheKey(h,p)];return void 0===h?null:h};return a}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(v,a){var h=0;return function(){function a(a){void 0===a&&(a=null);this.uid=h++;a?(this._wkt=void 0!==
a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(h){var p=new a;p._wkt=h.wkt;p._wkid=h.wkid;p._isInverse=h.isInverse;return p};Object.defineProperty(a.prototype,"wkt",{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=h++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},set:function(a){this._wkid=
a;this.uid=h++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=h++},enumerable:!0,configurable:!0});a.prototype.getInverse=function(){var h=new a;h._wkt=this.wkt;h._wkid=this._wkid;h._isInverse=!this.isInverse;return h};return a}()})},"esri/geometry/geometryAdapters/json":function(){define(["require","exports"],function(v,a){Object.defineProperty(a,"__esModule",{value:!0});a.jsonAdapter=
{convertToGEGeometry:function(a,d){return null==d?null:a.convertJSONToGeometry(d)},exportPoint:function(a,d,k){k=new h(a.getPointX(d),a.getPointY(d),k);var l=a.hasZ(d),f=a.hasM(d);l&&(k.z=a.getPointZ(d));f&&(k.m=a.getPointM(d));return k},exportPolygon:function(a,d,k){return new p(a.exportPaths(d),k,a.hasZ(d),a.hasM(d))},exportPolyline:function(a,d,k){return new m(a.exportPaths(d),k,a.hasZ(d),a.hasM(d))},exportMultipoint:function(a,d,k){return new r(a.exportPoints(d),k,a.hasZ(d),a.hasM(d))},exportExtent:function(a,
d,k){var l=a.hasZ(d),h=a.hasM(d);k=new f(a.getXMin(d),a.getYMin(d),a.getXMax(d),a.getYMax(d),k);l&&(l=a.getZExtent(d),k.zmin=l.vmin,k.zmax=l.vmax);h&&(a=a.getMExtent(d),k.mmin=a.vmin,k.mmax=a.vmax);return k}};var h=function(){return function(a,d,k){this.x=a;this.y=d;this.spatialReference=k;this.m=this.z=void 0}}(),p=function(){return function(a,d,k,f){this.rings=a;this.spatialReference=d;this.hasM=this.hasZ=void 0;k&&(this.hasZ=k);f&&(this.hasM=f)}}(),m=function(){return function(a,d,k,f){this.paths=
a;this.spatialReference=d;this.hasM=this.hasZ=void 0;k&&(this.hasZ=k);f&&(this.hasM=f)}}(),r=function(){return function(a,d,k,f){this.points=a;this.spatialReference=d;this.hasM=this.hasZ=void 0;k&&(this.hasZ=k);f&&(this.hasM=f)}}(),f=function(){return function(a,d,k,f,h){this.xmin=a;this.ymin=d;this.xmax=k;this.ymax=f;this.spatialReference=h;this.mmax=this.mmin=this.zmax=this.zmin=void 0}}()})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require exports tslib ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../layers/support/FieldsIndex ../../../../../support/arcadeOnDemand ../../../engine ../../../arcade/utils ../../../engine/webgl/definitions ../tileRenderers/support/visualVariablesUtils @dojo/framework/shim/Promise".split(" "),
function(v,a,h,p,m,r,f,l,d,k,t,w,u,b,g){Object.defineProperty(a,"__esModule",{value:!0});var c=r.getLogger("esri.views.layers.2d.features.support.AttributeStore"),y=w.debug.createDebugLogger(w.debug.DEBUG_ATTR_UPDATES,c);a.LOCAL_ID_TYPE_AGGREGATE=1;a.isAggregateId=function(b){return(b&2147483648)>>>31===a.LOCAL_ID_TYPE_AGGREGATE};var e=function(b,a){return function(c,e,g){var d;try{d=a(c,e,g)}catch(E){d=NaN}return(null===d||isNaN(d)||Infinity===d)&&b||d}},n=m("esri-shared-array-buffer"),z=m("esri-webgl-texture-float"),
x=m("esri-webgl-max-texture-size"),C=m("esri-atomics"),A=function(){function b(b,a,c,e){this.texelSize=4;var g=e.pixelType,d=e.layout;this.textureOnly=(e=e.textureOnly)||!1;this.pixelType=g;this._ctype=a;this.layout=d;this._resetRange();this._shared=b;e||(this.data=this._initData(g,c,b,a))}Object.defineProperty(b.prototype,"buffer",{get:function(){return l.andThen(this.data,function(b){return b.buffer})},enumerable:!0,configurable:!0});b.prototype.getData=function(b,a){b&=2147483647;return l.unwrap(this.data)[b*
this.texelSize+a]};b.prototype.setData=function(b,a,e){b&=2147483647;0===(this.layout&1<<a)?c.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):(this.data[b*this.texelSize+a]=e,this.dirtyStart=Math.min(this.dirtyStart,b),this.dirtyEnd=Math.max(this.dirtyEnd,b))};b.prototype.lock=function(){5121===this.pixelType&&this._shared&&C&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};b.prototype.unlock=function(){5121===this.pixelType&&this._shared&&C&&"local"!==
this._ctype&&Atomics.store(this.data,0,0)};b.prototype.expand=function(b){if(!this.textureOnly){b=this._initData(this.pixelType,b,this._shared,this._ctype);var a=l.unwrap(this.data);b.set(a);this.data=b}};b.prototype.toMessage=function(){var b=this.dirtyStart,a=this.dirtyEnd,c=this.texelSize;if(b>a)return null;this._resetRange();var e=!this._shared&&"local"!==this._ctype,g=this.pixelType,d=this.layout,q=l.unwrap(this.data);if(!q.slice){if(!e)return{start:b,end:a,data:null,pixelType:g,layout:d};c=
new (w.Utils.getPixelArrayCtor(this.pixelType))(Array.prototype.slice.call(this.data,b*c,(a+1)*c));return{start:b,end:a,data:c,pixelType:g,layout:d}}c=e&&q.slice(b*c,(a+1)*c)||null;return{start:b,end:a,data:c,pixelType:g,layout:d}};b.prototype._initData=function(b,a,c,e){c=c&&"local"!==e?SharedArrayBuffer:ArrayBuffer;b=w.Utils.getPixelArrayCtor(b);a=new b(new c(a*a*4*b.BYTES_PER_ELEMENT));for(b=0;b<a.length;b+=4)a[b+1]=255;return a};b.prototype._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=
0};return b}();m=function(){function m(b){this._attributeComputeMap=new Map;this._blocks=[];this._idMap=new Map;this._localToObjectId=new Map;this._filters=Array(w.definitions.MAX_FILTERS);this._freeTexelsList=[];this._abortController=d.createAbortController();this._hasScaleExpr=!1;this._size=32;this._idCounter=1;this._idsToHighlight=new Set;var a=z?5126:5121;y("Creating AttributeStore "+(n?"with":"without")+" shared memory");this._client=b;this._blockDescriptors=[{pixelType:5121,layout:1},{pixelType:5121,
layout:15,textureOnly:!0},{pixelType:a,layout:15},{pixelType:a,layout:15}];this._blocks=this._blockDescriptors.map(function(){return null})}m.prototype.destroy=function(){this._abortController.abort()};Object.defineProperty(m.prototype,"hasScaleExpr",{get:function(){return this._hasScaleExpr},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"_signal",{get:function(){return this._abortController.signal},enumerable:!0,configurable:!0});m.prototype.invalidateResources=function(){this._createResourcesPromise=
null;this._abortController.abort();this._abortController=d.createAbortController()};m.prototype.createLocalId=function(b,a){void 0===a&&(a=!1);if(!this._idMap.has(b)){var c=this._getFreeTexel();a=((a?2147483648:0)|c)>>>0;this._idMap.set(b,-1===a?0:a);this._localToObjectId.set(a,b)}return this._idMap.get(b)};m.prototype.addLocalId=function(b){this._getBlock(0).setData(b,0,0);this._freeTexelsList.push(b&2147483647)};m.prototype.removeLocalId=function(b){var a=this._idMap.get(b);this._idMap.delete(b);
this._localToObjectId.delete(a);return a};m.prototype.freeLocalId=function(b){var a=this._idMap.get(b);this._getBlock(0).setData(a,0,0);this._idMap.delete(b);this._localToObjectId.delete(a);this._freeTexelsList.push(a&2147483647)};m.prototype.getFeatureId=function(b){return this._localToObjectId.get(b)};m.prototype.getLocalId=function(b){return this._idMap.has(b)?this._idMap.get(b):null};m.prototype.setHighlight=function(b){return h.__awaiter(this,void 0,void 0,function(){var a,c,e,g,d,q,k=this;return h.__generator(this,
function(n){switch(n.label){case 0:this._getBlock(0).lock();this._idsToHighlight.forEach(function(b){if(b=k.getLocalId(b)){var a=k._getBlock(0).getData(b,0);k._getBlock(0).setData(b,0,a&-2)}});this._idsToHighlight.clear();a=0;for(c=b;a<c.length;a++)e=c[a],this._idsToHighlight.add(e);for(g=0;g<b.length;g++)d=this.getLocalId(b[g]),null!=d&&(q=this._getBlock(0).getData(d,0),this._getBlock(0).setData(d,0,q|1));this._getBlock(0).unlock();return[4,this.sendUpdates()];case 1:return n.sent(),[2]}})})};m.prototype.addHighlight=
function(){return h.__awaiter(this,void 0,void 0,function(){return h.__generator(this,function(b){return[2]})})};m.prototype.removeHighlight=function(){return h.__awaiter(this,void 0,void 0,function(){return h.__generator(this,function(b){return[2]})})};m.prototype.updateFilters=function(b){return h.__awaiter(this,void 0,void 0,function(){var a,c,e,g,k,q=this;return h.__generator(this,function(n){switch(n.label){case 0:return a=b.config,c=b.service,e=b.spatialReference,g=a.filters,k=g.map(function(a,
g){return q._updateFilter(b,a,g,c,e)}),[4,d.all(k)];case 1:return n.sent(),[2]}})})};m.prototype.setAttributeBindings=function(b,a){return h.__awaiter(this,void 0,void 0,function(){return h.__generator(this,function(e){this._hasScaleExpr=!1;switch(b.type){case "simple":case "class-breaks":case "unique-value":case "dictionary":return[2,this._bindVVEvaluators(b.visualVariables,a)];case "dot-density":return[2,this._bindDDEvaluators(b.attributes,a)];case "heatmap":break;default:c.error(new p("attribute-store",
"Found invalid renderer type: "+b))}return[2]})})};m.prototype.setData=function(b,a,c,e){this._getBlock(a).setData(b,c,e)};m.prototype.getData=function(b,a,c){return this._getBlock(a).getData(b,c)};m.prototype.getHighlightFlag=function(a){return this._idsToHighlight.has(a)?b.HIGHLIGHT_FLAG:0};m.prototype.setAttributeData=function(a,c,e,g){var d=this;this._getBlock(0).setData(a,0,this.getFilterFlags(c));var k=z?1:2;this._attributeComputeMap.forEach(function(q,n){var h=n*k%4;n=d._getBlock(Math.floor(n*
k/4)+b.ATTRIBUTE_DATA_VV);q=q(c,{$view:g},e);if(z)n.setData(a,h,q);else if(q===w.definitions.NAN_MAGIC_NUMBER)n.setData(a,h,255),n.setData(a,h+1,255);else{q=f.clamp(Math.round(q),-32767,32766)+32768;var l=(q&65280)>>8;n.setData(a,h,q&255);n.setData(a,h+1,l)}})};m.prototype.sendUpdates=function(){var b=this;if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=d.createResolver(),this._nextUpdate.promise;var a={blocks:this._blocks.map(function(b){return l.isSome(b)?
b.toMessage():null})};return this._currUpdate=this._createResources().then(function(){var c=function(){b._currUpdate=null;if(b._nextUpdate){var a=b._nextUpdate;b._nextUpdate=null;b.sendUpdates().then(function(){return a.resolve()})}},c=b._client.update(a,b._signal).then(c).catch(c);b._client.render();return c}).catch(function(a){if(d.isAbortError(a))return b._createResourcesPromise=null,b._createResources();c.error(new p("mapview-attribute-store","Encountered an error during client update",a));return d.resolve()})};
m.prototype._createResources=function(){var a=this;if(l.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(b.ATTRIBUTE_DATA_ANIMATION);y("Initializing AttributeStore");var e={shared:n&&"local"!==this._client.type,size:this._size,blocks:l.mapMany(this._blocks,function(b){return{textureOnly:b.textureOnly,buffer:b.buffer,pixelType:b.pixelType}})};this._createResourcesPromise=e=this._client.initialize(e,this._signal).catch(function(b){d.isAbortError(b)?a._createResourcesPromise=
null:c.error(new p("mapview-attribute-store","Encountered an error during client initialization",b))});e.then(function(){return l.isNone(a._createResourcesPromise)?a._createResources():void 0});return e};m.prototype._getBlock=function(b){var a=this._blocks[b];if(l.isSome(a))return a;y("Initializing AttributeBlock at index "+b);a=new A(n,this._client.type,this._size,this._blockDescriptors[b]);this._blocks[b]=a;this._createResourcesPromise=null;return a};m.prototype._expand=function(){if(this._size<
x){var b=this._size<<=1;y("Expanding block size to",b,this._blocks);l.forEachSome(this._blocks,function(a){return a.expand(b)});this._createResourcesPromise=null;this._size=b;return 0}c.error(new p("mapview-limitations","Maximum number of onscreen features exceeded."));return-1};m.prototype._getFreeTexel=function(){return this._freeTexelsList.length?this._freeTexelsList.pop():this._idCounter>=this._size*this._size&&this._expand()?-1:this._idCounter++};m.prototype._updateFilter=function(b,c,e,g,d){return h.__awaiter(this,
void 0,void 0,function(){var k,q,n,f,y,t,m,p,z,w=this;return h.__generator(this,function(h){switch(h.label){case 0:k=this._filters[e];q=l.isSome(k)&&k.hash;if(q===JSON.stringify(c))return[2];n=1<<e+1;return l.isNone(c)?(this._filters[e]=null,this._idMap.forEach(function(b){var a=w._getBlock(0).getData(b,0);w._getBlock(0).setData(b,0,a|n)}),[2]):[4,b.queryObjectIds(c)];case 1:return f=h.sent(),c.hiddenIds&&c.hiddenIds.length&&(f=f.filter(function(b){return-1===c.hiddenIds.indexOf(b)})),y=f.map(function(b){return w._idMap.get(b)}),
[4,this._getFilter(e,g)];case 2:t=h.sent();t.update(c,d);this._getBlock(0).lock();this._idMap.forEach(function(b){if((b&2147483648)>>>31!==a.LOCAL_ID_TYPE_AGGREGATE){var c=w._getBlock(0).getData(b,0);w._getBlock(0).setData(b,0,c&~n)}});for(m=0;m<y.length;m++)p=y[m],null!=p&&(z=this._getBlock(0).getData(p,0),this._getBlock(0).setData(p,0,z|n));this._getBlock(0).unlock();return[2]}})})};m.prototype._getFilter=function(b,a){return h.__awaiter(this,void 0,void 0,function(){var c,e,g;return h.__generator(this,
function(d){switch(d.label){case 0:return c=this._filters[b],l.isSome(c)?[2,c]:[4,new Promise(function(b,a){v(["../../../../../layers/graphics/data/FeatureFilter"],b,a)})];case 1:return e=d.sent().default,g=new e({geometryType:a.geometryType,hasM:!1,hasZ:!1,timeInfo:a.timeInfo,fieldsIndex:new k(a.fields)}),this._filters[b]=g,[2,g]}})})};m.prototype.isVisible=function(b){return!!(this._getBlock(0).getData(b.localId,0)&2)};m.prototype.getFilterFlags=function(b){for(var c=0,e=(b.localId&2147483648)>>>
31===a.LOCAL_ID_TYPE_AGGREGATE?254:255,g=0;g<this._filters.length;g++)var d=this._filters[g],d=!(e&1<<g)||l.isNone(d)||d.check(b),c=c|(d?1:0)<<g;b=this.getFeatureId(b.localId);return c<<1|this.getHighlightFlag(b)};m.prototype._bindVVEvaluators=function(b,a){return h.__awaiter(this,void 0,void 0,function(){var c,e=this;return h.__generator(this,function(g){switch(g.label){case 0:this._attributeComputeMap.clear();if(!l.isSome(b))return[3,2];c=d.all(b.map(function(b){return h.__awaiter(e,void 0,void 0,
function(){var c,e;return h.__generator(this,function(g){switch(g.label){case 0:return c=w.Utils.getVVType(b.type),[4,this._createGetValueFunction(b,a)];case 1:return e=g.sent(),l.isSome(e)&&this._attributeComputeMap.set(c,e),[2]}})})}));return[4,c];case 1:g.sent(),g.label=2;case 2:return[2]}})})};m.prototype._bindDDEvaluators=function(b,a){return h.__awaiter(this,void 0,void 0,function(){var g,k,n,f=this;return h.__generator(this,function(q){switch(q.label){case 0:return this._attributeComputeMap.clear(),
b.length>w.definitions.DOT_DENSITY_MAX_FIELDS&&c.warn("mapview-invalid-value","DotDensityRenderer supports a maximum of "+w.definitions.DOT_DENSITY_MAX_FIELDS+" attribtues, but found "+b.length),[4,d.all(b.map(function(b){return f._createNormalizedFunction(b,a)}))];case 1:g=q.sent().map(function(b){return e(0,b)});for(k=0;k<w.definitions.DOT_DENSITY_MAX_FIELDS;k++)(n=k<b.length&&g[k])?this._attributeComputeMap.set(k,n):this._attributeComputeMap.has(k)&&this._attributeComputeMap.delete(k);return[2]}})})};
m.prototype._createGetValueFunction=function(b,a){return h.__awaiter(this,void 0,void 0,function(){var c,d,k,n,q,f,l;return h.__generator(this,function(h){switch(h.label){case 0:if("size"!==b.type)return[3,2];c=w.getTypeOfSizeVisualVariable(b);if(c===w.enums.WGLVVFlag.SIZE_SCALE_STOPS)return[2,null];k=(d=c===w.enums.WGLVVFlag.SIZE_UNIT_VALUE)&&function(a){return g.getVisualVariableSizeValueRepresentationRatio(a,b.valueRepresentation)};n=e;q=[w.definitions.NAN_MAGIC_NUMBER];return[4,this._createNormalizedFunction(b,
a,k)];case 1:return[2,n.apply(void 0,q.concat([h.sent()]))];case 2:return f=e,l=[w.definitions.NAN_MAGIC_NUMBER],[4,this._createNormalizedFunction(b,a)];case 3:return[2,f.apply(void 0,l.concat([h.sent()]))]}})})};m.prototype._createNormalizedFunction=function(b,a,e){return h.__awaiter(this,void 0,void 0,function(){var g,d,k;return h.__generator(this,function(n){switch(n.label){case 0:if(g=b.field){if("string"===typeof g)return(d=b.normalizationField)?[2,function(b){if(b.attributes[g]&&b.attributes[d])return b=
b.attributes[g]/b.attributes[d],e?e(b):b}]:[2,e?function(b){return e(b.attributes[g])}:function(b){return b.attributes[g]}];c.error(new p("mapview-rendering:invalid-type","The field for a vv must be a string or a number, but got "+typeof g));return[2,function(){}]}if(!b.valueExpression)return[3,2];this._hasScaleExpr=this._hasScaleExpr||-1!==b.valueExpression.indexOf("scale");return[4,t.createVVExpression(b.valueExpression,a.spatialReference,a.fields)];case 1:return k=n.sent(),[2,u.callWithOptimizedFeature.bind(null,
k)];case 2:return c.error("Unable to create a normalized function for visual variable: "+b),[2,function(){}]}})})};return m}();a.default=m})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("require exports tslib ../../../../../../core/screenUtils ../../../../engine ../../../../engine/webgl/definitions ../../../../../3d/layers/support/FastSymbolUpdates".split(" "),function(v,a,h,p,m,r,f){function l(b){return{value:b.value,size:p.toPt(b.size)}}function d(b){return b.map(function(b){return l(b)})}
function k(b){return"string"===typeof b||"number"===typeof b?p.toPt(b):{type:"size",expression:b.expression,stops:d(b.stops)}}function t(b){var a={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if(m.Utils.isString(b.field))if(b.stops){if(8<b.stops.length)return null;var c=b.stops;for(b=0;8>b;++b){var d=c[Math.min(b,c.length-1)];a.values[b]=d.value;a.opacities[b]=d.opacity}}else return null;else if(b.stops&&0<=b.stops.length)for(c=b.stops&&0<=b.stops.length&&b.stops[0].opacity,b=0;8>b;b++)a.values[b]=
Infinity,a.opacities[b]=c;else return null;return a}Object.defineProperty(a,"__esModule",{value:!0});var w=m.enums.WGLVVFlag;a.getVisualVariableSizeValueRepresentationRatio=function(b,a){if(!b||!a)return b;switch(a){case "radius":case "distance":return 2*b;case "area":return Math.sqrt(b)}return b};a.stopToSizeStop=l;a.normalizeSizeStops=d;a.normalizeSizeElement=k;a.getVisualVariablesFields=function(b){var a=b&&0<b.length?{}:null;a&&b.forEach(function(b){var c=b.type;b.field&&(a[c]=b.field)});return a};
var u=function(b){var a=[],c=[];b=d(b);for(var k=b.length,e=0;6>e;e++){var n=b[Math.min(e,k-1)];a.push(n.value);c.push(null==n.size?r.NAN_MAGIC_NUMBER:p.pt2px(n.size))}return{values:new Float32Array(a),sizes:new Float32Array(c)}};a.convertVisualVariables=function(b){var a=b&&0<b.length?{}:null,c=a?{}:null;if(!a)return{vvFields:a,vvRanges:c};for(var l=0;l<b.length;l++){var e=b[l],n=e.type;e.field&&(a[n]=e.field);if("size"===n)switch(c.size||(c.size={}),m.getTypeOfSizeVisualVariable(e)){case w.SIZE_MINMAX_VALUE:c.size.minMaxValue=
{minDataValue:e.minDataValue,maxDataValue:e.maxDataValue,minSize:k(e.minSize),maxSize:k(e.maxSize)};break;case w.SIZE_SCALE_STOPS:c.size.scaleStops={stops:d(e.stops)};break;case w.SIZE_FIELD_STOPS:if(e.levels){var n={},p;for(p in e.levels)n[p]=u(e.levels[p]);c.size.fieldStops={type:"level-dependent",levels:n}}else c.size.fieldStops=h.__assign({type:"static"},u(e.stops));break;case w.SIZE_UNIT_VALUE:c.size.unitValue={unit:e.valueUnit,valueRepresentation:e.valueRepresentation}}else if("color"===n){if(e=
f.convertVisualVariables([e],{modelSize:null,symbolSize:null,unitInMeters:1,transformation:null}))for(c.color=e.color,e=0;32>e;e+=4)m.color.premultiplyAlpha(c.color.colors,e,!0)}else"opacity"===n?c.opacity=t(e):"rotation"===n&&(c.rotation={type:e.rotationType})}return{vvFields:a,vvRanges:c}}})},"esri/views/3d/layers/support/FastSymbolUpdates":function(){define("require exports ../../../../core/compilerUtils ../../../../core/mathUtils ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f64 ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../renderers/support/utils ../../support/debugFlags".split(" "),
function(v,a,h,p,m,r,f,l,d,k,t,w){function u(b){return null!==b&&void 0!==b}function b(b){return"number"===typeof b}function g(b){return"string"===typeof b}function c(b,a){b&&b.push(a)}function y(a,g,d,k,n){var f=a.minSize,h=a.maxSize;if(a.expression)return c(n,"Could not convert size info: expression not supported"),!1;if(a.useSymbolValue)return a=k.symbolSize[d],g.minSize[d]=a,g.maxSize[d]=a,g.offset[d]=g.minSize[d],g.factor[d]=0,g.type[d]=1,!0;if(u(a.field)){if(u(a.stops)){if(2===a.stops.length&&
b(a.stops[0].size)&&b(a.stops[1].size))return e(a.stops[0].size,a.stops[1].size,a.stops[0].value,a.stops[1].value,g,d),g.type[d]=1,!0;c(n,"Could not convert size info: stops only supported with 2 elements");return!1}if(b(f)&&b(h)&&u(a.minDataValue)&&u(a.maxDataValue))return e(f,h,a.minDataValue,a.maxDataValue,g,d),g.type[d]=1,!0;if(null!=t.meterIn[a.valueUnit])return g.minSize[d]=-Infinity,g.maxSize[d]=Infinity,g.offset[d]=0,g.factor[d]=1/t.meterIn[a.valueUnit],g.type[d]=1,!0;if("unknown"===a.valueUnit)return c(n,
"Could not convert size info: proportional size not supported"),!1;c(n,"Could not convert size info: scale-dependent size not supported");return!1}if(!u(a.field)){if(a.stops&&a.stops[0]&&b(a.stops[0].size))return g.minSize[d]=a.stops[0].size,g.maxSize[d]=a.stops[0].size,g.offset[d]=g.minSize[d],g.factor[d]=0,g.type[d]=1,!0;if(b(f))return g.minSize[d]=f,g.maxSize[d]=f,g.offset[d]=f,g.factor[d]=0,g.type[d]=1,!0}c(n,"Could not convert size info: unsupported variant of sizeInfo");return!1}function e(b,
a,c,g,e,d){g=0<Math.abs(g-c)?(a-b)/(g-c):0;e.minSize[d]=0<g?b:a;e.maxSize[d]=0<g?a:b;e.offset[d]=b-c*g;e.factor[d]=g}function n(b,a,e,d){if(b.normalizationField||b.valueRepresentation)return c(d,"Could not convert size info: unsupported property"),null;var k=b.field;if(null!=k&&!g(k))return c(d,"Could not convert size info: field is not a string"),null;if(!a.size)a.size={field:b.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[0,0,0]};else if(b.field)if(!a.size.field)a.size.field=
b.field;else if(b.field!==a.size.field)return c(d,"Could not convert size info: multiple fields in use"),null;switch(b.axis){case "width":return(k=y(b,a.size,0,e,d))?a:null;case "height":return(k=y(b,a.size,2,e,d))?a:null;case "depth":return(k=y(b,a.size,1,e,d))?a:null;case "width-and-depth":return(k=y(b,a.size,0,e,d))&&y(b,a.size,1,e,d),k?a:null;case null:case void 0:case "all":return(k=(k=(k=y(b,a.size,0,e,d))&&y(b,a.size,1,e,d))&&y(b,a.size,2,e,d))?a:null;default:return c(d,'Could not convert size info: unknown axis "'+
b.axis+'""'),null}}function z(b,a,e){for(var g=0;3>g;++g){var d=a.unitInMeters;1===b.type[g]&&(d*=a.modelSize[g],b.type[g]=2);b.minSize[g]/=d;b.maxSize[g]/=d;b.offset[g]/=d;b.factor[g]/=d}if(0!==b.type[0])a=0;else if(0!==b.type[1])a=1;else if(0!==b.type[2])a=2;else return c(e,"No size axis contains a valid size or scale"),!1;for(g=0;3>g;++g)0===b.type[g]&&(b.minSize[g]=b.minSize[a],b.maxSize[g]=b.maxSize[a],b.offset[g]=b.offset[a],b.factor[g]=b.factor[a],b.type[g]=b.type[a]);return!0}function x(b,
a,c){b[4*a+0]=c.r/255;b[4*a+1]=c.g/255;b[4*a+2]=c.b/255;b[4*a+3]=c.a}function C(b,a,e){if(b.normalizationField)return c(e,"Could not convert color info: unsupported property"),null;if(g(b.field))if(b.stops){if(8<b.stops.length)return c(e,"Could not convert color info: too many color stops"),null;a.color={field:b.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};e=b.stops;for(b=0;8>b;++b){var d=e[Math.min(b,e.length-1)];a.color.values[b]=d.value;
x(a.color.colors,b,d.color)}}else return c(e,"Could not convert color info: missing stops or colors"),null;else if(b.stops&&0<=b.stops.length)for(e=b.stops&&0<=b.stops.length&&b.stops[0].color,a.color={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},b=0;8>b;b++)a.color.values[b]=Infinity,x(a.color.colors,b,e);else return c(e,"Could not convert color info: no field and no colors/stops"),null;return a}function A(b,a,e){if(b.normalizationField)return c(e,
"Could not convert opacity info: unsupported property"),null;if(g(b.field))if(b.stops){if(8<b.stops.length)return c(e,"Could not convert opacity info: too many opacity stops"),null;a.opacity={field:b.field,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};e=b.stops;for(b=0;8>b;++b){var d=e[Math.min(b,e.length-1)];a.opacity.values[b]=d.value;a.opacity.opacityValues[b]=d.opacity}}else return c(e,"Could not convert opacity info: missing stops or opacities"),null;else if(b.stops&&0<=b.stops.length)for(e=
b.stops&&0<=b.stops.length&&b.stops[0].opacity,a.opacity={field:null,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]},b=0;8>b;b++)a.opacity.values[b]=Infinity,a.opacity.opacityValues[b]=e;else return c(e,"Could not convert opacity info: no field and no opacities/stops"),null;return a}function I(b,a,c){b=2===c&&"arithmetic"===b.rotationType;a.offset[c]=b?90:0;a.factor[c]=b?-1:1;a.type[c]=1}function F(b,a,e){if(!g(b.field))return c(e,"Could not convert rotation info: field is not a string"),
null;if(!a.rotation)a.rotation={field:b.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};else if(b.field)if(!a.rotation.field)a.rotation.field=b.field;else if(b.field!==a.rotation.field)return c(e,"Could not convert rotation info: multiple fields in use"),null;switch(b.axis){case "tilt":return I(b,a.rotation,0),a;case "roll":return I(b,a.rotation,1),a;case null:case void 0:case "heading":return I(b,a.rotation,2),a;default:return c(e,'Could not convert rotation info: unknown axis "'+b.axis+'""'),
null}}function J(b,a,e){if(!b)return null;var g=!a.supportedTypes||!!a.supportedTypes.size,d=!a.supportedTypes||!!a.supportedTypes.color,k=!a.supportedTypes||!!a.supportedTypes.rotation,f=!!a.supportedTypes&&!!a.supportedTypes.opacity,l=b.reduce(function(b,l){if(!b)return b;if(l.valueExpression)return c(e,"Could not convert visual variables: arcade expressions not supported"),null;switch(l.type){case "size":return g?n(l,b,a,e):b;case "color":return d?C(l,b,e):b;case "opacity":return f?A(l,b,e):null;
case "rotation":return k?F(l,b,e):b;default:return h.neverReached(l),null}},{size:null,color:null,opacity:null,rotation:null});return 0<b.length&&l&&!l.size&&!l.color&&!l.opacity&&!l.rotation||l&&l.size&&!z(l.size,a,e)?null:l}function H(b,a,c){if(!!b!==!!a||b&&b.field!==a.field)return!1;if(b&&"rotation"===c)for(c=0;3>c;c++)if(b.type[c]!==a.type[c]||b.offset[c]!==a.offset[c]||b.factor[c]!==a.factor[c])return!1;return!0}function G(b,a){var c={vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,vvSizeOffset:null,
vvSizeFactor:null,vvSizeValue:null,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null,vvOpacityEnabled:!1,vvOpacityValues:null,vvOpacityOpacities:null,vvSymbolAnchor:null,vvSymbolRotationMatrix:null},e=b&&null!=b.size;b&&b.size?(c.vvSizeEnabled=!0,c.vvSizeMinSize=b.size.minSize,c.vvSizeMaxSize=b.size.maxSize,c.vvSizeOffset=b.size.offset,c.vvSizeFactor=b.size.factor):b&&e&&(c.vvSizeValue=a.transformation.scale);if(b&&e){c.vvSymbolAnchor=a.transformation.anchor;c.vvSymbolRotationMatrix=r.mat3f64.create();
f.mat4.identity(E);var g=a.transformation.rotation[2],e=a.transformation.rotation[0],d=a.transformation.rotation[1];a=E;void 0===a&&(a=l.mat4f64.create());g=g||0;e=e||0;d=d||0;0!==g&&f.mat4.rotateZ(a,a,-g/180*Math.PI);0!==e&&f.mat4.rotateX(a,a,e/180*Math.PI);0!==d&&f.mat4.rotateY(a,a,d/180*Math.PI);m.mat3.fromMat4(c.vvSymbolRotationMatrix,E)}b&&b.color&&(c.vvColorEnabled=!0,c.vvColorValues=b.color.values,c.vvColorColors=b.color.colors);b&&b.opacity&&(c.vvOpacityEnabled=!0,c.vvOpacityValues=b.opacity.values,
c.vvOpacityOpacities=b.opacity.opacityValues);return c}Object.defineProperty(a,"__esModule",{value:!0});a.convertVisualVariables=J;a.initFastSymbolUpdatesState=function(b,a){return!b||w.DISABLE_FAST_UPDATES?{enabled:!1}:(b=J(b.visualVariables,a))?{enabled:!0,visualVariables:b,materialParameters:G(b,a),requiresShaderTransformation:b&&null!=b.size}:{enabled:!1}};a.updateFastSymbolUpdatesState=function(b,a,c){if(!a||!b.enabled)return!1;var e=b.visualVariables;a=J(a.visualVariables,c);if(!(a&&H(e.size,
a.size,"size")&&H(e.color,a.color,"color")&&H(e.rotation,a.rotation,"rotation")&&H(e.opacity,a.opacity,"opacity")))return!1;b.visualVariables=a;b.materialParameters=G(a,c);b.requiresShaderTransformation=a&&null!=a.size;return!0};a.getMaterialParams=G;var D;(function(b){var a=l.mat4f64.create(),c=k.vec3f64.create();b.evaluateModelTransform=function(b,e,g){if(!b.vvSizeEnabled)return g;f.mat4.copy(a,g);g=b.vvSymbolRotationMatrix;f.mat4.set(E,g[0],g[1],g[2],0,g[3],g[4],g[5],0,g[6],g[7],g[8],0,0,0,0,1);
f.mat4.multiply(a,a,E);for(g=0;3>g;++g)c[g]=p.clamp(b.vvSizeOffset[g]+e[0]*b.vvSizeFactor[g],b.vvSizeMinSize[g],b.vvSizeMaxSize[g]);f.mat4.scale(a,a,c);f.mat4.translate(a,a,b.vvSymbolAnchor);return a};b.evaluateModelTransformScale=function(b,a,c){if(!a.vvSizeEnabled)return d.vec3.set(b,1,1,1);for(var e=0;3>e;++e)b[e]=p.clamp(a.vvSizeOffset[e]+c[0]*a.vvSizeFactor[e],a.vvSizeMinSize[e],a.vvSizeMaxSize[e]);return b}})(D||(D={}));var E=l.mat4f64.create();a.evaluateModelTransform=D.evaluateModelTransform;
a.evaluateModelTransformScale=D.evaluateModelTransformScale})},"esri/core/libs/gl-matrix-2/mat3f64":function(){define(["require","exports","./factories/mat3f64"],function(v,a,h){Object.defineProperty(a,"__esModule",{value:!0});a.mat3f64=h})},"esri/core/libs/gl-matrix-2/factories/mat3f64":function(){define(["require","exports"],function(v,a){Object.defineProperty(a,"__esModule",{value:!0});a.create=function(){return[1,0,0,0,1,0,0,0,1]};a.clone=function(a){return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],
a[7],a[8]]};a.fromValues=function(a,p,m,r,f,l,d,k,t){return[a,p,m,r,f,l,d,k,t]};a.createView=function(a,p){return new Float64Array(a,p,9)}})},"esri/core/libs/gl-matrix-2/mat4f64":function(){define(["require","exports","./factories/mat4f64"],function(v,a,h){Object.defineProperty(a,"__esModule",{value:!0});a.mat4f64=h})},"esri/core/libs/gl-matrix-2/factories/mat4f64":function(){define(["require","exports"],function(v,a){function h(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}Object.defineProperty(a,"__esModule",
{value:!0});a.create=h;a.clone=function(a){return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]};a.fromValues=function(a,h,r,f,l,d,k,t,w,u,b,g,c,y,e,n){return[a,h,r,f,l,d,k,t,w,u,b,g,c,y,e,n]};a.createView=function(a,h){return new Float64Array(a,h,16)};a.IDENTITY=h()})},"esri/views/3d/support/debugFlags":function(){define(["require","exports","tslib","../../../core/Accessor","../../../core/accessorSupport/decorators"],function(v,a,h,p,m){return new (function(a){function f(){var f=
null!==a&&a.apply(this,arguments)||this;f.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1;f.SCENEVIEW_LOCKING_LOG=!1;f.HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED=!1;f.HIGHLIGHTS_PROFILE_TO_CONSOLE=!1;f.DECONFLICTOR_SHOW_VISIBLE=!1;f.DECONFLICTOR_SHOW_INVISIBLE=!1;f.DECONFLICTOR_SHOW_GRID=!1;f.LABELS_SHOW_BORDER=!1;f.OVERLAY_DRAW_DEBUG_TEXTURE=!1;f.OVERLAY_SHOW_CENTER=!1;f.TERRAIN_DEBUG_POPUP=!1;f.TESTS_DISABLE_UPDATE_THRESHOLDS=!1;f.DISABLE_DECONFLICTOR_VISIBILITY_OFFSET=!1;f.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES=
!1;f.DRAW_MESH_GEOMETRY_NORMALS=!1;f.FEATURE_TILE_FETCH_SHOW_TILES=!1;f.FEATURE_TILE_TREE_SHOW_TILES=!1;f.I3S_TREE_SHOW_TILES=!1;f.I3S_SHOW_MODIFICATIONS=!1;f.ENABLE_PROFILE_DEPTH_RANGE=!1;f.DISABLE_FAST_UPDATES=!1;f.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1;f.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1;f.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1;return f}h.__extends(f,a);h.__decorate([m.property()],f.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0);h.__decorate([m.property()],f.prototype,"SCENEVIEW_LOCKING_LOG",
void 0);h.__decorate([m.property()],f.prototype,"HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED",void 0);h.__decorate([m.property()],f.prototype,"HIGHLIGHTS_PROFILE_TO_CONSOLE",void 0);h.__decorate([m.property()],f.prototype,"DECONFLICTOR_SHOW_VISIBLE",void 0);h.__decorate([m.property()],f.prototype,"DECONFLICTOR_SHOW_INVISIBLE",void 0);h.__decorate([m.property()],f.prototype,"DECONFLICTOR_SHOW_GRID",void 0);h.__decorate([m.property()],f.prototype,"LABELS_SHOW_BORDER",void 0);h.__decorate([m.property()],f.prototype,
"OVERLAY_DRAW_DEBUG_TEXTURE",void 0);h.__decorate([m.property()],f.prototype,"OVERLAY_SHOW_CENTER",void 0);h.__decorate([m.property()],f.prototype,"TERRAIN_DEBUG_POPUP",void 0);h.__decorate([m.property()],f.prototype,"TESTS_DISABLE_UPDATE_THRESHOLDS",void 0);h.__decorate([m.property()],f.prototype,"DISABLE_DECONFLICTOR_VISIBILITY_OFFSET",void 0);h.__decorate([m.property()],f.prototype,"DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES",void 0);h.__decorate([m.property()],f.prototype,"DRAW_MESH_GEOMETRY_NORMALS",
void 0);h.__decorate([m.property()],f.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0);h.__decorate([m.property()],f.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0);h.__decorate([m.property()],f.prototype,"I3S_TREE_SHOW_TILES",void 0);h.__decorate([m.property()],f.prototype,"I3S_SHOW_MODIFICATIONS",void 0);h.__decorate([m.property()],f.prototype,"ENABLE_PROFILE_DEPTH_RANGE",void 0);h.__decorate([m.property()],f.prototype,"DISABLE_FAST_UPDATES",void 0);h.__decorate([m.property()],f.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",
void 0);h.__decorate([m.property()],f.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0);h.__decorate([m.property()],f.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0);return f=h.__decorate([m.subclass("esri.views.3d.support.DebugFlags")],f)}(p))})},"esri/views/2d/layers/features/support/TileStore":function(){define("require exports tslib ../../../../../core/Evented ../../../../../core/has ../../../../../core/libs/rbush/rbush ./Tile ../../../tiling/TileCoverage ../../../tiling/TileKey".split(" "),
function(v,a,h,p,m,r,f,l,d){Object.defineProperty(a,"__esModule",{value:!0});var k={added:[],removed:[]},t=new Set,w=new d(0,0,0,0);v=function(a){function b(b){var c=a.call(this)||this;c._tiles=new Map;c._index=r(9,m("csp-restrictions")?function(b){return{minX:b.bounds[0],minY:b.bounds[1],maxX:b.bounds[2],maxY:b.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]);c.tiles=[];c.tileScheme=b;return c}h.__extends(b,a);b.prototype.destroy=function(){this._tiles.clear()};b.prototype.clear=
function(){this._tiles.clear();this._index.clear()};b.prototype.has=function(b){return this._tiles.has(b)};b.prototype.get=function(b){return this._tiles.get(b)};b.prototype.findByKey=function(b){return this._tiles.get(b.id)};b.prototype.intersections=function(b,a){var c="string"===typeof b?this.get(b):b;if(!c)return[];var e=a*c.resolution;a=c.bounds[0]-e;b=c.bounds[1]-e;for(var g=c.bounds[2]+e,c=c.bounds[3]+e,e=[],d=0,k=this._index.search({minX:a,minY:b,maxX:g,maxY:c});d<k.length;d++){var f=k[d],
h=f.bounds.slice();h[0]=Math.max(h[0],a);h[1]=Math.max(h[1],b);h[2]=Math.min(h[2],g);h[3]=Math.min(h[3],c);0<h[2]-h[0]&&0<h[3]-h[1]&&e.push({bounds:h,tile:f})}return e};b.prototype.boundsIntersections=function(b){return this._index.search({minX:b[0],minY:b[1],maxX:b[2],maxY:b[3]})};b.prototype.setViewState=function(b){if(b=this.tileScheme.getTileCoverage(b,0)){var a=b.spans,g=b.lodInfo,e=g.level;if(0<a.length)for(var d=0;d<a.length;d++)for(var h=a[d],m=h.row,p=h.colTo,u=h.colFrom;u<=p;u++){var r=
w.set(e,m,g.normalizeCol(u),g.getWorldForColumn(u)).id;t.add(r);this.has(r)||(h=new f.default(this.tileScheme,r),this._tiles.set(r,h),this._index.insert(h),this.tiles.push(h),k.added.push(h))}for(a=this.tiles.length-1;0<=a;a--)h=this.tiles[a],t.has(h.id)||(this._tiles.delete(h.id),this.tiles.splice(a,1),this._index.remove(h),k.removed.push(h));(k.added.length||k.removed.length)&&this.emit("update",k);l.pool.release(b);t.clear();k.added.length=0;k.removed.length=0}};return b}(p);a.default=v})},"esri/core/libs/rbush/rbush":function(){define(["../quickselect/quickselect"],
function(v){function a(b,g){if(!(this instanceof a))return new a(b,g);this._maxEntries=Math.max(4,b||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));g&&("function"===typeof g?this.toBBox=g:this._initFormat(g));this.clear()}function h(b,a){p(b,0,b.children.length,a,b)}function p(b,a,c,d,e){e||(e=w(null));e.minX=Infinity;e.minY=Infinity;e.maxX=-Infinity;e.maxY=-Infinity;for(var g;a<c;a++)g=b.children[a],m(e,b.leaf?d(g):g);return e}function m(b,a){b.minX=Math.min(b.minX,a.minX);b.minY=
Math.min(b.minY,a.minY);b.maxX=Math.max(b.maxX,a.maxX);b.maxY=Math.max(b.maxY,a.maxY);return b}function r(b,a){return b.minX-a.minX}function f(b,a){return b.minY-a.minY}function l(b){return(b.maxX-b.minX)*(b.maxY-b.minY)}function d(b){return b.maxX-b.minX+(b.maxY-b.minY)}function k(b,a){return b.minX<=a.minX&&b.minY<=a.minY&&a.maxX<=b.maxX&&a.maxY<=b.maxY}function t(b,a){return a.minX<=b.maxX&&a.minY<=b.maxY&&a.maxX>=b.minX&&a.maxY>=b.minY}function w(b){return{children:b,height:1,leaf:!0,minX:Infinity,
minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function u(b,a,c,d,e){for(var g=[a,c],k;g.length;)c=g.pop(),a=g.pop(),c-a<=d||(k=a+Math.ceil((c-a)/d/2)*d,v(b,k,a,c,e),g.push(a,k,k,c))}a.prototype={all:function(){return this._all(this.data,[])},search:function(b){var a=this.data,c=[],d=this.toBBox;if(!t(b,a))return c;for(var e=[],f,h,l,m;a;){f=0;for(h=a.children.length;f<h;f++)l=a.children[f],m=a.leaf?d(l):l,t(b,m)&&(a.leaf?c.push(l):k(b,m)?this._all(l,c):e.push(l));a=e.pop()}return c},collides:function(b){var a=
this.data,c=this.toBBox;if(!t(b,a))return!1;for(var d=[],e,f,h,l;a;){e=0;for(f=a.children.length;e<f;e++)if(h=a.children[e],l=a.leaf?c(h):h,t(b,l)){if(a.leaf||k(b,l))return!0;d.push(h)}a=d.pop()}return!1},load:function(b){if(!b||!b.length)return this;if(b.length<this._minEntries){for(var a=0,c=b.length;a<c;a++)this.insert(b[a]);return this}b=this._build(b.slice(),0,b.length-1,0);this.data.children.length?this.data.height===b.height?this._splitRoot(this.data,b):(this.data.height<b.height&&(a=this.data,
this.data=b,b=a),this._insert(b,this.data.height-b.height-1,!0)):this.data=b;return this},insert:function(b){b&&this._insert(b,this.data.height-1);return this},clear:function(){this.data=w([]);return this},remove:function(b,a){if(!b)return this;for(var c=this.data,d=this.toBBox(b),e=[],g=[],f,h,l,t;c||e.length;){c||(c=e.pop(),h=e[e.length-1],f=g.pop(),t=!0);if(c.leaf){a:{l=b;var m=c.children,p=a;if(p){for(var w=0;w<m.length;w++)if(p(l,m[w])){l=w;break a}l=-1}else l=m.indexOf(l)}if(-1!==l){c.children.splice(l,
1);e.push(c);this._condense(e);break}}t||c.leaf||!k(c,d)?h?(f++,c=h.children[f],t=!1):c=null:(e.push(c),g.push(f),f=0,h=c,c=c.children[0])}return this},toBBox:function(b){return b},compareMinX:r,compareMinY:f,toJSON:function(){return this.data},fromJSON:function(b){this.data=b;return this},_all:function(b,a){for(var c=[];b;)b.leaf?a.push.apply(a,b.children):c.push.apply(c,b.children),b=c.pop();return a},_build:function(b,a,c,d){var e=c-a+1,g=this._maxEntries,k;if(e<=g)return k=w(b.slice(a,c+1)),h(k,
this.toBBox),k;d||(d=Math.ceil(Math.log(e)/Math.log(g)),g=Math.ceil(e/Math.pow(g,d-1)));k=w([]);k.leaf=!1;k.height=d;var e=Math.ceil(e/g),g=e*Math.ceil(Math.sqrt(g)),f,l,t;for(u(b,a,c,g,this.compareMinX);a<=c;a+=g)for(l=Math.min(a+g-1,c),u(b,a,l,e,this.compareMinY),f=a;f<=l;f+=e)t=Math.min(f+e-1,l),k.children.push(this._build(b,f,t,d-1));h(k,this.toBBox);return k},_chooseSubtree:function(b,a,c,d){for(var e,g,k,f,h,t,m,p;;){d.push(a);if(a.leaf||d.length-1===c)break;m=p=Infinity;e=0;for(g=a.children.length;e<
g;e++)k=a.children[e],h=l(k),t=(Math.max(k.maxX,b.maxX)-Math.min(k.minX,b.minX))*(Math.max(k.maxY,b.maxY)-Math.min(k.minY,b.minY))-h,t<p?(p=t,m=h<m?h:m,f=k):t===p&&h<m&&(m=h,f=k);a=f||a.children[0]}return a},_insert:function(b,a,c){var d=this.toBBox;c=c?b:d(b);var d=[],e=this._chooseSubtree(c,this.data,a,d);e.children.push(b);for(m(e,c);0<=a;)if(d[a].children.length>this._maxEntries)this._split(d,a),a--;else break;this._adjustParentBBoxes(c,d,a)},_split:function(b,a){var c=b[a],d=c.children.length,
e=this._minEntries;this._chooseSplitAxis(c,e,d);d=this._chooseSplitIndex(c,e,d);d=w(c.children.splice(d,c.children.length-d));d.height=c.height;d.leaf=c.leaf;h(c,this.toBBox);h(d,this.toBBox);a?b[a-1].children.push(d):this._splitRoot(c,d)},_splitRoot:function(b,a){this.data=w([b,a]);this.data.height=b.height+1;this.data.leaf=!1;h(this.data,this.toBBox)},_chooseSplitIndex:function(b,a,c){var d,e,g,k,f,h,t;f=h=Infinity;for(d=a;d<=c-a;d++)e=p(b,0,d,this.toBBox),g=p(b,d,c,this.toBBox),k=Math.max(0,Math.min(e.maxX,
g.maxX)-Math.max(e.minX,g.minX))*Math.max(0,Math.min(e.maxY,g.maxY)-Math.max(e.minY,g.minY)),e=l(e)+l(g),k<f?(f=k,t=d,h=e<h?e:h):k===f&&e<h&&(h=e,t=d);return t},_chooseSplitAxis:function(b,a,c){var d=b.leaf?this.compareMinX:r,e=b.leaf?this.compareMinY:f,g=this._allDistMargin(b,a,c,d);a=this._allDistMargin(b,a,c,e);g<a&&b.children.sort(d)},_allDistMargin:function(b,a,c,k){b.children.sort(k);k=this.toBBox;var e=p(b,0,a,k),g=p(b,c-a,c,k),f=d(e)+d(g),h,l;for(h=a;h<c-a;h++)l=b.children[h],m(e,b.leaf?k(l):
l),f+=d(e);for(h=c-a-1;h>=a;h--)l=b.children[h],m(g,b.leaf?k(l):l),f+=d(g);return f},_adjustParentBBoxes:function(b,a,c){for(;0<=c;c--)m(a[c],b)},_condense:function(b){for(var a=b.length-1,c;0<=a;a--)0===b[a].children.length?0<a?(c=b[a-1].children,c.splice(c.indexOf(b[a]),1)):this.clear():h(b[a],this.toBBox)},_initFormat:function(b){var a=["return a"," - b",";"];this.compareMinX=new Function("a","b",a.join(b[0]));this.compareMinY=new Function("a","b",a.join(b[1]));this.toBBox=new Function("a","return {minX: a"+
b[0]+", minY: a"+b[1]+", maxX: a"+b[2]+", maxY: a"+b[3]+"};")}};return a})},"esri/core/libs/quickselect/quickselect":function(){define([],function(){function v(h,m,r,f,l){for(;f>r;){if(600<f-r){var d=f-r+1,k=m-r+1,t=Math.log(d),p=.5*Math.exp(2*t/3),t=.5*Math.sqrt(t*p*(d-p)/d)*(0>k-d/2?-1:1);v(h,m,Math.max(r,Math.floor(m-k*p/d+t)),Math.min(f,Math.floor(m+(d-k)*p/d+t)),l)}d=h[m];k=r;p=f;a(h,r,m);for(0<l(h[f],d)&&a(h,r,f);k<p;){a(h,k,p);k++;for(p--;0>l(h[k],d);)k++;for(;0<l(h[p],d);)p--}0===l(h[r],d)?
a(h,r,p):(p++,a(h,p,f));p<=m&&(r=p+1);m<=p&&(f=p-1)}}function a(a,h,r){var f=a[h];a[h]=a[r];a[r]=f}function h(a,h){return a<h?-1:a>h?1:0}return function(a,m,r,f,l){v(a,m,r||0,f||a.length-1,l||h)}})},"esri/views/2d/layers/features/support/Tile":function(){define("require exports ../../../../../core/ArrayPool ../../../../../geometry/Extent ../../../../../geometry/support/aaBoundingRect ../../../../../tasks/support/QuantizationParameters ../../../tiling/TileKey".split(" "),function(v,a,h,p,m,r,f){function l(a,
k){var d=a.bounds,f=k.bounds;return a.key.id!==k.key.id&&a.key.world===k.key.world&&d[0]<=f[0]&&d[1]<=f[1]&&d[2]>=f[2]&&d[3]>=f[3]}Object.defineProperty(a,"__esModule",{value:!0});a.isParentOf=l;a.isChildOf=function(a,k){return l(k,a)};v=function(){function a(a,d){this.bounds=m.create();this.key=new f(0,0,0,0);this.objectIds=new Set;this.key.set(d);d=a.getLODInfoAt(this.key);this.tileInfoView=a;this.tileInfoView.getTileBounds(this.bounds,this.key,!0);this.resolution=d.resolution;this.scale=d.scale;
this.level=d.level;this.needsClear=!0}Object.defineProperty(a.prototype,"id",{get:function(){return this.key.id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"extent",{get:function(){return p.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"transform",{get:function(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}},enumerable:!0,
configurable:!0});a.prototype.clone=function(){return new a(this.tileInfoView,this.id)};a.prototype.createChildTiles=function(){for(var d=this.key.getChildKeys(),f=h.acquire(),l=0;l<d.length;l++)f[l]=new a(this.tileInfoView,d[l]);return f};a.prototype.getQuantizationParameters=function(){return r.default.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})};
return a}();a.Tile=v;a.default=v})},"esri/views/2d/layers/graphics/GraphicContainer":function(){define(["require","exports","tslib","../../engine/FeatureContainer"],function(v,a,h,p){Object.defineProperty(a,"__esModule",{value:!0});v=function(a){function m(){return null!==a&&a.apply(this,arguments)||this}h.__extends(m,a);Object.defineProperty(m.prototype,"hasLabels",{get:function(){return!1},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"labelsVisible",{get:function(){return!1},
enumerable:!0,configurable:!0});m.prototype._renderGraphics=function(a,h){for(var d=0,k=this.children;d<k.length;d++){var f=k[d];f.isReady&&f.hasData&&(f.commitChanges(),a.context.setStencilFunction(514,f.stencilRef,255),f._displayList.replay(a,f,h))}};m.prototype.renderChildren=function(f){var h=f.painter;this.children.some(function(a){return a.hasData})&&(a.prototype.renderChildren.call(this,f),this._renderGraphics(f),h=h.effects.highlight,h.bind(f),this._renderGraphics(f,h.defines),h.draw(f),h.unbind())};
return m}(p.FeatureContainer);a.default=v})},"esri/views/2d/engine/FeatureContainer":function(){define("require exports tslib ../../../core/promiseUtils ../../../core/promiseUtils ../../../geometry/support/aaBoundingRect ../engine".split(" "),function(v,a,h,p,m,r,f){Object.defineProperty(a,"__esModule",{value:!0});v=function(a){function d(d){d=a.call(this,d)||this;d._rendererInfo=new f.WGLRendererInfo;d._attachedResolver=p.createResolver();d.attributeView=new f.AttributeStoreView;return d}h.__extends(d,
a);d.prototype.destroy=function(){this.removeAllChildren();this.children.forEach(function(a){return a.destroy()});this.attributeView.destroy()};d.prototype.whenAttached=function(){return h.__awaiter(this,void 0,void 0,function(){return h.__generator(this,function(a){switch(a.label){case 0:return[4,this._attachedResolver.promise];case 1:return a.sent(),[2]}})})};d.prototype.setRendererInfo=function(a,d,f){this._rendererInfo.setInfo(a,d,f);this.requestRender()};d.prototype.getMaterialItems=function(a,
d){return h.__awaiter(this,void 0,void 0,function(){var k,f,b,g;return h.__generator(this,function(c){switch(c.label){case 0:return a&&0!==a.length?[4,this.whenAttached()]:[2,null];case 1:return c.sent(),k=this.stage.painter.textureManager,f=a.map(function(b){return k.rasterizeItem(b.symbol,b.glyphIds,d)}),[4,m.all(f)];case 2:return b=c.sent(),g=b.map(function(b,c){return{id:a[c].id,mosaicItem:b}}),[2,g]}})})};d.prototype.onTileData=function(a,d){if(!(d.addOrUpdate&&"tileDisplayData"in d.addOrUpdate)){var k=
d.addOrUpdate&&f.TileData.decode(d.addOrUpdate);d=h.__assign(h.__assign({},d),{addOrUpdate:k})}a.setData(d,this.hasLabels,this.labelsVisible);this.contains(a)||this.addChild(a);this.requestRender()};d.prototype.onTileError=function(a){a.clear();this.contains(a)||this.addChild(a)};d.prototype.renderChildren=function(d){this._rendererInfo.update(d.state);this.attributeView.bindTextures(this.stage.context);a.prototype.renderChildren.call(this,d)};d.prototype.createTile=function(a){var d=this._tileInfoView.getTileBounds(r.create(),
a);return new f.WGLTile(a,d)};d.prototype.destroyTile=function(a){this.removeChild(a);a.destroy()};d.prototype.createRenderParams=function(d){return h.__assign(h.__assign({},a.prototype.createRenderParams.call(this,d)),{rendererInfo:this._rendererInfo,attributeView:this.attributeView})};d.prototype.onAttach=function(){a.prototype.onAttach.call(this);var d=this.stage.context.capabilities;d.textureFloat;d.vao;this._attachedResolver()};d.prototype.onDetach=function(){a.prototype.onDetach.call(this);
this._attachedResolver=p.createResolver()};return d}(f.TileContainer);a.FeatureContainer=v})},"esri/views/2d/layers/graphics/GraphicProcessingQueue":function(){define("require exports tslib ../../../../core/Accessor ../../../../core/promiseUtils ../../../../core/scheduling ../../../../core/accessorSupport/decorators".split(" "),function(v,a,h,p,m,r,f){Object.defineProperty(a,"__esModule",{value:!0});v=function(a){function d(d){d=a.call(this,d)||this;d._queue=new Map;d._queueArray=[];d._onGoingGraphic=
null;d._onGoingPromise=null;d._scheduledNextHandle=null;d._next=d._next.bind(d);d._finalize=d._finalize.bind(d);return d}h.__extends(d,a);Object.defineProperty(d.prototype,"length",{get:function(){return this._queueArray.length},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"updating",{get:function(){return 0<this._queueArray.length||null!==this._onGoingPromise},enumerable:!0,configurable:!0});d.prototype.cancel=function(a){this._onGoingGraphic&&this._onGoingGraphic.graphic===
a&&(this._ongoingAbortController.abort(),this._onGoingGraphic=this._onGoingPromise=null);if(this._queue.has(a)){var d=this._queue.get(a);this._queue.delete(a);a=this._queueArray.indexOf(d);this._queueArray.slice(a,1)}this._scheduleNext();this.notifyChange("updating")};d.prototype.clear=function(){this._queue.clear();this._queueArray.length=0;this._onGoingPromise&&(this._ongoingAbortController.abort(),this._onGoingGraphic=this._onGoingPromise=null);this._cancelNext();this.notifyChange("updating")};
d.prototype.has=function(a){return this._queue.has(a)};d.prototype.isOngoing=function(a){return this._onGoingGraphic&&this._onGoingGraphic.graphic===a};d.prototype.push=function(a,d){this._queue.has(a)||(d={graphic:a,addOrUpdate:d},this._queueArray.push(d),this._queue.set(a,d),this._scheduleNext(),this.notifyChange("updating"))};d.prototype.refresh=function(){this.reset()};d.prototype.reset=function(){var a=this._onGoingGraphic;a&&this.push(a.graphic,a.addOrUpdate)};d.prototype._finalize=function(){this._onGoingPromise=
this._ongoingAbortController=this._onGoingGraphic=null;this.notifyChange("updating");this._scheduleNext()};d.prototype._cancelNext=function(){this._scheduledNextHandle&&(this._scheduledNextHandle.remove(),this._scheduledNextHandle=null)};d.prototype._scheduleNext=function(){this._scheduledNextHandle||0===this._queue.size||null!=this._onGoingGraphic||(this._scheduledNextHandle=r.schedule(this._next))};d.prototype._next=function(){if(null==this._scheduledNextHandle||0===this._queue.size||this._onGoingGraphic)this._scheduledNextHandle=
null;else{this._scheduledNextHandle=null;var a=this._peek(),d=a.graphic,f=a.addOrUpdate,h=m.createAbortController();this._queue.delete(d);this._onGoingGraphic=a;this._onGoingPromise=this.process(d,f,{signal:h.signal});this._ongoingAbortController=h;this._onGoingPromise.then(this._finalize,this._finalize);this.notifyChange("updating")}};d.prototype._peek=function(){return 0===this._queueArray.length?null:this._queueArray.pop()};h.__decorate([f.property({readOnly:!0})],d.prototype,"length",null);h.__decorate([f.property({readOnly:!0})],
d.prototype,"updating",null);h.__decorate([f.property({constructOnly:!0})],d.prototype,"process",void 0);return d=h.__decorate([f.subclass("esri.views.2d.layers.graphics.GraphicProcessingQueue")],d)}(p);a.default=v})},"esri/views/2d/layers/graphics/GraphicStore":function(){define("require exports tslib ../../../../core/has ../../../../core/screenUtils ../../../../core/unitUtils ../../../../core/libs/rbush/rbush ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/contains ../../../../geometry/support/extentUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtils ./GraphicStoreItem ./graphicsUtils".split(" "),
function(v,a,h,p,m,r,f,l,d,k,t,w,u,b){function g(b,a,d,e,g){c.minX=a;c.minY=d;c.maxX=e;c.maxY=g;return b.search(c)}Object.defineProperty(a,"__esModule",{value:!0});var c={minX:0,minY:0,maxX:0,maxY:0},y=l.create(),e=[];v=function(){function a(b,a,c,d,e,g){this._graphics=d;this._onAdd=e;this._onRemove=g;this._index=f(9,p("csp-restrictions")?function(b){return{minX:b.bounds[0],minY:b.bounds[1],maxX:b.bounds[2],maxY:b.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]);this._itemByGraphic=
new Map;this._currentLevel=-Infinity;this._tileInfoView=b;this._uidFieldName=c;if(a=b.getClosestInfoForScale(a))this._currentLevel=a.level,this._resolution=this._tileInfoView.getTileResolution(a.level);this._metersPerUnit=r.getMetersPerUnit(b.spatialReference)}a.prototype.hitTest=function(a,c,e,f,h){a=w.normalizeMapX(a,this._tileInfoView.spatialReference);var n=.5*f*e;y[0]=a-n;y[1]=c-n;y[2]=a+n;y[3]=c+n;e=.5*f*(e+50);e=g(this._index,a-e,c-e,a+e,c+e);if(!e||0===e.length)return[];for(var n={x:a,y:c},
p=[],u,r=0;r<e.length;r++){var x=e[r];if(x.graphic.visible)switch(t.getJsonType(x.geometry)){case "esriGeometryPoint":u=x.symbol;if(!u)continue;var z=x.geometry,q=void 0;switch(u.type){case "text":q=b.getTextSymbolBounds(z.x,z.y,u,x.size,f,h);break;case "cim":case "expanded-cim":q=b.getCIMMarkerBounds(z.x,z.y,u,f,f*this._metersPerUnit,h);break;default:q=b.getMarkerSymbolBounds(z.x,z.y,u,f,f*this._metersPerUnit,h)}d.polygonContainsPoint(q,n)&&p.push(x);break;case "esriGeometryPolyline":u=x.symbol;
if(!u)continue;u=1.5*f*window.devicePixelRatio*m.pt2px(u.width);b.isPointOnPolyline(x.geometry,a,c,u)&&p.push(x);break;case "esriGeometryEnvelope":u=x.geometry;u=l.fromValues(u.xmin,u.ymin,u.xmax,u.ymax);l.intersects(u,y)&&p.push(x);break;case "esriGeometryPolygon":if(d.polygonContainsPoint(x.geometry,n)){p.push(x);break}u=k.getPolygonExtent(x.geometry);if(Math.abs(u.ymax-u.ymin)<5*f||Math.abs(u.xmax-u.xmin)<5*f)u=l.fromValues(u.xmin,u.ymin,u.xmax,u.ymax),l.intersects(u,y)&&p.push(x);break;case "esriGeometryMultipoint":if(u=
x.symbol)for(var z=x.geometry.points,q=void 0,v=0;v<z.length;v++)if(q="text"===u.type?b.getTextSymbolBounds(z[v][0],z[v][1],u,x.size,f,h):b.getMarkerSymbolBounds(z[v][0],z[v][1],u,f,f*this._metersPerUnit,h),d.polygonContainsPoint(q,n)){p.push(x);break}}}p.sort(function(a,c){var d=b.graphicGeometryToNumber(a.graphic),e=b.graphicGeometryToNumber(c.graphic);return d===e?c.zorder-a.zorder:d-e});return p.map(function(b){return b.graphic})};a.prototype.getGraphicsData=function(b,a,c){var d=g(this._index,
a.bounds[0],a.bounds[1],a.bounds[2],a.bounds[3]);if(0===d.length||0===c.length)return[];d.sort(function(b,a){return b.zorder-a.zorder});d[0].insertAfter=-1;for(var e=1;e<d.length;e++)d[e].insertAfter=d[e-1].graphic.uid;d.sort(function(b,a){return b.graphic.uid-a.graphic.uid});c.sort(function(b,a){return b.uid-a.uid});var f=e=0,k,l=[];a={originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[a.bounds[0],a.bounds[3]]};for(var n=0;n<c.length;n++){for(var m=c[n],f=-2;e<d.length;)if(k=
d[e],e++,m.uid===k.graphic.uid){f=k.insertAfter;break}if(k.geometry&&-2!==f){var t=k.getGeometryQuantized(a),p=h.__assign({},k.graphic.attributes);p[this._uidFieldName]=m.uid;null==k.groupId&&(k.groupId=b.createTemplateGroup(k.symbol,null,null));l.push({centroid:u.default.getCentroidQuantized(k,a),geometry:t,attributes:p,symbol:k.symbol,groupId:k.groupId,insertAfter:f})}}return l};a.prototype.getGraphicData=function(b,a,c){var d=this._itemByGraphic.get(c);if(!d)return null;var e=g(this._index,a.bounds[0],
a.bounds[1],a.bounds[2],a.bounds[3]);e.sort(function(b,a){return b.zorder-a.zorder});var f=e.indexOf(d),e=0===f||-1===f?-1:e[f-1].graphic.uid;a={originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[a.bounds[0],a.bounds[3]]};var f=d.getGeometryQuantized(a),k=h.__assign({},d.graphic.attributes);k[this._uidFieldName]=c.uid;null==d.groupId&&(d.groupId=b.createTemplateGroup(d.symbol,null,null));return{centroid:u.default.getCentroidQuantized(d,a),geometry:f,attributes:k,symbol:d.symbol,
groupId:d.groupId,insertAfter:e}};a.prototype.queryTileData=function(b,a){var c=l.pad(a.bounds,50*a.resolution,l.create()),c=g(this._index,c[0],c[1],c[2],c[3]),d=[];this._createTileGraphics(d,b,c,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[a.bounds[0],a.bounds[3]]});return d};a.prototype.has=function(b){return this._itemByGraphic.has(b)};a.prototype.getBounds=function(b){return this._itemByGraphic.has(b)?this._itemByGraphic.get(b).bounds:null};a.prototype.add=function(b,
a,c){if(b)return this._onAdd(b),a=u.default.acquire(b,a,c,this._resolution,this._resolution*this._metersPerUnit,this._tileInfoView.spatialReference),this._itemByGraphic.set(b,a),c&&this._index.insert(a),a.bounds};a.prototype.remove=function(b){if(this._itemByGraphic.has(b)){this._onRemove(b);var a=this._itemByGraphic.get(b);this._index.remove(a);this._itemByGraphic.delete(b)}};a.prototype.updateZ=function(){for(var b=this._graphics.items,a,c=0;c<b.length;c++)if(a=b[c],a=this._itemByGraphic.get(a))a.zorder=
c};a.prototype.update=function(b,a,c){var d=this._itemByGraphic.get(b);d.groupId=null;var e=l.clone(d.bounds);d.size[0]=d.size[1]=0;this._index.remove(d);d.set(b,a,c,this._resolution,this._resolution*this._metersPerUnit,this._tileInfoView.spatialReference);c&&this._index.insert(d);return{oldBounds:e,newBounds:d.bounds}};a.prototype.updateLevel=function(b){var a=this;this._currentLevel!==b&&(this._currentLevel=b,this._resolution=this._tileInfoView.getTileResolution(b),this._index.clear(),e.length=
0,this._itemByGraphic.forEach(function(b){b.updateBounds(a._resolution,a._resolution*a._metersPerUnit,a._tileInfoView.spatialReference);b.geometry&&e.push(b)}),this._index.load(e))};a.prototype.clear=function(){this._itemByGraphic.clear();this._index.clear()};a.prototype._createTileGraphics=function(b,a,c,d){var e=this._uidFieldName;c.sort(function(b,a){return b.zorder-a.zorder});for(var g,f,k,l,n=0;n<c.length;n++){k=c[n];g=k.graphic;f=k.getGeometryQuantized(d);l=0===n?-1:c[n-1].graphic.uid;var m=
h.__assign({},k.graphic.attributes);m[e]=g.uid;null==k.groupId&&(k.groupId=a.createTemplateGroup(k.symbol,null,null));b.push({centroid:u.default.getCentroidQuantized(k,d),geometry:f,attributes:m,symbol:k.symbol,groupId:k.groupId,insertAfter:l})}};return a}();a.default=v})},"esri/views/2d/layers/graphics/GraphicStoreItem":function(){define("require exports ../../../../core/maybe ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/centroid ../../../../geometry/support/jsonUtils ../../../../geometry/support/quantizationUtils ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./graphicsUtils".split(" "),
function(v,a,h,p,m,r,f,l,d,k){Object.defineProperty(a,"__esModule",{value:!0});var t=new d.default,w=new d.default;v=function(){function a(){this.bounds=p.create();this.graphic=null;this.size=[0,0,0,0]}a.acquire=function(b,d,c,f,e,h){void 0===b&&(b=null);var g;0===a._pool.length?g=new a:(g=a._pool.pop(),this._set.delete(g));g.acquire(b,d,c,f,e,h);return g};a.release=function(b){b&&!this._set.has(b)&&(b.release(),this._pool.push(b),this._set.add(b))};a.getCentroidQuantized=function(b,a){if(r.isPolygon(b.geometry)){var c=
b.symbol;if(h.isNone(c))return null;if(k.isMarkerSymbol(c.type))return b=m.polygonCentroid(b.geometry),f.quantizePoint(a,{},{x:b[0],y:b[1]},!1,!1)}return null};a.prototype.acquire=function(b,a,c,d,e,f){void 0===b&&(b=null);b&&this.set(b,a,c,d,e,f)};a.prototype.release=function(){this.geometry=this.symbolResource=this.graphic=null};Object.defineProperty(a.prototype,"symbol",{get:function(){return this.symbolResource.symbol},enumerable:!0,configurable:!0});a.prototype.set=function(b,a,c,d,e,f){this.graphic=
b;this.geometry=c;this.symbolResource=a;this.updateBounds(d,e,f)};a.prototype.updateBounds=function(b,a,c){k.getBounds(this.bounds,this.size,this.symbolResource,this.geometry,b,a,c)};a.prototype.getGeometryQuantized=function(b){if(r.isPolygon(this.geometry)){var a=this.geometry.rings;if(1===a.length&&2===a[0].length)return f.quantizeGeometry(b,{paths:[[a[0][0],a[0][1]]]})}else if(r.isPolyline(this.geometry))return t.coords.length=0,t.lengths.length=0,w.coords.length=0,w.lengths.length=0,l.convertFromPolyline(t,
this.geometry),l.generalizeOptimizedGeometry(w,t,this.geometry.hasZ,this.geometry.hasM,"esriGeometryPolyline",b.scale[0]),l.quantizeOptimizedGeometry(t,w,this.geometry.hasZ,this.geometry.hasM,"esriGeometryPolyline",b),l.convertToPolyline(t,this.geometry.hasZ,this.geometry.hasM);return f.quantizeGeometry(b,this.geometry)};a._pool=[];a._set=new Set;return a}();a.default=v})},"esri/views/2d/layers/graphics/graphicsUtils":function(){define("require exports ../../../../core/maybe ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/mat2d ../../../../core/libs/gl-matrix-2/mat2df32 ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ../../../../geometry/SpatialReference ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/boundsUtils ../../../../geometry/support/intersects ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtils ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/support/spatialReferenceUtils ../../engine ../../engine".split(" "),
function(v,a,h,p,m,r,f,l,d,k,t,w,u,b,g,c,y,e){function n(b,a,c,d,e,g){var h,k,l=p.pt2px(c.xoffset),n=p.pt2px(c.yoffset),t=q*c.angle;g*=q;switch(c.type){case "simple-marker":h=k=p.pt2px(c.size);break;case "picture-marker":h=p.pt2px(c.width),k=p.pt2px(c.height)}.04>e&&(d=.04*d/e);c=m.mat2d.identity(K);m.mat2d.translate(c,c,f.vec2.set(B,b,a));m.mat2d.rotate(c,c,g-t);m.mat2d.scale(c,c,f.vec2.set(B,d,-d));m.mat2d.translate(c,c,f.vec2.set(B,l,-n));b=[0,0];f.vec2.transformMat2d(b,f.vec2.set(B,-.5*h,-.5*
k),c);a=[0,0];f.vec2.transformMat2d(a,f.vec2.set(B,-.5*h,.5*k),c);d=[0,0];f.vec2.transformMat2d(d,f.vec2.set(B,.5*h,-.5*k),c);l=[0,0];f.vec2.transformMat2d(l,f.vec2.set(B,.5*h,.5*k),c);return{rings:[[b,d,l,a,b]]}}function z(b,a,c,d,e,g){var h=y.CIMSymbolHelper.getEnvelope(c.data);if(!h)return null;.04>e&&(d=.04*d/e);e=p.pt2px(h.width);var k=p.pt2px(h.height);c=p.pt2px(h.x);var h=p.pt2px(h.y),l=0*q,n=q*g;g=m.mat2d.identity(K);m.mat2d.translate(g,g,f.vec2.set(B,b,a));m.mat2d.rotate(g,g,n-l);m.mat2d.scale(g,
g,f.vec2.set(B,d,d));b=[0,0];f.vec2.transformMat2d(b,f.vec2.set(B,c,h+k),g);a=[0,0];f.vec2.transformMat2d(a,f.vec2.set(B,c,h),g);d=[0,0];f.vec2.transformMat2d(d,f.vec2.set(B,c+e,h+k),g);k=[0,0];f.vec2.transformMat2d(k,f.vec2.set(B,c+e,h),g);return{rings:[[b,d,k,a,b]]}}function x(b,a,c,d,e,g){var h=p.pt2px(c.xoffset),k=p.pt2px(c.yoffset);c=q*c.angle;var l=q*g;g=m.mat2d.identity(K);m.mat2d.translate(g,g,f.vec2.set(B,b,a));m.mat2d.rotate(g,g,l);m.mat2d.scale(g,g,f.vec2.set(B,e,-e));b=d[0]+d[2]/2;a=d[1]+
d[3]/2;m.mat2d.translate(g,g,f.vec2.set(B,h,-k));m.mat2d.translate(g,g,f.vec2.set(B,b,a));m.mat2d.rotate(g,g,c);m.mat2d.translate(g,g,f.vec2.set(B,-b,-a));h=[0,0];f.vec2.transformMat2d(h,f.vec2.set(B,d[0],d[1]),g);k=[0,0];f.vec2.transformMat2d(k,f.vec2.set(B,d[0],d[1]+d[3]),g);c=[0,0];f.vec2.transformMat2d(c,f.vec2.set(B,d[0]+d[2],d[1]),g);b=[0,0];f.vec2.transformMat2d(b,f.vec2.set(B,d[0]+d[2],d[1]+d[3]),g);return{rings:[[h,c,b,k,h]]}}function C(b,a,c){if(!c||0===c.glyphMosaicItems.length)return b;
var d=y.bidiText(a.text)[1];a=e.shapeGlyphs(c.glyphMosaicItems,d,{scale:p.pt2px(a.font.size)/24,angle:a.angle,xOffset:a.xoffset,yOffset:a.yoffset,hAlign:e.alignmentUtils.getXAnchorDirection(a.horizontalAlignment||"center"),vAlign:e.alignmentUtils.getYAnchorDirection(a.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,Math.min(a.lineWidth||512,512)),lineHeight:30*Math.max(.25,Math.min(a.lineHeight||1,4)),decoration:a.font.decoration||"none",isCIM:!1}).bounds;b[0]=a.x-a.halfWidth;b[1]=a.y-a.halfHeight;
b[2]=a.width;b[3]=a.height;return b}function A(b,a){return Math.ceil((b-a)/(2*a))}function I(b,a){var c;c=u.isPolygon(b)?b.rings:b.paths;for(var d=0;d<c.length;d++)for(var e=0,g=c[d];e<g.length;e++)g[e][0]+=a;return b}function F(b,a){if(!a)return b;var c=J(b,a).map(function(b){return b.extent});return 2>c.length?c[0]||b:2<c.length?(b.xmin=a.valid[0],b.xmax=a.valid[1],b):{rings:c.map(function(b){return[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]})}}function J(b,
a){var c=[],d=b.ymin,e=b.ymax,g=b.xmax-b.xmin,f=b.xmin,h=b.xmax,k,l=a.valid,n=l[0],m=l[1];k=H(b.xmin,a);var t=k.x,l=k.frameId;k=H(b.xmax,a);a=k.x;b=k.frameId;k=t===a&&0<g;if(g>2*m){g={xmin:f<h?t:a,ymin:d,xmax:m,ymax:e};f={xmin:n,ymin:d,xmax:f<h?a:t,ymax:e};h={xmin:0,ymin:d,xmax:m,ymax:e};d={xmin:n,ymin:d,xmax:0,ymax:e};e=[];n=[];G(g,h)&&e.push(l);G(g,d)&&n.push(l);G(f,h)&&e.push(b);G(f,d)&&n.push(b);for(m=l+1;m<b;m++)e.push(m),n.push(m);c.push({extent:g,frameIds:[l]},{extent:f,frameIds:[b]},{extent:h,
frameIds:e},{extent:d,frameIds:n})}else t>a||k?c.push({extent:{xmin:t,ymin:d,xmax:m,ymax:e},frameIds:[l]},{extent:{xmin:n,ymin:d,xmax:a,ymax:e},frameIds:[b]}):c.push({extent:{xmin:t,ymin:d,xmax:a,ymax:e},frameIds:[l]});return c}function H(b,a){var c=a.valid;a=c[0];var d=c[1],c=2*d,e=0;b>d?(a=Math.ceil(Math.abs(b-d)/c),b-=a*c,e=a):b<a&&(a=Math.ceil(Math.abs(b-a)/c),b+=a*c,e=-a);return{x:b,frameId:e}}function G(b,a){var c=a.xmin,d=a.ymin,e=a.xmax;a=a.ymax;return D(b,c,d)&&D(b,c,a)&&D(b,e,a)&&D(b,e,
d)}function D(b,a,c){return a>=b.xmin&&a<=b.xmax&&c>=b.ymin&&c<=b.ymax?!0:!1}function E(b,a,c){if(Array.isArray(b)){var d=b[0];if(d>a){var e=A(d,a);b[0]=d+-2*e*a}else d<c&&(e=A(d,c),b[0]=d+-2*e*c)}else d=b.x,d>a?(e=A(d,a),b.x+=-2*e*a):d<c&&(e=A(d,c),b.x+=-2*e*c);return b}Object.defineProperty(a,"__esModule",{value:!0});var q=Math.PI/180,K=r.mat2df32.create(),B=l.vec2f32.create(),L=k.create();a.getBounds=function(a,d,e,g,f,h,k){if(!g||!e.symbol)return a[0]=a[1]=a[2]=a[3]=0,d[0]=d[1]=d[2]=d[3]=0,a;
if(u.isPoint(g)){var l=g.x;g=g.y;"text"===e.symbol.type&&0===d[2]&&0===d[3]&&C(d,e.symbol,e.mosaicItem);e=e.symbol;var m;switch(e.type){case "simple-marker":case "picture-marker":m=n(l,g,e,f,h,0);break;case "text":m=x(l,g,e,d,f,0);break;case "cim":case "expanded-cim":m=z(l,g,e,f,h,0)}for(f=d=0;f<m.rings[0].length-1;f++)e=m.rings[0][f],e=(l-e[0])*(l-e[0])+(g-e[1])*(g-e[1]),d=Math.max(d,e);d=Math.sqrt(d);f=b.normalizeMapX(l-d,k);l=b.normalizeMapX(l+d,k);f>l&&(k=c.getInfo(k))&&(f=k.valid,k=f[1],f=f[0],
l=k);a[0]=f;a[1]=g-d;a[2]=l;a[3]=g+d}else{t.getBoundsXY(a,g);g=d[0];if(0===g){a:switch(g=0,e.symbol.type){case "simple-fill":case "picture-fill":g=e.symbol.outline;if(!g){g=0;break a}g=g.width;break;case "simple-line":g=e.symbol.width;break;case "simple-marker":g=e.symbol.size;break;case "picture-marker":g=Math.max(e.symbol.width,e.symbol.height);break;case "text":g=[0,0,0,0];C(g,e.symbol,e.mosaicItem);g=Math.max(g[2],g[3])+Math.max(Math.abs(g[0]),Math.abs(g[1]));break;case "cim":case "expanded-cim":g=
y.CIMSymbolHelper.getEnvelope(e.symbol.data),g=Math.sqrt(g.width*g.width+g.height*g.height)}d[0]=g}g=f*g/2;a[0]-=g;a[1]-=g;a[2]+=g;a[3]+=g}return a};a.isMarkerSymbol=function(b){return"simple-marker"===b||"picture-marker"===b||"text"===b};a.graphicGeometryToNumber=function(b){switch(h.unwrap(b.geometry).type){case "polyline":return 1;case "polygon":case "extent":return 2}return 0};var O=l.vec2f32.create(),S=l.vec2f32.create(),R=l.vec2f32.create(),M=l.vec2f32.create(),P=l.vec2f32.create(),T=l.vec2f32.create(),
Q=l.vec2f32.create();a.isPointOnPolyline=function(b,a,c,d){f.vec2.set(R,a,c);b=b.paths;for(var e,g,h,k,l,n,m,t,p=Infinity,u=0;u<b.length;u++){var w=b[u];if(!(2>w.length))for(var r=1;r<w.length;r++)e=w[r-1][0],h=w[r-1][1],g=w[r][0],k=w[r][1],l=Math.min(e,g)-d,n=Math.min(h,k)-d,m=Math.max(e,g)+d,t=Math.max(h,k)+d,a<l||a>m||c<n||c>t||(f.vec2.set(O,e,h),f.vec2.set(S,g,k),f.vec2.subtract(M,S,O),f.vec2.subtract(P,O,R),f.vec2.scale(T,M,f.vec2.dot(M,P)/f.vec2.dot(M,M)),f.vec2.subtract(Q,P,T),e=f.vec2.dot(Q,
Q),p>e&&(p=e))}return Math.sqrt(p)<=d};a.getMarkerSymbolBounds=n;a.getCIMMarkerBounds=z;a.getTextSymbolBounds=x;a.normalizeCentralMeridian=function(b){var a,c,d,e,f,h=null;if(!b)return null;if("mesh"===b.type)return b.toJSON();a=b.spatialReference;c=g.getInfo(a);if(!c)return b.toJSON();f=a.isWebMercator?102100:4326;d=N[f].maxX;e=N[f].minX;a=N[f].plus180Line;f=N[f].minus180Line;var k,l=b.toJSON();u.isPoint(l)?k=E(l,d,e):u.isMultipoint(l)?(l.points=l.points.map(function(b){return E(b,d,e)}),k=l):u.isExtent(l)?
k=F(l,c):u.isPolygon(l)||u.isPolyline(l)?(t.getBoundsXY(L,l),b={xmin:L[0],ymin:L[1],xmax:L[2],ymax:L[3]},c=2*A(b.xmin,e)*d,l=0===c?l:I(l,c),b.xmin+=c,b.xmax+=c,w.extentIntersectsPolyline(b,a)&&b.xmax!==d?h=l:w.extentIntersectsPolyline(b,f)&&b.xmin!==e?h=l:k=l):k=b.clone();return null!==h?(new U).cut(h,d):k};a.getTextSymbolSize=C;var N={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:{paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],
spatialReference:d.WebMercator},minus180Line:{paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:d.WebMercator}},4326:{maxX:180,minX:-180,plus180Line:{paths:[[[180,-180],[180,180]]],spatialReference:d.WGS84},minus180Line:{paths:[[[-180,-180],[-180,180]]],spatialReference:d.WGS84}}},U=function(){function b(){}b.prototype.cut=function(b,a){var c;if(b.rings)this.closed=!0,c=b.rings,this.minPts=4;else if(b.paths)this.closed=!1,c=b.paths,
this.minPts=2;else return null;var d=c.length;a*=-2;for(var e=0;e<d;e++){var g=c[e];if(g&&g.length>=this.minPts){for(var f=[],h=0;h<g.length;h++){var k=g[h];f.push([k[0]+a,k[1]])}c.push(f)}}this.closed?b.rings=c:b.paths=c;return b};return b}()})},"esri/views/layers/GraphicsView":function(){define(["require","exports","tslib","../../core/accessorSupport/decorators"],function(v,a,h,p){Object.defineProperty(a,"__esModule",{value:!0});a.GraphicsView=function(a){return function(a){function f(){var f=null!==
a&&a.apply(this,arguments)||this;f.graphics=null;f.renderer=null;f.view=null;return f}h.__extends(f,a);h.__decorate([p.property()],f.prototype,"graphics",void 0);h.__decorate([p.property()],f.prototype,"renderer",void 0);h.__decorate([p.property()],f.prototype,"updating",void 0);h.__decorate([p.property()],f.prototype,"view",void 0);return f=h.__decorate([p.subclass("esri.views.layers.GraphicsView")],f)}(a)}})},"esri/views/2d/navigation/MapViewNavigation":function(){define("require exports tslib ../../../Viewpoint ../../../core/Accessor ../../../core/accessorSupport/decorators ../../../geometry/Point ../viewpointUtils ./ZoomBox ./actions/Pan ./actions/Pinch ./actions/Rotate".split(" "),
function(v,a,h,p,m,r,f,l,d,k,t,w){Object.defineProperty(a,"__esModule",{value:!0});var u=new p({targetGeometry:new f}),b=[0,0];v=function(a){function c(b){b=a.call(this,b)||this;b._endTimer=null;b.animationManager=null;return b}h.__extends(c,a);c.prototype.initialize=function(){this.pan=new k({navigation:this});this.rotate=new w({navigation:this});this.pinch=new t({navigation:this});this.zoomBox=new d({view:this.view,navigation:this})};c.prototype.destroy=function(){this.zoomBox.destroy();this.animationManager=
this.zoomBox=null};c.prototype.begin=function(){this._set("interacting",!0)};c.prototype.end=function(){this._lastEventTimestamp=performance.now();this._startTimer(250)};c.prototype.zoom=function(b,a){void 0===a&&(a=this._getDefaultAnchor());return h.__awaiter(this,void 0,void 0,function(){return h.__generator(this,function(c){this.stop();this.begin();if(this.view.constraints.snapToZoom&&this.view.constraints.effectiveLODs)return 1>b?[2,this.zoomIn(a)]:[2,this.zoomOut(a)];this.setViewpoint(a,b,0,
[0,0]);return[2]})})};c.prototype.zoomIn=function(b){return h.__awaiter(this,void 0,void 0,function(){var a,c;return h.__generator(this,function(d){a=this.view;c=a.constraints.snapToNextScale(a.scale);return[2,this._zoomToScale(c,b)]})})};c.prototype.zoomOut=function(b){return h.__awaiter(this,void 0,void 0,function(){var a,c;return h.__generator(this,function(d){a=this.view;c=a.constraints.snapToPreviousScale(a.scale);return[2,this._zoomToScale(c,b)]})})};c.prototype.setViewpoint=function(b,a,c,
d){this.begin();this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,b,a,c,d);this.end()};c.prototype.setViewpointImmediate=function(b,a,c,d){void 0===a&&(a=0);void 0===c&&(c=[0,0]);void 0===d&&(d=this._getDefaultAnchor());this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,d,b,a,c)};c.prototype.continousRotateClockwise=function(){var b=this.get("view.viewpoint");this.animationManager.animateContinous(b,function(b){l.rotateBy(b,b,-1)})};c.prototype.continousRotateCounterclockwise=
function(){var b=this.get("view.viewpoint");this.animationManager.animateContinous(b,function(b){l.rotateBy(b,b,1)})};c.prototype.resetRotation=function(){this.view.rotation=0};c.prototype.continousPanLeft=function(){var b=this.get("view.viewpoint");this.animationManager.animateContinous(b,function(b){l.translateBy(b,b,[-10,0])})};c.prototype.continousPanRight=function(){var b=this.get("view.viewpoint");this.animationManager.animateContinous(b,function(b){l.translateBy(b,b,[10,0])})};c.prototype.continousPanUp=
function(){var b=this.get("view.viewpoint");this.animationManager.animateContinous(b,function(b){l.translateBy(b,b,[0,10])})};c.prototype.continousPanDown=function(){var b=this.get("view.viewpoint");this.animationManager.animateContinous(b,function(b){l.translateBy(b,b,[0,-10])})};c.prototype.stop=function(){this.pan.stopMomentumNavigation();this.animationManager.stop();this.end();null!==this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=null,this._set("interacting",!1))};c.prototype._startTimer=
function(b){var a=this;return null!==this._endTimer?this._endTimer:this._endTimer=setTimeout(function(){a._endTimer=null;var b=performance.now()-a._lastEventTimestamp;250>b?a._endTimer=a._startTimer(b):a._set("interacting",!1)},b)};c.prototype._getDefaultAnchor=function(){var a=this.view,c=a.size,a=a.padding,d=a.top,g=a.bottom;b[0]=.5*(c[0]-a.right+a.left);b[1]=.5*(c[1]-g+d);return b};c.prototype._zoomToScale=function(b,a){void 0===a&&(a=this._getDefaultAnchor());return h.__awaiter(this,void 0,void 0,
function(){var c,d,e,g,f,k,m,t;return h.__generator(this,function(h){c=this.view;d=c.constraints;e=c.scale;g=c.viewpoint;f=c.size;k=c.padding;m=d.canZoomInTo(b);t=d.canZoomOutTo(b);return b<e&&!m||b>e&&!t?[2]:[2,c.goTo(l.padAndScaleAndRotateBy(u,g,b/e,0,a,f,k),{animate:!0})]})})};c.prototype._scaleRotateTranslateViewpoint=function(b,a,c,d,g){var e=this.view,f=e.size,h=e.padding,k=e.constraints,n=e.viewpoint,m=e.scale*c,e=k.canZoomInTo(m),k=k.canZoomOutTo(m);if(1>c&&!e||1<c&&!k)c=1;l.translateBy(n,
n,g);return l.padAndScaleAndRotateBy(b,n,c,d,a,f,h)};h.__decorate([r.property()],c.prototype,"animationManager",void 0);h.__decorate([r.property({type:Boolean,readOnly:!0})],c.prototype,"interacting",void 0);h.__decorate([r.property()],c.prototype,"pan",void 0);h.__decorate([r.property()],c.prototype,"pinch",void 0);h.__decorate([r.property()],c.prototype,"rotate",void 0);h.__decorate([r.property()],c.prototype,"view",void 0);h.__decorate([r.property()],c.prototype,"zoomBox",void 0);return c=h.__decorate([r.subclass("esri.views.2d.navigation.MapViewNavigation")],
c)}(m);a.default=v})},"esri/views/2d/navigation/ZoomBox":function(){define("require exports tslib ../../../core/Accessor ../../../core/screenUtils ../../../core/accessorSupport/decorators".split(" "),function(v,a,h,p,m,r){return function(a){function f(d){d=a.call(this,d)||this;d._container=null;d._overlay=null;d._backgroundShape=null;d._boxShape=null;d._box={x:0,y:0,width:0,height:0};d._redraw=d._redraw.bind(d);return d}h.__extends(f,a);f.prototype.destroy=function(){this.view=null};Object.defineProperty(f.prototype,
"view",{set:function(a){var d=this;this._handles&&this._handles.forEach(function(a){a.remove()});this._handles=null;this._destroyOverlay();this._set("view",a);a&&(a.on("drag",["Shift"],function(a){return d._handleDrag(a,1)}),a.on("drag",["Shift","Ctrl"],function(a){return d._handleDrag(a,-1)}))},enumerable:!0,configurable:!0});f.prototype._start=function(){this._createContainer();this._createOverlay();this.navigation.begin()};f.prototype._update=function(a,f,h,l){this._box.x=a;this._box.y=f;this._box.width=
h;this._box.height=l;this._rafId||(this._rafId=requestAnimationFrame(this._redraw))};f.prototype._end=function(a,f,h,l,p){var b=this.view;a=b.toMap(m.createScreenPoint(a+.5*h,f+.5*l));h=Math.max(h/b.width,l/b.height);-1===p&&(h=1/h);this._destroyOverlay();this.navigation.end();b.goTo({center:a,scale:b.scale*h})};f.prototype._updateBox=function(a,f,h,l){var d=this._boxShape;d.setAttributeNS(null,"x",""+a);d.setAttributeNS(null,"y",""+f);d.setAttributeNS(null,"width",""+h);d.setAttributeNS(null,"height",
""+l);d.setAttributeNS(null,"class","esri-zoom-box__outline")};f.prototype._updateBackground=function(a,f,h,l){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(a,f,h,l,this.view.width,this.view.height))};f.prototype._createContainer=function(){var a=document.createElement("div");a.className="esri-zoom-box__container";this.view.root.appendChild(a);this._container=a};f.prototype._createOverlay=function(){var a=this.view.width,f=this.view.height,h=document.createElementNS("http://www.w3.org/2000/svg",
"path");h.setAttributeNS(null,"d","M 0 0 L "+a+" 0 L "+a+" "+f+" L 0 "+f+" Z");h.setAttributeNS(null,"class","esri-zoom-box__overlay-background");a=document.createElementNS("http://www.w3.org/2000/svg","rect");f=document.createElementNS("http://www.w3.org/2000/svg","svg");f.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");f.setAttributeNS(null,"class","esri-zoom-box__overlay");f.appendChild(h);f.appendChild(a);this._container.appendChild(f);this._backgroundShape=
h;this._boxShape=a;this._overlay=f};f.prototype._destroyOverlay=function(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container=this._backgroundShape=this._boxShape=this._overlay=null};f.prototype._toSVGPath=function(a,f,h,l,m,b){h=a+h;l=f+l;return"M 0 0 L "+m+" 0 L "+m+" "+b+" L 0 "+b+" ZM "+a+" "+f+" L "+a+" "+l+" L "+h+" "+l+" L "+h+" "+f+" Z"};f.prototype._handleDrag=function(a,f){var d=a.x,h=a.y,k=a.origin.x,b=a.origin.y,g;d>k?(g=
k,k=d-k):(g=d,k-=d);h>b?(d=b,h-=b):(d=h,h=b-h);switch(a.action){case "start":this._start();break;case "update":this._update(g,d,k,h);break;case "end":this._end(g,d,k,h,f)}a.stopPropagation()};f.prototype._redraw=function(){if(this._rafId&&(this._rafId=null,this._overlay)){var a=this._box,f=a.x,h=a.y,l=a.width,a=a.height;this._updateBox(f,h,l,a);this._updateBackground(f,h,l,a);this._rafId=requestAnimationFrame(this._redraw)}};h.__decorate([r.property()],f.prototype,"navigation",void 0);h.__decorate([r.property()],
f.prototype,"view",null);return f=h.__decorate([r.subclass("esri.views.2d.navigation.ZoomBox")],f)}(p)})},"esri/views/2d/navigation/actions/Pan":function(){define("require exports tslib ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/screenUtils ../../../../core/accessorSupport/decorators ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../viewpointUtils ../../../navigation/PanPlanarMomentumEstimator".split(" "),function(v,a,
h,p,m,r,f,l,d,k,t,w){return function(a){function b(b){var c=a.call(this,b)||this;c.animationTime=0;c.momentumEstimator=new w.PanPlanarMomentumEstimator(500,6,.92);c.momentum=null;c.tmpMomentum=k.vec3f64.create();c.momentumFinished=!1;c.viewpoint=new m({targetGeometry:new p.Point,scale:0,rotation:0});c.watch("momentumFinished",function(b){b&&c.navigation.stop()});return c}h.__extends(b,a);b.prototype.begin=function(b,a){this.navigation.begin();this.momentumEstimator.reset();this.addToEstimator(a);
this.previousDrag=a};b.prototype.update=function(b,a){this.addToEstimator(a);var c=a.center.x,d=a.center.y,g=this.previousDrag,c=g?g.center.x-c:-c,d=g?d-g.center.y:d;b.viewpoint=t.translateBy(this.viewpoint,b.viewpoint,[c||0,d||0]);this.previousDrag=a};b.prototype.end=function(b,a){this.addToEstimator(a);this.momentum=b.navigation.momentumEnabled?this.momentumEstimator.evaluateMomentum():null;this.animationTime=0;if(this.momentum)this.onAnimationUpdate(b);this.previousDrag=null;this.navigation.end()};
b.prototype.addToEstimator=function(b){var a=b.center.x,d=b.center.y,e=f.createScreenPointArray(-a,d),a=k.vec3f64.fromValues(-a,d,0);this.momentumEstimator.add(e,a,.001*b.timestamp)};b.prototype.onAnimationUpdate=function(b){var a=this;this.navigation.animationManager.animateContinous(b.viewpoint,function(c,e){a.momentumFinished=!a.momentum||a.momentum.isFinished(a.animationTime);e*=.001;if(!a.momentumFinished){var g=a.momentum.valueDelta(a.animationTime,e);d.vec3.scale(a.tmpMomentum,a.momentum.direction,
g);b.viewpoint=t.translateBy(c,c,a.tmpMomentum)}a.animationTime+=e})};b.prototype.stopMomentumNavigation=function(){this.momentum&&(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())};h.__decorate([l.property()],b.prototype,"momentumFinished",void 0);h.__decorate([l.property()],b.prototype,"viewpoint",void 0);h.__decorate([l.property()],b.prototype,"navigation",void 0);return b=h.__decorate([l.subclass("esri.views.2d.navigation.actions.Pan")],b)}(r)})},"esri/views/navigation/PanPlanarMomentumEstimator":function(){define("require exports tslib ../../core/libs/gl-matrix-2/vec3 ../../core/libs/gl-matrix-2/vec3f64 ./FilteredFiniteDifference ./Momentum".split(" "),
function(v,a,h,p,m,r,f){Object.defineProperty(a,"__esModule",{value:!0});var l=function(a){function d(d,f,h,b,g){d=a.call(this,d,f,h)||this;d.sceneVelocity=b;d.direction=g;return d}h.__extends(d,a);d.prototype.value=function(d){return a.prototype.valueFromInitialVelocity.call(this,this.sceneVelocity,d)};return d}(f.Momentum);a.PanPlanarMomentum=l;v=function(){function a(a,d,f){void 0===a&&(a=300);void 0===d&&(d=12);void 0===f&&(f=.84);this.minimumInitialVelocity=a;this.stopVelocity=d;this.friction=
f;this.enabled=!0;this.time=new r.FilteredFiniteDifference(.6);this.screen=[new r.FilteredFiniteDifference(.4),new r.FilteredFiniteDifference(.4)];this.scene=[new r.FilteredFiniteDifference(.6),new r.FilteredFiniteDifference(.6),new r.FilteredFiniteDifference(.6)];this.tmpDirection=m.vec3f64.create()}a.prototype.add=function(a,d,f){!this.enabled||this.time.hasLastValue&&.015>this.time.computeDelta(f)||(this.screen[0].update(a[0]),this.screen[1].update(a[1]),this.scene[0].update(d[0]),this.scene[1].update(d[1]),
this.scene[2].update(d[2]),this.time.update(f))};a.prototype.reset=function(){this.screen[0].reset();this.screen[1].reset();this.scene[0].reset();this.scene[1].reset();this.scene[2].reset();this.time.reset()};a.prototype.evaluateMomentum=function(){if(!this.enabled||!this.screen[0].hasFilteredDelta)return null;var a=this.screen[0].filteredDelta,d=this.screen[1].filteredDelta,a=Math.sqrt(a*a+d*d)/this.time.filteredDelta;return Math.abs(a)<this.minimumInitialVelocity?null:this.createMomentum(a,this.stopVelocity,
this.friction)};a.prototype.createMomentum=function(a,d,f){p.vec3.set(this.tmpDirection,this.scene[0].filteredDelta,this.scene[1].filteredDelta,this.scene[2].filteredDelta);var h=p.vec3.length(this.tmpDirection);0<h&&p.vec3.scale(this.tmpDirection,this.tmpDirection,1/h);return new l(a,d,f,h/this.time.filteredDelta,this.tmpDirection)};return a}();a.PanPlanarMomentumEstimator=v})},"esri/views/navigation/FilteredFiniteDifference":function(){define(["require","exports"],function(v,a){Object.defineProperty(a,
"__esModule",{value:!0});v=function(){function a(a){this.gain=a}a.prototype.update=function(a){if(this.hasLastValue){var h=this.computeDelta(a);this.updateDelta(h)}this.lastValue=a};a.prototype.reset=function(){this.filteredDelta=this.lastValue=void 0};Object.defineProperty(a.prototype,"hasLastValue",{get:function(){return void 0!==this.lastValue},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasFilteredDelta",{get:function(){return void 0!==this.filteredDelta},enumerable:!0,
configurable:!0});a.prototype.computeDelta=function(a){return a-this.lastValue};a.prototype.updateDelta=function(a){this.filteredDelta=this.hasFilteredDelta?(1-this.gain)*this.filteredDelta+this.gain*a:a};return a}();a.FilteredFiniteDifference=v})},"esri/views/navigation/Momentum":function(){define(["require","exports"],function(v,a){Object.defineProperty(a,"__esModule",{value:!0});v=function(){function a(a,h,r){this._initialVelocity=a;this._stopVelocity=h;this._friction=r;this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/
this._stopVelocity)/Math.log(1-this._friction))}Object.defineProperty(a.prototype,"duration",{get:function(){return this._duration},enumerable:!0,configurable:!0});a.prototype.isFinished=function(a){return a>this.duration};Object.defineProperty(a.prototype,"friction",{get:function(){return this._friction},enumerable:!0,configurable:!0});a.prototype.value=function(a){return this.valueFromInitialVelocity(this._initialVelocity,a)};a.prototype.valueDelta=function(a,h){var m=this.value(a);return this.value(a+
h)-m};a.prototype.valueFromInitialVelocity=function(a,h){h=Math.min(h,this.duration);var m=1-this.friction;return a*(Math.pow(m,h)-1)/Math.log(m)};return a}();a.Momentum=v})},"esri/views/2d/navigation/actions/Pinch":function(){define("require exports tslib ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/accessorSupport/decorators ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../viewpointUtils ../../../navigation/RotationMomentumEstimator ../../../navigation/ZoomMomentumEstimator".split(" "),
function(v,a,h,p,m,r,f,l,d,k,t,w){return function(a){function b(b){var c=a.call(this,b)||this;c._animationTime=0;c._momentumFinished=!1;c._rotationMomentumEstimator=new t.RotationMomentumEstimator(.6,.15,.95);c._rotationDirection=1;c._zoomDirection=1;c._zoomMomentumEstimator=new w.ZoomMomentumEstimator;c._zoomOnly=null;c.zoomMomentum=null;c.rotateMomentum=null;c.viewpoint=new m({targetGeometry:new p.Point,scale:0,rotation:0});c.watch("_momentumFinished",function(a){a&&c.navigation.stop()});return c}
h.__extends(b,a);b.prototype.begin=function(a,b){this.navigation.begin();this._rotationMomentumEstimator.reset();this._zoomMomentumEstimator.reset();this._zoomOnly=null;this._previousAngle=this._startAngle=b.angle;this._previousRadius=this._startRadius=b.radius;this._previousCenter=b.center;this._updateTimestamp=null;a.constraints.rotationEnabled&&this.addToRotateEstimator(0,b.timestamp);this.addToZoomEstimator(b,1)};b.prototype.update=function(a,b){null===this._updateTimestamp&&(this._updateTimestamp=
b.timestamp);var c=b.angle,d=b.radius,g=b.center,f=Math.abs(180*(c-this._startAngle)/Math.PI),h=Math.abs(d-this._startRadius),k=this._startRadius/d;if(this._previousRadius){var l=d/this._previousRadius,m=180*(c-this._previousAngle)/Math.PI;this._rotationDirection=0<=m?1:-1;this._zoomDirection=1<=l?1:-1;a.constraints.rotationEnabled?(null===this._zoomOnly&&200<b.timestamp-this._updateTimestamp&&(this._zoomOnly=0<h-f),null===this._zoomOnly||this._zoomOnly?m=0:this.addToRotateEstimator(c-this._startAngle,
b.timestamp)):m=0;this.addToZoomEstimator(b,k);this.navigation.setViewpoint([g.x,g.y],1/l,m,[this._previousCenter.x-g.x,g.y-this._previousCenter.y])}this._previousAngle=c;this._previousRadius=d;this._previousCenter=g};b.prototype.end=function(a){this.rotateMomentum=this._rotationMomentumEstimator.evaluateMomentum();this.zoomMomentum=this._zoomMomentumEstimator.evaluateMomentum();this._animationTime=0;if(this.rotateMomentum||this.zoomMomentum)this.onAnimationUpdate(a);this.navigation.end()};b.prototype.addToRotateEstimator=
function(a,b){this._rotationMomentumEstimator.add(a,.001*b)};b.prototype.addToZoomEstimator=function(a,b){this._zoomMomentumEstimator.add(b,.001*a.timestamp)};b.prototype.canZoomIn=function(a){var b=a.scale;a=a.constraints.effectiveMaxScale;return 0===a||b>a};b.prototype.canZoomOut=function(a){var b=a.scale;a=a.constraints.effectiveMinScale;return 0===a||b<a};b.prototype.onAnimationUpdate=function(a){var b=this;this.navigation.animationManager.animateContinous(a.viewpoint,function(c,e){var g=!b.canZoomIn(a)&&
1<b._zoomDirection||!b.canZoomOut(a)&&1>b._zoomDirection,f=!b.rotateMomentum||b.rotateMomentum.isFinished(b._animationTime),g=g||!b.zoomMomentum||b.zoomMomentum.isFinished(b._animationTime);e*=.001;b._momentumFinished=f&&g;if(!b._momentumFinished){var f=b.rotateMomentum?Math.abs(b.rotateMomentum.valueDelta(b._animationTime,e))*b._rotationDirection*180/Math.PI:0,g=b.zoomMomentum?Math.abs(b.zoomMomentum.valueDelta(b._animationTime,e)):1,h=d.vec2f64.create(),m=d.vec2f64.create();if(b._previousCenter){l.vec2.set(h,
b._previousCenter.x,b._previousCenter.y);k.getPaddingScreenTranslation(m,a.size,a.padding);l.vec2.add(h,h,m);var m=a.constraints,p=a.scale,t=p*g;1>g&&!m.canZoomInTo(t)?(g=p/m.effectiveMaxScale,b.zoomMomentum=null,b.rotateMomentum=null):1<g&&!m.canZoomOutTo(t)&&(g=p/m.effectiveMinScale,b.zoomMomentum=null,b.rotateMomentum=null);k.scaleAndRotateBy(c,a.viewpoint,g,f,h,a.size)}}b._animationTime+=e})};b.prototype.stopMomentumNavigation=function(){if(this.rotateMomentum||this.zoomMomentum)this.rotateMomentum&&
(this._rotationMomentumEstimator.reset(),this.rotateMomentum=null),this.zoomMomentum&&(this._zoomMomentumEstimator.reset(),this.zoomMomentum=null),this.navigation.stop()};h.__decorate([f.property()],b.prototype,"_momentumFinished",void 0);h.__decorate([f.property()],b.prototype,"viewpoint",void 0);h.__decorate([f.property()],b.prototype,"navigation",void 0);return b=h.__decorate([f.subclass("esri.views.2d.navigation.actions.Pinch")],b)}(r)})},"esri/views/navigation/RotationMomentumEstimator":function(){define(["require",
"exports","tslib","./MomentumEstimator"],function(v,a,h,p){Object.defineProperty(a,"__esModule",{value:!0});v=function(a){function m(f,h,d,k){void 0===f&&(f=3);void 0===h&&(h=.01);void 0===d&&(d=.95);void 0===k&&(k=12);return a.call(this,f,h,d,k)||this}h.__extends(m,a);m.prototype.add=function(f,h){if(this.value.hasLastValue){var d=this.value.lastValue;for(f-=d;f>Math.PI;)f-=2*Math.PI;for(;f<-Math.PI;)f+=2*Math.PI;f=d+f}a.prototype.add.call(this,f,h)};return m}(p.MomentumEstimator);a.RotationMomentumEstimator=
v})},"esri/views/navigation/MomentumEstimator":function(){define(["require","exports","../../core/mathUtils","./FilteredFiniteDifference","./Momentum"],function(v,a,h,p,m){Object.defineProperty(a,"__esModule",{value:!0});v=function(){function a(a,h,d,k){void 0===a&&(a=2.5);void 0===h&&(h=.01);void 0===d&&(d=.95);void 0===k&&(k=12);this.minimumInitialVelocity=a;this.stopVelocity=h;this.friction=d;this.maxVelocity=k;this.enabled=!0;this.value=new p.FilteredFiniteDifference(.8);this.time=new p.FilteredFiniteDifference(.3)}
a.prototype.add=function(a,h){if(this.enabled){if(this.time.hasLastValue){if(.01>this.time.computeDelta(h))return;if(this.value.hasFilteredDelta){var d=this.value.computeDelta(a);0>this.value.filteredDelta*d&&this.value.reset()}}this.time.update(h);this.value.update(a)}};a.prototype.reset=function(){this.value.reset();this.time.reset()};a.prototype.evaluateMomentum=function(){if(!this.enabled||!this.value.hasFilteredDelta)return null;var a=this.value.filteredDelta/this.time.filteredDelta,a=h.clamp(a,
-this.maxVelocity,this.maxVelocity);return Math.abs(a)<this.minimumInitialVelocity?null:this.createMomentum(a,this.stopVelocity,this.friction)};a.prototype.createMomentum=function(a,h,d){return new m.Momentum(a,h,d)};return a}();a.MomentumEstimator=v})},"esri/views/navigation/ZoomMomentumEstimator":function(){define(["require","exports","tslib","./Momentum","./MomentumEstimator"],function(v,a,h,p,m){Object.defineProperty(a,"__esModule",{value:!0});var r=function(a){function f(d,f,h){return a.call(this,
d,f,h)||this}h.__extends(f,a);f.prototype.value=function(d){d=a.prototype.value.call(this,d);return Math.exp(d)};f.prototype.valueDelta=function(d,f){var h=a.prototype.value.call(this,d);d=a.prototype.value.call(this,d+f);return Math.exp(d-h)};return f}(p.Momentum);a.ZoomMomentum=r;v=function(a){function f(d,f,h,l){void 0===d&&(d=2.5);void 0===f&&(f=.01);void 0===h&&(h=.95);void 0===l&&(l=12);return a.call(this,d,f,h,l)||this}h.__extends(f,a);f.prototype.add=function(d,f){a.prototype.add.call(this,
Math.log(d),f)};f.prototype.createMomentum=function(a,f,h){return new r(a,f,h)};return f}(m.MomentumEstimator);a.ZoomMomentumEstimator=v})},"esri/views/2d/navigation/actions/Rotate":function(){define("require exports tslib ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/accessorSupport/decorators ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../viewpointUtils".split(" "),function(v,a,h,p,m,r,f,l,d,k){var t=d.vec2f64.create(),
w=d.vec2f64.create();return function(a){function b(b){b=a.call(this,b)||this;b._previousCenter=d.vec2f64.create();b.viewpoint=new m({targetGeometry:new p.Point,scale:0,rotation:0});return b}h.__extends(b,a);b.prototype.begin=function(a,b){this.navigation.begin();l.vec2.set(this._previousCenter,b.center.x,b.center.y)};b.prototype.update=function(a,b){var c=a.state,d=c.size,c=c.padding;l.vec2.set(t,b.center.x,b.center.y);k.getAnchor(w,d,c);a.viewpoint=k.rotateBy(this.viewpoint,a.state.paddedViewState.viewpoint,
k.angleBetween(w,this._previousCenter,t));l.vec2.copy(this._previousCenter,t)};b.prototype.end=function(){this.navigation.end()};h.__decorate([f.property()],b.prototype,"viewpoint",void 0);h.__decorate([f.property()],b.prototype,"navigation",void 0);return b=h.__decorate([f.subclass("esri.views.2d.actions.Rotate")],b)}(r)})},"esri/views/2d/magnifier/MagnifierView2D":function(){define("require exports tslib ../../../assets ../../../core/promiseUtils ../../webgl ../engine".split(" "),function(v,a,h,
p,m,r,f){Object.defineProperty(a,"__esModule",{value:!0});var l=f.enums.WGLDrawPhase;v=function(a){function d(){var d=a.call(this)||this;d.visible=!1;return d}h.__extends(d,a);d.prototype.destroy=function(){this._readbackTexture&&(this._readbackTexture.dispose(),this._readbackTexture=null,this._maskTexture.dispose(),this._maskTexture=null,this._overlayTexture.dispose(),this._overlayTexture=null,this._vertexArrayObject.dispose(),this._vertexArrayObject=null,this._program.dispose(),this._resourcesPromise=
this._program=null)};Object.defineProperty(d.prototype,"magnifier",{get:function(){return this._magnifier},set:function(a){var d=this;this._magnifier=a;this._handle&&this._handle.remove();this._handle=a.watch("version",function(){d.visible=a.visible;d.requestRender()});this.visible=a.visible;this.requestRender()},enumerable:!0,configurable:!0});d.prototype.doRender=function(a){var d=this.stage.context;if(!this._resourcesPromise)this._resourcesPromise=this._loadResources("esri/images/magnifier/mask.png",
"esri/images/magnifier/overlay.png");else if(a.drawPhase===l.MAP&&this._canRender()){this._updateResources(d);var f=this._magnifier,b=1/f.factor,g=Math.ceil(b*this.overlay.width),c=Math.ceil(b*this.overlay.height),h=a.state.size,e=a.pixelRatio,b=e*h[0];a=e*h[1];var k=f.position||{x:.5*h[0],y:.5*h[1]},h=e*k.x,e=a-e*k.y,k=.5*g,m=.5*c;k>h?h=k:h>=b-k&&(h=b-k-1);m>e?e=m:e>=a-m&&(e=a-m-1);var k=h-k,m=e-m,p=this._readbackTexture;d.bindTexture(p,0);d.gl.copyTexImage2D(p.descriptor.target,0,p.descriptor.pixelFormat,
k,m,g,c,0);g=(g=this.stage.background&&this.stage.background.color)?[g.a*g.r/255,g.a*g.g/255,g.a*g.b/255,g.a]:[1,1,1,1];c=-1+(h+f.offsetX)/b*2;f=-1+(e-f.offsetY)/a*2;b=this.overlay.width/b*2;a=this.overlay.height/a*2;h=this._program;d.bindVAO(this._vertexArrayObject);d.bindTexture(this._overlayTexture,6);d.bindTexture(this._maskTexture,7);d.bindProgram(h);h.setUniform4fv("u_background",g);h.setUniform1i("u_readbackTexture",0);h.setUniform1i("u_overlyTexture",6);h.setUniform1i("u_maskTexture",7);h.setUniform2f("u_drawPos",
c,f);h.setUniform1f("u_width",b);h.setUniform1f("u_height",a);d.setStencilTestEnabled(!1);d.drawArrays(5,0,4);d.bindVAO()}};d.prototype._canRender=function(){return this.mask&&this.overlay&&null!=this._magnifier};d.prototype._loadResources=function(a,d){return h.__awaiter(this,void 0,void 0,function(){var f,b,g;return h.__generator(this,function(c){switch(c.label){case 0:return[4,m.all([p.fetchAsset(a,{responseType:"image"}),p.fetchAsset(d,{responseType:"image"})])];case 1:return f=c.sent(),b=f[0].data,
g=f[1].data,this.mask=b,this.overlay=g,this.requestRender(),[2]}})})};d.prototype._updateResources=function(a){if(!this._readbackTexture){var d=1/this._magnifier.factor,h=Math.ceil(d*this.overlay.width),d=Math.ceil(d*this.overlay.height);this._program=f.createMagnifierProgram(a);var b=new Uint16Array([0,1,0,0,1,1,1,0]);this._vertexArrayObject=new r.VertexArrayObject(a,f.magnifier.attributes,{geometry:[{name:"a_pos",count:2,type:5123,offset:0,stride:4,normalized:!1,divisor:0}]},{geometry:r.BufferObject.createVertex(a,
35044,b)});this._overlayTexture=new r.Texture(a,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0},this.overlay);this._maskTexture=new r.Texture(a,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0},this.mask);this._readbackTexture=new r.Texture(a,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:h,height:d})}};return d}(f.DisplayObject);
a.default=v})},"*noref":1}});define("require exports ./LabelManager ./layers/graphics/GraphicsView2D ./navigation/MapViewNavigation ./magnifier/MagnifierView2D".split(" "),function(v,a,h,p,m,r){Object.defineProperty(a,"__esModule",{value:!0});a.LabelManager=h.default;a.GraphicsView2D=p.default;a.MapViewNavigation=m.default;a.MagnifierView2D=r.default});