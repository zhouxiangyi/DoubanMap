// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../../Viewpoint ../../../core/Accessor ../../../core/accessorSupport/decorators ../../../geometry/Point ../viewpointUtils ./ZoomBox ./actions/Pan ./actions/Pinch ./actions/Rotate".split(" "),function(f,p,d,r,t,e,u,g,v,w,x,y){Object.defineProperty(p,"__esModule",{value:!0});var z=new r({targetGeometry:new u}),k=[0,0];f=function(f){function a(b){b=f.call(this,b)||this;b._endTimer=null;b.animationManager=null;return b}d.__extends(a,f);a.prototype.initialize=function(){this.pan=
new w({navigation:this});this.rotate=new y({navigation:this});this.pinch=new x({navigation:this});this.zoomBox=new v({view:this.view,navigation:this})};a.prototype.destroy=function(){this.zoomBox.destroy();this.animationManager=this.zoomBox=null};a.prototype.begin=function(){this._set("interacting",!0)};a.prototype.end=function(){this._lastEventTimestamp=performance.now();this._startTimer(250)};a.prototype.zoom=function(b,c){void 0===c&&(c=this._getDefaultAnchor());return d.__awaiter(this,void 0,
void 0,function(){return d.__generator(this,function(a){this.stop();this.begin();if(this.view.constraints.snapToZoom&&this.view.constraints.effectiveLODs)return 1>b?[2,this.zoomIn(c)]:[2,this.zoomOut(c)];this.setViewpoint(c,b,0,[0,0]);return[2]})})};a.prototype.zoomIn=function(b){return d.__awaiter(this,void 0,void 0,function(){var c,a;return d.__generator(this,function(A){c=this.view;a=c.constraints.snapToNextScale(c.scale);return[2,this._zoomToScale(a,b)]})})};a.prototype.zoomOut=function(b){return d.__awaiter(this,
void 0,void 0,function(){var c,a;return d.__generator(this,function(A){c=this.view;a=c.constraints.snapToPreviousScale(c.scale);return[2,this._zoomToScale(a,b)]})})};a.prototype.setViewpoint=function(b,c,a,d){this.begin();this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,b,c,a,d);this.end()};a.prototype.setViewpointImmediate=function(b,c,a,d){void 0===c&&(c=0);void 0===a&&(a=[0,0]);void 0===d&&(d=this._getDefaultAnchor());this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,
d,b,c,a)};a.prototype.continousRotateClockwise=function(){var b=this.get("view.viewpoint");this.animationManager.animateContinous(b,function(c){g.rotateBy(c,c,-1)})};a.prototype.continousRotateCounterclockwise=function(){var b=this.get("view.viewpoint");this.animationManager.animateContinous(b,function(c){g.rotateBy(c,c,1)})};a.prototype.resetRotation=function(){this.view.rotation=0};a.prototype.continousPanLeft=function(){var b=this.get("view.viewpoint");this.animationManager.animateContinous(b,
function(c){g.translateBy(c,c,[-10,0])})};a.prototype.continousPanRight=function(){var b=this.get("view.viewpoint");this.animationManager.animateContinous(b,function(c){g.translateBy(c,c,[10,0])})};a.prototype.continousPanUp=function(){var b=this.get("view.viewpoint");this.animationManager.animateContinous(b,function(c){g.translateBy(c,c,[0,10])})};a.prototype.continousPanDown=function(){var b=this.get("view.viewpoint");this.animationManager.animateContinous(b,function(c){g.translateBy(c,c,[0,-10])})};
a.prototype.stop=function(){this.pan.stopMomentumNavigation();this.animationManager.stop();this.end();null!==this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=null,this._set("interacting",!1))};a.prototype._startTimer=function(b){var c=this;return null!==this._endTimer?this._endTimer:this._endTimer=setTimeout(function(){c._endTimer=null;var b=performance.now()-c._lastEventTimestamp;250>b?c._endTimer=c._startTimer(b):c._set("interacting",!1)},b)};a.prototype._getDefaultAnchor=function(){var b=
this.view,c=b.size,b=b.padding,a=b.top,d=b.bottom;k[0]=.5*(c[0]-b.right+b.left);k[1]=.5*(c[1]-d+a);return k};a.prototype._zoomToScale=function(b,c){void 0===c&&(c=this._getDefaultAnchor());return d.__awaiter(this,void 0,void 0,function(){var a,e,l,q,f,n,h,m;return d.__generator(this,function(d){a=this.view;e=a.constraints;l=a.scale;q=a.viewpoint;f=a.size;n=a.padding;h=e.canZoomInTo(b);m=e.canZoomOutTo(b);return b<l&&!h||b>l&&!m?[2]:[2,a.goTo(g.padAndScaleAndRotateBy(z,q,b/l,0,c,f,n),{animate:!0})]})})};
a.prototype._scaleRotateTranslateViewpoint=function(a,c,d,e,f){var b=this.view,l=b.size,n=b.padding,h=b.constraints,m=b.viewpoint,k=b.scale*d,b=h.canZoomInTo(k),h=h.canZoomOutTo(k);if(1>d&&!b||1<d&&!h)d=1;g.translateBy(m,m,f);return g.padAndScaleAndRotateBy(a,m,d,e,c,l,n)};d.__decorate([e.property()],a.prototype,"animationManager",void 0);d.__decorate([e.property({type:Boolean,readOnly:!0})],a.prototype,"interacting",void 0);d.__decorate([e.property()],a.prototype,"pan",void 0);d.__decorate([e.property()],
a.prototype,"pinch",void 0);d.__decorate([e.property()],a.prototype,"rotate",void 0);d.__decorate([e.property()],a.prototype,"view",void 0);d.__decorate([e.property()],a.prototype,"zoomBox",void 0);return a=d.__decorate([e.subclass("esri.views.2d.navigation.MapViewNavigation")],a)}(t);p.default=f});