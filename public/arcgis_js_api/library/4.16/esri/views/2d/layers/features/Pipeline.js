// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
/*

 Copyright 2000, Silicon Graphics, Inc. All Rights Reserved.
 Copyright 2015, Google Inc. All Rights Reserved.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to
 deal in the Software without restriction, including without limitation the
 rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 sell copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice including the dates of first publication and
 either this permission notice or a reference to http://oss.sgi.com/projects/FreeB/
 shall be included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 SILICON GRAPHICS, INC. BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
 IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

 Original Code. The Original Code is: OpenGL Sample Implementation,
 Version 1.2.1, released January 26, 2000, developed by Silicon Graphics,
 Inc. The Original Code is Copyright (c) 1991-2000 Silicon Graphics, Inc.
 Copyright in any portions created by third parties is as indicated
 elsewhere herein. All Rights Reserved.
*/
require({cache:{"esri/layers/support/TileInfo":function(){define("require exports tslib ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/unitUtils ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD".split(" "),function(f,a,e,m,k,l,g,c,h,b,d,n,p){var r=new k.default({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",
JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});return function(a){function q(b){b=a.call(this,b)||this;b.dpi=96;b.format=null;b.origin=null;b.minScale=0;b.maxScale=0;b.size=null;b.spatialReference=null;return b}e.__extends(q,a);u=q;q.create=function(b){void 0===b&&(b={size:256,spatialReference:m.SpatialReference.WebMercator});var c=b.resolutionFactor||1,h=b.scales,n=b.size||256,
a=b.spatialReference||m.SpatialReference.WebMercator;if(!d.isValid(a)){c=[];if(h)for(b=0;b<h.length;b++){var p=h[b];c.push({level:b,scale:p,resolution:p})}else{var e=5E-4;for(b=23;0<=b;b--)c.unshift({level:b,scale:e,resolution:e}),e*=2}return new u({dpi:96,lods:c,origin:new m.Point(0,0,a),size:[n,n],spatialReference:a})}var p=d.getInfo(a),q=b.origin?new m.Point({x:b.origin.x,y:b.origin.y,spatialReference:a}):p?new m.Point({x:p.origin[0],y:p.origin[1],spatialReference:a}):new m.Point({x:0,y:0,spatialReference:a}),
r=1/(39.37*g.getMetersPerUnitForSR(a)*96),v=[];if(h)for(b=0;b<h.length;b++)p=h[b],e=p*r,v.push({level:b,scale:p,resolution:e});else for(p=d.isGeographic(a)?512/n*5.916575275917094E8:256/n*5.91657527591555E8,h=Math.ceil(24/c),v.push({level:0,scale:p,resolution:p*r}),b=1;b<h;b++)p/=Math.pow(2,c),e=p*r,v.push({level:b,scale:p,resolution:e});return new u({dpi:96,lods:v,origin:q,size:[n,n],spatialReference:a})};Object.defineProperty(q.prototype,"isWrappable",{get:function(){var b=this.spatialReference,
c=this.origin;if(b&&c){var h=d.getInfo(b);return b.isWrappable&&Math.abs(h.origin[0]-c.x)<=h.dx}return!1},enumerable:!0,configurable:!0});q.prototype.readOrigin=function(b,d){return m.Point.fromJSON(e.__assign({spatialReference:d.spatialReference},b))};Object.defineProperty(q.prototype,"lods",{set:function(b){var d=this,c=0,h=0,n=[];this._levelToLOD={};b&&(c=-Infinity,h=Infinity,b.forEach(function(b){n.push(b.scale);c=b.scale>c?b.scale:c;h=b.scale<h?b.scale:h;d._levelToLOD[b.level]=b}));this._set("scales",
n);this._set("minScale",c);this._set("maxScale",h);this._set("lods",b);this._initializeUpsampleLevels()},enumerable:!0,configurable:!0});q.prototype.readSize=function(b,d){return[d.cols,d.rows]};q.prototype.writeSize=function(b,d){d.cols=b[0];d.rows=b[0]};q.prototype.zoomToScale=function(b){var d=this.scales;if(0>=b)return d[0];if(b>=d.length)return d[d.length-1];var c=Math.round(b);return d[c]+(c-b)*(d[Math.round(b-.5)]-d[c])};q.prototype.scaleToZoom=function(b){for(var d=this.scales,c=d.length-
1,h=0;h<c;h++){var n=d[h],a=d[h+1];if(n<=b)break;if(a===b)return h+1;if(n>b&&a<b)return h+1-(b-a)/(n-a)}return h};q.prototype.snapScale=function(b,d){void 0===d&&(d=.95);b=this.scaleToZoom(b);return b%Math.floor(b)>=d?this.zoomToScale(Math.ceil(b)):this.zoomToScale(Math.floor(b))};q.prototype.tileAt=function(c,h,a,g){var p=this.lodAt(c);if(!p)return null;var e;if("number"===typeof h)e=h,h=a;else{if(d.equals(h.spatialReference,this.spatialReference))e=h.x,h=h.y;else{g=n.project(h,this.spatialReference);
if(!g)return null;e=g.x;h=g.y}g=a}a=p.resolution*this.size[0];p=p.resolution*this.size[1];g||(g={id:null,level:0,row:0,col:0,extent:b.create()});g.level=c;g.row=Math.floor((this.origin.y-h)/p+.001);g.col=Math.floor((e-this.origin.x)/a+.001);this.updateTileInfo(g);return g};q.prototype.updateTileInfo=function(d){var c=this.lodAt(d.level);if(c){var h=c.resolution*this.size[0],c=c.resolution*this.size[1];d.id=d.level+"/"+d.row+"/"+d.col;d.extent||(d.extent=b.create());d.extent[0]=this.origin.x+d.col*
h;d.extent[1]=this.origin.y-(d.row+1)*c;d.extent[2]=d.extent[0]+h;d.extent[3]=d.extent[1]+c}};q.prototype.upsampleTile=function(b){var d=this._upsampleLevels[b.level];if(!d||-1===d.parentLevel)return!1;b.level=d.parentLevel;b.row=Math.floor(b.row/d.factor+.001);b.col=Math.floor(b.col/d.factor+.001);this.updateTileInfo(b);return!0};q.prototype.getTileBounds=function(b,d){var c=this.lodAt(d.level).resolution,h=c*this.size[0],c=c*this.size[1];b[0]=this.origin.x+d.col*h;b[1]=this.origin.y-(d.row+1)*c;
b[2]=b[0]+h;b[3]=b[1]+c;return b};q.prototype.lodAt=function(b){return this._levelToLOD&&this._levelToLOD[b]||null};q.prototype.clone=function(){return u.fromJSON(this.write({}))};q.prototype._initializeUpsampleLevels=function(){var b=this.lods;this._upsampleLevels=[];for(var d=null,c=0;c<b.length;c++){var h=b[c];this._upsampleLevels[h.level]={parentLevel:d?d.level:-1,factor:d?d.resolution/h.resolution:0};d=h}};var u;e.__decorate([c.property({type:Number,json:{write:!0}})],q.prototype,"compressionQuality",
void 0);e.__decorate([c.property({type:Number,json:{write:!0}})],q.prototype,"dpi",void 0);e.__decorate([c.property({type:String,json:{read:r.read,write:r.write,origins:{"web-scene":{read:!1,write:!1}}}})],q.prototype,"format",void 0);e.__decorate([c.property({readOnly:!0,dependsOn:["spatialReference","origin"]})],q.prototype,"isWrappable",null);e.__decorate([c.property({type:m.Point,json:{write:!0}})],q.prototype,"origin",void 0);e.__decorate([c.reader("origin")],q.prototype,"readOrigin",null);e.__decorate([c.property({type:[p],
value:null,json:{write:!0}})],q.prototype,"lods",null);e.__decorate([c.property({readOnly:!0})],q.prototype,"minScale",void 0);e.__decorate([c.property({readOnly:!0})],q.prototype,"maxScale",void 0);e.__decorate([c.property({readOnly:!0})],q.prototype,"scales",void 0);e.__decorate([c.property({cast:function(b){return Array.isArray(b)?b:"number"===typeof b?[b,b]:[256,256]}})],q.prototype,"size",void 0);e.__decorate([c.reader("size",["rows","cols"])],q.prototype,"readSize",null);e.__decorate([c.writer("size",
{cols:{type:h.Integer},rows:{type:h.Integer}})],q.prototype,"writeSize",null);e.__decorate([c.property({type:m.SpatialReference,json:{write:!0}})],q.prototype,"spatialReference",void 0);return q=u=e.__decorate([c.subclass("esri.layers.support.TileInfo")],q)}(l.JSONSupport)})},"esri/geometry":function(){define("require exports ./core/jsonMap ./core/accessorSupport/ensureType ./geometry/Extent ./geometry/Geometry ./geometry/Multipoint ./geometry/Point ./geometry/Polygon ./geometry/Polyline ./geometry/SpatialReference ./geometry/support/jsonUtils".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n){Object.defineProperty(a,"__esModule",{value:!0});a.Extent=k;a.BaseGeometry=l;a.Multipoint=g;a.Point=c;a.Polygon=h;a.Polyline=b;a.SpatialReference=d;a.isGeometry=function(b){return b instanceof l};a.fromJSON=n.fromJSON;a.typeKebabDictionary=e.strict()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"});a.isFeatureGeometryType=function(b){return"point"===
b||"multipoint"===b||"polyline"===b||"polygon"===b};a.featureGeometryTypeKebabDictionary=e.strict()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"});a.geometryTypes={base:l,key:"type",typeMap:{extent:k,multipoint:g,point:c,polyline:b,polygon:h}};a.ensureType=m.ensureOneOfType(a.geometryTypes)})},"esri/geometry/Extent":function(){define("require exports tslib ../core/maybe ../core/string ../core/accessorSupport/decorators ./Geometry ./Point ./SpatialReference ./support/contains ./support/intersects ./support/spatialReferenceUtils ./support/webMercatorUtils".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p){function r(b,d,c){return null==d?c:null==c?d:b(d,c)}f=function(a){function g(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];b=a.apply(this,b)||this;b.type="extent";b.xmin=0;b.ymin=0;b.mmin=void 0;b.zmin=void 0;b.xmax=0;b.ymax=0;b.mmax=void 0;b.zmax=void 0;return b}e.__extends(g,a);q=g;g.prototype.normalizeCtorArgs=function(b,d,c,n,g){return!b||"esri.geometry.SpatialReference"!==b.declaredClass&&null==b.wkid?"object"===typeof b?(b.spatialReference=null==
b.spatialReference?h.WGS84:b.spatialReference,b):{xmin:b,ymin:d,xmax:c,ymax:n,spatialReference:null==g?h.WGS84:g}:{spatialReference:b,xmin:0,ymin:0,xmax:0,ymax:0}};g.fromBounds=function(b,d){return new q({xmin:b[0],ymin:b[1],xmax:b[2],ymax:b[3],spatialReference:d})};Object.defineProperty(g.prototype,"center",{get:function(){var b=new c({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});this.hasZ&&(b.z=.5*(this.zmin+this.zmax));this.hasM&&(b.m=.5*(this.mmin+
this.mmax));return b},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"extent",{get:function(){return this.clone()},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"hasM",{get:function(){return null!=this.mmin&&null!=this.mmax},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"hasZ",{get:function(){return null!=this.zmin&&null!=this.zmax},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"height",{get:function(){return Math.abs(this.ymax-
this.ymin)},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"width",{get:function(){return Math.abs(this.xmax-this.xmin)},enumerable:!0,configurable:!0});g.prototype.centerAt=function(b){var d=this.center;return null!=b.z&&this.hasZ?this.offset(b.x-d.x,b.y-d.y,b.z-d.z):this.offset(b.x-d.x,b.y-d.y)};g.prototype.clone=function(){var b=new q;b.xmin=this.xmin;b.ymin=this.ymin;b.xmax=this.xmax;b.ymax=this.ymax;b.spatialReference=this.spatialReference;null!=this.zmin&&(b.zmin=this.zmin,
b.zmax=this.zmax);null!=this.mmin&&(b.mmin=this.mmin,b.mmax=this.mmax);return b};g.prototype.contains=function(d){if(!d)return!1;var c=this.spatialReference,h=d.spatialReference;c&&h&&!c.equals(h)&&p.canProject(c,h)&&(d=c.isWebMercator?p.geographicToWebMercator(d):p.webMercatorToGeographic(d,!0));return"point"===d.type?b.extentContainsPoint(this,d):"extent"===d.type?b.extentContainsExtent(this,d):!1};g.prototype.equals=function(b){if(!b)return!1;var d=this.spatialReference,c=b.spatialReference;d&&
c&&!d.equals(c)&&p.canProject(d,c)&&(b=d.isWebMercator?p.geographicToWebMercator(b):p.webMercatorToGeographic(b,!0));return this.xmin===b.xmin&&this.ymin===b.ymin&&this.zmin===b.zmin&&this.mmin===b.mmin&&this.xmax===b.xmax&&this.ymax===b.ymax&&this.zmax===b.zmax&&this.mmax===b.mmax};g.prototype.expand=function(b){b=.5*(1-b);var d=this.width*b,c=this.height*b;this.xmin+=d;this.ymin+=c;this.xmax-=d;this.ymax-=c;this.hasZ&&(d=(this.zmax-this.zmin)*b,this.zmin+=d,this.zmax-=d);this.hasM&&(b*=this.mmax-
this.mmin,this.mmin+=b,this.mmax-=b);return this};g.prototype.intersects=function(b){if(m.isNone(b))return!1;var c=this.spatialReference,h=b.spatialReference;c&&h&&!c.equals(h)&&p.canProject(c,h)&&(b=c.isWebMercator?p.geographicToWebMercator(b):p.webMercatorToGeographic(b,!0));c=d.getExtentIntersector(b.type);return"mesh"!==b.type?c(this,b):c(this,b.extent)};g.prototype.normalize=function(){var b=this._normalize(!1,!0);return Array.isArray(b)?b:[b]};g.prototype.offset=function(b,d,c){this.xmin+=b;
this.ymin+=d;this.xmax+=b;this.ymax+=d;null!=c&&(this.zmin+=c,this.zmax+=c);return this};g.prototype.shiftCentralMeridian=function(){return this._normalize(!0)};g.prototype.union=function(b){this.xmin=Math.min(this.xmin,b.xmin);this.ymin=Math.min(this.ymin,b.ymin);this.xmax=Math.max(this.xmax,b.xmax);this.ymax=Math.max(this.ymax,b.ymax);if(this.hasZ||b.hasZ)this.zmin=r(Math.min,this.zmin,b.zmin),this.zmax=r(Math.max,this.zmax,b.zmax);if(this.hasM||b.hasM)this.mmin=r(Math.min,this.mmin,b.mmin),this.mmax=
r(Math.max,this.mmax,b.mmax);return this};g.prototype.intersection=function(b){if(!this.intersects(b))return null;this.xmin=Math.max(this.xmin,b.xmin);this.ymin=Math.max(this.ymin,b.ymin);this.xmax=Math.min(this.xmax,b.xmax);this.ymax=Math.min(this.ymax,b.ymax);if(this.hasZ||b.hasZ)this.zmin=r(Math.max,this.zmin,b.zmin),this.zmax=r(Math.min,this.zmax,b.zmax);if(this.hasM||b.hasM)this.mmin=r(Math.max,this.mmin,b.mmin),this.mmax=r(Math.min,this.mmax,b.mmax);return this};g.prototype.toJSON=function(b){return this.write(null,
b)};g.prototype._shiftCM=function(b){void 0===b&&(b=n.getInfo(this.spatialReference));if(!b||!this.spatialReference)return this;var d=this.spatialReference,c=this._getCM(b);if(c){var g=d.isWebMercator?p.webMercatorToGeographic(c):c;this.xmin-=c.x;this.xmax-=c.x;d.isWebMercator||(g.x=this._normalizeX(g.x,b).x);this.spatialReference=new h(k.replace(d.isWGS84?b.altTemplate:b.wkTemplate,{Central_Meridian:g.x}))}return this};g.prototype._getCM=function(b){var d=null,c=b.valid;b=c[0];var c=c[1],h=this.xmin,
n=this.xmax;h>=b&&h<=c&&n>=b&&n<=c||(d=this.center);return d};g.prototype._normalize=function(b,d,c){var h=this.spatialReference;if(!h)return this;c=c||n.getInfo(h);if(!c)return this;var g=this._getParts(c).map(function(b){return b.extent});if(2>g.length)return g[0]||this;if(2<g.length)return b?this._shiftCM(c):this.set({xmin:c.valid[0],xmax:c.valid[1]});if(b)return this._shiftCM(c);if(d)return g;var a=!0,p=!0;g.forEach(function(b){b.hasZ||(a=!1);b.hasM||(p=!1)});return{rings:g.map(function(b){var d=
[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]];if(a)for(var c=(b.zmax-b.zmin)/2,h=0;h<d.length;h++)d[h].push(c);if(p)for(b=(b.mmax-b.mmin)/2,h=0;h<d.length;h++)d[h].push(b);return d}),hasZ:a,hasM:p,spatialReference:h}};g.prototype._getParts=function(b){var d=this.cache._parts;if(!d){var d=[],c=this.ymin,h=this.ymax,g=this.spatialReference,a=this.width,p=this.xmin,e=this.xmax,r=void 0;b=b||n.getInfo(g);var x=b.valid,u=x[0],v=x[1],r=this._normalizeX(this.xmin,b),l=
r.x,x=r.frameId,r=this._normalizeX(this.xmax,b),f=r.x;b=r.frameId;r=l===f&&0<a;if(a>2*v){a=new q(p<e?l:f,c,v,h,g);p=new q(u,c,p<e?f:l,h,g);e=new q(0,c,v,h,g);c=new q(u,c,0,h,g);h=[];g=[];a.contains(e)&&h.push(x);a.contains(c)&&g.push(x);p.contains(e)&&h.push(b);p.contains(c)&&g.push(b);for(u=x+1;u<b;u++)h.push(u),g.push(u);d.push({extent:a,frameIds:[x]},{extent:p,frameIds:[b]},{extent:e,frameIds:h},{extent:c,frameIds:g})}else l>f||r?d.push({extent:new q(l,c,v,h,g),frameIds:[x]},{extent:new q(u,c,
f,h,g),frameIds:[b]}):d.push({extent:new q(l,c,f,h,g),frameIds:[x]});this.cache._parts=d}b=this.hasZ;c=this.hasM;if(b||c)for(x={},b&&(x.zmin=this.zmin,x.zmax=this.zmax),c&&(x.mmin=this.mmin,x.mmax=this.mmax),b=0;b<d.length;b++)d[b].extent.set(x);return d};g.prototype._normalizeX=function(b,d){var c=d.valid;d=c[0];var h=c[1],c=2*h,n=0;b>h?(d=Math.ceil(Math.abs(b-h)/c),b-=d*c,n=d):b<d&&(d=Math.ceil(Math.abs(b-d)/c),b+=d*c,n=-d);return{x:b,frameId:n}};var q;e.__decorate([l.property({dependsOn:"xmin ymin zmin mmin xmax ymax zmax mmax spatialReference".split(" ")})],
g.prototype,"cache",void 0);e.__decorate([l.property({readOnly:!0,dependsOn:["cache"]})],g.prototype,"center",null);e.__decorate([l.property({readOnly:!0,dependsOn:["cache"]})],g.prototype,"extent",null);e.__decorate([l.property({readOnly:!0,dependsOn:["mmin","mmax"],json:{write:{enabled:!1,overridePolicy:null}}})],g.prototype,"hasM",null);e.__decorate([l.property({readOnly:!0,dependsOn:["zmin","zmax"],json:{write:{enabled:!1,overridePolicy:null}}})],g.prototype,"hasZ",null);e.__decorate([l.property({readOnly:!0,
dependsOn:["ymin","ymax"]})],g.prototype,"height",null);e.__decorate([l.property({readOnly:!0,dependsOn:["xmin","xmax"]})],g.prototype,"width",null);e.__decorate([l.property({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],g.prototype,"xmin",void 0);e.__decorate([l.property({type:Number,json:{write:!0}})],g.prototype,"ymin",void 0);e.__decorate([l.property({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy:function(){return{enabled:this.hasM}}}}})],
g.prototype,"mmin",void 0);e.__decorate([l.property({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy:function(){return{enabled:this.hasZ}}}}})],g.prototype,"zmin",void 0);e.__decorate([l.property({type:Number,json:{write:!0}})],g.prototype,"xmax",void 0);e.__decorate([l.property({type:Number,json:{write:!0}})],g.prototype,"ymax",void 0);e.__decorate([l.property({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy:function(){return{enabled:this.hasM}}}}})],
g.prototype,"mmax",void 0);e.__decorate([l.property({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy:function(){return{enabled:this.hasZ}}}}})],g.prototype,"zmax",void 0);return g=q=e.__decorate([l.subclass("esri.geometry.Extent")],g)}(g);f.prototype.toJSON.isDefaultToJSON=!0;return f})},"esri/geometry/Geometry":function(){define("require exports tslib ../core/JSONSupport ../core/accessorSupport/decorators ./SpatialReference".split(" "),function(f,a,e,m,k,l){return function(g){function c(){for(var c=
[],b=0;b<arguments.length;b++)c[b]=arguments[b];c=g.apply(this,c)||this;c.type=null;c.extent=null;c.hasM=!1;c.hasZ=!1;c.spatialReference=l.WGS84;return c}e.__extends(c,g);Object.defineProperty(c.prototype,"cache",{get:function(){return{}},enumerable:!0,configurable:!0});c.prototype.readSpatialReference=function(c,b){if(c instanceof l)return c;if(null!=c){var d=new l;d.read(c,b);return d}return c};c.prototype.clone=function(){console.warn(".clone() is not implemented for "+this.declaredClass);return null};
c.prototype.clearCache=function(){this.notifyChange("cache")};c.prototype.getCacheValue=function(c){return this.cache[c]};c.prototype.setCacheValue=function(c,b){this.cache[c]=b};e.__decorate([k.property()],c.prototype,"type",void 0);e.__decorate([k.property({readOnly:!0,dependsOn:["spatialReference"]})],c.prototype,"cache",null);e.__decorate([k.property({readOnly:!0,dependsOn:["spatialReference"]})],c.prototype,"extent",void 0);e.__decorate([k.property({type:Boolean,json:{write:{overridePolicy:function(c){return{enabled:c}}}}})],
c.prototype,"hasM",void 0);e.__decorate([k.property({type:Boolean,json:{write:{overridePolicy:function(c){return{enabled:c}}}}})],c.prototype,"hasZ",void 0);e.__decorate([k.property({type:l,json:{write:!0}})],c.prototype,"spatialReference",void 0);e.__decorate([k.reader("spatialReference")],c.prototype,"readSpatialReference",null);return c=e.__decorate([k.subclass("esri.geometry.Geometry")],c)}(m.JSONSupport)})},"esri/core/JSONSupport":function(){define("require exports tslib ./Accessor ./accessorSupport/decorators ./accessorSupport/read ./accessorSupport/write".split(" "),
function(f,a,e,m,k,l,g){Object.defineProperty(a,"__esModule",{value:!0});a.JSONSupportMixin=function(c){c=function(c){function b(){for(var b=[],h=0;h<arguments.length;h++)b[h]=arguments[h];return c.apply(this,b)||this}e.__extends(b,c);b.prototype.read=function(b,c){l.default(this,b,c)};b.prototype.write=function(b,c){return g.default(this,b||{},c)};b.prototype.toJSON=function(b){return this.write(null,b)};b.fromJSON=function(b,c){if(b){if(b.declaredClass)throw Error("JSON object is already hydrated");
var d=new this;d.read(b,c);b=d}else b=null;return b};return b=e.__decorate([k.subclass("esri.core.JSONSupport")],b)}(c);c.prototype.toJSON.isDefaultToJSON=!0;return c};a.isJSONSupport=function(c){return c&&"read"in c&&"write"in c&&"toJSON"in c};f=function(c){function h(){return null!==c&&c.apply(this,arguments)||this}e.__extends(h,c);return h=e.__decorate([k.subclass("esri.core.JSONSupport")],h)}(a.JSONSupportMixin(m));a.JSONSupport=f})},"esri/core/accessorSupport/read":function(){define("require exports tslib ./get ./utils ./extensions/serializableProperty".split(" "),
function(f,a,e,m,k,l){function g(h,b,d){void 0===d&&(d=c);if(b&&"object"===typeof b){for(var n=k.getProperties(h),g=n.metadatas,a={},e=0,x=Object.getOwnPropertyNames(b);e<x.length;e++){var u=a,v=g,y=x[e],f=b,A=d,B=l.originSpecificReadPropertyDefinition(v[y],A);B&&(!B.read||!1!==B.read.enabled&&!B.read.source)&&(u[y]=!0);for(var D=0,C=Object.getOwnPropertyNames(v);D<C.length;D++){var E=C[D],B=l.originSpecificReadPropertyDefinition(v[E],A),F;a:{F=y;var I=f;if(B&&B.read&&!1!==B.read.enabled&&B.read.source)if(B=
B.read.source,"string"===typeof B){if(B===F||-1<B.indexOf(".")&&0===B.indexOf(F)&&m.exists(B,I)){F=!0;break a}}else for(var J=0;J<B.length;J++){var G=B[J];if(G===F||-1<G.indexOf(".")&&0===G.indexOf(F)&&m.exists(G,I)){F=!0;break a}}F=!1}F&&(u[E]=!0)}}n.setDefaultOrigin(d.origin);x=0;for(u=Object.getOwnPropertyNames(a);x<u.length;x++)e=u[x],y=(v=l.originSpecificReadPropertyDefinition(g[e],d).read)&&v.source,f=void 0,f=y&&"string"===typeof y?m.valueOf(b,y):b[e],v&&v.reader&&(f=v.reader.call(h,f,b,d)),
void 0!==f&&n.set(e,f);if(!d||!d.ignoreDefaults)for(b=0,g=Object.getOwnPropertyNames(g);b<g.length;b++)e=g[b],a[e]||(x=h,u=n,v=d,y=(y=l.originSpecificPropertyDefinition(u.metadatas[e],"any",v))&&y.default,void 0!==y&&(x="function"===typeof y?y.call(x,e,v):y,void 0!==x&&u.set(e,x)));n.setDefaultOrigin("user")}}Object.defineProperty(a,"__esModule",{value:!0});var c={origin:"service"};a.read=g;a.readLoadable=function(h,b,d,n){void 0===n&&(n=c);b=e.__assign(e.__assign({},n),{messages:[]});d(b);b.messages.forEach(function(b){"warning"!==
b.type||h.loaded?n&&n.messages.push(b):h.loadWarnings.push(b)})};a.default=g})},"esri/core/accessorSupport/write":function(){define("require exports ../arrayUtils ../Error ../Logger ../promiseUtils ./PropertyOrigin ./utils ./extensions/serializableProperty".split(" "),function(f,a,e,m,k,l,g,c,h){function b(b,d,c,h,n){var g={};d.write.writer.call(b,h,g,c,n);return g}function d(b,d,c,h,n,a){if(!h||!h.write)return!1;var r=b.get(c);if(!n&&h.write.overridePolicy){var q=h.write.overridePolicy.call(b,r,
c,a);void 0!==q&&(n=q)}n||(n=h.write);if(!n||!1===n.enabled)return!1;if((null===r&&!n.allowNull||void 0===r)&&n.isRequired)return(d=new m("web-document-write:property-required","Missing value for required property '"+c+"' on '"+b.declaredClass+"'",{propertyName:c,target:b}),a)&&a.messages?a.messages.push(d):d&&!a&&p.error(d.name,d.message),!1;if(void 0===r||null===r&&!n.allowNull)return!1;q=h.default;void 0===q?r=!1:null!=h.defaultEquals?r=h.defaultEquals(r):"function"===typeof q?Array.isArray(r)?
(b=q.call(b,c,a),r=e.equals(b,r)):r=!1:r=q===r;return r?!1:void 0!==h.default?!0:!n.ignoreOrigin&&a&&a.origin&&d.store.originOf(c)<g.nameToId(a.origin)?!1:!0}function n(n,a,p){if(n&&"function"===typeof n.toJSON&&(!n.toJSON.isDefaultToJSON||!n.write))return c.merge(a,n.toJSON());var e=c.getProperties(n),r=e.metadatas,q=function(q){var x=h.originSpecificWritePropertyDefinition(r[q],p);if(!d(n,e,q,x,null,p))return"continue";var u=n.get(q),v=b(n,x,"string"===typeof x.write.target?x.write.target:q,u,p);
0<Object.keys(v).length&&(a=c.merge(a,v),p&&p.resources&&p.resources.pendingOperations&&p.resources.pendingOperations.length&&l.all(p.resources.pendingOperations).then(function(){return c.merge(a,v)}),p&&p.writtenProperties&&p.writtenProperties.push({target:n,propName:q,oldOrigin:g.idToReadableName(e.store.originOf(q)),newOrigin:p.origin}))},x;for(x in r)q(x);return a}Object.defineProperty(a,"__esModule",{value:!0});var p=k.getLogger("esri.core.accessorSupport.write");a.willPropertyWrite=function(b,
n,g,a){var p=c.getProperties(b),e=h.originSpecificWritePropertyDefinition(p.metadatas[n],a);return e?d(b,p,n,e,g,a):!1};a.write=n;a.default=n})},"esri/geometry/SpatialReference":function(){define("require exports tslib ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators ./support/spatialReferenceUtils".split(" "),function(f,a,e,m,k,l,g){f=function(c){function h(b){b=c.call(this,b)||this;b.latestWkid=null;b.wkid=null;b.wkt=null;b.imageCoordinateSystem=null;return b}e.__extends(h,c);
b=h;h.fromJSON=function(d){if(!d)return null;if(d.wkid){if(102100===d.wkid)return b.WebMercator;if(4326===d.wkid)return b.WGS84}var c=new b;c.read(d);return c};h.prototype.normalizeCtorArgs=function(b){var d;return b&&"object"===typeof b?b:(d={},d["string"===typeof b?"wkt":"wkid"]=b,d)};Object.defineProperty(h.prototype,"isWGS84",{get:function(){return g.isWGS84(this)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"isWebMercator",{get:function(){return g.isWebMercator(this)},enumerable:!0,
configurable:!0});Object.defineProperty(h.prototype,"isGeographic",{get:function(){return g.isGeographic(this)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"isWrappable",{get:function(){return g.isWrappable(this)},enumerable:!0,configurable:!0});h.prototype.writeWkt=function(b,c){this.wkid||(c.wkt=b)};h.prototype.clone=function(){if(this===b.WGS84)return b.WGS84;if(this===b.WebMercator)return b.WebMercator;var d=new b;null!=this.wkid?(d.wkid=this.wkid,null!=this.latestWkid&&
(d.latestWkid=this.latestWkid),null!=this.vcsWkid&&(d.vcsWkid=this.vcsWkid),null!=this.latestVcsWkid&&(d.latestVcsWkid=this.latestVcsWkid)):null!=this.wkt&&(d.wkt=this.wkt);this.imageCoordinateSystem&&(d.imageCoordinateSystem=k.clone(this.imageCoordinateSystem));return d};h.prototype.equals=function(b){if(null==b)return!1;if(this.imageCoordinateSystem||b.imageCoordinateSystem){if(null==this.imageCoordinateSystem||null==b.imageCoordinateSystem)return!1;var d=b.imageCoordinateSystem,c=d.id,d=d.referenceServiceName,
h=b.imageCoordinateSystem.geodataXform,a=this.imageCoordinateSystem;return null==c||h?JSON.stringify(a)===JSON.stringify(b.imageCoordinateSystem):d?a.id===c&&a.referenceServiceName===d:a.id===c}return g.equals(this,b)};h.prototype.toJSON=function(b){return this.write(null,b)};var b;h.GCS_NAD_1927=null;h.WGS84=null;h.WebMercator=null;e.__decorate([l.property({dependsOn:["wkid"],readOnly:!0})],h.prototype,"isWGS84",null);e.__decorate([l.property({dependsOn:["wkid"],readOnly:!0})],h.prototype,"isWebMercator",
null);e.__decorate([l.property({dependsOn:["wkid","wkt"],readOnly:!0})],h.prototype,"isGeographic",null);e.__decorate([l.property({dependsOn:["wkid"],readOnly:!0})],h.prototype,"isWrappable",null);e.__decorate([l.property({type:Number,json:{write:!0}})],h.prototype,"latestWkid",void 0);e.__decorate([l.property({type:Number,json:{write:!0,origins:{"web-scene":{write:{overridePolicy:function(){return{isRequired:null===this.wkt?!0:!1}}}}}}})],h.prototype,"wkid",void 0);e.__decorate([l.property({type:String,
json:{origins:{"web-scene":{write:{overridePolicy:function(){return{isRequired:null===this.wkid?!0:!1}}}}}}})],h.prototype,"wkt",void 0);e.__decorate([l.writer("wkt"),l.writer("web-scene","wkt")],h.prototype,"writeWkt",null);e.__decorate([l.property({type:Number,json:{write:!0}})],h.prototype,"vcsWkid",void 0);e.__decorate([l.property({type:Number,json:{write:!0}})],h.prototype,"latestVcsWkid",void 0);e.__decorate([l.property()],h.prototype,"imageCoordinateSystem",void 0);return h=b=e.__decorate([l.subclass("esri.geometry.SpatialReference")],
h)}(m.JSONSupport);f.prototype.toJSON.isDefaultToJSON=!0;f.GCS_NAD_1927=new f({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'});f.WGS84=new f(g.WGS84);f.WebMercator=new f(g.WebMercator);Object.freeze&&(Object.freeze(f.GCS_NAD_1927),Object.freeze(f.WGS84),Object.freeze(f.WebMercator));return f})},"esri/geometry/support/spatialReferenceUtils":function(){define(["require",
"exports","../../core/string","./WKIDUnitConversion"],function(f,a,e,m){function k(b){return g(b)&&b.wkid?d[b.wkid]:null}function l(b){return g(b)&&!0===c[b.wkid]}function g(b){return null!=b&&(null!=b.wkid&&2E3<=b.wkid||null!=b.wkt)}Object.defineProperty(a,"__esModule",{value:!0});var c={102113:!0,102100:!0,3857:!0,3785:!0},h={102113:!0,102100:!0,3857:!0,3785:!0,4326:!0};f=[-2.0037508342788905E7,2.0037508342788905E7];var b=[-2.0037508342787E7,2.0037508342787E7],d={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',
valid:f,origin:b,dx:1E-5},102100:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:f,origin:b,
dx:1E-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:f,origin:b,dx:1E-5},3857:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',
valid:f,origin:b,dx:1E-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',
valid:[-180,180],origin:[-180,180],dx:1E-5}};a.equals=function(b,d){return b&&d?b===d?!0:null!=b.wkid||null!=d.wkid?b.wkid===d.wkid||l(b)&&l(d)||null!=d.latestWkid&&b.wkid===d.latestWkid||null!=b.latestWkid&&d.wkid===b.latestWkid:b.wkt&&d.wkt?b.wkt.toUpperCase()===d.wkt.toUpperCase():!1:!1};a.getInfo=k;a.isGeographic=function(b){return g(b)?b.wkid?null==m[b.wkid]:b.wkt?!!/^\s*GEOGCS/i.test(b.wkt):!1:!1};a.isWGS84=function(b){return g(b)&&4326===b.wkid};a.isWebMercator=l;a.isWrappable=function(b){return g(b)&&
!0===h[b.wkid]};a.isValid=g;a.WGS84={wkid:4326,wkt:e.replace(k({wkid:4326}).wkTemplate,{Central_Meridian:"0.0"})};a.WebMercator={wkid:102100,latestWkid:3857}})},"esri/geometry/support/WKIDUnitConversion":function(){(function(f){"object"===typeof module&&"object"===typeof module.exports?(f=f(),void 0!==f&&(module.exports=f)):"function"===typeof define&&define.amd&&define(f)})(function(){var f,a={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,
20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.116756,5E4,15E4],units:"Meter Foot Foot_US Foot_Clarke Yard_Clarke Link_Clarke Yard_Sears Foot_Sears Chain_Sears Chain_Benoit_1895_B Yard_Indian Yard_Indian_1937 Foot_Gold_Coast Chain_Sears_1922_Truncated 50_Kilometers 150_Kilometers".split(" "),2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,
2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:13,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,
3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,
3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,
3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,
5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,
6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,
6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,
6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,
6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,
7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,
7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,
8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,
8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,
9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25E3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,
27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,54090:0,54091:0,65061:2,65062:2,65161:0,
65163:0,102041:2,102064:11,102068:14,102069:15,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102962:0,102963:0,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,
103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,
103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,
103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,
103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2};for(f=2E3;2045>=f;f++)a[f]=0;for(f=2056;2065>=f;f++)a[f]=0;for(f=2067;2135>=f;f++)a[f]=0;for(f=2137;2154>=f;f++)a[f]=0;for(f=2161;2170>=f;f++)a[f]=0;for(f=2172;2193>=f;f++)a[f]=0;for(f=2195;2198>=f;f++)a[f]=0;for(f=2200;2203>=f;f++)a[f]=0;for(f=2205;2217>=f;f++)a[f]=0;for(f=2222;2224>=
f;f++)a[f]=1;for(f=2225;2250>=f;f++)a[f]=2;for(f=2251;2253>=f;f++)a[f]=1;for(f=2257;2264>=f;f++)a[f]=2;for(f=2274;2279>=f;f++)a[f]=2;for(f=2280;2282>=f;f++)a[f]=1;for(f=2283;2289>=f;f++)a[f]=2;for(f=2290;2292>=f;f++)a[f]=0;for(f=2308;2313>=f;f++)a[f]=0;for(f=2315;2491>=f;f++)a[f]=0;for(f=2494;2866>=f;f++)a[f]=0;for(f=2867;2869>=f;f++)a[f]=1;for(f=2870;2888>=f;f++)a[f]=2;for(f=2891;2895>=f;f++)a[f]=2;for(f=2896;2898>=f;f++)a[f]=1;for(f=2902;2908>=f;f++)a[f]=2;for(f=2915;2920>=f;f++)a[f]=2;for(f=2921;2923>=
f;f++)a[f]=1;for(f=2924;2930>=f;f++)a[f]=2;for(f=2931;2962>=f;f++)a[f]=0;for(f=2964;2968>=f;f++)a[f]=2;for(f=2969;2973>=f;f++)a[f]=0;for(f=2975;2991>=f;f++)a[f]=0;for(f=2995;3051>=f;f++)a[f]=0;for(f=3054;3079>=f;f++)a[f]=0;for(f=3081;3088>=f;f++)a[f]=0;for(f=3092;3101>=f;f++)a[f]=0;for(f=3106;3138>=f;f++)a[f]=0;for(f=3146;3151>=f;f++)a[f]=0;for(f=3153;3166>=f;f++)a[f]=0;for(f=3168;3172>=f;f++)a[f]=0;for(f=3174;3203>=f;f++)a[f]=0;for(f=3294;3358>=f;f++)a[f]=0;for(f=3367;3403>=f;f++)a[f]=0;for(f=3408;3416>=
f;f++)a[f]=0;for(f=3417;3438>=f;f++)a[f]=2;for(f=3441;3446>=f;f++)a[f]=2;for(f=3447;3450>=f;f++)a[f]=0;for(f=3451;3459>=f;f++)a[f]=2;for(f=3460;3478>=f;f++)a[f]=0;for(f=3554;3559>=f;f++)a[f]=0;for(f=3560;3570>=f;f++)a[f]=2;for(f=3571;3581>=f;f++)a[f]=0;for(f=3594;3597>=f;f++)a[f]=0;for(f=3601;3604>=f;f++)a[f]=0;for(f=3637;3639>=f;f++)a[f]=0;for(f=3665;3667>=f;f++)a[f]=0;for(f=3693;3695>=f;f++)a[f]=0;for(f=3701;3727>=f;f++)a[f]=0;for(f=3728;3739>=f;f++)a[f]=2;for(f=3740;3751>=f;f++)a[f]=0;for(f=3753;3760>=
f;f++)a[f]=2;for(f=3761;3773>=f;f++)a[f]=0;for(f=3775;3777>=f;f++)a[f]=0;for(f=3779;3781>=f;f++)a[f]=0;for(f=3783;3785>=f;f++)a[f]=0;for(f=3788;3791>=f;f++)a[f]=0;for(f=3797;3802>=f;f++)a[f]=0;for(f=3814;3816>=f;f++)a[f]=0;for(f=3825;3829>=f;f++)a[f]=0;for(f=3832;3841>=f;f++)a[f]=0;for(f=3844;3852>=f;f++)a[f]=0;for(f=3873;3885>=f;f++)a[f]=0;for(f=3890;3893>=f;f++)a[f]=0;for(f=3907;3912>=f;f++)a[f]=0;for(f=3942;3950>=f;f++)a[f]=0;for(f=3968;3970>=f;f++)a[f]=0;for(f=3973;3976>=f;f++)a[f]=0;for(f=3986;3989>=
f;f++)a[f]=0;for(f=3994;3997>=f;f++)a[f]=0;for(f=4048;4051>=f;f++)a[f]=0;for(f=4056;4063>=f;f++)a[f]=0;for(f=4093;4096>=f;f++)a[f]=0;for(f=4390;4398>=f;f++)a[f]=0;for(f=4399;4413>=f;f++)a[f]=2;for(f=4418;4433>=f;f++)a[f]=2;for(f=4455;4457>=f;f++)a[f]=2;for(f=4484;4489>=f;f++)a[f]=0;for(f=4491;4554>=f;f++)a[f]=0;for(f=4568;4589>=f;f++)a[f]=0;for(f=4652;4656>=f;f++)a[f]=0;for(f=4766;4800>=f;f++)a[f]=0;for(f=5014;5016>=f;f++)a[f]=0;for(f=5069;5072>=f;f++)a[f]=0;for(f=5105;5130>=f;f++)a[f]=0;for(f=5173;5188>=
f;f++)a[f]=0;for(f=5253;5259>=f;f++)a[f]=0;for(f=5269;5275>=f;f++)a[f]=0;for(f=5292;5311>=f;f++)a[f]=0;for(f=5329;5331>=f;f++)a[f]=0;for(f=5343;5349>=f;f++)a[f]=0;for(f=5355;5357>=f;f++)a[f]=0;for(f=5387;5389>=f;f++)a[f]=0;for(f=5459;5463>=f;f++)a[f]=0;for(f=5479;5482>=f;f++)a[f]=0;for(f=5518;5520>=f;f++)a[f]=0;for(f=5530;5539>=f;f++)a[f]=0;for(f=5550;5552>=f;f++)a[f]=0;for(f=5562;5583>=f;f++)a[f]=0;for(f=5623;5625>=f;f++)a[f]=2;for(f=5631;5639>=f;f++)a[f]=0;for(f=5649;5653>=f;f++)a[f]=0;for(f=5663;5680>=
f;f++)a[f]=0;for(f=5682;5685>=f;f++)a[f]=0;for(f=5875;5877>=f;f++)a[f]=0;for(f=5896;5899>=f;f++)a[f]=0;for(f=5921;5940>=f;f++)a[f]=0;for(f=6050;6125>=f;f++)a[f]=0;for(f=6244;6275>=f;f++)a[f]=0;for(f=6328;6348>=f;f++)a[f]=0;for(f=6350;6356>=f;f++)a[f]=0;for(f=6366;6372>=f;f++)a[f]=0;for(f=6381;6387>=f;f++)a[f]=0;for(f=6393;6404>=f;f++)a[f]=0;for(f=6480;6483>=f;f++)a[f]=0;for(f=6511;6514>=f;f++)a[f]=0;for(f=6579;6581>=f;f++)a[f]=0;for(f=6619;6624>=f;f++)a[f]=0;for(f=6625;6627>=f;f++)a[f]=2;for(f=6628;6632>=
f;f++)a[f]=0;for(f=6634;6637>=f;f++)a[f]=0;for(f=6669;6692>=f;f++)a[f]=0;for(f=6707;6709>=f;f++)a[f]=0;for(f=6720;6723>=f;f++)a[f]=0;for(f=6732;6738>=f;f++)a[f]=0;for(f=6931;6933>=f;f++)a[f]=0;for(f=6956;6959>=f;f++)a[f]=0;for(f=7005;7007>=f;f++)a[f]=0;for(f=7057;7070>=f;f++)a[f]=2;for(f=7074;7082>=f;f++)a[f]=0;for(f=7109;7118>=f;f++)a[f]=0;for(f=7119;7127>=f;f++)a[f]=1;for(f=7374;7376>=f;f++)a[f]=0;for(f=7528;7586>=f;f++)a[f]=0;for(f=7587;7645>=f;f++)a[f]=2;for(f=7692;7696>=f;f++)a[f]=0;for(f=7755;7787>=
f;f++)a[f]=0;for(f=7791;7795>=f;f++)a[f]=0;for(f=7799;7801>=f;f++)a[f]=0;for(f=7803;7805>=f;f++)a[f]=0;for(f=7825;7831>=f;f++)a[f]=0;for(f=7845;7859>=f;f++)a[f]=0;for(f=8013;8032>=f;f++)a[f]=0;for(f=8065;8068>=f;f++)a[f]=1;for(f=8518;8529>=f;f++)a[f]=2;for(f=8533;8536>=f;f++)a[f]=2;for(f=8538;8540>=f;f++)a[f]=2;for(f=8677;8679>=f;f++)a[f]=0;for(f=8836;8840>=f;f++)a[f]=0;for(f=8857;8859>=f;f++)a[f]=0;for(f=8908;8910>=f;f++)a[f]=0;for(f=9154;9159>=f;f++)a[f]=0;for(f=9205;9218>=f;f++)a[f]=0;for(f=9271;9273>=
f;f++)a[f]=0;for(f=20002;20032>=f;f++)a[f]=0;for(f=20062;20092>=f;f++)a[f]=0;for(f=20135;20138>=f;f++)a[f]=0;for(f=20248;20258>=f;f++)a[f]=0;for(f=20348;20358>=f;f++)a[f]=0;for(f=20436;20440>=f;f++)a[f]=0;for(f=20822;20824>=f;f++)a[f]=0;for(f=20934;20936>=f;f++)a[f]=0;for(f=21035;21037>=f;f++)a[f]=0;for(f=21095;21097>=f;f++)a[f]=0;for(f=21148;21150>=f;f++)a[f]=0;for(f=21413;21423>=f;f++)a[f]=0;for(f=21453;21463>=f;f++)a[f]=0;for(f=21473;21483>=f;f++)a[f]=0;for(f=21780;21782>=f;f++)a[f]=0;for(f=21891;21894>=
f;f++)a[f]=0;for(f=21896;21899>=f;f++)a[f]=0;for(f=22171;22177>=f;f++)a[f]=0;for(f=22181;22187>=f;f++)a[f]=0;for(f=22191;22197>=f;f++)a[f]=0;for(f=22234;22236>=f;f++)a[f]=0;for(f=22521;22525>=f;f++)a[f]=0;for(f=22991;22994>=f;f++)a[f]=0;for(f=23028;23038>=f;f++)a[f]=0;for(f=23830;23853>=f;f++)a[f]=0;for(f=23866;23872>=f;f++)a[f]=0;for(f=23877;23884>=f;f++)a[f]=0;for(f=23886;23894>=f;f++)a[f]=0;for(f=23946;23948>=f;f++)a[f]=0;for(f=24311;24313>=f;f++)a[f]=0;for(f=24342;24347>=f;f++)a[f]=0;for(f=24370;24374>=
f;f++)a[f]=10;for(f=24375;24381>=f;f++)a[f]=0;for(f=24718;24721>=f;f++)a[f]=0;for(f=24817;24821>=f;f++)a[f]=0;for(f=24877;24882>=f;f++)a[f]=0;for(f=24891;24893>=f;f++)a[f]=0;for(f=25391;25395>=f;f++)a[f]=0;for(f=25828;25838>=f;f++)a[f]=0;for(f=26191;26195>=f;f++)a[f]=0;for(f=26391;26393>=f;f++)a[f]=0;for(f=26701;26722>=f;f++)a[f]=0;for(f=26729;26799>=f;f++)a[f]=2;for(f=26801;26803>=f;f++)a[f]=2;for(f=26811;26813>=f;f++)a[f]=2;for(f=26847;26870>=f;f++)a[f]=2;for(f=26891;26899>=f;f++)a[f]=0;for(f=26901;26923>=
f;f++)a[f]=0;for(f=26929;26946>=f;f++)a[f]=0;for(f=26948;26998>=f;f++)a[f]=0;for(f=27037;27040>=f;f++)a[f]=0;for(f=27205;27232>=f;f++)a[f]=0;for(f=27258;27260>=f;f++)a[f]=0;for(f=27391;27398>=f;f++)a[f]=0;for(f=27561;27564>=f;f++)a[f]=0;for(f=27571;27574>=f;f++)a[f]=0;for(f=27581;27584>=f;f++)a[f]=0;for(f=27591;27594>=f;f++)a[f]=0;for(f=28191;28193>=f;f++)a[f]=0;for(f=28348;28358>=f;f++)a[f]=0;for(f=28402;28432>=f;f++)a[f]=0;for(f=28462;28492>=f;f++)a[f]=0;for(f=29118;29122>=f;f++)a[f]=0;for(f=29168;29172>=
f;f++)a[f]=0;for(f=29177;29185>=f;f++)a[f]=0;for(f=29187;29195>=f;f++)a[f]=0;for(f=29900;29903>=f;f++)a[f]=0;for(f=30161;30179>=f;f++)a[f]=0;for(f=30491;30494>=f;f++)a[f]=0;for(f=30729;30732>=f;f++)a[f]=0;for(f=31251;31259>=f;f++)a[f]=0;for(f=31265;31268>=f;f++)a[f]=0;for(f=31275;31279>=f;f++)a[f]=0;for(f=31281;31297>=f;f++)a[f]=0;for(f=31461;31469>=f;f++)a[f]=0;for(f=31491;31495>=f;f++)a[f]=0;for(f=31917;31922>=f;f++)a[f]=0;for(f=31965;32E3>=f;f++)a[f]=0;for(f=32001;32003>=f;f++)a[f]=2;for(f=32005;32031>=
f;f++)a[f]=2;for(f=32033;32060>=f;f++)a[f]=2;for(f=32064;32067>=f;f++)a[f]=2;for(f=32074;32077>=f;f++)a[f]=2;for(f=32081;32086>=f;f++)a[f]=0;for(f=32107;32130>=f;f++)a[f]=0;for(f=32133;32158>=f;f++)a[f]=0;for(f=32164;32167>=f;f++)a[f]=2;for(f=32180;32199>=f;f++)a[f]=0;for(f=32201;32260>=f;f++)a[f]=0;for(f=32301;32360>=f;f++)a[f]=0;for(f=32601;32662>=f;f++)a[f]=0;for(f=32664;32667>=f;f++)a[f]=2;for(f=32701;32761>=f;f++)a[f]=0;for(f=53001;53004>=f;f++)a[f]=0;for(f=53008;53019>=f;f++)a[f]=0;for(f=53021;53032>=
f;f++)a[f]=0;for(f=53034;53037>=f;f++)a[f]=0;for(f=53042;53046>=f;f++)a[f]=0;for(f=53074;53080>=f;f++)a[f]=0;for(f=54001;54004>=f;f++)a[f]=0;for(f=54008;54019>=f;f++)a[f]=0;for(f=54021;54032>=f;f++)a[f]=0;for(f=54034;54037>=f;f++)a[f]=0;for(f=54042;54046>=f;f++)a[f]=0;for(f=54048;54053>=f;f++)a[f]=0;for(f=54074;54080>=f;f++)a[f]=0;for(f=54098;54101>=f;f++)a[f]=0;for(f=102001;102040>=f;f++)a[f]=0;for(f=102042;102063>=f;f++)a[f]=0;for(f=102065;102067>=f;f++)a[f]=0;for(f=102070;102117>=f;f++)a[f]=0;
for(f=102122;102216>=f;f++)a[f]=0;for(f=102221;102377>=f;f++)a[f]=0;for(f=102382;102388>=f;f++)a[f]=0;for(f=102389;102398>=f;f++)a[f]=2;for(f=102399;102444>=f;f++)a[f]=0;for(f=102445;102447>=f;f++)a[f]=2;for(f=102448;102458>=f;f++)a[f]=0;for(f=102459;102468>=f;f++)a[f]=2;for(f=102469;102499>=f;f++)a[f]=0;for(f=102500;102519>=f;f++)a[f]=1;for(f=102520;102524>=f;f++)a[f]=0;for(f=102525;102529>=f;f++)a[f]=2;for(f=102530;102588>=f;f++)a[f]=0;for(f=102590;102598>=f;f++)a[f]=0;for(f=102601;102603>=f;f++)a[f]=
0;for(f=102605;102628>=f;f++)a[f]=0;for(f=102629;102646>=f;f++)a[f]=2;for(f=102648;102700>=f;f++)a[f]=2;for(f=102701;102703>=f;f++)a[f]=0;for(f=102707;102730>=f;f++)a[f]=2;for(f=102733;102758>=f;f++)a[f]=2;for(f=102767;102900>=f;f++)a[f]=0;for(f=102965;102969>=f;f++)a[f]=0;for(f=102971;102973>=f;f++)a[f]=0;for(f=102975;102989>=f;f++)a[f]=0;for(f=102990;102992>=f;f++)a[f]=1;for(f=102997;103002>=f;f++)a[f]=0;for(f=103003;103008>=f;f++)a[f]=2;for(f=103009;103011>=f;f++)a[f]=0;for(f=103012;103014>=f;f++)a[f]=
2;for(f=103019;103021>=f;f++)a[f]=0;for(f=103022;103024>=f;f++)a[f]=2;for(f=103029;103031>=f;f++)a[f]=0;for(f=103032;103034>=f;f++)a[f]=2;for(f=103065;103068>=f;f++)a[f]=0;for(f=103074;103076>=f;f++)a[f]=0;for(f=103077;103079>=f;f++)a[f]=1;for(f=103080;103082>=f;f++)a[f]=0;for(f=103083;103085>=f;f++)a[f]=2;for(f=103090;103093>=f;f++)a[f]=0;for(f=103097;103099>=f;f++)a[f]=0;for(f=103100;103102>=f;f++)a[f]=2;for(f=103107;103109>=f;f++)a[f]=0;for(f=103110;103112>=f;f++)a[f]=2;for(f=103113;103116>=f;f++)a[f]=
0;for(f=103117;103120>=f;f++)a[f]=2;for(f=103153;103157>=f;f++)a[f]=0;for(f=103158;103162>=f;f++)a[f]=2;for(f=103163;103165>=f;f++)a[f]=0;for(f=103166;103168>=f;f++)a[f]=1;for(f=103169;103171>=f;f++)a[f]=2;for(f=103186;103188>=f;f++)a[f]=0;for(f=103189;103191>=f;f++)a[f]=2;for(f=103192;103195>=f;f++)a[f]=0;for(f=103196;103199>=f;f++)a[f]=2;for(f=103200;103224>=f;f++)a[f]=0;for(f=103225;103227>=f;f++)a[f]=1;for(f=103232;103237>=f;f++)a[f]=0;for(f=103238;103243>=f;f++)a[f]=2;for(f=103244;103246>=f;f++)a[f]=
0;for(f=103247;103249>=f;f++)a[f]=2;for(f=103254;103256>=f;f++)a[f]=0;for(f=103257;103259>=f;f++)a[f]=2;for(f=103264;103266>=f;f++)a[f]=0;for(f=103267;103269>=f;f++)a[f]=2;for(f=103300;103375>=f;f++)a[f]=0;for(f=103381;103383>=f;f++)a[f]=0;for(f=103384;103386>=f;f++)a[f]=1;for(f=103387;103389>=f;f++)a[f]=0;for(f=103390;103392>=f;f++)a[f]=2;for(f=103397;103399>=f;f++)a[f]=0;for(f=103400;103471>=f;f++)a[f]=2;for(f=103476;103478>=f;f++)a[f]=0;for(f=103479;103481>=f;f++)a[f]=2;for(f=103486;103488>=f;f++)a[f]=
0;for(f=103489;103491>=f;f++)a[f]=2;for(f=103492;103495>=f;f++)a[f]=0;for(f=103496;103499>=f;f++)a[f]=2;for(f=103528;103543>=f;f++)a[f]=0;for(f=103544;103548>=f;f++)a[f]=2;for(f=103549;103551>=f;f++)a[f]=0;for(f=103552;103554>=f;f++)a[f]=1;for(f=103555;103557>=f;f++)a[f]=2;for(f=103558;103560>=f;f++)a[f]=0;for(f=103571;103573>=f;f++)a[f]=0;for(f=103574;103576>=f;f++)a[f]=2;for(f=103577;103580>=f;f++)a[f]=0;for(f=103581;103583>=f;f++)a[f]=2;for(f=103595;103598>=f;f++)a[f]=0;for(f=103600;103694>=f;f++)a[f]=
0;for(f=103696;103699>=f;f++)a[f]=0;for(f=103700;103793>=f;f++)a[f]=2;for(f=103794;103871>=f;f++)a[f]=0;for(f=103900;103971>=f;f++)a[f]=2;return a})},"esri/geometry/Point":function(){define("require exports tslib ../core/Logger ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ./Geometry ./SpatialReference ./support/offset ./support/spatialReferenceUtils ./support/webMercatorUtils".split(" "),function(f,a,e,m,k,l,g,c,h,b,d){function n(b){return b&&("esri.geometry.SpatialReference"===
b.declaredClass||null!=b.wkid)}var p=[0,0],r=m.getLogger("esri.geometry.Point");f=function(g){function a(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];b=g.apply(this,b)||this;b.x=0;b.y=0;b.z=void 0;b.m=void 0;b.type="point";return b}e.__extends(a,g);q=a;a.copy=function(b,d){d._set("x",b._get("x"));d._set("y",b._get("y"));d._set("z",b._get("z"));d._set("m",b._get("m"));b=b._get("spatialReference");d._set("spatialReference",Object.isFrozen(b)?b:b.clone())};a.distance=function(b,d){var c=
b.x-d.x,h=b.y-d.y;b=b.hasZ&&d.hasZ?b.z-d.z:0;return Math.sqrt(c*c+h*h+b*b)};a.prototype.normalizeCtorArgs=function(b,h,a,g,e){var q;if(Array.isArray(b))q=b,e=h,b=q[0],h=q[1],a=q[2],g=q[3];else if(b&&"object"===typeof b){if(q=b,b=null!=q.x?q.x:q.longitude,h=null!=q.y?q.y:q.latitude,a=null!=q.z?q.z:q.altitude,g=q.m,(e=q.spatialReference)&&"esri.geometry.SpatialReference"!==e.declaredClass&&(e=new c(e)),null!=q.longitude||null!=q.latitude)null==q.longitude?r.warn(".longitude\x3d","Latitude was defined without longitude"):
null==q.latitude?r.warn(".latitude\x3d","Longitude was defined without latitude"):!q.declaredClass&&e&&e.isWebMercator&&(h=d.lngLatToXY(q.longitude,q.latitude,p),b=h[0],h=h[1])}else n(a)?(e=a,a=null):n(g)&&(e=g,g=null);b={x:b,y:h};null==b.x&&null!=b.y?r.warn(".y\x3d","Y coordinate was defined without an X coordinate"):null==b.y&&null!=b.x&&r.warn(".x\x3d","X coordinate was defined without a Y coordinate");null!=e&&(b.spatialReference=e);null!=a&&(b.z=a);null!=g&&(b.m=g);return b};Object.defineProperty(a.prototype,
"hasM",{get:function(){return void 0!==this.m},set:function(b){b!==this.hasM&&(this._set("m",b?0:void 0),this._set("hasM",b))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasZ",{get:function(){return void 0!==this.z},set:function(b){b!==this.hasZ&&(this._set("z",b?0:void 0),this._set("hasZ",b))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"latitude",{get:function(){var b=this._get("spatialReference");if(b){if(b.isWebMercator)return d.xyToLngLat(this.x,
this.y,p)[1];if(b.isGeographic)return this._get("y")}return null},set:function(b){var c=this._get("spatialReference");c&&(c.isWebMercator?this._set("y",d.lngLatToXY(this.x,b,p)[1]):c.isGeographic&&this._set("y",b),this._set("latitude",b))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"longitude",{get:function(){var b=this._get("spatialReference");if(b){if(b.isWebMercator)return d.xyToLngLat(this._get("x"),this._get("y"),p)[0];if(b.isGeographic)return this._get("x")}return null},
set:function(b){var c=this._get("spatialReference");c&&(c.isWebMercator?this._set("x",d.lngLatToXY(b,this._get("y"),p)[0]):c.isGeographic&&this._set("x",b),this._set("longitude",b))},enumerable:!0,configurable:!0});a.prototype.writeX=function(b,d,c){d[c]=isNaN(b)?"NaN":b};a.prototype.readX=function(b){return"string"===typeof b?NaN:b};a.prototype.clone=function(){var b=new q;b.x=this.x;b.y=this.y;b.z=this.z;b.m=this.m;b.spatialReference=this.spatialReference;return b};a.prototype.copy=function(b){q.copy(b,
this);return this};a.prototype.equals=function(b){var c;if(!b)return!1;var h=this.x,n=this.y,a=this.z,g=this.m,e=this.spatialReference,p=b.z,q=b.m,r=b.x;c=b.y;b=b.spatialReference;if(!e.equals(b))if(e.isWebMercator&&b.isWGS84)c=d.lngLatToXY(r,c),r=c[0],c=c[1],b=e;else if(e.isWGS84&&b.isWebMercator)c=d.xyToLngLat(r,c),r=c[0],c=c[1],b=e;else return!1;return h===r&&n===c&&a===p&&g===q&&e.wkid===b.wkid};a.prototype.offset=function(b,d,c){return h.offsetPoint(this,b,d,c)};a.prototype.normalize=function(){if(!this.spatialReference)return this;
var d=b.getInfo(this.spatialReference);if(!d)return this;var c=this.x,h=d.valid,d=h[0],n=h[1],h=2*n;c>n?(d=Math.ceil(Math.abs(c-n)/h),c-=d*h):c<d&&(d=Math.ceil(Math.abs(c-d)/h),c+=d*h);this._set("x",c);return this};a.prototype.distance=function(b){return q.distance(this,b)};a.prototype.toArray=function(){var b=this.hasZ,d=this.hasM;return b&&d?[this.x,this.y,this.z,this.m]:b?[this.x,this.y,this.z]:d?[this.x,this.y,this.m]:[this.x,this.y]};a.prototype.toJSON=function(b){return this.write(null,b)};
var q;e.__decorate([k.property({dependsOn:["x","y","z","m","spatialReference"]})],a.prototype,"cache",void 0);e.__decorate([k.property({type:Boolean,dependsOn:["m"],json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],a.prototype,"hasM",null);e.__decorate([k.property({type:Boolean,dependsOn:["z"],json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],a.prototype,"hasZ",null);e.__decorate([k.property({type:Number,dependsOn:["y"]})],a.prototype,"latitude",null);e.__decorate([k.property({type:Number,
dependsOn:["x"]})],a.prototype,"longitude",null);e.__decorate([k.property({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),k.cast(function(b){return isNaN(b)?b:l.ensureNumber(b)})],a.prototype,"x",void 0);e.__decorate([k.writer("x")],a.prototype,"writeX",null);e.__decorate([k.reader("x")],a.prototype,"readX",null);e.__decorate([k.property({type:Number,json:{write:!0}})],a.prototype,"y",void 0);e.__decorate([k.property({type:Number,json:{write:{overridePolicy:function(){return{enabled:this.hasZ}}}}})],
a.prototype,"z",void 0);e.__decorate([k.property({type:Number,json:{write:{overridePolicy:function(){return{enabled:this.hasM}}}}})],a.prototype,"m",void 0);return a=q=e.__decorate([k.subclass("esri.geometry.Point")],a)}(g);f.prototype.toJSON.isDefaultToJSON=!0;return f})},"esri/geometry/support/offset":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});a.offsetPoint=function(a,f,k,l){a.x+=f;a.y+=k;null!=l&&null!=a.z&&(a.z+=l);return a};a.offsetCoordsX=
function(a,f){a[0]+=f;return a}})},"esri/geometry/support/webMercatorUtils":function(){define("require exports ../../core/lang ../../core/wgs84Constants ../SpatialReference ./spatialReferenceUtils".split(" "),function(f,a,e,m,k,l){function g(b,d,c,h,n){var a;if("x"in b&&"x"in n)d=d(b.x,b.y,p,h),n.x=d[0],n.y=d[1];else if("xmin"in b&&"xmin"in n)a=d(b.xmin,b.ymin,p,h),n.xmin=a[0],n.ymin=a[1],d=d(b.xmax,b.ymax,p,h),n.xmax=d[0],n.ymax=d[1];else if("paths"in b&&"paths"in n||"rings"in b&&"rings"in n){a=
"paths"in b?b.paths:b.rings;var g=[],e=void 0;for(b=0;b<a.length;b++){var q=a[b],e=[];g.push(e);for(var r=0;r<q.length;r++)e.push(d(q[r][0],q[r][1],[0,0],h)),2<q[r].length&&e[r].push(q[r][2]),3<q[r].length&&e[r].push(q[r][3])}"paths"in n?n.paths=g:n.rings=g}else if("points"in b&&"points"in n){a=b.points;g=[];for(b=0;b<a.length;b++)g[b]=d(a[b][0],a[b][1],[0,0],h),2<a[b].length&&g[b].push(a[b][2]),3<a[b].length&&g[b].push(a[b][3]);n.points=g}else if("type"in b&&"mesh"===b.type&&"type"in n&&"mesh"===
n.type&&(a=b.vertexAttributes&&b.vertexAttributes.position,g=n.vertexAttributes&&n.vertexAttributes.position,a))for(e=[0,0],b=0;b<a.length;b+=3)d(a[b],a[b+1],e,h),g[b]=e[0],g[b+1]=e[1];n.spatialReference=c;return n}function c(b,d){b=b&&(null!=b.wkid||null!=b.wkt?b:b.spatialReference);d=d&&(null!=d.wkid||null!=d.wkt?d:d.spatialReference);return b&&d?l.equals(d,b)?!0:l.isWebMercator(d)&&l.isWGS84(b)||l.isWebMercator(b)&&l.isWGS84(d):!1}function h(b,c,h){void 0===h&&(h=[0,0]);89.99999<c?c=89.99999:-89.99999>
c&&(c=-89.99999);c*=.017453292519943;h[0]=.017453292519943*b*d;h[1]=n*Math.log((1+Math.sin(c))/(1-Math.sin(c)));return h}function b(b,c,h,n){void 0===h&&(h=[0,0]);void 0===n&&(n=!1);b=b/d*57.29577951308232;h[0]=n?b:b-360*Math.floor((b+180)/360);h[1]=57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-1*c/d)));return h}Object.defineProperty(a,"__esModule",{value:!0});var d=m.wgs84Radius,n=d/2,p=[0,0];a.canProject=c;a.project=function(d,n){var a=d&&d.spatialReference;n=n&&(null!=n.wkid||null!=n.wkt?
n:n.spatialReference);return c(a,n)?l.equals(a,n)?e.clone(d):l.isWebMercator(n)?g(d,h,k.WebMercator,!1,e.clone(d)):l.isWGS84(n)?g(d,b,k.WGS84,!1,e.clone(d)):null:null};a.lngLatToXY=h;a.xyToLngLat=b;a.geographicToWebMercator=function(b,d,c){void 0===d&&(d=!1);void 0===c&&(c=e.clone(b));return g(b,h,k.WebMercator,d,c)};a.webMercatorToGeographic=function(d,c,h){void 0===c&&(c=!1);void 0===h&&(h=e.clone(d));return g(d,b,k.WGS84,c,h)}})},"esri/core/wgs84Constants":function(){define(["require","exports"],
function(f,a){Object.defineProperty(a,"__esModule",{value:!0});a.wgs84Radius=6378137;a.wgs84InverseFlattening=298.257223563;a.wgs84Flattening=1/a.wgs84InverseFlattening;a.wgs84PolarRadius=a.wgs84Radius*(1-a.wgs84Flattening);a.wgs84Eccentricity=.0818191908426215})},"esri/geometry/support/contains":function(){define(["require","exports"],function(f,a){function e(c,h){return m(c,h[0],h[1])}function m(c,h,b,d){return h>=c.xmin&&h<=c.xmax&&b>=c.ymin&&b<=c.ymax?null!=d&&c.hasZ?d>=c.zmin&&d<=c.zmax:!0:!1}
function k(c,h){if(c=c.rings)if(Array.isArray(c[0][0])){for(var b=!1,d=0,n=c.length;d<n;d++)b=l(b,c[d],h);h=b}else h=l(!1,c,h);else h=!1;return h}function l(c,h,b){var d=b[0];b=b[1];for(var n=0,a=0,g=h.length;a<g;a++){n++;n===g&&(n=0);var e=h[a],x=e[0],e=e[1],u=h[n],l=u[0],u=u[1];(e<b&&u>=b||u<b&&e>=b)&&x+(b-e)/(u-e)*(l-x)<d&&(c=!c)}return c}Object.defineProperty(a,"__esModule",{value:!0});var g=[0,0];a.extentContainsPoint=function(c,h){return m(c,h.x,h.y,h.z)};a.extentContainsMultipoint=function(c,
h){if(!h.points||h.points.length)return!1;var b=0;for(h=h.points;b<h.length;b++)if(!e(c,h[b]))return!1;return!0};a.extentContainsExtent=function(c,h){var b=h.xmin,d=h.ymin,n=h.zmin,a=h.xmax,g=h.ymax,e=h.zmax;return c.hasZ&&h.hasZ?m(c,b,d,n)&&m(c,b,g,n)&&m(c,a,g,n)&&m(c,a,d,n)&&m(c,b,d,e)&&m(c,b,g,e)&&m(c,a,g,e)&&m(c,a,d,e):m(c,b,d)&&m(c,b,g)&&m(c,a,g)&&m(c,a,d)};a.extentContainsCoords2D=e;a.extentContainsCoords3D=function(c,h){return m(c,h[0],h[1],h[2])};a.polygonContainsPoint=function(c,h){g[1]=
h.y;g[0]=h.x;return k(c,g)};a.polygonContainsCoords=k})},"esri/geometry/support/intersects":function(){define(["require","exports","./contains"],function(f,a,e){function m(b,d){return e.extentContainsPoint(b,d)}function k(b,d){var c=b.hasZ&&d.hasZ,h;if(b.xmin<=d.xmin){if(h=d.xmin,b.xmax<h)return!1}else if(h=b.xmin,d.xmax<h)return!1;if(b.ymin<=d.ymin){if(h=d.ymin,b.ymax<h)return!1}else if(h=b.ymin,d.ymax<h)return!1;if(c&&d.hasZ)if(b.zmin<=d.zmin){if(c=d.zmin,b.zmax<c)return!1}else if(c=b.zmin,d.zmax<
c)return!1;return!0}function l(b,d){var c=d.hasZ?e.extentContainsCoords3D:e.extentContainsCoords2D,h=0;for(d=d.points;h<d.length;h++)if(c(b,d[h]))return!0;return!1}function g(b,c){d[0]=b.xmin;d[1]=b.ymax;n[0]=b.xmax;n[1]=b.ymax;p[0]=b.xmin;p[1]=b.ymin;r[0]=b.xmax;r[1]=b.ymin;for(var a=0,g=q;a<g.length;a++)if(e.polygonContainsCoords(c,g[a]))return!0;a=0;for(c=c.rings;a<c.length;a++)if(g=c[a],g.length){var u=g[0];if(e.extentContainsCoords2D(b,u))return!0;for(var l=1;l<g.length;l++){var v=g[l];if(e.extentContainsCoords2D(b,
v)||h(u,v,x))return!0;u=v}}return!1}function c(b,c){d[0]=b.xmin;d[1]=b.ymax;n[0]=b.xmax;n[1]=b.ymax;p[0]=b.xmin;p[1]=b.ymin;r[0]=b.xmax;r[1]=b.ymin;c=c.paths;for(var a=0;a<c.length;a++){var g=c[a];if(c.length){var q=g[0];if(e.extentContainsCoords2D(b,q))return!0;for(var u=1;u<g.length;u++){var l=g[u];if(e.extentContainsCoords2D(b,l)||h(q,l,x))return!0;q=l}}}return!1}function h(d,c,h){for(var n=0;n<h.length;n++)if(b(d,c,h[n][0],h[n][1]))return!0;return!1}function b(b,d,c,h,n){var a=b[0];b=b[1];var g=
d[0];d=d[1];var e=c[0],p=c[1];c=h[0]-e;var e=a-e,q=g-a;h=h[1]-p;var p=b-p,r=d-b,u=h*q-c*r;if(0===u)return!1;c=(c*p-h*e)/u;e=(q*p-r*e)/u;return 0<=c&&1>=c&&0<=e&&1>=e?(n&&(n[0]=a+c*(g-a),n[1]=b+c*(d-b)),!0):!1}Object.defineProperty(a,"__esModule",{value:!0});a.extentIntersectsPoint=m;a.extentIntersectsExtent=k;a.extentIntersectsMultipoint=l;var d=[0,0],n=[0,0],p=[0,0],r=[0,0],q=[d,n,p,r],x=[[p,d],[d,n],[n,r],[r,p]];a.extentIntersectsPolygon=g;a.extentIntersectsPolyline=c;var u=[0,0];a.isSelfIntersecting=
function(d){for(var c=0;c<d.length;c++){for(var h=d[c],n=0;n<h.length-1;n++)for(var a=h[n],g=h[n+1],e=c+1;e<d.length;e++)for(var p=0;p<d[e].length-1;p++){var q=d[e][p],r=d[e][p+1],x=b(a,g,q,r,u);if(x&&!(u[0]===a[0]&&u[1]===a[1]||u[0]===q[0]&&u[1]===q[1]||u[0]===g[0]&&u[1]===g[1]||u[0]===r[0]&&u[1]===r[1]))return!0}p=h.length;if(!(4>=p))for(n=0;n<p-3;n++){var l=p-1;0===n&&(l=p-2);a=h[n];g=h[n+1];for(e=n+2;e<l;e++)if(q=h[e],r=h[e+1],(x=b(a,g,q,r,u))&&!(u[0]===a[0]&&u[1]===a[1]||u[0]===q[0]&&u[1]===
q[1]||u[0]===g[0]&&u[1]===g[1]||u[0]===r[0]&&u[1]===r[1]))return!0}}return!1};a.segmentIntersects=b;a.getExtentIntersector=function(b){switch(b){case "esriGeometryEnvelope":case "extent":return k;case "esriGeometryMultipoint":case "multipoint":return l;case "esriGeometryPoint":case "point":return m;case "esriGeometryPolygon":case "polygon":return g;case "esriGeometryPolyline":case "polyline":return c;case "mesh":return k}}})},"esri/geometry/Multipoint":function(){define("require exports tslib ../core/lang ../core/accessorSupport/decorators ./Extent ./Geometry ./Point ./support/zmUtils".split(" "),
function(f,a,e,m,k,l,g,c,h){function b(b){return function(d,c){return null==d?c:null==c?d:b(d,c)}}f=function(d){function n(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=d.apply(this,b)||this;b.points=[];b.type="multipoint";return b}e.__extends(n,d);a=n;n.prototype.normalizeCtorArgs=function(b,d){if(!b&&!d)return null;var c={};Array.isArray(b)?(c.points=b,c.spatialReference=d):!b||"esri.geometry.SpatialReference"!==b.declaredClass&&null==b.wkid?(b.points&&(c.points=b.points),b.spatialReference&&
(c.spatialReference=b.spatialReference),b.hasZ&&(c.hasZ=b.hasZ),b.hasM&&(c.hasM=b.hasM)):c.spatialReference=b;if(b=c.points&&c.points[0])void 0===c.hasZ&&void 0===c.hasM?(c.hasZ=2<b.length,c.hasM=!1):void 0===c.hasZ?c.hasZ=3<b.length:void 0===c.hasM&&(c.hasM=3<b.length);return c};Object.defineProperty(n.prototype,"extent",{get:function(){var d=this.points;if(!d.length)return null;for(var c=new l,h=this.hasZ,n=this.hasM,a=h?3:2,g=d[0],e=b(Math.min),p=b(Math.max),f=g[0],k=g[1],m=g[0],g=g[1],E,F,I,J,
G=0,H=d.length;G<H;G++){var K=d[G],O=K[0],L=K[1],f=e(f,O),k=e(k,L),m=p(m,O),g=p(g,L);h&&2<K.length&&(O=K[2],E=e(E,O),I=p(I,O));n&&K.length>a&&(K=K[a],F=e(F,K),J=p(J,K))}c.xmin=f;c.ymin=k;c.xmax=m;c.ymax=g;c.spatialReference=this.spatialReference;h?(c.zmin=E,c.zmax=I):(c.zmin=null,c.zmax=null);n?(c.mmin=F,c.mmax=J):(c.mmin=null,c.mmax=null);return c},enumerable:!0,configurable:!0});n.prototype.writePoints=function(b,d){d.points=m.clone(this.points)};n.prototype.addPoint=function(b){this.clearCache();
h.updateSupportFromPoint(this,b);Array.isArray(b)?this.points.push(b):this.points.push(b.toArray());return this};n.prototype.clone=function(){var b={points:m.clone(this.points),spatialReference:this.spatialReference};this.hasZ&&(b.hasZ=!0);this.hasM&&(b.hasM=!0);return new a(b)};n.prototype.getPoint=function(b){if(!this._validateInputs(b))return null;b=this.points[b];var d={x:b[0],y:b[1],spatialReference:this.spatialReference},h=2;this.hasZ&&(d.z=b[2],h=3);this.hasM&&(d.m=b[h]);return new c(d)};n.prototype.removePoint=
function(b){if(!this._validateInputs(b))return null;this.clearCache();return new c(this.points.splice(b,1)[0],this.spatialReference)};n.prototype.setPoint=function(b,d){if(!this._validateInputs(b))return this;this.clearCache();h.updateSupportFromPoint(this,d);Array.isArray(d)||(d=d.toArray());this.points[b]=d;return this};n.prototype.toJSON=function(b){return this.write(null,b)};n.prototype._validateInputs=function(b){return null!=b&&0<=b&&b<this.points.length};var a;e.__decorate([k.property({dependsOn:["points",
"hasZ","hasM","spatialReference"]})],n.prototype,"cache",void 0);e.__decorate([k.property({dependsOn:["cache"]})],n.prototype,"extent",null);e.__decorate([k.property({type:[[Number]],json:{write:{isRequired:!0}}})],n.prototype,"points",void 0);e.__decorate([k.writer("points")],n.prototype,"writePoints",null);return n=a=e.__decorate([k.subclass("esri.geometry.Multipoint")],n)}(g);f.prototype.toJSON.isDefaultToJSON=!0;return f})},"esri/geometry/support/zmUtils":function(){define(["require","exports"],
function(f,a){Object.defineProperty(a,"__esModule",{value:!0});a.updateSupportFromPoint=function(a,f,k){void 0===k&&(k=!1);var e=a.hasM,g=a.hasZ;Array.isArray(f)?4!==f.length||e||g?3===f.length&&k&&!e?(g=!0,e=!1):3===f.length&&e&&g&&(g=e=!1):g=e=!0:(g=!g&&f.hasZ&&(!e||f.hasM),e=!e&&f.hasM&&(!g||f.hasZ));a.hasZ=g;a.hasM=e}})},"esri/geometry/Polygon":function(){define("require exports tslib ../core/lang ../core/accessorSupport/decorators ./Extent ./Geometry ./Point ./SpatialReference ./support/centroid ./support/contains ./support/coordsUtils ./support/extentUtils ./support/intersects ./support/webMercatorUtils ./support/zmUtils".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x){f=function(a){function g(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];b=a.apply(this,b)||this;b.rings=[];b.type="polygon";return b}e.__extends(g,a);u=g;g.fromExtent=function(b){var d=b.clone().normalize();b=b.spatialReference;var c=!1,h=!1;d.map(function(b){b.hasZ&&(c=!0);b.hasM&&(h=!0)});d={rings:d.map(function(b){var d=[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]];if(c&&b.hasZ)for(var a=b.zmin+.5*(b.zmax-
b.zmin),n=0;n<d.length;n++)d[n].push(a);if(h&&b.hasM)for(b=b.mmin+.5*(b.mmax-b.mmin),n=0;n<d.length;n++)d[n].push(b);return d}),spatialReference:b};c&&(d.hasZ=!0);h&&(d.hasM=!0);return new u(d)};g.prototype.normalizeCtorArgs=function(b,d){var c=null,a,n,g=null;b&&!Array.isArray(b)?(c=b.rings?b.rings:null,d||(b.spatialReference?d=b.spatialReference:b.rings||(d=b)),a=b.hasZ,n=b.hasM):c=b;c=c||[];d=d||h.WGS84;c.length&&c[0]&&null!=c[0][0]&&"number"===typeof c[0][0]&&(c=[c]);if(g=c[0]&&c[0][0])void 0===
a&&void 0===n?(a=2<g.length,n=!1):void 0===a?a=!n&&3<g.length:void 0===n&&(n=!a&&3<g.length);return{rings:c,spatialReference:d,hasZ:a,hasM:n}};Object.defineProperty(g.prototype,"centroid",{get:function(){var d=b.polygonCentroid(this);if(!d||isNaN(d[0])||isNaN(d[1])||this.hasZ&&isNaN(d[2]))return null;var h=new c;h.x=d[0];h.y=d[1];h.spatialReference=this.spatialReference;this.hasZ&&(h.z=d[2]);return h},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"extent",{get:function(){var b=
this.spatialReference,d=p.getPolygonExtent(this);if(!d)return null;d=new l(d);d.spatialReference=b;return d},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"isSelfIntersecting",{get:function(){return r.isSelfIntersecting(this.rings)},enumerable:!0,configurable:!0});g.prototype.writePaths=function(b,d){d.rings=m.clone(this.rings)};g.prototype.addRing=function(b){if(b){this.clearCache();var d=this.rings,c=d.length;if(Array.isArray(b[0]))d[c]=b.concat();else{for(var h=[],a=0,n=b.length;a<
n;a++)h[a]=b[a].toArray();d[c]=h}return this}};g.prototype.clone=function(){var b=new u;b.spatialReference=this.spatialReference;b.rings=m.clone(this.rings);b.hasZ=this.hasZ;b.hasM=this.hasM;return b};g.prototype.contains=function(b){if(!b)return!1;q.canProject(b,this.spatialReference)&&(b=q.project(b,this.spatialReference));return d.polygonContainsPoint(this,b)};g.prototype.isClockwise=function(b){var d=this;b=Array.isArray(b[0])?b:b.map(function(b){return d.hasZ?d.hasM?[b.x,b.y,b.z,b.m]:[b.x,b.y,
b.z]:[b.x,b.y]});return n.isClockwise(b,this.hasM,this.hasZ)};g.prototype.getPoint=function(b,d){if(!this._validateInputs(b,d))return null;b=this.rings[b][d];d=this.hasZ;var h=this.hasM;return d&&!h?new c(b[0],b[1],b[2],void 0,this.spatialReference):h&&!d?new c(b[0],b[1],void 0,b[2],this.spatialReference):d&&h?new c(b[0],b[1],b[2],b[3],this.spatialReference):new c(b[0],b[1],this.spatialReference)};g.prototype.insertPoint=function(b,d,c){if(!this._validateInputs(b,d,!0))return this;this.clearCache();
x.updateSupportFromPoint(this,c);Array.isArray(c)||(c=c.toArray());this.rings[b].splice(d,0,c);return this};g.prototype.removePoint=function(b,d){if(!this._validateInputs(b,d))return null;this.clearCache();return new c(this.rings[b].splice(d,1)[0],this.spatialReference)};g.prototype.removeRing=function(b){if(!this._validateInputs(b,null))return null;this.clearCache();b=this.rings.splice(b,1)[0];var d=this.spatialReference;return b.map(function(b){return new c(b,d)})};g.prototype.setPoint=function(b,
d,c){if(!this._validateInputs(b,d))return this;this.clearCache();x.updateSupportFromPoint(this,c);Array.isArray(c)||(c=c.toArray());this.rings[b][d]=c;return this};g.prototype._validateInputs=function(b,d,c){void 0===c&&(c=!1);return null==b||0>b||b>=this.rings.length||null!=d&&(b=this.rings[b],c&&(0>d||d>b.length)||!c&&(0>d||d>=b.length))?!1:!0};g.prototype.toJSON=function(b){return this.write(null,b)};var u;e.__decorate([k.property({dependsOn:["hasM","hasZ","rings"]})],g.prototype,"cache",void 0);
e.__decorate([k.property({readOnly:!0,dependsOn:["cache"]})],g.prototype,"centroid",null);e.__decorate([k.property({dependsOn:["cache"],readOnly:!0})],g.prototype,"extent",null);e.__decorate([k.property({dependsOn:["cache"],readOnly:!0})],g.prototype,"isSelfIntersecting",null);e.__decorate([k.property({type:[[[Number]]],json:{write:{isRequired:!0}}})],g.prototype,"rings",void 0);e.__decorate([k.writer("rings")],g.prototype,"writePaths",null);return g=u=e.__decorate([k.subclass("esri.geometry.Polygon")],
g)}(g);f.prototype.toJSON.isDefaultToJSON=!0;return f})},"esri/geometry/support/centroid":function(){define(["require","exports","./coordsUtils"],function(f,a,e){function m(a,c){if(!a||!a.length)return null;for(var h=[],b=[],d=c?[Infinity,-Infinity,Infinity,-Infinity,Infinity,-Infinity]:[Infinity,-Infinity,Infinity,-Infinity],n=0,g=a.length;n<g;n++){var e=k(a[n],c,d);e&&b.push(e)}b.sort(function(b,d){var h=b[2]-d[2];0===h&&c&&(h=b[4]-d[4]);return h});b.length&&(n=6*b[0][2],h[0]=b[0][0]/n,h[1]=b[0][1]/
n,c&&(n=6*b[0][4],h[2]=0!==n?b[0][3]/n:0),h[0]<d[0]||h[0]>d[1]||h[1]<d[2]||h[1]>d[3]||c&&(h[2]<d[4]||h[2]>d[5]))&&(h.length=0);if(!h.length)if(a=a[0]&&a[0].length?l(a[0],c):null)h[0]=a[0],h[1]=a[1],c&&2<a.length&&(h[2]=a[2]);else return null;return h}function k(a,c,h){for(var b=0,d=0,n=0,g=0,e=0,q=0;q<a.length;q++){var l=a[q],u=l[0],v=l[1],f=l[2],k=a[(q+1)%a.length],m=k[0],B=k[1],D=k[2],C=u*B-m*v,g=g+C,b=b+(u+m)*C,d=d+(v+B)*C;c&&2<l.length&&2<k.length&&(C=u*D-m*f,n+=(f+D)*C,e+=C);u<h[0]&&(h[0]=u);
u>h[1]&&(h[1]=u);v<h[2]&&(h[2]=v);v>h[3]&&(h[3]=v);c&&(f<h[4]&&(h[4]=f),f>h[5]&&(h[5]=f))}0<g&&(g*=-1);0<e&&(e*=-1);if(!g)return null;a=[b,d,.5*g];c&&(a[3]=n,a[4]=.5*e);return a}function l(a,c){for(var h=c?[0,0,0]:[0,0],b=c?[0,0,0]:[0,0],d=0,n=0,g=0,r=0,q=0,l=a.length;q<l-1;q++){var u=a[q],v=a[q+1];if(u&&v){h[0]=u[0];h[1]=u[1];b[0]=v[0];b[1]=v[1];c&&2<u.length&&2<v.length&&(h[2]=u[2],b[2]=v[2]);var f=e.getLength(h,b);f&&(d+=f,u=e.getMidpoint(u,v),n+=f*u[0],g+=f*u[1],c&&2<u.length&&(r+=f*u[2]))}}return 0<
d?c?[n/d,g/d,r/d]:[n/d,g/d]:a.length?a[0]:null}Object.defineProperty(a,"__esModule",{value:!0});a.extentCentroid=function(a){return a?a.hasZ?[a.xmax-a.xmin/2,a.ymax-a.ymin/2,a.zmax-a.zmin/2]:[a.xmax-a.xmin/2,a.ymax-a.ymin/2]:null};a.polygonCentroid=function(a){return a?m(a.rings,a.hasZ):null};a.ringsCentroid=m;a.lineCentroid=l})},"esri/geometry/support/coordsUtils":function(){define(["require","exports","./spatialReferenceUtils"],function(f,a,e){function m(c,h){var b=h[0]-c[0],d=h[1]-c[1];return 2<
c.length&&2<h.length?(c=c[2]-h[2],Math.sqrt(b*b+d*d+c*c)):Math.sqrt(b*b+d*d)}function k(c,h,b){var d=c[0]+b*(h[0]-c[0]),a=c[1]+b*(h[1]-c[1]);return 2<c.length&&2<h.length?[d,a,c[2]+b*(h[2]-c[2])]:[d,a]}function l(c,h,b){for(var d=c.length,a=0,g=0,e=0,q=0;q<d;q++){var l=c[q],u=c[(q+1)%d],f=2,a=a+(l[0]*u[1]-u[0]*l[1]);2<l.length&&2<u.length&&b&&(g+=l[0]*u[2]-u[0]*l[2],f=3);l.length>f&&u.length>f&&h&&(e+=l[0]*u[f]-u[0]*l[f])}return 0>=a&&0>=g&&0>=e}function g(c,h){if(h=e.getInfo(h)){var b=h.valid[0],
d=h.valid[1],a=d-b;h=function(c){var h=Infinity,n=-Infinity;c.forEach(function(c){for(var g=c[0];g<b;)g+=a;for(;g>d;)g-=a;h=Math.min(h,g);n=Math.max(n,g);c[0]=g});var g=n-h;a-g<g&&c.forEach(function(b){0>b[0]&&(b[0]+=a)})};for(var g=0;g<c.length;g++)h(c[g])}}Object.defineProperty(a,"__esModule",{value:!0});a.geometryToCoordinates=function(c){if(!c)return null;if(Array.isArray(c))return c;var h=c.hasZ,b=c.hasM;if("point"===c.type)return b&&h?[c.x,c.y,c.z,c.m]:h?[c.x,c.y,c.z]:b?[c.x,c.y,c.m]:[c.x,c.y];
if("polygon"===c.type)return c.rings.slice(0);if("polyline"===c.type)return c.paths.slice(0);if("multipoint"===c.type)return c.points.slice(0);if("extent"===c.type){c=c.clone().normalize();if(!c)return null;var d=!1,a=!1;c.forEach(function(b){b.hasZ&&(d=!0);b.hasM&&(a=!0)});return c.map(function(b){var c=[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]];if(d&&b.hasZ)for(var h=.5*(b.zmax-b.zmin),n=0;n<c.length;n++)c[n].push(h);if(a&&b.hasM)for(b=.5*(b.mmax-b.mmin),n=
0;n<c.length;n++)c[n].push(b);return c})}return null};a.getLength=m;a.getMidpoint=function(c,h){return k(c,h,.5)};a.getPathLength=function(c){for(var h=c.length,b=0,d=0;d<h-1;++d)b+=m(c[d],c[d+1]);return b};a.getPointOnPath=function(c,h){if(0>=h)return c[0];for(var b=c.length,d=0,a=0;a<b-1;++a){var g=m(c[a],c[a+1]);if(h-d<g)return k(c[a],c[a+1],(h-d)/g);d+=g}return c[b-1]};a.isClockwise=l;a.closeRingsAndFixWinding=function(c){if("rings"in c){for(var h=0,b=c.rings;h<b.length;h++){var d=b[h];3>d.length||
d[0][0]===d[d.length-1][0]&&d[0][1]===d[d.length-1][1]||d.push([d[0][0],d[0][1]])}if(0<c.rings.length&&!l(c.rings[0],c.hasM,c.hasZ))for(h=0;h<c.rings.length;++h)c.rings[h]=c.rings[h].reverse()}};a.closeRings=function(c){if("rings"in c){var h=0;for(c=c.rings;h<c.length;h++){var b=c[h];3>b.length||b[0][0]===b[b.length-1][0]&&b[0][1]===b[b.length-1][1]||b.push([b[0][0],b[0][1]])}}};a.getRingArea=function(c){for(var h=c.length,b=0,d=0;d<h;d++)var a=c[d],g=c[(d+1)%h],b=b+(a[0]*g[1]-g[0]*a[1]);return b};
a.unnormalizeGeometryOnDatelineCrossing=function(c){if("polygon"!==c.type&&"polyline"!==c.type)return c;g("polygon"===c.type?c.rings:c.paths,c.spatialReference);return c};a.unnormalizeVerticesOnDatelineCrossing=g;a.computeUnnormalizedVertexPositionsOnDateLineCrossing=function(c,h,b,d){var a=Infinity,g=-Infinity;c.forEach(function(c){for(var n=c.pos[0];n<h;)n+=d;for(;n>b;)n-=d;a=Math.min(a,n);g=Math.max(g,n);c.unnormalizedPos[0]=n;c.unnormalizedPos[1]=c.pos[1];2<c.pos.length&&(c.unnormalizedPos[2]=
c.pos[2]);3<c.pos.length&&(c.unnormalizedPos[3]=c.pos[3])});var e=g-a;d-e<e&&c.forEach(function(b){0>b.unnormalizedPos[0]&&(b.unnormalizedPos[0]+=d)})}})},"esri/geometry/support/extentUtils":function(){define(["require","exports","./boundsUtils"],function(f,a,e){function m(b,d,c){void 0===d&&(d=!1);void 0===c&&(c=!1);return d?c?{xmin:b[0],ymin:b[1],zmin:b[2],mmin:b[3],xmax:b[4],ymax:b[5],zmax:b[6],mmax:b[7]}:{xmin:b[0],ymin:b[1],zmin:b[2],xmax:b[3],ymax:b[4],zmax:b[5]}:c?{xmin:b[0],ymin:b[1],mmin:b[2],
xmax:b[3],ymax:b[4],mmax:b[5]}:{xmin:b[0],ymin:b[1],xmax:b[2],ymax:b[3]}}function k(b){var d=b.hasZ,c=b.hasM;return m(e.getPointsBounds(h,b.points,d,c),d,c)}function l(b){var d=b.x,c=b.y,h=b.z;b=b.m;var a=null!=b;return null!=h?a?{xmin:d,ymin:c,zmin:h,mmin:b,xmax:d,ymax:c,zmax:h,mmax:b}:{xmin:d,ymin:c,zmin:h,xmax:d,ymax:c,zmax:h}:a?{xmin:d,ymin:c,mmin:b,xmax:d,ymax:c,mmax:b}:{xmin:d,ymin:c,xmax:d,ymax:c}}function g(b){var d=b.hasZ,c=b.hasM;return(b=e.getRingsOrPathsBounds(h,b.rings,d,c))?m(b,d,c):
null}function c(b){var d=b.hasZ,c=b.hasM;return(b=e.getRingsOrPathsBounds(h,b.paths,d,c))?m(b,d,c):null}Object.defineProperty(a,"__esModule",{value:!0});var h=[];a.getGeometryExtent=function(b){return b?void 0!==b.xmin&&void 0!==b.ymin&&void 0!==b.xmax&&void 0!==b.ymax?b:void 0!==b.x&&void 0!==b.y?l(b):void 0!==b.rings?g(b):void 0!==b.paths?c(b):void 0!==b.points?k(b):null:null};a.getMultipointExtent=k;a.getPointExtent=l;a.getPolygonExtent=g;a.getPolylineExtent=c})},"esri/geometry/support/boundsUtils":function(){define(["require",
"exports"],function(f,a){function e(b){return void 0!==b.xmin&&void 0!==b.ymin&&void 0!==b.xmax&&void 0!==b.ymax}function m(b){return function(d,c){return null==d?c:null==c?d:b(d,c)}}function k(b,d,a,g){var n=a?3:2;if(!d.length||!d[0].length)return null;for(var e=d[0][0],p=e[0],e=e[1],l=d[0][0],f=l[0],l=l[1],y=void 0,k=void 0,m=void 0,B=void 0,D=0;D<d.length;D++)for(var C=d[D],E=0;E<C.length;E++){var F=C[E],I=F[0],J=F[1],p=c(p,I),e=c(e,J),f=h(f,I),l=h(l,J);a&&2<F.length&&(I=F[2],y=c(y,I),k=h(k,I));
g&&F.length>n&&(B=F[n],m=c(y,B),B=h(k,B))}if(a){if(g)return b[0]=p,b[1]=e,b[2]=y,b[3]=m,b[4]=f,b[5]=l,b[6]=k,b[7]=B,b.length=8,b;b[0]=p;b[1]=e;b[2]=y;b[3]=f;b[4]=l;b[5]=k;b.length=6;return b}if(g)return b[0]=p,b[1]=e,b[2]=m,b[3]=f,b[4]=l,b[5]=B,b.length=6,b;b[0]=p;b[1]=e;b[2]=f;b[3]=l;b.length=4;return b}function l(b,d,c,h,a,g){c=d.xmin;h=d.xmax;var n=d.ymin,e=d.ymax,p=d.zmin,q=d.zmax,r=d.mmin;d=d.mmax;if(a){p=p||0;q=q||0;if(g)return b[0]=c,b[1]=n,b[2]=p,b[3]=r||0,b[4]=h,b[5]=e,b[6]=q,b[7]=d||0,b;
b[0]=c;b[1]=n;b[2]=p;b[3]=h;b[4]=e;b[5]=q;return b}if(g)return b[0]=c,b[1]=n,b[2]=r||0,b[3]=h,b[4]=e,b[5]=d||0,b;b[0]=c;b[1]=n;b[2]=h;b[3]=e;return b}function g(b,d,a,g,e,q){var n=a?3:2;g=g&&q;a=a&&e;if(!d.length||!d[0].length)return null;for(var p=d[0],r=p[0],p=p[1],l=d[0],f=l[0],l=l[1],k=void 0,m=void 0,D=void 0,C=void 0,E=0;E<d.length;E++){var F=d[E],I=F[0],J=F[1],r=c(r,I),p=c(p,J),f=h(f,I),l=h(l,J);a&&2<F.length&&(I=F[2],k=c(k,I),m=h(m,I));g&&F.length>n&&(C=F[n],D=c(k,C),C=h(m,C))}if(e){k=k||
0;m=m||0;if(q)return b[0]=r,b[1]=p,b[2]=k,b[3]=D||0,b[4]=f,b[5]=l,b[6]=m,b[7]=C||0,b;b[0]=r;b[1]=p;b[2]=k;b[3]=f;b[4]=l;b[5]=m;return b}if(q)return b[0]=r,b[1]=p,b[2]=D||0,b[3]=f,b[4]=l,b[5]=C||0,b;b[0]=r;b[1]=p;b[2]=f;b[3]=l;return b}Object.defineProperty(a,"__esModule",{value:!0});var c=m(Math.min),h=m(Math.max);a.getBoundsXY=function(b,d){if(void 0!==d.paths)return k(b,d.paths,!1,!1);if(void 0!==d.rings)return k(b,d.rings,!1,!1);if(void 0!==d.points)return g(b,d.points,!1,!1,!1,!1);if(e(d))return l(b,
d);void 0!==d.x&&void 0!==d.y&&(b[0]=d.x,b[1]=d.y,b[2]=d.x,b[3]=d.y);return b};a.getBoundsXYZ=function(b,d){if(void 0!==d.paths)return k(b,d.paths,!0,!1);if(void 0!==d.rings)return k(b,d.rings,!0,!1);if(void 0!==d.points)return g(b,d.points,!0,!1,!0,!1);if(e(d))return l(b,d,!0,!1,!0,!1);void 0!==d.x&&void 0!==d.y&&(b[0]=d.x,b[1]=d.y,b[2]=d.z,b[3]=d.x,b[4]=d.y,b[5]=d.z);return b};a.getRingsOrPathsBounds=k;a.getExtentBounds=l;a.getPointsBounds=g;a.getPointsBoundsWidth=function(b){if(!b.length||!b[0].length)return null;
for(var d=b[0][0],a=b[0][0],g=0;g<b.length;g++)var e=b[g][0],d=c(d,e),a=h(a,e);return a-d};a.getPointsBoundsCenterX=function(b){if(!b.length||!b[0].length)return null;for(var d=b[0][0],a=b[0][0],g=0;g<b.length;g++)var e=b[g][0],d=c(d,e),a=h(a,e);return d+.5*(a-d)}})},"esri/geometry/Polyline":function(){define("require exports tslib ../core/lang ../core/accessorSupport/decorators ./Extent ./Geometry ./Point ./SpatialReference ./support/extentUtils ./support/zmUtils".split(" "),function(f,a,e,m,k,l,
g,c,h,b,d){f=function(a){function g(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];b=a.apply(this,b)||this;b.paths=[];b.type="polyline";return b}e.__extends(g,a);n=g;g.prototype.normalizeCtorArgs=function(b,d){var c=null,a,g,n=null;b&&!Array.isArray(b)?(c=b.paths?b.paths:null,d||(b.spatialReference?d=b.spatialReference:b.paths||(d=b)),a=b.hasZ,g=b.hasM):c=b;c=c||[];d=d||h.WGS84;c.length&&c[0]&&null!=c[0][0]&&"number"===typeof c[0][0]&&(c=[c]);if(n=c[0]&&c[0][0])void 0===a&&void 0===g?
(a=2<n.length,g=!1):void 0===a?a=!g&&3<n.length:void 0===g&&(g=!a&&3<n.length);return{paths:c,spatialReference:d,hasZ:a,hasM:g}};Object.defineProperty(g.prototype,"extent",{get:function(){var d=this.spatialReference,c=b.getPolylineExtent(this);if(!c)return null;c=new l(c);c.spatialReference=d;return c},enumerable:!0,configurable:!0});g.prototype.writePaths=function(b,d){d.paths=m.clone(this.paths)};g.prototype.addPath=function(b){if(b){this.clearCache();var d=this.paths,c=d.length;if(Array.isArray(b[0]))d[c]=
b.concat();else{for(var h=[],a=0,g=b.length;a<g;a++)h[a]=b[a].toArray();d[c]=h}return this}};g.prototype.clone=function(){var b=new n;b.spatialReference=this.spatialReference;b.paths=m.clone(this.paths);b.hasZ=this.hasZ;b.hasM=this.hasM;return b};g.prototype.getPoint=function(b,d){if(!this._validateInputs(b,d))return null;b=this.paths[b][d];d=this.hasZ;var h=this.hasM;return d&&!h?new c(b[0],b[1],b[2],void 0,this.spatialReference):h&&!d?new c(b[0],b[1],void 0,b[2],this.spatialReference):d&&h?new c(b[0],
b[1],b[2],b[3],this.spatialReference):new c(b[0],b[1],this.spatialReference)};g.prototype.insertPoint=function(b,c,h){if(!this._validateInputs(b,c,!0))return this;this.clearCache();d.updateSupportFromPoint(this,h);Array.isArray(h)||(h=h.toArray());this.paths[b].splice(c,0,h);return this};g.prototype.removePath=function(b){if(!this._validateInputs(b,null))return null;this.clearCache();b=this.paths.splice(b,1)[0];var d=this.spatialReference;return b.map(function(b){return new c(b,d)})};g.prototype.removePoint=
function(b,d){if(!this._validateInputs(b,d))return null;this.clearCache();return new c(this.paths[b].splice(d,1)[0],this.spatialReference)};g.prototype.setPoint=function(b,c,h){if(!this._validateInputs(b,c))return this;this.clearCache();d.updateSupportFromPoint(this,h);Array.isArray(h)||(h=h.toArray());this.paths[b][c]=h;return this};g.prototype._validateInputs=function(b,d,c){void 0===c&&(c=!1);return null==b||0>b||b>=this.paths.length||null!=d&&(b=this.paths[b],c&&(0>d||d>b.length)||!c&&(0>d||d>=
b.length))?!1:!0};g.prototype.toJSON=function(b){return this.write(null,b)};var n;e.__decorate([k.property({dependsOn:["hasM","hasZ","paths"]})],g.prototype,"cache",void 0);e.__decorate([k.property({dependsOn:["cache"],readOnly:!0})],g.prototype,"extent",null);e.__decorate([k.property({type:[[[Number]]],json:{write:{isRequired:!0}}})],g.prototype,"paths",void 0);e.__decorate([k.writer("paths")],g.prototype,"writePaths",null);return g=n=e.__decorate([k.subclass("esri.geometry.Polyline")],g)}(g);f.prototype.toJSON.isDefaultToJSON=
!0;return f})},"esri/geometry/support/jsonUtils":function(){define("require exports ../Extent ../Geometry ../Multipoint ../Point ../Polygon ../Polyline".split(" "),function(f,a,e,m,k,l,g,c){function h(b){return void 0!==b.xmin&&void 0!==b.ymin&&void 0!==b.xmax&&void 0!==b.ymax}function b(b){return void 0!==b.points}function d(b){return void 0!==b.x&&void 0!==b.y}function n(b){return void 0!==b.paths}function p(b){return void 0!==b.rings}function r(a){return a?a instanceof m?a:d(a)?l.fromJSON(a):n(a)?
c.fromJSON(a):p(a)?g.fromJSON(a):b(a)?k.fromJSON(a):h(a)?e.fromJSON(a):null:null}Object.defineProperty(a,"__esModule",{value:!0});a.fromJson=function(b){try{throw Error("fromJson is deprecated, use fromJSON instead");}catch(u){console.warn(u.stack)}return r(b)};a.isExtent=h;a.isMultipoint=b;a.isPoint=d;a.isPolyline=n;a.isPolygon=p;a.isMesh=function(b){return void 0!==b.vertexAttributes};a.fromJSON=r;a.getJsonType=function(c){return c?d(c)?"esriGeometryPoint":n(c)?"esriGeometryPolyline":p(c)?"esriGeometryPolygon":
h(c)?"esriGeometryEnvelope":b(c)?"esriGeometryMultipoint":null:null};var q={esriGeometryPoint:l,esriGeometryPolyline:c,esriGeometryPolygon:g,esriGeometryEnvelope:e,esriGeometryMultipoint:k};a.getGeometryType=function(b){return b&&q[b]||null}})},"esri/core/unitUtils":function(){define("require exports ./compilerUtils ./jsonMap ./SetUtils ./wgs84Constants ../geometry/support/WKIDUnitConversion".split(" "),function(f,a,e,m,k,l,g){function c(b){if(b=D[b])return b;throw Error("unknown measure");}function h(b){return B[b].baseUnit}
function b(b,d){void 0===d&&(d=null);d=d||c(b);return B[d].baseUnit===b}function d(d,h,a){if(h===a)return d;var g=c(h);if(g!==c(a))throw Error("incompatible units");d=b(h,g)?d:d*B[g].units[h].inBaseUnits;return b(a,g)?d:d/B[g].units[a].inBaseUnits}function n(b){return A.fromJSON(b.toLowerCase())||null}function p(b,d){void 0===d&&(d=x);return r(b,!0)||d}function r(b,d){void 0===d&&(d=!1);var c,h,a;null!=b&&("object"===typeof b?(c=b.wkid,h=b.wkt):"number"===typeof b?c=b:"string"===typeof b&&(h=b));
c?(a=y.values[y[c]],!a&&d&&z.has(c)&&(a=u)):h&&-1!==h.search(/^PROJCS/i)&&(b=v.exec(h))&&b[1]&&(a=parseFloat(b[1].split(",")[1]));return a}function q(b){var d,c,h;null!=b&&("object"===typeof b?(d=b.wkid,c=b.wkt):"number"===typeof b?d=b:"string"===typeof b&&(c=b));d?h=y.units[y[d]]:c&&-1!==c.search(/^PROJCS/i)&&(b=v.exec(c))&&b[1]&&(h=(b=/[\\"\\']{1}([^\\"\\']+)/.exec(b[1]))&&b[1]);return h?n(h):null}Object.defineProperty(a,"__esModule",{value:!0});a.inchesPerMeter=39.37;var x=l.wgs84Radius*Math.PI/
180,u=l.wgs84Radius*Math.PI/200,v=/UNIT\[([^\]]+)\]\]$/i,y=g,z=k.SetFromValues([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),A=m.strict()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",
chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"});f={millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1E3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}};m={"square-millimeters":{inBaseUnits:1E-6},"square-centimeters":{inBaseUnits:1E-4},
"square-decimeters":{inBaseUnits:.1*.1},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:1E6},"square-inches":{inBaseUnits:6.4516E-4},"square-feet":{inBaseUnits:.09290304},"square-yards":{inBaseUnits:.83612736},"square-miles":{inBaseUnits:2589988.110336},"square-us-feet":{inBaseUnits:function(b){return b*b}(1200/3937)},acres:{inBaseUnits:4046.8564224},ares:{inBaseUnits:100},hectares:{inBaseUnits:1E4}};var B={length:{baseUnit:"meters",units:f},area:{baseUnit:"square-meters",units:m},
volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1E3*1E-9},"cubic-centimeters":{inBaseUnits:.001},"cubic-decimeters":{inBaseUnits:1},"cubic-meters":{inBaseUnits:1E3},"cubic-kilometers":{inBaseUnits:1E12},"cubic-inches":{inBaseUnits:.016387064},"cubic-feet":{inBaseUnits:.09290304*304.8},"cubic-yards":{inBaseUnits:764.554857984},"cubic-miles":{inBaseUnits:4.16818182544058E12}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/
180}}}},D=function(){var b={},d;for(d in B)for(var c in B[d].units)b[c]=d;return b}();a.measurementAreaUnits="metric imperial square-inches square-feet square-yards square-miles square-us-feet square-meters square-kilometers acres ares hectares".split(" ");a.measurementLengthUnits="metric imperial inches feet yards miles nautical-miles us-feet meters kilometers".split(" ");a.measureForUnit=c;a.baseUnitForMeasure=h;a.baseUnitForUnit=function(b){return h(c(b))};a.isBaseUnit=b;a.convertUnit=d;a.preferredMetricLengthUnit=
function(b,c){return 3E3>d(b,c,"meters")?"meters":"kilometers"};a.preferredMetricVerticalLengthUnit=function(b,c){return 1E5>d(b,c,"meters")?"meters":"kilometers"};a.preferredImperialLengthUnit=function(b,c){return 1E3>d(b,c,"feet")?"feet":"miles"};a.preferredImperialVerticalLengthUnit=function(b,c){return 1E5>d(b,c,"feet")?"feet":"miles"};a.preferredMetricAreaUnit=function(b,c){return 3E6>d(b,c,"square-meters")?"square-meters":"square-kilometers"};a.preferredImperialAreaUnit=function(b,c){return 1E6>
d(b,c,"square-feet")?"square-feet":"square-miles"};a.lengthToDegrees=function(b,c,h){void 0===h&&(h=l.wgs84Radius);return d(b,c,"meters")/(h*Math.PI/180)};a.unitFromRESTJSON=n;a.unitToRESTJSON=function(b){return A.toJSON(b)||null};a.getMetersPerVerticalUnitForSR=function(b){b=p(b);return 1E5<b?1:b};a.getVerticalUnitStringForSR=function(b){return 1E5<p(b)?"meters":q(b)};a.getMetersPerUnitForSR=p;a.getMetersPerUnit=r;a.getUnitString=q;a.getDefaultUnitSystem=function(b){if(!b)return null;b=q(b);switch(b){case "feet":case "us-feet":case "clarke-feet":case "clarke-yards":case "clarke-links":case "sears-yards":case "sears-feet":case "sears-chains":case "benoit-1895-b-chains":case "indian-yards":case "indian-1937-yards":case "gold-coast-feet":case "sears-1922-truncated-chains":return"imperial";
case "50-kilometers":case "150-kilometers":case "meters":return"metric";case null:case void 0:break;default:e.neverReached(b)}return null}})},"esri/core/SetUtils":function(){define(["require","exports"],function(f,a){function e(a){if(0===a.size)throw Error("Set is empty");return a.values().next().value}function m(a){if(0===a.size)throw Error("Set is empty");var g,c=!1;a.forEach(function(h){c||(g=h,c=!0)});return g}Object.defineProperty(a,"__esModule",{value:!0});a.someSet=Set.prototype.entries?function(a,
g){a=a.entries();for(var c=a.next();!c.done;c=a.next())if(g(c.value[0]))return!0;return!1}:function(a,g){var c=!0;a.forEach(function(h){c&&(c=!g(h))});return!c};f=!!Set.prototype.values;var k=!!Array.from;a.valuesOfSet=f&&k?function(a){return Array.from(a.values())}:function(a){var g=Array(a.size),c=0;a.forEach(function(h){return g[c++]=h});return g};a.SetFromValues=f?function(a){return new Set(a)}:function(a){for(var g=new Set,c=0;c<a.length;c++)g.add(a[c]);return g};a.firstOfSet=f?e:m;a.reduceSet=
function(a,g,c){var h=c;a.forEach(function(b){return h=g(b,h)});return h}})},"esri/geometry/support/aaBoundingRect":function(){define(["require","exports","../../core/compilerUtils","../Extent"],function(f,a,e,m){function k(b){void 0===b&&(b=a.ZERO);return[b[0],b[1],b[2],b[3]]}function l(b){return b[0]>=b[2]?0:b[2]-b[0]}function g(b){return b[1]>=b[3]?0:b[3]-b[1]}function c(b,d,c){return d>=b[0]&&c>=b[1]&&d<=b[2]&&c<=b[3]}function h(b,d){b[0]=d[0];b[1]=d[1];b[2]=d[2];b[3]=d[3];return b}function b(b){return 4===
b.length}function d(b,d,c){return b<d?d:b>c?c:b}Object.defineProperty(a,"__esModule",{value:!0});a.create=k;a.clone=function(b){return[b[0],b[1],b[2],b[3]]};a.fromValues=function(b,d,c,h,a){void 0===a&&(a=k());a[0]=b;a[1]=d;a[2]=c;a[3]=h;return a};a.fromExtent=function(b,d){void 0===d&&(d=k());d[0]=b.xmin;d[1]=b.ymin;d[2]=b.xmax;d[3]=b.ymax;return d};a.toExtent=function(b,d){return new m({xmin:b[0],ymin:b[1],xmax:b[2],ymax:b[3],spatialReference:d})};a.expandPointInPlace=function(b,d){d[0]<b[0]&&(b[0]=
d[0]);d[0]>b[2]&&(b[2]=d[0]);d[1]<b[1]&&(b[1]=d[1]);d[1]>b[3]&&(b[3]=d[1])};a.expand=function(d,c,h){void 0===h&&(h=d);if("length"in c)if(b(c))h[0]=Math.min(d[0],c[0]),h[1]=Math.min(d[1],c[1]),h[2]=Math.max(d[2],c[2]),h[3]=Math.max(d[3],c[3]);else{if(2===c.length||3===c.length)h[0]=Math.min(d[0],c[0]),h[1]=Math.min(d[1],c[1]),h[2]=Math.max(d[2],c[0]),h[3]=Math.max(d[3],c[1])}else switch(c.type){case "extent":h[0]=Math.min(d[0],c.xmin);h[1]=Math.min(d[1],c.ymin);h[2]=Math.max(d[2],c.xmax);h[3]=Math.max(d[3],
c.ymax);break;case "point":h[0]=Math.min(d[0],c.x);h[1]=Math.min(d[1],c.y);h[2]=Math.max(d[2],c.x);h[3]=Math.max(d[3],c.y);break;default:e.neverReached(c)}return h};a.expandWithNestedArray=function(b,d,c){void 0===c&&(c=b);var h=d.length,a=b[0],g=b[1],n=b[2];b=b[3];for(var e=0;e<h;e++){var p=d[e],a=Math.min(a,p[0]),g=Math.min(g,p[1]),n=Math.max(n,p[0]);b=Math.max(b,p[1])}c[0]=a;c[1]=g;c[2]=n;c[3]=b;return c};a.allFinite=function(b){for(var d=0;4>d;d++)if(!isFinite(b[d]))return!1;return!0};a.width=
l;a.height=g;a.diameter=function(b){var d=l(b);b=g(b);return Math.sqrt(d*d+b*b)};a.area=function(b){return l(b)*g(b)};a.center=function(b,d){void 0===d&&(d=[0,0]);d[0]=(b[0]+b[2])/2;d[1]=(b[1]+b[3])/2;return d};a.containsPoint=function(b,d){return c(b,d[0],d[1])};a.containsPointObject=function(b,d){return c(b,d.x,d.y)};a.containsXY=c;a.containsPointWithMargin=function(b,d,c){return d[0]>=b[0]-c&&d[1]>=b[1]-c&&d[0]<=b[2]+c&&d[1]<=b[3]+c};a.intersects=function(b,d){return Math.max(d[0],b[0])<=Math.min(d[2],
b[2])&&Math.max(d[1],b[1])<=Math.min(d[3],b[3])};a.contains=function(b,d){return d[0]>=b[0]&&d[2]<=b[2]&&d[1]>=b[1]&&d[3]<=b[3]};a.intersection=function(b,c,h){void 0===h&&(h=b);var a=c[0],g=c[1],e=c[2];c=c[3];h[0]=d(b[0],a,e);h[1]=d(b[1],g,c);h[2]=d(b[2],a,e);h[3]=d(b[3],g,c);return h};a.distance=function(b,d){var c=(b[1]+b[3])/2,h=Math.max(Math.abs(d[0]-(b[0]+b[2])/2)-l(b)/2,0);b=Math.max(Math.abs(d[1]-c)-g(b)/2,0);return Math.sqrt(h*h+b*b)};a.size=function(b,d){d[0]=b[2]-b[0];d[1]=b[3]-b[1]};a.offset=
function(b,d,c,h){void 0===h&&(h=b);h[0]=b[0]+d;h[1]=b[1]+c;h[2]=b[2]+d;h[3]=b[3]+c;return h};a.pad=function(b,d,c){void 0===c&&(c=b);c[0]=b[0]-d;c[1]=b[1]-d;c[2]=b[2]+d;c[3]=b[3]+d;return c};a.setMin=function(b,d,c){void 0===c&&(c=b);c[0]=d[0];c[1]=d[1];c!==b&&(c[2]=b[2],c[3]=b[3]);return c};a.setMax=function(b,d,c){void 0===c&&(c=b);c[2]=d[0];c[3]=d[1];c!==b&&(c[0]=b[0],c[1]=b[1]);return b};a.set=h;a.empty=function(b){return b?h(b,a.NEGATIVE_INFINITY):k(a.NEGATIVE_INFINITY)};a.is=b;a.isPoint=function(b){return(0===
l(b)||!isFinite(b[0]))&&(0===g(b)||!isFinite(b[1]))};a.equals=function(d,c,h){if(null==d||null==c)return d===c;if(!b(d)||!b(c))return!1;if(h)for(var a=0;a<d.length;a++){if(!h(d[a],c[a]))return!1}else for(a=0;a<d.length;a++)if(d[a]!==c[a])return!1;return!0};a.POSITIVE_INFINITY=[-Infinity,-Infinity,Infinity,Infinity];a.NEGATIVE_INFINITY=[Infinity,Infinity,-Infinity,-Infinity];a.ZERO=[0,0,0,0];a.UNIT=[0,0,1,1]})},"esri/layers/support/LOD":function(){define("require exports tslib ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType".split(" "),
function(f,a,e,m,k,l){return function(a){function c(b){b=a.call(this,b)||this;b.level=0;b.levelValue=null;b.resolution=0;b.scale=0;return b}e.__extends(c,a);h=c;c.prototype.clone=function(){return new h({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})};var h;e.__decorate([k.property({type:l.Integer,json:{write:!0}})],c.prototype,"level",void 0);e.__decorate([k.property({type:String,json:{write:!0}})],c.prototype,"levelValue",void 0);e.__decorate([k.property({type:Number,
json:{write:!0}})],c.prototype,"resolution",void 0);e.__decorate([k.property({type:Number,json:{write:!0}})],c.prototype,"scale",void 0);return c=h=e.__decorate([k.subclass("esri.layers.support.LOD")],c)}(m.JSONSupport)})},"esri/views/2d/ViewState":function(){define("require exports tslib ../../geometry ../../Viewpoint ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/libs/gl-matrix-2/common ../../core/libs/gl-matrix-2/mat2d ../../core/libs/gl-matrix-2/mat2df32 ../../core/libs/gl-matrix-2/mat2df64 ../../core/libs/gl-matrix-2/mat3 ../../core/libs/gl-matrix-2/mat3f32 ../../core/libs/gl-matrix-2/vec2 ../../core/libs/gl-matrix-2/vec2f32 ../../core/libs/gl-matrix-2/vec2f64 ../../core/libs/gl-matrix-2/types/vec2 ./viewpointUtils".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u,v){var y=[0,0];return function(a){function l(){for(var c=[],h=0;h<arguments.length;h++)c[h]=arguments[h];c=a.apply(this,c)||this;c._viewpoint2D={center:x.vec2f64.create(),rotation:0,scale:0,spatialReference:null};c.center=[0,0];c.extent=new m.Extent;c.id=0;c.inverseTransform=d.mat2df64.create();c.resolution=0;c.rotation=0;c.scale=0;c.transform=d.mat2df64.create();c.transformNoRotation=d.mat2df64.create();c.displayMat3=p.mat3f32.create();c.displayViewMat3=
p.mat3f32.create();c.viewMat3=p.mat3f32.create();c.viewMat2d=b.mat2df32.create();c.worldScreenWidth=0;c.size=[0,0];return c}e.__extends(l,a);f=l;Object.defineProperty(l.prototype,"pixelRatio",{set:function(b){this._set("pixelRatio",b);this._update()},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"size",{set:function(b){this._set("size",b);this._update()},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"viewpoint",{set:function(b){if(b){var d=this._viewpoint2D,
c=b.targetGeometry;d.center[0]=c.x;d.center[1]=c.y;d.rotation=b.rotation;d.scale=b.scale;d.spatialReference=c.spatialReference}this._update()},enumerable:!0,configurable:!0});l.prototype.copy=function(b){var d=this.size,c=this.viewpoint;c&&d?(this.viewpoint=v.copy(c,b.viewpoint),this._set("size",r.vec2.copy(d,b.size))):(this.viewpoint=b.viewpoint.clone(),this._set("size",[b.size[0],b.size[1]]));this._set("pixelRatio",b.pixelRatio);return this};l.prototype.clone=function(){return new f({size:this.size,
viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})};l.prototype.toMap=function(b,d,c){if(u.isVec2(d))return r.vec2.transformMat2d(b,d,this.inverseTransform);y[0]=d;y[1]=c;return r.vec2.transformMat2d(b,y,this.inverseTransform)};l.prototype.toScreen=function(b,d,c){if(u.isVec2(d))return r.vec2.transformMat2d(b,d,this.transform);y[0]=d;y[1]=c;return r.vec2.transformMat2d(b,y,this.transform)};l.prototype.toScreenNoRotation=function(b,d,c){if(u.isVec2(d))return r.vec2.transformMat2d(b,d,this.transformNoRotation);
y[0]=d;y[1]=c;return r.vec2.transformMat2d(b,y,this.transformNoRotation)};l.prototype.getScreenTransform=function(b,d){var c=this._viewpoint2D.center,h=this._get("pixelRatio")||1,a=this._get("size");v.getMatrix(b,c,a,d,0,h);return b};l.prototype._update=function(){var b=this._viewpoint2D,d=b.center,a=b.spatialReference,g=b.scale,e=b.rotation,b=this._get("pixelRatio")||1,p=this._get("size"),l=new k({targetGeometry:new m.Point(d[0],d[1],a),scale:g,rotation:e});this._set("viewpoint",l);if(p&&a&&g)return this.resolution=
v.getResolution(l),this.rotation=e,this.scale=g,this.spatialReference=a,r.vec2.copy(this.center,d),n.mat3.set(this.displayMat3,0!==p[0]?2/p[0]:0,0,0,0,0!==p[1]?-2/p[1]:0,0,-1,1,1),g=n.mat3.identity(this.viewMat3),d=q.vec2f32.fromValues(p[0]/2,p[1]/2),a=q.vec2f32.fromValues(-p[0]/2,-p[1]/2),e=c.common.toRadian(e),n.mat3.translate(g,g,d),n.mat3.rotate(g,g,e),n.mat3.translate(g,g,a),n.mat3.multiply(this.displayViewMat3,this.displayMat3,g),g=h.mat2d.identity(this.viewMat2d),h.mat2d.translate(g,g,d),h.mat2d.rotate(g,
g,e),h.mat2d.translate(g,g,a),v.getExtent(this.extent,l,p),v.getTransform(this.transform,l,p,b),h.mat2d.invert(this.inverseTransform,this.transform),v.getTransformNoRotation(this.transformNoRotation,l,p,b),this.worldScreenWidth=v.getWorldScreenWidth(this.spatialReference,this.resolution),this._set("id",this.id+1),this};var f;e.__decorate([g.property({readOnly:!0})],l.prototype,"id",void 0);e.__decorate([g.property({value:1,json:{write:!0}})],l.prototype,"pixelRatio",null);e.__decorate([g.property({json:{write:!0}})],
l.prototype,"size",null);e.__decorate([g.property({type:k,json:{write:!0}})],l.prototype,"viewpoint",null);return l=f=e.__decorate([g.subclass("esri.views.2d.ViewState")],l)}(l.JSONSupport)})},"esri/Viewpoint":function(){define("require exports tslib ./Camera ./geometry ./core/JSONSupport ./core/accessorSupport/decorators ./geometry/support/jsonUtils".split(" "),function(f,a,e,m,k,l,g,c){function h(){return{enabled:!this.camera}}return function(b){function d(d){d=b.call(this,d)||this;d.rotation=0;
d.scale=0;d.targetGeometry=null;d.camera=null;return d}e.__extends(d,b);a=d;d.prototype.castRotation=function(b){b%=360;0>b&&(b+=360);return b};d.prototype.clone=function(){return new a({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry?this.targetGeometry.clone():null,camera:this.camera?this.camera.clone():null})};var a;e.__decorate([g.property({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:h}}}}})],d.prototype,"rotation",
void 0);e.__decorate([g.cast("rotation")],d.prototype,"castRotation",null);e.__decorate([g.property({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:h}}}}})],d.prototype,"scale",void 0);e.__decorate([g.property({types:k.geometryTypes,json:{read:c.fromJSON,write:!0,origins:{"web-scene":{read:c.fromJSON,write:{overridePolicy:h}}}}})],d.prototype,"targetGeometry",void 0);e.__decorate([g.property({type:m,json:{write:!0}})],d.prototype,"camera",void 0);
return d=a=e.__decorate([g.subclass("esri.Viewpoint")],d)}(l.JSONSupport)})},"esri/Camera":function(){define("require exports tslib ./core/JSONSupport ./core/mathUtils ./core/accessorSupport/decorators ./core/accessorSupport/ensureType ./geometry/Point ./views/3d/support/mathUtils".split(" "),function(f,a,e,m,k,l,g,c,h){return function(b){function d(){for(var d=[],h=0;h<arguments.length;h++)d[h]=arguments[h];d=b.apply(this,d)||this;d.position=new c([0,0,0]);d.heading=0;d.tilt=0;d.fov=55;return d}
e.__extends(d,b);a=d;d.prototype.normalizeCtorArgs=function(b,d,c,h){b&&"object"===typeof b&&("x"in b||Array.isArray(b))&&(b={position:b},null!=d&&(b.heading=d),null!=c&&(b.tilt=c),null!=h&&(b.fov=h));return b};d.prototype.writePosition=function(b,d,c,h){var a=b.clone();a.x=g.ensureNumber(b.x||0);a.y=g.ensureNumber(b.y||0);a.z=b.hasZ?g.ensureNumber(b.z||0):b.z;d[c]=a.write(null,h)};d.prototype.readPosition=function(b,d){var h=new c;h.read(b,d);h.x=g.ensureNumber(h.x||0);h.y=g.ensureNumber(h.y||0);
h.z=h.hasZ?g.ensureNumber(h.z||0):h.z;return h};d.prototype.equals=function(b){return b?this.tilt===b.tilt&&this.heading===b.heading&&this.fov===b.fov&&this.position.equals(b.position):!1};d.prototype.clone=function(){return new a({position:this.position.clone(),heading:this.heading,tilt:this.tilt,fov:this.fov})};var a;e.__decorate([l.property({type:c,json:{write:{isRequired:!0}}})],d.prototype,"position",void 0);e.__decorate([l.writer("position")],d.prototype,"writePosition",null);e.__decorate([l.reader("position")],
d.prototype,"readPosition",null);e.__decorate([l.property({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),l.cast(function(b){return h.cyclicalDeg.normalize(g.ensureNumber(b))})],d.prototype,"heading",void 0);e.__decorate([l.property({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),l.cast(function(b){return k.clamp(g.ensureNumber(b),-180,180)})],d.prototype,"tilt",void 0);e.__decorate([l.property({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],d.prototype,"fov",void 0);
return d=a=e.__decorate([l.subclass("esri.Camera")],d)}(m.JSONSupport)})},"esri/views/3d/support/mathUtils":function(){define(["require","exports","../../../core/mathUtils","../../../core/libs/gl-matrix-2/vec3","../../../core/libs/gl-matrix-2/vec3f64"],function(f,a,e,m,k){function l(b){for(var d in b){var c=b[d];c instanceof Function&&(b[d]=c.bind(b))}return b}Object.defineProperty(a,"__esModule",{value:!0});a.cosCapped=function(b,d){return b>d?Math.cos(d):Math.cos(b)};a.fovx2fovy=function(b,d,c){return 2*
Math.atan(c*Math.tan(.5*b)/d)};a.fovy2fovx=function(b,d,c){return 2*Math.atan(d*Math.tan(.5*b)/c)};a.maxScale=function(b){return Math.sqrt(Math.max(Math.max(b[0]*b[0]+b[4]*b[4]+b[8]*b[8],b[1]*b[1]+b[5]*b[5]+b[9]*b[9]),b[2]*b[2]+b[6]*b[6]+b[10]*b[10]))};a.scaleFromMatrix=function(b,d){m.vec3.set(b,Math.sqrt(d[0]*d[0]+d[4]*d[4]+d[8]*d[8]),Math.sqrt(d[1]*d[1]+d[5]*d[5]+d[9]*d[9]),Math.sqrt(d[2]*d[2]+d[6]*d[6]+d[10]*d[10]));return b};a.makeOrthonormal=function(b,d,c){c=c||b;var h=m.vec3.dot(b,d);m.vec3.set(c,
b[0]-h*d[0],b[1]-h*d[1],b[2]-h*d[2]);m.vec3.normalize(c,c)};a.tangentFrame=function(b,d,c){Math.abs(b[0])>Math.abs(b[1])?m.vec3.set(d,0,1,0):m.vec3.set(d,1,0,0);m.vec3.cross(c,b,d);m.vec3.normalize(d,d);m.vec3.cross(d,c,b);m.vec3.normalize(c,c)};a.moduloPositive=function(b,d){return(b%d+d)%d};a.cartesianToSpherical=function(b,d){var c=m.vec3.length(b),h=e.asinClamped(b[2]/c);m.vec3.set(d,c,h,Math.atan2(b[1]/c,b[0]/c));return d};a.sphericalToCartesian=function(b,d){var c=b[0],h=b[1];b=b[2];var a=Math.cos(h);
m.vec3.set(d,c*a*Math.cos(b),c*a*Math.sin(b),c*Math.sin(h))};a.directionFromTo=function(b,d,c){var h=c[0]-d[0],a=c[1]-d[1];d=c[2]-d[2];c=h*h+a*a+d*d;if(!c)return b[0]=0,b[1]=0,b[2]=0,b;c=1/Math.sqrt(c);b[0]=h*c;b[1]=a*c;b[2]=d*c;return b};a.bilerp=function(b,d,c,h,a,g){b+=(d-b)*a;return b+(c+(h-c)*a-b)*g};a.slerp=function(c,h,a,g){void 0===g&&(g=k.vec3f64.create());var e=m.vec3.length(c),n=m.vec3.length(h),q=m.vec3.dot(c,h)/(e*n);if(.9999999999999999>q){var q=Math.acos(q),p=((1-a)*e+a*n)/Math.sin(q),
n=p/n*Math.sin(a*q);m.vec3.scale(b,c,p/e*Math.sin((1-a)*q));m.vec3.scale(d,h,n);return m.vec3.add(g,b,d)}return m.vec3.lerp(g,c,h,a)};a.angle=function(c,a,g){c=m.vec3.normalize(b,c);a=m.vec3.normalize(d,a);var n=e.acosClamped(m.vec3.dot(c,a));return g&&(c=m.vec3.cross(h,c,a),0>m.vec3.dot(c,g))?-n:n};a.makePiecewiseLinearFunction=function(b){var d=b.length;return function(c){if(c<=b[0][0])return b[0][1];if(c>=b[d-1][0])return b[d-1][1];for(var h=1;c>b[h][0];)h++;var a=b[h][0];c=(a-c)/(a-b[h-1][0]);
return c*b[h-1][1]+(1-c)*b[h][1]}};a.vectorEquals=function(b,d){if(null==b||null==d)return b!==d;if(b.length!==d.length)return!1;for(var c=0;c<b.length;c++)if(b[c]!==d[c])return!1;return!0};f=function(){function b(b,d){this.min=b;this.max=d;this.range=d-b}b.prototype.ndiff=function(b,d){void 0===d&&(d=0);return Math.ceil((b-d)/this.range)*this.range+d};b.prototype._normalize=function(b,d,c,h,a){void 0===h&&(h=0);void 0===a&&(a=!1);c-=h;c<b?c+=this.ndiff(b-c):c>d&&(c-=this.ndiff(c-d));a&&c===d&&(c=
b);return c+h};b.prototype.normalize=function(b,d,c){void 0===d&&(d=0);void 0===c&&(c=!1);return this._normalize(this.min,this.max,b,d,c)};b.prototype.clamp=function(b,d){void 0===d&&(d=0);return e.clamp(b-d,this.min,this.max)+d};b.prototype.monotonic=function(b,d,c){return b<d?d:d+this.ndiff(b-d,c)};b.prototype.minimalMonotonic=function(b,d,c){return this._normalize(b,b+this.range,d,c)};b.prototype.center=function(b,d,c){d=this.monotonic(b,d,c);return this.normalize((b+d)/2,c)};b.prototype.diff=
function(b,d,c){return this.monotonic(b,d,c)-b};b.prototype.shortestSignedDiff=function(b,d){b=this.normalize(b);d=this.normalize(d);var c=d-b;b=d<b?this.minimalMonotonic(b,d)-b:d-this.minimalMonotonic(d,b);return Math.abs(c)<Math.abs(b)?c:b};b.prototype.contains=function(b,d,c){d=this.minimalMonotonic(b,d);c=this.minimalMonotonic(b,c);return c>b&&c<d};return b}();a.Cyclical=f;a.planeFromPoints=function(b,d,h,a){m.vec3.subtract(g,d,b);m.vec3.subtract(c,h,b);m.vec3.cross(a,g,c);m.vec3.normalize(a,
a);a[3]=-m.vec3.dot(b,a)};var g=k.vec3f64.create(),c=k.vec3f64.create();a.cyclical2PI=l(new f(0,2*Math.PI));a.cyclicalPI=l(new f(-Math.PI,Math.PI));a.cyclicalDeg=l(new f(0,360));var h=k.vec3f64.create(),b=k.vec3f64.create(),d=k.vec3f64.create()})},"esri/core/libs/gl-matrix-2/vec3":function(){define(["require","exports","./math/vec3"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.vec3=e})},"esri/core/libs/gl-matrix-2/math/vec3":function(){define(["require","exports","../factories/vec3f64",
"./common"],function(f,a,e,m){function k(b){var d=b[0],c=b[1];b=b[2];return Math.sqrt(d*d+c*c+b*b)}function l(b,d){b[0]=d[0];b[1]=d[1];b[2]=d[2];return b}function g(b,d,c){b[0]=d[0]-c[0];b[1]=d[1]-c[1];b[2]=d[2]-c[2];return b}function c(b,d,c){b[0]=d[0]*c[0];b[1]=d[1]*c[1];b[2]=d[2]*c[2];return b}function h(b,d,c){b[0]=d[0]/c[0];b[1]=d[1]/c[1];b[2]=d[2]/c[2];return b}function b(b,d){var c=d[0]-b[0],h=d[1]-b[1];b=d[2]-b[2];return Math.sqrt(c*c+h*h+b*b)}function d(b,d){var c=d[0]-b[0],h=d[1]-b[1];b=
d[2]-b[2];return c*c+h*h+b*b}function n(b){var d=b[0],c=b[1];b=b[2];return d*d+c*c+b*b}function p(b,d){var c=d[0],h=d[1],a=d[2],c=c*c+h*h+a*a;0<c&&(c=1/Math.sqrt(c),b[0]=d[0]*c,b[1]=d[1]*c,b[2]=d[2]*c);return b}function r(b,d){return b[0]*d[0]+b[1]*d[1]+b[2]*d[2]}Object.defineProperty(a,"__esModule",{value:!0});a.length=k;a.copy=l;a.set=function(b,d,c,h){b[0]=d;b[1]=c;b[2]=h;return b};a.add=function(b,d,c){b[0]=d[0]+c[0];b[1]=d[1]+c[1];b[2]=d[2]+c[2];return b};a.subtract=g;a.multiply=c;a.divide=h;
a.ceil=function(b,d){b[0]=Math.ceil(d[0]);b[1]=Math.ceil(d[1]);b[2]=Math.ceil(d[2]);return b};a.floor=function(b,d){b[0]=Math.floor(d[0]);b[1]=Math.floor(d[1]);b[2]=Math.floor(d[2]);return b};a.min=function(b,d,c){b[0]=Math.min(d[0],c[0]);b[1]=Math.min(d[1],c[1]);b[2]=Math.min(d[2],c[2]);return b};a.max=function(b,d,c){b[0]=Math.max(d[0],c[0]);b[1]=Math.max(d[1],c[1]);b[2]=Math.max(d[2],c[2]);return b};a.round=function(b,d){b[0]=Math.round(d[0]);b[1]=Math.round(d[1]);b[2]=Math.round(d[2]);return b};
a.scale=function(b,d,c){b[0]=d[0]*c;b[1]=d[1]*c;b[2]=d[2]*c;return b};a.scaleAndAdd=function(b,d,c,h){b[0]=d[0]+c[0]*h;b[1]=d[1]+c[1]*h;b[2]=d[2]+c[2]*h;return b};a.distance=b;a.squaredDistance=d;a.squaredLength=n;a.negate=function(b,d){b[0]=-d[0];b[1]=-d[1];b[2]=-d[2];return b};a.inverse=function(b,d){b[0]=1/d[0];b[1]=1/d[1];b[2]=1/d[2];return b};a.normalize=p;a.dot=r;a.cross=function(b,d,c){var h=d[0],a=d[1];d=d[2];var g=c[0],e=c[1];c=c[2];b[0]=a*c-d*e;b[1]=d*g-h*c;b[2]=h*e-a*g;return b};a.lerp=
function(b,d,c,h){var a=d[0],g=d[1];d=d[2];b[0]=a+h*(c[0]-a);b[1]=g+h*(c[1]-g);b[2]=d+h*(c[2]-d);return b};a.hermite=function(b,d,c,h,a,g){var e=g*g,n=e*(2*g-3)+1,q=e*(g-2)+g,p=e*(g-1);g=e*(3-2*g);b[0]=d[0]*n+c[0]*q+h[0]*p+a[0]*g;b[1]=d[1]*n+c[1]*q+h[1]*p+a[1]*g;b[2]=d[2]*n+c[2]*q+h[2]*p+a[2]*g;return b};a.bezier=function(b,d,c,h,a,g){var e=1-g,n=e*e,q=g*g,p=n*e,n=3*g*n,e=3*q*e;g*=q;b[0]=d[0]*p+c[0]*n+h[0]*e+a[0]*g;b[1]=d[1]*p+c[1]*n+h[1]*e+a[1]*g;b[2]=d[2]*p+c[2]*n+h[2]*e+a[2]*g;return b};a.random=
function(b,d){d=d||1;var c=2*m.RANDOM()*Math.PI,h=2*m.RANDOM()-1,a=Math.sqrt(1-h*h)*d;b[0]=Math.cos(c)*a;b[1]=Math.sin(c)*a;b[2]=h*d;return b};a.transformMat4=function(b,d,c){var h=d[0],a=d[1];d=d[2];b[0]=c[0]*h+c[4]*a+c[8]*d+c[12];b[1]=c[1]*h+c[5]*a+c[9]*d+c[13];b[2]=c[2]*h+c[6]*a+c[10]*d+c[14];return b};a.transformMat3=function(b,d,c){var h=d[0],a=d[1];d=d[2];b[0]=h*c[0]+a*c[3]+d*c[6];b[1]=h*c[1]+a*c[4]+d*c[7];b[2]=h*c[2]+a*c[5]+d*c[8];return b};a.transformQuat=function(b,d,c){var h=c[0],a=c[1],
g=c[2],e=d[0],n=d[1];d=d[2];var q=a*d-g*n,p=g*e-h*d,r=h*n-a*e;c=2*c[3];b[0]=e+q*c+2*(a*r-g*p);b[1]=n+p*c+2*(g*q-h*r);b[2]=d+r*c+2*(h*p-a*q);return b};a.rotateX=function(b,d,c,h){var a=[],g=[];a[0]=d[0]-c[0];a[1]=d[1]-c[1];a[2]=d[2]-c[2];g[0]=a[0];g[1]=a[1]*Math.cos(h)-a[2]*Math.sin(h);g[2]=a[1]*Math.sin(h)+a[2]*Math.cos(h);b[0]=g[0]+c[0];b[1]=g[1]+c[1];b[2]=g[2]+c[2];return b};a.rotateY=function(b,d,c,h){var a=[],g=[];a[0]=d[0]-c[0];a[1]=d[1]-c[1];a[2]=d[2]-c[2];g[0]=a[2]*Math.sin(h)+a[0]*Math.cos(h);
g[1]=a[1];g[2]=a[2]*Math.cos(h)-a[0]*Math.sin(h);b[0]=g[0]+c[0];b[1]=g[1]+c[1];b[2]=g[2]+c[2];return b};a.rotateZ=function(b,d,c,h){var a=[],g=[];a[0]=d[0]-c[0];a[1]=d[1]-c[1];a[2]=d[2]-c[2];g[0]=a[0]*Math.cos(h)-a[1]*Math.sin(h);g[1]=a[0]*Math.sin(h)+a[1]*Math.cos(h);g[2]=a[2];b[0]=g[0]+c[0];b[1]=g[1]+c[1];b[2]=g[2]+c[2];return b};a.angle=function(b,d){l(q,b);l(x,d);p(q,q);p(x,x);b=r(q,x);return 1<b?0:-1>b?Math.PI:Math.acos(b)};var q=e.create(),x=e.create();a.str=function(b){return"vec3("+b[0]+", "+
b[1]+", "+b[2]+")"};a.exactEquals=function(b,d){return b[0]===d[0]&&b[1]===d[1]&&b[2]===d[2]};a.equals=function(b,d){var c=b[0],h=b[1];b=b[2];var a=d[0],g=d[1];d=d[2];return Math.abs(c-a)<=m.EPSILON*Math.max(1,Math.abs(c),Math.abs(a))&&Math.abs(h-g)<=m.EPSILON*Math.max(1,Math.abs(h),Math.abs(g))&&Math.abs(b-d)<=m.EPSILON*Math.max(1,Math.abs(b),Math.abs(d))};a.sub=g;a.mul=c;a.div=h;a.dist=b;a.sqrDist=d;a.len=k;a.sqrLen=n})},"esri/core/libs/gl-matrix-2/factories/vec3f64":function(){define(["require",
"exports"],function(f,a){function e(){return[0,0,0]}function m(){return[1,1,1]}function k(){return[1,0,0]}function l(){return[0,1,0]}function g(){return[0,0,1]}Object.defineProperty(a,"__esModule",{value:!0});a.create=e;a.clone=function(c){return[c[0],c[1],c[2]]};a.fromValues=function(c,h,b){return[c,h,b]};a.fromArray=function(c){for(var h=e(),b=Math.min(3,c.length),d=0;d<b;++d)h[d]=c[d];return h};a.createView=function(c,h){return new Float64Array(c,h,3)};a.zeros=function(){return e()};a.ones=m;a.unitX=
k;a.unitY=l;a.unitZ=g;a.ZEROS=e();a.ONES=m();a.UNIT_X=k();a.UNIT_Y=l();a.UNIT_Z=g()})},"esri/core/libs/gl-matrix-2/math/common":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});a.EPSILON=1E-6;a.RANDOM=Math.random;var e=Math.PI/180,m=180/Math.PI;a.toRadian=function(a){return a*e};a.toDegree=function(a){return a*m};a.equals=function(e,l){return Math.abs(e-l)<=a.EPSILON*Math.max(1,Math.abs(e),Math.abs(l))}})},"esri/core/libs/gl-matrix-2/vec3f64":function(){define(["require",
"exports","./factories/vec3f64"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.vec3f64=e})},"esri/core/libs/gl-matrix-2/common":function(){define(["require","exports","./math/common"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.common=e})},"esri/core/libs/gl-matrix-2/mat2d":function(){define(["require","exports","./math/mat2d"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.mat2d=e})},"esri/core/libs/gl-matrix-2/math/mat2d":function(){define(["require",
"exports","./common"],function(f,a,e){function m(a,g,c){var h=g[0],b=g[1],d=g[2],e=g[3],p=g[4];g=g[5];var r=c[0],q=c[1],l=c[2],f=c[3],k=c[4];c=c[5];a[0]=h*r+d*q;a[1]=b*r+e*q;a[2]=h*l+d*f;a[3]=b*l+e*f;a[4]=h*k+d*c+p;a[5]=b*k+e*c+g;return a}function k(a,g,c){a[0]=g[0]-c[0];a[1]=g[1]-c[1];a[2]=g[2]-c[2];a[3]=g[3]-c[3];a[4]=g[4]-c[4];a[5]=g[5]-c[5];return a}Object.defineProperty(a,"__esModule",{value:!0});a.copy=function(a,g){a[0]=g[0];a[1]=g[1];a[2]=g[2];a[3]=g[3];a[4]=g[4];a[5]=g[5];return a};a.identity=
function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a};a.set=function(a,g,c,h,b,d,e){a[0]=g;a[1]=c;a[2]=h;a[3]=b;a[4]=d;a[5]=e;return a};a.invert=function(a,g){var c=g[0],h=g[1],b=g[2],d=g[3],e=g[4];g=g[5];var p=c*d-h*b;if(!p)return null;p=1/p;a[0]=d*p;a[1]=-h*p;a[2]=-b*p;a[3]=c*p;a[4]=(b*g-d*e)*p;a[5]=(h*e-c*g)*p;return a};a.determinant=function(a){return a[0]*a[3]-a[1]*a[2]};a.multiply=m;a.rotate=function(a,g,c){var h=g[0],b=g[1],d=g[2],e=g[3],p=g[4];g=g[5];var r=Math.sin(c);c=Math.cos(c);
a[0]=h*c+d*r;a[1]=b*c+e*r;a[2]=h*-r+d*c;a[3]=b*-r+e*c;a[4]=p;a[5]=g;return a};a.scale=function(a,g,c){var h=g[1],b=g[2],d=g[3],e=g[4],p=g[5],r=c[0];c=c[1];a[0]=g[0]*r;a[1]=h*r;a[2]=b*c;a[3]=d*c;a[4]=e;a[5]=p;return a};a.translate=function(a,g,c){var h=g[0],b=g[1],d=g[2],e=g[3],p=g[4];g=g[5];var r=c[0];c=c[1];a[0]=h;a[1]=b;a[2]=d;a[3]=e;a[4]=h*r+d*c+p;a[5]=b*r+e*c+g;return a};a.fromRotation=function(a,g){var c=Math.sin(g);g=Math.cos(g);a[0]=g;a[1]=c;a[2]=-c;a[3]=g;a[4]=0;a[5]=0;return a};a.fromScaling=
function(a,g){a[0]=g[0];a[1]=0;a[2]=0;a[3]=g[1];a[4]=0;a[5]=0;return a};a.fromTranslation=function(a,g){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=g[0];a[5]=g[1];return a};a.str=function(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"};a.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)};a.add=function(a,g,c){a[0]=g[0]+c[0];a[1]=g[1]+c[1];a[2]=g[2]+c[2];a[3]=g[3]+c[3];a[4]=g[4]+c[4];a[5]=g[5]+
c[5];return a};a.subtract=k;a.multiplyScalar=function(a,g,c){a[0]=g[0]*c;a[1]=g[1]*c;a[2]=g[2]*c;a[3]=g[3]*c;a[4]=g[4]*c;a[5]=g[5]*c;return a};a.multiplyScalarAndAdd=function(a,g,c,h){a[0]=g[0]+c[0]*h;a[1]=g[1]+c[1]*h;a[2]=g[2]+c[2]*h;a[3]=g[3]+c[3]*h;a[4]=g[4]+c[4]*h;a[5]=g[5]+c[5]*h;return a};a.exactEquals=function(a,g){return a[0]===g[0]&&a[1]===g[1]&&a[2]===g[2]&&a[3]===g[3]&&a[4]===g[4]&&a[5]===g[5]};a.equals=function(a,g){var c=a[0],h=a[1],b=a[2],d=a[3],n=a[4];a=a[5];var p=g[0],r=g[1],q=g[2],
l=g[3],f=g[4];g=g[5];return Math.abs(c-p)<=e.EPSILON*Math.max(1,Math.abs(c),Math.abs(p))&&Math.abs(h-r)<=e.EPSILON*Math.max(1,Math.abs(h),Math.abs(r))&&Math.abs(b-q)<=e.EPSILON*Math.max(1,Math.abs(b),Math.abs(q))&&Math.abs(d-l)<=e.EPSILON*Math.max(1,Math.abs(d),Math.abs(l))&&Math.abs(n-f)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(a-g)<=e.EPSILON*Math.max(1,Math.abs(a),Math.abs(g))};a.mul=m;a.sub=k})},"esri/core/libs/gl-matrix-2/mat2df32":function(){define(["require","exports","./factories/mat2df32"],
function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.mat2df32=e})},"esri/core/libs/gl-matrix-2/factories/mat2df32":function(){define(["require","exports"],function(f,a){function e(a,e,l,g){var c=e[g];e=e[g+1];a[g]=l[0]*c+l[2]*e+l[4];a[g+1]=l[1]*c+l[3]*e+l[5]}Object.defineProperty(a,"__esModule",{value:!0});a.create=function(){var a=new Float32Array(6);a[0]=1;a[3]=1;return a};a.clone=function(a){var e=new Float32Array(6);e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=a[3];e[4]=a[4];e[5]=a[5];return e};
a.fromValues=function(a,e,l,g,c,h){var b=new Float32Array(6);b[0]=a;b[1]=e;b[2]=l;b[3]=g;b[4]=c;b[5]=h;return b};a.createView=function(a,e){return new Float32Array(a,e,6)};a.transform=e;a.transformMany=function(a,f,l,g,c,h){void 0===g&&(g=0);void 0===c&&(c=0);void 0===h&&(h=2);for(c=c||f.length/h;g<c;g++)e(a,f,l,g*h)}})},"esri/core/libs/gl-matrix-2/mat2df64":function(){define(["require","exports","./factories/mat2df64"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.mat2df64=e})},
"esri/core/libs/gl-matrix-2/factories/mat2df64":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});a.create=function(){return[1,0,0,1,0,0]};a.clone=function(a){return[a[0],a[1],a[2],a[3],a[4],a[5]]};a.fromValues=function(a,f,k,l,g,c){return[a,f,k,l,g,c]};a.createView=function(a,f){return new Float64Array(a,f,6)}})},"esri/core/libs/gl-matrix-2/mat3":function(){define(["require","exports","./math/mat3"],function(f,a,e){Object.defineProperty(a,"__esModule",
{value:!0});a.mat3=e})},"esri/core/libs/gl-matrix-2/math/mat3":function(){define(["require","exports","./common"],function(f,a,e){function m(a,g,c){var h=g[0],b=g[1],d=g[2],e=g[3],p=g[4],r=g[5],q=g[6],l=g[7];g=g[8];var f=c[0],k=c[1],y=c[2],m=c[3],A=c[4],B=c[5],D=c[6],C=c[7];c=c[8];a[0]=f*h+k*e+y*q;a[1]=f*b+k*p+y*l;a[2]=f*d+k*r+y*g;a[3]=m*h+A*e+B*q;a[4]=m*b+A*p+B*l;a[5]=m*d+A*r+B*g;a[6]=D*h+C*e+c*q;a[7]=D*b+C*p+c*l;a[8]=D*d+C*r+c*g;return a}function k(a,g,c){a[0]=g[0]-c[0];a[1]=g[1]-c[1];a[2]=g[2]-
c[2];a[3]=g[3]-c[3];a[4]=g[4]-c[4];a[5]=g[5]-c[5];a[6]=g[6]-c[6];a[7]=g[7]-c[7];a[8]=g[8]-c[8];return a}Object.defineProperty(a,"__esModule",{value:!0});a.fromMat4=function(a,g){a[0]=g[0];a[1]=g[1];a[2]=g[2];a[3]=g[4];a[4]=g[5];a[5]=g[6];a[6]=g[8];a[7]=g[9];a[8]=g[10];return a};a.copy=function(a,g){a[0]=g[0];a[1]=g[1];a[2]=g[2];a[3]=g[3];a[4]=g[4];a[5]=g[5];a[6]=g[6];a[7]=g[7];a[8]=g[8];return a};a.set=function(a,g,c,h,b,d,e,p,r,q){a[0]=g;a[1]=c;a[2]=h;a[3]=b;a[4]=d;a[5]=e;a[6]=p;a[7]=r;a[8]=q;return a};
a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,g){if(a===g){var c=g[1],h=g[2],b=g[5];a[1]=g[3];a[2]=g[6];a[3]=c;a[5]=g[7];a[6]=h;a[7]=b}else a[0]=g[0],a[1]=g[3],a[2]=g[6],a[3]=g[1],a[4]=g[4],a[5]=g[7],a[6]=g[2],a[7]=g[5],a[8]=g[8];return a};a.invert=function(a,g){var c=g[0],h=g[1],b=g[2],d=g[3],e=g[4],p=g[5],r=g[6],q=g[7];g=g[8];var f=g*e-p*q,l=-g*d+p*r,k=q*d-e*r,y=c*f+h*l+b*k;if(!y)return null;y=1/y;a[0]=f*y;a[1]=(-g*h+b*q)*
y;a[2]=(p*h-b*e)*y;a[3]=l*y;a[4]=(g*c-b*r)*y;a[5]=(-p*c+b*d)*y;a[6]=k*y;a[7]=(-q*c+h*r)*y;a[8]=(e*c-h*d)*y;return a};a.adjoint=function(a,g){var c=g[0],h=g[1],b=g[2],d=g[3],e=g[4],p=g[5],r=g[6],q=g[7];g=g[8];a[0]=e*g-p*q;a[1]=b*q-h*g;a[2]=h*p-b*e;a[3]=p*r-d*g;a[4]=c*g-b*r;a[5]=b*d-c*p;a[6]=d*q-e*r;a[7]=h*r-c*q;a[8]=c*e-h*d;return a};a.determinant=function(a){var g=a[3],c=a[4],h=a[5],b=a[6],d=a[7],e=a[8];return a[0]*(e*c-h*d)+a[1]*(-e*g+h*b)+a[2]*(d*g-c*b)};a.multiply=m;a.translate=function(a,g,c){var h=
g[0],b=g[1],d=g[2],e=g[3],p=g[4],r=g[5],q=g[6],f=g[7];g=g[8];var l=c[0];c=c[1];a[0]=h;a[1]=b;a[2]=d;a[3]=e;a[4]=p;a[5]=r;a[6]=l*h+c*e+q;a[7]=l*b+c*p+f;a[8]=l*d+c*r+g;return a};a.rotate=function(a,g,c){var h=g[0],b=g[1],d=g[2],e=g[3],p=g[4],r=g[5],q=g[6],f=g[7];g=g[8];var l=Math.sin(c);c=Math.cos(c);a[0]=c*h+l*e;a[1]=c*b+l*p;a[2]=c*d+l*r;a[3]=c*e-l*h;a[4]=c*p-l*b;a[5]=c*r-l*d;a[6]=q;a[7]=f;a[8]=g;return a};a.scale=function(a,g,c){var h=c[0],b=c[1];c=c[2];a[0]=h*g[0];a[1]=h*g[1];a[2]=h*g[2];a[3]=b*
g[3];a[4]=b*g[4];a[5]=b*g[5];a[6]=c*g[6];a[7]=c*g[7];a[8]=c*g[8];return a};a.scaleByVec2=function(a,g,c){var h=c[0];c=c[1];a[0]=h*g[0];a[1]=h*g[1];a[2]=h*g[2];a[3]=c*g[3];a[4]=c*g[4];a[5]=c*g[5];return a};a.fromTranslation=function(a,g){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=g[0];a[7]=g[1];a[8]=1;return a};a.fromRotation=function(a,g){var c=Math.sin(g);g=Math.cos(g);a[0]=g;a[1]=c;a[2]=0;a[3]=-c;a[4]=g;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromScaling=function(a,g){a[0]=g[0];a[1]=0;a[2]=
0;a[3]=0;a[4]=g[1];a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat2d=function(a,g){a[0]=g[0];a[1]=g[1];a[2]=0;a[3]=g[2];a[4]=g[3];a[5]=0;a[6]=g[4];a[7]=g[5];a[8]=1;return a};a.fromQuat=function(a,g){var c=g[0],h=g[1],b=g[2];g=g[3];var d=c+c,e=h+h,p=b+b,c=c*d,r=h*d,h=h*e,q=b*d,f=b*e,b=b*p,d=g*d,e=g*e;g*=p;a[0]=1-h-b;a[3]=r-g;a[6]=q+e;a[1]=r+g;a[4]=1-c-b;a[7]=f-d;a[2]=q-e;a[5]=f+d;a[8]=1-c-h;return a};a.normalFromMat4Legacy=function(a,g){var c=g[0],h=g[1],b=g[2],d=g[4],e=g[5],p=g[6],r=g[8],q=g[9];g=
g[10];var f=g*e-p*q,u=-g*d+p*r,l=q*d-e*r,k=c*f+h*u+b*l;if(!k)return null;k=1/k;a[0]=f*k;a[1]=(-g*h+b*q)*k;a[2]=(p*h-b*e)*k;a[3]=u*k;a[4]=(g*c-b*r)*k;a[5]=(-p*c+b*d)*k;a[6]=l*k;a[7]=(-q*c+h*r)*k;a[8]=(e*c-h*d)*k;return a};a.normalFromMat4=function(a,g){var c=g[0],h=g[1],b=g[2],d=g[3],e=g[4],p=g[5],r=g[6],q=g[7],f=g[8],u=g[9],l=g[10],k=g[11],m=g[12],A=g[13],B=g[14];g=g[15];var D=c*p-h*e,C=c*r-b*e,E=c*q-d*e,F=h*r-b*p,I=h*q-d*p,J=b*q-d*r,G=f*A-u*m,H=f*B-l*m,f=f*g-k*m,K=u*B-l*A,u=u*g-k*A,l=l*g-k*B,k=D*
l-C*u+E*K+F*f-I*H+J*G;if(!k)return null;k=1/k;a[0]=(p*l-r*u+q*K)*k;a[1]=(r*f-e*l-q*H)*k;a[2]=(e*u-p*f+q*G)*k;a[3]=(b*u-h*l-d*K)*k;a[4]=(c*l-b*f+d*H)*k;a[5]=(h*f-c*u-d*G)*k;a[6]=(A*J-B*I+g*F)*k;a[7]=(B*E-m*J-g*C)*k;a[8]=(m*I-A*E+g*D)*k;return a};a.projection=function(a,g,c){a[0]=2/g;a[1]=0;a[2]=0;a[3]=0;a[4]=-2/c;a[5]=0;a[6]=-1;a[7]=1;a[8]=1;return a};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.frob=function(a){return Math.sqrt(Math.pow(a[0],
2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};a.add=function(a,g,c){a[0]=g[0]+c[0];a[1]=g[1]+c[1];a[2]=g[2]+c[2];a[3]=g[3]+c[3];a[4]=g[4]+c[4];a[5]=g[5]+c[5];a[6]=g[6]+c[6];a[7]=g[7]+c[7];a[8]=g[8]+c[8];return a};a.subtract=k;a.multiplyScalar=function(a,g,c){a[0]=g[0]*c;a[1]=g[1]*c;a[2]=g[2]*c;a[3]=g[3]*c;a[4]=g[4]*c;a[5]=g[5]*c;a[6]=g[6]*c;a[7]=g[7]*c;a[8]=g[8]*c;return a};a.multiplyScalarAndAdd=function(a,
g,c,h){a[0]=g[0]+c[0]*h;a[1]=g[1]+c[1]*h;a[2]=g[2]+c[2]*h;a[3]=g[3]+c[3]*h;a[4]=g[4]+c[4]*h;a[5]=g[5]+c[5]*h;a[6]=g[6]+c[6]*h;a[7]=g[7]+c[7]*h;a[8]=g[8]+c[8]*h;return a};a.exactEquals=function(a,g){return a[0]===g[0]&&a[1]===g[1]&&a[2]===g[2]&&a[3]===g[3]&&a[4]===g[4]&&a[5]===g[5]&&a[6]===g[6]&&a[7]===g[7]&&a[8]===g[8]};a.equals=function(a,g){var c=a[0],h=a[1],b=a[2],d=a[3],n=a[4],p=a[5],r=a[6],q=a[7];a=a[8];var f=g[0],u=g[1],l=g[2],k=g[3],m=g[4],A=g[5],B=g[6],D=g[7];g=g[8];return Math.abs(c-f)<=
e.EPSILON*Math.max(1,Math.abs(c),Math.abs(f))&&Math.abs(h-u)<=e.EPSILON*Math.max(1,Math.abs(h),Math.abs(u))&&Math.abs(b-l)<=e.EPSILON*Math.max(1,Math.abs(b),Math.abs(l))&&Math.abs(d-k)<=e.EPSILON*Math.max(1,Math.abs(d),Math.abs(k))&&Math.abs(n-m)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(p-A)<=e.EPSILON*Math.max(1,Math.abs(p),Math.abs(A))&&Math.abs(r-B)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(B))&&Math.abs(q-D)<=e.EPSILON*Math.max(1,Math.abs(q),Math.abs(D))&&Math.abs(a-g)<=e.EPSILON*
Math.max(1,Math.abs(a),Math.abs(g))};a.mul=m;a.sub=k})},"esri/core/libs/gl-matrix-2/mat3f32":function(){define(["require","exports","./factories/mat3f32"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.mat3f32=e})},"esri/core/libs/gl-matrix-2/factories/mat3f32":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});a.create=function(){var a=new Float32Array(9);a[0]=1;a[4]=1;a[8]=1;return a};a.clone=function(a){var e=new Float32Array(9);
e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=a[3];e[4]=a[4];e[5]=a[5];e[6]=a[6];e[7]=a[7];e[8]=a[8];return e};a.fromValues=function(a,f,k,l,g,c,h,b,d){var e=new Float32Array(9);e[0]=a;e[1]=f;e[2]=k;e[3]=l;e[4]=g;e[5]=c;e[6]=h;e[7]=b;e[8]=d;return e};a.createView=function(a,f){return new Float32Array(a,f,9)}})},"esri/core/libs/gl-matrix-2/vec2":function(){define(["require","exports","./math/vec2"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.vec2=e})},"esri/core/libs/gl-matrix-2/math/vec2":function(){define(["require",
"exports","./common"],function(f,a,e){function m(b,c,a){b[0]=c[0]-a[0];b[1]=c[1]-a[1];return b}function k(b,c,a){b[0]=c[0]*a[0];b[1]=c[1]*a[1];return b}function l(b,c,a){b[0]=c[0]/a[0];b[1]=c[1]/a[1];return b}function g(b,c){var d=c[0]-b[0];b=c[1]-b[1];return Math.sqrt(d*d+b*b)}function c(b,c){var d=c[0]-b[0];b=c[1]-b[1];return d*d+b*b}function h(b){var d=b[0];b=b[1];return Math.sqrt(d*d+b*b)}function b(b){var d=b[0];b=b[1];return d*d+b*b}Object.defineProperty(a,"__esModule",{value:!0});a.copy=function(b,
c){b[0]=c[0];b[1]=c[1];return b};a.set=function(b,c,a){b[0]=c;b[1]=a;return b};a.add=function(b,c,a){b[0]=c[0]+a[0];b[1]=c[1]+a[1];return b};a.subtract=m;a.multiply=k;a.divide=l;a.ceil=function(b,c){b[0]=Math.ceil(c[0]);b[1]=Math.ceil(c[1]);return b};a.floor=function(b,c){b[0]=Math.floor(c[0]);b[1]=Math.floor(c[1]);return b};a.min=function(b,c,a){b[0]=Math.min(c[0],a[0]);b[1]=Math.min(c[1],a[1]);return b};a.max=function(b,c,a){b[0]=Math.max(c[0],a[0]);b[1]=Math.max(c[1],a[1]);return b};a.round=function(b,
c){b[0]=Math.round(c[0]);b[1]=Math.round(c[1]);return b};a.scale=function(b,c,a){b[0]=c[0]*a;b[1]=c[1]*a;return b};a.scaleAndAdd=function(b,c,a,h){b[0]=c[0]+a[0]*h;b[1]=c[1]+a[1]*h;return b};a.distance=g;a.squaredDistance=c;a.length=h;a.squaredLength=b;a.negate=function(b,c){b[0]=-c[0];b[1]=-c[1];return b};a.inverse=function(b,c){b[0]=1/c[0];b[1]=1/c[1];return b};a.normalize=function(b,c){var d=c[0],a=c[1],d=d*d+a*a;0<d&&(d=1/Math.sqrt(d),b[0]=c[0]*d,b[1]=c[1]*d);return b};a.dot=function(b,c){return b[0]*
c[0]+b[1]*c[1]};a.cross=function(b,c,a){c=c[0]*a[1]-c[1]*a[0];b[0]=b[1]=0;b[2]=c;return b};a.lerp=function(b,c,a,h){var d=c[0];c=c[1];b[0]=d+h*(a[0]-d);b[1]=c+h*(a[1]-c);return b};a.random=function(b,c){c=c||1;var d=2*e.RANDOM()*Math.PI;b[0]=Math.cos(d)*c;b[1]=Math.sin(d)*c;return b};a.transformMat2=function(b,c,a){var d=c[0];c=c[1];b[0]=a[0]*d+a[2]*c;b[1]=a[1]*d+a[3]*c;return b};a.transformMat2d=function(b,c,a){var d=c[0];c=c[1];b[0]=a[0]*d+a[2]*c+a[4];b[1]=a[1]*d+a[3]*c+a[5];return b};a.transformMat3=
function(b,c,a){var d=c[0];c=c[1];b[0]=a[0]*d+a[3]*c+a[6];b[1]=a[1]*d+a[4]*c+a[7];return b};a.transformMat4=function(b,c,a){var d=c[0];c=c[1];b[0]=a[0]*d+a[4]*c+a[12];b[1]=a[1]*d+a[5]*c+a[13];return b};a.rotate=function(b,c,a,h){var d=c[0]-a[0];c=c[1]-a[1];var g=Math.sin(h);h=Math.cos(h);b[0]=d*h-c*g+a[0];b[1]=d*g+c*h+a[1];return b};a.angle=function(b,c){var d=b[0];b=b[1];var a=c[0];c=c[1];var h=d*d+b*b;0<h&&(h=1/Math.sqrt(h));var g=a*a+c*c;0<g&&(g=1/Math.sqrt(g));d=(d*a+b*c)*h*g;return 1<d?0:-1>
d?Math.PI:Math.acos(d)};a.str=function(b){return"vec2("+b[0]+", "+b[1]+")"};a.exactEquals=function(b,c){return b[0]===c[0]&&b[1]===c[1]};a.equals=function(b,c){var d=b[0];b=b[1];var a=c[0];c=c[1];return Math.abs(d-a)<=e.EPSILON*Math.max(1,Math.abs(d),Math.abs(a))&&Math.abs(b-c)<=e.EPSILON*Math.max(1,Math.abs(b),Math.abs(c))};a.len=h;a.sub=m;a.mul=k;a.div=l;a.dist=g;a.sqrDist=c;a.sqrLen=b})},"esri/core/libs/gl-matrix-2/vec2f32":function(){define(["require","exports","./factories/vec2f32"],function(f,
a,e){Object.defineProperty(a,"__esModule",{value:!0});a.vec2f32=e})},"esri/core/libs/gl-matrix-2/factories/vec2f32":function(){define(["require","exports"],function(f,a){function e(){return new Float32Array(2)}function m(c,a){var b=new Float32Array(2);b[0]=c;b[1]=a;return b}function k(){return m(1,1)}function l(){return m(1,0)}function g(){return m(0,1)}Object.defineProperty(a,"__esModule",{value:!0});a.create=e;a.clone=function(c){var a=new Float32Array(2);a[0]=c[0];a[1]=c[1];return a};a.fromValues=
m;a.createView=function(c,a){return new Float32Array(c,a,2)};a.zeros=function(){return e()};a.ones=k;a.unitX=l;a.unitY=g;a.ZEROS=e();a.ONES=k();a.UNIT_X=l();a.UNIT_Y=g()})},"esri/core/libs/gl-matrix-2/vec2f64":function(){define(["require","exports","./factories/vec2f64"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.vec2f64=e})},"esri/core/libs/gl-matrix-2/factories/vec2f64":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});
a.create=function(){return[0,0]};a.clone=function(a){return[a[0],a[1]]};a.fromValues=function(a,f){return[a,f]};a.fromArray=function(a){for(var e=[0,0],f=Math.min(2,a.length),l=0;l<f;++l)e[l]=a[l];return e};a.createView=function(a,f){return new Float64Array(a,f,2)};a.zeros=function(){return[0,0]};a.ones=function(){return[1,1]};a.unitX=function(){return[1,0]};a.unitY=function(){return[0,1]};a.ZEROS=[0,0];a.ONES=[1,1];a.UNIT_X=[1,0];a.UNIT_Y=[0,1]})},"esri/core/libs/gl-matrix-2/types/vec2":function(){define(["require",
"exports"],function(f,a){function e(a){return a instanceof Float32Array&&2<=a.length}function m(a){return Array.isArray(a)&&2<=a.length}Object.defineProperty(a,"__esModule",{value:!0});a.isVec2f32=e;a.isVec2f64=m;a.isVec2=function(a){return e(a)||m(a)}})},"esri/views/2d/viewpointUtils":function(){define("require exports tslib ../../Viewpoint ../../core/Collection ../../core/maybe ../../core/promiseUtils ../../core/unitUtils ../../core/wgs84Constants ../../core/libs/gl-matrix-2/common ../../core/libs/gl-matrix-2/mat2d ../../core/libs/gl-matrix-2/mat2df64 ../../core/libs/gl-matrix-2/vec2 ../../core/libs/gl-matrix-2/vec2f64 ../../geometry/Extent ../../geometry/Geometry ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ../../geometry/support/webMercatorUtils".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u,v,y,z,A){function B(d,c,a,h){return h&&a&&!h.equals(a)&&z.canProject(h,a)&&h.isWebMercator?(h.isWebMercator?(a=c[1],89.99999<a?a=89.99999:-89.99999>a&&(a=-89.99999),a=Math.sin(b.common.toRadian(a)),d=p.vec2.set(d,b.common.toRadian(c[0])*Q,.5*Q*Math.log((1+a)/(1-a)))):(a=b.common.toDegree(c[0]/Q),d=p.vec2.set(d,a-360*Math.floor((a+180)/360),b.common.toDegree(.5*Math.PI-2*Math.atan(Math.exp(-1*c[1]/Q))))),d):p.vec2.copy(d,c)}function D(b){return b.wkid?b:b.spatialReference||
v.WGS84}function C(b,d){return d.type?p.vec2.set(b,d.x,d.y):p.vec2.copy(b,d)}function E(b,d){return Math.max(b.width/d[0],b.height/d[1])*T(b.spatialReference)}function F(b,d,c,a){return e.__awaiter(this,void 0,void 0,function(){var h,n,p,r,f,v,y,m,A,B,C,D,E,I,H,J,K,G,O,L,N,T,Q,R,X,U,t,V;return e.__generator(this,function(e){switch(e.label){case 0:if(!b||Array.isArray(b)&&!b.length)return[2,null];k.isCollection(b)&&(b=b.toArray());if(!Array.isArray(b)||!b.length||"object"!==typeof b[0])return[3,7];
n=b.every(function(b){return"attributes"in b});p=b.some(function(b){return!b.geometry});r=b;if(!(n&&p&&d&&d.allLayerViews))return[3,2];f=new Map;v=0;for(y=b;v<y.length;v++)m=y[v],A=m.layer,B=f.get(A)||[],C=m.attributes[A.objectIdField],null!=C&&B.push(C),f.set(A,B);D=[];f.forEach(function(b,c){var a=d.allLayerViews.find(function(b){return b.layer.id===c.id});if("queryFeatures"in a){var h=c.createQuery();h.objectIds=b;h.returnGeometry=!0;D.push(a.queryFeatures(h))}});return[4,g.all(D)];case 1:E=e.sent();
I=[];H=0;for(J=E;H<J.length;H++)if((K=J[H])&&K.features&&K.features.length)for(G=0,O=K.features;G<O.length;G++)m=O[G],l.isSome(m.geometry)&&I.push(m.geometry);r=I;e.label=2;case 2:L=0,N=r,e.label=3;case 3:if(!(L<N.length))return[3,6];T=N[L];return[4,F(T,d,c,a)];case 4:a=e.sent(),e.label=5;case 5:return L++,[3,3];case 6:return[2,a];case 7:if(!Array.isArray(b)||2!==b.length||"number"!==typeof b[0]||"number"!==typeof b[1])return[3,8];h=new u(b);return[3,12];case 8:if(!(b instanceof x))return[3,9];h=
b;return[3,12];case 9:if(!("geometry"in b))return[3,12];if(!b.geometry)return[3,10];h=b.geometry;return[3,12];case 10:if(!b.layer)return[3,12];Q=b.layer;R=d.allLayerViews.find(function(b){return b.layer.id===Q.id});if(!("queryFeatures"in R))return[3,12];X=Q.createQuery();X.objectIds=[b.attributes[Q.objectIdField]];X.returnGeometry=!0;return[4,R.queryFeatures(X)];case 11:U=e.sent(),h=l.get(U,"features",0,"geometry"),e.label=12;case 12:if(l.isNone(h))return[2,null];t="point"===h.type?new q({xmin:h.x,
ymin:h.y,xmax:h.x,ymax:h.y,spatialReference:h.spatialReference}):h.extent;if(!t)return[2,null];V=z.canProject(t,c);if(!t.spatialReference.equals(c)&&V)t=z.project(t,c);else if(!V)return[2,null];a=a?a.union(t):t.clone();return[2,a]}})})}function I(b){if(b&&(!Array.isArray(b)||"number"!==typeof b[0])&&("object"===typeof b||Array.isArray(b)&&"object"===typeof b[0])){if("layer"in b&&b.layer&&b.layer.minScale&&b.layer.maxScale){var d=b.layer;return{min:d.minScale,max:d.maxScale}}if(Array.isArray(b)&&b.length&&
b.every(function(b){return"layer"in b})){for(var c=0,a=0,h=0;h<b.length;h++)(d=b[h].layer)&&d.minScale&&d.maxScale&&(c=d.minScale<c?d.minScale:c,a=d.maxScale>a?d.maxScale:a);return c&&a?{min:c,max:a}:null}}}function J(b,d){return e.__awaiter(this,void 0,void 0,function(){var c,a,h,g,n,p,f,x,l,k,v,y,H,J,K,G,O,L,N,T;return e.__generator(this,function(e){switch(e.label){case 0:if(!b||!d)return[2,new m({targetGeometry:new u,scale:0,rotation:0})];c=d.spatialReference;a=d.constraints;h=d.padding;g=d.viewpoint;
n=d.size;p=h?n[0]-h.left-h.right:n[0];f=h?n[1]-h.top-h.bottom:n[1];x=[p,f];l=null;b instanceof m?l=b:b.viewpoint?l=b.viewpoint:b.target&&"esri.Viewpoint"===b.target.declaredClass&&(l=b.target);k=null;if(!l||!l.targetGeometry)return[3,1];k=l.targetGeometry;return[3,10];case 1:if(!(b instanceof q))return[3,2];k=b;return[3,10];case 2:return b||b&&("center"in b||"extent"in b||"target"in b)?[4,F(b.center,d,c)]:[3,10];case 3:return(H=e.sent())?[3,5]:[4,F(b.extent,d,c)];case 4:H=e.sent(),e.label=5;case 5:return(y=
H)?[3,7]:[4,F(b.target,d,c)];case 6:y=e.sent(),e.label=7;case 7:return(v=y)?[3,9]:[4,F(b,d,c)];case 8:v=e.sent(),e.label=9;case 9:k=v,e.label=10;case 10:!k&&g&&g.targetGeometry?k=g.targetGeometry:!k&&d.extent&&(k=d.extent);J=D(k);c||(c=D(d.spatialReference||d.extent||k));if(!A.canProject(k,c)&&J&&!J.equals(c))return[2,null];K=C(r.vec2f64.create(),k.center?k.center:k);G=new u(B(K,K,J,c),c);O=null;O=l&&l.targetGeometry&&"point"===l.targetGeometry.type?l.scale:b.hasOwnProperty("scale")&&b.scale?b.scale:
b.hasOwnProperty("zoom")&&-1!==b.zoom&&a&&a.effectiveLODs?a.zoomToScale(b.zoom):Array.isArray(k)||"point"===k.type||"extent"===k.type&&0===k.width&&0===k.height?d.extent&&z.canProject(d.extent,c)?E(z.project(d.extent,c),x):d.extent?E(d.extent,x):g.scale:z.canProject(k.extent,c)?E(z.project(k.extent,c),x):E(k.extent,x);if(L=I(b))L.min&&L.min>O?O=L.min:L.max&&L.max<O&&(O=L.max);N=0;l?N=l.rotation:b.hasOwnProperty("rotation")?N=b.rotation:g&&(N=g.rotation);T=new m({targetGeometry:G,scale:O,rotation:N});
a&&(T=a.fit(T),a.rotationEnabled||(T.rotation=N));return[2,T]}})})}function G(b,d){var c=b.targetGeometry,a=d.targetGeometry;c.x=a.x;c.y=a.y;c.spatialReference=a.spatialReference;b.scale=d.scale;b.rotation=d.rotation;return b}function H(b,d,c){return c?p.vec2.set(b,.5*(d[0]-c.right+c.left),.5*(d[1]-c.bottom+c.top)):p.vec2.scale(b,d,.5)}function K(b,c,h,g){a.getTransform(b,c,h,g);return d.mat2d.invert(b,b)}function O(b,d,c){var a=N(d);d=Math.abs(Math.cos(a));a=Math.abs(Math.sin(a));return p.vec2.set(b,
Math.round(c[1]*a+c[0]*d),Math.round(c[1]*d+c[0]*a))}function L(b){var d=b.scale;b=b.targetGeometry.spatialReference;b=y.isValid(b)?1/(39.37*c.getMetersPerUnitForSR(b)*96):1;return d*b}function N(d){return b.common.toRadian(d.rotation)||0}function T(b){return y.isValid(b)?39.37*c.getMetersPerUnitForSR(b)*96:1}function R(b){return b.isWrappable?(b=y.getInfo(b),b.valid[1]-b.valid[0]):0}Object.defineProperty(a,"__esModule",{value:!0});var Q=h.wgs84Radius,S=180/Math.PI;a.extentToScale=E;a.create=J;a.copy=
G;a.getAnchor=H;a.getExtent=function(){var b=r.vec2f64.create();return function(d,c,a){var h=c.targetGeometry;C(b,h);c=.5*L(c);d.xmin=b[0]-c*a[0];d.ymin=b[1]-c*a[1];d.xmax=b[0]+c*a[0];d.ymax=b[1]+c*a[1];d.spatialReference=h.spatialReference;return d}}();a.setExtent=function(b,d,c,h,g){a.centerAt(b,d,c.center);b.scale=E(c,h);g&&g.constraints&&g.constraints.constrain(b);return b};a.getOuterExtent=function(){var b=r.vec2f64.create(),d=r.vec2f64.create();return function(c,a,h){C(b,a.targetGeometry);O(d,
a,h);h=.5*L(a);c.set({xmin:b[0]-h*d[0],ymin:b[1]-h*d[1],xmax:b[0]+h*d[0],ymax:b[1]+h*d[1],spatialReference:a.targetGeometry.spatialReference});return c}}();a.getOuterSize=O;a.getPaddingScreenTranslation=function(){var b=r.vec2f64.create();return function(d,c,a){return p.vec2.sub(d,p.vec2.scale(d,c,.5),H(b,c,a))}}();a.getPaddingMapTranslation=function(){var b=n.mat2df64.create(),c=r.vec2f64.create();return function(h,g,e,n){var q=L(g);g=N(g);p.vec2.set(c,q,q);d.mat2d.fromScaling(b,c);d.mat2d.rotate(b,
b,g);d.mat2d.translate(b,b,a.getPaddingScreenTranslation(c,e,n));d.mat2d.translate(b,b,[0,n.top-n.bottom]);return p.vec2.set(h,b[4],b[5])}}();a.getResolution=L;a.getResolutionToScaleFactor=T;a.getMatrix=function(){var b=r.vec2f64.create(),c=r.vec2f64.create(),a=r.vec2f64.create();return function(h,g,e,n,q,r){p.vec2.negate(b,g);p.vec2.scale(c,e,.5*r);p.vec2.set(a,1/n*r,-1/n*r);d.mat2d.identity(h);d.mat2d.translate(h,h,c);q&&d.mat2d.rotate(h,h,q);d.mat2d.scale(h,h,a);d.mat2d.translate(h,h,b);return h}}();
a.getTransform=function(){var b=r.vec2f64.create();return function(d,c,h,g){var e=L(c),n=N(c);C(b,c.targetGeometry);return a.getMatrix(d,b,h,e,n,g)}}();a.getTransformNoRotation=function(){var b=r.vec2f64.create();return function(d,c,h,g){var e=L(c);C(b,c.targetGeometry);return a.getMatrix(d,b,h,e,0,g)}}();a.getWorldWidth=R;a.getWorldScreenWidth=function(b,d){return Math.round(R(b)/d)};a.createAsync=function(b,d){return J(b,d)};a.angleBetween=function(){var b=r.vec2f64.create(),d=r.vec2f64.create(),
c=[0,0,0];return function(a,h,g){p.vec2.subtract(b,a,h);p.vec2.normalize(b,b);p.vec2.subtract(d,a,g);p.vec2.normalize(d,d);p.vec2.cross(c,b,d);a=Math.acos(p.vec2.dot(b,d)/(p.vec2.length(b)*p.vec2.length(d)))*S;0>c[2]&&(a=-a);isNaN(a)&&(a=0);return a}}();a.addPadding=function(){var b=r.vec2f64.create();return function(d,c,h,g){var e=d.targetGeometry;G(d,c);a.getPaddingMapTranslation(b,c,h,g);e.x+=b[0];e.y+=b[1];return d}}();a.removePadding=function(){var b=r.vec2f64.create();return function(d,c,h,
g){var e=d.targetGeometry;G(d,c);a.getPaddingMapTranslation(b,c,h,g);e.x-=b[0];e.y-=b[1];return d}}();a.centerAt=function(){var b=r.vec2f64.create();return function(d,c,a){G(d,c);c=d.targetGeometry;var h=D(a),g=D(c);C(b,a);B(b,b,h,g);c.x=b[0];c.y=b[1];return d}}();a.pixelSize=function(b){return L(b)};a.resize=function(){var b=r.vec2f64.create();return function(d,c,h,g,e){e||(e="center");p.vec2.sub(b,h,g);p.vec2.scale(b,b,.5);h=b[0];g=b[1];switch(e){case "center":p.vec2.set(b,0,0);break;case "left":p.vec2.set(b,
-h,0);break;case "top":p.vec2.set(b,0,g);break;case "right":p.vec2.set(b,h,0);break;case "bottom":p.vec2.set(b,0,-g);break;case "top-left":p.vec2.set(b,-h,g);break;case "bottom-left":p.vec2.set(b,-h,-g);break;case "top-right":p.vec2.set(b,h,g);break;case "bottom-right":p.vec2.set(b,h,-g)}a.translateBy(d,c,b);return d}}();a.rotateBy=function(b,d,c){G(b,d);b.rotation+=c;return b};a.rotateTo=function(b,d,c){G(b,d);b.rotation=c;return b};a.scaleBy=function(){var b=r.vec2f64.create();return function(d,
c,h,g,e){G(d,c);isNaN(h)||0===h||(a.toMap(b,g,c,e),d.scale=c.scale*h,a.toScreen(b,b,d,e),a.translateBy(d,d,p.vec2.set(b,b[0]-g[0],g[1]-b[1])));return d}}();a.scaleTo=function(b,d,c){G(b,d);b.scale=c;return b};a.scaleAndRotateBy=function(){var b=r.vec2f64.create();return function(d,c,h,g,e,n){G(d,c);isNaN(h)||0===h||(a.toMap(b,e,c,n),d.scale=c.scale*h,d.rotation+=g,a.toScreen(b,b,d,n),a.translateBy(d,d,p.vec2.set(b,b[0]-e[0],e[1]-b[1])));return d}}();a.padAndScaleAndRotateBy=function(){var b=r.vec2f64.create(),
d=r.vec2f64.create();return function(c,h,g,e,n,q,r){a.getPaddingScreenTranslation(d,q,r);p.vec2.add(b,n,d);return e?a.scaleAndRotateBy(c,h,g,e,b,q):a.scaleBy(c,h,g,b,q)}}();a.toMap=function(){var b=n.mat2df64.create();return function(d,c,a,h){return p.vec2.transformMat2d(d,c,K(b,a,h,1))}}();a.toScreen=function(){var b=n.mat2df64.create();return function(d,c,h,g){return p.vec2.transformMat2d(d,c,a.getTransform(b,h,g,1))}}();a.translateBy=function(){var b=r.vec2f64.create(),c=n.mat2df64.create();return function(a,
h,g){G(a,h);var e=L(h),n=a.targetGeometry;d.mat2d.fromRotation(c,N(h));d.mat2d.scale(c,c,r.vec2f64.fromValues(e,e));p.vec2.transformMat2d(b,g,c);n.x+=b[0];n.y+=b[1];return a}}()})},"esri/core/Collection":function(){define("require exports tslib ./ArrayPool ./arrayUtils ./Evented ./lang ./ObjectPool ./scheduling ./accessorSupport/decorators ./accessorSupport/ensureType".split(" "),function(f,a,e,m,k,l,g,c,h,b,d){function n(b){return b?b instanceof B?b.toArray():b.length?Array.prototype.slice.apply(b):
[]:[]}function p(b){if(b&&b.length)return b[0]}function r(b,d,c,a){d&&d.forEach(function(d,h,g){b.push(d);r(b,c.call(a,d,h,g),c,a)})}f=function(){function b(){this.target=null;this.defaultPrevented=this.cancellable=!1}b.prototype.preventDefault=function(){this.cancellable&&(this.defaultPrevented=!0)};b.prototype.reset=function(b){this.defaultPrevented=!1;this.item=b};return b}();var q=new c(f,null,function(b){b.item=null;b.target=null;b.defaultPrevented=!1;b.cancellable=!1}),x=function(){},u=new Set,
v=new Set,y=new Set,z=new Map,A=0,B=function(c){function a(b){b=c.call(this,b)||this;b._chgListeners=[];b._notifications=null;b._timer=null;b.length=0;b._items=[];Object.defineProperty(b,"uid",{value:A++});return b}e.__extends(a,c);f=a;a.isCollection=function(b){return null!=b&&b instanceof f};a.prototype.normalizeCtorArgs=function(b){return b?Array.isArray(b)||b instanceof f?{items:b}:b:{}};Object.defineProperty(a.prototype,"items",{get:function(){return this._items},set:function(b){this._emitBeforeChanges(1)||
(this._splice.apply(this,e.__spreadArrays([0,this.length],n(b))),this._emitAfterChanges(1))},enumerable:!0,configurable:!0});a.prototype.hasEventListener=function(b){return"change"===b?0<this._chgListeners.length:this._emitter.hasEventListener(b)};a.prototype.on=function(b,d){if("change"===b){var c=this._chgListeners,a={removed:!1,callback:d};c.push(a);this._notifications&&this._notifications.push({listeners:c.slice(),items:this._items.slice(),changes:[]});return{remove:function(){this.remove=x;a.removed=
!0;c.splice(c.indexOf(a),1)}}}return this._emitter.on(b,d)};a.prototype.once=function(b,d){var c=this.on(b,d);return{remove:function(){c.remove()}}};a.prototype.add=function(b,d){if(this._emitBeforeChanges(1))return this;d=this.getNextIndex(d);this._splice(d,0,b);this._emitAfterChanges(1);return this};a.prototype.addMany=function(b,d){void 0===d&&(d=this._items.length);if(!b||!b.length||this._emitBeforeChanges(1))return this;d=this.getNextIndex(d);this._splice.apply(this,e.__spreadArrays([d,0],n(b)));
this._emitAfterChanges(1);return this};a.prototype.removeAll=function(){if(!this.length||this._emitBeforeChanges(2))return[];var b=this._splice(0,this.length)||[];this._emitAfterChanges(2);return b};a.prototype.clone=function(){return this._createNewInstance({items:this._items.map(g.clone)})};a.prototype.concat=function(){for(var b,d=[],c=0;c<arguments.length;c++)d[c]=arguments[c];d=d.map(n);return this._createNewInstance({items:(b=this._items).concat.apply(b,d)})};a.prototype.drain=function(b,d){if(this.length&&
!this._emitBeforeChanges(2)){for(var c=this._splice(0,this.length),a=c.length,h=0;h<a;h++)b.call(d,c[h],h,c);this._emitAfterChanges(2)}};a.prototype.every=function(b,d){return this._items.every(b,d)};a.prototype.filter=function(b,d){var c;c=2===arguments.length?this._items.filter(b,d):this._items.filter(b);return this._createNewInstance({items:c})};a.prototype.find=function(b,d){return k.find(this._items,b,d)};a.prototype.findIndex=function(b,d){return k.findIndex(this._items,b,d)};a.prototype.flatten=
function(b,d){var c=[];r(c,this,b,d);return new f(c)};a.prototype.forEach=function(b,d){return this._items.forEach(b,d)};a.prototype.getItemAt=function(b){return this._items[b]};a.prototype.getNextIndex=function(b){var d=this.length;b=null==b?d:b;0>b?b=0:b>d&&(b=d);return b};a.prototype.includes=function(b,d){void 0===d&&(d=0);return arguments.length?-1!==this._items.indexOf(b,d):!1};a.prototype.indexOf=function(b,d){void 0===d&&(d=0);return this._items.indexOf(b,d)};a.prototype.join=function(b){void 0===
b&&(b=",");return this._items.join(b)};a.prototype.lastIndexOf=function(b,d){void 0===d&&(d=this.length-1);return this._items.lastIndexOf(b,d)};a.prototype.map=function(b,d){b=this._items.map(b,d);return new f({items:b})};a.prototype.reorder=function(b,d){void 0===d&&(d=this.length-1);var c=this.indexOf(b);if(-1!==c){0>d?d=0:d>=this.length&&(d=this.length-1);if(c!==d){if(this._emitBeforeChanges(4))return b;this._splice(c,1);this._splice(d,0,b);this._emitAfterChanges(4)}return b}};a.prototype.pop=
function(){if(this.length&&!this._emitBeforeChanges(2)){var b=p(this._splice(this.length-1,1));this._emitAfterChanges(2);return b}};a.prototype.push=function(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];if(this._emitBeforeChanges(1))return this.length;this._splice.apply(this,e.__spreadArrays([this.length,0],b));this._emitAfterChanges(1);return this.length};a.prototype.reduce=function(b,d){var c=this._items;return 2===arguments.length?c.reduce(b,d):c.reduce(b)};a.prototype.reduceRight=
function(b,d){var c=this._items;return 2===arguments.length?c.reduceRight(b,d):c.reduceRight(b)};a.prototype.remove=function(b){return this.removeAt(this.indexOf(b))};a.prototype.removeAt=function(b){if(!(0>b||b>=this.length||this._emitBeforeChanges(2)))return b=p(this._splice(b,1)),this._emitAfterChanges(2),b};a.prototype.removeMany=function(b){if(!b||!b.length||this._emitBeforeChanges(2))return[];b=b instanceof f?b.toArray():b;for(var d=this._items,c=[],a=b.length,h=0;h<a;h++){var g=d.indexOf(b[h]);
if(-1<g){for(var e=h+1,n=g+1,q=Math.min(b.length-e,d.length-n),p=0;p<q&&b[e+p]===d[n+p];)p++;e=1+p;(g=this._splice(g,e))&&0<g.length&&c.push.apply(c,g);h+=e-1}}this._emitAfterChanges(2);return c};a.prototype.reverse=function(){if(this._emitBeforeChanges(4))return this;var b=this._splice(0,this.length);b&&(b.reverse(),this._splice.apply(this,e.__spreadArrays([0,0],b)));this._emitAfterChanges(4);return this};a.prototype.shift=function(){if(this.length&&!this._emitBeforeChanges(2)){var b=p(this._splice(0,
1));this._emitAfterChanges(2);return b}};a.prototype.slice=function(b,d){void 0===b&&(b=0);void 0===d&&(d=this.length);return this._createNewInstance({items:this._items.slice(b,d)})};a.prototype.some=function(b,d){return this._items.some(b,d)};a.prototype.sort=function(b){if(!this.length||this._emitBeforeChanges(4))return this;var d=this._splice(0,this.length);arguments.length?d.sort(b):d.sort();this._splice.apply(this,e.__spreadArrays([0,0],d));this._emitAfterChanges(4);return this};a.prototype.splice=
function(b,d){for(var c=[],a=2;a<arguments.length;a++)c[a-2]=arguments[a];a=(d?2:0)|(c.length?1:0);if(this._emitBeforeChanges(a))return[];c=this._splice.apply(this,e.__spreadArrays([b,d],c))||[];this._emitAfterChanges(a);return c};a.prototype.toArray=function(){return this._items.slice()};a.prototype.toJSON=function(){return this.toArray()};a.prototype.toLocaleString=function(){return this._items.toLocaleString()};a.prototype.toString=function(){return this._items.toString()};a.prototype.unshift=
function(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];if(!b.length||this._emitBeforeChanges(1))return this.length;this._splice.apply(this,e.__spreadArrays([0,0],b));this._emitAfterChanges(1);return this.length};a.prototype._createNewInstance=function(b){return new this.constructor(b)};a.prototype._splice=function(b,d){for(var c=this,a=[],g=2;g<arguments.length;g++)a[g-2]=arguments[g];var g=this._items,n=this.constructor.prototype.itemType,p,r;!this._notifications&&this.hasEventListener("change")&&
(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=h.schedule(function(){return c._dispatchChange()}));if(d){r=g.splice(b,d);if(this.hasEventListener("before-remove")){var f=q.acquire();f.target=this;f.cancellable=!0;for(var x=0,u=r.length;x<u;x++)p=r[x],f.reset(p),this.emit("before-remove",f),f.defaultPrevented&&(r.splice(x,1),g.splice(b,0,p),b+=1,--x,--u);q.release(f)}this.length=this._items.length;if(this.hasEventListener("after-remove")){p=
q.acquire();p.target=this;p.cancellable=!1;u=r.length;for(x=0;x<u;x++)p.reset(r[x]),this.emit("after-remove",p);q.release(p)}}if(a&&a.length){if(n){x=[];for(u=0;u<a.length;u++)p=a[u],f=n.ensureType(p),null==f&&null!=p||x.push(f);a=x}n=this.hasEventListener("before-add");x=this.hasEventListener("after-add");u=b===this.length;if(n||x){p=q.acquire();p.target=this;p.cancellable=!0;f=q.acquire();f.target=this;f.cancellable=!1;for(var l=0,k=a;l<k.length;l++){var v=k[l];n?(p.reset(v),this.emit("before-add",
p),p.defaultPrevented||(u?g.push(v):g.splice(b++,0,v),this._set("length",g.length),x&&(f.reset(v),this.emit("after-add",f)))):(u?g.push(v):g.splice(b++,0,v),this._set("length",g.length),f.reset(v),this.emit("after-add",f))}q.release(f);q.release(p)}else{if(u)for(n=0,x=a;n<x.length;n++)g.push(x[n]);else g.splice.apply(g,e.__spreadArrays([b,0],a));this._set("length",g.length)}}(a&&a.length||r&&r.length)&&this._notifyChangeEvent(a,r);return r};a.prototype._emitBeforeChanges=function(b){var d=!1;if(this.hasEventListener("before-changes")){var c=
q.acquire();c.target=this;c.cancellable=!0;c.type=b;this.emit("before-changes",c);d=c.defaultPrevented;q.release(c)}return d};a.prototype._emitAfterChanges=function(b){if(this.hasEventListener("after-changes")){var d=q.acquire();d.target=this;d.cancellable=!1;d.type=b;this.emit("after-changes",d);q.release(d)}};a.prototype._notifyChangeEvent=function(b,d){this.hasEventListener("change")&&this._notifications[this._notifications.length-1].changes.push({added:b,removed:d})};a.prototype._dispatchChange=
function(){this._timer&&(this._timer.remove(),this._timer=null);if(this._notifications){var b=this._notifications;this._notifications=null;for(var d=function(b){var d=b.changes;u.clear();v.clear();y.clear();for(var a=0;a<d.length;a++){var h=d[a],g=h.added,h=h.removed;if(g)if(0===y.size&&0===v.size)for(var e=0,n=g;e<n.length;e++)g=n[e],u.add(g);else for(e=0,n=g;e<n.length;e++)g=n[e],v.has(g)?(y.add(g),v.delete(g)):y.has(g)||u.add(g);if(h)if(0===y.size&&0===u.size)for(e=0;e<h.length;e++)g=h[e],v.add(g);
else for(e=0;e<h.length;e++)g=h[e],u.has(g)?u.delete(g):(y.delete(g),v.add(g))}var q=m.acquire();u.forEach(function(b){q.push(b)});var p=m.acquire();v.forEach(function(b){p.push(b)});var r=c._items,f=b.items,x=m.acquire();y.forEach(function(b){f.indexOf(b)!==r.indexOf(b)&&x.push(b)});if(b.listeners&&(q.length||p.length||x.length))for(d={target:c,added:q,removed:p,moved:x},a=b.listeners.length,g=0;g<a;g++)h=b.listeners[g],h.removed||h.callback.call(c,d);m.release(q);m.release(p);m.release(x)},c=this,
a=0;a<b.length;a++)d(b[a]);u.clear();v.clear();y.clear()}};var f;a.ofType=function(c){if(!c)return f;if(z.has(c))return z.get(c);var a;if("function"===typeof c)a=c.prototype.declaredClass;else if(c.base)a=c.base.prototype.declaredClass;else for(var h in c.typeMap){var g=c.typeMap[h].prototype.declaredClass;a=a?a+(" | "+g):g}h=function(d){function c(){return null!==d&&d.apply(this,arguments)||this}e.__extends(c,d);return c=e.__decorate([b.subclass("esri.core.Collection\x3c"+a+"\x3e")],c)}(f);g={Type:c,
ensureType:"function"===typeof c?d.ensureType(c):d.ensureOneOfType(c)};Object.defineProperty(h.prototype,"itemType",{value:g});z.set(c,h);return h};e.__decorate([b.property()],a.prototype,"length",void 0);e.__decorate([b.property()],a.prototype,"items",null);return a=f=e.__decorate([b.subclass("esri.core.Collection")],a)}(l.EventedAccessor);return B})},"esri/core/Evented":function(){define("require exports tslib ./Accessor ./handleUtils ./accessorSupport/decorators".split(" "),function(f,a,e,m,k,
l){var g=function(){function c(){this._emitter=new c.EventEmitter}c.prototype.emit=function(c,b){return this._emitter.emit(c,b)};c.prototype.on=function(c,b){return this._emitter.on(c,b)};c.prototype.once=function(c,b){return this._emitter.once(c,b)};c.prototype.hasEventListener=function(c){return this._emitter.hasEventListener(c)};return c}();(function(c){var a=function(){function b(){}b.prototype.clear=function(){this._listenersMap&&this._listenersMap.clear()};b.prototype.emit=function(b,d){b=this._listenersMap&&
this._listenersMap.get(b);if(!b)return!1;e.__spreadArrays(b).forEach(function(b){b.call(null,d)});return 0<b.length};b.prototype.on=function(b,d){var c=this;if(Array.isArray(b)){var a=b.map(function(b){return c.on(b,d)});return k.handlesGroup(a)}if(-1<b.indexOf(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);a=this._listenersMap.get(b)||[];a.push(d);this._listenersMap.set(b,a);return{remove:function(){var a=
c._listenersMap&&c._listenersMap.get(b)||[];0<=a.indexOf(d)&&a.splice(a.indexOf(d),1)}}};b.prototype.once=function(b,d){var c;return c=this.on(b,function(b){c.remove();d.call(null,b)})};b.prototype.hasEventListener=function(b){b=this._listenersMap&&this._listenersMap.get(b);return null!=b&&0<b.length};return b}();c.EventEmitter=a;c.EventedMixin=function(b){return function(b){function d(){var d=null!==b&&b.apply(this,arguments)||this;d._emitter=new a;return d}e.__extends(d,b);d.prototype.emit=function(b,
d){return this._emitter.emit(b,d)};d.prototype.on=function(b,d){return this._emitter.on(b,d)};d.prototype.once=function(b,d){return this._emitter.once(b,d)};d.prototype.hasEventListener=function(b){return this._emitter.hasEventListener(b)};return d=e.__decorate([l.subclass("esri.core.Evented")],d)}(b)};var b=function(b){function d(){var d=null!==b&&b.apply(this,arguments)||this;d._emitter=new g.EventEmitter;return d}e.__extends(d,b);d.prototype.emit=function(b,d){return this._emitter.emit(b,d)};d.prototype.on=
function(b,d){return this._emitter.on(b,d)};d.prototype.once=function(b,d){return this._emitter.once(b,d)};d.prototype.hasEventListener=function(b){return this._emitter.hasEventListener(b)};return d=e.__decorate([l.subclass("esri.core.Evented")],d)}(m);c.EventedAccessor=b})(g||(g={}));return g})},"esri/views/2d/layers/features/controllers":function(){define(["require","exports","../../../../core/Error","../../../../core/promiseUtils","@dojo/framework/shim/Promise"],function(f,a,e,m){Object.defineProperty(a,
"__esModule",{value:!0});a.loadControllerModule=function(a){switch(a){case "on-demand":return new Promise(function(a,g){f(["./controllers/OnDemandController"],a,g)});case "stream":return new Promise(function(a,g){f(["./controllers/StreamController"],a,g)});default:return m.reject(new e("mapview-controller:bad-type","Unable to create controller for unknown type: "+a))}}})},"esri/views/2d/layers/features/processors":function(){define(["require","exports","@dojo/framework/shim/Promise"],function(f,a){Object.defineProperty(a,
"__esModule",{value:!0});a.loadProcessorModule=function(a){return"heatmap"===a?new Promise(function(a,e){f(["./processors/HeatmapProcessor"],a,e)}):new Promise(function(a,e){f(["./processors/SymbolProcessor"],a,e)})}})},"esri/views/2d/layers/features/support/TileStore":function(){define("require exports tslib ../../../../../core/Evented ../../../../../core/has ../../../../../core/libs/rbush/rbush ./Tile ../../../tiling/TileCoverage ../../../tiling/TileKey".split(" "),function(f,a,e,m,k,l,g,c,h){Object.defineProperty(a,
"__esModule",{value:!0});var b={added:[],removed:[]},d=new Set,n=new h(0,0,0,0);f=function(a){function h(b){var d=a.call(this)||this;d._tiles=new Map;d._index=l(9,k("csp-restrictions")?function(b){return{minX:b.bounds[0],minY:b.bounds[1],maxX:b.bounds[2],maxY:b.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]);d.tiles=[];d.tileScheme=b;return d}e.__extends(h,a);h.prototype.destroy=function(){this._tiles.clear()};h.prototype.clear=function(){this._tiles.clear();this._index.clear()};
h.prototype.has=function(b){return this._tiles.has(b)};h.prototype.get=function(b){return this._tiles.get(b)};h.prototype.findByKey=function(b){return this._tiles.get(b.id)};h.prototype.intersections=function(b,d){var c="string"===typeof b?this.get(b):b;if(!c)return[];var a=d*c.resolution;d=c.bounds[0]-a;b=c.bounds[1]-a;for(var h=c.bounds[2]+a,c=c.bounds[3]+a,a=[],g=0,e=this._index.search({minX:d,minY:b,maxX:h,maxY:c});g<e.length;g++){var n=e[g],q=n.bounds.slice();q[0]=Math.max(q[0],d);q[1]=Math.max(q[1],
b);q[2]=Math.min(q[2],h);q[3]=Math.min(q[3],c);0<q[2]-q[0]&&0<q[3]-q[1]&&a.push({bounds:q,tile:n})}return a};h.prototype.boundsIntersections=function(b){return this._index.search({minX:b[0],minY:b[1],maxX:b[2],maxY:b[3]})};h.prototype.setViewState=function(a){if(a=this.tileScheme.getTileCoverage(a,0)){var h=a.spans,e=a.lodInfo,q=e.level;if(0<h.length)for(var p=0;p<h.length;p++)for(var r=h[p],f=r.row,l=r.colTo,k=r.colFrom;k<=l;k++){var m=n.set(q,f,e.normalizeCol(k),e.getWorldForColumn(k)).id;d.add(m);
this.has(m)||(r=new g.default(this.tileScheme,m),this._tiles.set(m,r),this._index.insert(r),this.tiles.push(r),b.added.push(r))}for(h=this.tiles.length-1;0<=h;h--)r=this.tiles[h],d.has(r.id)||(this._tiles.delete(r.id),this.tiles.splice(h,1),this._index.remove(r),b.removed.push(r));(b.added.length||b.removed.length)&&this.emit("update",b);c.pool.release(a);d.clear();b.added.length=0;b.removed.length=0}};return h}(m);a.default=f})},"esri/core/libs/rbush/rbush":function(){define(["../quickselect/quickselect"],
function(f){function a(b,d){if(!(this instanceof a))return new a(b,d);this._maxEntries=Math.max(4,b||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));d&&("function"===typeof d?this.toBBox=d:this._initFormat(d));this.clear()}function e(b,d){m(b,0,b.children.length,d,b)}function m(b,d,c,a,h){h||(h=n(null));h.minX=Infinity;h.minY=Infinity;h.maxX=-Infinity;h.maxY=-Infinity;for(var g;d<c;d++)g=b.children[d],k(h,b.leaf?a(g):g);return h}function k(b,d){b.minX=Math.min(b.minX,d.minX);b.minY=
Math.min(b.minY,d.minY);b.maxX=Math.max(b.maxX,d.maxX);b.maxY=Math.max(b.maxY,d.maxY);return b}function l(b,d){return b.minX-d.minX}function g(b,d){return b.minY-d.minY}function c(b){return(b.maxX-b.minX)*(b.maxY-b.minY)}function h(b){return b.maxX-b.minX+(b.maxY-b.minY)}function b(b,d){return b.minX<=d.minX&&b.minY<=d.minY&&d.maxX<=b.maxX&&d.maxY<=b.maxY}function d(b,d){return d.minX<=b.maxX&&d.minY<=b.maxY&&d.maxX>=b.minX&&d.maxY>=b.minY}function n(b){return{children:b,height:1,leaf:!0,minX:Infinity,
minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function p(b,d,c,a,h){for(var g=[d,c],e;g.length;)c=g.pop(),d=g.pop(),c-d<=a||(e=d+Math.ceil((c-d)/a/2)*a,f(b,e,d,c,h),g.push(d,e,e,c))}a.prototype={all:function(){return this._all(this.data,[])},search:function(c){var a=this.data,h=[],g=this.toBBox;if(!d(c,a))return h;for(var e=[],n,p,r,f;a;){n=0;for(p=a.children.length;n<p;n++)r=a.children[n],f=a.leaf?g(r):r,d(c,f)&&(a.leaf?h.push(r):b(c,f)?this._all(r,h):e.push(r));a=e.pop()}return h},collides:function(c){var a=
this.data,h=this.toBBox;if(!d(c,a))return!1;for(var g=[],e,n,p,r;a;){e=0;for(n=a.children.length;e<n;e++)if(p=a.children[e],r=a.leaf?h(p):p,d(c,r)){if(a.leaf||b(c,r))return!0;g.push(p)}a=g.pop()}return!1},load:function(b){if(!b||!b.length)return this;if(b.length<this._minEntries){for(var d=0,c=b.length;d<c;d++)this.insert(b[d]);return this}b=this._build(b.slice(),0,b.length-1,0);this.data.children.length?this.data.height===b.height?this._splitRoot(this.data,b):(this.data.height<b.height&&(d=this.data,
this.data=b,b=d),this._insert(b,this.data.height-b.height-1,!0)):this.data=b;return this},insert:function(b){b&&this._insert(b,this.data.height-1);return this},clear:function(){this.data=n([]);return this},remove:function(d,c){if(!d)return this;for(var a=this.data,h=this.toBBox(d),g=[],e=[],n,q,p,r;a||g.length;){a||(a=g.pop(),q=g[g.length-1],n=e.pop(),r=!0);if(a.leaf){a:{p=d;var f=a.children,l=c;if(l){for(var k=0;k<f.length;k++)if(l(p,f[k])){p=k;break a}p=-1}else p=f.indexOf(p)}if(-1!==p){a.children.splice(p,
1);g.push(a);this._condense(g);break}}r||a.leaf||!b(a,h)?q?(n++,a=q.children[n],r=!1):a=null:(g.push(a),e.push(n),n=0,q=a,a=a.children[0])}return this},toBBox:function(b){return b},compareMinX:l,compareMinY:g,toJSON:function(){return this.data},fromJSON:function(b){this.data=b;return this},_all:function(b,d){for(var c=[];b;)b.leaf?d.push.apply(d,b.children):c.push.apply(c,b.children),b=c.pop();return d},_build:function(b,d,c,a){var h=c-d+1,g=this._maxEntries,q;if(h<=g)return q=n(b.slice(d,c+1)),e(q,
this.toBBox),q;a||(a=Math.ceil(Math.log(h)/Math.log(g)),g=Math.ceil(h/Math.pow(g,a-1)));q=n([]);q.leaf=!1;q.height=a;var h=Math.ceil(h/g),g=h*Math.ceil(Math.sqrt(g)),r,f,x;for(p(b,d,c,g,this.compareMinX);d<=c;d+=g)for(f=Math.min(d+g-1,c),p(b,d,f,h,this.compareMinY),r=d;r<=f;r+=h)x=Math.min(r+h-1,f),q.children.push(this._build(b,r,x,a-1));e(q,this.toBBox);return q},_chooseSubtree:function(b,d,a,h){for(var g,e,n,q,p,r,f,x;;){h.push(d);if(d.leaf||h.length-1===a)break;f=x=Infinity;g=0;for(e=d.children.length;g<
e;g++)n=d.children[g],p=c(n),r=(Math.max(n.maxX,b.maxX)-Math.min(n.minX,b.minX))*(Math.max(n.maxY,b.maxY)-Math.min(n.minY,b.minY))-p,r<x?(x=r,f=p<f?p:f,q=n):r===x&&p<f&&(f=p,q=n);d=q||d.children[0]}return d},_insert:function(b,d,c){var a=this.toBBox;c=c?b:a(b);var a=[],h=this._chooseSubtree(c,this.data,d,a);h.children.push(b);for(k(h,c);0<=d;)if(a[d].children.length>this._maxEntries)this._split(a,d),d--;else break;this._adjustParentBBoxes(c,a,d)},_split:function(b,d){var c=b[d],a=c.children.length,
h=this._minEntries;this._chooseSplitAxis(c,h,a);a=this._chooseSplitIndex(c,h,a);a=n(c.children.splice(a,c.children.length-a));a.height=c.height;a.leaf=c.leaf;e(c,this.toBBox);e(a,this.toBBox);d?b[d-1].children.push(a):this._splitRoot(c,a)},_splitRoot:function(b,d){this.data=n([b,d]);this.data.height=b.height+1;this.data.leaf=!1;e(this.data,this.toBBox)},_chooseSplitIndex:function(b,d,a){var h,g,e,n,p,q,r;p=q=Infinity;for(h=d;h<=a-d;h++)g=m(b,0,h,this.toBBox),e=m(b,h,a,this.toBBox),n=Math.max(0,Math.min(g.maxX,
e.maxX)-Math.max(g.minX,e.minX))*Math.max(0,Math.min(g.maxY,e.maxY)-Math.max(g.minY,e.minY)),g=c(g)+c(e),n<p?(p=n,r=h,q=g<q?g:q):n===p&&g<q&&(q=g,r=h);return r},_chooseSplitAxis:function(b,d,c){var a=b.leaf?this.compareMinX:l,h=b.leaf?this.compareMinY:g,e=this._allDistMargin(b,d,c,a);d=this._allDistMargin(b,d,c,h);e<d&&b.children.sort(a)},_allDistMargin:function(b,d,c,a){b.children.sort(a);a=this.toBBox;var g=m(b,0,d,a),e=m(b,c-d,c,a),n=h(g)+h(e),p,q;for(p=d;p<c-d;p++)q=b.children[p],k(g,b.leaf?a(q):
q),n+=h(g);for(p=c-d-1;p>=d;p--)q=b.children[p],k(e,b.leaf?a(q):q),n+=h(e);return n},_adjustParentBBoxes:function(b,d,c){for(;0<=c;c--)k(d[c],b)},_condense:function(b){for(var d=b.length-1,c;0<=d;d--)0===b[d].children.length?0<d?(c=b[d-1].children,c.splice(c.indexOf(b[d]),1)):this.clear():e(b[d],this.toBBox)},_initFormat:function(b){var d=["return a"," - b",";"];this.compareMinX=new Function("a","b",d.join(b[0]));this.compareMinY=new Function("a","b",d.join(b[1]));this.toBBox=new Function("a","return {minX: a"+
b[0]+", minY: a"+b[1]+", maxX: a"+b[2]+", maxY: a"+b[3]+"};")}};return a})},"esri/core/libs/quickselect/quickselect":function(){define([],function(){function f(e,k,l,g,c){for(;g>l;){if(600<g-l){var h=g-l+1,b=k-l+1,d=Math.log(h),n=.5*Math.exp(2*d/3),d=.5*Math.sqrt(d*n*(h-n)/h)*(0>b-h/2?-1:1);f(e,k,Math.max(l,Math.floor(k-b*n/h+d)),Math.min(g,Math.floor(k+(h-b)*n/h+d)),c)}h=e[k];b=l;n=g;a(e,l,k);for(0<c(e[g],h)&&a(e,l,g);b<n;){a(e,b,n);b++;for(n--;0>c(e[b],h);)b++;for(;0<c(e[n],h);)n--}0===c(e[l],h)?
a(e,l,n):(n++,a(e,n,g));n<=k&&(l=n+1);k<=n&&(g=n-1)}}function a(a,e,f){var g=a[e];a[e]=a[f];a[f]=g}function e(a,e){return a<e?-1:a>e?1:0}return function(a,k,l,g,c){f(a,k,l||0,g||a.length-1,c||e)}})},"esri/views/2d/layers/features/support/Tile":function(){define("require exports ../../../../../core/ArrayPool ../../../../../geometry/Extent ../../../../../geometry/support/aaBoundingRect ../../../../../tasks/support/QuantizationParameters ../../../tiling/TileKey".split(" "),function(f,a,e,m,k,l,g){function c(c,
b){var d=c.bounds,a=b.bounds;return c.key.id!==b.key.id&&c.key.world===b.key.world&&d[0]<=a[0]&&d[1]<=a[1]&&d[2]>=a[2]&&d[3]>=a[3]}Object.defineProperty(a,"__esModule",{value:!0});a.isParentOf=c;a.isChildOf=function(a,b){return c(b,a)};f=function(){function c(b,d){this.bounds=k.create();this.key=new g(0,0,0,0);this.objectIds=new Set;this.key.set(d);d=b.getLODInfoAt(this.key);this.tileInfoView=b;this.tileInfoView.getTileBounds(this.bounds,this.key,!0);this.resolution=d.resolution;this.scale=d.scale;
this.level=d.level;this.needsClear=!0}Object.defineProperty(c.prototype,"id",{get:function(){return this.key.id},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"extent",{get:function(){return m.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"transform",{get:function(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}},enumerable:!0,
configurable:!0});c.prototype.clone=function(){return new c(this.tileInfoView,this.id)};c.prototype.createChildTiles=function(){for(var b=this.key.getChildKeys(),d=e.acquire(),a=0;a<b.length;a++)d[a]=new c(this.tileInfoView,b[a]);return d};c.prototype.getQuantizationParameters=function(){return l.default.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})};
return c}();a.Tile=f;a.default=f})},"esri/tasks/support/QuantizationParameters":function(){define("require exports tslib ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators".split(" "),function(f,a,e,m,k,l,g,c){Object.defineProperty(a,"__esModule",{value:!0});var h=new k.default({upperLeft:"upper-left",lowerLeft:"lower-left"});f=function(b){function d(d){d=b.call(this,d)||this;d.extent=null;d.mode="view";d.originPosition="upper-left";d.tolerance=
1;return d}e.__extends(d,b);a=d;d.prototype.clone=function(){return new a(g.clone({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))};var a;e.__decorate([c.property({type:m.Extent,json:{write:!0}})],d.prototype,"extent",void 0);e.__decorate([c.property({type:["view","edit"],json:{write:!0}})],d.prototype,"mode",void 0);e.__decorate([c.property({type:String,json:{read:h.read,write:h.write}})],d.prototype,"originPosition",void 0);e.__decorate([c.property({type:Number,
json:{write:!0}})],d.prototype,"tolerance",void 0);return d=a=e.__decorate([c.subclass("esri.tasks.support.QuantizationParameters")],d)}(l.JSONSupport);a.default=f})},"esri/views/2d/tiling/TileKey":function(){define(["require","exports","../../../core/ObjectPool"],function(f,a,e){return function(){function a(a,e,g,c){this.set(a,e,g,c)}a.getId=function(a,e,g,c){return"object"===typeof a?a.level+"/"+a.row+"/"+a.col+"/"+a.world:a+"/"+e+"/"+g+"/"+c};Object.defineProperty(a.prototype,"key",{get:function(){return this},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"id",{get:function(){return this.toString()},enumerable:!0,configurable:!0});a.prototype.acquire=function(a,e,g,c){this.set(a,e,g,c)};a.prototype.equals=function(a){return this.level===a.level&&this.row===a.row&&this.col===a.col&&this.world===a.world};a.prototype.release=function(){this.world=this.col=this.row=this.level=0};a.prototype.set=function(a,e,g,c){null==a?this.world=this.col=this.row=this.level=0:"object"===typeof a?(this.level=
a.level||0,this.row=a.row||0,this.col=a.col||0,this.world=a.world||0):"string"===typeof a?(a=a.split("/"),e=a[1],g=a[2],c=a[3],this.level=parseFloat(a[0]),this.row=parseFloat(e),this.col=parseFloat(g),this.world=parseFloat(c)):(this.level=+a,this.row=+e,this.col=+g,this.world=+c||0);return this};a.prototype.toString=function(){return this.level+"/"+this.row+"/"+this.col+"/"+this.world};a.prototype.getChildKeys=function(){var e=this.level+1,f=this.row<<1,g=this.col<<1,c=this.world;return[new a(e,f,
g,c),new a(e,f,g+1,c),new a(e,f+1,g,c),new a(e,f+1,g+1,c)]};a.prototype.compareRowMajor=function(a){return this.row<a.row?-1:this.row>a.row?1:this.col<a.col?-1:this.col>a.col?1:0};a.pool=new e(a,null,null,25,50);return a}()})},"esri/views/2d/tiling/TileCoverage":function(){define(["require","exports","../../../core/ObjectPool"],function(f,a,e){return function(){function a(){this.spans=[]}a.prototype.acquire=function(a){this.lodInfo=a};a.prototype.release=function(){this.lodInfo=null;this.spans.length=
0};a.prototype.forEach=function(a,e){var g=this.spans,c=this.lodInfo,h=c.level;if(0!==g.length)for(var b=0;b<g.length;b++)for(var d=g[b],n=d.row,p=d.colTo,d=d.colFrom;d<=p;d++)a.call(e,h,n,c.normalizeCol(d),c.getWorldForColumn(d))};a.pool=new e(a);return a}()})},"esri/views/2d/tiling/TileInfoView":function(){define("require exports ../../../geometry/support/spatialReferenceUtils ./LODInfo ./TileCoverage ./TileKey ./TileSpan".split(" "),function(f,a,e,m,k,l,g){var c=new l("0/0/0/0"),h=function(){function b(b,
d,a,c,h,g,e,f){this.x=b;this.ymin=d;this.ymax=a;this.invM=c;this.leftAdjust=h;this.rightAdjust=g;this.leftBound=e;this.rightBound=f}b.create=function(d,a){var c;d[1]>a[1]&&(c=[a,d],d=c[0],a=c[1]);c=d[0];d=d[1];var h=a[0];a=a[1];var g=h-c,e=a-d,e=0!==e?g/e:0,n=(Math.ceil(d)-d)*e,p=(Math.floor(d)-d)*e;return new b(c,Math.floor(d),Math.ceil(a),e,0>g?n:p,0>g?p:n,0>g?h:c,0>g?c:h)};b.prototype.incrRow=function(){this.x+=this.invM};b.prototype.getLeftCol=function(){return Math.max(this.x+this.leftAdjust,
this.leftBound)};b.prototype.getRightCol=function(){return Math.min(this.x+this.rightAdjust,this.rightBound)};return b}(),b=[[0,0],[0,0],[0,0],[0,0]];return function(){function d(b,d){var a=this;this.tileInfo=b;this.fullExtent=d;this.scales=[];this._lodInfos=null;this._infoByScale={};this._infoByLevel={};var c=b.lods.slice();c.sort(function(b,d){return d.scale-b.scale});var h=this._lodInfos=c.map(function(a){return m.create(b,a,d)});c.forEach(function(b,d){a._infoByLevel[b.level]=h[d];a._infoByScale[b.scale]=
h[d];a.scales[d]=b.scale},this);this._wrap=b.isWrappable}Object.defineProperty(d.prototype,"spatialReference",{get:function(){return this.tileInfo.spatialReference},enumerable:!0,configurable:!0});d.prototype.getLODInfoAt=function(b){return this._infoByLevel["number"===typeof b?b:b.level]};d.prototype.getTileBounds=function(b,d,a){void 0===a&&(a=!1);c.set(d);return(d=this._infoByLevel[c.level])?d.getTileBounds(b,c,a):b};d.prototype.getTileCoords=function(b,d,a){void 0===a&&(a=!1);c.set(d);return(d=
this._infoByLevel[c.level])?d.getTileCoords(b,c,a):b};d.prototype.getTileCoverage=function(d,a,c){void 0===a&&(a=192);void 0===c&&(c="closest");c="closest"===c?this.getClosestInfoForScale(d.scale):this.getSmallestInfoForScale(d.scale);var e=k.pool.acquire(c),n=this._wrap,p;p=Infinity;var f=-Infinity,r,l,m=e.spans;b[0][0]=b[0][1]=b[1][1]=b[3][0]=-a;b[1][0]=b[2][0]=d.size[0]+a;b[2][1]=b[3][1]=d.size[1]+a;for(a=0;a<b.length;a++){var B=b[a];d.toMap(B,B);B[0]=c.getColumnForX(B[0]);B[1]=c.getRowForY(B[1])}d=
[];B=3;for(a=0;4>a;a++){if(b[a][1]!==b[B][1]){var D=h.create(b[a],b[B]);p=Math.min(D.ymin,p);f=Math.max(D.ymax,f);void 0===d[D.ymin]&&(d[D.ymin]=[]);d[D.ymin].push(D)}B=a}if(null==p||null==f||100<f-p)return null;for(B=[];p<f;){null!=d[p]&&(B=B.concat(d[p]));r=Infinity;l=-Infinity;for(a=B.length-1;0<=a;a--)D=B[a],r=Math.min(r,D.getLeftCol()),l=Math.max(l,D.getRightCol());r=Math.floor(r);l=Math.floor(l);if(p>=c.first[1]&&p<=c.last[1])if(n)if(c.size[0]<c.worldSize[0])for(D=Math.floor(l/c.worldSize[0]),
a=Math.floor(r/c.worldSize[0]);a<=D;a++)m.push(new g(p,Math.max(c.getFirstColumnForWorld(a),r),Math.min(c.getLastColumnForWorld(a),l)));else m.push(new g(p,r,l));else r>c.last[0]||l<c.first[0]||(r=Math.max(r,c.first[0]),l=Math.min(l,c.last[0]),m.push(new g(p,r,l)));p+=1;for(a=B.length-1;0<=a;a--)D=B[a],D.ymax>=p?D.incrRow():B.splice(a,1)}return e};d.prototype.getTileParentId=function(b){c.set(b);b=this._lodInfos.indexOf(this._infoByLevel[c.level])-1;if(0>b)return null;this._getTileIdAtLOD(c,this._lodInfos[b],
c);return c.id};d.prototype.getTileResolution=function(b){return(b=this._infoByLevel["object"===typeof b?b.level:b])?b.resolution:-1};d.prototype.getTileScale=function(b){return(b=this._infoByLevel[b.level])?b.scale:-1};d.prototype.intersects=function(b,d){c.set(d);d=this._infoByLevel[c.level];var a=b.lodInfo;if(a.resolution>d.resolution){this._getTileIdAtLOD(c,a,c);for(var h=a.denormalizeCol(c.col,c.world),g=0,e=b.spans;g<e.length;g++){var n=e[g];if(n.row===c.row&&n.colFrom<=h&&n.colTo>=h)return!0}}if(a.resolution<
d.resolution){e=b.spans.reduce(function(b,d){b[0]=Math.min(b[0],d.row);b[1]=Math.max(b[1],d.row);b[2]=Math.min(b[2],d.colFrom);b[3]=Math.max(b[3],d.colTo);return b},[Infinity,-Infinity,Infinity,-Infinity]);b=e[0];var h=e[1],g=e[2],e=e[3],p=d.denormalizeCol(c.col,c.world),n=a.getColumnForX(d.getXForColumn(p)),f=a.getRowForY(d.getYForRow(c.row)),p=a.getColumnForX(d.getXForColumn(p+1))-1;d=a.getRowForY(d.getYForRow(c.row+1))-1;return!(n>e||p<g||f>h||d<b)}var l=a.denormalizeCol(c.col,c.world);return b.spans.some(function(b){return b.row===
c.row&&b.colFrom<=l&&b.colTo>=l})};d.prototype.normalizeBounds=function(b,d,a){b[0]=d[0];b[1]=d[1];b[2]=d[2];b[3]=d[3];this._wrap&&(d=e.getInfo(this.tileInfo.spatialReference),a=-a*(d.valid[1]-d.valid[0]),b[0]+=a,b[2]+=a);return b};d.prototype.getSmallestInfoForScale=function(b){var d=this.scales;if(this._infoByScale[b])return this._infoByScale[b];if(b>d[0])return this._infoByScale[d[0]];for(var a=1;a<d.length-1;a++)if(b>d[a]+1E-6)return this._infoByScale[d[a-1]];return this._infoByScale[d[d.length-
1]]};d.prototype.getClosestInfoForScale=function(b){var d=this.scales;if(this._infoByScale[b])return this._infoByScale[b];b=d.reduce(function(d,a){return Math.abs(a-b)<Math.abs(d-b)?a:d},d[0]);return this._infoByScale[b]};d.prototype.scaleToLevel=function(b){var d=this.scales;if(this._infoByScale[b])return this._infoByScale[b].level;for(var a=d.length-1;0<=a;a--)if(b<d[a])return a===d.length-1?this._infoByScale[d[d.length-1]].level:this._infoByScale[d[a]].level+(d[a]-b)/(d[a]-d[a+1]);return this._infoByScale[d[0]].level};
d.prototype.scaleToZoom=function(b){return this.tileInfo.scaleToZoom(b)};d.prototype._getTileIdAtLOD=function(b,d,a){var c=this._infoByLevel[a.level];b.set(a);if(d.resolution<c.resolution)return null;if(d.resolution===c.resolution)return b;b.level=d.level;b.col=Math.floor(a.col*c.resolution/d.resolution+.01);b.row=Math.floor(a.row*c.resolution/d.resolution+.01);return b};return d}()})},"esri/views/2d/tiling/LODInfo":function(){define(["require","exports","../../../geometry/support/spatialReferenceUtils",
"./TileKey"],function(f,a,e,m){function k(a,c,h){a[0]=c;a[1]=h;return a}var l=new m("0/0/0/0");return function(){function a(a,h,b,d,g,e,f,q,x,l,k,y){this.level=a;this.resolution=h;this.scale=b;this.origin=d;this.first=g;this.last=e;this.size=f;this.norm=q;this.worldStart=x;this.worldEnd=l;this.worldSize=k;this.wrap=y}a.create=function(c,h,b){var d=e.getInfo(c.spatialReference),g=[c.origin.x,c.origin.y],p=[c.size[0]*h.resolution,c.size[1]*h.resolution],f=[-Infinity,-Infinity],q=[Infinity,Infinity],
x=[Infinity,Infinity];b&&(k(f,Math.max(0,Math.floor((b.xmin-g[0])/p[0])),Math.max(0,Math.floor((g[1]-b.ymax)/p[1]))),k(q,Math.max(0,Math.floor((b.xmax-g[0])/p[0])),Math.max(0,Math.floor((g[1]-b.ymin)/p[1]))),k(x,q[0]-f[0]+1,q[1]-f[1]+1));var l;c.isWrappable?(c=[Math.ceil(Math.round(2*d.origin[1]/h.resolution)/c.size[0]),x[1]],d=[Math.floor((d.origin[0]-g[0])/p[0]),f[1]],b=[c[0]+d[0]-1,q[1]],l=!0):(d=f,b=q,c=x,l=!1);return new a(h.level,h.resolution,h.scale,g,f,q,x,p,d,b,c,l)};a.prototype.normalizeCol=
function(a){if(!this.wrap)return a;var c=this.worldSize[0];return 0>a?c-1-Math.abs((a+1)%c):a%c};a.prototype.denormalizeCol=function(a,h){return this.wrap?this.worldSize[0]*h+a:a};a.prototype.getWorldForColumn=function(a){return this.wrap?Math.floor(a/this.worldSize[0]):0};a.prototype.getFirstColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]};a.prototype.getLastColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]+this.size[0]-1};a.prototype.getColumnForX=function(a){return(a-
this.origin[0])/this.norm[0]};a.prototype.getXForColumn=function(a){return this.origin[0]+a*this.norm[0]};a.prototype.getRowForY=function(a){return(this.origin[1]-a)/this.norm[1]};a.prototype.getYForRow=function(a){return this.origin[1]-a*this.norm[1]};a.prototype.getTileBounds=function(a,h,b){void 0===b&&(b=!1);l.set(h);var d=b?l.col:this.denormalizeCol(l.col,l.world),c=l.row;h=this.getXForColumn(d);b=this.getYForRow(c+1);d=this.getXForColumn(d+1);c=this.getYForRow(c);a[0]=h;a[1]=b;a[2]=d;a[3]=c;
return a};a.prototype.getTileCoords=function(a,h,b){void 0===b&&(b=!1);l.set(h);h=b?l.col:this.denormalizeCol(l.col,l.world);Array.isArray(a)?k(a,this.getXForColumn(h),this.getYForRow(l.row)):(a.x=this.getXForColumn(h),a.y=this.getYForRow(l.row));return a};return a}()})},"esri/views/2d/tiling/TileSpan":function(){define(["require","exports"],function(f,a){return function(){return function(a,f,k){this.row=a;this.colFrom=f;this.colTo=k}}()})},"esri/views/2d/layers/features/controllers/OnDemandController":function(){define("require exports tslib ../../../../../core/ArrayPool ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/promiseUtils ../../../../../core/watchUtils ../../../../../core/workers ../../../../../core/accessorSupport/decorators ../../../../../geometry/Extent ../../../../../geometry/support/jsonUtils ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/ogc/ogcFeatureUtils ../../../../../tasks/operations/query ../../../../../tasks/support/QuantizationParameters ../../../engine ./BaseController ./EditsQueue ../support/DataTile ../support/DataTileFeaturesIndex ../support/Tile ../support/TileUpdateQueue ../../../tiling/TileQueue".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u,v,y,z,A,B,D,C,E){Object.defineProperty(a,"__esModule",{value:!0});var F=g.getLogger("esri.views.2d.layers.features.controllers.OnDemandController");f=l("esri-featurelayer-webgl");l=l("esri-mobile");var I=f&&"object"===typeof f&&null!=f.maxDrillLevel?f.maxDrillLevel:l?1:4,J=f&&"object"===typeof f&&null!=f.maxRecordCountFactor?f.maxRecordCountFactor:l?1:3,G=f&&"object"===typeof f&&null!=f.enablePBFQuery?f.enablePBFQuery:!0,H=new Set,K=[],O=function(){function d(d,
a){var c=this;this.objectIdField=a;b.openWithPorts(d).then(function(b){return c.client=b})}d.prototype.destroy=function(){this.client.close();this.client=null};d.prototype.executeQuery=function(b,d){return e.__awaiter(this,void 0,void 0,function(){var a;return e.__generator(this,function(c){switch(c.label){case 0:return[4,this.client.invoke("queryFeatures",b.toJSON(),d)];case 1:return a=c.sent(),[2,r.convertFromFeatureSet(a,this.objectIdField)]}})})};return d}(),L=function(){function b(b,d){this.source=
b;this.sourceSpatialReference=d}b.prototype.destroy=function(){};b.prototype.executeQuery=function(b,d){return e.__awaiter(this,void 0,void 0,function(){var a;return e.__generator(this,function(c){switch(c.label){case 0:return[4,x.executeQueryPBF(this.source,b,{type:"optimized",sourceSpatialReference:this.sourceSpatialReference},d)];case 1:return a=c.sent().data,[2,a]}})})};return b}(),N=function(){function b(b,d,a){this.source=b;this.objectIdField=d;this.sourceSpatialReference=a}b.prototype.destroy=
function(){};b.prototype.executeQuery=function(b,d){return e.__awaiter(this,void 0,void 0,function(){var a;return e.__generator(this,function(c){switch(c.label){case 0:return[4,x.executeQuery(this.source,b,this.sourceSpatialReference,d)];case 1:return a=c.sent().data,[2,r.convertFromFeatureSet(a,this.objectIdField)]}})})};return b}(),T=function(){function b(b,d){this.source=b;this.objectIdField=d}b.prototype.destroy=function(){};b.prototype.executeQuery=function(b,d){return e.__awaiter(this,void 0,
void 0,function(){return e.__generator(this,function(a){return[2,q.queryOptimizedFeatureSet(this.source,b,d)]})})};return b}();y=function(b){function a(){var d=null!==b&&b.apply(this,arguments)||this;d.type="on-demand";d._queryInfoHash=null;d._dataTileIndex=new B.default;d._editsQueue=new z.EditsQueue({processEdits:d._processEdits.bind(d)});d._featuresInFlight=new Map;d.service=null;return d}e.__extends(a,b);a.prototype.initialize=function(){var b=this,d=this._createFeatureStore();d.onFeatureAdd=
this.onFeatureAdd.bind(this);d.onFeatureRemove=this.onFeatureRemove.bind(this);this._set("featureStore",d);this._dataTileIndex.featureStore=this.featureStore;this._dataTileIndex.forEach(function(b){return b.done=!1});this._fetchQueue=new E({concurrency:10,strategy:"center-first",tileInfoView:this.tileStore.tileScheme,process:function(d,a){return e.__awaiter(b,void 0,void 0,function(){var b;return e.__generator(this,function(c){switch(c.label){case 0:return[4,this._fetchTile(d,this.queryInfo,a)];case 1:return b=
c.sent(),[2,{dataTile:d,featureSet:b}]}})})}});this._patchQueue=new E({concurrency:10,strategy:"center-first",tileInfoView:this.tileStore.tileScheme,process:function(d,a){return b._fetchTile(d.dataTile,d.queryInfo,a)}});this._updateQueue=new C.default({tileInfoView:this.tileStore.tileScheme,process:function(d,a,c){return b._updateTile(d,a,c)}});var a=this.service,d=a.capabilities,c=a.source,h=a.objectIdField,a=a.spatialReference;c&&c.capabilities&&c.collectionId&&c.layerDefinition&&c.url?this.sourceAdapter=
new T(c,h):Array.isArray(c)?this.sourceAdapter=new O(c,h):this.sourceAdapter=G&&d.query.supportsFormatPBF?new L(c,a):new N(c,h,a);this.handles.add([this.watch("updating",function(d){return!d&&b.onIdle()})]);this.featureStore.events.on("valueRangesChanged",function(d){b.remoteClient.invoke("emitEvent",{name:"valueRangesChanged",event:{valueRanges:d.valueRanges}})})};a.prototype.destroy=function(){this._fetchQueue.clear();this._patchQueue.clear();this._updateQueue.clear();this._editsQueue.destroy();
this.queryEngine.destroy();this.sourceAdapter.destroy()};Object.defineProperty(a.prototype,"queryEngine",{get:function(){return this._createQueryEngine(this.featureStore)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"updating",{get:function(){return!this.viewState||this._fetchQueue.updating||this._patchQueue.updating||this._updateQueue.updating||this._editsQueue.updating},enumerable:!0,configurable:!0});a.prototype.update=function(b,d){return e.__awaiter(this,void 0,void 0,function(){var a,
c,h,g,n,q,p=this;return e.__generator(this,function(e){switch(e.label){case 0:return this.validateConfig(b),a=JSON.stringify(this.config.filters),c=this.renderer.getAttributeHash(),h=b.availableFields.filter(function(b){return-1===p.availableFields.indexOf(b)}),g=this.config.definitionExpression,this._set("config",b),g!==this.config.definitionExpression&&this._set("queryEngine",this._createQueryEngine(this.featureStore)),[4,this.updatePixelBuffer()];case 1:return e.sent(),n=a!==JSON.stringify(b.filters),
q=c!==this.renderer.getAttributeHash(),d?q?[4,this.attributeStore.setAttributeBindings(this.renderer,this.arcadeInfo)]:[3,3]:[3,6];case 2:e.sent(),e.label=3;case 3:return[4,this.attributeStore.updateFilters(this)];case 4:return e.sent(),[4,this.featureStore.update(n,b,this.service.fields)];case 5:return e.sent(),this.refresh(),[2];case 6:return h.length?[4,this._handleAttributeChange(h)]:[3,8];case 7:e.sent(),e.label=8;case 8:return"heatmap"===this.renderer.type?[2]:q?[4,this.attributeStore.setAttributeBindings(this.renderer,
this.arcadeInfo)]:[3,10];case 9:e.sent(),this.featureStore.forEach(function(b){return p.attributeStore.setAttributeData(b.localId,b,p.geometryInfo,p.viewParams)}),e.label=10;case 10:return[4,this.attributeStore.updateFilters(this)];case 11:return e.sent(),[4,this.featureStore.update(n,b,this.service.fields)];case 12:return e.sent(),[4,this.attributeStore.sendUpdates()];case 13:return e.sent(),[2]}})})};a.prototype.invalidate=function(){return e.__awaiter(this,void 0,void 0,function(){var b,d,a;return e.__generator(this,
function(c){b=0;for(d=this.tileStore.tiles;b<d.length;b++)a=d[b],this._updateQueue.push(a.id,Date.now());return[2]})})};a.prototype.onIdle=function(){this.featureStore.sweepClusters()};a.prototype.onEdits=function(b){var d=this;this._fetchQueue.pause();this._fetchQueue.reset();return this._editsQueue.push(b).then(function(){d._editsQueue.updating||d._fetchQueue.resume()})};a.prototype.queryFeatures=function(b){return this.queryEngine.executeQuery(b)};a.prototype.queryFeatureCount=function(b){return this.queryEngine.executeQueryForCount(b)};
a.prototype.queryObjectIds=function(b){return this.queryEngine.executeQueryForIds(b)};a.prototype.queryExtent=function(b){return this.queryEngine.executeQueryForExtent(b)};a.prototype.queryStatistics=function(){return e.__awaiter(this,void 0,void 0,function(){var b,d,a,h=this;return e.__generator(this,function(g){switch(g.label){case 0:return a=d=b=0,[4,c.all(this.tileStore.tiles.map(function(c){return e.__awaiter(h,void 0,void 0,function(){var h,g,n,q,f,r,x,l,u,k,v;return e.__generator(this,function(e){switch(e.label){case 0:return h=
this.queryInfo,g=h.returnCentroid,n=h.returnGeometry,q=this._pixelBuffer,f={pixelBuffer:q,returnGeometry:n,returnCentroid:g,returnOutline:this.returnOutline},r=performance.now(),[4,this.featureStore.executeTileQuery(c,this.spatialReference,f)];case 1:x=e.sent().features;l=performance.now();a+=l-r;b+=x.length;u=0;for(k=x;u<k.length;u++)v=k[u],v.geometry&&(p.isPolygon(v.geometry)?d+=v.geometry.rings.reduce(function(b,d){return b+d.length},0):p.isPolyline(v.geometry)&&(d+=v.geometry.paths.reduce(function(b,
d){return b+d.length},0)));return[2]}})})}))];case 1:return g.sent(),[2,e.__assign(e.__assign({},this.featureStore.storeStatistics),{displayedFeatureCount:b,displayedVertexCount:d,displayPreProcessTime:a})]}})})};a.prototype.refresh=function(){return e.__awaiter(this,void 0,void 0,function(){var b=this;return e.__generator(this,function(d){switch(d.label){case 0:return this._queryInfoHash=Math.random().toString(),this._dataTileIndex.clear(),this._fetchQueue.pause(),this._updateQueue.pause(),this._editsQueue.clear(),
this._fetchQueue.clear(),[4,h.whenFalseOnce(this._fetchQueue,"updating")];case 1:return d.sent(),this._updateQueue.clear(),[4,h.whenFalseOnce(this._updateQueue,"updating")];case 2:return d.sent(),this.featureStore.startMarkingUsedFeatures(),this._manageTiles(this.tileStore.tiles),this._fetchQueue.resume(),[4,h.whenFalseOnce(this._fetchQueue,"updating")];case 3:return d.sent(),this.featureStore.sweep(),this.featureStore.forEach(function(d){return b.attributeStore.setAttributeData(d.localId,d,b.geometryInfo,
b.viewParams)}),this.attributeStore.sendUpdates(),this._updateQueue.resume(),[2]}})})};a.prototype.setViewState=function(d){var a=this,c=this.viewState&&this.viewState.scale;b.prototype.setViewState.call(this,d);this._fetchQueue.state=d;this._updateQueue.state=d;c!==this.viewState.scale&&this.attributeStore.hasScaleExpr&&(this.featureStore.forEach(function(b){return a.attributeStore.setAttributeData(b.localId,b,a.geometryInfo,a.viewParams)}),this.attributeStore.sendUpdates());this.featureStore.setScale(this.viewState.scale)};
a.prototype.getAggregate=function(b){return this.featureStore.getAggregate(b)};a.prototype.getAggregateValueRanges=function(){return this.featureStore.getAggregateValueRanges()};a.prototype.onTileUpdate=function(b){this._manageTiles(b.added,b.removed);this.featureStore.onTileUpdate(b)};a.prototype.onFeatureAdd=function(b){if(this._featuresInFlight.has(b.objectId)){var d=this._featuresInFlight.get(b.objectId).attributes;b.attributes=e.__assign(e.__assign({},d),b.attributes);this._featuresInFlight.delete(b.objectId)}b.localId=
this.attributeStore.createLocalId(b.objectId);this.attributeStore.setAttributeData(b.localId,b,this.geometryInfo,this.viewParams)};a.prototype._handleAttributeChange=function(b){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(d){switch(d.label){case 0:return[4,this._fetchChangedFields(b)];case 1:return d.sent(),[2]}})})};a.prototype._fetchChangedTileFields=function(b,d){return e.__awaiter(this,void 0,void 0,function(){var a;return e.__generator(this,function(c){return(a=
this._dataTileIndex.get(b.id))?[2,this._fetchChangedTileFieldsDrill(a,d)]:[2]})})};a.prototype._fetchChangedTileFieldsDrill=function(b,d,a){void 0===a&&(a=0);return e.__awaiter(this,void 0,void 0,function(){var h,g,n,q,p,f,r,x,l,u,k=this;return e.__generator(this,function(v){switch(v.label){case 0:return h=e.__assign(e.__assign({},this.queryInfo),{returnGeometry:!1,returnCentroid:!1,outFields:d.concat([this.service.objectIdField])}),b.returnExceeded=b.returnExceeded||a>=I,g=b.key,n={key:g,dataTile:b,
queryInfo:h},[4,this._patchQueue.push(n)];case 1:q=v.sent();if(!(q.exceededTransferLimit&&a<I))return[3,3];p=b.tile.createChildTiles();f=p.map(function(d){var a=new A.default;a.tile=d;a.displayTile=b.displayTile;return a});return[4,c.all(f.map(function(b){return k._fetchChangedTileFieldsDrill(b,d,a+1)}))];case 2:return v.sent(),[2];case 3:r=0;for(x=q.features;r<x.length;r++)l=x[r],this.featureStore.has(l.objectId)?(u=this.featureStore.getFeature(l.objectId),u.attributes=e.__assign(e.__assign({},u.attributes),
l.attributes)):this._featuresInFlight.set(l.objectId,l);return[2]}})})};a.prototype._fetchChangedTileFieldsPaged=function(b,d,a){void 0===a&&(a=0);return e.__awaiter(this,void 0,void 0,function(){var c,h,g,n,q,p,f,r,x,l,u;return e.__generator(this,function(k){switch(k.label){case 0:return c=this.service.capabilities.query.supportsMaxRecordCountFactor,h=this.service.tileMaxRecordCount,g=h*(c?1:J),n=e.__assign(e.__assign({},this.queryInfo),{returnGeometry:!1,returnCentroid:!1,outFields:d.concat([this.service.objectIdField]),
resultOffset:a*g,num:g}),b.returnExceeded=!0,q=b.key,p={key:q,dataTile:b,queryInfo:n},[4,this._patchQueue.push(p)];case 1:f=k.sent();r=0;for(x=f.features;r<x.length;r++)l=x[r],this.featureStore.has(l.objectId)?(u=this.featureStore.getFeature(l.objectId),u.attributes=e.__assign(e.__assign({},u.attributes),l.attributes)):this._featuresInFlight.set(l.objectId,l);return f.exceededTransferLimit?[2,this._fetchChangedTileFieldsPaged(b,d,a+1)]:[2]}})})};a.prototype._fetchChangedFields=function(b){return e.__awaiter(this,
void 0,void 0,function(){var d,a,h=this;return e.__generator(this,function(g){switch(g.label){case 0:return d=this.tileStore.tiles,a=d.map(function(d){return h._fetchChangedTileFields(d,b)}),[4,c.all(a)];case 1:return g.sent(),[2]}})})};a.prototype._manageTiles=function(b,d){void 0===d&&(d=null);for(var a=this._dataTileIndex,c=this._fetchQueue,h=this._updateQueue,g="esriGeometryPoint"===this.service.geometryType,e=function(b){var d=a.get(b.id);d?(d.displayTile=b,g?a.forEach(function(a){D.isChildOf(a,
d)&&(a.displayTile=b)}):d.done=!1):(d=new A.default,d.tile=b.clone(),d.displayTile=b,a.add(d));n._processDataTile(d)},n=this,q=0;q<b.length;q++){var p=b[q];e(p)}if(d)for(b=0;b<d.length;b++)p=d[b],H.add(p),h.abort(p.id);a.forEach(function(b){H.has(b.displayTile)&&K.push(b)});for(h=0;h<K.length;h++)p=K[h],c.abort(p.id),a.delete(p);K.length=0;H.clear()};a.prototype._processDataTile=function(b){var d=this,a=b.key,h=this._fetchQueue,g=a.id,e=this._queryInfoHash,a=a.level-b.displayTile.key.level>=I;this._dataTileIndex.add(b);
if(b.done||h.has(g)){if(b.queryInfoHash!==e||b.returnExceeded!==a)if(b.done)b.done=!1;else if(h.isOngoing(g))h.abort(g);else{b.queryInfoHash=e;b.returnExceeded=a;return}}else b.queryInfoHash=e,b.returnExceeded=a;b.done?this._invalidateTile(b.displayTile):h.has(g)||h.push(b).then(function(b){return d._handleResponse(b.dataTile,b.featureSet)}).catch(function(a){c.isAbortError(a)||(F.error(new k("featurelayer-controller:tile-error","Encountered an error when handling tile response",a)),b.done=!0,d._invalidateTile(b.displayTile))})};
a.prototype._handleResponse=function(b,d){b.done=!0;r.hydrateOptimizedFeatureSet(d);if(d.exceededTransferLimit)if(b.returnExceeded)this._dataTileIndex.setTileFeatures(b,d.features),this._deleteChildrenDataTiles(b);else{d=b.tile.createChildTiles();for(var a=0;a<d.length;a++){var c=d[a],h=new A.default;h.tile=c;h.displayTile=b.displayTile;this._processDataTile(h)}m.release(d)}else this._dataTileIndex.setTileFeatures(b,d.features),this._deleteChildrenDataTiles(b);this._invalidateTile(b.tile)};a.prototype._deleteChildrenDataTiles=
function(b){this._dataTileIndex.forEach(function(d){D.isChildOf(d,b)&&K.push(d)});for(var d=0;d<K.length;d++){var a=K[d];this._fetchQueue.abort(a.id);this._dataTileIndex.delete(a)}K.length=0};a.prototype._createQuery=function(b,d,a,c,h,g){var e=this.service.geometryType;c=this._createDefaultQuery(c);c.maxRecordCountFactor=h;c.returnExceededLimitFeatures=g;c.resultType="tile";c.geometry=b;if(this.service.capabilities.query.supportsQuantization)c.quantizationParameters=new u.default({mode:"view",originPosition:"upper-left",
tolerance:a,extent:d}),"esriGeometryPolyline"===e&&(c.maxAllowableOffset=a);else if("esriGeometryPolyline"===e||"esriGeometryPolygon"===e)c.maxAllowableOffset=a;return c};a.prototype._fetchTile=function(b,d,a){return e.__awaiter(this,void 0,void 0,function(){var c,h,g,q,p,f,x,l,u,k,v;return e.__generator(this,function(e){switch(e.label){case 0:return c=new n({xmin:b.bounds[0],ymin:b.bounds[1],xmax:b.bounds[2],ymax:b.bounds[3],spatialReference:this.spatialReference}),h=this.service.geometryType,g=
"esriGeometryPoint"===h?b.tile:b.displayTile,q=g.extent,p=g.resolution,f=b.returnExceeded,x=this._createQuery(c,q,p,d,J,f),[4,this.sourceAdapter.executeQuery(x,a)];case 1:l=e.sent();if(l.transform&&"esriGeometryPolygon"===h)for(u=0,k=l.features;u<k.length;u++)v=k[u],v.geometry=r.removeCollinearVectices(v.geometry,v.geometry,h,!1,!1);return[2,l]}})})};a.prototype._invalidateTile=function(b){var d=this._updateQueue,a=0;for(b=this.tileStore.intersections(b,this._pixelBuffer);a<b.length;a++){var c=b[a].tile;
d.push(c.id,c.updateTimestamp)}};a.prototype._updateTile=function(b,d,a){return e.__awaiter(this,void 0,void 0,function(){var h,g,n,q,p,f,r,x,l,u,k,y,m=this;return e.__generator(this,function(e){switch(e.label){case 0:return h=this.tileStore.get(b),g=this.queryInfo,n=g.returnCentroid,q=g.returnGeometry,p=this._pixelBuffer,f={pixelBuffer:p,returnGeometry:q,returnCentroid:n,returnOutline:this.returnOutline},[4,this.featureStore.executeTileQuery(h,this.spatialReference,f)];case 1:return r=e.sent(),x=
r.features,l=r.objectIds,[4,this.attributeStore.sendUpdates()];case 2:return e.sent(),u={geometryType:this.service.geometryType,features:x,fields:this.service.fields,objectIdFieldName:this.service.objectIdField,transform:h.transform},k=[],y=!0,this._dataTileIndex.forEach(function(b){h.id!==b.id&&D.isChildOf(b,h)&&y&&!b.done&&(y=!1)}),y&&h&&h.objectIds.forEach(function(b){l.has(b)||(b=m.attributeStore.getLocalId(b),k.push(b))}),l.forEach(function(b){h.objectIds.add(b)}),h.updateTimestamp=d,[2,this.processor.onTileData(h,
{clear:!0,addOrUpdate:u.features,remove:k,transformParams:v.Utils.getTransformParams(u)},a).catch(function(b){c.isAbortError(b)||F.error("update-tile",b)})]}})})};a.prototype._processEdits=function(b,d,a){return e.__awaiter(this,void 0,void 0,function(){var h,g,n,q,p,f=this;return e.__generator(this,function(x){switch(x.label){case 0:return h=this._createTempQueryEngine(),g=this._createObjectIdsQuery(b),b.length?[4,this.sourceAdapter.executeQuery(g)]:[3,2];case 1:n=x.sent(),r.hydrateOptimizedFeatureSet(n),
this._dataTileIndex.addOrUpdateFeatures(n.features),h.featureStore.addMany(n.features),x.label=2;case 2:return q=d.concat(b).map(function(b){return f.attributeStore.getLocalId(b)}),this._dataTileIndex.deleteFeaturesById(d),this.attributeStore.sendUpdates(),p=e.__assign(e.__assign({},this.queryInfo),{pixelBuffer:this._pixelBuffer,returnOutline:this.returnOutline}),this.tileStore.tiles.map(function(b){return e.__awaiter(f,void 0,void 0,function(){var d,g;return e.__generator(this,function(e){switch(e.label){case 0:return[4,
h.featureStore.executeTileQuery(b,this.spatialReference,p)];case 1:return d=e.sent().features,g={transform:b.transform,hasZ:!1,hasM:!1},[2,this.processor.onTileData(b,{addOrUpdate:d,remove:q,transformParams:g},a).catch(function(b){c.isAbortError(b)||F.error("update-tile",b)})]}})})}),h.destroy(),[2]}})})};a.prototype._createObjectIdsQuery=function(b){var d=this._createDefaultQuery(this.queryInfo);d.objectIds=b;return d};e.__decorate([d.property()],a.prototype,"_fetchQueue",void 0);e.__decorate([d.property()],
a.prototype,"_patchQueue",void 0);e.__decorate([d.property()],a.prototype,"_updateQueue",void 0);e.__decorate([d.property()],a.prototype,"_editsQueue",void 0);e.__decorate([d.property({readOnly:!0})],a.prototype,"featureStore",void 0);e.__decorate([d.property({constructOnly:!0})],a.prototype,"service",void 0);e.__decorate([d.property()],a.prototype,"sourceAdapter",void 0);e.__decorate([d.property({readOnly:!0,dependsOn:["featureStore","service"]})],a.prototype,"queryEngine",null);e.__decorate([d.property({dependsOn:["viewState",
"_fetchQueue.updating","_updateQueue.updating","_patchQueue.updating","_editsQueue.updating"]})],a.prototype,"updating",null);return a=e.__decorate([d.subclass("esri.views.2d.layers.features.controllers.OnDemandController")],a)}(y.default);a.default=y})},"esri/core/workers":function(){define(["require","exports","tslib","./workers/workers"],function(f,a,e,m){Object.defineProperty(a,"__esModule",{value:!0});e.__exportStar(m,a)})},"esri/core/workers/workers":function(){define("require exports tslib ../Error ../has ../Logger ../promiseUtils ./Connection ./RemoteClient ./WorkerOwner @dojo/framework/shim/Promise".split(" "),
function(f,a,e,m,k,l,g,c,h,b){function d(b,d){return e.__awaiter(this,void 0,void 0,function(){var a;return e.__generator(this,function(h){switch(h.label){case 0:return a=new c,[4,a.open(b,d)];case 1:return h.sent(),[2,a]}})})}function n(){return e.__awaiter(this,void 0,void 0,function(){var d,a,c;return e.__generator(this,function(h){if(u)return[2,u];v=g.createAbortController();d=[];a=function(a){var c=b.create(a).then(function(b){return q[a]=b});d.push(c)};for(c=0;c<p;c++)a(c);u=g.all(d);return[2,
u]})})}Object.defineProperty(a,"__esModule",{value:!0});a.Connection=c;a.RemoteClient=h;var p=k("esri-workers-debug")?1:k("host-browser")?navigator.hardwareConcurrency-1:0;p||(p=k("safari")&&k("mac")||k("trident")?7:2);var r=0,q=[],x=l.getLogger("esri.core.workers");a.initialize=function(b){void 0===b&&(b={});if(b.maxNumWorkers&&0<b.maxNumWorkers){b=Math.min(b.maxNumWorkers,p);if(u){b!==p&&x.warn("Web workers already initialized, can't set requested number of workers");return}p=b}n()};a.openWithPorts=
function(b,a){return d(b,{client:a})};a.open=function(b,a){void 0===a&&(a={});return e.__awaiter(this,void 0,void 0,function(){var c,x,l,u,v,y;return e.__generator(this,function(z){switch(z.label){case 0:if("string"!==typeof b)throw new m("workers:undefined-module","modulePath is missing");c=a.strategy||"distributed";k("host-webworker")&&!k("esri-workers")&&(c="local");return"local"!==c?[3,4]:[4,h.loadWorker(b)];case 1:return(x=z.sent())?[3,3]:[4,new Promise(function(d,a){f([b],d,a)})];case 2:x=z.sent(),
z.label=3;case 3:return g.throwIfAborted(a.signal),l=a.client||x,u=h.connect(x),[2,d([u],e.__assign(e.__assign({},a),{client:l}))];case 4:return[4,n()];case 5:z.sent();g.throwIfAborted(a.signal);if("dedicated"!==c)return[3,7];v=r++;r%=p;return[4,q[v].open(b,a)];case 6:return u=z.sent(),[2,d([u],a)];case 7:return y=q.map(function(d){return d.open(b,a)}),[2,d(y,a)]}})})};a.terminate=function(){u&&(v.abort(),u=null);for(var b=0;b<q.length;b++)q[b]&&q[b].terminate();q.length=0};var u=null,v})},"esri/core/workers/Connection":function(){define("require exports ../handleUtils ../Logger ../promiseUtils ./RemoteClient".split(" "),
function(f,a,e,m,k,l){var g=m.getLogger("esri.core.workers.Connection");return function(){function a(){this._clients=[];this._clientPromises=[];this._clientIdx=0}Object.defineProperty(a.prototype,"closed",{get:function(){return!this._clients||!this._clients.length},enumerable:!0,configurable:!0});a.prototype.open=function(a,b){var d=this;return k.create(function(c,h){var g=!0,e=function(d){k.throwIfAborted(b.signal);g&&(g=!1,d())};d._clients.length=a.length;d._clientPromises.length=a.length;for(var n=
function(g){var n=a[g];if(k.isThenable(n))return d._clientPromises[g]=n.then(function(a){d._clients[g]=new l(a,b);e(c);return d._clients[g]},function(){e(h);return null}),"continue";d._clients[g]=new l(n,b);d._clientPromises[g]=k.resolve(d._clients[g]);e(c)},p=0;p<a.length;++p)n(p)})};a.prototype.broadcast=function(a,b,d){for(var c=Array(this._clientPromises.length),h=0;h<this._clientPromises.length;++h)c[h]=this._clientPromises[h].then(function(c){return c.invoke(a,b,d)});return c};a.prototype.close=
function(){for(var a=0,b=this._clientPromises;a<b.length;a++)b[a].then(function(b){return b.close()});this._clients.length=0;this._clientPromises.length=0};a.prototype.getAvailableClient=function(){for(var a,b=0;b<this._clients.length;++b){var d=this._clients[b];if(!d)a=a||[],a.push(this._clientPromises[b]);else if(!d.isBusy())return k.resolve(d)}return a?k.first(a):(this._clientIdx=(this._clientIdx+1)%this._clients.length,k.resolve(this._clients[this._clientIdx]))};a.prototype.invoke=function(a,
b,d){var c=null;Array.isArray(d)?(g.warn("invoke()","The transferList parameter is deprecated, use the options object instead"),c={transferList:d}):c=d;return this.closed?k.reject(Error("Connection closed")):this.getAvailableClient().then(function(d){return d.invoke(a,b,c)})};a.prototype.on=function(a,b){var d=this;return k.all(this._clientPromises).then(function(){return e.handlesGroup(d._clients.map(function(d){return d.on(a,b)}))})};a.prototype.openPorts=function(){var a=this;return k.create(function(b){for(var d=
Array(a._clientPromises.length),c=d.length,h=function(h){a._clientPromises[h].then(function(a){d[h]=a.openPort();0===--c&&b(d)})},g=0;g<a._clientPromises.length;++g)h(g)})};return a}()})},"esri/core/workers/WorkerOwner":function(){define("require exports tslib ../../kernel ../Error ../Logger ../promiseUtils ./utils ./workerFactory".split(" "),function(f,a,e,m,k,l,g,c,h){var b=l.getLogger("esri.core.workers"),d=c.MessageType.ABORT,n=c.MessageType.INVOKE,p=c.MessageType.OPEN,r=c.MessageType.OPENED,
q=c.MessageType.RESPONSE;return function(){function a(d,a){this._outJobs=new Map;this._inJobs=new Map;this.worker=d;this.id=a;d.addEventListener("message",this._onMessage.bind(this));d.addEventListener("error",function(d){d.preventDefault();b.error(d)})}a.create=function(b){return e.__awaiter(this,void 0,void 0,function(){var d;return e.__generator(this,function(c){switch(c.label){case 0:return[4,h.createWorker()];case 1:return d=c.sent(),[2,new a(d,b)]}})})};a.prototype.terminate=function(){this.worker.terminate()};
a.prototype.open=function(b,a){void 0===a&&(a={});return e.__awaiter(this,void 0,void 0,function(){var h,n,q=this;return e.__generator(this,function(e){h=a.signal;n=c.newJobId();return[2,g.create(function(a,c){a={resolve:a,reject:c};g.onAbortOrThrow(h,function(){q._outJobs.delete(n);q._post({type:d,jobId:n})});q._outJobs.set(n,a);q._post({type:p,jobId:n,modulePath:b})})]})})};a.prototype._onMessage=function(b){if(b=c.receiveMessage(b))switch(b.type){case r:this._onOpenedMessage(b);break;case q:this._onResponseMessage(b);
break;case d:this._onAbortMessage(b);break;case n:this._onInvokeMessage(b)}};a.prototype._onAbortMessage=function(b){var d=this._inJobs;b=b.jobId;var a=d.get(b);a&&(a.controller&&a.controller.abort(),d.delete(b))};a.prototype._onInvokeMessage=function(b){var d=this,a=b.methodName,h=b.jobId,e=b.data;b=b.abortable?g.createAbortController():null;var n=this._inJobs,p=m.workerMessages[a],f;try{if("function"!==typeof p)throw new TypeError(a+" is not a function");f=p.call(null,e,{signal:b?b.signal:null})}catch(E){this._post({type:q,
jobId:h,error:c.toInvokeError(E)});return}g.isPromiseLike(f)?(n.set(h,{controller:b,promise:f}),f.then(function(b){n.has(h)&&(n.delete(h),d._post({type:q,jobId:h},b))},function(b){n.has(h)&&(n.delete(h),b||(b={message:"Error encountered at method"+a}),g.isAbortError(b)||d._post({type:q,jobId:h,error:c.toInvokeError(b||{message:"Error encountered at method "+a})}))})):this._post({type:q,jobId:h},f)};a.prototype._onOpenedMessage=function(b){var d=b.jobId;b=b.data;var a=this._outJobs.get(d);a&&(this._outJobs.delete(d),
a.resolve(b))};a.prototype._onResponseMessage=function(b){var d=b.jobId,a=b.error;b=b.data;var c=this._outJobs.get(d);c&&(this._outJobs.delete(d),a?c.reject(k.fromJSON(JSON.parse(a))):c.resolve(b))};a.prototype._post=function(b,d,a){return c.postMessage(this.worker,b,d,a)};return a}()})},"esri/core/workers/workerFactory":function(){define("require exports tslib ../../config ../../intl ../has ../Logger ../promiseUtils ./loaderConfig ./utils ./WorkerFallback".split(" "),function(f,a,e,m,k,l,g,c,h,b,
d){function n(a){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(g){return[2,c.create(function(c){function g(d){if(d=b.receiveMessage(d))switch(d.type){case x:d=a;var p=m.workers.loaderUrl||h.DEFAULT_LOADER_URL,f;null!=m["default"]?(f=e.__assign({},m),delete f["default"],f=JSON.parse(JSON.stringify(f))):f=JSON.parse(JSON.stringify(m));f.locale=k.getLocale();f.has={"csp-restrictions":l("csp-restrictions"),"esri-2d-debug":0,"esri-atomics":l("esri-atomics"),"esri-secure-context":l("esri-secure-context"),
"esri-shared-array-buffer":l("esri-shared-array-buffer"),"esri-webgl-max-texture-size":l("esri-webgl-max-texture-size"),"esri-webgl-texture-float":l("esri-webgl-texture-float"),"esri-workers-arraybuffer-transfer":l("esri-workers-arraybuffer-transfer"),"host-webworker":1};var u=m.workers.loaderConfig,u=h.default({baseUrl:u.baseUrl,locale:k.getLocale(),has:e.__assign({"csp-restrictions":l("csp-restrictions"),"dojo-test-sniff":0,"host-webworker":1},u.has),map:e.__assign({},u.map),paths:e.__assign({},
u.paths),packages:u.packages||[]});d.postMessage({type:q,configure:{esriConfig:f,loaderUrl:p,loaderConfig:u}});break;case r:a.removeEventListener("message",g),a.removeEventListener("error",n),c(a)}}function n(b){b.preventDefault();a.removeEventListener("message",g);a.removeEventListener("error",n);p.warn("Failed to create Worker. Fallback to execute module in main thread",b);a=new d;a.addEventListener("message",g);a.addEventListener("error",n)}a.addEventListener("message",g);a.addEventListener("error",
n)})]})})}Object.defineProperty(a,"__esModule",{value:!0});var p=g.getLogger("esri.core.workers");l.add("esri-workers-arraybuffer-transfer",!l("safari")||12<=l("safari"));var r=b.MessageType.CONFIGURED,q=b.MessageType.CONFIGURE,x=b.MessageType.HANDSHAKE,u;try{u=URL.createObjectURL(new Blob(['var globalId\x3d0,outgoing\x3dnew Map,configured\x3d!1,HANDSHAKE\x3d0,CONFIGURE\x3d1,CONFIGURED\x3d2,OPEN\x3d3,OPENED\x3d4,RESPONSE\x3d5,INVOKE\x3d6,ABORT\x3d7;function createAbortError(){var error\x3dnew Error("Aborted");return error.name\x3d"AbortError",error}function receiveMessage(event){return event\x26\x26event.data?"string"\x3d\x3dtypeof event.data?JSON.parse(event.data):event.data:null}function invokeStaticMessage(methodName,data,options){var signal\x3doptions\x26\x26options.signal,jobId\x3dglobalId++;return new Promise((function(resolve,reject){if(signal){if(signal.aborted)return reject(createAbortError());signal.addEventListener("abort",(function(){outgoing.get(jobId)\x26\x26(outgoing.delete(jobId),self.postMessage({type:ABORT,jobId:jobId}),reject(createAbortError()))}))}outgoing.set(jobId,{resolve:resolve,reject:reject}),self.postMessage({type:INVOKE,jobId:jobId,methodName:methodName,abortable:null!\x3dsignal,data:data})}))}function messageHandler(event){var message\x3dreceiveMessage(event);if(message){var jobId\x3dmessage.jobId;switch(message.type){case CONFIGURE:var configuration\x3dmessage.configure;if(configured)return;configured\x3d!0,self.dojoConfig\x3dconfiguration.loaderConfig,self.importScripts(configuration.loaderUrl),"function"\x3d\x3dtypeof require.config\x26\x26require.config(configuration.loaderConfig),self.esriConfig\x3dconfiguration.esriConfig,self.postMessage({type:CONFIGURED});break;case OPEN:var modulePath\x3dmessage.modulePath;require(["esri/core/workers/RemoteClient"],(function(RemoteClient){RemoteClient.loadWorker(modulePath).then((function(Module){return Module||new Promise((function(resolve){require([modulePath],resolve)}))})).then((function(Module){var port\x3dRemoteClient.connect(Module);self.postMessage({type:OPENED,jobId:jobId,data:port},[port])}))}));break;case RESPONSE:if(outgoing.has(jobId)){var deferred\x3doutgoing.get(jobId);outgoing.delete(jobId),message.error?deferred.reject(JSON.parse(message.error)):deferred.resolve(message.data)}}}}self.addEventListener("message",messageHandler),self.postMessage({type:HANDSHAKE});'],
{type:"text/javascript"}))}catch(v){}a.createWorker=function(){return e.__awaiter(this,void 0,void 0,function(){var b;return e.__generator(this,function(a){if(!l("esri-workers"))return[2,n(new d)];if(u)try{b=new Worker(u)}catch(z){p.warn("Failed to create Worker. Fallback to execute module in main thread",event),b=new d}else p.warn("Failed to create Worker. Fallback to execute module in main thread",event),b=new d;return[2,n(b)]})})}})},"esri/intl":function(){define("require exports ./intl/date ./intl/number ./intl/substitute ./intl/locale ./intl/messages".split(" "),
function(f,a,e,m,k,l,g){Object.defineProperty(a,"__esModule",{value:!0});a.formatDate=e.formatDate;a.convertDateFormatToIntlOptions=e.convertDateFormatToIntlOptions;a.formatNumber=m.formatNumber;a.convertNumberFormatToIntlOptions=m.convertNumberFormatToIntlOptions;a.substitute=k.substitute;a.getLocale=l.getLocale;a.setLocale=l.setLocale;a.onLocaleChange=l.onLocaleChange;a.prefersRTL=l.prefersRTL;a.loadMessageBundle=g.loadMessageBundle;a.getKnownMessageBundleLocale=g.getKnownMessageBundleLocale})},
"esri/intl/date":function(){define("require exports tslib @dojo/framework/shim/WeakMap ../core/jsonMap ./locale".split(" "),function(f,a,e,m,k,l){function g(b){b=b||x;if(!q.has(b)){var d=l.getLocale(),d=r[l.getLocale()]||d;q.set(b,new Intl.DateTimeFormat(d,b))}return q.get(b)}Object.defineProperty(a,"__esModule",{value:!0});f={year:"numeric",month:"numeric",day:"numeric"};var c={year:"numeric",month:"long",day:"numeric"},h={year:"numeric",month:"short",day:"numeric"},b={year:"numeric",month:"long",
weekday:"long",day:"numeric"},d={hour:"numeric",minute:"numeric"},n=e.__assign(e.__assign({},d),{second:"numeric"}),p={"short-date":f,"short-date-short-time":e.__assign(e.__assign({},f),d),"short-date-short-time-24":e.__assign(e.__assign(e.__assign({},f),d),{hour12:!1}),"short-date-long-time":e.__assign(e.__assign({},f),n),"short-date-long-time-24":e.__assign(e.__assign(e.__assign({},f),n),{hour12:!1}),"short-date-le":f,"short-date-le-short-time":e.__assign(e.__assign({},f),d),"short-date-le-short-time-24":e.__assign(e.__assign(e.__assign({},
f),d),{hour12:!1}),"short-date-le-long-time":e.__assign(e.__assign({},f),n),"short-date-le-long-time-24":e.__assign(e.__assign(e.__assign({},f),n),{hour12:!1}),"long-month-day-year":c,"long-month-day-year-short-time":e.__assign(e.__assign({},c),d),"long-month-day-year-short-time-24":e.__assign(e.__assign(e.__assign({},c),d),{hour12:!1}),"long-month-day-year-long-time":e.__assign(e.__assign({},c),n),"long-month-day-year-long-time-24":e.__assign(e.__assign(e.__assign({},c),n),{hour12:!1}),"day-short-month-year":h,
"day-short-month-year-short-time":e.__assign(e.__assign({},h),d),"day-short-month-year-short-time-24":e.__assign(e.__assign(e.__assign({},h),d),{hour12:!1}),"day-short-month-year-long-time":e.__assign(e.__assign({},h),n),"day-short-month-year-long-time-24":e.__assign(e.__assign(e.__assign({},h),n),{hour12:!1}),"long-date":b,"long-date-short-time":e.__assign(e.__assign({},b),d),"long-date-short-time-24":e.__assign(e.__assign(e.__assign({},b),d),{hour12:!1}),"long-date-long-time":e.__assign(e.__assign({},
b),n),"long-date-long-time-24":e.__assign(e.__assign(e.__assign({},b),n),{hour12:!1}),"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":d,"long-time":n};a.dictionary=k.strict()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",
shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",
dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"});a.dateFormats=a.dictionary.apiValues;a.toJSON=
a.dictionary.toJSON.bind(a.dictionary);a.fromJSON=a.dictionary.fromJSON.bind(a.dictionary);var r={ar:"ar-u-nu-latn-ca-gregory"},q=new m.default,x=p["short-date-short-time"];l.beforeLocaleChange(function(){q=new m.default;x=p["short-date-short-time"]});a.getDateTimeFormatter=g;a.convertDateFormatToIntlOptions=function(b){return p[b]||null};a.formatDate=function(b,d){return g(d).format(b)}})},"@dojo/framework/shim/WeakMap":function(){(function(f){"object"===typeof module&&"object"===typeof module.exports?
(f=f(require,exports),void 0!==f&&(module.exports=f)):"function"===typeof define&&define.amd&&define("require exports tslib ./global ./iterator ../has/has ./Symbol".split(" "),f)})(function(f,a){Object.defineProperty(a,"__esModule",{value:!0});var e=f("tslib"),m=f("./global"),k=f("./iterator"),l=f("../has/has");f("./Symbol");a.WeakMap=m.default.WeakMap;if(!l.default("es6-weakmap")){var g={},c=function(){var a=Math.floor(Date.now()%1E8);return function(){return"__wm"+Math.floor(1E8*Math.random())+
(a++ +"__")}}();a.WeakMap=function(){function a(b){this[Symbol.toStringTag]="WeakMap";this._name=c();this._frozenEntries=[];if(b)if(k.isArrayLike(b))for(var d=0;d<b.length;d++){var a=b[d];this.set(a[0],a[1])}else try{for(d=e.__values(b),a=d.next();!a.done;a=d.next()){var h=e.__read(a.value,2);this.set(h[0],h[1])}}catch(x){g={error:x}}finally{try{a&&!a.done&&(q=d.return)&&q.call(d)}finally{if(g)throw g.error;}}var g,q}a.prototype._getFrozenEntryIndex=function(b){for(var d=0;d<this._frozenEntries.length;d++)if(this._frozenEntries[d].key===
b)return d;return-1};a.prototype.delete=function(b){if(void 0===b||null===b)return!1;var d=b[this._name];if(d&&d.key===b&&d.value!==g)return d.value=g,!0;b=this._getFrozenEntryIndex(b);return 0<=b?(this._frozenEntries.splice(b,1),!0):!1};a.prototype.get=function(b){if(void 0!==b&&null!==b){var d=b[this._name];if(d&&d.key===b&&d.value!==g)return d.value;b=this._getFrozenEntryIndex(b);if(0<=b)return this._frozenEntries[b].value}};a.prototype.has=function(b){if(void 0===b||null===b)return!1;var d=b[this._name];
return d&&d.key===b&&d.value!==g||0<=this._getFrozenEntryIndex(b)?!0:!1};a.prototype.set=function(b,d){if(!b||"object"!==typeof b&&"function"!==typeof b)throw new TypeError("Invalid value used as weak map key");var a=b[this._name];a&&a.key===b||(a=Object.create(null,{key:{value:b}}),Object.isFrozen(b)?this._frozenEntries.push(a):Object.defineProperty(b,this._name,{value:a}));a.value=d;return this};return a}()}a.default=a.WeakMap})},"esri/intl/locale":function(){define(["require","exports","tslib",
"../core/global"],function(f,a,e,m){function k(){var b,d;return null!==(d=null!==r&&void 0!==r?r:null===(b=m.navigator)||void 0===b?void 0:b.language)&&void 0!==d?d:"en"}function l(){void 0===p&&(p=k());return p}function g(){var b=null!==n&&void 0!==n?n:k();p!==b&&(p=b,e.__spreadArrays(u).forEach(function(d){d.call(null,b)}),e.__spreadArrays(x).forEach(function(d){d.call(null,b)}))}var c,h,b,d;Object.defineProperty(a,"__esModule",{value:!0});var n=void 0,p=void 0,r=null!==(h=null===(c=m.esriConfig)||
void 0===c?void 0:c.locale)&&void 0!==h?h:null===(b=m.dojoConfig)||void 0===b?void 0:b.locale;a.getDefaultLocale=k;a.getLocale=l;a.setLocale=function(b){n=b?b:void 0;g()};var q={he:!0,ar:!0};a.prefersRTL=function(b){void 0===b&&(b=l());b=/^([a-zA-Z]{2,3})(?:[_\-]\w+)*$/.exec(b);b=null===b||void 0===b?void 0:b[1].toLowerCase();return q[b]||!1};var x=[];a.onLocaleChange=function(b){x.push(b);return{remove:function(){x.splice(x.indexOf(b),1)}}};var u=[];a.beforeLocaleChange=function(b){u.push(b);return{remove:function(){x.splice(u.indexOf(b),
1)}}};null===(d=m.addEventListener)||void 0===d?void 0:d.call(m,"languagechange",g)})},"esri/intl/number":function(){define(["require","exports","@dojo/framework/shim/WeakMap","./locale"],function(f,a,e,m){function k(a){var b=a||c;if(!g.has(b)){var d=m.getLocale(),d=l[m.getLocale()]||d;g.set(b,new Intl.NumberFormat(d,a))}return g.get(b)}Object.defineProperty(a,"__esModule",{value:!0});var l={ar:"ar-u-nu-latn"},g=new e.default,c={};m.beforeLocaleChange(function(){g=new e.default;c={}});a.getFormatter=
k;a.convertNumberFormatToIntlOptions=function(a){void 0===a&&(a={});var b={};null!=a.digitSeparator&&(b.useGrouping=a.digitSeparator);null!=a.places&&(b.minimumFractionDigits=b.maximumFractionDigits=a.places);return b};a.formatNumber=function(a,b){return k(b).format(a)}})},"esri/intl/substitute":function(){define("require exports ../core/Logger ../core/object ../core/string ./date ./number".split(" "),function(f,a,e,m,k,l,g){function c(b){switch(typeof b){case "string":return b;case "number":return g.formatNumber(b);
case "boolean":return""+b;default:return b instanceof Date?l.formatDate(b):""}}Object.defineProperty(a,"__esModule",{value:!0});var h=e.getLogger("esri.intl");a.substitute=function(b,d,a){void 0===a&&(a={});a=a.format;var e=void 0===a?{}:a;return k.replace(b,function(b){var a;var n,p=b.indexOf(":");-1===p?n=b.trim():(n=b.slice(0,p).trim(),a=b.slice(p+1).trim());if(n)if(b=m.getDeepValue(n,d),null==b)a="";else if(n=e[a]||e[n])b:switch(n.type){case "date":a=l.formatDate(b,n.intlOptions);break b;case "number":a=
g.formatNumber(b,n.intlOptions);break b;default:h.warn("missing format descriptor for key {key}"),a=c(b)}else if(a)b:switch(a.toLowerCase()){case "dateformat":a=l.formatDate(b);break b;case "numberformat":a=g.formatNumber(b);break b;default:h.warn("inline format is unsupported since 4.12: "+a),a=/^(dateformat|datestring)/i.test(a)?l.formatDate(b):/^numberformat/i.test(a)?g.formatNumber(b):c(b)}else a=c(b);else a="";return a})}})},"esri/intl/messages":function(){define("require exports tslib ../assets ../core/Error ../core/maybe ../core/promiseUtils ../core/SetUtils ./locale @dojo/framework/shim/Promise".split(" "),
function(f,a,e,m,k,l,g,c,h){function b(b){if(!p.test(b))return null;var d=p.exec(b);b=d[1];d=d[2];d=b+(d?"-"+d.toUpperCase():"");return r.has(d)?d:r.has(b)?b:null}function d(d){return e.__awaiter(this,void 0,void 0,function(){var a,c,g,q,p,f,r,x,l;return e.__generator(this,function(e){switch(e.label){case 0:a=/^(.*)\/t9n\/(.*)$/g.exec(d);if(!a)throw new k("esri-intl:invalid-bundle",'Missing "t9n" folder in locale bundle path "'+d+'"');c=a[1]+"/t9n/";g=a[2];q=h.getLocale();p=b(q);f=""+c+g+".json";
r=p?""+c+g+"_"+p+".json":f;e.label=1;case 1:return e.trys.push([1,3,,8]),[4,n(r)];case 2:return x=e.sent(),[3,8];case 3:l=e.sent();if(r===f)throw l;e.label=4;case 4:return e.trys.push([4,6,,7]),[4,n(f)];case 5:return x=e.sent(),[3,7];case 6:throw e.sent(),new k("esri-intl:unknown-bundle",'Bundle "'+d+'" cannot be loaded',{error:l});case 7:return[3,8];case 8:return[2,x]}})})}function n(b){return e.__awaiter(this,void 0,void 0,function(){var d;return e.__generator(this,function(c){switch(c.label){case 0:return l.isSome(a.test.fetchBundleAsset)?
[2,a.test.fetchBundleAsset(b)]:[4,m.fetchAsset(b,{responseType:"json"})];case 1:return d=c.sent(),[2,d.data]}})})}Object.defineProperty(a,"__esModule",{value:!0});var p=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,r=c.SetFromValues("ar bs ca cs da de el en es et fi fr he hi hr hu id it ja ko lt lv nb nl pl pt-BR pt-PT ro ru sl sr sv th tr uk vi zh-CN zh-HK zh-TW".split(" ")),q=new Map;h.beforeLocaleChange(function(){q.clear()});a.loadMessageBundle=function(b){return e.__awaiter(this,void 0,void 0,function(){var a;
return e.__generator(this,function(c){switch(c.label){case 0:return q.has(b)||q.set(b,d(b)),a=q.get(b),[4,x.add(a)];case 1:return c.sent(),[2,a]}})})};a.getKnownMessageBundleLocale=b;var x=new (function(){function b(){this._numLoading=0}b.prototype.waitForAll=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(b){switch(b.label){case 0:return this._dfd?[4,this._dfd.promise]:[3,2];case 1:b.sent(),b.label=2;case 2:return[2]}})})};b.prototype.add=function(b){var d=
this;this._increase();b.then(function(){return d._decrease()},function(){return d._decrease()});return this.waitForAll()};b.prototype._increase=function(){this._numLoading++;this._dfd||(this._dfd=g.createDeferred())};b.prototype._decrease=function(){this._numLoading=Math.max(this._numLoading-1,0);this._dfd&&0===this._numLoading&&(this._dfd.resolve(),this._dfd=null)};return b}());a.test={cache:q}})},"esri/assets":function(){define(["require","exports","./request","./core/urlUtils"],function(f,a,e,
m){function k(a){return m.join(f.toUrl("."),"../",a)}Object.defineProperty(a,"__esModule",{value:!0});a.fetchAsset=function(a,g){return e(k(a),g)};a.getAssetUrl=k})},"esri/core/workers/loaderConfig":function(){define(["require","exports","tslib","../has","../urlUtils"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});a.DEFAULT_LOADER_URL=k.makeAbsolute(k.removeQueryParameters(f.toUrl("dojo/dojo-lite.js")));a.DEFAULT_CONFIG={baseUrl:function(){var a=k.removeQueryParameters(f.toUrl("dojo/x.js"));
return k.makeAbsolute(a.slice(0,a.length-5))}(),packages:[{name:"esri"},{name:"dojo"},{name:"dojox"},{name:"dstore"},{name:"moment",main:"moment"},{name:"@dojo"},{name:"cldrjs",main:"dist/cldr"},{name:"globalize",main:"dist/globalize"},{name:"maquette-css-transitions",main:"dist/maquette-css-transitions.umd"},{name:"maquette-jsx",main:"dist/maquette-jsx.umd"},{name:"tslib",main:"tslib"}],map:{globalize:{cldr:"cldrjs/dist/cldr","cldr/event":"cldrjs/dist/cldr/event","cldr/supplemental":"cldrjs/dist/cldr/supplemental",
"cldr/unresolved":"cldrjs/dist/cldr/unresolved"}}};a.default=function(l){var g={async:l.async,isDebug:l.isDebug,locale:l.locale,baseUrl:l.baseUrl,has:e.__assign({},l.has),map:e.__assign({},l.map),packages:l.packages&&l.packages.concat()||[],paths:e.__assign({},l.paths)};l.hasOwnProperty("async")||(g.async=!0);l.hasOwnProperty("isDebug")||(g.isDebug=!1);l.baseUrl||(g.baseUrl=a.DEFAULT_CONFIG.baseUrl);a.DEFAULT_CONFIG.packages.forEach(function(b){a:{for(var d=g.packages,a=0;a<d.length;a++)if(d[a].name===
b.name)break a;b=e.__assign({},b);a=k.removeQueryParameters(f.toUrl(b.name+"/x.js"));a=a.slice(0,a.length-5);b.location=k.makeAbsolute(a);d.push(b)}});l=g.map=g.map||{};for(var c=0,h=Object.keys(a.DEFAULT_CONFIG.map);c<h.length;c++){var b=h[c];l[b]||(l[b]=a.DEFAULT_CONFIG.map[b])}return g}})},"esri/core/workers/WorkerFallback":function(){define("require exports tslib ../global ./RemoteClient ./utils @dojo/framework/shim/Promise".split(" "),function(f,a,e,m,k,l){var g=function(){return function(){var b=
this,a=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(function(d){b[d]=function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return a[d].apply(a,b)}})}}(),c=m.MutationObserver||m.WebKitMutationObserver,h=function(){var b;if(m.process&&m.process.nextTick)b=function(b){m.process.nextTick(b)};else if(m.Promise)b=function(b){m.Promise.resolve().then(b)};else if(c){var a=[],h=document.createElement("div");(new c(function(){for(;0<a.length;)a.shift()()})).observe(h,
{attributes:!0});b=function(b){a.push(b);h.setAttribute("queueStatus","1")}}return b}(),b=function(){var b=m.MessageEvent;try{new b("message",{data:null})}catch(n){return function(b,d){void 0===d&&(d={});var a=d.data,c=d.bubbles,c=void 0===c?!1:c;d=d.cancelable;d=void 0===d?!1:d;var h=document.createEvent("Event");h.initEvent(b,c,d);h.data=a;return h}}return function(d,a){return new b(d,a)}}();return function(){function d(){this._dispatcher=new g;this._isInitialized=!1;this._workerPostMessage({type:l.MessageType.HANDSHAKE})}
d.prototype.terminate=function(){};Object.defineProperty(d.prototype,"onmessage",{get:function(){return this._onmessageHandler},set:function(b){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler);(this._onmessageHandler=b)&&this.addEventListener("message",b)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"onerror",{get:function(){return this._onerrorHandler},set:function(b){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler);
(this._onerrorHandler=b)&&this.addEventListener("error",b)},enumerable:!0,configurable:!0});d.prototype.postMessage=function(d){var a=this;h(function(){a._workerMessageHandler(b("message",{data:d}))})};d.prototype.dispatchEvent=function(b){return this._dispatcher.dispatchEvent(b)};d.prototype.addEventListener=function(b,d,a){this._dispatcher.addEventListener(b,d,a)};d.prototype.removeEventListener=function(b,d,a){this._dispatcher.removeEventListener(b,d,a)};d.prototype._workerPostMessage=function(d){var a=
this;h(function(){a.dispatchEvent(b("message",{data:d}))})};d.prototype._workerMessageHandler=function(b){return e.__awaiter(this,void 0,void 0,function(){var d,a,c,h,g,n;return e.__generator(this,function(e){switch(e.label){case 0:d=l.receiveMessage(b);if(!d)return[2];a=d.type;switch(a){case l.MessageType.CONFIGURE:return[3,1];case l.MessageType.OPEN:return[3,2]}return[3,6];case 1:return this._isInitialized||this._workerPostMessage({type:l.MessageType.CONFIGURED}),[3,6];case 2:return c=d.modulePath,
h=d.jobId,[4,k.loadWorker(c)];case 3:return(g=e.sent())?[3,5]:[4,new Promise(function(b,d){f([c],b,d)})];case 4:g=e.sent(),e.label=5;case 5:return n=k.connect(g),this._workerPostMessage({type:l.MessageType.OPENED,jobId:h,data:n}),[3,6];case 6:return[2]}})})};return d}()})},"esri/layers/graphics/featureConversionUtils":function(){define("require exports ../../core/Error ../../core/Logger ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(f,
a,e,m,k,l,g,c){function h(b,d){return b?d?4:3:d?3:2}function b(b,d,a,c){if(b){if(a)return d&&c?V:U;if(d&&c)return X}else if(d&&c)return U;return S}function d(b,d){return Math.round((d-b.translate[0])/b.scale[0])}function n(b,d){return Math.round((b.translate[1]-d)/b.scale[1])}function p(b,d){return d*b.scale[0]+b.translate[0]}function r(b,d){return b.translate[1]-d*b.scale[1]}function q(b){b=b.coords;return{x:b[0],y:b[1]}}function x(b,d){b.coords[0]=d.x;b.coords[1]=d.y;return b}function u(b){b=b.coords;
return{x:b[0],y:b[1],z:b[2]}}function v(b,d){b.coords[0]=d.x;b.coords[1]=d.y;b.coords[2]=d.z;return b}function y(b){b=b.coords;return{x:b[0],y:b[1],m:b[2]}}function z(b,d){b.coords[0]=d.x;b.coords[1]=d.y;b.coords[2]=d.m;return b}function A(b){b=b.coords;return{x:b[0],y:b[1],z:b[2],m:b[3]}}function B(b,d){b.coords[0]=d.x;b.coords[1]=d.y;b.coords[2]=d.z;b.coords[3]=d.m;return b}function D(b,d){return b&&d?B:b?v:d?z:x}function C(b,d,a){if(!b)return null;for(var c=h(d,a),g=[],e=0;e<b.coords.length;e+=
c){for(var n=[],q=0;q<c;q++)n.push(b.coords[e+q]);g.push(n)}return d?a?{points:g,hasZ:d,hasM:a}:{points:g,hasZ:d}:a?{points:g,hasM:a}:{points:g}}function E(b,d,a){void 0===a&&(a=h(d.hasZ,d.hasM));b.lengths[0]=d.points.length;var c=b.coords,g=0,e=0;for(d=d.points;e<d.length;e++)for(var n=d[e],q=0;q<a;q++)c[g++]=n[q];return b}function F(b,d,a){if(!b)return null;var c=h(d,a),g=b.coords,e=[],n=0,q=0;for(b=b.lengths;q<b.length;q++){for(var p=b[q],f=[],r=0;r<p;r++){for(var x=[],l=0;l<c;l++)x.push(g[n++]);
f.push(x)}e.push(f)}return d?a?{paths:e,hasZ:d,hasM:a}:{paths:e,hasZ:d}:a?{paths:e,hasM:a}:{paths:e}}function I(b,d,a){void 0===a&&(a=h(d.hasZ,d.hasM));var c=b.lengths,g=b.coords,e=0,n=0;for(d=d.paths;n<d.length;n++){for(var q=d[n],p=0,f=q;p<f.length;p++)for(var r=f[p],x=0;x<a;x++)g[e++]=r[x];c.push(q.length)}return b}function J(b,d,a){if(!b)return null;var c=h(d,a),g=b.coords,e=[],n=0,q=0;for(b=b.lengths;q<b.length;q++){for(var p=b[q],f=[],r=0;r<p;r++){for(var x=[],l=0;l<c;l++)x.push(g[n++]);f.push(x)}e.push(f)}return d?
a?{rings:e,hasZ:d,hasM:a}:{rings:e,hasZ:d}:a?{rings:e,hasM:a}:{rings:e}}function G(b,d,a,c){void 0===a&&(a=d.hasZ);void 0===c&&(c=d.hasM);H(b,d.rings,a,c);return b}function H(b,d,a,c){a=h(a,c);c=b.lengths;for(var g=b.coords,e=0,n=c.length=g.length=0;n<d.length;n++){for(var q=d[n],p=0,f=q;p<f.length;p++)for(var r=f[p],x=0;x<a;x++)g[e++]=r[x];c.push(q.length)}return b}function K(b,d,a,g,n,q){b.length=0;if(!a){for(g=0;g<d.length;g++)n=d[g],b.push(new l.default(null,n.attributes,null,n.attributes[q]));
return b}switch(a){case "esriGeometryPoint":g=D(g,n);for(n=0;n<d.length;n++){var p=d[n];a=p.geometry;var p=p.attributes,f=void 0;a&&(f=g(new c.default,a));b.push(new l.default(f,p,null,p[q]))}break;case "esriGeometryMultipoint":g=h(g,n);for(n=0;n<d.length;n++)p=d[n],a=p.geometry,p=p.attributes,f=void 0,a&&(f=E(new c.default,a,g)),b.push(new l.default(f,p,null,p[q]));break;case "esriGeometryPolyline":g=h(g,n);for(n=0;n<d.length;n++)p=d[n],a=p.geometry,p=p.attributes,f=void 0,a&&(f=I(new c.default,
a,g)),b.push(new l.default(f,p,null,p[q]));break;case "esriGeometryPolygon":for(a=0;a<d.length;a++){var r=d[a],p=r.geometry,f=r.centroid,r=r.attributes,k=void 0;p&&(k=G(new c.default,p,g,n));f?b.push(new l.default(k,r,x(new c.default,f),r[q])):b.push(new l.default(k,r,null,r[q]))}break;default:R.error("convertToFeatureSet:unknown-geometry",new e("Unable to parse unknown geometry type '"+a+"'")),b.length=0}return b}function O(b,d,a,c,h){b.length=0;switch(a){case "esriGeometryPoint":a=q;c&&h?a=A:c?
a=u:h&&(a=y);for(c=0;c<d.length;c++){var g=d[c];h=g.geometry;g=g.attributes;h=h?a(h):null;b.push({attributes:g,geometry:h})}break;case "esriGeometryMultipoint":for(a=0;a<d.length;a++){var n=d[a],g=n.geometry,n=n.attributes,p=void 0;g&&(p=C(g,c,h));b.push({attributes:n,geometry:p})}break;case "esriGeometryPolyline":for(a=0;a<d.length;a++)n=d[a],g=n.geometry,n=n.attributes,p=void 0,g&&(p=F(g,c,h)),b.push({attributes:n,geometry:p});break;case "esriGeometryPolygon":for(a=0;a<d.length;a++){var p=d[a],
n=p.geometry,g=p.attributes,f=p.centroid,p=void 0;n&&(p=J(n,c,h));f?(n=q(f),b.push({attributes:g,centroid:n,geometry:p})):b.push({attributes:g,geometry:p})}break;default:R.error("convertToFeatureSet:unknown-geometry",new e("Unable to parse unknown geometry type '"+a+"'"))}return b}function L(a,c,g,e,q,p,f,r){void 0===f&&(f=g);void 0===r&&(r=e);a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!c||!c.coords.length)return null;q=Q[q];var x=c.coords;c=c.lengths;var l=h(g,
e),k=h(g&&f,e&&r);g=b(g,e,f,r);if(!c.length)return g(a.coords,x,0,0,d(p,x[0]),n(p,x[1])),a.lengths.length&&(a.lengths.length=0),a.coords.length=l,a;for(var u,y=0,v,m=0,z=0;z<c.length;z++){var A=c[z];if(!(A<q)){var B=0;v=m;r=e=d(p,x[y]);u=f=n(p,x[y+1]);g(a.coords,x,v,y,r,u);B++;y+=l;v+=k;for(var C=1;C<A;C++,y+=l)if(r=d(p,x[y]),u=n(p,x[y+1]),r!==e||u!==f)g(a.coords,x,v,y,r-e,u-f),v+=k,B++,e=r,f=u;B>=q&&(a.lengths.push(B),m=v)}}a.coords.length=m;return a.coords.length?a:null}function N(b,d,a,c,h,g,e){for(var n=
c,q=0,p,f=g+a;f<e;f+=a){p=d[f];var r=d[f+1],x=d[e],l=d[e+1],k=d[g],u=d[g+1],y=x-k,v=l-u;if(0!==y||0!==v){var m=((p-k)*y+(r-u)*v)/(y*y+v*v);1<m?(k=x,u=l):0<m&&(k+=y*m,u+=v*m)}y=p-k;v=r-u;p=y*y+v*v;p>n&&(q=f,n=p)}n>c&&(q-g>a&&N(b,d,a,c,h,g,q),h(b,d,b.length,q,d[q],d[q+1]),e-q>a&&N(b,d,a,c,h,q,e))}function T(b,d,a,c,g){var e=d.coords,n=d.lengths,q=a?c?V:U:c?U:S;a=h(a,c);if(!e.length)return b!==d&&(b.lengths.length=0,b.coords.length=0),b;if(!n.length)return q(b.coords,e,0,0,p(g,e[0]),r(g,e[1])),b!==d&&
(b.lengths.length=0,b.coords.length=a),b;var f=g.scale;c=f[0];for(var f=f[1],x=0,l=0;l<n.length;l++){var k=n[l];b.lengths[l]=k;var u=p(g,e[x]),y=r(g,e[x+1]);q(b.coords,e,x,x,u,y);for(var x=x+a,v=1;v<k;v++,x+=a)u+=e[x]*c,y-=e[x+1]*f,q(b.coords,e,x,x,u,y)}b!==d&&(b.lengths.length=n.length,b.coords.length=e.length);return b}Object.defineProperty(a,"__esModule",{value:!0});var R=m.getLogger("esri.tasks.support.optimizedFeatureSet"),Q={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},
S=function(b,d,a,c,h,g){b[a]=h;b[a+1]=g},U=function(b,d,a,c,h,g){b[a]=h;b[a+1]=g;b[a+2]=d[c+2]},X=function(b,d,a,c,h,g){b[a]=h;b[a+1]=g;b[a+2]=d[c+3]},V=function(b,d,a,c,h,g){b[a]=h;b[a+1]=g;b[a+2]=d[c+2];b[a+3]=d[c+3]};a.quantizeX=d;a.quantizeY=n;a.hydrateX=p;a.hydrateY=r;a.convertToPoint=function(b,d,a){return b?d?a?A(b):u(b):a?y(b):q(b):null};a.convertFromPoint=function(b,d,a){void 0===a&&(a=D(null!=d.z,null!=d.m));return a(b,d)};a.convertToMultipoint=C;a.convertFromMultipoint=E;a.convertToPolyline=
F;a.convertFromPolyline=I;a.convertToPolygon=J;a.convertFromPolygon=G;a.convertFromNestedArray=H;var ca=[],Y=[];a.convertFromFeature=function(b,d,a,c,h){ca[0]=b;b=K(Y,ca,d,a,c,h)[0];ca.length=Y.length=0;return b};a.convertFromFeatures=K;a.convertToFeature=function(b,d,a,c){Y[0]=b;O(ca,Y,d,a,c);b=ca[0];ca.length=Y.length=0;return b};a.convertFromGeometry=function(b,d,a){if(!b)return null;var g=new c.default;"hasZ"in b&&null==d&&(d=b.hasZ);"hasM"in b&&null==a&&(a=b.hasM);if(k.isPoint(b))return D(null!=
d?d:null!=b.z,null!=a?a:null!=b.m)(g,b);if(k.isPolygon(b))return G(g,b,d,a);if(k.isPolyline(b))return I(g,b,h(d,a));if(k.isMultipoint(b))return E(g,b,h(d,a));R.error("convertFromGeometry:unknown-geometry",new e("Unable to parse unknown geometry type '"+b+"'"))};a.convertToGeometry=function(b,d,a,c){b=b&&("coords"in b?b:b.geometry);if(!b)return null;switch(d){case "esriGeometryPoint":return d=q,a&&c?d=A:a?d=u:c&&(d=y),d(b);case "esriGeometryMultipoint":return C(b,a,c);case "esriGeometryPolyline":return F(b,
a,c);case "esriGeometryPolygon":return J(b,a,c);default:R.error("convertToGeometry:unknown-geometry",new e("Unable to parse unknown geometry type '"+d+"'"))}};a.convertToFeatures=O;a.convertToFeatureSet=function(b){var d=b.objectIdFieldName,a=b.spatialReference,c=b.transform,h=b.fields,g=b.hasM,e=b.hasZ,n=b.geometryType,q=b.exceededTransferLimit;b={features:O([],b.features,n,e,g),fields:h,geometryType:n,objectIdFieldName:d,spatialReference:a};c&&(b.transform=c);q&&(b.exceededTransferLimit=q);g&&(b.hasM=
g);e&&(b.hasZ=e);return b};a.convertFromFeatureSet=function(b,d){var a=new g.default,c=b.hasM,h=b.hasZ,n=b.features,q=b.objectIdFieldName,p=b.spatialReference,f=b.geometryType,r=b.exceededTransferLimit,x=b.transform;a.fields=b.fields;a.geometryType=f;a.objectIdFieldName=q||d;a.spatialReference=p;if(!a.objectIdFieldName)return R.error(new e("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),a;n&&K(a.features,n,f,h,c,a.objectIdFieldName);r&&(a.exceededTransferLimit=r);c&&
(a.hasM=c);h&&(a.hasZ=h);x&&(a.transform=x);return a};a.hydrateOptimizedFeatureSet=function(b){var d=b.transform,a=b.hasM,c=b.hasZ;if(!d)return b;for(var h=0,g=b.features;h<g.length;h++){var e=g[h];e.geometry&&T(e.geometry,e.geometry,a,c,d);e.centroid&&T(e.centroid,e.centroid,a,c,d)}b.transform=null;return b};a.quantizeOptimizedFeatureSet=function(b,d){var a=d.geometryType,h=d.features,g=d.hasM,e=d.hasZ;if(!b)return d;for(var n=0;n<h.length;n++){var q=h[n],p=new l.default(new c.default,q.attributes);
L(p.geometry,q.geometry,g,e,a,b);q.centroid&&(p.centroid=new c.default,L(p.centroid,q.centroid,g,e,"esriGeometryPoint",b));h[n]=p}d.transform=b;return d};a.quantizeOptimizedGeometry=L;a.generalizeOptimizedGeometry=function(d,a,c,g,e,n,q,p){void 0===q&&(q=c);void 0===p&&(p=g);d.lengths.length&&(d.lengths.length=0);d.coords.length&&(d.coords.length=0);if(!a||!a.coords.length)return null;e=Q[e];var f=a.coords;a=a.lengths;var r=h(c,g),x=h(c&&q,g&&p);c=b(c,g,q,p);if(!a.length)return c(d.coords,f,0,0,f[0],
f[1]),d.lengths.length&&(d.lengths.length=0),d.coords.length=r,d;g=0;n*=n;for(q=0;q<a.length;q++){p=a[q];if(!(p<e)){var l=d.coords.length/x,k=g,u=g+(p-1)*r;c(d.coords,f,d.coords.length,k,f[k],f[k+1]);N(d.coords,f,r,n,c,k,u);c(d.coords,f,d.coords.length,u,f[u],f[u+1]);k=d.coords.length/x-l;k>=e?d.lengths.push(k):d.coords.length=l*x}g+=p*r}return d.coords.length?d:null};a.getBoundsOptimizedGeometry=function(b,d,a,c){a=h(a,c);var g=c=Number.POSITIVE_INFINITY,e=Number.NEGATIVE_INFINITY,n=Number.NEGATIVE_INFINITY;
if(d&&d.coords){d=d.coords;for(var q=0;q<d.length;q+=a){var p=d[q],f=d[q+1];c=Math.min(c,p);e=Math.max(e,p);g=Math.min(g,f);n=Math.max(n,f)}}b[0]=c;b[1]=g;b[2]=e;b[3]=n;return b};a.getQuantizedBoundsOptimizedGeometry=function(b,d,a,c){a=h(a,c);c=d.coords;var g=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,q=Number.NEGATIVE_INFINITY,p=0,f=0;for(d=d.lengths;f<d.length;f++)for(var r=d[f],x=c[p],l=c[p+1],g=Math.min(x,g),e=Math.min(l,e),n=Math.max(x,n),q=Math.max(l,q),
p=p+a,k=1;k<r;k++,p+=a){var u=c[p],y=c[p+1],x=x+u,l=l+y;0>u&&(g=Math.min(g,x));0<u&&(n=Math.max(n,x));0>y?e=Math.min(e,l):0<y&&(q=Math.max(q,l))}b[0]=g;b[1]=e;b[2]=n;b[3]=q;return b};a.hydrateOptimizedGeometry=T;a.removeZMValues=function(d,a,c,g,e,n){var q,p=h(c,g);c=b(c,g,e,n);g=a.coords;d.coords.length=0;d.lengths.length=0;(q=d.lengths).push.apply(q,a.lengths);for(a=0;a<g.length;a+=p)c(d.coords,g,d.coords.length,a,g[a],g[a+1]);return d};a.removeCollinearVectices=function(d,a,c,g,e){if(!a||!a.coords||
!a.coords.length)return null;c=Q[c];var n=a.coords;a=a.lengths;var q=b(g,e,g,e);g=h(g,e);for(var p=e=0,f=0,r=0,x=0;x<a.length;x++){var l=a[x],p=r;q(d.coords,n,p,e,n[e],n[e+1]);e+=g;var k=n[e],u=n[e+1],y=k,v=u,m=u/k,p=p+g;q(d.coords,n,p,e,y,v);e+=g;for(var z=2;z<l;z++){var k=n[e],u=n[e+1],A=u/k,B=m===A||!isFinite(m)&&!isFinite(A),m=B&&isFinite(A)?0<=m&&0<=A||0>=m&&0>=A:0<=v&&0<=u||0>=v&&0>=u;B&&m?(y+=k,v+=u):(y=k,v=u,p+=g);q(d.coords,n,p,e,y,v);e+=g;m=A}p+=g;l=(p-r)/g;l>=c&&(d.lengths[f]=l,r=p,f++)}d.coords.length>
r&&(d.coords.length=r);d.lengths.length>f&&(d.lengths.length=f);return d.coords.length&&d.lengths.length?d:null}})},"esri/layers/graphics/OptimizedFeature":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});f=function(){return function(a,f,k,l){void 0===a&&(a=null);void 0===f&&(f={});this.localId=0;this.geohashIndexed=!1;this.geohashY=this.geohashX=0;this.geometry=a;f&&(this.attributes=f);k&&(this.centroid=k);null!=l&&(this.objectId=l)}}();a.default=
f})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});f=function(){return function(){this.spatialReference=this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=null;this.hasM=this.hasZ=!1;this.features=[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1}}();a.default=f})},"esri/layers/graphics/OptimizedGeometry":function(){define(["require",
"exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});f=function(){return function(a,f){void 0===a&&(a=[]);void 0===f&&(f=[]);this.lengths=a;this.coords=f}}();a.default=f})},"esri/layers/ogc/ogcFeatureUtils":function(){define("require exports tslib ../../request ../../core/arrayUtils ../../core/Error ../../core/Logger ../../geometry/support/spatialReferenceUtils ../graphics/featureConversionUtils ../graphics/OptimizedFeatureSet ../graphics/data/projectionSupport ../graphics/data/projectionSupport ../graphics/sources/geojson/geojson ../graphics/sources/support/clientSideDefaults ../support/FieldsIndex ../support/fieldType ../../tasks/support/FeatureSet".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u){function v(b,d,a){return e.__awaiter(this,void 0,void 0,function(){var c;return e.__generator(this,function(g){switch(g.label){case 0:return[4,y(b,d,a)];case 1:return c=g.sent(),[2,h.convertToFeatureSet(c)]}})})}function y(a,g,q){var f;return e.__awaiter(this,void 0,void 0,function(){var r,x,l,k,u,y,v,A,B,C,E,D,S,U,X,V,ca,Y,aa,da,W,ea,pa,qa,oa,ra,va,Ca,Da,wa,Ba,xa,na;return e.__generator(this,function(F){switch(F.label){case 0:return r=a.capabilities.query.maxRecordCount,
x=a.collectionId,l=a.layerDefinition,k=a.url,u=k+"/collections/"+x+"/items",y=g.geometry,v=g.num,A=g.outSpatialReference,B=g.start,C=g.timeExtent,E=g.where,S=(D=n.project(y,c.WGS84))?D.xmin+","+D.ymin+","+D.xmax+","+D.ymax:null,U=z(C),X=E&&"1\x3d1"!==E?E:null,V=null!==B&&void 0!==B?B:0,ca=null!==v&&void 0!==v?v:null!=B&&void 0!==B?10:r,[4,m(u,e.__assign(e.__assign({},q),{query:{bbox:S,datetime:U,query:X,limit:ca,startindex:V,f:"application/geo+json"}}))];case 1:Y=F.sent().data;aa=null===(f=Y.links)||
void 0===f?void 0:f.filter(function(b){return"next"===b.rel});da=0!==(null===aa||void 0===aa?void 0:aa.length);W=l.fields;ea=l.globalIdField;pa=l.hasM;qa=l.hasZ;oa=l.objectIdField;ra=l.geometryType;va=p.createOptimizedFeatures(Y,{geometryType:ra,hasZ:qa,objectIdFieldName:oa});if(!c.equals(A,c.WGS84))for(Ca=0,Da=va;Ca<Da.length;Ca++)wa=Da[Ca],wa.geometry&&(wa.geometry=h.convertFromGeometry(d.project(h.convertToGeometry(wa.geometry,ra,qa,!1),c.WGS84,A)));Ba=0;for(xa=va;Ba<xa.length;Ba++)wa=xa[Ba],wa.objectId=
wa.attributes[oa];na=new b.default;na.exceededTransferLimit=da;na.features=va;na.fields=W;na.geometryType=ra;na.globalIdFieldName=ea;na.hasM=pa;na.hasZ=qa;na.objectIdFieldName=oa;na.spatialReference=A||c.WGS84;return[2,na]}})})}function z(b){if(!b)return null;var d=b.start;b=b.end;return(d?d.toISOString():"..")+"/"+(b?b.toISOString():"..")}Object.defineProperty(a,"__esModule",{value:!0});var A=g.getLogger("esri.layers.graphics.sources.ogcfeature");a.getCollectionDefinition=function(b,a,h,g,n){void 0===
n&&(n=5);return e.__awaiter(this,void 0,void 0,function(){var f,u,y,v,z,B,C,F,E,D,Q,S,U,X,V,ca,Y;return e.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,d.checkProjectionSupport(c.WGS84,h.spatialReference)];case 1:return e.sent(),[3,3];case 2:throw e.sent(),new l("ogc-feature-layer:projection-not-supported","Projection not supported");case 3:return f=b+"/collections/"+a+"/items",[4,m(f,{signal:g,query:{limit:n,f:"application/geo+json"}})];case 4:return u=e.sent().data,
[4,p.validateGeoJSON(u)];case 5:e.sent();y=p.inferLayerProperties(u,{geometryType:h.geometryType});v=h.fields||y.fields||[];z=null!=h.hasZ?h.hasZ:y.hasZ;B=y.geometryType;C=h.objectIdField||y.objectIdFieldName||"OBJECTID";F=h.timeInfo;E=k.find(v,function(b){return b.name===C});if(D=!E){if(!y.objectIdFieldType)throw new l("ogc-feature-layer:missing-feature-id","Collection geojson require a feature id as a unique identifier");v.unshift({name:C,alias:C,type:"esriFieldTypeOID",editable:!1,nullable:!1})}else E.type=
"esriFieldTypeOID",E.editable=!1,E.nullable=!1;C!==y.objectIdFieldName&&(Q=k.find(v,function(b){return b.name===y.objectIdFieldName}))&&(Q.type="esriFieldTypeInteger");if(!B)throw new l("ogc-feature-layer:missing-property","geometryType not set and couldn't be inferred from the provided features");v===y.fields&&0<y.unknownFields.length&&A.warn({name:"ogc-feature-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:y.unknownFields}});
S=0;for(U=v;S<U.length;S++){Q=U[S];null==Q.name&&(Q.name=Q.alias);null==Q.alias&&(Q.alias=Q.name);"esriFieldTypeOID"!==Q.type&&"esriFieldTypeGlobalID"!==Q.type&&(Q.editable=null==Q.editable?!0:!!Q.editable,Q.nullable=null==Q.nullable?!0:!!Q.nullable);if(!Q.name)throw new l("ogc-feature-layer:invalid-field-name","field name is missing",{field:Q});if(-1===x.kebabDict.jsonValues.indexOf(Q.type))throw new l("ogc-feature-layer:invalid-field-type",'invalid type for field "'+Q.name+'"',{field:Q});}F&&(X=
new q(v),F.startTimeField&&((V=X.get(F.startTimeField))?(F.startTimeField=V.name,V.type="esriFieldTypeDate"):F.startTimeField=null),F.endTimeField&&((ca=X.get(F.endTimeField))?(F.endTimeField=ca.name,ca.type="esriFieldTypeDate"):F.endTimeField=null),F.trackIdField&&((Y=X.get(F.trackIdField))?F.trackIdField=Y.name:(F.trackIdField=null,A.warn({name:"ogc-feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:F}}))),F.startTimeField||F.endTimeField||(A.warn({name:"ogc-feature-layer:invalid-timeInfo",
message:"startTimeField and endTimeField are missing",details:{timeInfo:F}}),F=null));return[2,{drawingInfo:r.createDrawingInfo(B),geometryType:B,fields:v,hasZ:!!z,objectIdField:C,timeInfo:F}]}})})};a.getServerCollection=function(b,d,a,c){return e.__awaiter(this,void 0,void 0,function(){var h,g;return e.__generator(this,function(e){switch(e.label){case 0:return h=b+"/collections/"+d,[4,m(h,{signal:c,query:{f:a}})];case 1:return g=e.sent().data,[2,g]}})})};a.getServerCollections=function(b,d,a){return e.__awaiter(this,
void 0,void 0,function(){var c,h;return e.__generator(this,function(g){switch(g.label){case 0:return c=b+"/collections",[4,m(c,{signal:a,query:{f:d}})];case 1:return h=g.sent().data,[2,h]}})})};a.getServerConformance=function(b,d,a){return e.__awaiter(this,void 0,void 0,function(){var c,h;return e.__generator(this,function(g){switch(g.label){case 0:return c=b+"/conformance",[4,m(c,{signal:a,query:{f:d}})];case 1:return h=g.sent().data,[2,h]}})})};a.getServerLandingPage=function(b,d,a){return e.__awaiter(this,
void 0,void 0,function(){var c;return e.__generator(this,function(h){switch(h.label){case 0:return[4,m(b,{signal:a,query:{f:d}})];case 1:return c=h.sent().data,[2,c]}})})};a.queryFeatureSet=function(b,d,a){return e.__awaiter(this,void 0,void 0,function(){var c;return e.__generator(this,function(h){switch(h.label){case 0:return[4,v(b,d,a)];case 1:return c=h.sent(),[2,u.fromJSON(c)]}})})};a.queryFeatureSetJSON=v;a.queryOptimizedFeatureSet=y})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports tslib ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(f,a,e,m,k,l,g,c,h){function b(b,a){var c;if(!a)return null;if("x"in a){var h={x:0,y:0};b=b(a.x,a.y,r);h.x=b[0];h.y=b[1];null!=a.z&&(h.z=a.z);null!=a.m&&(h.m=a.m);return h}if("xmin"in a)return h={xmin:0,ymin:0,xmax:0,ymax:0},c=b(a.xmin,a.ymin,r),h.xmin=c[0],h.ymin=c[1],b=b(a.xmax,a.ymax,r),h.xmax=b[0],h.ymax=b[1],a.hasZ&&(h.zmin=a.zmin,h.zmax=a.zmax,h.hasZ=!0),a.hasM&&(h.mmin=a.mmin,h.mmax=a.mmax,h.hasM=!0),h;if("rings"in a)return{rings:d(a.rings,b),hasM:a.hasM,hasZ:a.hasZ};if("paths"in a)return{paths:d(a.paths,
b),hasM:a.hasM,hasZ:a.hasZ};if("points"in a)return{points:n(a.points,b),hasM:a.hasM,hasZ:a.hasZ}}function d(b,a){for(var d=[],c=0;c<b.length;c++)d.push(n(b[c],a));return d}function n(b,a){for(var d=[],c=0;c<b.length;c++){var h=b[c],g=a(h[0],h[1],[0,0]);d.push(g);2<h.length&&g.push(h[2]);3<h.length&&g.push(h[3])}return d}function p(b,a){return!c.isValid(b)||!c.isValid(a)||c.equals(b,a)||h.canProject(b,a)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});var r=[0,0];a.doesBrowserSupportProjection=
function(b,a){return p(b,a)?l.isSupported():!0};a.checkProjectionSupport=function(b,a){return e.__awaiter(this,void 0,void 0,function(){var d,c,h;return e.__generator(this,function(g){if(!a)return[2];if(Array.isArray(b)){d=0;for(c=b;d<c.length;d++)if(h=c[d],p(h.geometry&&h.geometry.spatialReference,a)){if(l.isSupported())return[2,l.load()];throw new m("feature-store:unsupported-query","projection not supported",{inSpatialReference:b,outSpatialReference:a});}return[2]}if(!p(b,a))return[2];if(l.isSupported())return[2,
l.load()];throw new m("feature-store:unsupported-query","projection not supported",{inSpatialReference:b,outSpatialReference:a});})})};var q=b.bind(null,h.lngLatToXY),x=b.bind(null,h.xyToLngLat);a.project=function(b,a,d){if(!b)return b;d||(d=a,a=b.spatialReference);return c.isValid(a)&&c.isValid(d)&&!c.equals(a,d)?h.canProject(a,d)?c.isWebMercator(d)?q(b):x(b):l.projectMany(g.jsonAdapter,[b],a,d,null)[0]:b};var u=new (function(){function b(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}
b.prototype.push=function(b,a,d){return e.__awaiter(this,void 0,void 0,function(){var h,g=this;return e.__generator(this,function(e){b&&b.length&&a&&d&&!c.equals(a,d)||k.resolve(b);h={geometries:b,inSpatialReference:a,outSpatialReference:d,resolve:null};this._jobs.push(h);return[2,k.create(function(b){h.resolve=b;null===g._timer&&(g._timer=setTimeout(g._process,10))})]})})};b.prototype._process=function(){this._timer=null;var b=this._jobs.shift();if(b){var a=b.geometries,d=b.inSpatialReference,e=
b.outSpatialReference,b=b.resolve;h.canProject(d,e)?c.isWebMercator(e)?b(a.map(q)):b(a.map(x)):b(l.projectMany(g.jsonAdapter,a,d,e,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return b}());a.projectMany=function(b,a,d){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(c){return[2,u.push(b,a,d)]})})}})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./support/GeographicTransformation @dojo/framework/shim/Promise".split(" "),
function(f,a,e,m,k){function l(b,a,h,e,f){void 0===f&&(f=null);if(null===f){var n=k.cacheKey(h,e);void 0!==d[n]?f=d[n]:(f=g(h,e,null),null===f&&(f=new k),d[n]=f)}return c._project(b,a,h,e,f)}function g(b,a,d){void 0===d&&(d=null);b=c._getTransformation(h,b,a,d,null===d||void 0===d?void 0:d.spatialReference);return null!==b?k.fromGE(b):null}Object.defineProperty(a,"__esModule",{value:!0});var c=null,h=null;a.isLoaded=function(){return!!c&&m.isLoaded()};a.isSupported=function(){return m.isSupported()};
var b=null;a.load=function(){return b?b:b=e.all([m.load(),new Promise(function(b,a){f(["./geometryEngineBase"],b,a)}),new Promise(function(b,a){f(["./geometryAdapters/hydrated"],b,a)})]).then(function(b){var a=b[1];h=b[2].hydratedAdapter;c=a;c._enableProjection(m)})};a.project=function(b,a,d){void 0===d&&(d=null);return b instanceof Array?0===b.length?[]:l(h,b,b[0].spatialReference,a,d):l(h,[b],b.spatialReference,a,d)[0]};var d={};a.projectMany=l;a.getTransformation=g;a.getTransformations=function(b,
a,d){void 0===d&&(d=null);b=c._getTransformationBySuitability(h,b,a,d,null===d||void 0===d?void 0:d.spatialReference);if(null!==b){a=[];for(d=0;d<b.length;d++)a.push(k.fromGE(b[d]));return a}return[]}})},"esri/geometry/pe":function(){define("require exports tslib ../assets ../core/has ../core/promiseUtils @dojo/framework/shim/Promise".split(" "),function(f,a,e,m,k,l){function g(b){function c(b,a,d){b[a]=d(b[a])}a._pe=b;p.init();r.init();q.init();x.init();u.init();a.PeGCSExtent=function(b){function d(){return null!==
b&&b.apply(this,arguments)||this}e.__extends(d,b);d.prototype.destroy=function(){a._pe.destroy(this)};return d}(a._pe.PeGCSExtent);for(var h=0,g=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,a._pe.PeUnit];h<g.length;h++)b=g[h],c(b.prototype,"getName",function(b){return function(){return b.call(this,Array(p.PE_NAME_MAX))}});h=0;for(g=[a._pe.PeGeogtran,a._pe.PeProjcs];h<g.length;h++)b=g[h],c(b.prototype,"getParameters",
function(b){return function(){for(var d=Array(p.PE_PARM_MAX),c=b.call(this),h=0;h<d.length;h++){var g=a._pe.getValue(c,"*");d[h]=g?a._pe.wrapPointer(g,a._pe.PeParameter):null;c+=Int32Array.BYTES_PER_ELEMENT}return d}});c(a._pe.PeHorizon.prototype,"getCoord",function(b){return function(){var a=this.getSize();if(!a)return null;var c=[],h=b.call(this);d(c,a,h);return c}});c(a._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(b){var d=a._pe._pe_getPeGTlistExtendedGTsSize();return function(){var c=
null,h=b.call(this);if(!a._pe.compare(h,a._pe.NULL)){var c=[h],g=this.getSteps();if(1<g)for(var h=a._pe.getPointer(h),e=1;e<g;e++)c.push(a._pe.wrapPointer(h+d*e,a._pe.PeGTlistExtendedGTs))}return c}});var n=a._pe._pe_getPeHorizonSize();b=function(b){return function(){var d=this._cache;d||(this._cache=d=new Map);if(d.has(b))return d.get(b);var c=null,h=b.call(this);if(!a._pe.compare(h,a._pe.NULL)){var c=[h],g=h.getNump();if(1<g)for(var h=a._pe.getPointer(h),e=1;e<g;e++)c.push(a._pe.wrapPointer(h+n*
e,a._pe.PeHorizon))}d.set(b,c);return c}};c(a._pe.PeProjcs.prototype,"horizonGcsGenerate",b);c(a._pe.PeProjcs.prototype,"horizonPcsGenerate",b);a._pe.PeObject.prototype.toString=function(b){void 0===b&&(b=p.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var d=a._pe.getPointer(this),c=a._pe.ensureInt8(Array(p.PE_BUFFER_MAX));return a._pe.UTF8ToString(a._pe._pe_object_to_string_ext(d,b,c))}}function c(b){if(b){var d=a._pe.getClass(b);d&&(d=a._pe.getCache(d))&&(b=a._pe.getPointer(b))&&delete d[b]}}function h(b,
d){var c=[];d=Array(d);for(var h=0;h<b;h++)c.push(a._pe.ensureInt8(d));return c}function b(b){var d;Array.isArray(b[0])?(d=[],b.forEach(function(b){d.push(b[0],b[1])})):d=b;return d}function d(b,d,c,h){void 0===h&&(h=!1);if(h)for(h=0;h<2*d;h++)b[h]=a._pe.getValue(c+h*Float64Array.BYTES_PER_ELEMENT,"double");else{var g=0===b.length;for(h=0;h<d;h++)g&&(b[h]=Array(2)),b[h][0]=a._pe.getValue(c,"double"),b[h][1]=a._pe.getValue(c+Float64Array.BYTES_PER_ELEMENT,"double"),c+=2*Float64Array.BYTES_PER_ELEMENT}}
Object.defineProperty(a,"__esModule",{value:!0});var n;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!k("esri-wasm")};a.load=function(){return n?n:n=l.create(function(b,d){(new Promise(function(b,d){f(["./support/pe-wasm"],b,d)})).then(function(a){a({locateFile:function(b){return m.getAssetUrl("esri/geometry/support/"+b)},onAbort:function(b){d(Error(b))}}).then(function(d){g(d);b()})})})};(function(c){function h(c,h,g){a._pe.ensureCache.prepare();var e=b(g),n=g===
e,e=a._pe.ensureFloat64(e);(c=a._pe._pe_geog_to_proj(a._pe.getPointer(c),h,e))&&d(g,h,e,n);return c}function g(b,d,a){return e(b,d,a,0)}function e(c,h,g,e){a._pe.ensureCache.prepare();var n=b(g),q=g===n,n=a._pe.ensureFloat64(n);(c=a._pe._pe_proj_to_geog_center(a._pe.getPointer(c),h,n,e))&&d(g,h,n,q);return c}c.geogToProj=h;c.projGeog=function(b,d,a,c){switch(c){case p.PE_TRANSFORM_P_TO_G:return g(b,d,a);case p.PE_TRANSFORM_G_TO_P:return h(b,d,a)}return 0};c.projToGeog=g;c.projToGeogCenter=e})(a.PeCSTransformations||
(a.PeCSTransformations={}));var p;(function(b){b.init=function(){b.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;b.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;b.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;b.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;b.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;b.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;b.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;b.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;b.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;b.PE_TYPE_NONE=
a._pe.PeDefs.prototype.PE_TYPE_NONE;b.PE_TYPE_GEOGCS=a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;b.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;b.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;b.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;b.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;b.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;b.PE_STR_AUTH_NONE=a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;b.PE_STR_AUTH_TOP=a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;b.PE_STR_NAME_CANON=
a._pe.PeDefs.prototype.PE_STR_NAME_CANON;b.PE_PARM_X0=a._pe.PeDefs.prototype.PE_PARM_X0;b.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;b.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;b.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;b.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;b.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;b.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;b.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;
b.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;b.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(p=a.PeDefs||(a.PeDefs={}));(function(b){function d(b,d){var g=null,e=h[b];e||(e={},h[b]=e);e.hasOwnProperty(String(d))?g=e[d]:(b=a._pe.PeFactory.prototype.factoryByType(b,d),a._pe.compare(b,a._pe.NULL)||(g=b,e[d]=g));return g=c(g)}function c(b){if(b){var d=b.getType();switch(d){case p.PE_TYPE_GEOGCS:b=a._pe.castObject(b,a._pe.PeGeogcs);break;case p.PE_TYPE_PROJCS:b=a._pe.castObject(b,
a._pe.PeProjcs);break;case p.PE_TYPE_GEOGTRAN:b=a._pe.castObject(b,a._pe.PeGeogtran);break;default:d&p.PE_TYPE_UNIT&&(b=a._pe.castObject(b,a._pe.PeUnit))}}return b}var h={},g={};b.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};b.coordsys=function(b){return d(p.PE_TYPE_COORDSYS,b)};b.factoryByType=d;b.fromString=function(b,d){var h=null,e=g[b];e||(e={},g[b]=e);e.hasOwnProperty(d)?h=e[d]:(b=a._pe.PeFactory.prototype.fromString(b,d),a._pe.compare(b,a._pe.NULL)||(h=b,e[d]=h));return h=
c(h)};b.geogcs=function(b){return d(p.PE_TYPE_GEOGCS,b)};b.geogtran=function(b){return d(p.PE_TYPE_GEOGTRAN,b)};b.getCode=function(b){return a._pe.PeFactory.prototype.getCode(b)};b.projcs=function(b){return d(p.PE_TYPE_PROJCS,b)};b.unit=function(b){return d(p.PE_TYPE_UNIT,b)}})(a.PeFactory||(a.PeFactory={}));a.PeGCSExtent=null;var r;(function(b){var d;b.init=function(){b.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;d=a._pe._pe_getPeGTlistExtendedEntrySize()};b.getGTlist=
function(b,c,h,g,e,n){var q=null,p=new a._pe.PeInteger(n);try{var f=a._pe.PeGTlistExtended.prototype.getGTlist(b,c,h,g,e,p);if(n=p.val)if(q=[f],1<n){var r=a._pe.getPointer(f);for(b=1;b<n;b++)q.push(a._pe.wrapPointer(r+d*b,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(p)}return q}})(r=a.PeGTlistExtended||(a.PeGTlistExtended={}));(function(b){b.destroy=function(b){if(b&&b.length){for(var d=0;d<b.length;d++){var h=b[d];c(h);h.getEntries().forEach(function(b){c(b);b=b.getGeogtran();c(b);b.getParameters().forEach(c);
[b.getGeogcs1(),b.getGeogcs2()].forEach(function(b){c(b);var d=b.getDatum();c(d);c(d.getSpheroid());c(b.getPrimem());c(b.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(b[0])}}})(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));(function(c){c.geogToGeog=function(c,h,g,e,n){a._pe.ensureCache.prepare();var q=b(g),p=g===q,q=a._pe.ensureFloat64(q),f=0;e&&(f=a._pe.ensureFloat64(e));(c=a._pe._pe_geog_to_geog(a._pe.getPointer(c),h,q,f,n))&&d(g,h,q,p);return c}})(a.PeGTTransformations||
(a.PeGTTransformations={}));(function(c){function g(d,c,g,e,n,q){a._pe.ensureCache.prepare();var f,r;switch(d){case "dd":f=a._pe._pe_geog_to_dd;r=p.PE_DD_MAX;break;case "ddm":f=a._pe._pe_geog_to_ddm;r=p.PE_DDM_MAX;break;case "dms":f=a._pe._pe_geog_to_dms,r=p.PE_DMS_MAX}d=0;c&&(d=a._pe.getPointer(c));c=b(e);c=a._pe.ensureFloat64(c);r=h(g,r);e=a._pe.ensureInt32(r);if(n=f(d,g,c,n,e))for(f=0;f<g;f++)q[f]=a._pe.UTF8ToString(r[f]);return n}function e(b,c,h,g,e){a._pe.ensureCache.prepare();var n;switch(b){case "dd":n=
a._pe._pe_dd_to_geog;break;case "ddm":n=a._pe._pe_ddm_to_geog;break;case "dms":n=a._pe._pe_dms_to_geog}b=0;c&&(b=a._pe.getPointer(c));c=g.map(function(b){return a._pe.ensureString(b)});g=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*h));(n=n(b,h,g,c))&&d(e,h,c);return n}c.geog_to_dms=function(b,d,a,c,h){return g("dms",b,d,a,c,h)};c.dms_to_geog=function(b,d,a,c){return e("dms",b,d,a,c)};c.geog_to_ddm=function(b,d,a,c,h){return g("ddm",b,d,a,c,h)};c.ddm_to_geog=function(b,d,a,c){return e("ddm",
b,d,a,c)};c.geog_to_dd=function(b,d,a,c,h){return g("dd",b,d,a,c,h)};c.dd_to_geog=function(b,d,a,c){return e("dd",b,d,a,c)}})(a.PeNotationDms||(a.PeNotationDms={}));var q;(function(c){c.init=function(){c.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;c.PE_MGRS_STYLE_OLD=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;c.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;c.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;c.PE_MGRS_ADD_SPACES=
a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};c.geog_to_mgrs_extended=function(d,c,g,e,n,q,f){a._pe.ensureCache.prepare();var r=0;d&&(r=a._pe.getPointer(d));d=b(g);g=a._pe.ensureFloat64(d);d=h(c,p.PE_MGRS_MAX);var x=a._pe.ensureInt32(d);if(e=a._pe._pe_geog_to_mgrs_extended(r,c,g,e,n,q,x))for(n=0;n<c;n++)f[n]=a._pe.UTF8ToString(d[n]);return e};c.mgrs_to_geog_extended=function(b,c,h,g,e){a._pe.ensureCache.prepare();var n=0;b&&(n=a._pe.getPointer(b));b=h.map(function(b){return a._pe.ensureString(b)});
h=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(g=a._pe._pe_mgrs_to_geog_extended(n,c,h,g,b))&&d(e,c,b);return g}})(q=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(c){c.geog_to_usng=function(d,c,g,e,n,q,f){a._pe.ensureCache.prepare();var r=0;d&&(r=a._pe.getPointer(d));d=b(g);g=a._pe.ensureFloat64(d);d=h(c,p.PE_MGRS_MAX);var x=a._pe.ensureInt32(d);if(e=a._pe._pe_geog_to_usng(r,c,g,e,n,q,x))for(n=0;n<c;n++)f[n]=a._pe.UTF8ToString(d[n]);return e};c.usng_to_geog=function(b,c,h,g){a._pe.ensureCache.prepare();
var e=0;b&&(e=a._pe.getPointer(b));b=h.map(function(b){return a._pe.ensureString(b)});h=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(e=a._pe._pe_usng_to_geog(e,c,h,b))&&d(g,c,b);return e}})(a.PeNotationUsng||(a.PeNotationUsng={}));var x;(function(c){c.init=function(){c.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;c.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;c.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};c.geog_to_utm=function(d,
c,g,e,n){a._pe.ensureCache.prepare();var q=0;d&&(q=a._pe.getPointer(d));d=b(g);g=a._pe.ensureFloat64(d);d=h(c,p.PE_UTM_MAX);var f=a._pe.ensureInt32(d);if(e=a._pe._pe_geog_to_utm(q,c,g,e,f))for(q=0;q<c;q++)n[q]=a._pe.UTF8ToString(d[q]);return e};c.utm_to_geog=function(b,c,h,g,e){a._pe.ensureCache.prepare();var n=0;b&&(n=a._pe.getPointer(b));b=h.map(function(b){return a._pe.ensureString(b)});h=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(g=a._pe._pe_utm_to_geog(n,c,h,g,b))&&d(e,c,b);return g}})(x=
a.PeNotationUtm||(a.PeNotationUtm={}));var u;(function(b){var d=new Map;b.init=function(){b.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;b.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;b.PE_POLE_OUTSIDE_BOUNDARY=a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;b.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};b.generate=function(c,h){void 0===h&&(h=b.PE_PCSINFO_OPTION_DOMAIN);var g,e;d.has(c)&&(e=d.get(c),e[h]&&(g=e[h]));g||(g=a._pe.PePCSInfo.prototype.generate(c,
h),e||(e=[],d.set(c,e)),e[h]=g);return g}})(u=a.PePCSInfo||(a.PePCSInfo={}));(function(b){b.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||(a.PeVersion={}));a._init=g})},"esri/geometry/support/GeographicTransformation":function(){define(["require","exports","./GeographicTransformationStep"],function(f,a,e){return function(){function a(a){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(a&&a.steps){var f=0;for(a=a.steps;f<
a.length;f++){var g=a[f];g instanceof e?this.steps.push(g):this.steps.push(new e({wkid:g.wkid,wkt:g.wkt,isInverse:g.isInverse}))}}}a.cacheKey=function(a,e){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==e.wkid&&null!==e.wkid?e.wkid.toString():"-1",void 0!==e.wkt&&null!==e.wkt?e.wkt.toString():""].join()};a.fromGE=function(f){var l=new a,g="",c=0;for(f=f.steps;c<f.length;c++){var h=e.fromGE(f[c]);l.steps.push(h);g+=h.uid.toString()+
","}l._cached_projection={};l._gtlistentry=null;l._chain=g;return l};a.prototype.getInverse=function(){var e=new a;e.steps=[];for(var f=this.steps.length-1;0<=f;f--)e.steps.push(this.steps[f].getInverse());return e};a.prototype.getGTListEntry=function(){for(var a="",e=0,g=this.steps;e<g.length;e++)a+=g[e].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};a.prototype.assignCachedGe=function(e,f,g){this._cached_projection[a.cacheKey(e,
f)]=g};a.prototype.getCachedGeTransformation=function(e,f){for(var g="",c=0,h=this.steps;c<h.length;c++)g+=h[c].uid.toString()+",";g!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=g);e=this._cached_projection[a.cacheKey(e,f)];return void 0===e?null:e};return a}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(f,a){var e=0;return function(){function a(a){void 0===a&&(a=null);this.uid=e++;a?(this._wkt=void 0!==
a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(e){var f=new a;f._wkt=e.wkt;f._wkid=e.wkid;f._isInverse=e.isInverse;return f};Object.defineProperty(a.prototype,"wkt",{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=e++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},set:function(a){this._wkid=
a;this.uid=e++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=e++},enumerable:!0,configurable:!0});a.prototype.getInverse=function(){var e=new a;e._wkt=this.wkt;e._wkid=this._wkid;e._isInverse=!this.isInverse;return e};return a}()})},"esri/geometry/geometryAdapters/json":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});a.jsonAdapter=
{convertToGEGeometry:function(a,h){return null==h?null:a.convertJSONToGeometry(h)},exportPoint:function(a,h,b){b=new e(a.getPointX(h),a.getPointY(h),b);var d=a.hasZ(h),c=a.hasM(h);d&&(b.z=a.getPointZ(h));c&&(b.m=a.getPointM(h));return b},exportPolygon:function(a,h,b){return new m(a.exportPaths(h),b,a.hasZ(h),a.hasM(h))},exportPolyline:function(a,h,b){return new k(a.exportPaths(h),b,a.hasZ(h),a.hasM(h))},exportMultipoint:function(a,h,b){return new l(a.exportPoints(h),b,a.hasZ(h),a.hasM(h))},exportExtent:function(a,
h,b){var d=a.hasZ(h),c=a.hasM(h);b=new g(a.getXMin(h),a.getYMin(h),a.getXMax(h),a.getYMax(h),b);d&&(d=a.getZExtent(h),b.zmin=d.vmin,b.zmax=d.vmax);c&&(a=a.getMExtent(h),b.mmin=a.vmin,b.mmax=a.vmax);return b}};var e=function(){return function(a,h,b){this.x=a;this.y=h;this.spatialReference=b;this.m=this.z=void 0}}(),m=function(){return function(a,h,b,d){this.rings=a;this.spatialReference=h;this.hasM=this.hasZ=void 0;b&&(this.hasZ=b);d&&(this.hasM=d)}}(),k=function(){return function(a,h,b,d){this.paths=
a;this.spatialReference=h;this.hasM=this.hasZ=void 0;b&&(this.hasZ=b);d&&(this.hasM=d)}}(),l=function(){return function(a,h,b,d){this.points=a;this.spatialReference=h;this.hasM=this.hasZ=void 0;b&&(this.hasZ=b);d&&(this.hasM=d)}}(),g=function(){return function(a,h,b,d,g){this.xmin=a;this.ymin=h;this.xmax=b;this.ymax=d;this.spatialReference=g;this.mmax=this.mmin=this.zmax=this.zmin=void 0}}()})},"esri/layers/graphics/sources/geojson/geojson":function(){define("require exports tslib ../../../../core/Error ../../OptimizedFeature ../../OptimizedGeometry".split(" "),
function(f,a,e,m,k,l){function g(b){var a=[];b.forEach(function(b){return a.push(b)});return a}function c(b){var a,d,c,h;return e.__generator(this,function(g){switch(g.label){case 0:a=b.type;switch(a){case "Feature":return[3,1];case "FeatureCollection":return[3,3]}return[3,7];case 1:return[4,b];case 2:return g.sent(),[3,7];case 3:d=0,c=b.features,g.label=4;case 4:return d<c.length?(h=c[d])?[4,h]:[3,6]:[3,7];case 5:g.sent(),g.label=6;case 6:return d++,[3,4];case 7:return[2]}})}function h(b){var a,
d,c,h,g,n,q,f,p,r;return e.__generator(this,function(x){switch(x.label){case 0:if(!b)return[2,null];a=b.type;switch(a){case "Point":return[3,1];case "LineString":return[3,3];case "MultiPoint":return[3,3];case "MultiLineString":return[3,5];case "Polygon":return[3,5];case "MultiPolygon":return[3,10]}return[3,17];case 1:return[4,b.coordinates];case 2:return x.sent(),[3,17];case 3:return[5,e.__values(b.coordinates)];case 4:return x.sent(),[3,17];case 5:d=0,c=b.coordinates,x.label=6;case 6:if(!(d<c.length))return[3,
9];h=c[d];return[5,e.__values(h)];case 7:x.sent(),x.label=8;case 8:return d++,[3,6];case 9:return[3,17];case 10:g=0,n=b.coordinates,x.label=11;case 11:if(!(g<n.length))return[3,16];q=n[g];f=0;p=q;x.label=12;case 12:if(!(f<p.length))return[3,15];r=p[f];return[5,e.__values(r)];case 13:x.sent(),x.label=14;case 14:return f++,[3,12];case 15:return g++,[3,11];case 16:return[3,17];case 17:return[2]}})}function b(b,a){var d,c,h,g,n,q,f,p,x,u;void 0===a&&(a={});return e.__generator(this,function(e){switch(e.label){case 0:d=
a.geometryType,c=a.objectIdFieldName,e.label=1;case 1:h=b.next();g=h.value;if(n=h.done)return[2];q=g.geometry;f=g.properties;p=g.id;if(q&&v[q.type]!==d)return[3,1];x=f||{};c&&null!=p&&!x[c]&&(x[c]=p);u=new k.default(q?r(new l.default,q,a):null,x);return[4,u];case 2:return e.sent(),[3,1];case 3:return[2]}})}function d(b){for(;;){var a=b.next();if(a.done)return!1;if(2<a.value.length)return!0}}function n(b){for(var a=0,d=0;d<b.length;d++)var c=b[d],h=b[(d+1)%b.length],a=a+(c[0]*h[1]-h[0]*c[1]);return 0>=
a}function p(b){var a=b[0],d=b[b.length-1];a[0]===d[0]&&a[1]===d[1]&&a[2]===d[2]||b.push(a);return b}function r(b,a,d){switch(a.type){case "LineString":return q(b,a.coordinates,d),b;case "MultiLineString":var c=0;for(a=a.coordinates;c<a.length;c++)q(b,a[c],d);return b;case "MultiPoint":return q(b,a.coordinates,d),b;case "MultiPolygon":c=0;for(a=a.coordinates;c<a.length;c++){var h=a[c],g=b,e=d,f=p(h[0]);n(f)?q(g,f,e):x(g,f,e);for(g=1;g<h.length;g++){var e=b,f=d,r=p(h[g]);n(r)?x(e,r,f):q(e,r,f)}}return b;
case "Point":return u(b,a.coordinates,d),b;case "Polygon":c=a.coordinates;a=p(c[0]);n(a)?q(b,a,d):x(b,a,d);for(a=1;a<c.length;a++)h=b,g=d,e=p(c[a]),n(e)?x(h,e,g):q(h,e,g);return b}}function q(b,a,d){for(var c=0;c<a.length;c++)u(b,a[c],d);b.lengths.push(a.length)}function x(b,a,d){for(var c=a.length-1;0<=c;c--)u(b,a[c],d);b.lengths.push(a.length)}function u(b,a,d){var c=a[2];b.coords.push(a[0],a[1]);d.hasZ&&b.coords.push(c||0)}Object.defineProperty(a,"__esModule",{value:!0});var v={LineString:"esriGeometryPolyline",
MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};a.validateGeoJSON=function(b){if(!b)throw new m("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==b.type&&"FeatureCollection"!==b.type)throw new m("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:b});if(b=b.crs){var a="string"===typeof b?b:"name"===b.type?b.properties.name:null,
d=/.*(CRS84H?|4326)$/i;if(!a||!d.test(a))throw new m("geojson-layer:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:b});}};a.inferLayerProperties=function(b,a){void 0===a&&(a={});var e=c(b),n=[],q=new Set,f=new Set,p=!1,r=Number.NEGATIVE_INFINITY,x=null,l=!1,u=void 0;b=a.geometryType;var k=void 0===b?null:b,m=!1;for(b=function(){var b=e.next(),a=b.value;if(b.done){var c=x&&1===x.length&&x[0]||null;if(c)for(a=0;a<n.length;a++)b=n[a],b.name===c&&(b.type="esriFieldTypeOID");return{value:{fields:n,
geometryType:k,hasZ:p,maxObjectId:Math.max(0,r),objectIdFieldName:c,objectIdFieldType:u,unknownFields:g(f)}}}var b=a.geometry,y=a.properties,z=a.id;if(b&&(k||(k=v[b.type]),v[b.type]!==k))return"continue";p||(a=h(b),p=d(a));!l&&(l=null!=z)&&(u=typeof z,"number"===u&&(x=Object.keys(y).filter(function(b){return y[b]===z})));l&&"number"===u&&null!=z&&(r=Math.max(r,z),1<x.length?x=x.filter(function(b){return y[b]===z}):1===x.length&&(x=y[x[0]]===z?x:[]));if(!m&&y){a=!0;for(c in y)if(!q.has(c))if(b=y[c],
null==b)a=!1,f.add(c);else{a:switch(typeof b){case "string":b="esriFieldTypeString";break a;case "number":b="esriFieldTypeDouble";break a;default:b="unknown"}"unknown"===b?f.add(c):(f.delete(c),q.add(c),n.push({name:c,alias:c,type:b}))}m=a}};;)if(a=b(),"object"===typeof a)return a.value};a.createOptimizedFeatures=function(a,d){a:for(a=b(c(a),d),d=[];;){var h=a.next(),g=h.value;if(h.done)break a;d.push(g)}return d}})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define("require exports tslib ../../../../core/has ../../../../core/lang ../../../../symbols/support/defaultsJSON".split(" "),
function(f,a,e,m,k,l){Object.defineProperty(a,"__esModule",{value:!0});a.createDrawingInfo=function(a){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===a||"esriGeometryMultipoint"===a?l.defaultPointSymbolJSON:"esriGeometryPolyline"===a?l.defaultPolylineSymbolJSON:l.defaultPolygonSymbolJSON}}};a.createDefaultAttributesFunction=function(a,c){if(m("csp-restrictions"))return function(){var b;return e.__assign((b={},b[c]=null,b),a)};try{var h="this."+c+" \x3d null;",b;for(b in a)h+="this."+
b+" \x3d "+JSON.stringify(a[b])+";";var d=new Function(h);return function(){return new d}}catch(n){return function(){var b;return e.__assign((b={},b[c]=null,b),a)}}};a.createDefaultTemplate=function(a){void 0===a&&(a={});return[{name:"New Feature",description:"",prototype:{attributes:k.clone(a)}}]}})},"esri/symbols/support/defaultsJSON":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});a.defaultColor=[252,146,31,255];a.defaultOutlineColor=[153,
153,153,255];a.defaultPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",size:6,color:a.defaultColor,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}};a.defaultPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",width:.75,color:a.defaultColor};a.defaultPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}};a.defaultTextSymbolJSON={type:"esriTS",color:[255,255,
255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0};a.errorPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5};a.errorPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5};a.errorPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}})},"esri/layers/support/FieldsIndex":function(){define(["require",
"exports"],function(f,a){return function(){function a(a){this.fields=a;this._fieldsMap=new Map;this._dateFieldsSet=new Set;this.dateFields=[];if(a){for(var e=[],f=0;f<a.length;f++){var g=a[f],c=g&&g.name;if(c){var h=c.toLowerCase().trim();this._fieldsMap.set(c,g);this._fieldsMap.set(h,g);e.push(h);if("date"===g.type||"esriFieldTypeDate"===g.type)this.dateFields.push(g),this._dateFieldsSet.add(g)}}e.sort();this.uid=e.join(",")}}a.prototype.destroy=function(){this._fieldsMap.clear()};a.prototype.has=
function(a){return null!=this.get(a)};a.prototype.get=function(a){return null!=a?this._fieldsMap.get(a)||this._fieldsMap.get(a.toLowerCase().trim()):void 0};a.prototype.isDateField=function(a){return this._dateFieldsSet.has(this.get(a))};a.prototype.normalizeFieldName=function(a){if(a=this.get(a))return a.name};return a}()})},"esri/layers/support/fieldType":function(){define(["require","exports","../../core/jsonMap"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.kebabDict=new e.default({esriFieldTypeSmallInteger:"small-integer",
esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"})})},"esri/tasks/support/FeatureSet":function(){define("require exports tslib ../../geometry ../../Graphic ../../core/jsonMap ../../core/JSONSupport ../../core/maybe ../../core/accessorSupport/decorators ../../geometry/SpatialReference ../../geometry/support/jsonUtils ../../layers/support/Field".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n){var p=new l.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"});f=function(a){function g(b){b=a.call(this,b)||this;b.displayFieldName=null;b.exceededTransferLimit=!1;b.features=[];b.fields=null;b.geometryType=null;b.hasM=!1;b.hasZ=!1;b.queryGeometry=null;b.spatialReference=null;return b}e.__extends(g,a);g.prototype.readFeatures=function(a,d){d=
b.fromJSON(d.spatialReference);for(var h=[],g=0;g<a.length;g++){var e=a[g],n=k.fromJSON(e),e=e.geometry&&e.geometry.spatialReference;c.isSome(n.geometry)&&!e&&(n.geometry.spatialReference=d);h.push(n)}return h};g.prototype.writeGeometryType=function(b,a,d,h){if(b)p.write(b,a,d,h);else if(b=this.features)for(var g=0;g<b.length;g++){var e=b[g];if(e&&c.isSome(e.geometry)){p.write(e.geometry.type,a,d,h);break}}};g.prototype.writeSpatialReference=function(b,a){if(b)a.spatialReference=b.toJSON();else if(b=
this.features)for(var d=0;d<b.length;d++){var h=b[d];h&&c.isSome(h.geometry)&&h.geometry.spatialReference&&(a.spatialReference=h.geometry.spatialReference.toJSON())}};g.prototype.toJSON=function(b){var a=this.write(null);if(a.features&&Array.isArray(b)&&0<b.length)for(var d=0;d<a.features.length;d++){var c=a.features[d];if(c.geometry){var h=b&&b[d];c.geometry=h&&h.toJSON()||c.geometry}}return a};g.prototype.quantize=function(b){for(var a=b.scale,d=a[0],h=a[1],a=b.translate,g=a[0],e=a[1],a=this.features,
n=this._getQuantizationFunction(this.geometryType,function(b){return Math.round((b-g)/d)},function(b){return Math.round((e-b)/h)}),f=0,q=a.length;f<q;f++)n(c.unwrap(a[f].geometry))||(a.splice(f,1),f--,q--);this.transform=b;return this};g.prototype.unquantize=function(){var b=this.features,a=this.transform;if(!a)return this;for(var d=a.translate,h=d[0],g=d[1],a=a.scale,e=a[0],n=a[1],a=this._getHydrationFunction(this.geometryType,function(b){return b*e+h},function(b){return g-b*n}),d=0;d<b.length;d++){var f=
b[d].geometry;c.isSome(f)&&a(f)}return this};g.prototype._quantizePoints=function(b,a,d){for(var c,h,g=[],e=0,n=b.length;e<n;e++){var f=b[e];if(0<e){var q=a(f[0]),f=d(f[1]);if(q!==c||f!==h)g.push([q-c,f-h]),c=q,h=f}else c=a(f[0]),h=d(f[1]),g.push([c,h])}return 0<g.length?g:null};g.prototype._getQuantizationFunction=function(b,a,c){var h=this;return"point"===b?function(b){b.x=a(b.x);b.y=c(b.y);return b}:"polyline"===b||"polygon"===b?function(b){for(var g=d.isPolygon(b)?b.rings:b.paths,e=[],n=0,f=g.length;n<
f;n++){var q=h._quantizePoints(g[n],a,c);q&&e.push(q)}return 0<e.length?(d.isPolygon(b)?b.rings=e:b.paths=e,b):null}:"multipoint"===b?function(b){var d;d=h._quantizePoints(b.points,a,c);return 0<d.length?(b.points=d,b):null}:"extent"===b?function(b){return b}:null};g.prototype._getHydrationFunction=function(b,a,c){if("point"===b)return function(b){b.x=a(b.x);b.y=c(b.y)};if("polyline"===b||"polygon"===b)return function(b){b=d.isPolygon(b)?b.rings:b.paths;for(var h,g,e=0,n=b.length;e<n;e++)for(var f=
b[e],q=0,p=f.length;q<p;q++){var r=f[q];0<q?(h+=r[0],g+=r[1]):(h=r[0],g=r[1]);r[0]=a(h);r[1]=c(g)}};if("extent"===b)return function(b){b.xmin=a(b.xmin);b.ymin=c(b.ymin);b.xmax=a(b.xmax);b.ymax=c(b.ymax)};if("multipoint"===b)return function(b){b=b.points;for(var d,h,g=0,e=b.length;g<e;g++){var n=b[g];0<g?(d+=n[0],h+=n[1]):(d=n[0],h=n[1]);n[0]=a(d);n[1]=c(h)}}};e.__decorate([h.property({type:String,json:{write:!0}})],g.prototype,"displayFieldName",void 0);e.__decorate([h.property({type:Boolean,json:{write:{overridePolicy:function(b){return{enabled:b}}}}})],
g.prototype,"exceededTransferLimit",void 0);e.__decorate([h.property({type:[k],json:{write:!0}})],g.prototype,"features",void 0);e.__decorate([h.reader("features")],g.prototype,"readFeatures",null);e.__decorate([h.property({type:[n],json:{write:!0}})],g.prototype,"fields",void 0);e.__decorate([h.property({type:"point multipoint polyline polygon extent mesh".split(" "),json:{read:{reader:p.read}}})],g.prototype,"geometryType",void 0);e.__decorate([h.writer("geometryType")],g.prototype,"writeGeometryType",
null);e.__decorate([h.property({type:Boolean,json:{write:{overridePolicy:function(b){return{enabled:b}}}}})],g.prototype,"hasM",void 0);e.__decorate([h.property({type:Boolean,json:{write:{overridePolicy:function(b){return{enabled:b}}}}})],g.prototype,"hasZ",void 0);e.__decorate([h.property({types:m.geometryTypes,json:{read:d.fromJSON,write:!0}})],g.prototype,"queryGeometry",void 0);e.__decorate([h.property({type:b,json:{write:!0}})],g.prototype,"spatialReference",void 0);e.__decorate([h.writer("spatialReference")],
g.prototype,"writeSpatialReference",null);e.__decorate([h.property({json:{write:!0}})],g.prototype,"transform",void 0);return g=e.__decorate([h.subclass("esri.tasks.support.FeatureSet")],g)}(g.JSONSupport);f.prototype.toJSON.isDefaultToJSON=!0;(function(b){})(f||(f={}));return f})},"esri/Graphic":function(){define("require exports tslib ./geometry ./PopupTemplate ./symbols ./core/JSONSupport ./core/lang ./core/maybe ./core/accessorSupport/decorators ./geometry/support/jsonUtils ./symbols/support/jsonUtils".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n){f=function(a){function g(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];b=a.apply(this,b)||this;b.layer=null;b.popupTemplate=null;b.sourceLayer=null;Object.defineProperty(b,"uid",{value:f.generateUID()});return b}e.__extends(g,a);f=g;g.prototype.normalizeCtorArgs=function(b,a,d,c){return b&&!b.declaredClass?b:{geometry:b,symbol:a,attributes:d,popupTemplate:c}};Object.defineProperty(g.prototype,"attributes",{set:function(b){var a=this._get("attributes");
a!==b&&(this._set("attributes",b),this._notifyLayer("attributes",a,b))},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"geometry",{set:function(b){var a=this._get("geometry");a!==b&&(this._set("geometry",b),this._notifyLayer("geometry",a,b))},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"symbol",{set:function(b){var a=this._get("symbol");a!==b&&(this._set("symbol",b),this._notifyLayer("symbol",a,b))},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,
"visible",{set:function(b){var a=this._get("visible");a!==b&&(this._set("visible",b),this._notifyLayer("visible",a,b))},enumerable:!0,configurable:!0});g.prototype.getEffectivePopupTemplate=function(b){void 0===b&&(b=!1);return this.popupTemplate?this.popupTemplate:this.sourceLayer?this.sourceLayer.popupTemplate?this.sourceLayer.popupTemplate:b&&h.isSome(this.sourceLayer.defaultPopupTemplate)?this.sourceLayer.defaultPopupTemplate:null:null};g.prototype.getAttribute=function(b){return this.attributes&&
this.attributes[b]};g.prototype.setAttribute=function(b,a){var d;this.attributes?(d=this.getAttribute(b),this.attributes[b]=a,this._notifyLayer("attributes",d,a,b)):(this.attributes=(d={},d[b]=a,d),this._notifyLayer("attributes",void 0,a,b))};g.prototype.getObjectId=function(){return this.sourceLayer?this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null:null};g.prototype.toJSON=function(){return{geometry:h.isSome(this.geometry)?this.geometry.toJSON():null,symbol:h.isSome(this.symbol)?
this.symbol.toJSON():null,attributes:e.__assign({},this.attributes),popupTemplate:this.popupTemplate&&this.popupTemplate.toJSON()}};g.prototype.clone=function(){return new f(this.cloneProperties())};g.prototype.cloneProperties=function(){return{attributes:c.clone(this.attributes),geometry:c.clone(this.geometry),layer:this.layer,popupTemplate:this.popupTemplate&&this.popupTemplate.clone(),sourceLayer:this.sourceLayer,symbol:c.clone(this.symbol),visible:this.visible}};g.prototype._notifyLayer=function(b,
a,d,c){this.layer&&this.layer.graphicChanged&&(a={graphic:this,property:b,oldValue:a,newValue:d},"attributes"===b&&(a.attributeName=c),this.layer.graphicChanged(a))};var f;e.__decorate([b.property({value:null})],g.prototype,"attributes",null);e.__decorate([b.property({value:null,types:m.geometryTypes,json:{read:d.fromJSON}})],g.prototype,"geometry",null);e.__decorate([b.property()],g.prototype,"layer",void 0);e.__decorate([b.property({type:k})],g.prototype,"popupTemplate",void 0);e.__decorate([b.property()],
g.prototype,"sourceLayer",void 0);e.__decorate([b.property({value:null,types:l.symbolTypes,json:{read:n.read}})],g.prototype,"symbol",null);e.__decorate([b.property({type:Boolean,value:!0})],g.prototype,"visible",null);return g=f=e.__decorate([b.subclass("esri.Graphic")],g)}(g.JSONSupport);var p=0;(function(b){b.generateUID=function(){return p++}})(f||(f={}));return f})},"esri/PopupTemplate":function(){define("require exports tslib ./core/arrayUtils ./core/Collection ./core/JSONSupport ./core/lang ./core/Logger ./core/promiseUtils ./core/SetUtils ./core/accessorSupport/decorators ./core/accessorSupport/ensureType ./layers/support/fieldUtils ./popup/content ./popup/ExpressionInfo ./popup/FieldInfo ./popup/LayerOptions ./popup/RelatedRecordsInfo ./popup/content/AttachmentsContent ./popup/content/Content ./popup/content/CustomContent ./popup/content/FieldsContent ./popup/content/MediaContent ./popup/content/TextContent ./popup/content/support/mediaInfoTypes ./support/actions/ActionBase ./support/actions/ActionButton ./support/actions/ActionToggle".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u,v,y,z,A,B,D,C,E,F,I,J){var G=k.ofType({key:"type",defaultKeyValue:"button",base:F,typeMap:{button:I,toggle:J}}),H={base:z,key:"type",typeMap:{media:D,custom:A,text:C,attachments:y,fields:B}},K=c.getLogger("esri.PopupTemplate"),O=["attachments","fields","media","text"];return function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b.actions=null;b.content="";b.expressionInfos=null;b.fieldInfos=null;b.layerOptions=null;b.lastEditInfoEnabled=
!0;b.outFields=null;b.overwriteActions=!1;b.title="";b.relatedRecordsInfo=null;return b}e.__extends(c,a);f=c;c.prototype.castContent=function(b){if(Array.isArray(b))return b.map(function(b){return n.ensureOneOfType(H,b)});if("string"===typeof b||"function"===typeof b||b instanceof HTMLElement||h.isPromiseLike(b))return b;K.error("content error","unsupported content value",{value:b});return null};c.prototype.readContent=function(b,a){b=a.popupElements;return Array.isArray(b)&&0<b.length?this._readPopupInfoElements(a):
this._readPopupInfo(a)};c.prototype.writeContent=function(b,a){var d=this;"string"===typeof b?a.description=b:Array.isArray(b)&&(a.popupElements=b.filter(function(b){return-1!==O.indexOf(b.type)}).map(function(b){return b&&b.toJSON()}),a.popupElements.forEach(function(b){"attachments"===b.type?d._writeAttachmentContent(a):"media"===b.type?d._writeMediaContent(b,a):"text"===b.type&&d._writeTextContent(b,a)}))};c.prototype.writeFieldInfos=function(b,a){var d=this.content,d=Array.isArray(d)?d:null;if(b){var c=
d?d.some(function(b){return"fields"===b.type&&(!b.fieldInfos||0===b.fieldInfos.length)}):!1;a.fieldInfos=b.filter(Boolean).map(function(b){b=b.toJSON();c||(b.visible=!1);return b})}if(d)for(b=0;b<d.length;b++){var h=d[b];"fields"===h.type&&this._writeFieldsContent(h,a)}};c.prototype.writeLayerOptions=function(b,a){a.layerOptions=!b||null===b.showNoDataRecords&&null===b.returnTopmostRaster?null:b.toJSON()};c.prototype.writeTitle=function(b,a){a.title=b||""};c.prototype.clone=function(){var b=this.actions,
b=b?g.clone(b.toArray()):[];return new f({actions:b,content:Array.isArray(this.content)?g.clone(this.content):this.content,expressionInfos:Array.isArray(this.expressionInfos)?g.clone(this.expressionInfos):null,fieldInfos:Array.isArray(this.fieldInfos)?g.clone(this.fieldInfos):null,layerOptions:this.layerOptions?g.clone(this.layerOptions):null,lastEditInfoEnabled:this.lastEditInfoEnabled,outFields:Array.isArray(this.outFields)?g.clone(this.outFields):null,overwriteActions:this.overwriteActions,title:this.title,
relatedRecordsInfo:this.relatedRecordsInfo?g.clone(this.relatedRecordsInfo):null})};c.prototype.collectRequiredFields=function(b,a){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(d){switch(d.label){case 0:return[4,this._collectExpressionInfoFields(b,a,this.expressionInfos)];case 1:return d.sent(),p.collectFields(b,a,e.__spreadArrays(this.outFields||[],this._getActionsFields(this.actions),this._getTitleFields(this.title),this._getContentFields(this.content))),[2]}})})};
c.prototype.getRequiredFields=function(a){return e.__awaiter(this,void 0,void 0,function(){var d;return e.__generator(this,function(c){switch(c.label){case 0:return d=new Set,[4,this.collectRequiredFields(d,a)];case 1:return c.sent(),[2,b.valuesOfSet(d).sort()]}})})};c.prototype._writeFieldsContent=function(b,a){Array.isArray(b.fieldInfos)&&b.fieldInfos.length&&(b=g.clone(b.fieldInfos),Array.isArray(a.fieldInfos)?b.forEach(function(b){var d=m.find(a.fieldInfos,function(a){return a.fieldName.toLowerCase()===
b.fieldName.toLowerCase()});d?d.visible=!0:a.fieldInfos.push(b)}):a.fieldInfos=b)};c.prototype._writeAttachmentContent=function(b){b.showAttachments||(b.showAttachments=!0)};c.prototype._writeTextContent=function(b,a){!a.description&&b.text&&(a.description=b.text)};c.prototype._writeMediaContent=function(b,a){Array.isArray(b.mediaInfos)&&b.mediaInfos.length&&(b=g.clone(b.mediaInfos),Array.isArray(a.mediaInfos)?a.mediaInfos=e.__spreadArrays(a.mediaInfos,b):a.mediaInfos=b)};c.prototype._readPopupInfoElements=
function(b){var a=b.description,d=b.mediaInfos,c=!1,h=!1;return b.popupElements.map(function(b){if("media"===b.type)return b.mediaInfos||!d||h||(b.mediaInfos=d,h=!0),D.fromJSON(b);if("text"===b.type)return b.text||!a||c||(b.text=a,c=!0),C.fromJSON(b);if("attachments"===b.type)return y.fromJSON(b);if("fields"===b.type)return B.fromJSON(b)}).filter(Boolean)};c.prototype._readPopupInfo=function(b){var a=b.description,d=b.mediaInfos;b=b.showAttachments;var c=[];a?c.push(new C({text:a})):c.push(new B);
Array.isArray(d)&&d.length&&c.push(D.fromJSON({mediaInfos:d}));b&&c.push(y.fromJSON({displayType:"list"}));return c.length?c:a};c.prototype._getContentElementFields=function(b){var a=this;if(!b||"attachments"===b.type)return[];if("custom"===b.type)return b.outFields||[];if("fields"===b.type)return this._getFieldInfoFields(b.fieldInfos||this.fieldInfos);if("media"===b.type)return(b.mediaInfos||[]).reduce(function(b,d){return e.__spreadArrays(b,a._getMediaInfoFields(d))},[]);if("text"===b.type)return this._extractFieldNames(b.text)};
c.prototype._getMediaInfoFields=function(b){var a=b.caption,d=b.value||{},c=d.fields,h=void 0===c?[]:c,c=d.normalizeField,g=d.tooltipField,n=d.sourceURL,d=d.linkURL;b=e.__spreadArrays(this._extractFieldNames(b.title),this._extractFieldNames(a),this._extractFieldNames(n),this._extractFieldNames(d),h);c&&b.push(c);g&&b.push(g);return b};c.prototype._getContentFields=function(b){var a=this;return"string"===typeof b?this._extractFieldNames(b):Array.isArray(b)?b.reduce(function(b,d){return e.__spreadArrays(b,
a._getContentElementFields(d))},[]):[]};c.prototype._collectExpressionInfoFields=function(b,a,d){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(c){switch(c.label){case 0:return d?[4,h.all(d.map(function(d){return p.collectArcadeFieldNames(b,a,d.expression)}))]:[2];case 1:return c.sent(),[2]}})})};c.prototype._getFieldInfoFields=function(b){return b?b.filter(function(b){return"undefined"===typeof b.visible?!0:!!b.visible}).map(function(b){return b.fieldName}).filter(function(b){return-1===
b.indexOf("relationships/")&&-1===b.indexOf("expression/")}):[]};c.prototype._getActionsFields=function(b){var a=this;return b?b.toArray().reduce(function(b,d){return e.__spreadArrays(b,a._getActionFields(d))},[]):[]};c.prototype._getActionFields=function(b){var a=b.className,d=b.type,d="button"===d||"toggle"===d?b.image:"";return e.__spreadArrays(this._extractFieldNames(b.title),this._extractFieldNames(a),this._extractFieldNames(d))};c.prototype._getTitleFields=function(b){return"string"===typeof b?
this._extractFieldNames(b):[]};c.prototype._extractFieldNames=function(b){if(!b||"string"!==typeof b)return[];b=b.match(/{[^}]*}/g);if(!b)return[];var a=/\{(\w+):.+\}/;return(b=b.filter(function(b){return!(0===b.indexOf("{relationships/")||0===b.indexOf("{expression/"))}).map(function(b){return b.replace(a,"{$1}")}))?b.map(function(b){return b.slice(1,-1)}):[]};var f;e.__decorate([d.property({type:G})],c.prototype,"actions",void 0);e.__decorate([d.property()],c.prototype,"content",void 0);e.__decorate([d.cast("content")],
c.prototype,"castContent",null);e.__decorate([d.reader("content",["description","popupElements","mediaInfos","showAttachments"])],c.prototype,"readContent",null);e.__decorate([d.writer("content",{popupElements:{type:k.ofType(r.types)},showAttachments:{type:Boolean},mediaInfos:{type:k.ofType(E.types)},description:{type:String}})],c.prototype,"writeContent",null);e.__decorate([d.property({type:[q],json:{write:!0}})],c.prototype,"expressionInfos",void 0);e.__decorate([d.property({type:[x]})],c.prototype,
"fieldInfos",void 0);e.__decorate([d.writer("fieldInfos")],c.prototype,"writeFieldInfos",null);e.__decorate([d.property({type:u})],c.prototype,"layerOptions",void 0);e.__decorate([d.writer("layerOptions")],c.prototype,"writeLayerOptions",null);e.__decorate([d.property({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],c.prototype,"lastEditInfoEnabled",void 0);e.__decorate([d.property()],c.prototype,"outFields",void 0);e.__decorate([d.property()],
c.prototype,"overwriteActions",void 0);e.__decorate([d.property({json:{type:String}})],c.prototype,"title",void 0);e.__decorate([d.writer("title")],c.prototype,"writeTitle",null);e.__decorate([d.property({type:v,json:{write:!0}})],c.prototype,"relatedRecordsInfo",void 0);return c=f=e.__decorate([d.subclass("esri.PopupTemplate")],c)}(l.JSONSupport)})},"esri/layers/support/fieldUtils":function(){define("require exports tslib @dojo/framework/shim/array ../../core/Error ../../core/maybe ../../core/object ../../core/promiseUtils ../../core/SetUtils ./domains ../../support/arcadeOnDemand @dojo/framework/shim/Promise".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d){function n(b,a,d){if(b)for(var c=0;c<b.length;c++){var h=b[c],e=g.getDeepValue(h,a);(e=e&&"function"!==typeof e&&x(d,e))&&g.setDeepValue(h,e.name,a)}}function p(b,a){if(!b||!a)return[];T.clear();r(T,b,a);return h.valuesOfSet(T).sort()}function r(b,a,d){if(d)if(a&&a.length)if(m.includes(d,"*"))for(d=0;d<a.length;d++)b.add(a[d].name);else for(var c=0;c<d.length;c++)h=d[c],q(b,a,h);else if(m.includes(d,"*"))b.clear(),b.add("*");else for(a=0;a<d.length;a++){var h=d[a];
b.add(h)}}function q(b,a,d){a&&a.length?(a=x(a,d))&&b.add(a.name):"string"===typeof d&&b.add(d)}function x(b,a){if("string"!==typeof a)return null;if(null!=b){a=a.toLowerCase();for(var d=0;d<b.length;d++){var c=b[d];if(c&&c.name.toLowerCase()===a)return c}}return null}function u(b,a,c){return e.__awaiter(this,void 0,void 0,function(){var h,g,n,f,p;return e.__generator(this,function(e){switch(e.label){case 0:return c?[4,d.loadArcade()]:[2];case 1:h=e.sent().arcadeUtils;g=h.extractFieldNames(c);n=0;
for(f=g;n<f.length;n++)p=f[n],q(b,a,p);return[2]}})})}function v(b,a){for(var d=0;d<b.length;d++){var c=b[d];if(c&&c.valueType&&c.valueType===a)return c.name}return null}function y(b,a){return e.__awaiter(this,void 0,void 0,function(){var d,c;return e.__generator(this,function(h){if(!a)return[2];d=a.fields;return(c=g.getDeepValue("elevationInfo.featureExpressionInfo",a))?[2,c.collectRequiredFields(b,d)]:[2]})})}function z(b,a,d){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,
function(c){d.outStatistic.onStatisticValueExpression?u(b,a,d.outStatistic.onStatisticValueExpression):b.add(d.outStatistic.onStatisticField);return[2]})})}function A(b,a){return e.__awaiter(this,void 0,void 0,function(){var d,h;return e.__generator(this,function(g){switch(g.label){case 0:return d=a.labelingInfo,h=a.fields,d&&d.length?[4,c.all(d.map(function(a){return B(b,h,a)}))]:[2];case 1:return g.sent(),[2]}})})}function B(b,a,d){return e.__awaiter(this,void 0,void 0,function(){var c,h,g,n,f;
return e.__generator(this,function(e){switch(e.label){case 0:if(!d)return[2];c=d.getLabelExpression();h=d.where;return"arcade"!==c.type?[3,2]:[4,u(b,a,c.expression)];case 1:return e.sent(),[3,3];case 2:(g=c.expression.match(/{[^}]*}/g))&&g.forEach(function(d){q(b,a,d.slice(1,-1))}),e.label=3;case 3:return n=/['"]+/g,h&&(f=h.split(" "),3===f.length&&q(b,a,f[0].replace(n,"")),7===f.length&&(q(b,a,f[0].replace(n,"")),q(b,a,f[4].replace(n,"")))),[2]}})})}function D(b){return"number"===typeof b&&!isNaN(b)&&
isFinite(b)}function C(b){return null===b||D(b)}function E(b){return null===b||R(b)}function F(b){return null!=b&&"string"===typeof b}function I(b){return null===b||F(b)}function J(){return!0}function G(b,a){var d;switch(b.type){case "date":case "integer":case "long":case "small-integer":case "esriFieldTypeDate":case "esriFieldTypeInteger":case "esriFieldTypeLong":case "esriFieldTypeSmallInteger":d=b.nullable?E:R;break;case "double":case "single":case "esriFieldTypeSingle":case "esriFieldTypeDouble":d=
b.nullable?C:D;break;case "string":case "esriFieldTypeString":d=b.nullable?I:F;break;default:d=J}return 1===arguments.length?d:d(a)}function H(b){return null!=b&&Q.has(b.type)}function K(a,d){return a.nullable&&null===d?null:H(a)&&!O(a.type,Number(d))?S.OUT_OF_RANGE:G(a,d)?a.domain?b.validateDomainValue(a.domain,d):null:U.INVALID_TYPE}function O(b,a){return(b="string"===typeof b?L(b):b)?b.isInteger?R(a)&&a>=b.min&&a<=b.max:a>=b.min&&a<=b.max:!1}function L(b){switch(b){case "esriFieldTypeSmallInteger":case "small-integer":return a.smallIntegerRange;
case "esriFieldTypeInteger":case "integer":return a.integerRange;case "esriFieldTypeSingle":case "single":return a.singleRange;case "esriFieldTypeDouble":case "double":return a.doubleRange}}function N(b,a,d){if(!a||!a.attributes||!b){if(l.isSome(d))for(var c=0;c<b.length;c++)a=b[c],d.add(a);return!0}for(var c=a.attributes,h=!1,g=0;g<b.length;g++)if(a=b[g],!(a in c))if(h=!0,l.isSome(d))d.add(a);else break;return h}Object.defineProperty(a,"__esModule",{value:!0});a.rendererFields="field field2 field3 normalizationField rotationInfo.field proportionalSymbolInfo.field proportionalSymbolInfo.normalizationField colorInfo.field colorInfo.normalizationField".split(" ");
a.visualVariableFields=["field","normalizationField"];a.fixRendererFields=function(b,d){if(null!=b&&null!=d){var c=0;for(b=Array.isArray(b)?b:[b];c<b.length;c++){var h=b[c];n(a.rendererFields,h,d);if("visualVariables"in h&&h.visualVariables)for(var g=0,h=h.visualVariables;g<h.length;g++)n(a.visualVariableFields,h[g],d)}}};a.fixTimeInfoFields=function(b,a){if(null!=b&&null!=a)if("startField"in b){var d=x(a,b.startField);a=x(a,b.endField);b.startField=d&&d.name||null;b.endField=a&&a.name||null}else d=
x(a,b.startTimeField),a=x(a,b.endTimeField),b.startTimeField=d&&d.name||null,b.endTimeField=a&&a.name||null};var T=new Set;a.fixFields=p;a.collectFields=r;a.collectField=q;a.unpackFieldNames=function(b,a){return a&&b?m.includes(a,"*")?b.map(function(b){return b.name}):a:[]};a.packFields=function(b,a,d){void 0===d&&(d=1);if(!a||!b)return[];if(m.includes(a,"*"))return["*"];a=p(b,a);return a.length/b.length>=d?["*"]:a};a.getField=x;a.hasField=function(b,a){if(!b||!a||"string"!==typeof a)return!1;a=a.toLowerCase();
for(var d=0;d<b.length;d++){var c=b[d];if(c&&c.name.toLowerCase()===a)return!0}return!1};a.collectArcadeFieldNames=u;a.getDisplayFieldName=function(b){var a=b.displayField;b=b.fields;if(a)return a;if(!b||!b.length)return null;if(!(a=v(b,"name-or-title")||v(b,"unique-identifier")||v(b,"type-or-category")))a:{for(a=0;a<b.length;a++){var d=b[a];if(d&&d.name){var c=d.name.toLowerCase();if(-1<c.indexOf("name")||-1<c.indexOf("title")){a=d.name;break a}}}a=null}return a};a.getElevationFields=function(b){return e.__awaiter(this,
void 0,void 0,function(){var a;return e.__generator(this,function(d){switch(d.label){case 0:if(!b)return[2,[]];a=new Set;return[4,y(a,b)];case 1:return d.sent(),[2,h.valuesOfSet(a).sort()]}})})};a.collectElevationFields=y;a.collectFeatureReductionFields=function(b,a,d){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(h){switch(h.label){case 0:return a&&d&&"cluster"===d.type&&d.fields?[4,c.all(d.fields.map(function(d){return z(b,a.fields,d)}))]:[2];case 1:return h.sent(),
[2]}})})};a.collectFilterFields=function(b,a,d){return e.__awaiter(this,void 0,void 0,function(){var c,h;return e.__generator(this,function(g){switch(g.label){case 0:if(!a||!d||!(d.where&&"1\x3d1"!==d.where||d.timeExtent))return[2];a.timeInfo&&d.timeExtent&&r(b,a.fields,[a.timeInfo.startField,a.timeInfo.endField]);return d.where?[4,new Promise(function(b,a){f(["../../core/sql/WhereClause"],b,a)})]:[3,2];case 1:c=g.sent();h=c.WhereClause.create(d.where,a.fieldsIndex);if(!h.isStandardized)throw new k("fieldUtils:collectFilterFields",
"Where clause is not standardized");r(b,a.fields,h.fieldNames);g.label=2;case 2:return[2]}})})};a.getTimeFields=function(b){return e.__awaiter(this,void 0,void 0,function(){var a;return e.__generator(this,function(d){return b?(a="timeInfo"in b&&b.timeInfo)?[2,p(b.fields,[b.trackIdField,a.startField,a.endField])]:[2,[]]:[2,[]]})})};a.getFeatureEditFields=function(b){if(!b)return[];var a="editFieldsInfo"in b&&b.editFieldsInfo;return a?p(b.fields,[a&&a.creatorField,a&&a.creationDateField,a&&a.editorField,
a&&a.editDateField]):[]};a.getFeatureGeometryFields=function(b){if(!b)return[];var a="geometryProperties"in b&&b.geometryProperties;return a?p(b.fields,[a&&a.shapeAreaFieldName,a&&a.shapeLengthFieldName]):[]};a.getLabelingFields=function(b){return e.__awaiter(this,void 0,void 0,function(){var a;return e.__generator(this,function(d){switch(d.label){case 0:if(!b)return[2,[]];a=new Set;return[4,A(a,b)];case 1:return d.sent(),[2,h.valuesOfSet(a).sort()]}})})};a.collectLabelingFields=A;a.getFieldDefaultValue=
function(b){var a=b.defaultValue;if(void 0!==a&&G(b,a))return a;if(b.nullable)return null};var R=function(){return"isInteger"in Number?Number.isInteger:function(b){return"number"===typeof b&&isFinite(b)&&Math.floor(b)===b}}();a.isValueMatchingFieldType=G;a.numericTypes=["integer","small-integer","single","double"];var Q=h.SetFromValues(e.__spreadArrays(a.numericTypes,["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]));a.isNumericField=H;a.isStringField=
function(b){return null!=b&&("string"===b.type||"esriFieldTypeString"===b.type)};a.isDateField=function(b){return null!=b&&("date"===b.type||"esriFieldTypeDate"===b.type)};a.isValidFieldValue=function(b,a){return null===K(b,a)};var S;(S=a.NumericRangeValidationError||(a.NumericRangeValidationError={})).OUT_OF_RANGE="numeric-range-validation-error::out-of-range";var U;(U=a.TypeValidationError||(a.TypeValidationError={})).INVALID_TYPE="type-validation-error::invalid-type";a.sanitizeNullFieldValue=function(b){return null==
b||"number"===typeof b&&isNaN(b)?null:b};a.validateFieldValue=K;a.isNumberInRange=O;a.getFieldRange=function(a){var d=b.getDomainRange(a.domain);if(d)return d;if(H(a))return L(a.type)};a.getNumericTypeForValue=function(b){if(!D(b))return null;if(R(b)){if(b>=a.smallIntegerRange.min&&b<=a.smallIntegerRange.max)return"esriFieldTypeSmallInteger";if(b>=a.integerRange.min&&b<=a.integerRange.max)return"esriFieldTypeInteger"}return b>=a.singleRange.min&&b<=a.singleRange.max?"esriFieldTypeSingle":"esriFieldTypeDouble"};
a.smallIntegerRange={min:-32768,max:32767,isInteger:!0};a.integerRange={min:-2147483648,max:2147483647,isInteger:!0};a.singleRange={min:-3.4E38,max:1.2E38,isInteger:!1};a.doubleRange={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};a.validationErrorToString=function(a,d,c){switch(a){case b.DomainValidationError.INVALID_CODED_VALUE:return"Value "+c+" is not in the coded domain - field: "+d.name+", domain: "+JSON.stringify(d.domain);case b.DomainValidationError.VALUE_OUT_OF_RANGE:return"Value "+
c+" is out of the range of valid values - field: "+d.name+", domain: "+JSON.stringify(d.domain);case U.INVALID_TYPE:return"Value "+c+" is not a valid value for the field type - field: "+d.name+", type: "+d.type+", nullable: "+d.nullable;case S.OUT_OF_RANGE:return a=L(d.type),"Value "+c+" is out of range for the number type - field: "+d.name+", type: "+d.type+", value range is "+a.min+" to "+a.max}};a.featureHasFields=function(b,a){return!N(b,a,null)};a.populateMissingFields=N;a.getExpressionFields=
function(b,a){return e.__awaiter(this,void 0,void 0,function(){var d,c,g,n;return e.__generator(this,function(e){switch(e.label){case 0:d=new Set,c=0,g=a,e.label=1;case 1:if(!(c<g.length))return[3,4];n=g[c];return[4,u(d,b.fields,n)];case 2:e.sent(),e.label=3;case 3:return c++,[3,1];case 4:return[2,h.valuesOfSet(d).sort()]}})})}})},"esri/layers/support/domains":function(){define("require exports ../../core/compilerUtils ./CodedValueDomain ./Domain ./InheritedDomain ./RangeDomain".split(" "),function(f,
a,e,m,k,l,g){function c(b,a){switch(b.type){case "range":var d="range"in b?b.range[1]:b.maxValue;if(+a<("range"in b?b.range[0]:b.minValue)||+a>d)return h.VALUE_OUT_OF_RANGE;break;case "coded-value":case "codedValue":if(null==b.codedValues||b.codedValues.every(function(b){return null==b||b.code!==a}))return h.INVALID_CODED_VALUE}return null}Object.defineProperty(a,"__esModule",{value:!0});a.CodedValueDomain=m;a.DomainBase=k;a.InheritedDomain=l;a.RangeDomain=g;var h;(function(b){b.VALUE_OUT_OF_RANGE=
"domain-validation-error::value-out-of-range";b.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(h=a.DomainValidationError||(a.DomainValidationError={}));a.isValidDomainValue=function(b,a){return null===c(b,a)};a.validateDomainValue=c;a.types={key:"type",base:k,typeMap:{range:g,"coded-value":m,inherited:l}};a.getDomainRange=function(b){if(b&&"range"===b.type)return{min:"range"in b?b.range[0]:b.minValue,max:"range"in b?b.range[1]:b.maxValue}};a.fromJSON=function(b){if(!b||!b.type)return null;
switch(b.type){case "range":return g.fromJSON(b);case "codedValue":return m.fromJSON(b);case "inherited":return l.fromJSON(b);default:e.neverReached(b)}return null}})},"esri/layers/support/CodedValueDomain":function(){define("require exports tslib ../../core/lang ../../core/accessorSupport/decorators ./CodedValue ./Domain".split(" "),function(f,a,e,m,k,l,g){return function(a){function c(b){b=a.call(this,b)||this;b.codedValues=null;b.type="coded-value";return b}e.__extends(c,a);b=c;c.prototype.getName=
function(b){var a=null;if(this.codedValues){var d=String(b);this.codedValues.some(function(b){String(b.code)===d&&(a=b.name);return!!a})}return a};c.prototype.clone=function(){return new b({codedValues:m.clone(this.codedValues),name:this.name})};var b;e.__decorate([k.property({type:[l.default],json:{write:!0}})],c.prototype,"codedValues",void 0);e.__decorate([k.enumeration({codedValue:"coded-value"})],c.prototype,"type",void 0);return c=b=e.__decorate([k.subclass("esri.layers.support.CodedValueDomain")],
c)}(g)})},"esri/layers/support/CodedValue":function(){define(["require","exports","tslib","../../core/JSONSupport","../../core/accessorSupport/decorators"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function g(c){c=a.call(this,c)||this;c.name=null;c.code=null;return c}e.__extends(g,a);c=g;g.prototype.clone=function(){return new c({name:this.name,code:this.code})};var c;e.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"name",void 0);e.__decorate([k.property({type:[String,
Number],json:{write:!0}})],g.prototype,"code",void 0);return g=c=e.__decorate([k.subclass("esri.layers.support.CodedValue")],g)}(m.JSONSupport);a.CodedValue=f;a.default=f})},"esri/layers/support/Domain":function(){define("require exports tslib ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(f,a,e,m,k,l){var g=new m.default({inherited:"inherited",codedValue:"coded-value",range:"range"});return function(a){function c(b){b=a.call(this,b)||this;b.name=
null;b.type=null;return b}e.__extends(c,a);e.__decorate([l.property({type:String,json:{write:!0}})],c.prototype,"name",void 0);e.__decorate([l.enumeration(g)],c.prototype,"type",void 0);return c=e.__decorate([l.subclass("esri.layers.support.Domain")],c)}(k.JSONSupport)})},"esri/layers/support/InheritedDomain":function(){define(["require","exports","tslib","../../core/accessorSupport/decorators","./Domain"],function(f,a,e,m,k){return function(a){function g(c){c=a.call(this,c)||this;c.type="inherited";
return c}e.__extends(g,a);c=g;g.prototype.clone=function(){return new c};var c;e.__decorate([m.enumeration({inherited:"inherited"})],g.prototype,"type",void 0);return g=c=e.__decorate([m.subclass("esri.layers.support.InheritedDomain")],g)}(k)})},"esri/layers/support/RangeDomain":function(){define(["require","exports","tslib","../../core/accessorSupport/decorators","./Domain"],function(f,a,e,m,k){return function(a){function g(c){c=a.call(this,c)||this;c.maxValue=null;c.minValue=null;c.type="range";
return c}e.__extends(g,a);c=g;g.prototype.clone=function(){return new c({maxValue:this.maxValue,minValue:this.minValue,name:this.name})};var c;e.__decorate([m.property({type:Number,json:{type:[Number],read:{source:"range",reader:function(a,b){return b.range&&b.range[1]}},write:{enabled:!1,overridePolicy:function(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer:function(a,b,d){b[d]=[this.minValue||0,a]}}}})],g.prototype,"maxValue",void 0);e.__decorate([m.property({type:Number,
json:{type:[Number],read:{source:"range",reader:function(a,b){return b.range&&b.range[0]}},write:{target:"range",writer:function(a,b,d){b[d]=[a,this.maxValue||0]}}}})],g.prototype,"minValue",void 0);e.__decorate([m.enumeration({range:"range"})],g.prototype,"type",void 0);return g=c=e.__decorate([m.subclass("esri.layers.support.RangeDomain")],g)}(k)})},"esri/support/arcadeOnDemand":function(){define("require exports tslib ../geometry ../core/maybe ../core/promiseUtils @dojo/framework/shim/Promise".split(" "),
function(f,a,e,m,k,l){function g(){return e.__awaiter(this,void 0,void 0,function(){var b=this;return e.__generator(this,function(a){c||(c=function(){return e.__awaiter(b,void 0,void 0,function(){var b;return e.__generator(this,function(a){switch(a.label){case 0:return[4,new Promise(function(b,a){f(["./arcadeUtils"],b,a)})];case 1:return b=a.sent(),[4,b.arcade.load()];case 2:return a.sent(),[2,{arcade:b.arcade,arcadeUtils:b,Dictionary:b.Dictionary,Feature:b.arcadeFeature}]}})})}());return[2,c]})})}
Object.defineProperty(a,"__esModule",{value:!0});var c;a.loadArcade=g;a.createLabelExpression=function(b,a,c){return h.create(b,a,c,null,["$feature"])};a.createVVExpression=function(b,a,c){return h.create(b,a,c,null,["$feature","$view"])};a.createRendererExpression=function(b,a,c){return h.create(b,a,c,null,["$feature","$view"])};a.createDictionaryExpression=function(b,a,c,g){return h.create(b,a,c,g,["$feature","$view"])};var h=function(){function b(b,a,c,h,g,e,f){this.evaluate=h;this._syntaxTree=
c;this._arcade=b;this._arcadeDictionary=a;this._arcadeFeature=g;this._fields=e;this._spatialReference=f;this._referencesGeometry=b.scriptTouchesGeometry(this._syntaxTree);this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}b.create=function(a,c,h,f,q,x){return e.__awaiter(this,void 0,void 0,function(){var d,n,p,r,A,B,D,C,E,F,I,J,G,H,K;return e.__generator(this,function(u){switch(u.label){case 0:return[4,g()];case 1:return d=u.sent(),n=d.arcade,p=d.Feature,r=d.Dictionary,
A=m.SpatialReference.fromJSON(c),B=n.parseScript(a,x),D=q.reduce(function(b,a){var d;return e.__assign(e.__assign({},b),(d={},d[a]=null,d))},{}),C=null,k.isSome(f)&&(C=new r(f),C.immutable=!0,D.$config=null),E=n.scriptUsesGeometryEngine(B)&&n.enableGeometrySupport(),F=n.scriptUsesFeatureSet(B)&&n.enableFeatureSetSupport(),I=n.scriptIsAsync(B)&&n.enableAsyncSupport(),J={vars:D,spatialReference:A,useAsync:!!I},G=new r,G.immutable=!1,G.setField("scale",0),H=n.compileScript(B,J),K=function(b){"$view"in
b&&b.$view&&(G.setField("scale",b.$view.scale),b.$view=G);C&&(b.$config=C);return H({vars:b,spatialReference:A})},[4,l.all([E,F,I])];case 2:return u.sent(),[2,new b(n,r,B,K,new p,h,A)]}})})};b.prototype.repurposeFeature=function(b){b.geometry&&!b.geometry.spatialReference&&(b.geometry.spatialReference=this._spatialReference);this._arcadeFeature.repurposeFromGraphicLikeObject(b.geometry,b.attributes,{fields:this._fields});return this._arcadeFeature};b.prototype.createDictionary=function(){return new this._arcadeDictionary};
b.prototype.referencesMember=function(b){return this._arcade.referencesMember(this._syntaxTree,b)};b.prototype.referencesFunction=function(b){return this._arcade.referencesFunction(this._syntaxTree,b)};b.prototype.referencesGeometry=function(){return this._referencesGeometry};b.prototype.referencesScale=function(){return this._referencesScale};b.prototype.extractFieldLiterals=function(b){return this._arcade.extractFieldLiterals(this._syntaxTree,b)};return b}();a.ArcadeExpression=h;a.default=h})},
"esri/popup/content":function(){define("require exports ./content/AttachmentsContent ./content/Content ./content/CustomContent ./content/FieldsContent ./content/MediaContent ./content/TextContent".split(" "),function(f,a,e,m,k,l,g,c){Object.defineProperty(a,"__esModule",{value:!0});a.AttachmentsContent=e;a.BaseContent=m;a.CustomContent=k;a.FieldsContent=l;a.MediaContent=g;a.TextContent=c;a.isContent=function(a){return a instanceof m};a.types={base:null,key:"type",typeMap:{attachment:e,custom:k,fields:l,
media:g,text:c}}})},"esri/popup/content/AttachmentsContent":function(){define(["require","exports","tslib","../../core/accessorSupport/decorators","./Content"],function(f,a,e,m,k){return function(a){function g(c){c=a.call(this,c)||this;c.displayType=null;c.type="attachments";return c}e.__extends(g,a);c=g;g.prototype.clone=function(){return new c({displayType:this.displayType})};var c;e.__decorate([m.property({type:["preview","list"],json:{write:!0}})],g.prototype,"displayType",void 0);e.__decorate([m.property({type:["attachments"],
readOnly:!0,json:{read:!1,write:!0}})],g.prototype,"type",void 0);return g=c=e.__decorate([m.subclass("esri.popup.content.AttachmentsContent")],g)}(k)})},"esri/popup/content/Content":function(){define(["require","exports","tslib","../../core/JSONSupport","../../core/accessorSupport/decorators"],function(f,a,e,m,k){return function(a){function g(c){c=a.call(this,c)||this;c.type=null;return c}e.__extends(g,a);e.__decorate([k.property({type:["attachments","custom","fields","media","text"],readOnly:!0,
json:{read:!1,write:!0}})],g.prototype,"type",void 0);return g=e.__decorate([k.subclass("esri.popup.content.Content")],g)}(m.JSONSupport)})},"esri/popup/content/CustomContent":function(){define("require exports tslib ../../core/lang ../../core/accessorSupport/decorators ./Content".split(" "),function(f,a,e,m,k,l){return function(a){function c(b){b=a.call(this,b)||this;b.creator=null;b.destroyer=null;b.outFields=null;b.type="custom";return b}e.__extends(c,a);h=c;c.prototype.clone=function(){return new h({creator:this.creator,
destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?m.clone(this.outFields):null})};var h;e.__decorate([k.property()],c.prototype,"creator",void 0);e.__decorate([k.property()],c.prototype,"destroyer",void 0);e.__decorate([k.property()],c.prototype,"outFields",void 0);e.__decorate([k.property({type:["custom"],readOnly:!0})],c.prototype,"type",void 0);return c=h=e.__decorate([k.subclass("esri.popup.content.CustomContent")],c)}(l)})},"esri/popup/content/FieldsContent":function(){define("require exports tslib ../../core/lang ../../core/accessorSupport/decorators ../FieldInfo ./Content".split(" "),
function(f,a,e,m,k,l,g){return function(a){function c(b){b=a.call(this,b)||this;b.fieldInfos=null;b.type="fields";return b}e.__extends(c,a);b=c;c.prototype.writeFieldInfos=function(b,a){a.fieldInfos=b&&b.map(function(b){return b.toJSON()})};c.prototype.clone=function(){return new b({fieldInfos:Array.isArray(this.fieldInfos)?m.clone(this.fieldInfos):null})};var b;e.__decorate([k.property({type:[l]})],c.prototype,"fieldInfos",void 0);e.__decorate([k.writer("fieldInfos")],c.prototype,"writeFieldInfos",
null);e.__decorate([k.property({type:["fields"],readOnly:!0,json:{read:!1,write:!0}})],c.prototype,"type",void 0);return c=b=e.__decorate([k.subclass("esri.popup.content.FieldsContent")],c)}(g)})},"esri/popup/FieldInfo":function(){define("require exports tslib ../core/jsonMap ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators ./support/FieldInfoFormat".split(" "),function(f,a,e,m,k,l,g,c){var h=new m.default({richtext:"rich-text",textarea:"text-area",textbox:"text-box"});return function(b){function a(a){a=
b.call(this,a)||this;a.fieldName=null;a.format=null;a.isEditable=!1;a.label=null;a.stringFieldOption="text-box";a.statisticType=null;a.tooltip=null;a.visible=!0;return a}e.__extends(a,b);n=a;a.prototype.writeStringFieldOption=function(b,a){a.stringFieldOption=h.toJSON(b)};a.prototype.readStringFieldOption=function(b){if(b)return h.fromJSON(b)};a.prototype.clone=function(){return new n({fieldName:this.fieldName,format:this.format?l.clone(this.format):null,isEditable:this.isEditable,label:this.label,
stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,visible:this.visible})};var n;e.__decorate([g.property({type:String,json:{write:!0}})],a.prototype,"fieldName",void 0);e.__decorate([g.property({type:c,json:{write:!0}})],a.prototype,"format",void 0);e.__decorate([g.property({type:Boolean,json:{write:!0,default:!1}})],a.prototype,"isEditable",void 0);e.__decorate([g.property({type:String,json:{write:!0}})],a.prototype,"label",void 0);e.__decorate([g.property({type:h.apiValues,
json:{write:!0,default:"text-box",type:h.jsonValues}})],a.prototype,"stringFieldOption",void 0);e.__decorate([g.writer("stringFieldOption")],a.prototype,"writeStringFieldOption",null);e.__decorate([g.reader("stringFieldOption")],a.prototype,"readStringFieldOption",null);e.__decorate([g.property({type:"count sum min max avg stddev var".split(" "),json:{write:!0}})],a.prototype,"statisticType",void 0);e.__decorate([g.property({type:String,json:{write:!0}})],a.prototype,"tooltip",void 0);e.__decorate([g.property({type:Boolean,
json:{write:!0}})],a.prototype,"visible",void 0);return a=n=e.__decorate([g.subclass("esri.popup.FieldInfo")],a)}(k.JSONSupport)})},"esri/popup/support/FieldInfoFormat":function(){define("require exports tslib ../../core/date ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../intl/date ../../intl/number".split(" "),function(f,a,e,m,k,l,g,c,h){return function(b){function a(a){a=b.call(this,a)||this;a.dateFormat=null;a.digitSeparator=!1;a.places=
null;return a}e.__extends(a,b);n=a;a.prototype.clone=function(){return new n({dateFormat:this.dateFormat,digitSeparator:this.digitSeparator,places:this.places})};a.prototype.format=function(b){return this.dateFormat?c.formatDate(b,c.convertDateFormatToIntlOptions(this.dateFormat)):h.formatNumber(b,h.convertNumberFormatToIntlOptions(this))};var n;e.__decorate([l.enumeration(m.dictionary)],a.prototype,"dateFormat",void 0);e.__decorate([l.property({type:Boolean,json:{write:!0}})],a.prototype,"digitSeparator",
void 0);e.__decorate([l.property({type:g.Integer,json:{write:!0}})],a.prototype,"places",void 0);return a=n=e.__decorate([l.subclass("esri.popup.support.FieldInfoFormat")],a)}(k.JSONSupport)})},"esri/core/date":function(){define(["require","exports","./jsonMap"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.formats={"short-date":"(datePattern: 'M/d/y', selector: 'date')","short-date-short-time":"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')","short-date-short-time-24":"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')",
"short-date-long-time":"(datePattern: 'M/d/y', timePattern: 'h:mm:ss a', selector: 'date and time')","short-date-long-time-24":"(datePattern: 'M/d/y', timePattern: 'H:mm:ss', selector: 'date and time')","short-date-le":"(datePattern: 'd/M/y', selector: 'date')","short-date-le-short-time":"(datePattern: 'd/M/y', timePattern: 'h:mm a', selector: 'date and time')","short-date-le-short-time-24":"(datePattern: 'd/M/y', timePattern: 'H:mm', selector: 'date and time')","short-date-le-long-time":"(datePattern: 'd/M/y', timePattern: 'h:mm:ss a', selector: 'date and time')",
"short-date-le-long-time-24":"(datePattern: 'd/M/y', timePattern: 'H:mm:ss', selector: 'date and time')","long-month-day-year":"(datePattern: 'MMMM d, y', selector: 'date')","long-month-day-year-short-time":"(datePattern: 'MMMM d, y', timePattern: 'h:mm a', selector: 'date and time')","long-month-day-year-short-time-24":"(datePattern: 'MMMM d, y', timePattern: 'H:mm', selector: 'date and time')","long-month-day-year-long-time":"(datePattern: 'MMMM d, y', timePattern: 'h:mm:ss a', selector: 'date and time')",
"long-month-day-year-long-time-24":"(datePattern: 'MMMM d, y', timePattern: 'H:mm:ss', selector: 'date and time')","day-short-month-year":"(datePattern: 'd MMM y', selector: 'date')","day-short-month-year-short-time":"(datePattern: 'd MMM y', timePattern: 'h:mm a', selector: 'date and time')","day-short-month-year-short-time-24":"(datePattern: 'd MMM y', timePattern: 'H:mm', selector: 'date and time')","day-short-month-year-long-time":"(datePattern: 'd MMM y', timePattern: 'h:mm:ss a', selector: 'date and time')",
"day-short-month-year-long-time-24":"(datePattern: 'd MMM y', timePattern: 'H:mm:ss', selector: 'date and time')","long-date":"(datePattern: 'EEEE, MMMM d, y', selector: 'date')","long-date-short-time":"(datePattern: 'EEEE, MMMM d, y', timePattern: 'h:mm a', selector: 'date and time')","long-date-short-time-24":"(datePattern: 'EEEE, MMMM d, y', timePattern: 'H:mm', selector: 'date and time')","long-date-long-time":"(datePattern: 'EEEE, MMMM d, y', timePattern: 'h:mm:ss a', selector: 'date and time')",
"long-date-long-time-24":"(datePattern: 'EEEE, MMMM d, y', timePattern: 'H:mm:ss', selector: 'date and time')","long-month-year":"(datePattern: 'MMMM y', selector: 'date')","short-month-year":"(datePattern: 'MMM y', selector: 'date')",year:"(datePattern: 'y', selector: 'date')"};a.dictionary=e.strict()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",
shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",
dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",
shortMonthYear:"short-month-year",year:"year"});a.toJSON=a.dictionary.toJSON.bind(a.dictionary);a.fromJSON=a.dictionary.fromJSON.bind(a.dictionary);a.getFormat=function(e){return a.formats[e]}})},"esri/popup/content/MediaContent":function(){define("require exports tslib ../../core/lang ../../core/accessorSupport/decorators ./BarChartMediaInfo ./ColumnChartMediaInfo ./Content ./ImageMediaInfo ./LineChartMediaInfo ./PieChartMediaInfo ./support/mediaInfoTypes".split(" "),function(f,a,e,m,k,l,g,c,h,b,
d,n){return function(a){function c(b){b=a.call(this,b)||this;b.mediaInfos=null;b.type="media";return b}e.__extends(c,a);f=c;c.prototype.readMediaInfos=function(a){return a&&a.map(function(a){if("image"===a.type)return h.fromJSON(a);if("barchart"===a.type)return l.fromJSON(a);if("columnchart"===a.type)return g.fromJSON(a);if("linechart"===a.type)return b.fromJSON(a);if("piechart"===a.type)return d.fromJSON(a)}).filter(Boolean)};c.prototype.writeMediaInfos=function(b,a){a.mediaInfos=b&&b.map(function(b){return b.toJSON()})};
c.prototype.clone=function(){return new f({mediaInfos:this.mediaInfos?m.clone(this.mediaInfos):null})};var f;e.__decorate([k.property({types:[n.types]})],c.prototype,"mediaInfos",void 0);e.__decorate([k.reader("mediaInfos")],c.prototype,"readMediaInfos",null);e.__decorate([k.writer("mediaInfos")],c.prototype,"writeMediaInfos",null);e.__decorate([k.property({type:["media"],readOnly:!0,json:{read:!1,write:!0}})],c.prototype,"type",void 0);return c=f=e.__decorate([k.subclass("esri.popup.content.MediaContent")],
c)}(c)})},"esri/popup/content/BarChartMediaInfo":function(){define("require exports tslib ../../core/accessorSupport/decorators ./mixins/ChartMediaInfo ./support/chartMediaInfoUtils".split(" "),function(f,a,e,m,k,l){return function(a){function c(b){b=a.call(this,b)||this;b.type="bar-chart";return b}e.__extends(c,a);h=c;c.prototype.clone=function(){return new h({title:this.title,caption:this.caption,value:this.value?this.value.clone():null})};var h;e.__decorate([m.property({type:["bar-chart"],readOnly:!0,
json:{type:["barchart"],read:!1,write:l.chartTypeKebabDict.write}})],c.prototype,"type",void 0);return c=h=e.__decorate([m.subclass("esri.popup.content.BarChartMediaInfo")],c)}(k)})},"esri/popup/content/mixins/ChartMediaInfo":function(){define("require exports tslib ../../../core/accessorSupport/decorators ./MediaInfo ../support/ChartMediaInfoValue".split(" "),function(f,a,e,m,k,l){return function(a){function c(c){c=a.call(this,c)||this;c.type=null;c.value=null;return c}e.__extends(c,a);e.__decorate([m.property({type:["bar-chart",
"column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],c.prototype,"type",void 0);e.__decorate([m.property({type:l,json:{write:!0}})],c.prototype,"value",void 0);return c=e.__decorate([m.subclass("esri.popup.content.mixins.ChartMediaInfo")],c)}(k)})},"esri/popup/content/mixins/MediaInfo":function(){define(["require","exports","tslib","../../../core/JSONSupport","../../../core/accessorSupport/decorators"],function(f,a,e,m,k){return function(a){function g(c){c=a.call(this,c)||
this;c.altText=null;c.caption="";c.title="";c.type=null;return c}e.__extends(g,a);e.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"altText",void 0);e.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"caption",void 0);e.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"title",void 0);e.__decorate([k.property({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],g.prototype,"type",void 0);return g=
e.__decorate([k.subclass("esri.popup.content.mixins.MediaInfo")],g)}(m.JSONSupport)})},"esri/popup/content/support/ChartMediaInfoValue":function(){define("require exports tslib ../../../core/JSONSupport ../../../core/lang ../../../core/accessorSupport/decorators ./ChartMediaInfoValueSeries".split(" "),function(f,a,e,m,k,l,g){return function(a){function c(b){b=a.call(this,b)||this;b.fields=[];b.normalizeField=null;b.series=[];b.tooltipField=null;return b}e.__extends(c,a);b=c;c.prototype.clone=function(){return new b({fields:k.clone(this.fields),
normalizeField:this.normalizeField,tooltipField:this.tooltipField})};var b;e.__decorate([l.property({type:[String],json:{write:!0}})],c.prototype,"fields",void 0);e.__decorate([l.property({type:String,json:{write:!0}})],c.prototype,"normalizeField",void 0);e.__decorate([l.property({type:[g],json:{read:!1}})],c.prototype,"series",void 0);e.__decorate([l.property({type:String,json:{write:!0}})],c.prototype,"tooltipField",void 0);return c=b=e.__decorate([l.subclass("esri.popup.content.support.ChartMediaInfoValue")],
c)}(m.JSONSupport)})},"esri/popup/content/support/ChartMediaInfoValueSeries":function(){define(["require","exports","tslib","../../../core/Accessor","../../../core/accessorSupport/decorators"],function(f,a,e,m,k){return function(a){function g(c){c=a.call(this,c)||this;c.tooltip=null;c.x=null;c.y=null;return c}e.__extends(g,a);c=g;g.prototype.clone=function(){return new c({tooltip:this.tooltip,x:this.x,y:this.y})};var c;e.__decorate([k.property()],g.prototype,"tooltip",void 0);e.__decorate([k.property()],
g.prototype,"x",void 0);e.__decorate([k.property()],g.prototype,"y",void 0);return g=c=e.__decorate([k.subclass("esri.popup.content.support.ChartMediaInfoValueSeries")],g)}(m)})},"esri/popup/content/support/chartMediaInfoUtils":function(){define(["require","exports","../../../core/jsonMap"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.chartTypeKebabDict=e.strict()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"})})},"esri/popup/content/ColumnChartMediaInfo":function(){define("require exports tslib ../../core/accessorSupport/decorators ./mixins/ChartMediaInfo ./support/chartMediaInfoUtils".split(" "),
function(f,a,e,m,k,l){return function(a){function c(b){b=a.call(this,b)||this;b.type="column-chart";return b}e.__extends(c,a);h=c;c.prototype.clone=function(){return new h({title:this.title,caption:this.caption,value:this.value?this.value.clone():null})};var h;e.__decorate([m.property({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:l.chartTypeKebabDict.write}})],c.prototype,"type",void 0);return c=h=e.__decorate([m.subclass("esri.popup.content.ColumnChartMediaInfo")],c)}(k)})},
"esri/popup/content/ImageMediaInfo":function(){define("require exports tslib ../../core/accessorSupport/decorators ./mixins/MediaInfo ./support/ImageMediaInfoValue".split(" "),function(f,a,e,m,k,l){return function(a){function c(b){b=a.call(this,b)||this;b.refreshInterval=null;b.type="image";b.value=null;return b}e.__extends(c,a);h=c;c.prototype.clone=function(){return new h({title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?this.value.clone():null})};var h;
e.__decorate([m.property({type:Number,json:{write:!0}})],c.prototype,"refreshInterval",void 0);e.__decorate([m.property({type:["image"],readOnly:!0,json:{read:!1,write:!0}})],c.prototype,"type",void 0);e.__decorate([m.property({type:l,json:{write:!0}})],c.prototype,"value",void 0);return c=h=e.__decorate([m.subclass("esri.popup.content.ImageMediaInfo")],c)}(k)})},"esri/popup/content/support/ImageMediaInfoValue":function(){define(["require","exports","tslib","../../../core/JSONSupport","../../../core/accessorSupport/decorators"],
function(f,a,e,m,k){return function(a){function g(c){c=a.call(this,c)||this;c.linkURL=null;c.sourceURL=null;return c}e.__extends(g,a);c=g;g.prototype.clone=function(){return new c({linkURL:this.linkURL,sourceURL:this.sourceURL})};var c;e.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"linkURL",void 0);e.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"sourceURL",void 0);return g=c=e.__decorate([k.subclass("esri.popup.content.support.ImageMediaInfoValue")],g)}(m.JSONSupport)})},
"esri/popup/content/LineChartMediaInfo":function(){define("require exports tslib ../../core/accessorSupport/decorators ./mixins/ChartMediaInfo ./support/chartMediaInfoUtils".split(" "),function(f,a,e,m,k,l){return function(a){function c(b){b=a.call(this,b)||this;b.type="line-chart";return b}e.__extends(c,a);h=c;c.prototype.clone=function(){return new h({title:this.title,caption:this.caption,value:this.value?this.value.clone():null})};var h;e.__decorate([m.property({type:["line-chart"],readOnly:!0,
json:{type:["linechart"],read:!1,write:l.chartTypeKebabDict.write}})],c.prototype,"type",void 0);return c=h=e.__decorate([m.subclass("esri.popup.content.LineChartMediaInfo")],c)}(k)})},"esri/popup/content/PieChartMediaInfo":function(){define("require exports tslib ../../core/accessorSupport/decorators ./mixins/ChartMediaInfo ./support/chartMediaInfoUtils".split(" "),function(f,a,e,m,k,l){return function(a){function c(b){b=a.call(this,b)||this;b.type="pie-chart";return b}e.__extends(c,a);h=c;c.prototype.clone=
function(){return new h({title:this.title,caption:this.caption,value:this.value?this.value.clone():null})};var h;e.__decorate([m.property({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:l.chartTypeKebabDict.write}})],c.prototype,"type",void 0);return c=h=e.__decorate([m.subclass("esri.popup.content.PieChartMediaInfo")],c)}(k)})},"esri/popup/content/support/mediaInfoTypes":function(){define("require exports ../BarChartMediaInfo ../ColumnChartMediaInfo ../ImageMediaInfo ../LineChartMediaInfo ../PieChartMediaInfo ../mixins/MediaInfo".split(" "),
function(f,a,e,m,k,l,g,c){Object.defineProperty(a,"__esModule",{value:!0});a.types={base:c,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":e,"column-chart":m,"line-chart":l,"pie-chart":g,image:k}};a.default=a.types})},"esri/popup/content/TextContent":function(){define(["require","exports","tslib","../../core/accessorSupport/decorators","./Content"],function(f,a,e,m,k){return function(a){function g(c){c=a.call(this,c)||this;c.text=null;c.type="text";return c}e.__extends(g,a);c=g;g.prototype.clone=
function(){return new c({text:this.text})};var c;e.__decorate([m.property({type:String,json:{write:!0}})],g.prototype,"text",void 0);e.__decorate([m.property({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],g.prototype,"type",void 0);return g=c=e.__decorate([m.subclass("esri.popup.content.TextContent")],g)}(k)})},"esri/popup/ExpressionInfo":function(){define(["require","exports","tslib","../core/JSONSupport","../core/accessorSupport/decorators"],function(f,a,e,m,k){return function(a){function g(c){c=
a.call(this,c)||this;c.name=null;c.title=null;c.expression=null;c.returnType=null;return c}e.__extends(g,a);c=g;g.prototype.clone=function(){return new c({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})};var c;e.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"name",void 0);e.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"title",void 0);e.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"expression",
void 0);e.__decorate([k.property({type:["string","number"],json:{write:!0}})],g.prototype,"returnType",void 0);return g=c=e.__decorate([k.subclass("esri.popup.ExpressionInfo")],g)}(m.JSONSupport)})},"esri/popup/LayerOptions":function(){define(["require","exports","tslib","../core/JSONSupport","../core/accessorSupport/decorators"],function(f,a,e,m,k){return function(a){function g(c){c=a.call(this,c)||this;c.returnTopmostRaster=null;c.showNoDataRecords=null;return c}e.__extends(g,a);c=g;g.prototype.clone=
function(){return new c({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})};var c;e.__decorate([k.property({type:Boolean,json:{write:!0}})],g.prototype,"returnTopmostRaster",void 0);e.__decorate([k.property({type:Boolean,json:{write:!0}})],g.prototype,"showNoDataRecords",void 0);return g=c=e.__decorate([k.subclass("esri.popup.LayerOptions")],g)}(m.JSONSupport)})},"esri/popup/RelatedRecordsInfo":function(){define("require exports tslib ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators ./support/RelatedRecordsInfoFieldOrder".split(" "),
function(f,a,e,m,k,l,g){return function(a){function c(b){b=a.call(this,b)||this;b.showRelatedRecords=null;b.orderByFields=null;return b}e.__extends(c,a);b=c;c.prototype.clone=function(){return new b({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?k.clone(this.orderByFields):null})};var b;e.__decorate([l.property({type:Boolean,json:{write:!0}})],c.prototype,"showRelatedRecords",void 0);e.__decorate([l.property({type:[g],json:{write:!0}})],c.prototype,"orderByFields",void 0);
return c=b=e.__decorate([l.subclass("esri.popup.RelatedRecordsInfo")],c)}(m.JSONSupport)})},"esri/popup/support/RelatedRecordsInfoFieldOrder":function(){define(["require","exports","tslib","../../core/JSONSupport","../../core/accessorSupport/decorators"],function(f,a,e,m,k){return function(a){function g(c){c=a.call(this,c)||this;c.field=null;c.order=null;return c}e.__extends(g,a);c=g;g.prototype.clone=function(){return new c({field:this.field,order:this.order})};var c;e.__decorate([k.property({type:String,
json:{write:!0}})],g.prototype,"field",void 0);e.__decorate([k.property({type:["asc","desc"],json:{write:!0}})],g.prototype,"order",void 0);return g=c=e.__decorate([k.subclass("esri.popup.support.RelatedRecordsInfoFieldOrder")],g)}(m.JSONSupport)})},"esri/support/actions/ActionBase":function(){define("require exports tslib ../../core/Accessor ../../core/Identifiable ../../core/accessorSupport/decorators".split(" "),function(f,a,e,m,k,l){return function(a){function c(b){b=a.call(this,b)||this;b.active=
!1;b.className=null;b.disabled=!1;b.id=null;b.indicator=!1;b.title=null;b.type=null;b.visible=!0;return b}e.__extends(c,a);h=c;c.prototype.clone=function(){return new h({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})};var h;e.__decorate([l.property()],c.prototype,"active",void 0);e.__decorate([l.property()],c.prototype,"className",void 0);e.__decorate([l.property()],c.prototype,"disabled",void 0);e.__decorate([l.property()],
c.prototype,"id",void 0);e.__decorate([l.property()],c.prototype,"indicator",void 0);e.__decorate([l.property()],c.prototype,"title",void 0);e.__decorate([l.property()],c.prototype,"type",void 0);e.__decorate([l.property()],c.prototype,"visible",void 0);return c=h=e.__decorate([l.subclass("esri.support.actions.ActionBase")],c)}(k.IdentifiableMixin(m))})},"esri/core/Identifiable":function(){define(["require","exports","tslib","./accessorSupport/decorators"],function(f,a,e,m){Object.defineProperty(a,
"__esModule",{value:!0});var k=0;a.IdentifiableMixin=function(a){return function(a){function c(){for(var c=[],b=0;b<arguments.length;b++)c[b]=arguments[b];c=a.apply(this,c)||this;Object.defineProperty(c,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+k++});return c}e.__extends(c,a);return c=e.__decorate([m.subclass("esri.core.Identifiable")],c)}(a)};f=function(a){function g(){return null!==a&&a.apply(this,arguments)||this}e.__extends(g,a);return g=e.__decorate([m.subclass("esri.core.Identifiable")],
g)}(a.IdentifiableMixin(function(){return function(){}}()));a.Identifiable=f})},"esri/support/actions/ActionButton":function(){define(["require","exports","tslib","../../core/accessorSupport/decorators","./ActionBase"],function(f,a,e,m,k){return function(a){function g(c){c=a.call(this,c)||this;c.image=null;c.type="button";return c}e.__extends(g,a);c=g;g.prototype.clone=function(){return new c({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,
visible:this.visible,image:this.image})};var c;e.__decorate([m.property()],g.prototype,"image",void 0);return g=c=e.__decorate([m.subclass("esri.support.Action.ActionButton")],g)}(k)})},"esri/support/actions/ActionToggle":function(){define(["require","exports","tslib","../../core/accessorSupport/decorators","./ActionBase"],function(f,a,e,m,k){return function(a){function g(c){c=a.call(this,c)||this;c.image=null;c.type="toggle";c.value=!1;return c}e.__extends(g,a);c=g;g.prototype.clone=function(){return new c({active:this.active,
className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})};var c;e.__decorate([m.property()],g.prototype,"image",void 0);e.__decorate([m.property()],g.prototype,"value",void 0);return g=c=e.__decorate([m.subclass("esri.support.Action.ActionToggle")],g)}(k)})},"esri/symbols":function(){define("require exports ./core/accessorSupport/ensureType ./symbols/CIMSymbol ./symbols/ExtrudeSymbol3DLayer ./symbols/FillSymbol ./symbols/FillSymbol3DLayer ./symbols/Font ./symbols/IconSymbol3DLayer ./symbols/LabelSymbol3D ./symbols/LineSymbol3D ./symbols/LineSymbol3DLayer ./symbols/MarkerSymbol ./symbols/MeshSymbol3D ./symbols/ObjectSymbol3DLayer ./symbols/PathSymbol3DLayer ./symbols/PictureFillSymbol ./symbols/PictureMarkerSymbol ./symbols/PointSymbol3D ./symbols/PolygonSymbol3D ./symbols/SimpleFillSymbol ./symbols/SimpleLineSymbol ./symbols/SimpleMarkerSymbol ./symbols/Symbol ./symbols/Symbol3D ./symbols/Symbol3DLayer ./symbols/TextSymbol ./symbols/TextSymbol3DLayer ./symbols/WaterSymbol3DLayer ./symbols/WebStyleSymbol ./symbols/callouts/LineCallout3D ./symbols/callouts/LineCallout3DBorder ./symbols/support/Symbol3DVerticalOffset ./symbols/support/jsonUtils".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u,v,y,z,A,B,D,C,E,F,I,J,G,H,K,O,L,N){Object.defineProperty(a,"__esModule",{value:!0});a.CIMSymbol=m;a.ExtrudeSymbol3DLayer=k;a.BaseFillSymbol=l;a.FillSymbol3DLayer=g;a.Font=c;a.IconSymbol3DLayer=h;a.LabelSymbol3D=b;a.LineSymbol3D=d;a.LineSymbol3DLayer=n;a.BaseMarkerSymbol=p;a.MeshSymbol3D=r;a.ObjectSymbol3DLayer=q;a.PathSymbol3DLayer=x;a.PictureFillSymbol=u;a.PictureMarkerSymbol=v;a.PointSymbol3D=y;a.PolygonSymbol3D=z;a.SimpleFillSymbol=A;a.SimpleLineSymbol=
B;a.SimpleMarkerSymbol=D;a.BaseSymbol=C;a.BaseSymbol3D=E;a.BaseSymbol3DLayer=F;a.TextSymbol=I;a.TextSymbol3DLayer=J;a.WaterSymbol3DLayer=G;a.WebStyleSymbol=H;a.LineCallout3D=K;a.LineCallout3DBorder=O;a.Symbol3DVerticalOffset=L.Symbol3DVerticalOffset;a.fromJSON=N.fromJSON;a.isSymbol=function(b){return b instanceof C};a.isSymbol2D=function(b){if(!b)return!1;switch(b.type){case "picture-fill":case "picture-marker":case "simple-fill":case "simple-line":case "simple-marker":case "text":case "cim":return!0;
default:return!1}};a.isSymbol3D=function(b){if(!b)return!1;switch(b.type){case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return!0;default:return!1}};a.symbolTypes={base:C,key:"type",typeMap:{"simple-fill":A,"picture-fill":u,"picture-marker":v,"simple-line":B,"simple-marker":D,text:I,"label-3d":b,"line-3d":d,"mesh-3d":r,"point-3d":y,"polygon-3d":z,"web-style":H,cim:m}};a.symbolTypesRenderer={base:C,key:"type",typeMap:{"simple-fill":A,"picture-fill":u,"picture-marker":v,
"simple-line":B,"simple-marker":D,text:I,"line-3d":d,"mesh-3d":r,"point-3d":y,"polygon-3d":z,"web-style":H,cim:m}};a.symbolTypesLabel={base:C,key:"type",typeMap:{text:I,"label-3d":b}};a.symbolTypes3D={base:C,key:"type",typeMap:{"label-3d":b,"line-3d":d,"mesh-3d":r,"point-3d":y,"polygon-3d":z,"web-style":H}};a.symbolTypesRenderer3D={base:C,key:"type",typeMap:{"line-3d":d,"mesh-3d":r,"point-3d":y,"polygon-3d":z,"web-style":H}};a.symbolTypesLabel3D={base:C,key:"type",typeMap:{"label-3d":b}};a.ensureType=
e.ensureOneOfType(a.symbolTypes)})},"esri/symbols/CIMSymbol":function(){define("require exports tslib ../core/lang ../core/promiseUtils ../core/accessorSupport/decorators ../layers/support/fieldUtils ../portal/Portal ./Symbol ./cim/cimSymbolUtils".split(" "),function(f,a,e,m,k,l,g,c,h,b){return function(a){function d(b){b=a.call(this,b)||this;b.data=null;b.portal=null;b.styleUrl="";b.type="cim";return b}e.__extends(d,a);h=d;d.prototype.readData=function(b,a){return a};d.prototype.writeData=function(b,
a){if(b)for(var d in b)a[d]=b[d]};d.prototype.readStyleUrl=function(b,a){return a.symbolUrl?a.symbolUrl:b};d.prototype.writeStyleUrl=function(b,a){b&&(a.symbolUrl=b)};d.prototype.collectRequiredFields=function(a,d){return e.__awaiter(this,void 0,void 0,function(){var c,h,n;return e.__generator(this,function(e){switch(e.label){case 0:return[4,b.fetchSymbol(this)];case 1:e.sent();if("CIMSymbolReference"!==this.data.type)return[3,3];c=this.data;h=c.primitiveOverrides;if(!h)return[3,3];n=h.map(function(b){return g.collectArcadeFieldNames(a,
d,b.valueExpressionInfo.expression)});return[4,k.all(n)];case 2:e.sent(),e.label=3;case 3:return[2]}})})};d.prototype.clone=function(){return new h({color:this.color.clone(),data:m.clone(this.data),portal:this.portal,styleName:this.styleName,styleUrl:this.styleUrl})};d.prototype.hash=function(){return this.color.hash()+"."+this.data+"."+this.portal+"."+this.styleName+"."+this.styleUrl};var h;e.__decorate([l.property({json:{write:!1}})],d.prototype,"color",void 0);e.__decorate([l.property({json:{write:!0}})],
d.prototype,"data",void 0);e.__decorate([l.reader("data",["symbol"])],d.prototype,"readData",null);e.__decorate([l.writer("data")],d.prototype,"writeData",null);e.__decorate([l.property({type:c,json:{write:!1}})],d.prototype,"portal",void 0);e.__decorate([l.property({json:{write:!0}})],d.prototype,"styleName",void 0);e.__decorate([l.property({type:String,json:{write:!0}})],d.prototype,"styleUrl",void 0);e.__decorate([l.reader("styleUrl",["styleUrl","symbolUrl"])],d.prototype,"readStyleUrl",null);
e.__decorate([l.writer("styleUrl")],d.prototype,"writeStyleUrl",null);e.__decorate([l.enumeration({CIMSymbolReference:"cim"})],d.prototype,"type",void 0);return d=h=e.__decorate([l.subclass("esri.symbols.CIMSymbol")],d)}(h)})},"esri/portal/Portal":function(){define("require exports tslib ../config ../intl ../kernel ../request ../core/Error ../core/JSONSupport ../core/lang ../core/Loadable ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ../geometry/Extent ./PortalQueryParams ./PortalQueryResult ./PortalUser @dojo/framework/shim/Promise".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u,v,y){var z,A={PortalGroup:function(){return new Promise(function(b,a){f(["./PortalGroup"],b,a)})},PortalItem:function(){return new Promise(function(b,a){f(["./PortalItem"],b,a)})},PortalUser:function(){return new Promise(function(b,a){f(["./PortalUser"],b,a)})}};return function(a){function d(b){b=a.call(this,b)||this;b.access=null;b.allSSL=!1;b.authMode="auto";b.authorizedCrossOriginDomains=null;b.basemapGalleryGroupQuery=null;b.bingKey=null;b.canListApps=
!1;b.canListData=!1;b.canListPreProvisionedItems=!1;b.canProvisionDirectPurchase=!1;b.canSearchPublic=!0;b.canShareBingPublic=!1;b.canSharePublic=!1;b.canSignInArcGIS=!1;b.canSignInIDP=!1;b.colorSetsGroupQuery=null;b.commentsEnabled=!1;b.created=null;b.culture=null;b.customBaseUrl=null;b.defaultBasemap=null;b.defaultExtent=null;b.defaultVectorBasemap=null;b.description=null;b.eueiEnabled=null;b.featuredGroups=null;b.featuredItemsGroupQuery=null;b.galleryTemplatesGroupQuery=null;b.livingAtlasGroupQuery=
null;b.hasCategorySchema=!1;b.helperServices=null;b.homePageFeaturedContent=null;b.homePageFeaturedContentCount=null;b.httpPort=null;b.httpsPort=null;b.id=null;b.ipCntryCode=null;b.isPortal=!1;b.isReadOnly=!1;b.layerTemplatesGroupQuery=null;b.maxTokenExpirationMinutes=null;b.modified=null;b.name=null;b.portalHostname=null;b.portalMode=null;b.portalProperties=null;b.region=null;b.rotatorPanels=null;b.showHomePageDescription=!1;b.sourceJSON=null;b.supportsHostedServices=!1;b.symbolSetsGroupQuery=null;
b.templatesGroupQuery=null;b.units=null;b.url=m.portalUrl;b.urlKey=null;b.user=null;b.useStandardizedQuery=!1;b.useVectorBasemaps=!1;b.vectorBasemapGalleryGroupQuery=null;return b}e.__extends(d,a);h=d;d.prototype.normalizeCtorArgs=function(b){return"string"===typeof b?{url:b}:b};d.prototype.destroy=function(){this._esriId_credentialCreateHandle&&(this._esriId_credentialCreateHandle.remove(),this._esriId_credentialCreateHandle=null)};d.prototype.readAuthorizedCrossOriginDomains=function(b){if(b)for(var a=
0;a<b.length;a++){var d=b[a];-1===m.request.trustedServers.indexOf(d)&&m.request.trustedServers.push(d)}return b};d.prototype.readDefaultBasemap=function(b){return b?(b=z.fromJSON(b),b.portalItem={portal:this},b):null};d.prototype.readDefaultVectorBasemap=function(b){return b?(b=z.fromJSON(b),b.portalItem={portal:this},b):null};Object.defineProperty(d.prototype,"extraQuery",{get:function(){var b=!(this.user&&this.user.orgId)||this.canSearchPublic;return this.id&&!b?" AND orgid:"+this.id:null},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"isOrganization",{get:function(){return!!this.access},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"restUrl",{get:function(){var b=this.url;if(b)var a=b.indexOf("/sharing"),b=0<a?b.substring(0,a):this.url.replace(/\/+$/,""),b=b+"/sharing/rest";return b},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"thumbnailUrl",{get:function(){var b=this.restUrl,a=this.thumbnail;return b&&a?this._normalizeSSL(b+"/portals/self/resources/"+
a):null},enumerable:!0,configurable:!0});d.prototype.readUrlKey=function(b){return b?b.toLowerCase():b};d.prototype.readUser=function(b){var a=null;b&&(a=y.fromJSON(b),a.portal=this);return a};d.prototype.load=function(b){var a=this,d=(new Promise(function(b,a){f(["../Basemap"],b,a)})).then(function(a){p.throwIfAborted(b);z=a}).then(function(){return a.sourceJSON?a.sourceJSON:a._fetchSelf(a.authMode,!1,b)}).then(function(b){if(l.id){var d=l.id;a.credential=d.findCredential(a.restUrl);a.credential||
a.authMode!==h.AUTH_MODE_AUTO||(a._esriId_credentialCreateHandle=d.on("credential-create",function(){d.findCredential(a.restUrl)&&a._signIn()}))}a.sourceJSON=b;a.read(b)});this.addResolvingPromise(d);return p.resolve(this)};d.prototype.createClosestFacilityTask=function(){return e.__awaiter(this,void 0,void 0,function(){var b,a;return e.__generator(this,function(d){switch(d.label){case 0:return[4,this.load()];case 1:return d.sent(),b=this._getHelperServiceUrl("closestFacility"),[4,new Promise(function(b,
a){f(["../tasks/ClosestFacilityTask"],b,a)})];case 2:return a=d.sent(),[2,new a(b)]}})})};d.prototype.createElevationLayers=function(){return e.__awaiter(this,void 0,void 0,function(){var b,a;return e.__generator(this,function(d){switch(d.label){case 0:return[4,this.load()];case 1:return d.sent(),b=this._getHelperService("defaultElevationLayers"),[4,new Promise(function(b,a){f(["../layers/ElevationLayer"],b,a)})];case 2:return a=d.sent(),[2,b?b.map(function(b){return new a({id:b.id,url:b.url})}):
[]]}})})};d.prototype.createGeometryService=function(){return e.__awaiter(this,void 0,void 0,function(){var b,a;return e.__generator(this,function(d){switch(d.label){case 0:return[4,this.load()];case 1:return d.sent(),b=this._getHelperServiceUrl("geometry"),[4,new Promise(function(b,a){f(["../tasks/GeometryService"],b,a)})];case 2:return a=d.sent(),[2,new a({url:b})]}})})};d.prototype.createPrintTask=function(){return e.__awaiter(this,void 0,void 0,function(){var b,a;return e.__generator(this,function(d){switch(d.label){case 0:return[4,
this.load()];case 1:return d.sent(),b=this._getHelperServiceUrl("printTask"),[4,new Promise(function(b,a){f(["../tasks/PrintTask"],b,a)})];case 2:return a=d.sent(),[2,new a(b)]}})})};d.prototype.createRouteTask=function(){return e.__awaiter(this,void 0,void 0,function(){var b,a;return e.__generator(this,function(d){switch(d.label){case 0:return[4,this.load()];case 1:return d.sent(),b=this._getHelperServiceUrl("route"),[4,new Promise(function(b,a){f(["../tasks/RouteTask"],b,a)})];case 2:return a=d.sent(),
[2,new a(b)]}})})};d.prototype.createServiceAreaTask=function(){return e.__awaiter(this,void 0,void 0,function(){var b,a;return e.__generator(this,function(d){switch(d.label){case 0:return[4,this.load()];case 1:return d.sent(),b=this._getHelperServiceUrl("serviceArea"),[4,new Promise(function(b,a){f(["../tasks/ServiceAreaTask"],b,a)})];case 2:return a=d.sent(),[2,new a(b)]}})})};d.prototype.fetchBasemaps=function(b,a){var d=new u;d.query=b||(this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:
this.basemapGalleryGroupQuery);d.disableExtraQuery=!0;return this.queryGroups(d,a).then(function(b){d.num=100;d.query='type:"Web Map" -type:"Web Application"';return b.total?(b=b.results[0],d.sortField=b.sortField||"name",d.sortOrder=b.sortOrder||"desc",b.queryItems(d,a)):null}).then(function(b){return b&&b.total?b.results.filter(function(b){return"Web Map"===b.type}).map(function(b){return new z({portalItem:b})}):[]})};d.prototype.fetchCategorySchema=function(b){return this.hasCategorySchema?this._request(this.restUrl+
"/portals/self/categorySchema",b).then(function(b){return b.categorySchema}):p.isAborted(b)?p.reject(p.createAbortError()):p.resolve([])};d.prototype.fetchFeaturedGroups=function(b){var a=this.featuredGroups,d=new u;d.num=100;d.sortField="title";if(a&&a.length){for(var c=[],h=0;h<a.length;h++){var g=a[h];c.push('(title:"'+g.title+'" AND owner:'+g.owner+")")}d.query=c.join(" OR ");return this.queryGroups(d,b).then(function(b){return b.results})}return p.isAborted(b)?p.reject(p.createAbortError()):
p.resolve([])};d.prototype.fetchRegions=function(b){var a=this.user&&this.user.culture||this.culture||k.getLocale();return this._request(this.restUrl+"/portals/regions",e.__assign(e.__assign({},b),{query:{culture:a}}))};d.getDefault=function(){if(!h._default||h._default.destroyed)h._default=new h;return h._default};d.prototype.queryGroups=function(b,a){return this._queryPortal("/community/groups",b,"PortalGroup",a)};d.prototype.queryItems=function(b,a){return this._queryPortal("/search",b,"PortalItem",
a)};d.prototype.queryUsers=function(b,a){b.sortField||(b.sortField="username");return this._queryPortal("/community/users",b,"PortalUser",a)};d.prototype.toJSON=function(){throw new c("internal:not-yet-implemented","Portal.toJSON is not yet implemented");};d.fromJSON=function(b){if(!b)return null;if(b.declaredClass)throw Error("JSON object is already hydrated");return new h({sourceJSON:b})};d.prototype._getHelperService=function(b){var a=this.helperServices&&this.helperServices[b];if(!a)throw new c("portal:service-not-found",
'The `helperServices` do not include an entry named "'+b+'"');return a};d.prototype._getHelperServiceUrl=function(b){var a=this._getHelperService(b);if(!a.url)throw new c("portal:service-url-not-found",'The `helperServices` entry "'+b+'" does not include a `url` value');return a.url};d.prototype._fetchSelf=function(b,a,d){void 0===b&&(b=this.authMode);void 0===a&&(a=!1);var c=this.restUrl+"/portals/self";b=e.__assign({authMode:b,query:{culture:k.getLocale().toLowerCase()}},d);"auto"===b.authMode&&
(b.authMode="no-prompt");a&&(b.query.default=!0);return this._request(c,b)};d.prototype._queryPortal=function(b,a,d,c){var g=this,n=q.ensureType(u,a),f=function(a){return g._request(g.restUrl+b,e.__assign(e.__assign({},n.toRequestOptions(g)),c)).then(function(b){var d=n.clone();d.start=b.nextStart;return new v({nextQueryParams:d,queryParams:n,total:b.total,results:h._resultsToTypedArray(a,{portal:g},b,c)})}).then(function(b){return p.all(b.results.map(function(a){return"function"===typeof a.when?
a.when():b})).then(function(){return b},function(a){p.throwIfAbortError(a);return b})})};return d&&A[d]?A[d]().then(function(b){p.throwIfAborted(c);return f(b)}):f()};d.prototype._signIn=function(){var b=this;if(this.authMode===h.AUTH_MODE_ANONYMOUS)return p.reject(new c("portal:invalid-auth-mode",'Current "authMode"\' is "'+this.authMode+'"'));if("failed"===this.loadStatus)return p.reject(this.loadError);var a=function(a){return p.resolve().then(function(){if("not-loaded"===b.loadStatus)return a||
(b.authMode="immediate"),b.load().then(function(){return null});if("loading"===b.loadStatus)return b.load().then(function(){if(b.credential)return null;b.credential=a;return b._fetchSelf("immediate")});if(b.user&&b.credential===a)return null;b.credential=a;return b._fetchSelf("immediate")}).then(function(a){a&&(b.sourceJSON=a,b.read(a))})};return l.id?l.id.getCredential(this.restUrl).then(function(b){return a(b)}):a(this.credential)};d.prototype._normalizeSSL=function(b){return b.replace(/^http:/i,
"https:").replace(":7080",":7443")};d.prototype._normalizeUrl=function(b){var a=this.credential&&this.credential.token;return this._normalizeSSL(a?b+(-1<b.indexOf("?")?"\x26":"?")+"token\x3d"+a:b)};d.prototype._requestToTypedArray=function(b,a,d){var c=this,g=function(d){return c._request(b,a).then(function(b){var a=h._resultsToTypedArray(d,{portal:c},b);return p.all(a.map(function(a){return"function"===typeof a.when?a.when():b})).then(function(){return a},function(){return a})})};return d?(new Promise(function(b,
a){f(["./"+d],b,a)})).then(function(b){return g(b)}):g()};d.prototype._request=function(b,a){void 0===a&&(a={});var d=e.__assign({f:"json"},a.query),c=a.authMode,n=a.body,f=a.cacheBust,q=a.method,p=a.responseType;a={authMode:void 0===c?this.authMode===h.AUTH_MODE_ANONYMOUS?"anonymous":"auto":c,body:void 0===n?null:n,cacheBust:void 0===f?!1:f,method:void 0===q?"auto":q,query:d,responseType:void 0===p?"json":p,timeout:0,signal:a.signal};return g(this._normalizeSSL(b),a).then(function(b){return b.data})};
d._resultsToTypedArray=function(a,d,c,h){if(c){var g=n.isSome(h)?h.signal:null;c=c.listings||c.notifications||c.userInvitations||c.tags||c.items||c.groups||c.comments||c.provisions||c.results||c.relatedItems||c;if(a||d)c=c.map(function(c){c=b.mixin(a?a.fromJSON(c):c,d);"function"===typeof c.load&&c.load(g);return c})}else c=[];return c};var h;d.AUTH_MODE_ANONYMOUS="anonymous";d.AUTH_MODE_AUTO="auto";d.AUTH_MODE_IMMEDIATE="immediate";e.__decorate([r.property()],d.prototype,"access",void 0);e.__decorate([r.property()],
d.prototype,"allSSL",void 0);e.__decorate([r.property()],d.prototype,"authMode",void 0);e.__decorate([r.property()],d.prototype,"authorizedCrossOriginDomains",void 0);e.__decorate([r.reader("authorizedCrossOriginDomains")],d.prototype,"readAuthorizedCrossOriginDomains",null);e.__decorate([r.property()],d.prototype,"basemapGalleryGroupQuery",void 0);e.__decorate([r.property()],d.prototype,"bingKey",void 0);e.__decorate([r.property()],d.prototype,"canListApps",void 0);e.__decorate([r.property()],d.prototype,
"canListData",void 0);e.__decorate([r.property()],d.prototype,"canListPreProvisionedItems",void 0);e.__decorate([r.property()],d.prototype,"canProvisionDirectPurchase",void 0);e.__decorate([r.property()],d.prototype,"canSearchPublic",void 0);e.__decorate([r.property()],d.prototype,"canShareBingPublic",void 0);e.__decorate([r.property()],d.prototype,"canSharePublic",void 0);e.__decorate([r.property()],d.prototype,"canSignInArcGIS",void 0);e.__decorate([r.property()],d.prototype,"canSignInIDP",void 0);
e.__decorate([r.property()],d.prototype,"colorSetsGroupQuery",void 0);e.__decorate([r.property()],d.prototype,"commentsEnabled",void 0);e.__decorate([r.property({type:Date})],d.prototype,"created",void 0);e.__decorate([r.property()],d.prototype,"credential",void 0);e.__decorate([r.property()],d.prototype,"culture",void 0);e.__decorate([r.property()],d.prototype,"currentVersion",void 0);e.__decorate([r.property()],d.prototype,"customBaseUrl",void 0);e.__decorate([r.property()],d.prototype,"defaultBasemap",
void 0);e.__decorate([r.reader("defaultBasemap")],d.prototype,"readDefaultBasemap",null);e.__decorate([r.property({type:x})],d.prototype,"defaultExtent",void 0);e.__decorate([r.property()],d.prototype,"defaultVectorBasemap",void 0);e.__decorate([r.reader("defaultVectorBasemap")],d.prototype,"readDefaultVectorBasemap",null);e.__decorate([r.property()],d.prototype,"description",void 0);e.__decorate([r.property()],d.prototype,"eueiEnabled",void 0);e.__decorate([r.property({dependsOn:["user","id","canSearchPublic"],
readOnly:!0})],d.prototype,"extraQuery",null);e.__decorate([r.property()],d.prototype,"featuredGroups",void 0);e.__decorate([r.property()],d.prototype,"featuredItemsGroupQuery",void 0);e.__decorate([r.property()],d.prototype,"galleryTemplatesGroupQuery",void 0);e.__decorate([r.property()],d.prototype,"livingAtlasGroupQuery",void 0);e.__decorate([r.property()],d.prototype,"hasCategorySchema",void 0);e.__decorate([r.property()],d.prototype,"helpBase",void 0);e.__decorate([r.property()],d.prototype,
"helperServices",void 0);e.__decorate([r.property()],d.prototype,"helpMap",void 0);e.__decorate([r.property()],d.prototype,"homePageFeaturedContent",void 0);e.__decorate([r.property()],d.prototype,"homePageFeaturedContentCount",void 0);e.__decorate([r.property()],d.prototype,"httpPort",void 0);e.__decorate([r.property()],d.prototype,"httpsPort",void 0);e.__decorate([r.property()],d.prototype,"id",void 0);e.__decorate([r.property()],d.prototype,"ipCntryCode",void 0);e.__decorate([r.property({dependsOn:["access"],
readOnly:!0})],d.prototype,"isOrganization",null);e.__decorate([r.property()],d.prototype,"isPortal",void 0);e.__decorate([r.property()],d.prototype,"isReadOnly",void 0);e.__decorate([r.property()],d.prototype,"layerTemplatesGroupQuery",void 0);e.__decorate([r.property()],d.prototype,"maxTokenExpirationMinutes",void 0);e.__decorate([r.property({type:Date})],d.prototype,"modified",void 0);e.__decorate([r.property()],d.prototype,"name",void 0);e.__decorate([r.property()],d.prototype,"portalHostname",
void 0);e.__decorate([r.property()],d.prototype,"portalMode",void 0);e.__decorate([r.property()],d.prototype,"portalProperties",void 0);e.__decorate([r.property()],d.prototype,"region",void 0);e.__decorate([r.property({dependsOn:["url"],readOnly:!0})],d.prototype,"restUrl",null);e.__decorate([r.property()],d.prototype,"rotatorPanels",void 0);e.__decorate([r.property()],d.prototype,"showHomePageDescription",void 0);e.__decorate([r.property()],d.prototype,"sourceJSON",void 0);e.__decorate([r.property()],
d.prototype,"staticImagesUrl",void 0);e.__decorate([r.property()],d.prototype,"stylesGroupQuery",void 0);e.__decorate([r.property()],d.prototype,"supportsHostedServices",void 0);e.__decorate([r.property()],d.prototype,"symbolSetsGroupQuery",void 0);e.__decorate([r.property()],d.prototype,"templatesGroupQuery",void 0);e.__decorate([r.property()],d.prototype,"thumbnail",void 0);e.__decorate([r.property({dependsOn:["restUrl","thumbnail"],readOnly:!0})],d.prototype,"thumbnailUrl",null);e.__decorate([r.property()],
d.prototype,"units",void 0);e.__decorate([r.property()],d.prototype,"url",void 0);e.__decorate([r.property()],d.prototype,"urlKey",void 0);e.__decorate([r.reader("urlKey")],d.prototype,"readUrlKey",null);e.__decorate([r.property()],d.prototype,"user",void 0);e.__decorate([r.reader("user")],d.prototype,"readUser",null);e.__decorate([r.property()],d.prototype,"useStandardizedQuery",void 0);e.__decorate([r.property()],d.prototype,"useVectorBasemaps",void 0);e.__decorate([r.property()],d.prototype,"vectorBasemapGalleryGroupQuery",
void 0);return d=h=e.__decorate([r.subclass("esri.portal.Portal")],d)}(h.JSONSupportMixin(d))})},"esri/core/Loadable":function(){define("require exports tslib ./Error ./Promise ./promiseUtils ./Warning ./accessorSupport/decorators".split(" "),function(f,a,e,m,k,l,g,c){var h=function(b){return function(b){function a(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];var c=b.apply(this,a)||this;c.loadError=null;c.loadStatus="not-loaded";c.loadWarnings=null;c._set("loadWarnings",[]);c.addResolvingPromise(l.create(function(b){var a=
c.load.bind(c);c.load=function(d){var h=l.create(function(b,a){l.onAbortOrThrow(d,a);c.destroyed&&a(new m("load:instance-destroyed","Instance is destroyed",{instance:c}));c._promiseProps.when(b,a)});if("not-loaded"===c.loadStatus){c._set("loadStatus","loading");var g=c._loadController=l.createAbortController();a({signal:g.signal});l.onAbort(g.signal,function(){c._promiseProps.abort()})}b();return h}}));c.when(function(){c._set("loadStatus","loaded");c._loadController=null},function(b){c._set("loadStatus",
"failed");c._set("loadError",b);c._loadController=null});return c}e.__extends(a,b);Object.defineProperty(a.prototype,"loaded",{get:function(){return"loaded"===this.loadStatus},enumerable:!0,configurable:!0});a.prototype.load=function(){return null};a.prototype.cancelLoad=function(){if(this.isFulfilled())return this;this._set("loadError",new m("load:cancelled","Cancelled"));this._loadController.abort();return this};e.__decorate([c.property({readOnly:!0,dependsOn:["loadStatus"]})],a.prototype,"loaded",
null);e.__decorate([c.property({readOnly:!0})],a.prototype,"loadError",void 0);e.__decorate([c.property()],a.prototype,"loadStatus",void 0);e.__decorate([c.property({type:[g],readOnly:!0})],a.prototype,"loadWarnings",void 0);return a=e.__decorate([c.subclass("esri.core.Loadable")],a)}(b)};f=function(b){function a(){return null!==b&&b.apply(this,arguments)||this}e.__extends(a,b);return a=e.__decorate([c.subclass("esri.core.Loadable")],a)}(h(k.EsriPromise));(function(b){b.LoadableMixin=h;b.isLoadable=
function(b){return!(!b||!b.load)}})(f||(f={}));return f})},"esri/core/Promise":function(){define("require exports tslib ./Accessor ./promiseUtils ./accessorSupport/decorators".split(" "),function(f,a,e,m,k,l){Object.defineProperty(a,"__esModule",{value:!0});var g=function(){function a(a){var b=this;this.instance=a;this._resolver=k.createDeferred();this._status=void 0;this._resolvingPromises=[];this._resolver.promise.then(function(){b._status=0;b._cleanUp()},function(){b._status=1;b._cleanUp()})}a.prototype.addResolvingPromise=
function(a){this._resolvingPromises.push(a);this._tryResolve()};a.prototype.isResolved=function(){return 0===this._status};a.prototype.isRejected=function(){return 1===this._status};a.prototype.isFulfilled=function(){return null!=this._status};a.prototype.abort=function(){this._resolver.reject(k.createAbortError())};a.prototype.when=function(a,b){return this._resolver.promise.then(a,b)};a.prototype._cleanUp=function(){this._allPromise=this._resolvingPromises=this._allPromise=null};a.prototype._tryResolve=
function(){var a=this;if(!this.isFulfilled()){var b=k.createDeferred(),d=e.__spreadArrays(this._resolvingPromises,[b.promise]),c=this._allPromise=k.all(d);c.then(function(){a.isFulfilled()||a._allPromise!==c||a._resolver.resolve(a.instance)},function(b){a.isFulfilled()||a._allPromise!==c||k.isAbortError(b)||a._resolver.reject(b)});b.resolve()}};return a}();a.EsriPromiseMixin=function(a){return function(a){function b(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;
b._promiseProps=new g(b);b.addResolvingPromise(k.resolve());return b}e.__extends(b,a);b.prototype.isResolved=function(){return this._promiseProps.isResolved()};b.prototype.isRejected=function(){return this._promiseProps.isRejected()};b.prototype.isFulfilled=function(){return this._promiseProps.isFulfilled()};b.prototype.when=function(b,a){var d=this;return k.create(function(b,a){d._promiseProps.when(b,a)}).then(b,a)};b.prototype.catch=function(b){return this.when(null,b)};b.prototype.addResolvingPromise=
function(b){b&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in b?b.when():b)};return b=e.__decorate([l.subclass("esri.core.Promise")],b)}(a)};f=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}e.__extends(c,a);return c=e.__decorate([l.subclass("esri.core.Promise")],c)}(a.EsriPromiseMixin(m));a.EsriPromise=f})},"esri/core/Warning":function(){define(["require","exports","tslib","./Message"],function(f,a,e,m){f=function(a){function f(g,
c,h){var b=a.call(this,g,c,h)||this;return b instanceof f?b:new f(g,c,h)}e.__extends(f,a);return f}(m);f.prototype.type="warning";return f})},"esri/portal/PortalQueryParams":function(){define("require exports tslib ../core/Accessor ../core/jsonMap ../core/lang ../core/accessorSupport/decorators ../geometry/Extent ../geometry/SpatialReference ../geometry/support/webMercatorUtils".split(" "),function(f,a,e,m,k,l,g,c,h,b){var d=new k.default({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",
numViews:"num-views"});return function(a){function n(b){b=a.call(this,b)||this;b.categories=null;b.disableExtraQuery=!1;b.extent=null;b.num=10;b.query=null;b.sortField=null;b.start=1;return b}e.__extends(n,a);f=n;Object.defineProperty(n.prototype,"sortOrder",{get:function(){return this._get("sortOrder")||"asc"},set:function(b){"asc"!==b&&"desc"!==b||this._set("sortOrder",b)},enumerable:!0,configurable:!0});n.prototype.clone=function(){return new f({categories:this.categories?l.clone(this.categories):
null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})};n.prototype.toRequestOptions=function(a,c){var g;this.categories&&(g=this.categories.map(function(b){return Array.isArray(b)?JSON.stringify(b):b}));var n;if(this.extent){var f=b.project(this.extent,h.WGS84);f&&(n=f.xmin+","+f.ymin+","+f.xmax+","+f.ymax)}f=this.query;!this.disableExtraQuery&&a.extraQuery&&(f="("+
f+")"+a.extraQuery);a={categories:g,bbox:n,q:f,num:this.num,sortField:null,sortOrder:null,start:this.start};this.sortField&&(a.sortField=this.sortField.split(",").map(function(b){return d.toJSON(b.trim())}).join(","),a.sortOrder=this.sortOrder);return{query:e.__assign(e.__assign({},c),a)}};var f;e.__decorate([g.property()],n.prototype,"categories",void 0);e.__decorate([g.property()],n.prototype,"disableExtraQuery",void 0);e.__decorate([g.property({type:c})],n.prototype,"extent",void 0);e.__decorate([g.property()],
n.prototype,"num",void 0);e.__decorate([g.property()],n.prototype,"query",void 0);e.__decorate([g.property()],n.prototype,"sortField",void 0);e.__decorate([g.property()],n.prototype,"sortOrder",null);e.__decorate([g.property()],n.prototype,"start",void 0);return n=f=e.__decorate([g.subclass("esri.portal.PortalQueryParams")],n)}(m)})},"esri/portal/PortalQueryResult":function(){define(["require","exports","tslib","../core/Accessor","../core/accessorSupport/decorators"],function(f,a,e,m,k){return function(a){function g(c){c=
a.call(this,c)||this;c.nextQueryParams=null;c.queryParams=null;c.results=null;c.total=null;return c}e.__extends(g,a);e.__decorate([k.property()],g.prototype,"nextQueryParams",void 0);e.__decorate([k.property()],g.prototype,"queryParams",void 0);e.__decorate([k.property()],g.prototype,"results",void 0);e.__decorate([k.property()],g.prototype,"total",void 0);return g=e.__decorate([k.subclass("esri.portal.PortalQueryResult")],g)}(m)})},"esri/portal/PortalUser":function(){define("require exports tslib ../core/Error ../core/JSONSupport ../core/promiseUtils ../core/accessorSupport/decorators ./PortalFolder ./PortalGroup @dojo/framework/shim/Promise".split(" "),
function(f,a,e,m,k,l,g,c,h){return function(b){function a(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];a=b.apply(this,a)||this;a.access=null;a.created=null;a.culture=null;a.description=null;a.email=null;a.fullName=null;a.modified=null;a.orgId=null;a.portal=null;a.preferredView=null;a.privileges=null;a.region=null;a.role=null;a.roleId=null;a.sourceJSON=null;a.units=null;a.username=null;a.userType=null;return a}e.__extends(a,b);n=a;Object.defineProperty(a.prototype,"thumbnailUrl",{get:function(){var b=
this.url,a=this.thumbnail;return b&&a?this.portal._normalizeUrl(b+"/info/"+a+"?f\x3djson"):null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"userContentUrl",{get:function(){var b=this.get("portal.restUrl");return b?b+"/content/users/"+this.username:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"url",{get:function(){var b=this.get("portal.restUrl");return b?b+"/community/users/"+this.username:null},enumerable:!0,configurable:!0});a.prototype.addItem=
function(b){var a=this,d=b&&b.item,c=b&&b.data;b=b&&b.folder;var h={method:"post"};d&&(h.query=d.createPostQuery(),null!=c&&("string"===typeof c?h.query.text=c:"object"===typeof c&&(h.query.text=JSON.stringify(c))));c=this.userContentUrl;b&&(c+="/"+("string"===typeof b?b:b.id));return this.portal._request(c+"/addItem",h).then(function(b){d.id=b.id;d.portal=a.portal;return d.loaded?d.reload():d.load()})};a.prototype.deleteItem=function(b){var a=this.userContentUrl;b.ownerFolder&&(a+="/"+b.ownerFolder);
return this.portal._request(a+("/items/"+b.id+"/delete"),{method:"post"}).then(function(){b.id=null;b.portal=null})};a.prototype.deleteItems=function(b){var a=this.userContentUrl+"/deleteItems",d=b.map(function(b){return b.id});return d.length?(d={method:"post",query:{items:d.join(",")}},this.portal._request(a,d).then(function(){b.forEach(function(b){b.id=null;b.portal=null})})):l.resolve(void 0)};a.prototype.fetchFolders=function(){var b=this;return this.portal._request(this.userContentUrl,{query:{num:1}}).then(function(a){return a&&
a.folders?a.folders.map(function(a){a=c.fromJSON(a);a.portal=b.portal;return a}):[]})};a.prototype.fetchGroups=function(){var b=this;return this.portal._request(this.url).then(function(a){return a&&a.groups?a.groups.map(function(a){a=h.fromJSON(a);a.portal=b.portal;return a}):[]})};a.prototype.fetchItems=function(b){var a=this;b||(b={});var d=this.userContentUrl;b.folder&&(d+="/"+b.folder.id);var c;return(new Promise(function(b,a){f(["./PortalItem"],b,a)})).then(function(h){c=h;return a.portal._request(d,
{query:{folders:!1,num:b.num||10,start:b.start||1,sortField:b.sortField||"created",sortOrder:b.sortOrder||"asc"}})}).then(function(b){var d;return b&&b.items?(d=b.items.map(function(b){b=c.fromJSON(b);b.portal=a.portal;return b}),l.all(d.map(function(b){return b.load()})).catch(function(b){return b}).then(function(){return{items:d,nextStart:b.nextStart,total:b.total}})):{items:[],nextStart:-1,total:0}})};a.prototype.fetchTags=function(){return this.portal._request(this.url+"/tags").then(function(b){return b.tags})};
a.prototype.getThumbnailUrl=function(b){var a=this.thumbnailUrl;a&&b&&(a+="\x26w\x3d"+b);return a};a.prototype.queryFavorites=function(b){return this.favGroupId?(this._favGroup||(this._favGroup=new h({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(b)):l.reject(new m("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))};a.prototype.toJSON=function(){throw new m("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");};a.fromJSON=
function(b){if(!b)return null;if(b.declaredClass)throw Error("JSON object is already hydrated");var a=new n;a.sourceJSON=b;a.read(b);return a};var n;e.__decorate([g.property()],a.prototype,"access",void 0);e.__decorate([g.property({type:Date})],a.prototype,"created",void 0);e.__decorate([g.property()],a.prototype,"culture",void 0);e.__decorate([g.property()],a.prototype,"description",void 0);e.__decorate([g.property()],a.prototype,"email",void 0);e.__decorate([g.property()],a.prototype,"favGroupId",
void 0);e.__decorate([g.property()],a.prototype,"fullName",void 0);e.__decorate([g.property({type:Date})],a.prototype,"modified",void 0);e.__decorate([g.property()],a.prototype,"orgId",void 0);e.__decorate([g.property()],a.prototype,"portal",void 0);e.__decorate([g.property()],a.prototype,"preferredView",void 0);e.__decorate([g.property()],a.prototype,"privileges",void 0);e.__decorate([g.property()],a.prototype,"region",void 0);e.__decorate([g.property()],a.prototype,"role",void 0);e.__decorate([g.property()],
a.prototype,"roleId",void 0);e.__decorate([g.property()],a.prototype,"sourceJSON",void 0);e.__decorate([g.property()],a.prototype,"thumbnail",void 0);e.__decorate([g.property({dependsOn:["url","thumbnail","portal.credential.token"],readOnly:!0})],a.prototype,"thumbnailUrl",null);e.__decorate([g.property()],a.prototype,"units",void 0);e.__decorate([g.property({dependsOn:["portal.restUrl"],readOnly:!0})],a.prototype,"userContentUrl",null);e.__decorate([g.property({dependsOn:["portal.restUrl"],readOnly:!0})],
a.prototype,"url",null);e.__decorate([g.property()],a.prototype,"username",void 0);e.__decorate([g.property()],a.prototype,"userType",void 0);return a=n=e.__decorate([g.subclass("esri.portal.PortalUser")],a)}(k.JSONSupport)})},"esri/portal/PortalFolder":function(){define("require exports tslib ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators".split(" "),function(f,a,e,m,k,l){return function(a){function c(c){c=a.call(this,c)||this;c.created=null;c.id=null;c.portal=null;c.title=
null;c.username=null;return c}e.__extends(c,a);Object.defineProperty(c.prototype,"url",{get:function(){var a=this.get("portal.restUrl");return a?a+"/content/users/"+this.username+"/"+this.id:null},enumerable:!0,configurable:!0});c.prototype.toJSON=function(){throw new m("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented");};e.__decorate([l.property({type:Date})],c.prototype,"created",void 0);e.__decorate([l.property()],c.prototype,"id",void 0);e.__decorate([l.property()],c.prototype,
"portal",void 0);e.__decorate([l.property()],c.prototype,"title",void 0);e.__decorate([l.property({dependsOn:["portal.restUrl"],readOnly:!0})],c.prototype,"url",null);e.__decorate([l.property()],c.prototype,"username",void 0);return c=e.__decorate([l.subclass("esri.portal.PortalFolder")],c)}(k.JSONSupport)})},"esri/portal/PortalGroup":function(){define("require exports tslib ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ./PortalQueryParams".split(" "),
function(f,a,e,m,k,l,g,c){return function(a){function b(b){b=a.call(this,b)||this;b.access=null;b.created=null;b.description=null;b.id=null;b.isInvitationOnly=!1;b.modified=null;b.owner=null;b.portal=null;b.snippet=null;b.sortField=null;b.sortOrder=null;b.tags=null;b.title=null;return b}e.__extends(b,a);Object.defineProperty(b.prototype,"thumbnailUrl",{get:function(){var b=this.url,a=this.thumbnail;return b&&a?this.portal._normalizeUrl(b+"/info/"+a+"?f\x3djson"):null},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"url",{get:function(){var b=this.get("portal.restUrl");return b?b+"/community/groups/"+this.id:null},enumerable:!0,configurable:!0});b.prototype.fetchCategorySchema=function(b){var a=this;return this.portal._request(this.url+"/categorySchema",b).then(function(d){d=d.categorySchema||[];return d.some(function(b){return"contentCategorySetsGroupQuery.LivingAtlas"===b.source})?a._fetchCategorySchemaSet("LivingAtlas",b):d})};b.prototype.fetchMembers=function(b){return this.portal._request(this.url+
"/users",b)};b.prototype.getThumbnailUrl=function(b){var a=this.thumbnailUrl;a&&b&&(a+="\x26w\x3d"+b);return a};b.prototype.toJSON=function(){throw new m("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");};b.prototype.queryItems=function(b,a){b=g.ensureType(c,b);if(5<parseFloat(this.portal.currentVersion))return b=b||new c,this.portal._queryPortal("/content/groups/"+this.id+"/search",b,"PortalItem",a);b=b?b.clone():new c;b.query="group:"+this.id+(b.query?" "+b.query:"");
return this.portal.queryItems(b,a)};b.prototype._fetchCategorySchemaSet=function(b,a){var d=this;return this.portal._fetchSelf(this.portal.authMode,!0,a).then(function(b){if(b=b.contentCategorySetsGroupQuery){var h=new c;h.disableExtraQuery=!0;h.num=1;h.query=b;return d.portal.queryGroups(h,a)}throw new m("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found");}).then(function(d){if(d.total){d=d.results[0];var h=new c;h.num=1;h.query='typekeywords:"'+b+'"';return d.queryItems(h,
a)}throw new m("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found");}).then(function(b){return b.total?b.results[0].fetchData("json",a).then(function(b){return(b=b&&b.categorySchema)&&b.length?b:[]}):[]})};e.__decorate([l.property()],b.prototype,"access",void 0);e.__decorate([l.property({type:Date})],b.prototype,"created",void 0);e.__decorate([l.property()],b.prototype,"description",void 0);e.__decorate([l.property()],b.prototype,"id",void 0);e.__decorate([l.property()],
b.prototype,"isInvitationOnly",void 0);e.__decorate([l.property({type:Date})],b.prototype,"modified",void 0);e.__decorate([l.property()],b.prototype,"owner",void 0);e.__decorate([l.property()],b.prototype,"portal",void 0);e.__decorate([l.property()],b.prototype,"snippet",void 0);e.__decorate([l.property()],b.prototype,"sortField",void 0);e.__decorate([l.property()],b.prototype,"sortOrder",void 0);e.__decorate([l.property()],b.prototype,"tags",void 0);e.__decorate([l.property()],b.prototype,"thumbnail",
void 0);e.__decorate([l.property({dependsOn:["url","thumbnail","portal.credential.token"],readOnly:!0})],b.prototype,"thumbnailUrl",null);e.__decorate([l.property()],b.prototype,"title",void 0);e.__decorate([l.property({dependsOn:["portal.restUrl"],readOnly:!0})],b.prototype,"url",null);return b=e.__decorate([l.subclass("esri.portal.PortalGroup")],b)}(k.JSONSupport)})},"esri/symbols/Symbol":function(){define("require exports tslib ../Color ../core/jsonMap ../core/JSONSupport ../core/accessorSupport/decorators".split(" "),
function(f,a,e,m,k,l,g){var c=new k.default({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"}),h=0;return function(b){function a(a){a=b.call(this,a)||this;a.id="sym"+h++;a.type=null;return a}e.__extends(a,b);Object.defineProperty(a.prototype,
"color",{set:function(b){this._set("color",b)},enumerable:!0,configurable:!0});a.prototype.readColor=function(b){return b&&null!=b[0]?[b[0],b[1],b[2],b[3]/255]:b};a.prototype.collectRequiredFields=function(b,a){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(b){return[2]})})};a.prototype.hash=function(){return JSON.stringify(this.toJSON())};a.prototype.clone=function(){};e.__decorate([g.property({type:c.apiValues,json:{read:c.read,write:{ignoreOrigin:!0,writer:c.write}}})],
a.prototype,"type",void 0);e.__decorate([g.property({type:m,value:new m([0,0,0,1]),json:{write:{allowNull:!0}}})],a.prototype,"color",null);e.__decorate([g.reader("color")],a.prototype,"readColor",null);return a=e.__decorate([g.subclass("esri.symbols.Symbol")],a)}(l.JSONSupport)})},"esri/symbols/cim/cimSymbolUtils":function(){define("require exports tslib ../../request ../../core/Logger ../../core/promiseUtils ./cimAnalyzer".split(" "),function(f,a,e,m,k,l,g){function c(b,a){return e.__awaiter(this,
void 0,void 0,function(){var d,c;return e.__generator(this,function(g){switch(g.label){case 0:if(b.data||!b.styleUrl||!b.styleName)return[2,b];d=b.styleName;c=b;return[4,h(d,b.styleUrl,a)];case 1:return c.data=g.sent(),[2,b]}})})}function h(b,c,h){return e.__awaiter(this,void 0,void 0,function(){var g,n;return e.__generator(this,function(f){if(r.has(b))return[2,r.get(b).then(function(b){return a.makeSymbolRef(b.data)})];try{return g=c+"/resources/styles/cim/"+b+".json",n=m(g,e.__assign({responseType:"json",
query:{f:"json"}},h)),r.set(b,n),[2,n.then(function(b){return a.makeSymbolRef(b.data)})]}catch(A){return d.error("error requesting "+b+", reason is "+A.message),r.has(b)&&r.delete(b),[2,null]}})})}var b=this;Object.defineProperty(a,"__esModule",{value:!0});var d=k.getLogger("esri/symbols/support/cimSymbolUtils"),n=function(){function b(b,a){this.layers=b;this.data=a}Object.defineProperty(b.prototype,"type",{get:function(){return"expanded-cim"},enumerable:!0,configurable:!0});b.prototype.hash=function(){for(var b=
"",a=0,d=this.layers;a<d.length;a++)b+=d[a].templateHash;return b};return b}();a.expandSymbols=function(d,c,h){return e.__awaiter(b,void 0,void 0,function(){return e.__generator(this,function(b){return[2,l.all(d.map(function(b){return a.expandSymbol(b,c,h)}))]})})};var p=function(a,d){return e.__awaiter(b,void 0,void 0,function(){var b;return e.__generator(this,function(c){switch(c.label){case 0:return b=n.bind,[4,g.analyzeCIMSymbol(a.data,d)];case 1:return[2,new (b.apply(n,[void 0,c.sent(),a.data]))]}})})};
a.expandSymbol=function(a,d,h){return e.__awaiter(b,void 0,void 0,function(){var b,g;return e.__generator(this,function(e){switch(e.label){case 0:if(!a)return[2,null];if("cim"!==a.type)return[3,2];b=p;return[4,c(a,h)];case 1:return[2,b.apply(void 0,[e.sent(),d])];case 2:if("web-style"!==a.type)return[3,4];g=p;return[4,a.fetchCIMSymbol(h)];case 3:return[2,g.apply(void 0,[e.sent(),d])];case 4:return[2,a]}})})};a.fetchSymbol=function(b,a){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,
function(d){return b?"cim"===b.type?[2,c(b,a)]:"web-style"===b.type?[2,b.fetchCIMSymbol(a)]:[2,b]:[2,null]})})};a.fetchCIMData=c;a.makeSymbolRef=function(b,a){return null===b?null:"CIMSymbolReference"===b.type?b:{type:"CIMSymbolReference",symbol:b,primitiveOverrides:a}};var r=new Map})},"esri/symbols/cim/cimAnalyzer":function(){define("require exports tslib ../../Color ../../core/Logger ../../core/promiseUtils ../../core/screenUtils ../../core/string ../../support/arcadeOnDemand ./CIMSymbolHelper ./SDFHelper ./utils ../../views/2d/arcade/utils".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p){function r(b){switch(b){case "Butt":return 0;case "Square":return 2;default:return 1}}function q(b){switch(b){case "Bevel":return 0;case "Miter":return 2;default:return 1}}function x(b){switch(b){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"justify"}}function u(b){switch(b){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}}function v(b){var a="normal",
d="normal";b&&(b=b.toLowerCase(),-1!==b.indexOf("italic")?a="italic":-1!==b.indexOf("oblique")&&(a="oblique"),-1!==b.indexOf("bold")?d="bold":-1!==b.indexOf("light")&&(d="lighter"));return{style:a,weight:d}}function y(b,a,d,c){var h;b[a]?h=b[a]:(h={},b[a]=h);h[d]=c}function z(b){return(b=b.markerPlacement)&&b.angleToLine?1:0}function A(a,d,h,g,e,n){if(a){var f=a.symbolLayers;if(f){var p,x=b.CIMSymbolHelper.getSize(a);"CIMPointSymbol"===a.type&&"Map"===a.angleAlignment&&(p=1);for(var l=f.length;l--;){var k=
f[l];if(k&&!1!==k.enable){var u=[];b.OverrideHelper.findApplicableOverrides(k,d,u);switch(k.type){case "CIMSolidFill":B(k,h,u,g,e);break;case "CIMPictureFill":D(k,h,u,g,e);break;case "CIMHatchFill":C(k,h,u,g,e);break;case "CIMGradientFill":var m=h,v=g,y=e,A=c.numericHash(JSON.stringify(k)).toString();y.push({type:"fill",templateHash:A,materialHash:0===u.length?A:T(A,m,u,v),cim:k,materialOverrides:null,colorLocked:k.colorLocked,effects:k.effects,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,
offsetY:0,scaleX:1});break;case "CIMSolidStroke":E(k,h,u,g,e,"CIMPolygonSymbol"===a.type,x);break;case "CIMPictureStroke":F(k,h,u,g,e,"CIMPolygonSymbol"===a.type,x);break;case "CIMGradientStroke":var m=h,v=g,y=e,A="CIMPolygonSymbol"===a.type,K=x,L=k.primitiveName,Q=void 0!==k.width?k.width:4,S=r(k.capStyle),U=q(k.joinStyle),X=k.miterLimit,V=c.numericHash(JSON.stringify(k)).toString();y.push({type:"line",templateHash:V,materialHash:0===u.length?V:T(V,m,u,v),cim:k,materialOverrides:null,isOutline:A,
colorLocked:k.colorLocked,effects:k.effects,color:{r:128,g:128,b:128,a:1},width:N(L,m,"Width",v,Q),cap:N(L,m,"CapStyle",v,S),join:N(L,m,"JoinStyle",v,U),miterLimit:N(L,m,"MiterLimit",v,X),referenceWidth:K,zOrder:O(k.name),isDashed:!1});break;case "CIMCharacterMarker":I(k,h,u,g,e);break;case "CIMPictureMarker":if(I(k,h,u,g,e))break;"CIMLineSymbol"===a.type&&(p=z(k));J(k,h,u,g,e,p,x);break;case "CIMVectorMarker":if(I(k,h,u,g,e))break;"CIMLineSymbol"===a.type&&(p=z(k));m=u;u=h;v=g;y=e;A=p;K=x;L=n;if(U=
k.markerGraphics)for(Q=0,k.scaleSymbolsProportionally&&(S=k.frame)&&(Q=S.ymax-S.ymin),S=0;S<U.length;S++)if(X=U[S])if(V=X.symbol)switch(V.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":H(k,X,m,u,v,y,A,K,Q,L);break;case "CIMTextSymbol":G(k,X,u,m,v,y,A,K,Q)}break;default:R.error("Cannot analyze CIM layer",k.type)}}}}}}function B(b,a,d,h,g){var e=b.primitiveName,f=n.fromCIMColor(b.color),q=c.numericHash(JSON.stringify(b)).toString();g.push({type:"fill",templateHash:q,materialHash:0===
d.length?q:function(){return q},cim:b,materialOverrides:null,colorLocked:b.colorLocked,color:N(e,a,"Color",h,f,L),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:b.effects})}function D(b,a,d,h,g){var e=b.primitiveName,f=b.tintColor?n.fromCIMColor(b.tintColor):{r:255,g:255,b:255,a:1},q=c.numericHash(JSON.stringify(b)).toString(),p=c.numericHash(""+b.url+JSON.stringify(b.colorSubstitutions)).toString();g.push({type:"fill",templateHash:q,materialHash:0===d.length?p:function(){return p},cim:b,materialOverrides:null,
colorLocked:b.colorLocked,effects:b.effects,color:N(e,a,"TintColor",h,f,L),height:N(e,a,"Height",h,b.height),scaleX:N(e,a,"ScaleX",h,b.scaleX),angle:N(e,a,"Rotation",h,b.rotation),offsetX:N(e,a,"OffsetX",h,b.offsetX),offsetY:N(e,a,"OffsetY",h,b.offsetY)})}function C(b,a,d,h,g){var e=["Rotation","OffsetX","OffsetY"],n=d.filter(function(a){return a.primitiveName!==b.primitiveName&&-1===e.indexOf(a.propertyName)}),f=b.primitiveName,q=c.numericHash(JSON.stringify(b)).toString(),p=c.numericHash(""+b.separation+
JSON.stringify(b.lineSymbol)).toString();g.push({type:"fill",templateHash:q,materialHash:0===d.length?p:T(p,a,n,h),cim:b,materialOverrides:n,colorLocked:b.colorLocked,effects:b.effects,color:{r:255,g:255,b:255,a:1},height:N(f,a,"Separation",h,b.separation),scaleX:1,angle:N(f,a,"Rotation",h,b.rotation),offsetX:N(f,a,"OffsetX",h,b.offsetX),offsetY:N(f,a,"OffsetY",h,b.offsetY)})}function E(b,a,d,h,g,e,f){var p=c.numericHash(JSON.stringify(b)).toString(),x=b.primitiveName,l=n.fromCIMColor(b.color),k=
void 0!==b.width?b.width:4,u=r(b.capStyle),m=q(b.joinStyle),v=b.miterLimit;g.push({type:"line",templateHash:p,materialHash:0===d.length?p:function(){return p},cim:b,materialOverrides:null,isOutline:e,colorLocked:b.colorLocked,effects:b.effects,color:N(x,a,"Color",h,l,L),width:N(x,a,"Width",h,k),cap:N(x,a,"CapStyle",h,u),join:N(x,a,"JoinStyle",h,m),miterLimit:N(x,a,"MiterLimit",h,v),referenceWidth:f,zOrder:O(b.name),isDashed:!1})}function F(b,a,d,h,g,e,f){var p=c.numericHash(""+b.url+JSON.stringify(b.colorSubstitutions)).toString(),
x=b.primitiveName,l=n.fromCIMColor(b.tintColor),k=void 0!==b.width?b.width:4,u=r(b.capStyle),m=q(b.joinStyle),v=b.miterLimit,y=c.numericHash(JSON.stringify(b)).toString();g.push({type:"line",templateHash:y,materialHash:0===d.length?p:function(){return p},cim:b,materialOverrides:null,isOutline:e,colorLocked:b.colorLocked,effects:b.effects,color:N(x,a,"TintColor",h,l,L),width:N(x,a,"Width",h,k),cap:N(x,a,"CapStyle",h,u),join:N(x,a,"JoinStyle",h,m),miterLimit:N(x,a,"MiterLimit",h,v),referenceWidth:f,
zOrder:O(b.name),isDashed:!1})}function I(b,a,d,h,g){var e=b.markerPlacement;if(!e||"CIMMarkerPlacementInsidePolygon"!==e.type)return!1;var n=["Rotation","OffsetX","OffsetY"],f=d.filter(function(a){return a.primitiveName!==b.primitiveName&&-1===n.indexOf(a.propertyName)}),q=c.numericHash(JSON.stringify(b)).toString();g.push({type:"fill",templateHash:q,materialHash:0===d.length?q:T(q,a,f,h),cim:b,materialOverrides:f,colorLocked:b.colorLocked,effects:b.effects,color:{r:255,g:255,b:255,a:1},height:N(e.primitiveName,
a,"StepY",h,e.stepY),scaleX:1,angle:N(e.primitiveName,a,"GridAngle",h,e.gridAngle),offsetX:N(e.primitiveName,a,"OffsetX",h,e.offsetX),offsetY:N(e.primitiveName,a,"OffsetY",h,e.offsetY)});return!0}function J(b,a,d,h,g,e,f){for(var q=b.primitiveName,p=b.size,r=b.scaleX,x=b.rotation,l=b.offsetX,k=b.offsetY,u=n.fromCIMColor(b.tintColor),m=c.numericHash(""+b.url+JSON.stringify(b.colorSubstitutions)).toString(),v=!1,y="",z=0;z<d.length;z++){var A=d[z];A.primitiveName===q&&(void 0!==A.value?y+="-"+A.primitiveName+
"-"+A.propertyName+"-"+JSON.stringify(A.value):A.valueExpressionInfo&&(v=!0))}g.push({type:"marker",templateHash:c.numericHash(JSON.stringify(b)+y).toString(),materialHash:v?function(){return m}:m,cim:b,materialOverrides:null,colorLocked:b.colorLocked,effects:b.effects,scaleSymbolsProportionally:!1,alignment:e,size:N(q,a,"Size",h,p),scaleX:N(q,a,"ScaleX",h,r),rotation:N(q,a,"Rotation",h,x),offsetX:N(q,a,"OffsetX",h,l),offsetY:N(q,a,"OffsetY",h,k),color:N(q,a,"TintColor",h,u,L),anchorPoint:b.anchorPoint,
isAbsoluteAnchorPoint:"Relative"!==b.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:b.rotateClockwise,referenceSize:f,sizeRatio:1,markerPlacement:b.markerPlacement})}function G(a,d,h,g,f,q,p,r,l){b.OverrideHelper.findApplicableOverrides(d,g,[]);var k=d.geometry;if("x"in k&&"y"in k){var m=d.symbol,y;y=m.underline?"underline":m.strikethrough?"line-through":"none";var z=v(m.fontStyleName);m.font=e.__assign({family:m.fontFamilyName,decoration:y},z);var A=
a.frame,B=a.size/l;l=a.primitiveName;y=(m.height||0)*B;var z=m.angle||0,C=((m.offsetX||0)+(k.x-.5*(A.xmin+A.xmax)))*B,k=((m.offsetY||0)+(k.y-.5*(A.ymin+A.ymax)))*B,A=n.fromCIMColor(b.CIMSymbolHelper.getFillColor(m)),F=n.fromCIMColor(b.CIMSymbolHelper.getStrokeColor(m)),H=b.CIMSymbolHelper.getStrokeWidth(m);H||(F=n.fromCIMColor(b.CIMSymbolHelper.getFillColor(m.haloSymbol)),H=m.haloSize*B);for(var B="",E=0;E<g.length;E++){var I=g[E];I.primitiveName===l&&void 0!==I.value&&(B+="-"+I.primitiveName+"-"+
I.propertyName+"-"+JSON.stringify(I.value))}g=Number(a.colorLocked)+JSON.stringify(a.anchorPoint)+a.anchorPointUnits;q.push({type:"text",templateHash:c.numericHash(JSON.stringify(d)+g+B).toString(),materialHash:function(){return c.numericHash(JSON.stringify(m.font)).toString()},cim:m,materialOverrides:null,colorLocked:a.colorLocked,effects:a.effects,alignment:p,anchorPoint:{x:a.anchorPoint?a.anchorPoint.x:0,y:a.anchorPoint?a.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==a.anchorPointUnits,fontName:m.fontFamilyName,
decoration:"none",weight:"normal",style:"normal",size:N(l,h,"Size",f,y),angle:N(l,h,"Rotation",f,z),offsetX:N(l,h,"OffsetX",f,C),offsetY:N(l,h,"OffsetY",f,k),horizontalAlignment:x(m.horizontalAlignment),verticalAlignment:u(m.verticalAlignment),text:N(d.primitiveName,h,"TextString",f,d.textString,n._adjustTextCase,m.textCase),color:A,outlineColor:F,outlineSize:H,referenceSize:r,sizeRatio:1,markerPlacement:a.markerPlacement})}}function H(a,h,g,f,q,p,r,x,l,k){var u=h.geometry;if(u){var m=h.symbol.symbolLayers;
if(m)if(k)K(a,h,f,g,q,p,r,x,l);else{var v=m.length;for(k=function(){var k=m[v];if(!k||!1===k.enable)return"continue";switch(k.type){case "CIMSolidFill":case "CIMSolidStroke":var y=d.getExtent(u),z=d.getSDFMetrics(y,a.frame,a.size,a.anchorPoint,"Relative"!==a.anchorPointUnits),y=z[0],A=z[1],z=z[2],B="CIMSolidFill"===k.type,C={type:"sdf",geom:u,asFill:B},F=a.primitiveName,H=a.size,E=a.rotation||0,I=a.offsetX,D=a.offsetY,J=k.primitiveName,G=B?n.fromCIMColor(b.CIMSymbolHelper.getFillColor(k)):n.fromCIMColor(b.CIMSymbolHelper.getStrokeColor(k)),
O=B?{r:0,g:0,b:0,a:0}:n.fromCIMColor(b.CIMSymbolHelper.getStrokeColor(k)),T=b.CIMSymbolHelper.getStrokeWidth(k);if(!B&&!T)break;for(var B=!1,R="",Q=0;Q<g.length;Q++){var S=g[Q];if(S.primitiveName===J||S.primitiveName===F)void 0!==S.value?R+="-"+S.primitiveName+"-"+S.propertyName+"-"+JSON.stringify(S.value):S.valueExpressionInfo&&(B=!0)}var F=JSON.stringify(e.__assign(e.__assign({},a),{markerGraphics:null})),U=c.numericHash(JSON.stringify(C)).toString(),k={type:"marker",templateHash:c.numericHash(JSON.stringify(h)+
JSON.stringify(k)+F+R).toString(),materialHash:B?function(){return U}:U,cim:C,materialOverrides:null,colorLocked:a.colorLocked,effects:a.effects,scaleSymbolsProportionally:a.scaleSymbolsProportionally,alignment:r,anchorPoint:{x:A,y:z},isAbsoluteAnchorPoint:!1,size:N(a.primitiveName,f,"Size",q,H),rotation:N(a.primitiveName,f,"Rotation",q,E),offsetX:N(a.primitiveName,f,"OffsetX",q,I),offsetY:N(a.primitiveName,f,"OffsetY",q,D),scaleX:1,frameHeight:l,rotateClockwise:a.rotateClockwise,referenceSize:x,
sizeRatio:y,color:N(J,f,"Color",q,G,L),outlineColor:N(J,f,"Color",q,O,L),outlineWidth:N(J,f,"Width",q,T),markerPlacement:a.markerPlacement};p.push(k);break;default:K(a,h,f,g,q,p,r,x,l)}};v--;)k()}}}function K(a,d,h,e,n,f,q,p,r){d={type:a.type,enable:!0,name:a.name,colorLocked:a.colorLocked,primitiveName:a.primitiveName,anchorPoint:a.anchorPoint,anchorPointUnits:a.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:a.rotateClockwise,rotation:0,size:a.size,billboardMode3D:a.billboardMode3D,depth3D:a.depth3D,
frame:a.frame,markerGraphics:[d],scaleSymbolsProportionally:a.scaleSymbolsProportionally,respectFrame:a.respectFrame,clippingPath:a.clippingPath,effects:a.effects};for(var x=[],l=["Rotation","OffsetX","OffsetY"],x=e.filter(function(b){return b.primitiveName!==a.primitiveName||-1===l.indexOf(b.propertyName)}),k="",u=0;u<e.length;u++){var m=e[u];void 0!==m.value&&(k+="-"+m.primitiveName+"-"+m.propertyName+"-"+JSON.stringify(m.value))}m=b.CIMSymbolHelper.getTextureAnchor(d);e=m[0];var u=m[1],m=m[2],
v=a.primitiveName,y=a.rotation||0,z=a.offsetX||0,A=a.offsetY||0,k=c.numericHash(JSON.stringify(d)+k).toString();h={type:"marker",templateHash:k,materialHash:0===x.length?k:T(k,h,x,n),cim:d,materialOverrides:x,colorLocked:a.colorLocked,effects:a.effects,scaleSymbolsProportionally:a.scaleSymbolsProportionally,alignment:q,anchorPoint:{x:e,y:u},isAbsoluteAnchorPoint:!1,size:a.size,rotation:N(v,h,"Rotation",n,y),offsetX:N(v,h,"OffsetX",n,z),offsetY:N(v,h,"OffsetY",n,A),color:{r:0,g:0,b:0,a:0},outlineColor:{r:0,
g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:r,rotateClockwise:a.rotateClockwise,referenceSize:p,sizeRatio:m/g.pt2px(a.size),markerPlacement:a.markerPlacement};f.push(h)}function O(b){return b&&0===b.indexOf("Level_")?parseInt(b.substr(6),10):0}function L(b){if(!b||0===b.length)return null;b=(new m(b)).toRgba();return{r:b[0],g:b[1],b:b[2],a:b[3]}}function N(b,a,d,c,g,e,n){if(b=a[b]){var f=b[d];if("string"===typeof f||"number"===typeof f||f instanceof Array)return e?e.call(null,f,n):f;if(null!=
f&&f instanceof h.default)return function(b,a,d){b=p.callWithFeature(f,b,{$view:d},c.geometryType,a);null!==b&&e&&(b=e.call(null,b,n));return null!==b?b:g}}return g}function T(a,d,g,e){for(var f=function(b){if(b.valueExpressionInfo){var a=d[b.primitiveName]&&d[b.primitiveName][b.propertyName];a instanceof h.default&&(b.fn=function(b,d,c){return p.callWithFeature(a,b,{$view:c},e.geometryType,d)})}},n=0;n<g.length;n++)f(g[n]);return function(d,h,e){for(var n=0;n<g.length;n++){var f=g[n];f.fn&&(f.value=
f.fn(d,h,e))}return c.numericHash(a+b.OverrideHelper.buildOverrideKey(g)).toString()}}Object.defineProperty(a,"__esModule",{value:!0});var R=k.getLogger("esri.symbols.cim.cimAnalyzer");a.analyzeCIMSymbol=function(b,a,d,c){return e.__awaiter(this,void 0,void 0,function(){var g,n,f,q,p,r,x,k,u;return e.__generator(this,function(e){switch(e.label){case 0:g=d?d:[];if(!b)return[2,g];q={};if("CIMSymbolReference"!==b.type)return[3,3];n=b.symbol;f=b.primitiveOverrides;if(!f)return[3,2];p=[];r=function(b){var d=
b.valueExpressionInfo;d?(d=h.createRendererExpression(d.expression,a.spatialReference,a.fields).then(function(a){a&&y(q,b.primitiveName,b.propertyName,a)}),p.push(d)):null!=b.value&&y(q,b.primitiveName,b.propertyName,b.value)};x=0;for(k=f;x<k.length;x++)u=k[x],r(u);return[4,l.all(p)];case 1:e.sent(),e.label=2;case 2:return[3,4];case 3:return R.error("Expect cim type to be 'CIMSymbolReference'"),[2,g];case 4:switch(n.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":A(n,f,q,
a,g,c)}return[2,g]}})})};a.analyzeCIMResource=function(a,d){if(!d||0===d.length)return a;a=JSON.parse(JSON.stringify(a));b.OverrideHelper.applyOverrides(a,d);return a}})},"esri/core/screenUtils":function(){define(["require","exports","./compilerUtils"],function(f,a,e){function m(b){return b?72*b/96:0}function k(b,a){void 0===b&&(b=0);void 0===a&&(a=0);return{x:b,y:a}}function l(b,a){void 0===b&&(b=0);void 0===a&&(a=0);return[b,a]}function g(b,a){void 0===b&&(b=0);void 0===a&&(a=0);return{x:b,y:a}}
function c(b,a){void 0===b&&(b=0);void 0===a&&(a=0);return[b,a]}function h(b,a){return a?(a[0]=b.x,a[1]=b.y,2<a.length&&(a[2]=0),a):[b.x,b.y]}function b(b){return k(b.x,b.y)}function d(b,a){b=(b instanceof HTMLElement?b:b.surface).getBoundingClientRect();return k(a.clientX-b.left,a.clientY-b.top)}Object.defineProperty(a,"__esModule",{value:!0});var n=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;a.pt2px=function(b){return b?b/72*96:0};a.px2pt=m;a.toPt=function(b){if("string"===typeof b){if(n.test(b)){var a=
b.match(n),d=Number(a[1]),a=a[3]&&a[3].toLowerCase();b="-"===b.charAt(0);d="px"===a?m(d):d;return b?-d:d}console.warn("screenUtils.toPt: input not recognized!");return null}return b};a.createScreenPoint=k;a.createScreenPointArray=l;a.createRenderScreenPoint=g;a.createRenderScreenPointArray=c;a.createRenderScreenPointArray3=function(b,a,d){void 0===b&&(b=0);void 0===a&&(a=0);void 0===d&&(d=0);return[b,a,d]};a.castRenderScreenPointArray=function(b){return b};a.castRenderScreenPointArray3=function(b){return b};
a.castScreenPointArray=function(b){return b};a.screenToRender=function(b,a,d){var c,e;switch(b.type){case "2d":b=window.devicePixelRatio||1;c=a.x*b;e=a.y*b;break;case "3d":h(a,r),b.state.camera.screenToRender(r,p),c=p[0],e=p[1]}return d?(d.x=c,d.y=e,d):g(c,e)};a.renderToScreen=function(b,a,d){var c,g;switch(b.type){case "2d":b=window.devicePixelRatio||1;c=a.x/b;g=a.y/b;break;case "3d":h(a,p),b.state.camera.renderToScreen(p,r),c=r[0],g=r[1]}return d?(d.x=c,d.y=g,d):k(c,g)};a.screenArrayToRender=function(b,
a,d){var h,g;switch(b.type){case "2d":b=window.devicePixelRatio||1;h=a[0]*b;g=a[1]*b;break;case "3d":b.state.camera.screenToRender(a,p),h=p[0],g=p[1]}return d?(d[0]=h,d[1]=g,2<d.length&&(d[2]=0),d):c(h,g)};a.renderArrayToScreen=function(b,a,d){var c,h;switch(b.type){case "2d":b=window.devicePixelRatio||1;c=a[0]/b;h=a[0]/b;break;case "3d":b.state.camera.renderToScreen(a,r),c=r[0],h=r[1]}return d?(d[0]=c,d[1]=h,d):l(c,h)};a.screenPointArrayToObject=function(b,a){return a?(a.x=b[0],a.y=b[1],a):{x:b[0],
y:b[1]}};a.screenPointObjectToArray=h;a.createScreenPointFromEvent=b;a.createScreenPointFromNativeEvent=d;a.createScreenPointFromSupportedEvent=function(a,c){return c instanceof Event?d(a,c):b(c)};a.isSupportedScreenPointEvent=function(b){if(b instanceof Event)return!0;if("object"===typeof b&&"type"in b)switch(b=b.type,b){case "click":case "double-click":case "pointer-down":case "pointer-drag":case "pointer-enter":case "pointer-leave":case "pointer-up":case "pointer-move":case "immediate-click":case "immediate-double-click":case "hold":case "drag":case "mouse-wheel":return!0;
case "key-down":case "key-up":case "gamepad":case "focus":case "blur":break;default:e.neverReachedSilent(b)}return!1};var p=c(),r=l()})},"esri/symbols/cim/CIMSymbolHelper":function(){define("require exports tslib ../../Color ../../core/Logger ../cim/CIMPlacements ./CIMSymbolDrawHelper ./packingUtils".split(" "),function(f,a,e,m,k,l,g,c){function h(b,a){switch(a.type){case "CIMSymbolReference":var d={type:"point",x:0,y:0};b.drawSymbol(a.symbol,d);break;case "CIMPointSymbol":d={type:"point",x:0,y:0};
b.drawSymbol(a,d);break;case "CIMVectorMarker":d=new l.Placement,b.drawMarker(a,d)}return b.envelope()}Object.defineProperty(a,"__esModule",{value:!0});var b=Math.PI,d=b/2,n=k.getLogger("esri.symbols.cim.CIMSymbolHelper");f=function(){function a(){}a.getEnvelope=function(b){var a=new g.EnvDrawHelper;if(Array.isArray(b)){for(var d=void 0,c=0;c<b.length;c++){var e=b[c];d?d.union(h(a,e)):d=h(a,e)}return d}return h(a,b)};a.getTextureAnchor=function(b){b=this.getEnvelope(b);if(!b||0>=b.width||0>=b.height)return[0,
0,0];var a=96/72,d=b.height*a+2;return[(b.x+.5*b.width)*a/(b.width*a+2),-(b.y+.5*b.height)*a/d,d]};a.rasterize=function(b,a,d,c){void 0===c&&(c=!0);var h=d||this.getEnvelope(a);if(!h||0>=h.width||0>=h.height)return[null,0,0,0,0];var e=96/72,f=(h.x+.5*h.width)*e,n=(h.y+.5*h.height)*e;b.width=h.width*e;b.height=h.height*e;d||(b.width+=2,b.height+=2);d=b.getContext("2d");e=g.Transformation.createScale(e,-e);e.translate(.5*b.width-f,.5*b.height+n);e=new g.CanvasDrawHelper(d,e);switch(a.type){case "CIMPointSymbol":e.drawSymbol(a,
{type:"point",x:0,y:0});break;case "CIMVectorMarker":h=new l.Placement,e.drawMarker(a,h)}a=d.getImageData(0,0,b.width,b.height);a=new Uint8Array(a.data);if(c)for(c=void 0,d=0;d<a.length;d+=4)c=a[d+3]/255,a[d]*=c,a[d+1]*=c,a[d+2]*=c;return[a,b.width,b.height,-f/b.width,-n/b.height]};a.fromSimpleMarker=function(a){var c,h,g=a.style;if("circle"===g||"esriSMSCircle"===g){c=Math.acos(.995);h=Math.ceil(b/c/4);0===h&&(h=1);c=d/h;h*=4;g=[];g.push([50,0]);for(var e=1;e<h;e++)g.push([50*Math.cos(e*c),-50*Math.sin(e*
c)]);g.push([50,0]);c={rings:[g]};h={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("cross"===g||"esriSMSCross"===g)c=0,c={rings:[[[c,50],[c,c],[50,c],[50,-c],[c,-c],[c,-50],[-c,-50],[-c,-c],[-50,-c],[-50,c],[-c,c],[-c,50],[c,50]]]},h={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("diamond"===g||"esriSMSDiamond"===g)c={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},h={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("square"===g||"esriSMSSquare"===g)c={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},
h={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("x"===g||"esriSMSX"===g)c=0,c={rings:[[[0,c],[50-c,50],[50,50-c],[c,0],[50,c-50],[50-c,-50],[0,-c],[c-50,-50],[-50,c-50],[-c,0],[-50,50-c],[c-50,50],[0,c]]]},h={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("triangle"===g||"esriSMSTriangle"===g)h=2/3*100,g=h-100,c={rings:[[[-57.735026918962575,g],[0,h],[57.735026918962575,g],[-57.735026918962575,g]]]},h={xmin:-57.735026918962575,ymin:g,xmax:57.735026918962575,ymax:h};else if("arrow"===g||"esriSMSArrow"===
g)c={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},h={xmin:-50,ymin:-50,xmax:50,ymax:50};var f;c&&h&&(f=[{type:"CIMSolidFill",enable:!0,color:a.color}],a.outline&&f.push({type:"CIMSolidStroke",enable:!0,width:a.outline.width,color:a.outline.color}),f={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:a.angle,size:a.size,offsetX:a.xoffset,offsetY:a.yoffset,frame:h,markerGraphics:[{type:"CIMMarkerGraphic",geometry:c,symbol:{type:"CIMPolygonSymbol",symbolLayers:f}}]}]});
return f};a.fromCIMHatchFill=function(b){for(var a=void 0!==b.separation?b.separation:4,d=a/2,c=this._getLineSymbolPeriod(b.lineSymbol)||4;4>c;)c*=2;c/=2;return{type:"CIMVectorMarker",frame:{xmin:-c,xmax:c,ymin:-d,ymax:d},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-c,0],[c,0]]]},symbol:b.lineSymbol}],size:a}};a._getLineSymbolPeriod=function(b){if(b){var a=this._getEffectsRepeat(b.effects);if(a)return a;if(b.symbolLayers)for(a=0,b=b.symbolLayers;a<b.length;a++){var d=b[a],c=this._getEffectsRepeat(d.effects);
if(c)return c;if(d&&(d=this._getPlacementRepeat(d.markerPlacement)))return d}}return 0};a._getEffectsRepeat=function(b){if(b)for(var a=0;a<b.length;a++){var d=b[a];if(d)switch(d.type){case "CIMGeometricEffectDashes":if((d=d.dashTemplate)&&d.length){for(var a=b=0,c=d;a<c.length;a++)b+=c[a];d.length&1&&(b*=2);return b}break;case "CIMGeometricEffectWave":return d.period;default:n.error("unsupported geometric effect type "+d.type)}}return 0};a._getPlacementRepeat=function(b){if(b)switch(b.type){case "CIMMarkerPlacementAlongLineSameSize":case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineVariableSize":if((b=
b.placementTemplate)&&b.length){for(var a=0,d=0;d<b.length;d++)a+=b[d];b.length&1&&(a*=2);return a}}return 0};a.fromCIMInsidePolygon=function(b){var a=b.markerPlacement,d=a.stepX/2,c=a.stepY/2,d={xmin:-d,xmax:d,ymin:-c,ymax:c};b=e.__assign({type:b.type},b);b.markerPlacement=null;b.anchorPoint=null;return{type:"CIMVectorMarker",frame:d,markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMPointSymbol",symbolLayers:[b]}}],size:a.stepY}};a.getFillColor=function(b){if(!b)return null;
switch(b.type){case "CIMPolygonSymbol":if(b.symbolLayers){var d=0;for(b=b.symbolLayers;d<b.length;d++){var c=a.getFillColor(b[d]);if(null!=c)return c}}break;case "CIMTextSymbol":return a.getFillColor(b.symbol);case "CIMSolidFill":return b.color}};a.getStrokeColor=function(b){if(b)switch(b.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(b.symbolLayers){var d=0;for(b=b.symbolLayers;d<b.length;d++){var c=a.getStrokeColor(b[d]);if(void 0!==c)return c}}break;case "CIMTextSymbol":return a.getStrokeColor(b.symbol);
case "CIMSolidStroke":return b.color}};a.getStrokeWidth=function(b){if(b)switch(b.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(b.symbolLayers){var d=0;for(b=b.symbolLayers;d<b.length;d++){var c=a.getStrokeWidth(b[d]);if(void 0!==c)return c}}break;case "CIMTextSymbol":return a.getStrokeWidth(b.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return b.width}};a.getSize=function(b){if(b)switch(b.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":var d=
0;if(b.symbolLayers){var c=0;for(b=b.symbolLayers;c<b.length;c++){var h=a.getSize(b[c]);h>d&&(d=h)}}return d;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":return b.width;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":return b.size}};a.getMarkerScaleRatio=function(b){if(b)switch(b.type){case "CIMVectorMarker":if(!1!==b.scaleSymbolsProportionally&&b.frame)return b.size/(b.frame.ymax-b.frame.ymin)}return 1};return a}();a.CIMSymbolHelper=f;f=function(){function b(){}
b.rasterizeSimpleFill=function(b,a){"solid"!==a&&"none"!==a&&"esriSFSSolid"!==a&&"esriSFSNull"!==a||console.error("Unexpected: style does not require rasterization");b.width=8;b.height=8;var d=b.getContext("2d");d.strokeStyle="#FFFFFF";d.lineWidth=1;d.beginPath();if("vertical"===a||"cross"===a||"esriSFSCross"===a||"esriSFSVertical"===a)d.moveTo(0,0),d.lineTo(0,8);if("horizontal"===a||"cross"===a||"esriSFSCross"===a||"esriSFSHorizontal"===a)d.moveTo(0,0),d.lineTo(8,0);if("forward-diagonal"===a||"diagonal-cross"===
a||"esriSFSDiagonalCross"===a||"esriSFSForwardDiagonal"===a)d.moveTo(0,0),d.lineTo(8,8);if("backward-diagonal"===a||"diagonal-cross"===a||"esriSFSBackwardDiagonal"===a||"esriSFSDiagonalCross"===a)d.moveTo(8,0),d.lineTo(0,8);d.stroke();a=d.getImageData(0,0,b.width,b.height);a=new Uint8Array(a.data);for(var c=0;c<a.length;c+=4)d=a[c+3]/255,a[c]*=d,a[c+1]*=d,a[c+2]*=d;return[a,b.width,b.height]};b.rasterizeSimpleLine=function(b,a){switch(a){case "butt":a="Butt";break;case "square":a="Square";break;default:a=
"Round"}var d="Butt"===a;switch(b){case "dash":case "esriSLSDash":b=d?[4,3]:[3,4];break;case "dash-dot":case "esriSLSDashDot":b=d?[4,3,1,3]:[3,4,0,4];break;case "dot":case "esriSLSDot":b=d?[1,3]:[0,4];break;case "long-dash":case "esriSLSLongDash":b=d?[8,3]:[7,4];break;case "long-dash-dot":case "esriSLSLongDashDot":b=d?[8,3,1,3]:[7,4,0,4];break;case "long-dash-dot-dot":case "esriSLSDashDotDot":b=d?[8,3,1,3,1,3]:[7,4,0,4,0,4];break;case "short-dash":case "esriSLSShortDash":b=d?[4,1]:[3,2];break;case "short-dash-dot":case "esriSLSShortDashDot":b=
d?[4,1,1,1]:[3,2,0,2];break;case "short-dash-dot-dot":case "esriSLSShortDashDotDot":b=d?[4,1,1,1,1,1]:[3,2,0,2,0,2];break;case "short-dot":case "esriSLSShortDot":b=d?[1,1]:[0,2];break;case "solid":case "esriSLSSolid":case "none":n.error("Unexpected: style does not require rasterization");b=[0,0];break;default:n.error("Tried to rasterize SLS, but found an unexpected style: "+b+"!"),b=[0,0]}return this.rasterizeDash(b,a)};b.rasterizeDash=function(b,a){var d="Butt"===a,h="Square"===a;a=!d&&!h;for(var g=
0,e=0;e<b.length;e++)var f=b[e],g=g+f;for(var g=15*g,n=31*g,e=new Float32Array(n),p=a?225:15,f=0;f<n;++f)e[f]=p;for(var p=n=0,q=!0,l=0;l<b.length;l++){for(var f=b[l],n=p,p=p+15*f,k=n;k<p;){for(var r=0;31>r;){var f=r*g+k,m=a?(r-15)*(r-15):Math.abs(r-15);e[f]=q?d?Math.max(Math.max(n+7.5-k,m),Math.max(k-p+7.5,m)):m:a?Math.min((k-n)*(k-n)+m,(k-p)*(k-p)+m):h?Math.min(Math.max(k-n,m),Math.max(p-k,m)):Math.min(Math.max(k-n+7.5,m),Math.max(p+7.5-k,m));r++}k++}q=!q}b=e.length;d=new Uint8Array(4*b);for(f=0;f<
b;++f)c.packFloatRGBA((a?Math.sqrt(e[f]):e[f])/15,d,4*f);return[d,g,31]};return b}();a.SymbolHelper=f;f=function(){function b(){}b.findApplicableOverrides=function(a,d,c){if(d){if(a.primitiveName){for(var h=!1,g=0;g<c.length;g++){var e=c[g];if(e.primitiveName===a.primitiveName){h=!0;break}}if(!h)for(h=0;h<d.length;h++)e=d[h],e.primitiveName===a.primitiveName&&c.push(e)}switch(a.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(a.effects)for(h=0,g=a.effects;h<g.length;h++)e=
g[h],b.findApplicableOverrides(e,d,c);if(a.symbolLayers)for(e=0,a=a.symbolLayers;e<a.length;e++)b.findApplicableOverrides(a[e],d,c);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(a.effects)for(h=0,g=a.effects;h<g.length;h++)e=g[h],b.findApplicableOverrides(e,d,c);a.markerPlacement&&b.findApplicableOverrides(a.markerPlacement,
d,c);if("CIMVectorMarker"===a.type){if(a.markerGraphics)for(e=0,a=a.markerGraphics;e<a.length;e++)h=a[e],b.findApplicableOverrides(h,d,c),b.findApplicableOverrides(h.symbol,d,c)}else"CIMCharacterMarker"===a.type?b.findApplicableOverrides(a.symbol,d,c):"CIMHatchFill"===a.type&&b.findApplicableOverrides(a.lineSymbol,d,c)}}};b.applyOverrides=function(a,d,c,h){if(d){if(a.primitiveName)for(var g=0;g<d.length;g++){var e=d[g];if(e.primitiveName===a.primitiveName){var f;f=(f=e.propertyName)?f.charAt(0).toLowerCase()+
f.substr(1):f;h&&h.push({cim:a,nocapPropertyName:f,value:a[f]});e.expression&&(e.value=b.toValue(e.propertyName,e.expression));if(c){for(var n=!1,p=0,q=c;p<q.length;p++)q[p].primitiveName===a.primitiveName&&(n=!0);n||c.push(e)}a[f]=e.value}}switch(a.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(a.effects)for(e=0,f=a.effects;e<f.length;e++)g=f[e],b.applyOverrides(g,d,c,h);if(a.symbolLayers)for(g=0,a=a.symbolLayers;g<a.length;g++)b.applyOverrides(a[g],d,c,h);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(a.effects)for(e=
0,f=a.effects;e<f.length;e++)g=f[e],b.applyOverrides(g,d,c,h);if("CIMVectorMarker"===a.type&&a.markerGraphics)for(g=0,a=a.markerGraphics;g<a.length;g++)e=a[g],b.applyOverrides(e,d,c,h),b.applyOverrides(e.symbol,d,c,h)}}};b.restoreOverrides=function(b){for(var a=0;a<b.length;a++){var d=b[a];d.cim[d.nocapPropertyName]=d.value}};b.buildOverrideKey=function(b){for(var a="",d=0;d<b.length;d++){var c=b[d];void 0!==c.value&&(a+=""+c.primitiveName+c.propertyName+JSON.stringify(c.value))}return a};b.toValue=
function(b,a){return"DashTemplate"===b?a.split(" ").map(function(b){return Number(b)}):"Color"===b?(b=(new m(a)).toRgba(),b[3]*=255,b):a};return b}();a.OverrideHelper=f})},"esri/symbols/cim/CIMPlacements":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){this.setIdentity()}a.prototype.getAngle=function(){if(null==this.rz||0===this.rz&&1!==this.rz_c&&0!==this.rz_s)this.rz=Math.atan2(this.rz_s,this.rz_c);return this.rz};
a.prototype.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rz_c=1;this.rz_s=0};a.prototype.setTranslate=function(a,e){this.tx=a;this.ty=e};a.prototype.setTranslateZ=function(a){this.tz=a};a.prototype.setRotateCS=function(a,e){this.rz=void 0;this.rz_c=a;this.rz_s=e};a.prototype.setRotate=function(a){this.rz=a;this.rz_s=this.rz_c=void 0};a.prototype.setRotateY=function(a){this.ry=a};a.prototype.setScale=function(a){this.s=a};a.prototype.setMeasure=function(a){this.m=
a};return a}();a.Placement=f;f=function(){function a(){}a.prototype.next=function(){return null};return a}();a.EmptyPlacementCursor=f})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("require exports tslib ../../core/Logger ../../geometry/support/jsonUtils ../cim/CIMEffects ../cim/CIMOperators ../cim/CIMPlacements ./Rect".split(" "),function(f,a,e,m,k,l,g,c,h){Object.defineProperty(a,"__esModule",{value:!0});a.C_DEG_TO_RAD=Math.PI/180;var b=m.getLogger("esri.symbols.cim.CIMSymbolDrawHelper"),
d=function(){function b(b){this._t=b}b.createIdentity=function(){return new b([1,0,0,0,1,0])};b.prototype.clone=function(){return new b(this._t.slice())};b.prototype.transform=function(b){var a=this._t;return[a[0]*b[0]+a[1]*b[1]+a[2],a[3]*b[0]+a[4]*b[1]+a[5]]};b.createScale=function(a,d){return new b([a,0,0,0,d,0])};b.prototype.scale=function(b,a){var d=this._t;d[0]*=b;d[1]*=b;d[2]*=b;d[3]*=a;d[4]*=a;d[5]*=a;return this};b.prototype.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*
this._t[1])};b.createTranslate=function(a,d){return new b([0,0,a,0,0,d])};b.prototype.translate=function(b,a){var d=this._t;d[2]+=b;d[5]+=a;return this};b.createRotate=function(a){var d=Math.cos(a);a=Math.sin(a);return new b([d,-a,0,a,d,0])};b.prototype.rotate=function(a){return this.multiply(b.createRotate(a))};b.prototype.multiply=function(b){var a=this._t;b=b._t;var d=a[1]*b[0]+a[4]*b[1],c=a[2]*b[0]+a[5]*b[1]+b[2],h=a[0]*b[3]+a[3]*b[4],g=a[1]*b[3]+a[4]*b[4],e=a[2]*b[3]+a[5]*b[4]+b[5];a[0]=a[0]*
b[0]+a[3]*b[1];a[1]=d;a[2]=c;a[3]=h;a[4]=g;a[5]=e;return this};return b}();a.Transformation=d;f=function(){function h(b){this._transfos=[];this._sizeTransfos=[];this._transfos.push(b||d.createIdentity());this._sizeTransfos.push(b?b.scaleRatio():1)}h.prototype.transformPt=function(b){return this._transfos[this._transfos.length-1].transform(b)};h.prototype.transformSize=function(b){return b*this._sizeTransfos[this._sizeTransfos.length-1]};h.prototype.back=function(){return this._transfos[this._transfos.length-
1]};h.prototype.push=function(b,a){a=a?b.scaleRatio():1;b.multiply(this.back());this._transfos.push(b);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*a)};h.prototype.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};h.prototype.drawSymbol=function(b,a){if(b)switch(b.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(b,a)}};h.prototype.drawMultiLayerSymbol=function(b,a){if(b){var d=b.symbolLayers;if(d)if(b=
b.effects){if(a=this.executeEffects(b,a))for(b=a.next();b;)this.drawSymbolLayers(d,b),b=a.next()}else this.drawSymbolLayers(d,a)}};h.prototype.executeEffects=function(b,a){a=new l.SimpleGeometryCursor(a);for(var d=0;d<b.length;d++){var c=b[d],h=g.getEffectOperator(c);h&&(a=h.execute(a,c,1))}return a};h.prototype.drawSymbolLayers=function(b,a){for(var d=b.length;d--;){var c=b[d];if(c&&!1!==c.enable){var h=c.effects;if(h){if(h=this.executeEffects(h,a))for(var g=h.next();g;)this.drawSymbolLayer(c,g),
g=h.next()}else this.drawSymbolLayer(c,a)}}};h.prototype.drawSymbolLayer=function(b,a){switch(b.type){case "CIMSolidFill":this.drawSolidFill(a,b.color);break;case "CIMSolidStroke":this.drawSolidStroke(a,b.color,b.width,b.capStyle,b.joinStyle,b.miterLimit);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(b,a)}};h.prototype.drawMarkerLayer=function(b,a){var d=b.markerPlacement;if(d){var h=g.getPlacementOperator(d);if(h&&(a=h.execute(a,d,1)))for(d=a.next();d;)this.drawMarker(b,
d),d=a.next()}else d=new c.Placement,d.tx=a.x,d.ty=a.y,this.drawMarker(b,d)};h.prototype.drawMarker=function(b,a){switch(b.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(b,a);break;case "CIMVectorMarker":this.drawVectorMarker(b,a)}};h.prototype.drawPictureMarker=function(b,a){};h.prototype.drawVectorMarker=function(c,h){if(c){var g=c.markerGraphics;if(g){var e=c.size,f=c.frame,n=f?f.ymax-f.ymin:0,e=e&&n?e/n:1,n=d.createIdentity();f&&n.translate(.5*-(f.xmax+f.xmin),
.5*-(f.ymax+f.ymin));var p=c.anchorPoint;if(p){var k=p.x,p=p.y;"Absolute"!==c.anchorPointUnits&&f&&(k*=f.xmax-f.xmin,p*=f.ymax-f.ymin);n.translate(-k,-p)}1!==e&&n.scale(e,e);c.rotation&&n.rotate(c.rotation*a.C_DEG_TO_RAD);n.translate(c.offsetX||0,c.offsetY||0);n.translate(h.tx,h.ty);this.push(n,c.scaleSymbolsProportionally);for(c=0;c<g.length;c++)(h=g[c])&&h.symbol&&h.geometry||b.error("Invalid marker graphic",h),this.drawSymbol(h.symbol,h.geometry);this.pop()}}};return h}();a.CIMSymbolDrawHelper=
f;m=function(b){function a(){var a=b.call(this)||this;a.reset();return a}e.__extends(a,b);a.prototype.reset=function(){this._xmin=this._ymin=Infinity;this._xmax=this._ymax=-Infinity};a.prototype.envelope=function(){return new h.default(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};a.prototype._merge=function(b,a){b[0]-a<this._xmin&&(this._xmin=b[0]-a);b[0]+a>this._xmax&&(this._xmax=b[0]+a);b[1]-a<this._ymin&&(this._ymin=b[1]-a);b[1]+a>this._ymax&&(this._ymax=b[1]+a)};a.prototype.drawSolidFill=
function(b){if(b&&b.rings){var a=0;for(b=b.rings;a<b.length;a++){var d=b[a],c=d?d.length:0;if(2<c){this._merge(this.transformPt(d[0]),0);for(var h=1;h<c;++h)this._merge(this.transformPt(d[h]),0)}}}};a.prototype.drawSolidStroke=function(b,a,d){a=.5*this.transformSize(d);if(b=k.isPolygon(b)?b.rings:b.paths)for(d=0;d<b.length;d++){var c=b[d],h=c?c.length:0;if(1<h){this._merge(this.transformPt(c[0]),a);for(var g=1;g<h;++g)this._merge(this.transformPt(c[g]),a)}}};return a}(f);a.EnvDrawHelper=m;f=function(b){function a(a,
d){d=b.call(this,d)||this;d._ctx=a;return d}e.__extends(a,b);a.prototype.drawSolidFill=function(b,a){if(b&&b.rings){var d=this._ctx;d.fillStyle="string"===typeof a?a:"rgba("+Math.round(a[0])+","+Math.round(a[1])+","+Math.round(a[2])+","+a[3]/255+")";d.beginPath();a=0;for(b=b.rings;a<b.length;a++){var c=b[a],h=c?c.length:0;if(2<h){var g=this.transformPt(c[0]);d.moveTo(g[0],g[1]);for(var e=1;e<h;++e)g=this.transformPt(c[e]),d.lineTo(g[0],g[1]);d.closePath()}}d.fill("evenodd")}};a.prototype.drawSolidStroke=
function(b,a,d,c,h,g){if(a&&0!==d){var e=this._ctx;e.strokeStyle="string"===typeof a?a:"rgba("+Math.round(a[0])+","+Math.round(a[1])+","+Math.round(a[2])+","+a[3]/255+")";e.lineWidth=this.transformSize(d)+.5;this._setCapStyle(c);this._setJoinStyle(h);e.miterLimit=g;e.beginPath();a=!1;k.isPolygon(b)?(d=b.rings,a=!0):d=b.paths;for(b=0;b<d.length;b++)if(h=(c=d[b])?c.length:0,1<h){g=this.transformPt(c[0]);e.moveTo(g[0],g[1]);for(var f=1;f<h;++f)g=this.transformPt(c[f]),e.lineTo(g[0],g[1]);a&&e.closePath()}e.stroke()}};
a.prototype._setCapStyle=function(b){switch(b){case "Butt":this._ctx.lineCap="butt";break;case "Round":this._ctx.lineCap="round";break;case "Square":this._ctx.lineCap="square"}};a.prototype._setJoinStyle=function(b){switch(b){case "Bevel":this._ctx.lineJoin="bevel";break;case "Round":this._ctx.lineJoin="round";break;case "Miter":this._ctx.lineJoin="miter"}};return a}(f);a.CanvasDrawHelper=f})},"esri/symbols/cim/CIMEffects":function(){define(["require","exports","../../core/lang"],function(f,a,e){Object.defineProperty(a,
"__esModule",{value:!0});f=function(){function a(a){this._geometry=a}a.prototype.next=function(){var a=this._geometry;this._geometry=null;return a};return a}();a.SimpleGeometryCursor=f;a.clone=function(a){return e.clone(a)}})},"esri/symbols/cim/CIMOperators":function(){define("require exports ./effects/EffectAddControlPoints ./effects/EffectArrow ./effects/EffectBuffer ./effects/EffectCut ./effects/EffectDashes ./effects/EffectDonut ./effects/EffectJog ./effects/EffectMove ./effects/EffectOffset ./effects/EffectReverse ./effects/EffectRotate ./effects/EffectScale ./effects/EffectWave ./placements/PlacementAlongLineSameSize ./placements/PlacementAtExtremities ./placements/PlacementAtRatioPositions ./placements/PlacementOnLine ./placements/PlacementOnVertices ./placements/PlacementPolygonCenter".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u,v,y,z,A){Object.defineProperty(a,"__esModule",{value:!0});a.getEffectOperator=function(a){if(!a)return null;switch(a.type){case "CIMGeometricEffectAddControlPoints":return e.EffectAddControlPoints.local();case "CIMGeometricEffectArrow":return m.EffectArrow.local();case "CIMGeometricEffectBuffer":return k.EffectBuffer.local();case "CIMGeometricEffectCut":return l.EffectCut.local();case "CIMGeometricEffectDashes":return g.EffectDashes.local();case "CIMGeometricEffectDonut":return c.EffectDonut.local();
case "CIMGeometricEffectJog":return h.EffectJog.local();case "CIMGeometricEffectMove":return b.EffectMove.local();case "CIMGeometricEffectOffset":return d.EffectOffset.local();case "CIMGeometricEffectReverse":return n.EffectReverse.local();case "CIMGeometricEffectRotate":return p.EffectRotate.local();case "CIMGeometricEffectScale":return r.EffectScale.local();case "CIMGeometricEffectWave":return q.EffectWave.local()}return null};a.getPlacementOperator=function(b){if(!b)return null;switch(b.type){case "CIMMarkerPlacementAlongLineSameSize":return x.PlacementAlongLineSameSize.local();
case "CIMMarkerPlacementAtExtremities":return u.PlacementAtExtremities.local();case "CIMMarkerPlacementAtRatioPositions":return v.PlacementAtRatioPositions.local();case "CIMMarkerPlacementOnLine":return y.PlacementOnLine.local();case "CIMMarkerPlacementOnVertices":return z.PlacementOnVertices.local();case "CIMMarkerPlacementPolygonCenter":return A.PlacementPolygonCenter.local()}return null}})},"esri/symbols/cim/effects/EffectAddControlPoints":function(){define(["require","exports","../../../core/lang",
"../../../geometry/support/jsonUtils","../CIMCursor"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,h,b){return new l(a,h,b)};a.instance=null;return a}();a.EffectAddControlPoints=f;var l=function(){function a(a,h,b){this._inputGeometries=a;this._angleTolerance=void 0!==h.angleTolerance?h.angleTolerance:120;this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/
180)*Math.PI)}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(m.isPolygon(a))return this._isClosed=!0,a=e.clone(a),this._processMultipath(a.rings),a;if(m.isPolyline(a))return this._isClosed=!1,a=e.clone(a),this._processMultipath(a.paths),a;if(m.isExtent(a)){if(this._maxCosAngle)return a;this._isClosed=!0;a=[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]];this._processPath(a);return{rings:[a]}}a=this._inputGeometries.next()}return null};a.prototype._processMultipath=
function(a){if(a)for(var c=0;c<a.length;c++)this._processPath(a[c])};a.prototype._processPath=function(a){if(a){var c=a.length,b=a[0],d=void 0,g=void 0,e=void 0,f=void 0,l=void 0,x=void 0;this._isClosed&&++c;for(var u=1;u<c;++u){var m=void 0,m=this._isClosed&&u===c-1?a[0]:a[u],y=m[0]-b[0],z=m[1]-b[1],A=Math.sqrt(y*y+z*z);1<u&&0<A&&0<e&&(d*y+g*z)/A/e<=this._maxCosAngle&&k.setId(b,1);1===u&&(f=y,l=z,x=A);0<A&&(b=m,d=y,g=z,e=A)}this._isClosed&&0<e&&0<x&&(d*f+g*l)/x/e<=this._maxCosAngle&&k.setId(a[0],
1)}};return a}()})},"esri/symbols/cim/CIMCursor":function(){define(["require","exports","../../core/lang","../../geometry/support/jsonUtils","./CIMPlacements"],function(f,a,e,m,k){function l(b){if(b)for(var a=b.length-1;0<a;--a)b[a][0]-=b[a-1][0],b[a][1]-=b[a-1][1]}function g(b){if(b)for(var a=0;a<b.length;a++)l(b[a])}function c(b){if(b)for(var a=b.length,d=1;d<a;++d)b[d][0]+=b[d-1][0],b[d][1]+=b[d-1][1]}function h(b){if(b)for(var a=0;a<b.length;a++)c(b[a])}function b(b){b&&(m.isPolygon(b)?h(b.rings):
m.isPolyline(b)?h(b.paths):m.isMultipoint(b)&&c(b.points))}function d(b){b&&b.reverse()}function n(b){return{rings:[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]}}Object.defineProperty(a,"__esModule",{value:!0});a.cloneAndDecodeGeometry=function(a){a=e.clone(a);b(a);return a};a.deltaDecodeGeometry=b;a.deltaEncodeGeometry=function(b){b&&(m.isPolygon(b)?g(b.rings):m.isPolyline(b)?g(b.paths):m.isMultipoint(b)&&l(b.points))};a.reverseMultipath=function(b){if(b)for(var a=
0;a<b.length;a++)d(b[a])};a.reversePath=d;a.getCoord2D=function(b,a,d){return[b[0]+(a[0]-b[0])*d,b[1]+(a[1]-b[1])*d]};a.isClosedPath=function(b){return b&&0!==b.length?b[0][0]===b[b.length-1][0]&&b[0][1]===b[b.length-1][1]:!1};a.getId=function(b){return b[4]};a.setId=function(b,a){b[4]=a};f=function(){function b(b,a,d,c){this.acceptPolygon=a;this.acceptPolyline=d;this.geomUnitsPerPoint=c;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;b&&(m.isPolygon(b)?a&&(this.multiPath=b.rings,this.isClosed=
!0):m.isPolyline(b)?d&&(this.multiPath=b.paths,this.isClosed=!1):m.isExtent(b)&&a&&(this.multiPath=n(b).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length));this.internalPlacement=new k.Placement}b.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;var b=this.processPath(this.multiPath[this.pathIndex]);if(b)return b}this.pathIndex=this.pathCount=-1;return this.multiPath=null};
return b}();a.PathTransformationCursor=f;f=function(){function b(b,a,d,c){this.inputGeometries=b;this.acceptPolygon=a;this.acceptPolyline=d;this.geomUnitsPerPoint=c;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}b.prototype.next=function(){for(;;){if(!this.multiPath){for(var b=this.inputGeometries.next();b;)if(m.isPolygon(b)?this.acceptPolygon&&(this.multiPath=b.rings,this.isClosed=!0):m.isPolyline(b)?this.acceptPolyline&&(this.multiPath=b.paths,this.isClosed=!1):m.isExtent(b)&&this.acceptPolygon&&
(this.multiPath=n(b).rings,this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length;this.pathIndex=-1;break}else b=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,b=this.processPath(this.multiPath[this.pathIndex]))return b;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return b}();a.PathGeometryCursor=f})},"esri/symbols/cim/effects/EffectArrow":function(){define(["require",
"exports","tslib","../CIMCursor","../CurveHelper"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,h,b){return new l(a,h,b)};a.instance=null;return a}();a.EffectArrow=f;var l=function(a){function c(c,b,d){c=a.call(this,c,!1,!0)||this;c._curveHelper=new k.CurveHelper;c._width=(void 0!==b.width?b.width:5)*d;c._arrowType=b.geometricEffectArrowType;
c._offsetFlattenError=k.PIXEL_TOLERANCE*d;return c}e.__extends(c,a);c.prototype.processPath=function(a){switch(this._arrowType){default:return this._constructSimpleArrow(a,!0);case "Block":return this._constructSimpleArrow(a,!1);case "Crossed":return this._constructCrossedArrow(a)}};c.prototype._constructSimpleArrow=function(a,b){var d=this._curveHelper.calculatePathLength(a),c=this._width;d<2*c&&(c=d/2);d=this._curveHelper.getSubCurve(a,0,d-c);if(!d)return null;var h=c/2;if(this._curveHelper.isEmpty(d,
!1))return null;c=this._constructOffset(d,-h);if(!c)return null;d=this._constructOffset(d,h);if(!d)return null;var g=this._constructArrowBasePoint(c,-h);if(!g)return null;h=this._constructArrowBasePoint(d,h);if(!h)return null;a=a[a.length-1];b||(this._makeControlPoint(d,!0),this._makeControlPoint(c,!0));var e=new k.PathHelper;e.addPath(d,!0);e.lineTo(h);this._makeControlPoint(e.path());e.lineTo(a);this._makeControlPoint(e.path());e.lineTo(g);this._makeControlPoint(e.path());e.addPath(c,!1);return b?
{paths:[e.path()]}:(e.close(),{rings:[e.path()]})};c.prototype._constructCrossedArrow=function(a){var b=this._curveHelper.calculatePathLength(a),d=this._width;b<3.732050807568877*d&&(d=b/3.732050807568877);var c=this._curveHelper.getSubCurve(a,0,b-2.732050807568877*d);if(!c)return null;var h=d/2;if(this._curveHelper.isEmpty(c,!1))return null;var g=this._constructOffset(c,h);if(!g)return null;c=this._constructOffset(c,-h);if(!c)return null;b=this._curveHelper.getSubCurve(a,0,b-d);if(!b||this._curveHelper.isEmpty(b,
!1))return null;d=this._constructOffset(b,h);if(!d)return null;var e=this._constructOffset(b,-h);if(!e)return null;b=d[d.length-1];d=this._constructArrowBasePoint(d,h);if(!d)return null;var f=e[e.length-1],h=this._constructArrowBasePoint(e,-h);if(!h)return null;a=a[a.length-1];this._makeControlPoint(g,!1);this._makeControlPoint(c,!1);e=new k.PathHelper;e.addPath(g,!0);this._makeControlPoint(e.path());e.lineTo(f);e.lineTo(h);this._makeControlPoint(e.path());e.lineTo(a);this._makeControlPoint(e.path());
e.lineTo(d);this._makeControlPoint(e.path());e.lineTo(b);this._makeControlPoint(e.path());e.addPath(c,!1);return{paths:[e.path()]}};c.prototype._constructOffset=function(a,b){return this._curveHelper.offset(a,b,"Rounded",4,this._offsetFlattenError)};c.prototype._constructArrowBasePoint=function(a,b){if(!a||2>a.length)return null;var d=a[a.length-2];a=a[a.length-1];d=[a[0]-d[0],a[1]-d[1]];this._curveHelper.normalize(d);return[a[0]+d[1]*b,a[1]-d[0]*b]};c.prototype._makeControlPoint=function(a,b){void 0===
b&&(b=!1);b?m.setId(a[0],1):m.setId(a[a.length-1],1)};return c}(m.PathGeometryCursor)})},"esri/symbols/cim/CurveHelper":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});a.PIXEL_TOLERANCE=.03;f=function(){function a(){this._path=[]}a.prototype.path=function(){return this._path};a.prototype.addPath=function(a,e){e||a.reverse();Array.prototype.push.apply(this._path,a);e||a.reverse()};a.mergePath=function(a,e){e&&Array.prototype.push.apply(a,e)};a.prototype.startPath=
function(a){this._path.push(a)};a.prototype.lineTo=function(a){this._path.push(a)};a.prototype.close=function(){var a=this._path;1<a.length&&(a[0][0]===a[a.length-1][0]&&a[0][1]===a[a.length-1][1]||a.push([a[0][0],a[0][1]]))};return a}();a.PathHelper=f;f=function(){function a(a,e){void 0===a&&(a=0);void 0===e&&(e=!1)}a.prototype.normalize=function(a){var e=Math.sqrt(a[0]*a[0]+a[1]*a[1]);a[0]/=e;a[1]/=e};a.prototype.calculateLength=function(a,e){var f=e[0]-a[0];a=e[1]-a[1];return Math.sqrt(f*f+a*a)};
a.prototype.calculateSegLength=function(a,e){return this.calculateLength(a[e],a[e+1])};a.prototype.calculatePathLength=function(a){for(var e=0,f=a?a.length:0,g=0;g<f-1;++g)e+=this.calculateSegLength(a,g);return e};a.prototype.calculatePathArea=function(a){for(var e=0,f=a?a.length:0,g=0;g<f-1;++g)e+=(a[g+1][0]-a[g][0])*(a[g+1][1]+a[g][1]);return e/2};a.prototype.getCoord2D=function(a,e,f){return[a[0]+(e[0]-a[0])*f,a[1]+(e[1]-a[1])*f]};a.prototype.getSegCoord2D=function(a,e,f){return this.getCoord2D(a[e],
a[e+1],f)};a.prototype.getAngle=function(a,e,f){return Math.atan2(e[1]-a[1],e[0]-a[0])};a.prototype.getSegAngle=function(a,e,f){return this.getAngle(a[e],a[e+1],f)};a.prototype.getAngleCS=function(a,e,f){f=e[0]-a[0];a=e[1]-a[1];e=Math.sqrt(f*f+a*a);return 0<e?[f/e,a/e]:[1,0]};a.prototype.getSegAngleCS=function(a,e,f){return this.getAngleCS(a[e],a[e+1],f)};a.prototype.cut=function(a,e,f,g){f=0>=f?a[e]:this.getSegCoord2D(a,e,f);a=1<=g?a[e+1]:this.getSegCoord2D(a,e,g);return[f,a]};a.prototype.addSegment=
function(a,e,f){f&&a.push(e[0]);a.push(e[1])};a.prototype.getSubCurve=function(a,e,f){var g=[];return this.appendSubCurve(g,a,e,f)?g:null};a.prototype.appendSubCurve=function(a,e,f,g){for(var c=e?e.length-1:0,h=0,b=!0,d=0;d<c;){var n=this.calculateSegLength(e,d);if(0!==n){if(b){if(h+n>f){var p=(f-h)/n,l=1,k=!1;h+n>=g&&(l=(g-h)/n,k=!0);(p=this.cut(e,d,p,l))&&this.addSegment(a,p,b);if(k)break;b=!1}}else{if(h+n>g){(p=this.cut(e,d,0,(g-h)/n))&&this.addSegment(a,p,b);break}this.addSegment(a,[e[d],e[d+
1]],b)}h+=n}++d}return!0};a.prototype.getCIMPointAlong=function(a,e){for(var f=a?a.length-1:0,g=0,c=-1;c<f;){++c;var h=this.calculateSegLength(a,c);if(0!==h){if(g+h>e)return this.getCoord2D(a[c],a[c+1],(e-g)/h);g+=h}}return null};a.prototype.isEmpty=function(a,e){if(!a||1>=a.length)return!0;for(var f=a?a.length-1:0,g=-1;g<f;)if(++g,a[g+1][0]!==a[g][0]||a[g+1][1]!==a[g][1]||e&&a[g+1][2]!==a[g][2])return!1;return!0};a.prototype.offset=function(a,e,f,g,c){c;if(!a||2>a.length)return null;c=a.length;var h=
a[0][0]===a[c-1][0]&&a[0][1]===a[c-1][1];if(h){if(3>a.length)return null;--c}for(var b=[],d=h?a[c-1]:null,n=a[0],p=0;p<c;p++){var l=p===c-1?h?a[0]:null:a[p+1];if(d)if(l){var q=[l[0]-n[0],l[1]-n[1]];this.normalize(q);d=[n[0]-d[0],n[1]-d[1]];this.normalize(d);var k=d[0]*q[1]-d[1]*q[0],u=d[0]*q[0]+d[1]*q[1];if(0<=k===0>=e)k=[q[0]-d[0],q[1]-d[1]],this.normalize(k),u=Math.sqrt((1+u)/2),q=-Math.abs(e)/u,b.push([n[0]-k[0]*q,n[1]-k[1]*q]);else switch(f){case "Mitered":if(u=Math.sqrt((1+u)/2),0<u&&1/u<g){k=
[q[0]-d[0],q[1]-d[1]];this.normalize(k);q=Math.abs(e)/u;b.push([n[0]-k[0]*q,n[1]-k[1]*q]);break}case "Bevelled":b.push([n[0]+d[1]*e,n[1]-d[0]*e]);b.push([n[0]+q[1]*e,n[1]-q[0]*e]);break;case "Rounded":b.push([n[0]+d[1]*e,n[1]-d[0]*e]);for(var u=.2,m=1;5>m;m++,u+=.2)k=[d[1]*(1-u)+q[1]*u,-d[0]*(1-u)-q[0]*u],this.normalize(k),b.push([n[0]+k[0]*e,n[1]+k[1]*e]);b.push([n[0]+q[1]*e,n[1]-q[0]*e]);break;default:0>k?(b.push([n[0]+(d[1]+d[0])*e,n[1]+(d[1]-d[0])*e]),b.push([n[0]+(q[1]-q[0])*e,n[1]-(q[0]+q[1])*
e])):(u=Math.sqrt((1+Math.abs(u))/2),k=[q[0]-d[0],q[1]-d[1]],this.normalize(k),q=e/u,b.push([n[0]-k[0]*q,n[1]-k[1]*q]))}}else k=[n[0]-d[0],n[1]-d[1]],this.normalize(k),b.push([n[0]+k[1]*e,n[1]-k[0]*e]);else k=[l[0]-n[0],l[1]-n[1]],this.normalize(k),b.push([n[0]+k[1]*e,n[1]-k[0]*e]);d=n;n=l}h&&b.push([b[0][0],b[0][1]]);return b};return a}();a.CurveHelper=f})},"esri/symbols/cim/effects/EffectBuffer":function(){define(["require","exports","../../../geometry/support/jsonUtils","../CurveHelper"],function(f,
a,e,m){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,c,h){return new k(a,c,h)};a.instance=null;return a}();a.EffectBuffer=f;var k=function(){function a(a,c,h){this._inputGeometries=a;this._curveHelper=new m.CurveHelper;this._size=(void 0!==c.size?c.size:1)*h;this._offsetFlattenError=m.PIXEL_TOLERANCE*h}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(e.isExtent(a))if(0<
this._size){var c=[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]];if(c=this._curveHelper.offset(c,this._size,"Rounded",4,this._offsetFlattenError))return{rings:[c]}}else if(0>this._size){if(0<Math.min(a.xmax-a.xmin,a.ymax-a.ymin)+2*this._size)return{xmin:a.xmin-this._size,xmax:a.xmax+this._size,ymin:a.ymin-this._size,ymax:a.ymax+this._size}}else return a;if(e.isPolygon(a)){if(0===this._size)return a;for(var h=[],b=0,d=a.rings;b<d.length;b++)c=d[b],(c=this._curveHelper.offset(c,
this._size,"Rounded",4,this._offsetFlattenError))&&h.push(c);if(h.length)return{rings:h}}if(e.isPolyline(a)&&0<this._size){h=[];b=0;for(d=a.paths;b<d.length;b++){var f=d[b];if(f&&1<f.length&&(c=this._curveHelper.offset(f,this._size,"Rounded",4,this._offsetFlattenError),f=this._curveHelper.offset(f,-this._size,"Rounded",4,this._offsetFlattenError),c&&f)){for(var p=f.length-1;0<=p;p--)c.push(f[p]);c.push([c[0][0],c[0][1]]);h.push(c)}}if(h.length)return{rings:h}}e.isPoint(a);a=this._inputGeometries.next()}return null};
return a}()})},"esri/symbols/cim/effects/EffectCut":function(){define(["require","exports","tslib","../CIMCursor","../CurveHelper"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,h,b){return new l(a,h,b)};a.instance=null;return a}();a.EffectCut=f;var l=function(a){function c(c,b,d){c=a.call(this,c,!0,!0)||this;c._curveHelper=new k.CurveHelper;
c._beginCut=(void 0!==b.beginCut?b.beginCut:1)*d;c._endCut=(void 0!==b.endCut?b.endCut:1)*d;c._middleCut=(void 0!==b.middleCut?b.middleCut:0)*d;c._invert=void 0!==b.invert?b.invert:!1;0>c._beginCut&&(c._beginCut=0);0>c._endCut&&(c._endCut=0);0>c._middleCut&&(c._middleCut=0);return c}e.__extends(c,a);c.prototype.processPath=function(a){var b=this._beginCut,d=this._endCut,c=this._middleCut,h=this._curveHelper.calculatePathLength(a),g=[];if(!this._invert)0===b&&0===d&&0===c?g.push(a):b+d+c>=h||(0===
c?b=this._curveHelper.getSubCurve(a,b,h-d):((b=this._curveHelper.getSubCurve(a,b,.5*(h-c)))&&g.push(b),b=this._curveHelper.getSubCurve(a,.5*(h+c),h-d)),b&&g.push(b));else if(0!==b||0!==d||0!==c)b+d+c>=h?g.push(a):((b=this._curveHelper.getSubCurve(a,0,b))&&g.push(b),(b=this._curveHelper.getSubCurve(a,.5*(h-c),.5*(h+c)))&&g.push(b),(b=this._curveHelper.getSubCurve(a,h-d,d))&&g.push(b));return 0===g.length?null:{paths:g}};return c}(m.PathGeometryCursor)})},"esri/symbols/cim/effects/EffectDashes":function(){define("require exports tslib ../CIMCursor ../CurveHelper ../GeometryWalker".split(" "),
function(f,a,e,m,k,l){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,d){return new g(a,b,d)};a.instance=null;return a}();a.EffectDashes=f;var g=function(a){function c(b,d,c){b=a.call(this,b,!0,!0)||this;b._walker=new l.GeometryWalker;b._walker.updateTolerance(c);b._endings=d.lineDashEnding;b._customDashPos=void 0!==d.offsetAlongLine?d.offsetAlongLine*c:0;b._offsetAtEnd=
void 0!==d.customEndingOffset?d.customEndingOffset*c:0;b._pattern=new l.DashPattern;b._pattern.init(d.dashTemplate,!0);b._pattern.scale(c);return b}e.__extends(c,a);c.prototype.processPath=function(b){if(0===this._pattern.length())return this.iteratePath=!1,{paths:[b]};if(!this.iteratePath){var a=!0;switch(this._endings){default:this._pattern.extPtGap=0;break;case "FullPattern":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case "FullGap":this.isClosed||(this._pattern.extPtGap=
.5*this._pattern.lastValue());break;case "NoConstraint":this.isClosed||(a=!1);break;case "Custom":this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var c=this._walker.calculatePathLength(b);if(this._pattern.isEmpty()||c<.1*this._pattern.length()||!this._walker.init(b,this._pattern,a))return{paths:[b]}}if(this.iteratePath)b=this._pattern.nextValue();else{a=void 0;switch(this._endings){default:a=.5*this._pattern.firstValue();break;case "HalfGap":a=.5*-this._pattern.lastValue();break;case "FullGap":a=
-this._pattern.lastValue();break;case "FullPattern":a=0;break;case "NoConstraint":case "Custom":a=-this._customDashPos}b=a/this._pattern.length();b-=Math.floor(b);a=b*this._pattern.length();this._pattern.reset();b=this._pattern.nextValue();for(c=!1;a>=b;)a-=b,b=this._pattern.nextValue(),c=!c;b-=a;c?(this._walker.nextPosition(b),b=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(b),b=this._pattern.nextValue(),this._walker.nextPosition(b),b=this._pattern.nextValue())}(a=
this._walker.nextCurve(b))?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,1),k.PathHelper.mergePath(a,this._firstCurve),this._firstCurve=null)):(b=this._pattern.nextValue(),!this._walker.nextPosition(b)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(a=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,a=this._firstCurve,this._firstCurve=null);return{paths:[a]}};return c}(m.PathGeometryCursor)})},"esri/symbols/cim/GeometryWalker":function(){define(["require",
"exports","tslib","./CIMCursor","./CurveHelper"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){this._values=[];this._currentValue=this._length=this.ctrlPtGap=this.extPtGap=0}a.prototype.isEmpty=function(){return 0===this._values.length};a.prototype.size=function(){return this._values.length};a.prototype.init=function(a,h,b){void 0===b&&(b=!0);this._setEmpty();if(!a||0===a.length)return!1;for(var d=0;d<a.length;d++){var c=Math.abs(a[d]);b&&1E-7>c&&(c=
1E-7);this._values.push(c);this._length+=c}h&&a.length&1&&(this._length*=2);if(0===this._length)return!1;this.ctrlPtGap=this.extPtGap=0;this._currentValue=-1;return!0};a.prototype.scale=function(a){for(var c=this._values?this._values.length:0,b=0;b<c;++b)this._values[b]*=a;this._length*=a;this.extPtGap*=a;this.ctrlPtGap*=a};a.prototype.addValue=function(a){this._length+=a;this._values.push(a)};a.prototype.firstValue=function(){return this._values[0]};a.prototype.lastValue=function(){return this._values[this._values.length-
1]};a.prototype.nextValue=function(){this._currentValue++;this._currentValue===this._values.length&&(this._currentValue=0);return this._values[this._currentValue]};a.prototype.reset=function(){this._currentValue=-1};a.prototype.length=function(){return this._length};a.prototype._setEmpty=function(){this.extPtGap=this.ctrlPtGap=this._length=0;this._currentValue=-1;this._values.length=0};return a}();a.DashPattern=f;var l=function(){function a(){this.reset()}a.prototype.reset=function(){this.segment=
-1;this.abscissa=this.segmentLength=0;this.isPartEnd=this.isPathEnd=!1};a.prototype.isValid=function(){return-1!==this.segment};a.prototype.copyTo=function(a){a.segment=this.segment;a.segmentLength=this.segmentLength;a.abscissa=this.abscissa;a.isPathEnd=this.isPathEnd;a.isPartEnd=this.isPartEnd};return a}();f=function(a){function c(c,b){void 0===c&&(c=0);void 0===b&&(b=!1);c=a.call(this,c,b)||this;c._tolerance=k.PIXEL_TOLERANCE;c._currentPosition=new l;return c}e.__extends(c,a);c.prototype.updateTolerance=
function(a){this._tolerance=k.PIXEL_TOLERANCE*a};c.prototype.init=function(a,b,d){void 0===d&&(d=!0);d?(this._patternLength=b.length(),this._partExtPtGap=b.extPtGap,this._partCtrlPtGap=b.ctrlPtGap):this._partCtrlPtGap=this._partExtPtGap=this._patternLength=0;this._currentPosition.reset();this._partSegCount=0;this._path=a;this._seg=-1;return this.setPosAtNextPart()};c.prototype.curPositionIsValid=function(){return this._currentPosition.isValid()};c.prototype.nextPosition=function(a,b){void 0===b&&
(b=0);var d=new l;if(!this._nextPosition(a,d,null,b))return!1;d.copyTo(this._currentPosition);return!0};c.prototype.curPointAndAngle=function(a){a.pt=this._getPoint(this._currentPosition);var b=this._getAngle(this._currentPosition),d=b[1];a.ca=b[0];a.sa=d};c.prototype.nextPointAndAngle=function(a,b,d){void 0===d&&(d=0);var c=new l;if(!this._nextPosition(a,c,null,d))return!1;c.copyTo(this._currentPosition);b.pt=this._getPoint(c);a=this._getAngle(c);d=a[1];b.ca=a[0];b.sa=d;return!0};c.prototype.nextCurve=
function(a){if(0===a)return null;var b=[],d=new l;if(!this._nextPosition(a,d,b,1))return null;d.copyTo(this._currentPosition);return b};c.prototype.isPathEnd=function(){return this._currentPosition.isPathEnd};c.prototype.getPathEnd=function(){if(-1===this._currentPosition.segment)throw Error("missing segment");return this._path[this._currentPosition.segment+1]};c.prototype._nextPosition=function(a,b,d,c){if(this._currentPosition.isPathEnd)return!1;var h=this._currentPosition.abscissa;0<this._currentPosition.segmentLength&&
(h/=this._currentPosition.segmentLength);for(this._currentPosition.copyTo(b);b.abscissa+a*this._partLengthRatio>b.segmentLength+this._tolerance;)if(d&&(0===d.length&&(0===h?(h=this._path[b.segment],d.push([h[0],h[1]])):d.push(this.getSegCoord2D(this._path,b.segment,h))),h=this._path[b.segment+1],d.push([h[0],h[1]])),h=0,a-=(b.segmentLength-b.abscissa)/this._partLengthRatio,this._partSegCount)b.segment=this.nextSegment(),b.segmentLength=this.calculateSegLength(this._path,b.segment),b.abscissa=0,this._partSegCount--;
else{if(!this.setPosAtNextPart()){if(0===c)return!1;b.segmentLength=this.calculateSegLength(this._path,b.segment);b.isPartEnd=!0;1===c?(b.abscissa=b.segmentLength,b.isPathEnd=!0):b.abscissa=b.segmentLength+a;return!0}this._currentPosition.copyTo(b)}b.abscissa+=a*this._partLengthRatio;d&&(0===d.length&&(0===h?(h=this._path[b.segment],d.push([h[0],h[1]])):d.push(this.getSegCoord2D(this._path,b.segment,h))),a=b.abscissa/b.segmentLength,1===a?(h=this._path[b.segment+1],d.push([h[0],h[1]])):d.push(this.getSegCoord2D(this._path,
b.segment,a)));!this._partSegCount&&Math.abs(b.abscissa-b.segmentLength)<this._tolerance&&(b.isPathEnd=this._partIsLast,b.isPartEnd=!0);return!0};c.prototype._getPoint=function(a){if(-1===a.segment)throw Error("missing segment");return this.getSegCoord2D(this._path,a.segment,0>=a.segmentLength?0:a.abscissa/a.segmentLength)};c.prototype._getAngle=function(a){if(-1===a.segment)throw Error("missing segment");return this.getSegAngleCS(this._path,a.segment,0>=a.segmentLength?0:a.abscissa/a.segmentLength)};
c.prototype.setPosAtNextPart=function(){for(;this._partSegCount;)this.hasNextSegment()&&this.nextSegment(),this._partSegCount--;if(!this.hasNextSegment())return!1;this._partLength=0;this._partIsLast=!0;for(this._partSegCount=0;this.hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this.nextSegment()),this._partSegCount++,1===m.getId(this._path[this.getEndPointIndex()])){this._partIsLast=!this.hasNextSegment();break}for(var a=this._partSegCount;a;)this.previousSegment(),--a;
this._currentPosition.segment=this.nextSegment();this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment);this._currentPosition.abscissa=0;this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1;--this._partSegCount;a=this.getStartPointIndex();this._ctrlPtBegin=1===m.getId(this._path[a]);a=a+this._partSegCount+1;a>=this._path.length&&(a=0);this._ctrlPtEnd=1===m.getId(this._path[a]);if(0<this._patternLength){var a=this._ctrlPtBegin?this._partCtrlPtGap:
this._partExtPtGap,b=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap,d=Math.round((this._partLength-(a+b))/this._patternLength);0>=d&&(d=0<a+b?0:1);this._partLengthRatio=this._partLength/(a+b+d*this._patternLength);.01>this._partLengthRatio&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0};c.prototype.hasNextSegment=function(){return this._seg<this._path.length-2};c.prototype.previousSegment=function(){return--this._seg};c.prototype.nextSegment=function(){return++this._seg};
c.prototype.getStartPointIndex=function(){return this._seg};c.prototype.getEndPointIndex=function(){return this._seg+1};return c}(k.CurveHelper);a.GeometryWalker=f})},"esri/symbols/cim/effects/EffectDonut":function(){define(["require","exports","../../../geometry/support/jsonUtils","../CurveHelper"],function(f,a,e,m){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,
c,h){return new k(a,c,h)};a.instance=null;return a}();a.EffectDonut=f;var k=function(){function a(a,c,h){this._inputGeometries=a;this._curveHelper=new m.CurveHelper;this._width=(void 0!==c.width?c.width:2)*h;switch(c.method){default:this._method="Mitered";break;case "Bevelled":this._method="Bevelled";break;case "Rounded":case "TrueBuffer":this._method="Rounded";break;case "Square":this._method="Square"}this._option=c.option;this._offsetFlattenError=m.PIXEL_TOLERANCE*h;this._option}a.prototype.next=
function(){for(var a=this._inputGeometries.next();a;){if(e.isExtent(a)&&0<this._width){if(0>Math.min(a.xmax-a.xmin,a.ymax-a.ymin)-2*this._width)return a;var c=[];c.push([[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]);c.push([[a.xmin+this._width,a.ymin+this._width],[a.xmax-this._width,a.ymin+this._width],[a.xmax-this._width,a.ymax-this._width],[a.xmin+this._width,a.ymax-this._width],[a.xmin+this._width,a.ymin+this._width]]);return{rings:c}}if(e.isPolygon(a)&&0<this._width){for(var h=
[],c=[],b=0,a=a.rings;b<a.length;b++){var d=a[b],f=this._curveHelper.calculatePathLength(d);0<f&&h.push(d);var p=this._curveHelper.offset(d,this._width,this._method,4,this._offsetFlattenError);p&&(0>f&&p.reverse(),c.push(p));0>f&&h.push(d)}if(c.length)return{rings:c}}a=this._inputGeometries.next()}return null};return a}()})},"esri/symbols/cim/effects/EffectJog":function(){define(["require","exports","tslib","../CIMCursor","../CurveHelper"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",
{value:!0});f=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,h,b){return new l(a,h,b)};a.instance=null;return a}();a.EffectJog=f;var l=function(a){function c(c,b,d){c=a.call(this,c,!1,!0)||this;c._curveHelper=new k.CurveHelper;c._length=(void 0!==b.length?b.length:20)*d;c._angle=void 0!==b.angle?b.angle:225;c._position=void 0!==b.position?b.position:50;0>c._length&&(c._length=-c._length);20>c._position&&(c._position=
20);80<c._position&&(c._position=80);c._mirror=!1;return c}e.__extends(c,a);c.prototype.processPath=function(a){if(this._curveHelper.isEmpty(a,!1))return null;var b=a[0];a=a[a.length-1];this._curveHelper.normalize([a[0]-b[0],a[1]-b[1]]);var d=[b[0]+(a[0]-b[0])*this._position/100,b[1]+(a[1]-b[1])*this._position/100],c=Math.cos((90-this._angle)/180*Math.PI),h=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(h=-h);this._mirror=!this._mirror;return{paths:[[b,[d[0]-this._length/2*c,d[1]-this._length/
2*h],[d[0]+this._length/2*c,d[1]+this._length/2*h],a]]}};return c}(m.PathGeometryCursor)})},"esri/symbols/cim/effects/EffectMove":function(){define(["require","exports","../../../core/lang","../../../geometry/support/jsonUtils"],function(f,a,e,m){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,c,h){return new k(a,c,h)};a.instance=null;return a}();a.EffectMove=f;var k=
function(){function a(a,c,h){this._inputGeometries=a;this._offsetX=void 0!==c.offsetX?c.offsetX*h:0;this._offsetY=void 0!==c.offsetY?-c.offsetY*h:0}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(m.isExtent(a))return{xmin:a.xmin+this._offsetX,xmax:a.xmax+this._offsetX,ymin:a.ymin+this._offsetY,ymax:a.ymax+this._offsetY};if(m.isPolygon(a))return a=e.clone(a),this._moveMultipath(a.rings,this._offsetX,this._offsetY),a;if(m.isPolyline(a))return a=e.clone(a),this._moveMultipath(a.paths,
this._offsetX,this._offsetY),a;if(m.isMultipoint(a))return a=e.clone(a),this._movePath(a.points,this._offsetX,this._offsetY),a;if(m.isPoint(a))return{x:a.x+this._offsetX,y:a.y+this._offsetY};a=this._inputGeometries.next()}return null};a.prototype._moveMultipath=function(a,c,h){if(a)for(var b=0;b<a.length;b++)this._movePath(a[b],c,h)};a.prototype._movePath=function(a,c,h){if(a)for(var b=0;b<a.length;b++){var d=a[b];d[0]+=c;d[1]+=h}};return a}()})},"esri/symbols/cim/effects/EffectOffset":function(){define(["require",
"exports","../../../geometry/support/jsonUtils","../CurveHelper"],function(f,a,e,m){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,c,h){return new k(a,c,h)};a.instance=null;return a}();a.EffectOffset=f;var k=function(){function a(a,c,h){this._inputGeometries=a;this._curveHelper=new m.CurveHelper;this._offset=(void 0!==c.offset?c.offset:1)*h;this._method=c.method;
this._option=c.option;this._offsetFlattenError=m.PIXEL_TOLERANCE*h;this._option}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(0===this._offset)return a;if(e.isExtent(a)){if("Rounded"===this._method&&0<this._offset){var c=[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]];return(c=this._curveHelper.offset(c,this._offset,this._method,4,this._offsetFlattenError))?{rings:[c]}:null}if(0<Math.min(a.xmax-a.xmin,a.ymax-a.ymin)+2*this._offset)return{xmin:a.xmin-
this._offset,xmax:a.xmax+this._offset,ymin:a.ymin-this._offset,ymax:a.ymax+this._offset}}if(e.isPolygon(a)){for(var h=[],b=0,d=a.rings;b<d.length;b++)c=d[b],(c=this._curveHelper.offset(c,this._offset,this._method,4,this._offsetFlattenError))&&h.push(c);if(h.length)return{rings:h}}if(e.isPolyline(a)){h=[];b=0;for(a=a.paths;b<a.length;b++)(d=this._curveHelper.offset(a[b],this._offset,this._method,4,this._offsetFlattenError))&&h.push(d);if(h.length)return{paths:h}}a=this._inputGeometries.next()}return null};
return a}()})},"esri/symbols/cim/effects/EffectReverse":function(){define(["require","exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,h,b){return new l(a,h,b)};a.instance=null;return a}();a.EffectReverse=f;var l=function(){function a(a,h,b){this._inputGeometries=
a;this._reverse=void 0!==h.reverse?h.reverse:!0;b}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(!this._reverse)return a;if(m.isPolyline(a))return a=e.clone(a),k.reverseMultipath(a.paths),a;a=this._inputGeometries.next()}return null};return a}()})},"esri/symbols/cim/effects/EffectRotate":function(){define("require exports ../../../core/lang ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils".split(" "),function(f,
a,e,m,k,l){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,d){return new g(a,b,d)};a.instance=null;return a}();a.EffectRotate=f;var g=function(){function a(a,b,d){this._inputGeometries=a;this._rotateAngle=void 0!==b.angle?-b.angle*Math.PI/180:0;d}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(0===this._rotateAngle)return a;var b=m.create();
k.getBoundsXY(b,a);var d=(b[2]+b[0])/2,b=(b[3]+b[1])/2;if(l.isExtent(a))return a={rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]},this._rotateMultipath(a.rings,d,b),a;if(l.isPolygon(a))return a=e.clone(a),this._rotateMultipath(a.rings,d,b),a;if(l.isPolyline(a))return a=e.clone(a),this._rotateMultipath(a.paths,d,b),a;if(l.isMultipoint(a))return a=e.clone(a),this._rotatePath(a.points,d,b),a;if(l.isPoint(a))return a;a=this._inputGeometries.next()}return null};
a.prototype._rotateMultipath=function(a,b,d){if(a)for(var c=0;c<a.length;c++)this._rotatePath(a[c],b,d)};a.prototype._rotatePath=function(a,b,d){if(a)for(var c=Math.cos(this._rotateAngle),h=Math.sin(this._rotateAngle),e=0;e<a.length;e++){var g=a[e],f=g[0]-b,k=g[1]-d;g[0]=b+f*c-k*h;g[1]=d+f*h+k*c}};return a}()})},"esri/symbols/cim/effects/EffectScale":function(){define("require exports ../../../core/lang ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils".split(" "),
function(f,a,e,m,k,l){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,d){return new g(a,b,d)};a.instance=null;return a}();a.EffectScale=f;var g=function(){function a(a,b,d){this._inputGeometries=a;this._xFactor=void 0!==b.xScaleFactor?b.xScaleFactor:1.15;this._yFactor=void 0!==b.yScaleFactor?b.yScaleFactor:1.15;d}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(1===
this._xFactor&&1===this._yFactor)return a;var b=m.create();k.getBoundsXY(b,a);var d=(b[2]+b[0])/2,b=(b[3]+b[1])/2;if(l.isExtent(a))return a={rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]},this._scaleMultipath(a.rings,d,b),a;if(l.isPolygon(a))return a=e.clone(a),this._scaleMultipath(a.rings,d,b),a;if(l.isPolyline(a))return a=e.clone(a),this._scaleMultipath(a.paths,d,b),a;if(l.isMultipoint(a))return a=e.clone(a),this._scalePath(a.points,d,b),a;if(l.isPoint(a))return a;
a=this._inputGeometries.next()}return null};a.prototype._scaleMultipath=function(a,b,d){if(a)for(var c=0;c<a.length;c++)this._scalePath(a[c],b,d)};a.prototype._scalePath=function(a,b,d){if(a)for(var c=0;c<a.length;c++){var h=a[c],e=(h[1]-d)*this._yFactor;h[0]=b+(h[0]-b)*this._xFactor;h[1]=d+e}};return a}()})},"esri/symbols/cim/effects/EffectWave":function(){define(["require","exports","../../../geometry/support/jsonUtils","../CurveHelper","../GeometryWalker"],function(f,a,e,m,k){Object.defineProperty(a,
"__esModule",{value:!0});f=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,h,b){return new l(a,h,b)};a.instance=null;return a}();a.EffectWave=f;var l=function(){function a(a,h,b){this._inputGeometries=a;this._height=(void 0!==h.amplitude?h.amplitude:2)*b;this._period=(void 0!==h.period?h.period:3)*b;this._style=h.waveform;0>=this._height&&(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));
this._pattern=new k.DashPattern;this._pattern.addValue(this._period);this._pattern.addValue(this._period);this._walker=new k.GeometryWalker;this._walker.updateTolerance(b)}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(0===this._height||0===this._period)return a;if(e.isPolyline(a)){var h=this._processGeom(a.paths);if(h.length)return{paths:h}}if(e.isPolygon(a)&&(a=this._processGeom(a.rings),a.length))return{rings:a};a=this._inputGeometries.next()}return null};a.prototype._processGeom=
function(a){for(var c=[],b=0;b<a.length;b++){var d=a[b];if(this._walker.init(d,this._pattern))switch(this._style){default:c.push(this._constructCurve(d,!1));break;case "Square":c.push(this._constructSquare(d));break;case "Triangle":c.push(this._constructTriangle(d));break;case "Random":c.push(this._constructCurve(d,!0))}else c.push(d)}return c};a.prototype._constructCurve=function(a,h){var b=new m.PathHelper,d=this._walker.calculatePathLength(a),c=Math.round(d/this._period);0===c&&(c=1);var e=this._period/
16,g=1/(16*c+1),d=2*Math.PI*d/(d/c),c=2*Math.PI*Math.random(),f=2*Math.PI*Math.random(),k=2*Math.PI*Math.random(),l=.75-Math.random()/2,v=.75-Math.random()/2,y={};this._walker.curPointAndAngle(y);b.startPath(y.pt);for(var z=0;;)if(this._walker.nextPointAndAngle(e,y)){var A=z,z=z+g,B=void 0;if(h)var D=this._height/2*(1+.3*Math.sin(l*d*A+c)),B=D*Math.sin(d*A+f),B=B+D*Math.sin(v*d*A+k),B=B/2;else B=.5*this._height*Math.sin(.5*d*A);b.lineTo([y.pt[0]-B*y.sa,y.pt[1]+B*y.ca])}else{b.lineTo(a[a.length-1]);
break}return b.path()};a.prototype._constructSquare=function(a){var c=new m.PathHelper;a=this._walker.calculatePathLength(a);a=Math.round(a/this._period);0===a&&(a=1);for(a=!0;;){var b=!1;if(this._walker.curPositionIsValid()){var d={};this._walker.curPointAndAngle(d);var e={};if(this._walker.nextPointAndAngle(this._period,e)){var g={};this._walker.nextPointAndAngle(this._period,g)&&(a?(c.startPath(d.pt),a=!1):c.lineTo(d.pt),c.lineTo([d.pt[0]-this._height/2*d.sa,d.pt[1]+this._height/2*d.ca]),c.lineTo([e.pt[0]-
this._height/2*e.sa,e.pt[1]+this._height/2*e.ca]),c.lineTo([e.pt[0]+this._height/2*e.sa,e.pt[1]-this._height/2*e.ca]),c.lineTo([g.pt[0]+this._height/2*g.sa,g.pt[1]-this._height/2*g.ca]),b=!0)}}if(!b){c.lineTo(this._walker.getPathEnd());break}}return c.path()};a.prototype._constructTriangle=function(a){var c=new m.PathHelper;a=this._walker.calculatePathLength(a);a=Math.round(a/this._period);0===a&&(a=1);for(a=!0;;){var b=!1;if(this._walker.curPositionIsValid()){var d={};this._walker.curPointAndAngle(d);
var e={};if(this._walker.nextPointAndAngle(this._period/2,e)){var g={};this._walker.nextPointAndAngle(this._period,g)&&(this._walker.nextPosition(this._period/2)&&(a?(c.startPath(d.pt),a=!1):c.lineTo(d.pt),c.lineTo([e.pt[0]-this._height/2*e.sa,e.pt[1]+this._height/2*e.ca]),c.lineTo([g.pt[0]+this._height/2*g.sa,g.pt[1]-this._height/2*g.ca])),b=!0)}}if(!b){c.lineTo(this._walker.getPathEnd());break}}return c.path()};return a}()})},"esri/symbols/cim/placements/PlacementAlongLineSameSize":function(){define("require exports tslib ../CIMCursor ../enums ../GeometryWalker".split(" "),
function(f,a,e,m,k,l){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,d){return new g(a,b,d)};a.instance=null;return a}();a.PlacementAlongLineSameSize=f;var g=function(a){function c(b,d,c){b=a.call(this,b,!0,!0)||this;b._grometryWalker=new l.GeometryWalker;b._grometryWalker.updateTolerance(c);b._angleToLine=void 0!==d.angleToLine?d.angleToLine:!0;b._offset=void 0!==
d.offset?d.offset*c:0;b._originalEndings=d.endings;b._offsetAtEnd=void 0!==d.customEndingOffset?d.customEndingOffset*c:0;b._position=void 0!==d.offsetAlongLine?d.offsetAlongLine*c:0;b._pattern=new l.DashPattern;b._pattern.init(d.placementTemplate,!1);b._pattern.scale(c);b._endings=b._originalEndings;return b}e.__extends(c,a);c.prototype.processPath=function(b){if(this._pattern.isEmpty())return null;var a;if(this.iteratePath)a=this._pattern.nextValue();else{this._endings=this._originalEndings===k.PlacementEndings.WithFullGap&&
this.isClosed?k.PlacementEndings.WithMarkers:this._originalEndings;this._pattern.extPtGap=0;var c=!0;a=void 0;switch(this._endings){case k.PlacementEndings.NoConstraint:a=-this._position;a=this._adjustPosition(a);c=!1;break;default:a=-this._pattern.lastValue()/2;break;case k.PlacementEndings.WithFullGap:a=-this._pattern.lastValue();this._pattern.extPtGap=this._pattern.lastValue();break;case k.PlacementEndings.WithMarkers:a=0;break;case k.PlacementEndings.Custom:a=-this._position,a=this._adjustPosition(a),
this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._grometryWalker.init(b,this._pattern,c))return null;this._pattern.reset();for(b=0;a>b;)a-=b,b=this._pattern.nextValue();a=b-a;this.iteratePath=!0}b={};if(!this._grometryWalker.nextPointAndAngle(a,b)||this._endings===k.PlacementEndings.WithFullGap&&this._grometryWalker.isPathEnd())return this.iteratePath=!1,null;if(this._endings===k.PlacementEndings.WithMarkers&&this._grometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed))return null;this.internalPlacement.setTranslate(b.pt[0]+
this._offset*b.sa,b.pt[1]-this._offset*b.ca);this._angleToLine&&this.internalPlacement.setRotateCS(b.ca,b.sa);return this.internalPlacement};c.prototype._adjustPosition=function(b){b/=this._pattern.length();b-=Math.floor(b);return b*this._pattern.length()};return c}(m.PathTransformationCursor)})},"esri/symbols/cim/enums":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});f=a.PlacementEndings||(a.PlacementEndings={});f.NoConstraint="NoConstraint";
f.WithMarkers="WithMarkers";f.WithFullGap="WithFullGap";f.WithHalfGap="WithHalfGap";f.Custom="Custom"})},"esri/symbols/cim/placements/PlacementAtExtremities":function(){define(["require","exports","tslib","../CIMCursor","../CurveHelper"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,h,b){return new l(a,h,b)};a.instance=null;return a}();a.PlacementAtExtremities=
f;var l=function(a){function c(c,b,d){c=a.call(this,c,!1,!0)||this;c._curveHelper=new k.CurveHelper;c._angleToLine=void 0!==b.angleToLine?b.angleToLine:!0;c._offset=void 0!==b.offset?b.offset*d:0;c._type=b.extremityPlacement;c._position=void 0!==b.offsetAlongLine?b.offsetAlongLine*d:0;c._beginProcessed=!1;return c}e.__extends(c,a);c.prototype.processPath=function(a){var b;switch(this._type){default:this._beginProcessed?(m.reversePath(a),b=this._atExtremities(a,this._position),m.reversePath(a),this.iteratePath=
this._beginProcessed=!1):(b=this._atExtremities(a,this._position),this.iteratePath=this._beginProcessed=!0);break;case "JustBegin":b=this._atExtremities(a,this._position);break;case "JustEnd":m.reversePath(a),b=this._atExtremities(a,this._position),m.reversePath(a);case "None":}return b};c.prototype._atExtremities=function(a,b){for(var d=a.length,c=0,h,e=a[0],g=1;g<d;++g){h=e;var e=a[g],f=this._curveHelper.calculateLength(h,e);if(c+f>b)return b=(b-c)/f,d=this._curveHelper.getAngleCS(h,e,b),a=d[0],
d=d[1],h=m.getCoord2D(h,e,b),this.internalPlacement.setTranslate(h[0]-this._offset*d,h[1]+this._offset*a),this._angleToLine&&this.internalPlacement.setRotateCS(-a,-d),this.internalPlacement;c+=f}return null};return c}(m.PathTransformationCursor)})},"esri/symbols/cim/placements/PlacementAtRatioPositions":function(){define(["require","exports","tslib","../CIMCursor","../GeometryWalker"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){}a.local=function(){null===
a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,h,b){return new l(a,h,b)};a.instance=null;return a}();a.PlacementAtRatioPositions=f;var l=function(a){function c(c,b,d){c=a.call(this,c,!0,!0)||this;c._walker=new k.GeometryWalker;c._walker.updateTolerance(d);c._angleToLine=void 0!==b.angleToLine?b.angleToLine:!0;c._offset=void 0!==b.offset?b.offset*d:0;c._beginGap=void 0!==b.beginPosition?b.beginPosition*d:0;c._endGap=void 0!==b.endPosition?b.endPosition*d:0;c._flipFirst=
void 0!==b.flipFirst?b.flipFirst:!0;c._pattern=new k.DashPattern;c._pattern.init(b.positionArray,!1,!1);c._subPathLen=0;c._posCount=c._pattern.size();c._isFirst=!0;c._prevPos=0;return c}e.__extends(c,a);c.prototype.processPath=function(a){if(this._pattern.isEmpty())return null;var b;if(this.iteratePath)a=this._pattern.nextValue()*this._subPathLen,a=this._beginGap+a,b=a-this._prevPos,this._prevPos=a;else{this._posCount=this._pattern.size();this._isFirst=!0;this._prevPos=0;this._subPathLen=this._walker.calculatePathLength(a)-
this._beginGap-this._endGap;if(0>this._subPathLen)return this.iteratePath=!1,null;if(!this._walker.init(a,this._pattern,!1))return null;this._pattern.reset();a=this._pattern.nextValue()*this._subPathLen;a=this._beginGap+a;b=a-this._prevPos;this._prevPos=a;this.iteratePath=!0}a={};if(!this._walker.nextPointAndAngle(b,a,1))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(a.pt[0]+this._offset*a.sa,a.pt[1]-this._offset*a.ca);b=this._isFirst&&this._flipFirst;var d;this._angleToLine?
(d=a.ca,a=a.sa):(d=1,a=0);b&&(d=-d,a=-a);this.internalPlacement.setRotateCS(d,a);this._isFirst=!1;this._posCount--;0===this._posCount&&(this.iteratePath=!1);return this.internalPlacement};return c}(m.PathTransformationCursor)})},"esri/symbols/cim/placements/PlacementOnLine":function(){define(["require","exports","tslib","../CIMCursor","../CurveHelper"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=
new a);return a.instance};a.prototype.execute=function(a,h,b){return new l(a,h,b)};a.instance=null;return a}();a.PlacementOnLine=f;var l=function(a){function c(c,b,d){c=a.call(this,c,!0,!0)||this;c._curveHelper=new k.CurveHelper;c._angleToLine=void 0!==b.angleToLine?b.angleToLine:!0;c._offset=void 0!==b.offset?b.offset*d:0;c._relativeTo=b.relativeTo;c._position=void 0!==b.startPointOffset?b.startPointOffset*d:0;c._epsilon=.001*d;return c}e.__extends(c,a);c.prototype.processPath=function(a){var b=
this._position;if("SegmentMidpoint"===this._relativeTo){this.iteratePath||(this._segmentCount=a.length,this._curSegment=1,this.iteratePath=!0);for(;this._curSegment<this._segmentCount;){var d=this._curSegment;this._curSegment++;var b=a[d-1],d=a[d],c=this._curveHelper.calculateLength(b,d);if(!(c<this._epsilon)){var c=.5+this._position/c,h=this._curveHelper.getAngleCS(b,d,c);a=h[0];h=h[1];b=m.getCoord2D(b,d,c);this.internalPlacement.setTranslate(b[0]-this._offset*h,b[1]+this._offset*a);this._angleToLine&&
this.internalPlacement.setRotateCS(a,h);return this.internalPlacement}}this.iteratePath=!1;return null}"LineEnd"===this._relativeTo&&m.reversePath(a);b=this.onLine(a,b);"LineEnd"===this._relativeTo&&m.reversePath(a);return b};c.prototype.onLine=function(a,b){var d,c=!1;switch(this._relativeTo){default:d=this._curveHelper.calculatePathLength(a)/2+b;break;case "LineBeginning":d=b;break;case "LineEnd":d=b,c=!0}for(var h=a.length,e=0,g=a[0],f=1;f<h;++f){b=g;var g=a[f],k=this._curveHelper.calculateLength(b,
g);if(e+k>d)return d=(d-e)/k,h=this._curveHelper.getAngleCS(b,g,d),a=h[0],h=h[1],b=m.getCoord2D(b,g,d),this.internalPlacement.setTranslate(b[0]-this._offset*h,b[1]+this._offset*a),this._angleToLine&&(c?this.internalPlacement.setRotateCS(-a,-h):this.internalPlacement.setRotateCS(a,h)),this.internalPlacement;e+=k}return null};return c}(m.PathTransformationCursor)})},"esri/symbols/cim/placements/PlacementOnVertices":function(){define(["require","exports","tslib","../CIMCursor","../CurveHelper"],function(f,
a,e,m,k){function l(a,h){for(var b=Math.PI;Math.abs(h-a)>b+2E-15;)h=h-a>b?h-2*b:h+2*b;return(a+h)/2}Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,d){return new g(a,b,d)};a.instance=null;return a}();a.PlacementOnVertices=f;var g=function(a){function c(b,d,c){b=a.call(this,b,!0,!0)||this;b._curveHelper=new k.CurveHelper;b._angleToLine=void 0!==d.angleToLine?d.angleToLine:
!0;b._offset=void 0!==d.offset?d.offset*c:0;b._endPoints=void 0!==d.placeOnEndPoints?d.placeOnEndPoints:!0;b._controlPoints=void 0!==d.placeOnControlPoints?d.placeOnControlPoints:!0;b._regularVertices=void 0!==d.placeOnRegularVertices?d.placeOnRegularVertices:!0;b._tags=[];b._tagIterator=0;return b}e.__extends(c,a);c.prototype.processPath=function(b){this.iteratePath||(this._preparePath(b),this.iteratePath=!0);if(this._tagIterator>=this._tags.length)return this._tagIterator=this._tags.length=0,this.iteratePath=
!1,null;b=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(b[2]);var a=b[0],c=b[1];if(0!==this._offset)var h=Math.cos(b[2]),a=a-this._offset*Math.sin(b[2]),c=c+this._offset*h;this.internalPlacement.setTranslate(a,c);this._tagIterator++;return this.internalPlacement};c.prototype._preparePath=function(b){this._tagIterator=this._tags.length=0;for(var a=m.isClosedPath(b),c=b.length-1,h=0,e=0,g=0,f=0,k=0,v,y;h<c;){h++;v=b[h-1];y=b[h];var z=m.getId(v),A=m.getId(y);if(this._angleToLine||
0!==this._offset)f=this._curveHelper.getAngle(v,y,0);1===h?a?(e=f,g=z):this._endPoints&&this._tags.push([v[0],v[1],f]):1===z?this._controlPoints&&this._tags.push([v[0],v[1],l(k,f)]):this._regularVertices&&this._tags.push([v[0],v[1],l(k,f)]);if(this._angleToLine||0!==this._offset)k=this._curveHelper.getAngle(v,y,1);h===c&&(a?1===A||1===g?this._controlPoints&&this._tags.push([y[0],y[1],l(k,e)]):this._regularVertices&&this._tags.push([y[0],y[1],l(k,e)]):this._endPoints&&this._tags.push([y[0],y[1],k]))}this._tagIterator=
0};return c}(m.PathTransformationCursor)})},"esri/symbols/cim/placements/PlacementPolygonCenter":function(){define(["require","exports","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../CIMPlacements"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,h,b){return new l(a,h,b)};a.instance=null;return a}();a.PlacementPolygonCenter=
f;var l=function(){function a(a,h,b){this._geometry=a;this._offsetX=void 0!==h.offsetX?h.offsetX*b:0;this._offsetY=void 0!==h.offsetY?h.offsetY*b:0;this._method=h.method;this._clipping=h.clipAtBoundary;this._internalPlacement=new k.Placement;this._clipping}a.prototype.next=function(){var a=this._geometry;this._geometry=null;return a&&void 0!==a.rings?this._polygonCenter(a):null};a.prototype._polygonCenter=function(a){switch(this._method){default:case "CenterOfMass":case "BoundingBoxCenter":var c=
e.create();m.getBoundsXY(c,a);this._internalPlacement.setTranslate((c[2]+c[0])/2+this._offsetX,(c[3]+c[1])/2-this._offsetY)}return this._internalPlacement};return a}()})},"esri/symbols/cim/Rect":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(a,e,f,g){void 0===a&&(a=0);void 0===e&&(e=0);void 0===f&&(f=0);void 0===g&&(g=0);this.x=a;this.y=e;this.width=f;this.height=g}Object.defineProperty(a.prototype,"isEmpty",{get:function(){return 0>=
this.width||0>=this.height},enumerable:!0,configurable:!0});a.prototype.union=function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.width=Math.max(this.width,a.width);this.height=Math.max(this.height,a.height)};return a}();a.default=f})},"esri/symbols/cim/packingUtils":function(){define(["require","exports"],function(f,a){function e(a){return a-Math.floor(a)}Object.defineProperty(a,"__esModule",{value:!0});var m=[1,256,65536,16777216],k=[1/256,1/65536,1/16777216,1/4294967296],l=
function(a,c){void 0===c&&(c=0);for(var h=0,b=0;4>b;b++)h+=a[c+b]*k[b];return h}(new Uint8ClampedArray([255,255,255,255]));a.packFloatRGBA=function(a,c,h){void 0===h&&(h=0);a=0>a?0:a>l?l:a;for(var b=0;4>b;b++)c[h+b]=Math.floor(256*e(a*m[b]))}})},"esri/symbols/cim/SDFHelper":function(){define(["require","exports","../../geometry/support/jsonUtils","./packingUtils","./Rect"],function(f,a,e,m,k){function l(a){if(!a)return null;switch(a.type){case "CIMPointSymbol":a=a.symbolLayers;if(!a||1!==a.length)break;
return l(a[0]);case "CIMVectorMarker":a=a.markerGraphics;if(!a||1!==a.length)break;var c=a[0];if(!c)break;a=c.geometry;if(!a)break;c=c.symbol;if(!c||"CIMPolygonSymbol"!==c.type&&"CIMLineSymbol"!==c.type)break;return{geom:a,asFill:"CIMPolygonSymbol"===c.type};case "sdf":return{geom:a.geom,asFill:a.asFill}}return null}function g(a){for(var c=Infinity,b=-Infinity,d=Infinity,e=-Infinity,g=0;g<a.length;g++)for(var f=0,k=a[g];f<k.length;f++){var l=k[f];l[0]<c&&(c=l[0]);l[0]>b&&(b=l[0]);l[1]<d&&(d=l[1]);
l[1]>e&&(e=l[1])}return[c,d,b,e]}Object.defineProperty(a,"__esModule",{value:!0});a.getSDFInfo=l;a.getSDFSymbol=function(a){a=a.markerGraphics;if(!a||1!==a.length)return null;a=a[0];if(!a)return null;a=a.symbol;return!a||"CIMPolygonSymbol"!==a.type&&"CIMLineSymbol"!==a.type?null:a};a.getExtent=function(a){return a?a.rings?g(a.rings):a.paths?g(a.paths):e.isExtent(a)?[a.xmin,a.ymin,a.xmax,a.ymax]:null:null};a.getSDFMetrics=function(a,h,b,d,e){var c=a[0],g=a[1],f=a[2];a=a[3];if(f<c||a<g)return[0,0,0];
var n=f-c,k=a-g,f=Math.floor(31.5);a=(128-2*(f+1))/Math.max(n,k);var n=Math.round(n*a),k=Math.round(k*a)+2*f,l=1;h&&(l=k/a/(h.ymax-h.ymin));var m=0,z=0;d&&(e?h&&b&&0<h.ymax-h.ymin&&(m=d.x/((h.xmax-h.xmin)/(h.ymax-h.ymin)*b),z=d.y/b):(m=d.x,z=d.y));m=.5*(h.xmax+h.xmin)+m*(h.xmax-h.xmin);z=.5*(h.ymax+h.ymin)+z*(h.ymax-h.ymin);m=(m-c)*a+f;z=(z-g)*a+f;return[l,m/(n+2*f)-.5,-(z/k-.5)]};a.buildSDF=function(a){var c,b=a.geom;c=b?b.rings?b.rings:b.paths?b.paths:void 0!==b.xmin&&void 0!==b.ymin&&void 0!==
b.xmax&&void 0!==b.ymax?[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]:null:null;var d,b=Infinity,e=-Infinity,g=Infinity,f=-Infinity;for(d=0;d<c.length;d++)for(var l=0,x=c[d];l<x.length;l++){var u=x[l];u[0]<b&&(b=u[0]);u[0]>e&&(e=u[0]);u[1]<g&&(g=u[1]);u[1]>f&&(f=u[1])}d=new k.default(b,g,e-b,f-g);g=Math.floor(31.5);l=(128-2*(g+1))/Math.max(d.width,d.height);b=Math.round(d.width*l)+2*g;e=Math.round(d.height*l)+2*g;f=[];for(x=0;x<c.length;x++){var v=c[x];if(v&&
1<v.length){for(var u=[],y=0;y<v.length;y++){var z=v[y],A=z[0],z=z[1],A=A-d.x,z=z-d.y,A=A*l,z=z*l,A=A+(g-.5),z=z+(g-.5);u.push([A,z])}a.asFill&&(y=u.length-1,u[0][0]===u[y][0]&&u[0][1]===u[y][1]||u.push(u[0]));f.push(u)}}d=b*e;c=Array(d);x=g*g+1;for(l=0;l<d;++l)c[l]=x;for(x=0;x<f.length;x++)for(u=f[x],y=u.length,l=1;l<y;++l){var v=u[l-1],A=u[l],B=void 0,z=void 0;v[0]<A[0]?(B=v[0],z=A[0]):(B=A[0],z=v[0]);var D=void 0,C=void 0;v[1]<A[1]?(D=v[1],C=A[1]):(D=A[1],C=v[1]);var E=Math.floor(B)-g,z=Math.floor(z)+
g,D=Math.floor(D)-g,C=Math.floor(C)+g;0>E&&(E=0);z>b&&(z=b);0>D&&(D=0);C>e&&(C=e);for(var B=A[0]-v[0],F=A[1]-v[1],I=B*B+F*F;E<z;E++)for(var J=D;J<C;J++){var G=(E-v[0])*B+(J-v[1])*F,H=void 0,K=void 0;0>G?(H=v[0],K=v[1]):G>I?(H=A[0],K=A[1]):(G/=I,H=v[0]+G*B,K=v[1]+G*F);G=(E-H)*(E-H)+(J-K)*(J-K);H=(e-J-1)*b+E;G<c[H]&&(c[H]=G)}}for(l=0;l<d;++l)c[l]=Math.sqrt(c[l]);if(a.asFill)for(a=0;a<f.length;a++)for(d=f[a],l=d.length,x=1;x<l;++x)for(u=d[x-1],y=d[x],A=v=void 0,u[0]<y[0]?(v=u[0],A=y[0]):(v=y[0],A=u[0]),
z=D=void 0,u[1]<y[1]?(D=u[1],z=y[1]):(D=y[1],z=u[1]),v=Math.floor(v),A=Math.floor(A)+1,D=Math.floor(D),z=Math.floor(z)+1,v<g&&(v=g),A>b-g&&(A=b-g),D<g&&(D=g),z>e-g&&(z=e-g);D<z;++D)if(u[1]>D!==y[1]>D){C=(e-D-1)*b;for(B=v;B<A;++B)B<(y[0]-u[0])*(D-u[1])/(y[1]-u[1])+u[0]&&(c[C+B]=-c[C+B]);for(B=g;B<v;++B)c[C+B]=-c[C+B]}g*=2;f=c.length;a=new Uint8Array(4*f);for(d=0;d<f;++d)m.packFloatRGBA(.5-c[d]/g,a,4*d);return[a,b,e]}})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(f,a){function e(a,
e){"string"!==typeof a&&(a=String(a));switch(e){case "LowerCase":return a.toLowerCase();case "Allcaps":return a.toUpperCase();default:return a}}Object.defineProperty(a,"__esModule",{value:!0});a.evaluateValueOrFunction=function(a,e,f,g){return"function"===typeof a?a(e,f,g):a};a.colorToArray=function(a){return[a.r,a.g,a.b,a.a]};a.createLabelOverrideFunction=function(a,f,l){var g=function(b){for(var a=b.length;a--;)if(-1===" /-,\n".indexOf(b.charAt(a)))return!1;return!0},c=[],h=0,b=-1;do b=f.indexOf("[",
h),b>=h&&(b>h&&(h=f.substr(h,b-h),c.push([h,null,g(h)])),h=b+1,b=f.indexOf("]",h),b>=h&&(b>h&&(h=f.substr(h,b-h),(h=a[h])&&c.push([null,h,!1])),h=b+1));while(-1!==b);h<f.length-1&&(h=f.substr(h),c.push([h,null,g(h)]));return function(b){for(var a="",d=null,h=0;h<c.length;h++){var g=c[h],f=g[0],k=g[1],g=g[2];if(f)g?d=f:(d&&(a+=d,d=null),a+=f);else if(f=b.attributes[k])d&&(a+=d,d=null),a+=f}return e(a,l)}};a._adjustTextCase=e;a.resampleHermite=function(a,e,f,g,c,h,b){void 0===b&&(b=!0);var d=e/c;f/=
h;for(var n=Math.ceil(d/2),k=Math.ceil(f/2),l=0;l<h;l++)for(var q=0;q<c;q++){for(var x=4*(q+(b?h-l-1:l)*c),u=0,m=0,y=0,z=0,A=0,B=0,D=0,C=(l+.5)*f,E=Math.floor(l*f);E<(l+1)*f;E++)for(var F=Math.abs(C-(E+.5))/k,I=(q+.5)*d,F=F*F,J=Math.floor(q*d);J<(q+1)*d;J++){var G=Math.abs(I-(J+.5))/n,u=Math.sqrt(F+G*G);-1<=u&&1>=u&&(u=2*u*u*u-3*u*u+1,0<u&&(G=4*(J+E*e),D+=u*a[G+3],y+=u,255>a[G+3]&&(u=u*a[G+3]/250),z+=u*a[G],A+=u*a[G+1],B+=u*a[G+2],m+=u))}g[x]=z/m;g[x+1]=A/m;g[x+2]=B/m;g[x+3]=D/y}};a.fromCIMColor=
function(a){return a?{r:a[0],g:a[1],b:a[2],a:a[3]/255}:{r:0,g:0,b:0,a:0}};a.toCIMSymbolJSON=function(a){var e;return null===(e=a.data)||void 0===e?void 0:e.symbol};a.isCIMMarker=function(a){return"CIMVectorMarker"===a.type||"CIMPictureMarker"===a.type||"CIMBarChartMarker"===a.type||"CIMCharacterMarker"===a.type||"CIMPieChartMarker"===a.type||"CIMStackedBarChartMarker"===a.type};a.isCIMStroke=function(a){return"CIMGradientStroke"===a.type||"CIMPictureStroke"===a.type||"CIMSolidStroke"===a.type};a.isCIMFill=
function(a){return"CIMGradientFill"===a.type||"CIMHatchFill"===a.type||"CIMPictureFill"===a.type||"CIMSolidFill"===a.type||"CIMWaterFill"===a.type};a.isCIMMarkerStrokePlacement=function(a){return"CIMMarkerPlacementAlongLineRandomSize"===a.type||"CIMMarkerPlacementAlongLineSameSize"===a.type||"CIMMarkerPlacementAlongLineVariableSize"===a.type||"CIMMarkerPlacementAtExtremities"===a.type||"CIMMarkerPlacementAtMeasuredUnits"===a.type||"CIMMarkerPlacementAtRatioPositions"===a.type||"CIMMarkerPlacementOnLine"===
a.type||"CIMMarkerPlacementOnVertices"===a.type}})},"esri/views/2d/arcade/utils":function(){define("require exports tslib @dojo/framework/shim/WeakMap ../../../core/Error ../../../core/Logger ../../../geometry/support/quantizationUtils ../../../layers/graphics/featureConversionUtils".split(" "),function(f,a,e,m,k,l,g,c){function h(a,d,c,h){var g=h.transform,f=h.hasZ;h=h.hasM;n.has(a)||n.set(a,b(c));a=n.get(a)(d.geometry,g,f,h);return e.__assign(e.__assign({},d),{geometry:a})}function b(b){var a={};
switch(b){case "esriGeometryPoint":return function(b,d,c,e){return g.hydratePoint(d,a,b,c,e)};case "esriGeometryPolygon":return function(b,d,c,e){return g.hydratePolygon(d,a,b,c,e)};case "esriGeometryPolyline":return function(b,d,c,e){return g.hydratePolyline(d,a,b,c,e)};case "esriGeometryMultipoint":return function(b,d,c,e){return g.hydrateMultipoint(d,a,b,c,e)};default:return d.error(new k("mapview-arcade","Unable to handle geometryType: "+b)),function(b){return b}}}Object.defineProperty(a,"__esModule",
{value:!0});var d=l.getLogger("esri.views.2d.support.arcadeOnDemand");a.callWithOptimizedFeature=function(b,a,g,f,n){var l=f.geometryType,k=f.hasZ;f=f.hasM;a=b.referencesGeometry()?n?h(b,c.convertToFeature(a,l,k,f),l,n):c.convertToFeature(a,l,k,f):a;a=b.repurposeFeature(a);try{return b.evaluate(e.__assign(e.__assign({},g),{$feature:a}))}catch(z){return d.warn("Feature arcade evaluation failed:",z),null}};a.callWithFeature=function(b,a,c,g,f){a=b.referencesGeometry()&&f?h(b,a,g,f):a;a=b.repurposeFeature(a);
try{return b.evaluate(e.__assign(e.__assign({},c),{$feature:a}))}catch(v){return d.warn("Feature arcade evaluation failed:",v),null}};var n=new m.default;a.createHydrateFactory=b})},"esri/geometry/support/quantizationUtils":function(){define(["require","exports","./jsonUtils"],function(f,a,e){function m(b,a){return Math.round((a-b.translate[0])/b.scale[0])}function k(b,a){return Math.round((b.translate[1]-a)/b.scale[1])}function l(b,a,d){for(var c=[],e,h,g,f,n=0;n<d.length;n++){var l=d[n];if(0<n){if(g=
m(b,l[0]),f=k(b,l[1]),g!==e||f!==h)c.push(a(l,g-e,f-h)),e=g,h=f}else e=m(b,l[0]),h=k(b,l[1]),c.push(a(l,e,h))}return 0<c.length?c:null}function g(b,a,d,c){return l(b,d?c?F:E:c?E:C,a)}function c(b,a,d,c){var e=[];d=d?c?F:E:c?E:C;for(c=0;c<a.length;c++){var h=l(b,d,a[c]);h&&3<=h.length&&e.push(h)}return e.length?e:null}function h(b,a,d,c){var e=[];d=d?c?F:E:c?E:C;for(c=0;c<a.length;c++){var h=l(b,d,a[c]);h&&2<=h.length&&e.push(h)}return e.length?e:null}function b(b,a){return a*b.scale[0]+b.translate[0]}
function d(b,a){return b.translate[1]-a*b.scale[1]}function n(a,c,e){var h=Array(e.length);if(!e.length)return h;var g=a.scale,f=g[0],g=g[1],n=b(a,e[0][0]);a=d(a,e[0][1]);h[0]=c(e[0],n,a);for(var l=1;l<e.length;l++){var k=e[l],n=n+k[0]*f;a-=k[1]*g;h[l]=c(k,n,a)}return h}function p(b,a,d){for(var c=Array(d.length),e=0;e<d.length;e++)c[e]=n(b,a,d[e]);return c}function r(b,a,d,c){return n(b,d?c?F:E:c?E:C,a)}function q(b,a,d,c){return p(b,d?c?F:E:c?E:C,a)}function x(b,a,d,c){return p(b,d?c?F:E:c?E:C,
a)}function u(b,a,d){var c=d[0],e=c[0],c=c[1],h=Math.min(e,a[0]),g=Math.min(c,a[1]),f=Math.max(e,a[2]);a=Math.max(c,a[3]);for(var n=1;n<d.length;n++){var l=d[n],k=l[0],l=l[1],e=e+k,c=c+l;0>k&&(h=Math.min(h,e));0<k&&(f=Math.max(f,e));0>l?g=Math.min(g,c):0<l&&(a=Math.max(a,c))}b[0]=h;b[1]=g;b[2]=f;b[3]=a;return b}function v(b,a){if(!a.length)return null;b[0]=b[1]=Number.POSITIVE_INFINITY;b[2]=b[3]=Number.NEGATIVE_INFINITY;for(var d=0;d<a.length;d++)u(b,b,a[d]);return b}function y(b,a,d,c,e){a.xmin=
m(b,d.xmin);a.ymin=k(b,d.ymin);a.xmax=m(b,d.xmax);a.ymax=k(b,d.ymax);a!==d&&(c&&(a.zmin=d.zmin,a.zmax=d.zmax),e&&(a.mmin=d.mmin,a.mmax=d.mmax));return a}function z(b,a,d,c,e){a.points=g(b,d.points,c,e);return a}function A(b,a,d,c,e){a.x=m(b,d.x);a.y=k(b,d.y);a!==d&&(c&&(a.z=d.z),e&&(a.m=d.m));return a}function B(b,a,d,e,h){b=c(b,d.rings,e,h);if(!b)return null;a.rings=b;return a}function D(b,a,d,c,e){b=h(b,d.paths,c,e);if(!b)return null;a.paths=b;return a}Object.defineProperty(a,"__esModule",{value:!0});
var C=function(b,a,d){return[a,d]},E=function(b,a,d){return[a,d,b[2]]},F=function(b,a,d){return[a,d,b[2],b[3]]};a.toQuantizationTransform=function(b){return b?{originPosition:"upper-left"===b.originPosition?"upperLeft":"lower-left"===b.originPosition?"lowerLeft":b.originPosition,scale:[b.tolerance,b.tolerance],translate:[b.extent.xmin,b.extent.ymax]}:null};a.equals=function(b,a){if(b===a||null==b&&null==a)return!0;if(null==b||null==a)return!1;var d,c,e,h;b&&"upperLeft"===b.originPosition?(d=b.translate[0],
c=b.translate[1],b=b.scale[0]):(d=b.extent.xmin,c=b.extent.ymax,b=b.tolerance);a&&"upperLeft"===a.originPosition?(e=a.translate[0],h=a.translate[1],a=a.scale[0]):(e=a.extent.xmin,h=a.extent.ymax,a=a.tolerance);return d===e&&c===h&&b===a};a.quantizeX=m;a.quantizeY=k;a.quantizeBounds=function(b,a,d){a[0]=m(b,d[0]);a[3]=k(b,d[1]);a[2]=m(b,d[2]);a[1]=k(b,d[3]);return a};a.quantizePoints=g;a.quantizeRings=c;a.quantizePaths=h;a.hydrateX=b;a.hydrateY=d;a.hydrateCoordsArray=n;a.hydrateCoordsArrayArray=p;
a.hydrateBounds=function(a,c,e){return e?(c[0]=b(a,e[0]),c[1]=d(a,e[3]),c[2]=b(a,e[2]),c[3]=d(a,e[1]),c):[b(a,c[0]),d(a,c[3]),b(a,c[2]),d(a,c[1])]};a.hydratePoints=r;a.hydratePaths=q;a.hydrateRings=x;a.getQuantizedBoundsCoordsArray=u;a.getQuantizedBoundsCoordsArrayArray=v;a.getQuantizedBoundsPoints=function(b){var a=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return u(a,a,b)};a.getQuantizedBoundsPaths=function(b){return v([0,0,0,0],b)};a.getQuantizedBoundsRings=
function(b){return v([0,0,0,0],b)};a.quantizeExtent=y;a.quantizeMultipoint=z;a.quantizePoint=A;a.quantizePolygon=B;a.quantizePolyline=D;a.quantizeGeometry=function(b,a){return b&&a?e.isPoint(a)?A(b,{},a,!1,!1):e.isPolyline(a)?D(b,{},a,!1,!1):e.isPolygon(a)?B(b,{},a,!1,!1):e.isMultipoint(a)?z(b,{},a,!1,!1):e.isExtent(a)?y(b,{},a,!1,!1):null:null};a.hydrateExtent=function(a,c,e,h,g){c.xmin=b(a,e.xmin);c.ymin=d(a,e.ymin);c.xmax=b(a,e.xmax);c.ymax=d(a,e.ymax);c!==e&&(h&&(c.zmin=e.zmin,c.zmax=e.zmax),
g&&(c.mmin=e.mmin,c.mmax=e.mmax));return c};a.hydrateMultipoint=function(b,a,d,c,e){a.points=r(b,d.points,c,e);return a};a.hydratePoint=function(a,c,e,h,g){c.x=b(a,e.x);c.y=d(a,e.y);c!==e&&(h&&(c.z=e.z),g&&(c.m=e.m));return c};a.hydratePolygon=function(b,a,d,c,e){a.rings=x(b,d.rings,c,e);return a};a.hydratePolyline=function(b,a,d,c,e){a.paths=q(b,d.paths,c,e);return a}})},"esri/symbols/ExtrudeSymbol3DLayer":function(){define("require exports tslib ../core/maybe ../core/accessorSupport/decorators ./Symbol3DLayer ./edges/utils ./support/Symbol3DMaterial".split(" "),
function(f,a,e,m,k,l,g,c){return function(a){function b(b){b=a.call(this,b)||this;b.type="extrude";b.size=void 0;b.material=null;b.castShadows=!0;b.edges=null;return b}e.__extends(b,a);d=b;b.prototype.clone=function(){return new d({edges:this.edges&&this.edges.clone(),enabled:this.enabled,material:m.isSome(this.material)?this.material.clone():null,castShadows:this.castShadows,size:this.size})};var d;e.__decorate([k.enumeration({Extrude:"extrude"})],b.prototype,"type",void 0);e.__decorate([k.property({type:Number,
json:{write:!0}})],b.prototype,"size",void 0);e.__decorate([k.property({type:c.default,json:{write:!0}})],b.prototype,"material",void 0);e.__decorate([k.property({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],b.prototype,"castShadows",void 0);e.__decorate([k.property(g.symbol3dEdgesProperty)],b.prototype,"edges",void 0);return b=d=e.__decorate([k.subclass("esri.symbols.ExtrudeSymbol3DLayer")],b)}(l)})},"esri/symbols/Symbol3DLayer":function(){define("require exports tslib ../core/jsonMap ../core/JSONSupport ../core/accessorSupport/decorators".split(" "),
function(f,a,e,m,k,l){var g=m.strict()({Icon:"icon",Object:"object",Line:"line",Path:"path",Fill:"fill",Extrude:"extrude",Text:"text",Water:"water"});f=function(a){function c(b){b=a.call(this,b)||this;b.enabled=!0;b.type=null;return b}e.__extends(c,a);c.prototype.writeEnabled=function(b,a,c){b||(a[c]=b)};e.__decorate([l.property({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],c.prototype,"enabled",void 0);e.__decorate([l.writer("enabled")],c.prototype,"writeEnabled",null);e.__decorate([l.property({type:g.apiValues,
readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:g.write}}})],c.prototype,"type",void 0);return c=e.__decorate([l.subclass("esri.symbols.Symbol3DLayer")],c)}(k.JSONSupport);(f||(f={})).typeJSONDictionary=g;return f})},"esri/symbols/edges/utils":function(){define(["require","exports","./Edges3D","./SketchEdges3D","./SolidEdges3D"],function(f,a,e,m,k){function l(a,c,e){if(!a)return a;switch(a.type){case "solid":return c=new k,c.read(a,e),c;case "sketch":return c=new m,c.read(a,e),c}}Object.defineProperty(a,
"__esModule",{value:!0});a.read=l;a.symbol3dEdgesProperty={types:{key:"type",base:e,typeMap:{solid:k,sketch:m}},json:{read:l,write:!0}}})},"esri/symbols/edges/Edges3D":function(){define("require exports tslib ../../Color ../../core/JSONSupport ../../core/lang ../../core/screenUtils ../../core/accessorSupport/decorators ../support/materialUtils".split(" "),function(f,a,e,m,k,l,g,c,h){return function(b){function a(a){a=b.call(this,a)||this;a.color=new m([0,0,0,1]);a.extensionLength=0;a.size=g.px2pt(1);
return a}e.__extends(a,b);a.prototype.normalizeCtorArgs=function(b){b&&b.type&&(b=e.__assign({},b),delete b.type);return b};a.prototype.clone=function(){};a.prototype.cloneProperties=function(){return{color:l.clone(this.color),size:this.size,extensionLength:this.extensionLength}};e.__decorate([c.property({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],a.prototype,"type",void 0);e.__decorate([c.property(h.colorAndTransparencyProperty)],a.prototype,"color",void 0);e.__decorate([c.property(e.__assign(e.__assign({},
h.screenSizeProperty),{json:{write:{overridePolicy:function(b){return{enabled:!!b}}}}}))],a.prototype,"extensionLength",void 0);e.__decorate([c.property(h.screenSizeProperty)],a.prototype,"size",void 0);return a=e.__decorate([c.subclass("esri.symbols.edges.Edges3D")],a)}(k.JSONSupport)})},"esri/symbols/support/materialUtils":function(){define("require exports ../../Color ../../core/screenUtils ../../core/accessorSupport/ensureType ../../webdoc/support/opacityUtils".split(" "),function(f,a,e,m,k,l){Object.defineProperty(a,
"__esModule",{value:!0});a.colorAndTransparencyProperty={type:e,json:{type:[k.Integer],default:null,read:{source:["color","transparency"],reader:function(a,c){a=null!=c.transparency?l.transparencyToOpacity(c.transparency):1;return(c=c.color)&&Array.isArray(c)?new e([c[0]||0,c[1]||0,c[2]||0,a]):null}},write:{target:{color:{type:[k.Integer]},transparency:{type:k.Integer}},writer:function(a,c){c.color=a.toJSON().slice(0,3);a=l.opacityToTransparency(a.a);0!==a&&(c.transparency=a)}}}};a.screenSizeProperty=
{type:Number,cast:m.toPt,json:{write:!0}};a.stipplePatternProperty={type:[Number],cast:function(a){return null!=a?a:Array.isArray(a)?a.map(m.toPt):null},json:{read:!1,write:!1}}})},"esri/webdoc/support/opacityUtils":function(){define(["require","exports","../../core/accessorSupport/ensureType"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.opacityToTransparency=function(a){a=e.ensureInteger(100*(1-a));return Math.max(0,Math.min(a,100))};a.transparencyToOpacity=function(a){return Math.max(0,
Math.min(1-a/100,1))}})},"esri/symbols/edges/SketchEdges3D":function(){define(["require","exports","tslib","../../core/accessorSupport/decorators","./Edges3D"],function(f,a,e,m,k){return function(a){function g(c){c=a.call(this,c)||this;c.type="sketch";return c}e.__extends(g,a);c=g;g.prototype.clone=function(){return new c(this.cloneProperties())};var c;e.__decorate([m.property({type:["sketch"]})],g.prototype,"type",void 0);return g=c=e.__decorate([m.subclass("esri.symbols.edges.SketchEdges3D")],g)}(k)})},
"esri/symbols/edges/SolidEdges3D":function(){define(["require","exports","tslib","../../core/accessorSupport/decorators","./Edges3D"],function(f,a,e,m,k){return function(a){function g(c){c=a.call(this,c)||this;c.type="solid";return c}e.__extends(g,a);c=g;g.prototype.clone=function(){return new c(this.cloneProperties())};var c;e.__decorate([m.property({type:["solid"]})],g.prototype,"type",void 0);return g=c=e.__decorate([m.subclass("esri.symbols.support.SolidEdges3D")],g)}(k)})},"esri/symbols/support/Symbol3DMaterial":function(){define("require exports tslib ../../core/JSONSupport ../../core/maybe ../../core/accessorSupport/decorators ./materialUtils".split(" "),
function(f,a,e,m,k,l,g){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b.color=null;return b}e.__extends(c,a);b=c;c.prototype.clone=function(){return new b({color:k.isSome(this.color)?this.color.clone():null})};var b;e.__decorate([l.property(g.colorAndTransparencyProperty)],c.prototype,"color",void 0);return c=b=e.__decorate([l.subclass("esri.symbols.support.Symbol3DMaterial")],c)}(m.JSONSupport);a.Symbol3DMaterial=f;a.default=
f})},"esri/symbols/FillSymbol":function(){define("require exports tslib ../core/jsonMap ../core/accessorSupport/decorators ./SimpleLineSymbol ./Symbol".split(" "),function(f,a,e,m,k,l,g){var c=new m.default({esriSFS:"simple-fill",esriPFS:"picture-fill"});return function(a){function b(b){b=a.call(this,b)||this;b.outline=null;b.type=null;return b}e.__extends(b,a);b.prototype.hash=function(){return this.type+"."+(this.outline&&this.outline.hash())};e.__decorate([k.property({type:l,json:{default:null,
write:!0}})],b.prototype,"outline",void 0);e.__decorate([k.property({type:c.apiValues,readOnly:!0,json:{type:c.jsonValues}})],b.prototype,"type",void 0);return b=e.__decorate([k.subclass("esri.symbols.FillSymbol")],b)}(g)})},"esri/symbols/SimpleLineSymbol":function(){define("require exports tslib ../core/jsonMap ../core/lang ../core/screenUtils ../core/accessorSupport/decorators ./LineSymbol ./LineSymbolMarker".split(" "),function(f,a,e,m,k,l,g,c,h){var b=new m.default({esriSLSSolid:"solid",esriSLSDash:"dash",
esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSInsideFrame:"inside-frame",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});return function(a){function d(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];b=a.apply(this,b)||this;b.type="simple-line";b.style="solid";b.cap="round";
b.join="round";b.marker=null;b.miterLimit=2;return b}e.__extends(d,a);c=d;d.prototype.normalizeCtorArgs=function(b,a,d,c,e,h){if(b&&"string"!==typeof b)return b;var g={};null!=b&&(g.style=b);null!=a&&(g.color=a);null!=d&&(g.width=l.toPt(d));null!=c&&(g.cap=c);null!=e&&(g.join=e);null!=h&&(g.miterLimit=l.toPt(h));return g};d.prototype.clone=function(){var b;return new c({color:k.clone(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:null===
(b=this.marker)||void 0===b?void 0:b.clone()})};d.prototype.hash=function(){var b,d;return a.prototype.hash.call(this)+"."+(null===(b=this.color)||void 0===b?void 0:b.hash())+"."+this.style+"."+this.cap+"."+this.join+"."+this.miterLimit+"."+(null===(d=this.marker)||void 0===d?void 0:d.hash())};var c;e.__decorate([g.enumeration({esriSLS:"simple-line"})],d.prototype,"type",void 0);e.__decorate([g.property({type:b.apiValues,json:{read:b.read,write:b.write}})],d.prototype,"style",void 0);e.__decorate([g.property({type:["butt",
"round","square"],json:{write:{overridePolicy:function(b,a,d){return{enabled:"round"!==b&&(null==d||null==d.origin)}}}}})],d.prototype,"cap",void 0);e.__decorate([g.property({type:["miter","round","bevel"],json:{write:{overridePolicy:function(b,a,d){return{enabled:"round"!==b&&(null==d||null==d.origin)}}}}})],d.prototype,"join",void 0);e.__decorate([g.property({type:h,json:{write:!0,origins:{"web-scene":{write:!1}}}})],d.prototype,"marker",void 0);e.__decorate([g.property({type:Number,json:{read:!1,
write:!1}})],d.prototype,"miterLimit",void 0);return d=c=e.__decorate([g.subclass("esri.symbols.SimpleLineSymbol")],d)}(c)})},"esri/symbols/LineSymbol":function(){define("require exports tslib ../core/screenUtils ../core/accessorSupport/decorators ./Symbol".split(" "),function(f,a,e,m,k,l){return function(a){function c(c){c=a.call(this,c)||this;c.type="simple-line";c.width=.75;return c}e.__extends(c,a);c.prototype.hash=function(){return this.type+"."+this.width};e.__decorate([k.enumeration({esriSLS:"simple-line"})],
c.prototype,"type",void 0);e.__decorate([k.property({type:Number,cast:m.toPt,json:{write:!0}})],c.prototype,"width",void 0);return c=e.__decorate([k.subclass("esri.symbols.LineSymbol")],c)}(l)})},"esri/symbols/LineSymbolMarker":function(){define("require exports tslib ../Color ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators".split(" "),function(f,a,e,m,k,l,g){return function(a){function c(b){b=a.call(this,b)||this;b.placement="begin-end";b.type="line-marker";b.style="arrow";return b}
e.__extends(c,a);b=c;c.prototype.writeType=function(b,a,c,e){"web-map"!==(null===e||void 0===e?void 0:e.origin)&&(a[c]=b)};c.prototype.writeStyle=function(b,a,c,e){a[c]="web-map"===(null===e||void 0===e?void 0:e.origin)?"arrow":b};Object.defineProperty(c.prototype,"color",{set:function(b){this._set("color",b)},enumerable:!0,configurable:!0});c.prototype.readColor=function(b){return b&&null!=b[0]?[b[0],b[1],b[2],b[3]/255]:b};c.prototype.writeColor=function(b,a,c,e){"web-map"!==(null===e||void 0===
e?void 0:e.origin)&&(a[c]=b)};c.prototype.clone=function(){return new b({color:l.clone(this.color),placement:this.placement,style:this.style})};c.prototype.hash=function(){var b;return this.placement+"."+(null===(b=this.color)||void 0===b?void 0:b.hash())+"."+this.style};var b;e.__decorate([g.property({type:["begin","end","begin-end"],json:{default:"begin-end",write:!0}})],c.prototype,"placement",void 0);e.__decorate([g.property({type:String,readOnly:!0})],c.prototype,"type",void 0);e.__decorate([g.writer("type")],
c.prototype,"writeType",null);e.__decorate([g.property({type:"arrow circle square diamond cross x".split(" ")})],c.prototype,"style",void 0);e.__decorate([g.writer("style")],c.prototype,"writeStyle",null);e.__decorate([g.property({type:m,value:null,json:{write:{allowNull:!0}}})],c.prototype,"color",null);e.__decorate([g.reader("color")],c.prototype,"readColor",null);e.__decorate([g.writer("color")],c.prototype,"writeColor",null);return c=b=e.__decorate([g.subclass("esri.symbols.LineSymbolMarker")],
c)}(k.JSONSupport)})},"esri/symbols/FillSymbol3DLayer":function(){define("require exports tslib ../core/maybe ../core/accessorSupport/decorators ./Symbol3DLayer ./edges/utils ./support/colors ./support/Symbol3DFillMaterial ./support/Symbol3DOutline".split(" "),function(f,a,e,m,k,l,g,c,h,b){return function(a){function d(b){b=a.call(this,b)||this;b.type="fill";b.material=null;b.castShadows=!0;b.outline=null;b.edges=null;return b}e.__extends(d,a);f=d;d.prototype.clone=function(){return new f({edges:m.isSome(this.edges)?
this.edges.clone():null,enabled:this.enabled,material:m.isSome(this.material)?this.material.clone():null,castShadows:this.castShadows,outline:m.isSome(this.outline)?this.outline.clone():null})};d.fromSimpleFillSymbol=function(a){return new f({material:{color:(a.color||c.transparentWhite).clone()},outline:a.outline?new b.default({size:a.outline.width||0,color:(a.outline.color||c.white).clone()}):null})};var f;e.__decorate([k.enumeration({Fill:"fill"})],d.prototype,"type",void 0);e.__decorate([k.property({type:h.default,
json:{write:!0}})],d.prototype,"material",void 0);e.__decorate([k.property({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],d.prototype,"castShadows",void 0);e.__decorate([k.property({type:b.default,json:{write:!0}})],d.prototype,"outline",void 0);e.__decorate([k.property(g.symbol3dEdgesProperty)],d.prototype,"edges",void 0);return d=f=e.__decorate([k.subclass("esri.symbols.FillSymbol3DLayer")],d)}(l)})},"esri/symbols/support/colors":function(){define(["require","exports","../../Color"],
function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.white=new e("white");a.black=new e("black");a.transparentWhite=new e([255,255,255,0]);a.isBlack=function(a){return 0===a.r&&0===a.g&&0===a.b}})},"esri/symbols/support/Symbol3DFillMaterial":function(){define("require exports tslib ../../core/maybe ../../core/accessorSupport/decorators ./Symbol3DMaterial".split(" "),function(f,a,e,m,k,l){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function c(){return null!==a&&a.apply(this,
arguments)||this}e.__extends(c,a);h=c;c.prototype.clone=function(){return new h({color:m.isSome(this.color)?this.color.clone():null,colorMixMode:this.colorMixMode})};var h;e.__decorate([k.enumeration({multiply:"multiply",replace:"replace",tint:"tint"})],c.prototype,"colorMixMode",void 0);return c=h=e.__decorate([k.subclass("esri.symbols.support.Symbol3DFillMaterial")],c)}(l.default);a.Symbol3DFillMaterial=f;a.default=f})},"esri/symbols/support/Symbol3DOutline":function(){define("require exports tslib ../../Color ../../core/JSONSupport ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ./materialUtils".split(" "),
function(f,a,e,m,k,l,g,c,h){Object.defineProperty(a,"__esModule",{value:!0});f=function(b){function a(){var a=null!==b&&b.apply(this,arguments)||this;a.color=new m([0,0,0,1]);a.size=g.px2pt(1);a.stipplePattern=null;a.stippleOffColor=null;return a}e.__extends(a,b);f=a;a.prototype.clone=function(){return new f({color:l.isSome(this.color)?this.color.clone():null,size:this.size,stipplePattern:this.stipplePattern?this.stipplePattern.slice():null,stippleOffColor:this.stippleOffColor?this.stippleOffColor.clone():
null})};var f;e.__decorate([c.property(h.colorAndTransparencyProperty)],a.prototype,"color",void 0);e.__decorate([c.property(h.screenSizeProperty)],a.prototype,"size",void 0);e.__decorate([c.property(h.stipplePatternProperty)],a.prototype,"stipplePattern",void 0);e.__decorate([c.property({type:m})],a.prototype,"stippleOffColor",void 0);return a=f=e.__decorate([c.subclass("esri.symbols.support.Symbol3DOutline")],a)}(k.JSONSupport);a.Symbol3DOutline=f;a.default=f})},"esri/symbols/Font":function(){define("require exports tslib ../core/JSONSupport ../core/screenUtils ../core/accessorSupport/decorators".split(" "),
function(f,a,e,m,k,l){return function(a){function c(b){b=a.call(this,b)||this;b.decoration="none";b.family="sans-serif";b.size=9;b.style="normal";b.weight="normal";return b}e.__extends(c,a);h=c;c.prototype.castSize=function(b){return k.toPt(b)};c.prototype.clone=function(){return new h({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})};c.prototype.hash=function(){return this.decoration+"."+this.family+"."+this.size+"."+this.style+"."+this.weight};
var h;e.__decorate([l.property({type:["underline","line-through","none"],json:{default:"none",write:!0}})],c.prototype,"decoration",void 0);e.__decorate([l.property({type:String,json:{write:!0}})],c.prototype,"family",void 0);e.__decorate([l.property({type:Number,json:{write:{overridePolicy:function(b,a,c){return{enabled:!c||!c.textSymbol3D}}}}})],c.prototype,"size",void 0);e.__decorate([l.cast("size")],c.prototype,"castSize",null);e.__decorate([l.property({type:["normal","italic","oblique"],json:{default:"normal",
write:!0}})],c.prototype,"style",void 0);e.__decorate([l.property({type:["normal","bold","bolder","lighter"],json:{default:"normal",write:!0}})],c.prototype,"weight",void 0);return c=h=e.__decorate([l.subclass("esri.symbols.Font")],c)}(m.JSONSupport)})},"esri/symbols/IconSymbol3DLayer":function(){define("require exports tslib ../core/Logger ../core/maybe ../core/urlUtils ../core/accessorSupport/decorators ./Symbol3DLayer ./support/colors ./support/IconSymbol3DLayerResource ./support/materialUtils ./support/Symbol3DAnchorPosition2D ./support/Symbol3DMaterial ./support/Symbol3DOutline".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r){function q(b){var a="width"in b?b.width:b.size,d="height"in b?b.height:b.size,c=x(b.xoffset);b=x(b.yoffset);return(c||b)&&a&&d?{x:-c/a,y:b/d}:null}function x(b){return isFinite(b)?b:0}var u=m.getLogger("esri.symbols.IconSymbol3DLayer"),v={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};return function(a){function c(b){b=a.call(this,b)||this;b.material=null;b.resource=null;b.type="icon";b.size=12;b.anchor="center";
b.anchorPosition=void 0;b.outline=void 0;return b}e.__extends(c,a);f=c;c.prototype.clone=function(){return new f({anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),enabled:this.enabled,material:k.isSome(this.material)?this.material.clone():null,outline:k.isSome(this.outline)?this.outline.clone():null,resource:this.resource&&this.resource.clone(),size:this.size})};c.fromSimpleMarkerSymbol=function(b){var a=b.color||h.white,d=q(b),c=b.outline&&0<b.outline.width?{size:b.outline.width,
color:(b.outline.color||h.white).clone()}:null,e=f,g=b.size;b=b.style;var n=v[b];n?b=n:(u.warn(b+' cannot be mapped to Icon symbol. Fallback to "circle"'),b="circle");return new e({size:g,resource:{primitive:b},material:{color:a},outline:c,anchor:d?"relative":void 0,anchorPosition:d})};c.fromPictureMarkerSymbol=function(b){var a=!b.color||h.isBlack(b.color)?h.white:b.color,d=q(b);return new f({size:b.width<=b.height?b.height:b.width,resource:{href:b.url},material:{color:a.clone()},anchor:d?"relative":
void 0,anchorPosition:d})};c.fromCIMSymbol=function(b){return new f({resource:{href:l.makeData({mediaType:"application/json",data:JSON.stringify(b.data)})}})};var f;e.__decorate([g.property({type:p.default,json:{write:!0}})],c.prototype,"material",void 0);e.__decorate([g.property({type:b.default,json:{write:!0}})],c.prototype,"resource",void 0);e.__decorate([g.enumeration({Icon:"icon"})],c.prototype,"type",void 0);e.__decorate([g.property(d.screenSizeProperty)],c.prototype,"size",void 0);e.__decorate([g.enumeration({center:"center",
left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),g.property({json:{default:"center"}})],c.prototype,"anchor",void 0);e.__decorate([g.property({type:n.Symbol3DAnchorPosition2D,json:{type:[Number],read:{reader:function(b){return new n.Symbol3DAnchorPosition2D({x:b[0],y:b[1]})}},write:{writer:function(b,a){a.anchorPosition=[b.x,b.y]},overridePolicy:function(){return{enabled:"relative"===
this.anchor}}}}})],c.prototype,"anchorPosition",void 0);e.__decorate([g.property({type:r.default,json:{write:!0}})],c.prototype,"outline",void 0);return c=f=e.__decorate([g.subclass("esri.symbols.IconSymbol3DLayer")],c)}(c)})},"esri/symbols/support/IconSymbol3DLayerResource":function(){define("require exports tslib ../../core/jsonMap ../../core/JSONSupport ../../core/urlUtils ../../core/accessorSupport/decorators ../../support/persistableUrlUtils".split(" "),function(f,a,e,m,k,l,g,c){Object.defineProperty(a,
"__esModule",{value:!0});var h=m.strict()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});f=function(b){function a(a){return b.call(this,a)||this}e.__extends(a,b);f=a;a.prototype.readHref=function(b,a,d){return b?c.fromJSON(b,d):a.dataURI};a.prototype.writeHref=function(b,a,d,e){b&&(l.isDataProtocol(b)?a.dataURI=b:(a.href=c.toJSON(b,e),l.isAbsolute(a.href)&&(a.href=l.normalize(a.href))))};a.prototype.clone=function(){return new f({href:this.href,primitive:this.primitive})};
var f;e.__decorate([g.property({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],a.prototype,"href",void 0);e.__decorate([g.reader("href")],a.prototype,"readHref",null);e.__decorate([g.writer("href",{href:{type:String},dataURI:{type:String}})],a.prototype,"writeHref",null);e.__decorate([g.enumeration(h)],a.prototype,"primitive",void 0);return a=f=e.__decorate([g.subclass("esri.symbols.support.IconSymbol3DLayerResource")],a)}(k.JSONSupport);a.IconSymbol3DLayerResource=f;a.defaultPrimitive=
"circle";a.default=f})},"esri/symbols/support/Symbol3DAnchorPosition2D":function(){define(["require","exports","tslib","../../core/Accessor","../../core/accessorSupport/decorators"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function g(){var c=null!==a&&a.apply(this,arguments)||this;c.x=0;c.y=0;return c}e.__extends(g,a);c=g;g.prototype.clone=function(){return new c({x:this.x,y:this.y})};var c;e.__decorate([k.property({type:Number})],g.prototype,"x",void 0);
e.__decorate([k.property({type:Number})],g.prototype,"y",void 0);return g=c=e.__decorate([k.subclass("esri.symbols.support.Symbol3DAnchorPosition2D")],g)}(m);a.Symbol3DAnchorPosition2D=f;a.default=f})},"esri/symbols/LabelSymbol3D":function(){define("require exports tslib ../core/Collection ../core/lang ../core/accessorSupport/decorators ./Symbol3D ./TextSymbol3DLayer ./callouts/calloutUtils ./support/Symbol3DVerticalOffset".split(" "),function(f,a,e,m,k,l,g,c,h,b){var d=m.ofType({base:null,key:"type",
typeMap:{text:c}});return function(a){function g(b){b=a.call(this,b)||this;b.verticalOffset=null;b.callout=null;b.styleOrigin=null;b.symbolLayers=new d;b.type="label-3d";return b}e.__extends(g,a);f=g;g.prototype.supportsCallout=function(){return!0};g.prototype.hasVisibleCallout=function(){return h.hasVisibleCallout(this)};g.prototype.hasVisibleVerticalOffset=function(){return h.hasVisibleVerticalOffset(this)};g.prototype.clone=function(){return new f({styleOrigin:k.clone(this.styleOrigin),symbolLayers:k.clone(this.symbolLayers),
thumbnail:k.clone(this.thumbnail),callout:k.clone(this.callout),verticalOffset:k.clone(this.verticalOffset)})};g.fromTextSymbol=function(b){return new f({symbolLayers:[c.fromTextSymbol(b)]})};var f;e.__decorate([l.property({type:b.default,json:{write:!0}})],g.prototype,"verticalOffset",void 0);e.__decorate([l.property(h.calloutProperty)],g.prototype,"callout",void 0);e.__decorate([l.property({json:{read:!1,write:!1}})],g.prototype,"styleOrigin",void 0);e.__decorate([l.property({type:d})],g.prototype,
"symbolLayers",void 0);e.__decorate([l.enumeration({LabelSymbol3D:"label-3d"})],g.prototype,"type",void 0);return g=f=e.__decorate([l.subclass("esri.symbols.LabelSymbol3D")],g)}(g)})},"esri/symbols/Symbol3D":function(){define("require exports tslib ../core/Collection ../core/collectionUtils ../core/jsonMap ../core/Logger ../core/urlUtils ../core/Warning ../core/accessorSupport/decorators ../portal/Portal ../support/persistableUrlUtils ./ExtrudeSymbol3DLayer ./FillSymbol3DLayer ./IconSymbol3DLayer ./LineSymbol3DLayer ./ObjectSymbol3DLayer ./PathSymbol3DLayer ./Symbol ./Symbol3DLayer ./TextSymbol3DLayer ./WaterSymbol3DLayer ./support/StyleOrigin ./support/Thumbnail".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u,v,y,z,A,B,D,C){var E={icon:q,object:u,line:x,path:v,fill:r,extrude:p,text:A,water:B},F=m.ofType({base:z,key:"type",typeMap:E}),I=l.strict()({PointSymbol3D:"point-3d",PolygonSymbol3D:"polygon-3d",LineSymbol3D:"line-3d",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d"}),J=g.getLogger("esri.symbols.Symbol3D");return function(a){function g(b){b=a.call(this,b)||this;b.styleOrigin=null;b.thumbnail=null;b.type=null;var d=b.__accessor__&&b.__accessor__.metadatas&&
b.__accessor__.metadatas.symbolLayers;b._set("symbolLayers",new (d&&d.type||m));return b}e.__extends(g,a);Object.defineProperty(g.prototype,"color",{get:function(){return null},set:function(b){J.error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"symbolLayers",{set:function(b){k.referenceSetter(b,this._get("symbolLayers"))},enumerable:!0,configurable:!0});
g.prototype.readSymbolLayers=function(b,a,d){a=[];for(var c=0;c<b.length;c++){var e=b[c],g=z.typeJSONDictionary.read(e.type),f=g&&E[g];f?(e=new f,e.read(b[c],d),a.push(e)):(J.warn("Unknown symbol layer type: "+g),d&&d.messages&&d.messages.push(new h("symbol-layer:unsupported","Symbol layers of type '"+(g||e.type||"unknown")+"' are not supported",{definition:e,context:d})))}return a};g.prototype.readStyleOrigin=function(b,a,c){if(b.styleUrl&&b.name)return a=n.fromJSON(b.styleUrl,c),new D({styleUrl:a,
name:b.name});if(b.styleName&&b.name)return new D({portal:c&&c.portal||d.getDefault(),styleName:b.styleName,name:b.name});c&&c.messages&&c.messages.push(new h("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:c,definition:b}))};g.prototype.writeStyleOrigin=function(b,a,d,e){b.styleUrl&&b.name?(d=n.toJSON(b.styleUrl,e),c.isAbsolute(d)&&(d=c.normalize(d)),a.styleOrigin={styleUrl:d,name:b.name}):b.styleName&&b.name&&(b.portal&&
e&&e.portal&&!c.hasSamePortal(b.portal.restUrl,e.portal.restUrl)?e&&e.messages&&e.messages.push(new h("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):a.styleOrigin={styleName:b.styleName,name:b.name})};g.prototype.normalizeCtorArgs=function(b){return b instanceof z||b&&E[b.type]?{symbolLayers:[b]}:Array.isArray(b)?{symbolLayers:b}:b};e.__decorate([b.property({json:{read:!1,write:!1}})],
g.prototype,"color",null);e.__decorate([b.property({type:F,nonNullable:!0,json:{write:!0}}),b.cast(k.castForReferenceSetter)],g.prototype,"symbolLayers",null);e.__decorate([b.reader("symbolLayers")],g.prototype,"readSymbolLayers",null);e.__decorate([b.property({type:D})],g.prototype,"styleOrigin",void 0);e.__decorate([b.reader("styleOrigin")],g.prototype,"readStyleOrigin",null);e.__decorate([b.writer("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],
g.prototype,"writeStyleOrigin",null);e.__decorate([b.property({type:C.default,json:{read:!1}})],g.prototype,"thumbnail",void 0);e.__decorate([b.property({type:I.apiValues,readOnly:!0,json:{type:I.jsonValues,read:!1}})],g.prototype,"type",void 0);return g=e.__decorate([b.subclass("esri.symbols.Symbol3D")],g)}(y)})},"esri/core/collectionUtils":function(){define(["require","exports","./Collection"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.referenceSetter=function(a,f,l){void 0===
l&&(l=e);f||(f=new l);if(f===a)return f;f.removeAll();a&&(Array.isArray(a)||"items"in a&&Array.isArray(a.items))?f.addMany(a):a&&f.add(a);return f};a.castForReferenceSetter=function(a){return a}})},"esri/symbols/LineSymbol3DLayer":function(){define("require exports tslib ../Color ../core/maybe ../core/screenUtils ../core/accessorSupport/decorators ./Symbol3DLayer ./support/colors ./support/materialUtils ./support/Symbol3DMaterial".split(" "),function(f,a,e,m,k,l,g,c,h,b,d){return function(a){function c(b){b=
a.call(this,b)||this;b.material=null;b.type="line";b.join="miter";b.cap="butt";b.size=l.px2pt(1);b.stipplePattern=null;b.stippleOffColor=null;return b}e.__extends(c,a);f=c;c.prototype.clone=function(){return new f({enabled:this.enabled,material:k.isSome(this.material)?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,stipplePattern:this.stipplePattern?this.stipplePattern.slice():null,stippleOffColor:this.stippleOffColor?this.stippleOffColor.clone():null})};c.fromSimpleLineSymbol=
function(b){return new f({size:b.width||1,cap:b.cap||"butt",join:b.join||"miter",material:{color:(b.color||h.white).clone()}})};var f;e.__decorate([g.property({type:d.default,json:{write:!0}})],c.prototype,"material",void 0);e.__decorate([g.enumeration({Line:"line"})],c.prototype,"type",void 0);e.__decorate([g.property({type:["miter","bevel","round"],json:{write:!0,default:"miter"}})],c.prototype,"join",void 0);e.__decorate([g.property({type:["butt","square","round"],json:{write:!0,default:"butt"}})],
c.prototype,"cap",void 0);e.__decorate([g.property(b.screenSizeProperty)],c.prototype,"size",void 0);e.__decorate([g.property(b.stipplePatternProperty)],c.prototype,"stipplePattern",void 0);e.__decorate([g.property({type:m})],c.prototype,"stippleOffColor",void 0);return c=f=e.__decorate([g.subclass("esri.symbols.LineSymbol3DLayer")],c)}(c)})},"esri/symbols/ObjectSymbol3DLayer":function(){define("require exports tslib ../core/maybe ../core/accessorSupport/decorators ./Symbol3DLayer ./support/ObjectSymbol3DLayerResource ./support/Symbol3DAnchorPosition3D ./support/Symbol3DMaterial".split(" "),
function(f,a,e,m,k,l,g,c,h){return function(b){function a(a){a=b.call(this,a)||this;a.material=null;a.castShadows=!0;a.resource=null;a.type="object";a.width=void 0;a.height=void 0;a.depth=void 0;a.anchor=void 0;a.anchorPosition=void 0;a.heading=void 0;a.tilt=void 0;a.roll=void 0;return a}e.__extends(a,b);f=a;a.prototype.clone=function(){return new f({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),depth:this.depth,
enabled:this.enabled,height:this.height,material:m.isSome(this.material)?this.material.clone():null,castShadows:this.castShadows,resource:this.resource&&this.resource.clone(),width:this.width})};Object.defineProperty(a.prototype,"isPrimitive",{get:function(){return!this.resource||"string"!==typeof this.resource.href},enumerable:!0,configurable:!0});var f;e.__decorate([k.property({type:h.default,json:{write:!0}})],a.prototype,"material",void 0);e.__decorate([k.property({type:Boolean,nonNullable:!0,
json:{write:!0,default:!0}})],a.prototype,"castShadows",void 0);e.__decorate([k.property({type:g.default,json:{write:!0}})],a.prototype,"resource",void 0);e.__decorate([k.enumeration({Object:"object"})],a.prototype,"type",void 0);e.__decorate([k.property({type:Number,json:{write:!0}})],a.prototype,"width",void 0);e.__decorate([k.property({type:Number,json:{write:!0}})],a.prototype,"height",void 0);e.__decorate([k.property({type:Number,json:{write:!0}})],a.prototype,"depth",void 0);e.__decorate([k.enumeration({center:"center",
top:"top",bottom:"bottom",origin:"origin",relative:"relative"}),k.property({json:{default:"origin"}})],a.prototype,"anchor",void 0);e.__decorate([k.property({type:c.Symbol3DAnchorPosition3D,json:{type:[Number],read:{reader:function(b){return new c.Symbol3DAnchorPosition3D({x:b[0],y:b[1],z:b[2]})}},write:{writer:function(b,a){a.anchorPosition=[b.x,b.y,b.z]},overridePolicy:function(){return{enabled:"relative"===this.anchor}}}}})],a.prototype,"anchorPosition",void 0);e.__decorate([k.property({type:Number,
json:{write:!0}})],a.prototype,"heading",void 0);e.__decorate([k.property({type:Number,json:{write:!0}})],a.prototype,"tilt",void 0);e.__decorate([k.property({type:Number,json:{write:!0}})],a.prototype,"roll",void 0);e.__decorate([k.property({readOnly:!0,dependsOn:["resource","resource.href"]})],a.prototype,"isPrimitive",null);return a=f=e.__decorate([k.subclass("esri.symbols.ObjectSymbol3DLayer")],a)}(l)})},"esri/symbols/support/ObjectSymbol3DLayerResource":function(){define("require exports tslib ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators ../../support/persistableUrlUtils".split(" "),
function(f,a,e,m,k,l,g){Object.defineProperty(a,"__esModule",{value:!0});var c=m.strict()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});f=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e.__extends(b,a);d=b;b.prototype.clone=function(){return new d({href:this.href,primitive:this.primitive})};var d;e.__decorate([l.property({type:String,json:{read:g.read,write:g.write}})],b.prototype,"href",
void 0);e.__decorate([l.enumeration(c)],b.prototype,"primitive",void 0);return b=d=e.__decorate([l.subclass("esri.symbols.support.ObjectSymbol3DLayerResource")],b)}(k.JSONSupport);a.ObjectSymbol3DLayerResource=f;a.defaultPrimitive="sphere";a.default=f})},"esri/symbols/support/Symbol3DAnchorPosition3D":function(){define(["require","exports","tslib","../../core/Accessor","../../core/accessorSupport/decorators"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function g(){var c=
null!==a&&a.apply(this,arguments)||this;c.x=0;c.y=0;c.z=0;return c}e.__extends(g,a);c=g;g.prototype.clone=function(){return new c({x:this.x,y:this.y,z:this.z})};var c;e.__decorate([k.property({type:Number})],g.prototype,"x",void 0);e.__decorate([k.property({type:Number})],g.prototype,"y",void 0);e.__decorate([k.property({type:Number})],g.prototype,"z",void 0);return g=c=e.__decorate([k.subclass("esri.symbols.support.Symbol3DAnchorPosition3D")],g)}(m);a.Symbol3DAnchorPosition3D=f;a.default=f})},"esri/symbols/PathSymbol3DLayer":function(){define("require exports tslib ../core/maybe ../core/accessorSupport/decorators ./Symbol3DLayer ./support/Symbol3DMaterial".split(" "),
function(f,a,e,m,k,l,g){return function(a){function c(b){b=a.call(this,b)||this;b.material=null;b.castShadows=!0;b.type="path";b.profile="circle";b.join="miter";b.cap="butt";b.width=void 0;b.height=void 0;b.anchor="center";b.profileRotation="all";return b}e.__extends(c,a);b=c;Object.defineProperty(c.prototype,"size",{get:function(){if(this.width&&this.height){if(this.width===this.height)return this.width}else{if(this.width)return this.width;if(this.height)return this.height}},set:function(b){this.height=
this.width=b},enumerable:!0,configurable:!0});c.prototype.readSize=function(b,a){return a.height||a.width?b:a.size};c.prototype.clone=function(){return new b({enabled:this.enabled,material:m.isSome(this.material)?this.material.clone():null,castShadows:this.castShadows,size:this.size,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})};var b;e.__decorate([k.property({type:g.default,json:{write:!0}})],c.prototype,
"material",void 0);e.__decorate([k.property({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],c.prototype,"castShadows",void 0);e.__decorate([k.enumeration({Path:"path"})],c.prototype,"type",void 0);e.__decorate([k.property({type:Number})],c.prototype,"size",null);e.__decorate([k.reader("size")],c.prototype,"readSize",null);e.__decorate([k.property({type:["circle","quad"],json:{write:!0,default:"circle"}})],c.prototype,"profile",void 0);e.__decorate([k.property({type:["miter","bevel","round"],
json:{write:!0,default:"miter"}})],c.prototype,"join",void 0);e.__decorate([k.property({type:["none","butt","square","round"],json:{write:!0,default:"butt"}})],c.prototype,"cap",void 0);e.__decorate([k.property({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],c.prototype,"width",void 0);e.__decorate([k.property({type:Number,json:{write:!0}})],c.prototype,"height",void 0);e.__decorate([k.property({type:["center","bottom","top"],json:{write:!0,default:"center"}})],
c.prototype,"anchor",void 0);e.__decorate([k.property({type:["heading","all"],json:{write:!0,default:"all"}})],c.prototype,"profileRotation",void 0);return c=b=e.__decorate([k.subclass("esri.symbols.PathSymbol3DLayer")],c)}(l)})},"esri/symbols/TextSymbol3DLayer":function(){define("require exports tslib ../core/lang ../core/maybe ../core/accessorSupport/decorators ./Font ./Symbol3DLayer ./support/materialUtils ./support/Symbol3DHalo ./support/Symbol3DMaterial".split(" "),function(f,a,e,m,k,l,g,c,h,
b,d){return function(a){function c(b){b=a.call(this,b)||this;b._userSize=void 0;b.halo=null;b.material=null;b.text=void 0;b.type="text";return b}e.__extends(c,a);f=c;Object.defineProperty(c.prototype,"font",{get:function(){return this._get("font")||null},set:function(b){b&&this._userSize&&(b.size=this._userSize);this._set("font",b)},enumerable:!0,configurable:!0});c.prototype.writeFont=function(b,a,d,c){d=e.__assign(e.__assign({},c),{textSymbol3D:!0});a.font=b.write({},d);delete a.font.size};Object.defineProperty(c.prototype,
"size",{get:function(){return null!=this._userSize?this._userSize:this.font&&null!=this.font.size?this.font.size:9},set:function(b){this._userSize=b;this.font&&(this.font.size=this._userSize);this.notifyChange("size")},enumerable:!0,configurable:!0});c.prototype.clone=function(){return new f({enabled:this.enabled,font:this.font&&m.clone(this.font),halo:this.halo&&m.clone(this.halo),material:k.isSome(this.material)?this.material.clone():null,size:this.size,text:this.text})};c.fromTextSymbol=function(b){var a;
a=b.haloColor;var d=b.haloSize;a=a&&0<d?{color:m.clone(a),size:d}:null;d=b.font?b.font.clone():new g;return new f({size:d.size,font:d,halo:a,material:b.color?{color:b.color.clone()}:null,text:b.text})};var f;e.__decorate([l.property({type:g,json:{write:!0}})],c.prototype,"font",null);e.__decorate([l.writer("font")],c.prototype,"writeFont",null);e.__decorate([l.property({type:b.default,json:{write:!0}})],c.prototype,"halo",void 0);e.__decorate([l.property({type:d.default,json:{write:!0}})],c.prototype,
"material",void 0);e.__decorate([l.property(h.screenSizeProperty),l.property({dependsOn:["font.size"]})],c.prototype,"size",null);e.__decorate([l.property({type:String,json:{write:!0}})],c.prototype,"text",void 0);e.__decorate([l.enumeration({Text:"text"})],c.prototype,"type",void 0);return c=f=e.__decorate([l.subclass("esri.symbols.TextSymbol3DLayer")],c)}(c)})},"esri/symbols/support/Symbol3DHalo":function(){define("require exports tslib ../../Color ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ./materialUtils".split(" "),
function(f,a,e,m,k,l,g,c){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.color=new m([0,0,0,1]);b.size=0;return b}e.__extends(b,a);d=b;b.prototype.clone=function(){return new d({color:l.clone(this.color),size:this.size})};var d;e.__decorate([g.property(c.colorAndTransparencyProperty)],b.prototype,"color",void 0);e.__decorate([g.property(c.screenSizeProperty)],b.prototype,"size",void 0);return b=d=e.__decorate([g.subclass("esri.symbols.support.Symbol3DHalo")],
b)}(k.JSONSupport);a.Symbol3DHalo=f;a.default=f})},"esri/symbols/WaterSymbol3DLayer":function(){define("require exports tslib ../Color ../core/lang ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ./Symbol3DLayer".split(" "),function(f,a,e,m,k,l,g,c){f=function(b){function a(a){a=b.call(this,a)||this;a.color=h.clone();a.type="water";a.waterbodySize="medium";a.waveDirection=null;a.waveStrength="moderate";return a}e.__extends(a,b);c=a;a.prototype.clone=function(){return new c({color:k.clone(this.color),
waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})};var c;e.__decorate([l.property({type:m,nonNullable:!0,json:{type:[g.Integer],write:function(b,a,d){return a[d]=b.toArray(1)},default:function(){return h.clone()},defaultEquals:function(b){return b.toCss(!0)===h.toCss(!0)}}})],a.prototype,"color",void 0);e.__decorate([l.enumeration({Water:"water"})],a.prototype,"type",void 0);e.__decorate([l.property({type:["small","medium","large"],json:{write:!0,default:"medium"}})],
a.prototype,"waterbodySize",void 0);e.__decorate([l.property({type:Number,json:{write:!0,default:null}})],a.prototype,"waveDirection",void 0);e.__decorate([l.property({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],a.prototype,"waveStrength",void 0);return a=c=e.__decorate([l.subclass("esri.symbols.WaterSymbol3DLayer")],a)}(c);var h=new m([0,119,190]);return f})},"esri/symbols/support/StyleOrigin":function(){define("require exports tslib ../../core/Accessor ../../core/accessorSupport/decorators ../../portal/Portal".split(" "),
function(f,a,e,m,k,l){return function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b.portal=null;return b}e.__extends(c,a);g=c;c.prototype.clone=function(){return new g({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})};var g;e.__decorate([k.property({type:String})],c.prototype,"name",void 0);e.__decorate([k.property({type:String})],c.prototype,"styleUrl",void 0);e.__decorate([k.property({type:String})],c.prototype,"styleName",void 0);e.__decorate([k.property({type:l})],
c.prototype,"portal",void 0);return c=g=e.__decorate([k.subclass("esri.symbols.support.StyleOrigin")],c)}(m)})},"esri/symbols/support/Thumbnail":function(){define(["require","exports","tslib","../../core/Accessor","../../core/accessorSupport/decorators"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function g(){return null!==a&&a.apply(this,arguments)||this}e.__extends(g,a);c=g;g.prototype.clone=function(){return new c({url:this.url})};var c;e.__decorate([k.property({type:String})],
g.prototype,"url",void 0);return g=c=e.__decorate([k.subclass("esri.symbols.support.Thumbnail")],g)}(m);a.Thumbnail=f;a.default=f})},"esri/symbols/callouts/calloutUtils":function(){define(["require","exports","./Callout3D","./LineCallout3D"],function(f,a,e,m){function k(a){if(!a)return!1;a=a.verticalOffset;return!a||0>=a.screenLength||0>=a.maxWorldLength?!1:!0}function l(a,c,e){if(!a)return a;switch(a.type){case "line":return c=new m,c.read(a,e),c}}Object.defineProperty(a,"__esModule",{value:!0});
a.hasVisibleVerticalOffset=k;a.hasVisibleCallout=function(a){if(!a||!a.supportsCallout||!a.supportsCallout())return!1;var c=a.callout;return c&&c.visible?k(a)?!0:!1:!1};a.isCalloutSupport=function(a){return"point-3d"===a.type||"label-3d"===a.type};a.read=l;a.calloutProperty={types:{key:"type",base:e,typeMap:{line:m}},json:{read:l,write:!0}}})},"esri/symbols/callouts/Callout3D":function(){define(["require","exports","tslib","../../core/JSONSupport","../../core/accessorSupport/decorators"],function(f,
a,e,m,k){return function(a){function g(c){c=a.call(this,c)||this;c.visible=!0;return c}e.__extends(g,a);g.prototype.normalizeCtorArgs=function(a){a&&a.type&&(a=e.__assign({},a),delete a.type);return a};g.prototype.clone=function(){};e.__decorate([k.property({type:["line"],readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],g.prototype,"type",void 0);e.__decorate([k.property({readOnly:!0})],g.prototype,"visible",void 0);return g=e.__decorate([k.subclass("esri.symbols.callouts.Callout3D")],g)}(m.JSONSupport)})},
"esri/symbols/callouts/LineCallout3D":function(){define("require exports tslib ../../Color ../../core/lang ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ./Callout3D ./LineCallout3DBorder ../support/materialUtils".split(" "),function(f,a,e,m,k,l,g,c,h,b,d){return function(a){function h(b){b=a.call(this,b)||this;b.type="line";b.color=new m([0,0,0,1]);b.size=g.px2pt(1);b.border=null;return b}e.__extends(h,a);f=h;Object.defineProperty(h.prototype,"visible",{get:function(){return 0<
this.size&&l.isSome(this.color)&&0<this.color.a},enumerable:!0,configurable:!0});h.prototype.clone=function(){return new f({color:k.clone(this.color),size:this.size,border:k.clone(this.border)})};var f;e.__decorate([c.property({type:["line"]})],h.prototype,"type",void 0);e.__decorate([c.property(d.colorAndTransparencyProperty)],h.prototype,"color",void 0);e.__decorate([c.property(d.screenSizeProperty)],h.prototype,"size",void 0);e.__decorate([c.property({type:b.default,json:{write:!0}})],h.prototype,
"border",void 0);e.__decorate([c.property({dependsOn:["size","color"],readOnly:!0})],h.prototype,"visible",null);return h=f=e.__decorate([c.subclass("esri.symbols.callouts.LineCallout3D")],h)}(h)})},"esri/symbols/callouts/LineCallout3DBorder":function(){define("require exports tslib ../../Color ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ../support/materialUtils".split(" "),function(f,a,e,m,k,l,g,c){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function b(){var b=
null!==a&&a.apply(this,arguments)||this;b.color=new m("white");return b}e.__extends(b,a);d=b;b.prototype.clone=function(){return new d({color:l.clone(this.color)})};var d;e.__decorate([g.property(c.colorAndTransparencyProperty)],b.prototype,"color",void 0);return b=d=e.__decorate([g.subclass("esri.symbols.callouts.LineCallout3DBorder")],b)}(k.JSONSupport);a.LineCallout3DBorder=f;a.default=f})},"esri/symbols/support/Symbol3DVerticalOffset":function(){define("require exports tslib ../../core/JSONSupport ../../core/accessorSupport/decorators ./materialUtils".split(" "),
function(f,a,e,m,k,l){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b.screenLength=0;b.minWorldLength=0;return b}e.__extends(c,a);g=c;c.prototype.clone=function(){return new g({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})};var g;e.__decorate([k.property(l.screenSizeProperty)],c.prototype,"screenLength",void 0);e.__decorate([k.property({type:Number,json:{write:!0,default:0}})],
c.prototype,"minWorldLength",void 0);e.__decorate([k.property({type:Number,json:{write:!0}})],c.prototype,"maxWorldLength",void 0);return c=g=e.__decorate([k.subclass("esri.symbols.support.Symbol3DVerticalOffset")],c)}(m.JSONSupport);a.Symbol3DVerticalOffset=f;a.default=f})},"esri/symbols/LineSymbol3D":function(){define("require exports tslib ../core/Collection ../core/lang ../core/accessorSupport/decorators ./LineSymbol3DLayer ./PathSymbol3DLayer ./Symbol3D".split(" "),function(f,a,e,m,k,l,g,c,h){var b=
m.ofType({base:null,key:"type",typeMap:{line:g,path:c}}),d=m.ofType({base:null,key:"type",typeMap:{line:g,path:c}});return function(a){function c(d){d=a.call(this,d)||this;d.symbolLayers=new b;d.type="line-3d";return d}e.__extends(c,a);h=c;c.prototype.clone=function(){return new h({styleOrigin:k.clone(this.styleOrigin),symbolLayers:k.clone(this.symbolLayers),thumbnail:k.clone(this.thumbnail)})};c.fromSimpleLineSymbol=function(b){return new h({symbolLayers:[g.fromSimpleLineSymbol(b)]})};var h;e.__decorate([l.property({type:b,
json:{type:d}})],c.prototype,"symbolLayers",void 0);e.__decorate([l.enumeration({LineSymbol3D:"line-3d"})],c.prototype,"type",void 0);return c=h=e.__decorate([l.subclass("esri.symbols.LineSymbol3D")],c)}(h)})},"esri/symbols/MarkerSymbol":function(){define("require exports tslib ../core/jsonMap ../core/screenUtils ../core/accessorSupport/decorators ./Symbol".split(" "),function(f,a,e,m,k,l,g){var c=new m.default({esriSMS:"simple-marker",esriPMS:"picture-marker"});return function(a){function b(b){b=
a.call(this,b)||this;b.angle=0;b.type=null;b.xoffset=0;b.yoffset=0;b.size=9;return b}e.__extends(b,a);b.prototype.hash=function(){return this.type+"."+this.angle+"."+this.size+"."+this.xoffset+"."+this.yoffset};e.__decorate([l.property({type:Number,json:{read:function(b){return b&&-1*b},write:function(b,a){return a.angle=b&&-1*b}}})],b.prototype,"angle",void 0);e.__decorate([l.property({type:c.apiValues,readOnly:!0,json:{type:c.jsonValues}})],b.prototype,"type",void 0);e.__decorate([l.property({type:Number,
cast:k.toPt,json:{write:!0}})],b.prototype,"xoffset",void 0);e.__decorate([l.property({type:Number,cast:k.toPt,json:{write:!0}})],b.prototype,"yoffset",void 0);e.__decorate([l.property({type:Number,cast:function(b){return"auto"===b?b:k.toPt(b)},json:{write:!0}})],b.prototype,"size",void 0);return b=e.__decorate([l.subclass("esri.symbols.MarkerSymbol")],b)}(g)})},"esri/symbols/MeshSymbol3D":function(){define("require exports tslib ../core/Collection ../core/lang ../core/accessorSupport/decorators ./FillSymbol3DLayer ./Symbol3D".split(" "),
function(f,a,e,m,k,l,g,c){var h=m.ofType({base:null,key:"type",typeMap:{fill:g}});return function(b){function a(a){a=b.call(this,a)||this;a.symbolLayers=new h;a.type="mesh-3d";return a}e.__extends(a,b);c=a;a.prototype.clone=function(){return new c({styleOrigin:k.clone(this.styleOrigin),symbolLayers:k.clone(this.symbolLayers),thumbnail:k.clone(this.thumbnail)})};var c;e.__decorate([l.property({type:h})],a.prototype,"symbolLayers",void 0);e.__decorate([l.enumeration({MeshSymbol3D:"mesh-3d"})],a.prototype,
"type",void 0);return a=c=e.__decorate([l.subclass("esri.symbols.MeshSymbol3D")],a)}(c)})},"esri/symbols/PictureFillSymbol":function(){define("require exports tslib ../core/lang ../core/screenUtils ../core/accessorSupport/decorators ./FillSymbol ./support/urlUtils".split(" "),function(f,a,e,m,k,l,g,c){return function(a){function b(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];b=a.apply(this,b)||this;b.type="picture-fill";b.url=null;b.xscale=1;b.yscale=1;b.width=12;b.height=12;b.xoffset=
0;b.yoffset=0;b.source=null;return b}e.__extends(b,a);d=b;b.prototype.normalizeCtorArgs=function(b,a,d,c){if(b&&"string"!==typeof b&&null==b.imageData)return b;var e={};b&&(e.url=b);a&&(e.outline=a);null!=d&&(e.width=k.toPt(d));null!=c&&(e.height=k.toPt(c));return e};b.prototype.clone=function(){var b=new d({color:m.clone(this.color),height:this.height,outline:this.outline&&this.outline.clone(),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});
b._set("source",m.clone(this.source));return b};b.prototype.hash=function(){return a.prototype.hash.call(this)+"."+this.color.hash()+"."+this.height+"."+this.url+"."+this.width+"."+this.xoffset+"."+this.xscale+"."+this.yoffset+"."+this.yscale};var d;e.__decorate([l.enumeration({esriPFS:"picture-fill"})],b.prototype,"type",void 0);e.__decorate([l.property(c.urlPropertyDefinition)],b.prototype,"url",void 0);e.__decorate([l.property({type:Number,json:{write:!0}})],b.prototype,"xscale",void 0);e.__decorate([l.property({type:Number,
json:{write:!0}})],b.prototype,"yscale",void 0);e.__decorate([l.property({type:Number,cast:k.toPt,json:{write:!0}})],b.prototype,"width",void 0);e.__decorate([l.property({type:Number,cast:k.toPt,json:{write:!0}})],b.prototype,"height",void 0);e.__decorate([l.property({type:Number,cast:k.toPt,json:{write:!0}})],b.prototype,"xoffset",void 0);e.__decorate([l.property({type:Number,cast:k.toPt,json:{write:!0}})],b.prototype,"yoffset",void 0);e.__decorate([l.property(c.sourcePropertyDefinition)],b.prototype,
"source",void 0);return b=d=e.__decorate([l.subclass("esri.symbols.PictureFillSymbol")],b)}(g)})},"esri/symbols/support/urlUtils":function(){define(["require","exports","../../core/urlUtils","../../support/persistableUrlUtils"],function(f,a,e,m){function k(a,g,b){return g.imageData?e.makeData({mediaType:g.contentType||"image/png",isBase64:!0,data:g.imageData}):l(g.url,b)}function l(a,g){return!g||"service"!==g.origin&&"portal-item"!==g.origin||!g.layer||"feature"!==g.layer.type&&"stream"!==g.layer.type||
e.isAbsolute(a)||!g.layer.parsedUrl?m.fromJSON(a,g):e.join(g.layer.parsedUrl.path,"images",a)}function g(a,g,b,d){e.isDataProtocol(a)?(a=e.dataComponents(a),g.contentType=a.mediaType,g.imageData=a.data,b&&b.imageData===g.imageData&&b.url&&m.write(b.url,g,"url",d)):m.write(a,g,"url",d)}Object.defineProperty(a,"__esModule",{value:!0});a.readImageDataOrUrl=k;a.read=l;a.writeImageDataAndUrl=g;a.urlPropertyDefinition={json:{read:{source:["imageData","url"],reader:k},write:{writer:function(a,e,b,d){g(a,
e,this.source,d)}}}};a.sourcePropertyDefinition={readOnly:!0,json:{read:{source:["imageData","url"],reader:function(a,e,b){a={};e.imageData&&(a.imageData=e.imageData);e.contentType&&(a.contentType=e.contentType);e.url&&(a.url=l(e.url,b));return a}}}}})},"esri/symbols/PictureMarkerSymbol":function(){define("require exports tslib ../core/lang ../core/screenUtils ../core/accessorSupport/decorators ./MarkerSymbol ./support/urlUtils".split(" "),function(f,a,e,m,k,l,g,c){return function(a){function b(){for(var b=
[],d=0;d<arguments.length;d++)b[d]=arguments[d];b=a.apply(this,b)||this;b.color=null;b.type="picture-marker";b.url=null;b.source=null;b.height=12;b.width=12;b.size=null;return b}e.__extends(b,a);d=b;b.prototype.normalizeCtorArgs=function(b,a,d){if(b&&"string"!==typeof b&&null==b.imageData)return b;var c={};b&&(c.url=b);null!=a&&(c.width=k.toPt(a));null!=d&&(c.height=k.toPt(d));return c};b.prototype.readHeight=function(b,a){return a.size||b};b.prototype.readWidth=function(b,a){return a.size||b};b.prototype.clone=
function(){var b=new d({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});b._set("source",m.clone(this.source));return b};b.prototype.hash=function(){return a.prototype.hash.call(this)+"."+this.height+"."+this.url+"."+this.width};var d;e.__decorate([l.property({json:{write:!1}})],b.prototype,"color",void 0);e.__decorate([l.enumeration({esriPMS:"picture-marker"})],b.prototype,"type",void 0);e.__decorate([l.property(c.urlPropertyDefinition)],
b.prototype,"url",void 0);e.__decorate([l.property(c.sourcePropertyDefinition)],b.prototype,"source",void 0);e.__decorate([l.property({type:Number,cast:k.toPt,json:{write:!0}})],b.prototype,"height",void 0);e.__decorate([l.reader("height",["height","size"])],b.prototype,"readHeight",null);e.__decorate([l.property({type:Number,cast:k.toPt,json:{write:!0}})],b.prototype,"width",void 0);e.__decorate([l.property({json:{write:!1}})],b.prototype,"size",void 0);return b=d=e.__decorate([l.subclass("esri.symbols.PictureMarkerSymbol")],
b)}(g)})},"esri/symbols/PointSymbol3D":function(){define("require exports tslib ../core/Collection ../core/Error ../core/lang ../core/accessorSupport/decorators ./IconSymbol3DLayer ./ObjectSymbol3DLayer ./Symbol3D ./TextSymbol3DLayer ./callouts/calloutUtils ./support/Symbol3DVerticalOffset".split(" "),function(f,a,e,m,k,l,g,c,h,b,d,n,p){var r=m.ofType({base:null,key:"type",typeMap:{icon:c,object:h,text:d}}),q=m.ofType({base:null,key:"type",typeMap:{icon:c,object:h}});return function(b){function a(a){a=
b.call(this,a)||this;a.verticalOffset=null;a.callout=null;a.symbolLayers=new r;a.type="point-3d";return a}e.__extends(a,b);h=a;a.prototype.writeSymbolLayers=function(b,a,d,c){var e=b.filter(function(b){return"text"!==b.type});c&&c.messages&&e.length<b.length&&(b=b.find(function(b){return"text"===b.type}),c.messages.push(new k("symbol-layer:unsupported","Symbol layers of type 'text' cannot be persisted in PointSymbol3D",{symbolLayer:b})));a[d]=e.map(function(b){return b.write({},c)}).toArray()};a.prototype.supportsCallout=
function(){if(1>(this.symbolLayers?this.symbolLayers.length:0))return!1;for(var b=0,a=this.symbolLayers.items;b<a.length;b++)switch(a[b].type){case "icon":case "text":case "object":continue;default:return!1}return!0};a.prototype.hasVisibleCallout=function(){return n.hasVisibleCallout(this)};a.prototype.hasVisibleVerticalOffset=function(){return n.hasVisibleVerticalOffset(this)};a.prototype.clone=function(){return new h({verticalOffset:l.clone(this.verticalOffset),callout:l.clone(this.callout),styleOrigin:l.clone(this.styleOrigin),
symbolLayers:l.clone(this.symbolLayers),thumbnail:l.clone(this.thumbnail)})};a.fromSimpleMarkerSymbol=function(b){return new h({symbolLayers:[c.fromSimpleMarkerSymbol(b)]})};a.fromPictureMarkerSymbol=function(b){return new h({symbolLayers:[c.fromPictureMarkerSymbol(b)]})};a.fromCIMSymbol=function(b){return new h({symbolLayers:[c.fromCIMSymbol(b)],callout:{type:"line",size:.5,color:[0,0,0]},verticalOffset:{screenLength:40}})};a.fromTextSymbol=function(b){return new h({symbolLayers:[d.fromTextSymbol(b)]})};
var h;e.__decorate([g.property({type:p.default,json:{write:!0}})],a.prototype,"verticalOffset",void 0);e.__decorate([g.property(n.calloutProperty)],a.prototype,"callout",void 0);e.__decorate([g.property({type:r,json:{type:q,origins:{"web-scene":{type:q}}}})],a.prototype,"symbolLayers",void 0);e.__decorate([g.writer("web-scene","symbolLayers")],a.prototype,"writeSymbolLayers",null);e.__decorate([g.enumeration({PointSymbol3D:"point-3d"})],a.prototype,"type",void 0);return a=h=e.__decorate([g.subclass("esri.symbols.PointSymbol3D")],
a)}(b)})},"esri/symbols/PolygonSymbol3D":function(){define("require exports tslib ../core/Collection ../core/Error ../core/lang ../core/maybe ../core/accessorSupport/decorators ./ExtrudeSymbol3DLayer ./FillSymbol3DLayer ./IconSymbol3DLayer ./LineSymbol3DLayer ./ObjectSymbol3DLayer ./Symbol3D ./TextSymbol3DLayer ./WaterSymbol3DLayer".split(" "),function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x){var u=m.ofType({base:null,key:"type",typeMap:{extrude:h,fill:b,icon:d,line:n,object:p,text:q,water:x}}),v=m.ofType({base:null,
key:"type",typeMap:{extrude:h,fill:b,icon:d,line:n,object:p,water:x}});return function(a){function d(b){b=a.call(this,b)||this;b.type="polygon-3d";return b}e.__extends(d,a);h=d;d.prototype.writeSymbolLayers=function(b,a,d,c){var e=b.filter(function(b){return"text"!==b.type});c&&c.messages&&e.length<b.length&&(b=b.find(function(b){return"text"===b.type}),c.messages.push(new k("symbol-layer:unsupported","Symbol layers of type 'text' cannot be persisted in PolygonSymbol3D",{symbolLayer:b})));a[d]=e.map(function(b){return b.write({},
c)}).toArray()};d.prototype.clone=function(){return new h({styleOrigin:l.clone(this.styleOrigin),symbolLayers:l.clone(this.symbolLayers),thumbnail:l.clone(this.thumbnail)})};d.fromJSON=function(b){var a=new h;a.read(b);if(2===a.symbolLayers.length&&"fill"===a.symbolLayers.getItemAt(0).type&&"line"===a.symbolLayers.getItemAt(1).type){var d=a.symbolLayers.getItemAt(0),c=a.symbolLayers.getItemAt(1);!c.enabled||b.symbolLayers&&b.symbolLayers[1]&&!1===b.symbolLayers[1].enable||(d.outline={size:c.size,
color:g.isSome(c.material)?c.material.color:null});a.symbolLayers.removeAt(1)}return a};d.fromSimpleFillSymbol=function(a){return new h({symbolLayers:[b.fromSimpleFillSymbol(a)]})};var h;e.__decorate([c.property({type:u,json:{type:v}})],d.prototype,"symbolLayers",void 0);e.__decorate([c.writer("web-scene","symbolLayers")],d.prototype,"writeSymbolLayers",null);e.__decorate([c.enumeration({PolygonSymbol3D:"polygon-3d"})],d.prototype,"type",void 0);return d=h=e.__decorate([c.subclass("esri.symbols.PolygonSymbol3D")],
d)}(r)})},"esri/symbols/SimpleFillSymbol":function(){define("require exports tslib ../Color ../core/jsonMap ../core/lang ../core/accessorSupport/decorators ./FillSymbol ./SimpleLineSymbol".split(" "),function(f,a,e,m,k,l,g,c,h){var b=new k.default({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});return function(a){function d(){for(var b=
[],d=0;d<arguments.length;d++)b[d]=arguments[d];b=a.apply(this,b)||this;b.color=new m([0,0,0,.25]);b.outline=new h;b.type="simple-fill";b.style="solid";return b}e.__extends(d,a);c=d;d.prototype.normalizeCtorArgs=function(b,a,d){if(b&&"string"!==typeof b)return b;var c={};b&&(c.style=b);a&&(c.outline=a);d&&(c.color=d);return c};d.prototype.clone=function(){return new c({color:l.clone(this.color),outline:this.outline&&this.outline.clone(),style:this.style})};d.prototype.hash=function(){return""+a.prototype.hash.call(this)+
this.style+"."+(this.color&&this.color.hash())};var c;e.__decorate([g.property()],d.prototype,"color",void 0);e.__decorate([g.property()],d.prototype,"outline",void 0);e.__decorate([g.enumeration({esriSFS:"simple-fill"})],d.prototype,"type",void 0);e.__decorate([g.property({type:b.apiValues,json:{read:b.read,write:b.write}})],d.prototype,"style",void 0);return d=c=e.__decorate([g.subclass("esri.symbols.SimpleFillSymbol")],d)}(c)})},"esri/symbols/SimpleMarkerSymbol":function(){define("require exports tslib ../Color ../core/jsonMap ../core/lang ../core/screenUtils ../core/accessorSupport/decorators ./MarkerSymbol ./SimpleLineSymbol".split(" "),
function(f,a,e,m,k,l,g,c,h,b){var d=new k.default({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});return function(a){function h(){for(var d=[],c=0;c<arguments.length;c++)d[c]=arguments[c];d=a.apply(this,d)||this;d.color=new m([255,255,255,.25]);d.type="simple-marker";d.size=12;d.style="circle";d.outline=new b;return d}e.__extends(h,a);f=h;h.prototype.normalizeCtorArgs=function(b,a,d,c){if(b&&
"string"!==typeof b)return b;var e={};b&&(e.style=b);null!=a&&(e.size=g.toPt(a));d&&(e.outline=d);c&&(e.color=c);return e};h.prototype.writeColor=function(b,a){b&&"x"!==this.style&&"cross"!==this.style&&(a.color=b.toJSON());null===b&&(a.color=null)};Object.defineProperty(h.prototype,"path",{set:function(b){this.style="path";this._set("path",b)},enumerable:!0,configurable:!0});h.prototype.clone=function(){return new f({angle:this.angle,color:l.clone(this.color),outline:this.outline&&this.outline.clone(),
path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})};h.prototype.hash=function(){var b;return a.prototype.hash.call(this)+"."+(this.color&&this.color.hash())+"."+this.path+"."+this.style+"."+(null===(b=this.outline)||void 0===b?void 0:b.hash())};var f;e.__decorate([c.property()],h.prototype,"color",void 0);e.__decorate([c.writer("color")],h.prototype,"writeColor",null);e.__decorate([c.enumeration({esriSMS:"simple-marker"})],h.prototype,"type",void 0);e.__decorate([c.property()],
h.prototype,"size",void 0);e.__decorate([c.property({type:d.apiValues,json:{read:d.read,write:d.write}})],h.prototype,"style",void 0);e.__decorate([c.property({type:String,json:{write:!0}})],h.prototype,"path",null);e.__decorate([c.property({type:b,json:{default:null,write:!0}})],h.prototype,"outline",void 0);return h=f=e.__decorate([c.subclass("esri.symbols.SimpleMarkerSymbol")],h)}(h)})},"esri/symbols/TextSymbol":function(){define("require exports tslib ../Color ../core/lang ../core/screenUtils ../core/accessorSupport/decorators ./Font ./Symbol".split(" "),
function(f,a,e,m,k,l,g,c,h){return function(b){function a(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];a=b.apply(this,a)||this;a.backgroundColor=null;a.borderLineColor=null;a.borderLineSize=null;a.font=new c;a.horizontalAlignment="center";a.kerning=!0;a.haloColor=null;a.haloSize=null;a.rightToLeft=null;a.rotated=!1;a.text="";a.type="text";a.verticalAlignment=null;a.xoffset=0;a.yoffset=0;a.angle=0;a.width=null;a.lineWidth=192;a.lineHeight=1;return a}e.__extends(a,b);h=a;a.prototype.normalizeCtorArgs=
function(b,a,d){if(b&&"string"!==typeof b)return b;var c={};b&&(c.text=b);a&&(c.font=a);d&&(c.color=d);return c};a.prototype.writeLineWidth=function(b,a,d,c){c&&"string"!==typeof c||(a[d]=b)};a.prototype.castLineWidth=function(b){return l.toPt(b)};a.prototype.writeLineHeight=function(b,a,d,c){c&&"string"!==typeof c||(a[d]=b)};a.prototype.clone=function(){return new h({angle:this.angle,backgroundColor:k.clone(this.backgroundColor),borderLineColor:k.clone(this.borderLineColor),borderLineSize:this.borderLineSize,
color:k.clone(this.color),font:this.font&&this.font.clone(),haloColor:k.clone(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})};a.prototype.hash=function(){return(this.backgroundColor&&this.backgroundColor.hash())+"."+this.borderLineColor+
"."+this.borderLineSize+"."+this.color.hash()+"."+(this.font&&this.font.hash())+"."+(this.haloColor&&this.haloColor.hash())+"."+this.haloSize+"."+this.horizontalAlignment+"."+this.kerning+"."+this.rightToLeft+"."+this.rotated+"."+this.text+"."+this.verticalAlignment+"."+this.width+"."+this.xoffset+"."+this.yoffset+"."+this.lineHeight+"."+this.lineWidth+"."+this.angle};var h;e.__decorate([g.property({type:m,json:{write:!0}})],a.prototype,"backgroundColor",void 0);e.__decorate([g.property({type:m,json:{write:!0}})],
a.prototype,"borderLineColor",void 0);e.__decorate([g.property({type:Number,json:{write:!0}})],a.prototype,"borderLineSize",void 0);e.__decorate([g.property({type:c,json:{write:!0}})],a.prototype,"font",void 0);e.__decorate([g.property({type:["left","right","center","justify"],json:{write:!0}})],a.prototype,"horizontalAlignment",void 0);e.__decorate([g.property({type:Boolean,json:{write:!0}})],a.prototype,"kerning",void 0);e.__decorate([g.property({type:m,json:{write:!0}})],a.prototype,"haloColor",
void 0);e.__decorate([g.property({type:Number,cast:l.toPt,json:{write:!0}})],a.prototype,"haloSize",void 0);e.__decorate([g.property({type:Boolean,json:{write:!0}})],a.prototype,"rightToLeft",void 0);e.__decorate([g.property({type:Boolean,json:{write:!0}})],a.prototype,"rotated",void 0);e.__decorate([g.property({type:String,json:{write:!0}})],a.prototype,"text",void 0);e.__decorate([g.property({type:String,readOnly:!0})],a.prototype,"type",void 0);e.__decorate([g.property({type:["baseline","top",
"middle","bottom"],json:{write:!0}})],a.prototype,"verticalAlignment",void 0);e.__decorate([g.property({type:Number,cast:l.toPt,json:{write:!0}})],a.prototype,"xoffset",void 0);e.__decorate([g.property({type:Number,cast:l.toPt,json:{write:!0}})],a.prototype,"yoffset",void 0);e.__decorate([g.property({type:Number,json:{read:function(b){return b&&-1*b},write:function(b,a){return a.angle=b&&-1*b}}})],a.prototype,"angle",void 0);e.__decorate([g.property({type:Number,json:{write:!0}})],a.prototype,"width",
void 0);e.__decorate([g.property({type:Number})],a.prototype,"lineWidth",void 0);e.__decorate([g.writer("lineWidth")],a.prototype,"writeLineWidth",null);e.__decorate([g.cast("lineWidth")],a.prototype,"castLineWidth",null);e.__decorate([g.property({type:Number})],a.prototype,"lineHeight",void 0);e.__decorate([g.writer("lineHeight")],a.prototype,"writeLineHeight",null);return a=h=e.__decorate([g.subclass("esri.symbols.TextSymbol")],a)}(h)})},"esri/symbols/WebStyleSymbol":function(){define("require exports tslib ../core/jsonMap ../core/Logger ../core/promiseUtils ../core/accessorSupport/decorators ../portal/Portal ../support/persistableUrlUtils ./Symbol ./support/Thumbnail @dojo/framework/shim/Promise".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d){function n(){return new Promise(function(b,a){f(["./support/styleUtils"],b,a)})}var p=k.getLogger("esri.symbols.WebStyleSymbol"),r=m.strict()({styleSymbolReference:"web-style"});return function(b){function a(a){a=b.call(this,a)||this;a.styleName=null;a.portal=null;a.styleUrl=null;a.thumbnail=null;a.name=null;a.type="web-style";return a}e.__extends(a,b);f=a;a.prototype.read=function(a,d){this.portal=d?d.portal:void 0;b.prototype.read.call(this,a,d)};a.prototype.clone=
function(){return new f({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})};a.prototype.fetchSymbol=function(b){return this._fetchSymbol("webRef",b)};a.prototype.fetchCIMSymbol=function(b){return this._fetchSymbol("cimRef",b)};a.prototype._fetchSymbol=function(b,a){return e.__awaiter(this,void 0,void 0,function(){var d,c;return e.__generator(this,function(e){switch(e.label){case 0:return[4,n()];case 1:return d=e.sent(),l.throwIfAborted(a),c=d.resolveWebStyleSymbol(this,
{portal:this.portal},b,a),c.catch(function(b){p.error("#fetchSymbol()","Failed to create symbol from style",b)}),[2,c]}})})};var f;e.__decorate([g.property({json:{write:!1}})],a.prototype,"color",void 0);e.__decorate([g.property({type:String,json:{write:!0}})],a.prototype,"styleName",void 0);e.__decorate([g.property({type:c,json:{write:!1}})],a.prototype,"portal",void 0);e.__decorate([g.property({type:String,json:{read:h.read,write:h.write}})],a.prototype,"styleUrl",void 0);e.__decorate([g.property({type:d.default,
json:{read:!1}})],a.prototype,"thumbnail",void 0);e.__decorate([g.property({type:String,json:{write:!0}})],a.prototype,"name",void 0);e.__decorate([g.property({type:r.apiValues,readOnly:!0,json:{type:r.jsonValues,read:!1,write:r.write}})],a.prototype,"type",void 0);return a=f=e.__decorate([g.subclass("esri.symbols.WebStyleSymbol")],a)}(b)})},"esri/symbols/support/jsonUtils":function(){define("require exports ../../core/Error ../../core/Logger ../../core/Warning ../CIMSymbol ../LabelSymbol3D ../LineSymbol3D ../MeshSymbol3D ../PictureFillSymbol ../PictureMarkerSymbol ../PointSymbol3D ../PolygonSymbol3D ../SimpleFillSymbol ../SimpleLineSymbol ../SimpleMarkerSymbol ../Symbol3D ../TextSymbol ../WebStyleSymbol ../callouts/LineCallout3D ./symbolConversion".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u,v,y,z,A){function B(b,a,d){a=b?C[b.type]||null:null;if(a)return a=new a,a.read(b,d),a;b&&(a="Symbols of type '"+(b.type||"unknown")+"' are not supported",d&&d.messages&&d.messages.push(new k("symbol:unsupported",a,{definition:b,context:d})),E.error(a));return null}function D(b,a,d){if(!b)return null;if(!(!d||"web-scene"!==d.origin||b instanceof u||b instanceof y)){var c="cim"!==b.type?A.to3D(b):{symbol:null,error:new e("symbol-conversion:unsupported-cim-symbol",
"CIM symbol is unsupported in web scenes",{symbol:b})};if(c.symbol)return c.symbol.write(a,d);d.messages&&d.messages.push(new e("symbol:unsupported","Symbols of type '"+b.declaredClass+"' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView",{symbol:b,context:d,error:c.error}));return null}return d&&"web-map"===d.origin&&"web-style"===b.type?(d.messages&&d.messages.push(new e("symbol:unsupported","Symbols of type '"+b.declaredClass+"' are not supported in webmaps. Use CIMSymbol instead when working with WebMap in MapView.",
{symbol:b,context:d})),null):b.write(a,d)}Object.defineProperty(a,"__esModule",{value:!0});var C={esriSMS:x,esriPMS:d,esriTS:v,esriSLS:q,esriSFS:r,esriPFS:b,PointSymbol3D:n,LineSymbol3D:c,PolygonSymbol3D:p,MeshSymbol3D:h,LabelSymbol3D:g,styleSymbolReference:y,CIMSymbolReference:l},E=m.getLogger("esri.symbols.support.jsonUtils");a.read=B;a.writeTarget=function(b,a,d,c){(b=D(b,{},c))&&(a[d]=b)};a.write=D;a.fromJSON=function(b,a){return B(b,null,a)};a.readCallout3D=function(b,a){if(!b||!b.type)return null;
var d=null;switch(b.type){case "line":d=new z}d&&d.read(b,a);return d}})},"esri/symbols/support/symbolConversion":function(){define(["require","exports","../../symbols","../../core/Error"],function(f,a,e,m){Object.defineProperty(a,"__esModule",{value:!0});a.to3D=function(a,f,g,c){void 0===f&&(f=!1);void 0===g&&(g=!1);void 0===c&&(c=!0);if(!a)return{symbol:null};if(e.isSymbol3D(a)||a instanceof e.WebStyleSymbol)c=a.clone();else if("cim"===a.type)c=e.PointSymbol3D.fromCIMSymbol(a);else if(a instanceof
e.SimpleLineSymbol)c=e.LineSymbol3D.fromSimpleLineSymbol(a);else if(a instanceof e.SimpleMarkerSymbol)c=e.PointSymbol3D.fromSimpleMarkerSymbol(a);else if(a instanceof e.PictureMarkerSymbol)c=e.PointSymbol3D.fromPictureMarkerSymbol(a);else if(a instanceof e.SimpleFillSymbol)c=e.PolygonSymbol3D.fromSimpleFillSymbol(a);else if(a instanceof e.TextSymbol)c=c?e.LabelSymbol3D.fromTextSymbol(a):e.PointSymbol3D.fromTextSymbol(a);else return{error:new m("symbol-conversion:unsupported-2d-symbol","2D symbol of type '"+
(a.type||a.declaredClass)+"' is unsupported in 3D",{symbol:a})};f&&(c.id=a.id);if(g&&e.isSymbol3D(c))for(a=0;a<c.symbolLayers.length;++a)c.symbolLayers.getItemAt(a)._ignoreDrivers=!0;return{symbol:c}}})},"esri/layers/support/Field":function(){define("require exports tslib ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ./domains ./fieldType".split(" "),function(f,a,e,m,k,l,g,c,h){var b=new m.default({binary:"binary",coordinate:"coordinate",
countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});return function(a){function d(b){b=a.call(this,b)||this;b.alias=null;b.defaultValue=void 0;b.description=null;b.domain=null;b.editable=!0;b.length=-1;b.name=
null;b.nullable=!0;b.type=null;b.valueType=null;return b}e.__extends(d,a);f=d;d.prototype.readDescription=function(b,a){b=a.description;var d;try{d=JSON.parse(b)}catch(u){}return d?d.value:null};d.prototype.readValueType=function(a,d){a=d.description;var c;try{c=JSON.parse(a)}catch(u){}return c?b.fromJSON(c.fieldValueType):null};d.prototype.clone=function(){return new f({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,
length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType})};var f;e.__decorate([l.property({type:String,json:{write:!0}})],d.prototype,"alias",void 0);e.__decorate([l.property({type:[String,Number],json:{write:{allowNull:!0}}})],d.prototype,"defaultValue",void 0);e.__decorate([l.property()],d.prototype,"description",void 0);e.__decorate([l.reader("description")],d.prototype,"readDescription",null);e.__decorate([l.property({types:c.types,json:{read:{reader:c.fromJSON},
write:!0}})],d.prototype,"domain",void 0);e.__decorate([l.property({type:Boolean,json:{write:!0}})],d.prototype,"editable",void 0);e.__decorate([l.property({type:g.Integer,json:{write:!0}})],d.prototype,"length",void 0);e.__decorate([l.property({type:String,json:{write:!0}})],d.prototype,"name",void 0);e.__decorate([l.property({type:Boolean,json:{write:!0}})],d.prototype,"nullable",void 0);e.__decorate([l.enumeration(h.kebabDict)],d.prototype,"type",void 0);e.__decorate([l.property()],d.prototype,
"valueType",void 0);e.__decorate([l.reader("valueType",["description"])],d.prototype,"readValueType",null);return d=f=e.__decorate([l.subclass("esri.layers.support.Field")],d)}(k.JSONSupport)})},"esri/tasks/operations/query":function(){define("require exports tslib ../../request ../../core/maybe ../../core/promiseUtils ../../core/urlUtils ../../geometry/support/jsonUtils ../../geometry/support/normalizeUtils ../../layers/graphics/OptimizedFeatureSet ./pbfQueryUtils ./urlUtils ./zscale @dojo/framework/shim/Promise".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p){function r(b,a){var d=b.geometry;b=b.toJSON();d&&(b.geometry=JSON.stringify(d),b.geometryType=c.getJsonType(d),b.inSR=d.spatialReference.wkid||JSON.stringify(d.spatialReference));b.groupByFieldsForStatistics&&(b.groupByFieldsForStatistics=b.groupByFieldsForStatistics.join(","));b.objectIds&&(b.objectIds=b.objectIds.join(","));b.orderByFields&&(b.orderByFields=b.orderByFields.join(","));!b.outFields||a&&(a.returnCountOnly||a.returnExtentOnly||a.returnIdsOnly)?delete b.outFields:
-1!==b.outFields.indexOf("*")?b.outFields="*":b.outFields=b.outFields.join(",");b.outSR?b.outSR=b.outSR.wkid||JSON.stringify(b.outSR):d&&(b.returnGeometry||b.returnCentroid)&&(b.outSR=b.inSR);b.returnGeometry&&delete b.returnGeometry;b.outStatistics&&(b.outStatistics=JSON.stringify(b.outStatistics));b.pixelSize&&(b.pixelSize=JSON.stringify(b.pixelSize));b.quantizationParameters&&(b.quantizationParameters=JSON.stringify(b.quantizationParameters));b.source&&(b.layer=JSON.stringify({source:b.source}),
delete b.source);if(b.timeExtent){d=b.timeExtent;a=d.start;d=d.end;if(null!=a||null!=d)b.time=a===d?a:(null==a?"null":a)+","+(null==d?"null":d);delete b.timeExtent}return b}function q(b,a,d,c,f){void 0===c&&(c={});var l="string"===typeof b?g.urlToObject(b):b;b=a.geometry?[a.geometry]:[];c.responseType="pbf"===d?"array-buffer":"json";return h.normalizeCentralMeridian(b,null,c).then(function(b){b=b&&b[0];k.isSome(b)&&(a=a.clone(),a.geometry=b);b=n.mapParameters(e.__assign(e.__assign(e.__assign(e.__assign({},
l.query),{f:d}),f),r(a,f)));return m(l.path+"/query",e.__assign(e.__assign({},c),{query:b}))})}Object.defineProperty(a,"__esModule",{value:!0});a.queryToQueryStringParameters=r;a.executeQuery=function(b,a,d,c){var g;return e.__awaiter(this,void 0,void 0,function(){var h,f;return e.__generator(this,function(e){switch(e.label){case 0:if(null===(g=a.timeExtent)||void 0===g||!g.isEmpty)return[3,1];f={data:{features:[]}};return[3,3];case 1:return[4,q(b,a,"json",c)];case 2:f=e.sent(),e.label=3;case 3:return h=
f,p.applyFeatureSetZUnitScaling(a,d,h.data),[2,h]}})})};a.executeQueryPBF=function(a,c,e,g){var h;return(null===(h=c.timeExtent)||void 0===h?0:h.isEmpty)?l.resolve({data:new b.default}):q(a,c,"pbf",g).then(function(b){var a=d.parsePBFFeatureQuery(b.data,e);b.data=a;return b})};a.executeQueryForIds=function(b,a,d){var c;return(null===(c=a.timeExtent)||void 0===c?0:c.isEmpty)?l.resolve({data:{objectIds:[]}}):q(b,a,"json",d,{returnIdsOnly:!0})};a.executeQueryForCount=function(b,a,d){var c;return(null===
(c=a.timeExtent)||void 0===c?0:c.isEmpty)?l.resolve({data:{count:0}}):q(b,a,"json",d,{returnIdsOnly:!0,returnCountOnly:!0})};a.executeQueryForExtent=function(b,a,d){var c;return(null===(c=a.timeExtent)||void 0===c?0:c.isEmpty)?l.resolve({data:{count:0,extent:null}}):q(b,a,"json",d,{returnExtentOnly:!0,returnCountOnly:!0}).then(function(b){var a=b.data;if(a.hasOwnProperty("extent"))return b;if(a.features)throw Error("Layer does not support extent calculation.");if(a.hasOwnProperty("count"))throw Error("Layer does not support extent calculation.");
return b})};a.runQuery=q})},"esri/geometry/support/normalizeUtils":function(){define("require exports tslib ../../config ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../Polygon ../Polyline ../SpatialReference ./spatialReferenceUtils ./webMercatorUtils ../../tasks/geometry/cut ../../tasks/geometry/simplify".split(" "),function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q){function x(b){return"polygon"===b.type?b.rings:b.paths}function u(b,a){return Math.ceil((b-a)/(2*a))}function v(b,
a){for(var d=0,c=x(b);d<c.length;d++)for(var e=0,g=c[d];e<g.length;e++)g[e][0]+=a;return b}function y(b){for(var a=[],d=0,c=0,e=0;e<b.length;e++){for(var g=b[e],h=null,f=0;f<g.length;f++)h=g[f],a.push(h),0===f?c=d=h[0]:(d=Math.min(d,h[0]),c=Math.max(c,h[0]));h&&a.push([(d+c)/2,0])}return a}function z(a,d){if(!(a instanceof b||a instanceof h))throw E.error("straightLineDensify: the input geometry is neither polyline nor polygon"),new k("straightLineDensify: the input geometry is neither polyline nor polygon");
for(var c=[],e=0,g=x(a);e<g.length;e++){var f=g[e],n=[];c.push(n);n.push([f[0][0],f[0][1]]);for(var l=0;l<f.length-1;l++){var q=f[l][0],p=f[l][1],u=f[l+1][0],r=f[l+1][1],m=Math.sqrt((u-q)*(u-q)+(r-p)*(r-p)),v=(r-p)/m,y=(u-q)/m,z=m/d;if(1<z){for(var A=1;A<=z-1;A++){var C=A*d;n.push([y*C+q,v*C+p])}m=(m+Math.floor(z-1)*d)/2;n.push([y*m+q,v*m+p])}n.push([u,r])}}return"polygon"===a.type?new h({rings:c,spatialReference:a.spatialReference}):new b({paths:c,spatialReference:a.spatialReference})}function A(b,
a,d){a&&(b=z(b,1E6),b=p.webMercatorToGeographic(b,!0));d&&(b=v(b,d));return b}function B(b,a,d){if(Array.isArray(b)){var c=b[0];if(c>a){var e=u(c,a);b[0]=c+-2*e*a}else c<d&&(e=u(c,d),b[0]=c+-2*e*d)}else c=b.x,c>a?(e=u(c,a),b=b.clone().offset(-2*e*a,0)):c<d&&(e=u(c,d),b=b.clone().offset(-2*e*d,0));return b}function D(b,a){for(var d=-1,c=function(c){var e=a.cutIndexes[c],g=a.geometries[c],h=x(g);c=function(b){var a=h[b];a.some(function(d){if(180>d[0])return!0;for(var c=d=0;c<a.length;c++){var e=a[c][0];
d=e>d?e:d}d=Number(d.toFixed(9));d=-360*u(d,180);for(c=0;c<a.length;c++)e=g.getPoint(b,c),g.setPoint(b,c,e.clone().offset(d,0));return!0})};for(var f=0;f<h.length;f++)c(f);if(e===d)if("polygon"===b[0].type)for(c=0,f=x(g);c<f.length;c++)b[e]=b[e].addRing(f[c]);else{if("polyline"===b[0].type)for(c=0,f=x(g);c<f.length;c++)b[e]=b[e].addPath(f[c])}else d=e,b[e]=g},e=0;e<a.cutIndexes.length;e++)c(e);return b}function C(a,d,f){return e.__awaiter(this,void 0,void 0,function(){var l,k,x,y,z,E,I,J,G,U,X,V,
ca,Y,aa,da,W,ea,pa,qa,oa,ra,va,Ca,Da,wa,Ba,xa,na,za,ia,la,ta,ma,sa,P,Ja;return e.__generator(this,function(e){switch(e.label){case 0:if(!Array.isArray(a))return[2,C([a],d)];l=d?d.url:m.geometryServiceUrl;U=0;X=[];V=[];ca=0;for(Y=a;ca<Y.length;ca++)aa=Y[ca],g.isNone(aa)?V.push(aa):(k||(k=aa.spatialReference,x=n.getInfo(k),I=(y=k.isWebMercator)?102100:4326,z=F[I].maxX,E=F[I].minX,J=F[I].plus180Line,G=F[I].minus180Line),x?"mesh"===aa.type?V.push(aa):"point"===aa.type?V.push(B(aa.clone(),z,E)):"multipoint"===
aa.type?(da=aa.clone(),da.points=da.points.map(function(b){return B(b,z,E)}),V.push(da)):"extent"===aa.type?(W=aa.clone(),ea=W._normalize(!1,!1,x),V.push(ea.rings?new h(ea):ea)):aa.extent?(W=aa.extent,pa=u(W.xmin,E),qa=2*pa*z,oa=0===qa?aa.clone():v(aa.clone(),qa),W.offset(qa,0),W.intersects(J)&&W.xmax!==z?(U=W.xmax>U?W.xmax:U,oa=A(oa,y),X.push(oa),V.push("cut")):W.intersects(G)&&W.xmin!==E?(U=2*W.xmax*z>U?2*W.xmax*z:U,oa=A(oa,y,360),X.push(oa),V.push("cut")):V.push(oa)):V.push(aa.clone()):V.push(aa));
ra=u(U,z);va=-90;Ca=ra;for(Da=new b;0<ra;)wa=-180+360*ra,Da.addPath([[wa,va],[wa,-1*va]]),va*=-1,ra--;return 0<X.length&&0<Ca?[4,r.cut(l,X,Da,f)]:[3,3];case 1:Ba=e.sent();xa=D(X,Ba);na=[];za=[];for(ia=0;ia<V.length;ia++)la=V[ia],"cut"!==la?za.push(la):(ta=xa.shift(),ma=a[ia],g.isSome(ma)&&"polygon"===ma.type&&ma.rings&&1<ma.rings.length&&ta.rings.length>=ma.rings.length?(na.push(ta),za.push("simplify")):za.push(y?p.geographicToWebMercator(ta):ta));return na.length?[4,q.simplify(l,na,f)]:[2,za];case 2:sa=
e.sent();P=[];for(ia=0;ia<za.length;ia++)la=za[ia],"simplify"!==la?P.push(la):P.push(y?p.geographicToWebMercator(sa.shift()):sa.shift());return[2,P];case 3:Ja=[];for(ia=0;ia<V.length;ia++)la=V[ia],"cut"!==la?Ja.push(la):(ta=X.shift(),Ja.push(!0===y?p.geographicToWebMercator(ta):ta));return[2,c.resolve(Ja)]}})})}Object.defineProperty(a,"__esModule",{value:!0});var E=l.getLogger("esri.geometry.support.normalizeUtils"),F={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:new b({paths:[[[2.0037508342788905E7,
-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:d.WebMercator}),minus180Line:new b({paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:d.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new b({paths:[[[180,-180],[180,180]]],spatialReference:d.WGS84}),minus180Line:new b({paths:[[[-180,-180],[-180,180]]],spatialReference:d.WGS84})}};a.straightLineDensify=z;a.normalizeCentralMeridian=C;a.getDenormalizedExtent=
function(b){var a;if(!b)return null;var d=b.extent;if(!d)return null;var c=b.spatialReference&&n.getInfo(b.spatialReference);if(!c)return d;var c=c.valid,e=c[0],c=c[1],g=d.width,h=d.xmin;a=d.xmax;a=[a,h];h=a[0];a=a[1];if("extent"===b.type||0===g||g<=c||g>2*c||h<e||a>c)return d;var f;switch(b.type){case "polygon":if(1<b.rings.length)f=y(b.rings);else return d;break;case "polyline":if(1<b.paths.length)f=y(b.paths);else return d;break;case "multipoint":f=b.points}b=d.clone();for(e=0;e<f.length;e++){var l=
f[e][0];0>l?(l+=c,a=Math.max(l,a)):(l-=c,h=Math.min(l,h))}b.xmin=h;b.xmax=a;return b.width<g?(b.xmin-=c,b.xmax-=c,b):d};a.normalizeMapX=function(b,a){if(a=n.getInfo(a)){var d=a.valid;a=d[0];var d=d[1],c=d-a;if(b<a)for(;b<a;)b+=c;if(b>d)for(;b>d;)b-=c}return b}})},"esri/tasks/geometry/cut":function(){define("require exports tslib ../../geometry ../../request ../../core/urlUtils ../../geometry/support/jsonUtils".split(" "),function(f,a,e,m,k,l,g){Object.defineProperty(a,"__esModule",{value:!0});a.cut=
function(a,h,b,d){return e.__awaiter(this,void 0,void 0,function(){var c,f,r,q,x,u,v,y;return e.__generator(this,function(n){switch(n.label){case 0:return c="string"===typeof a?l.urlToObject(a):a,f=h[0].spatialReference,r=e.__assign(e.__assign({},d),{query:e.__assign(e.__assign({},c.query),{f:"json",sr:JSON.stringify(f),target:JSON.stringify({geometryType:g.getJsonType(h[0]),geometries:h}),cutter:JSON.stringify(b)})}),[4,k(c.path+"/cut",r)];case 1:return q=n.sent(),x=q.data,u=x.cutIndexes,v=x.geometries,
y=void 0===v?[]:v,[2,{cutIndexes:u,geometries:y.map(function(b){return m.fromJSON(b).set(f)})}]}})})}})},"esri/tasks/geometry/simplify":function(){define("require exports tslib ../../request ../../core/urlUtils ../../geometry/support/jsonUtils".split(" "),function(f,a,e,m,k,l){function g(a){return{geometryType:l.getJsonType(a[0]),geometries:a.map(function(b){return b.toJSON()})}}function c(a,b,d){var c=l.getGeometryType(b);return a.map(function(b){b=c.fromJSON(b);b.spatialReference=d;return b})}Object.defineProperty(a,
"__esModule",{value:!0});a.simplify=function(a,b,d){return e.__awaiter(this,void 0,void 0,function(){var h,f,r,q,x;return e.__generator(this,function(n){switch(n.label){case 0:return h="string"===typeof a?k.urlToObject(a):a,f=b[0].spatialReference,r=l.getJsonType(b[0]),q=e.__assign(e.__assign({},d),{query:e.__assign(e.__assign({},h.query),{f:"json",sr:f.wkid?f.wkid:JSON.stringify(f),geometries:JSON.stringify(g(b))})}),[4,m(h.path+"/simplify",q)];case 1:return x=n.sent(),[2,c(x.data,r,f)]}})})}})},
"esri/tasks/operations/pbfQueryUtils":function(){define(["require","exports","./pbfFeatureServiceParser"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.parsePBFFeatureQuery=function(a,f){if((a=e.parseFeatureQuery(a,f).queryResult.featureResult)&&a.features&&a.features.length&&a.objectIdFieldName){f=a.objectIdFieldName;for(var l=0,g=a.features;l<g.length;l++){var c=g[l];c.attributes&&(c.objectId=c.attributes[f])}}return a}})},"esri/tasks/operations/pbfFeatureServiceParser":function(){define("require exports ../../core/Error ../../core/Logger ../../core/pbf ./pbfDehydratedFeatureSet ./pbfOptimizedFeatureSet".split(" "),
function(f,a,e,m,k,l,g){function c(b,a,d){for(d=a.createPointGeometry(d);b.next();)switch(b.tag()){case 3:for(var c=b.getUInt32(),c=b.pos()+c,e=0;b.pos()<c;)a.addCoordinatePoint(d,b.getSInt64(),0,e++);break;default:b.skip()}return d}function h(b,a,d){var c=a.createGeometry(d);for(d=2+(d.hasZ?1:0)+(d.hasM?1:0);b.next();)switch(b.tag()){case 2:for(var e=b.getUInt32(),e=b.pos()+e,g=0;b.pos()<e;)a.addLength(c,b.getUInt32(),g++);break;case 3:for(var e=b.getUInt32(),e=b.pos()+e,h=g=0;b.pos()<e;)a.addCoordinate(c,
b.getSInt64(),h,g),g++,g===d&&(h++,g=0);break;default:b.skip()}return c}function b(b){for(;b.next();)switch(b.tag()){case 1:return b.getString();case 2:return b.getFloat();case 3:return b.getDouble();case 4:return b.getSInt32();case 5:return b.getUInt32();case 6:return b.getInt64();case 7:return b.getUInt64();case 8:return b.getSInt64();case 9:return b.getBool();default:return b.skip(),null}return null}function d(b){for(var a={type:0>=A.length?null:A[0]};b.next();)switch(b.tag()){case 1:a.name=b.getString();
break;case 2:var d=b.getEnum();a.type=d>=A.length?null:A[d];break;case 3:a.alias=b.getString();break;case 4:d=b.getEnum();d=d>=B.length?null:B[d];a.sqlType=d;break;default:b.skip()}return a}function n(a,d,e,g){for(var f=d.createFeature(e),n=0;a.next();)switch(a.tag()){case 1:var l=g[n++].name;f.attributes[l]=a.processMessage(b);break;case 2:f.geometry=a.processMessageWithArgs(h,d,e);break;case 4:f.centroid=a.processMessageWithArgs(c,d,e);break;default:a.skip()}return f}function p(b){for(var a=[1,
1,1,1];b.next();)switch(b.tag()){case 1:a[0]=b.getDouble();break;case 2:a[1]=b.getDouble();break;case 4:a[2]=b.getDouble();break;case 3:a[3]=b.getDouble();break;default:b.skip()}return a}function r(b){for(var a=[0,0,0,0];b.next();)switch(b.tag()){case 1:a[0]=b.getDouble();break;case 2:a[1]=b.getDouble();break;case 4:a[2]=b.getDouble();break;case 3:a[3]=b.getDouble();break;default:b.skip()}return a}function q(b){for(var a={originPosition:0>=D.length?null:D[0]};b.next();)switch(b.tag()){case 1:var d=
b.getEnum();a.originPosition=d>=D.length?null:D[d];break;case 2:a.scale=b.processMessage(p);break;case 3:a.translate=b.processMessage(r);break;default:b.skip()}return a}function x(b){for(var a={};b.next();)switch(b.tag()){case 1:a.shapeAreaFieldName=b.getString();break;case 2:a.shapeLengthFieldName=b.getString();break;case 3:a.units=b.getString();break;default:b.skip()}return a}function u(b,a){for(a=a.createSpatialReference();b.next();)switch(b.tag()){case 1:a.wkid=b.getUInt32();break;case 5:a.wkt=
b.getString();break;default:b.skip()}return a}function v(b,a){var c=a.createFeatureResult();c.geometryType=0>=a.geometryTypes.length?null:a.geometryTypes[0];for(var e=!1;b.next();)switch(b.tag()){case 1:c.objectIdFieldName=b.getString();break;case 3:c.globalIdFieldName=b.getString();break;case 4:c.geohashFieldName=b.getString();break;case 5:c.geometryProperties=b.processMessage(x);break;case 7:var g=b.getEnum();c.geometryType=g>=a.geometryTypes.length?null:a.geometryTypes[g];break;case 8:c.spatialReference=
b.processMessageWithArgs(u,a);break;case 10:c.hasZ=b.getBool();break;case 11:c.hasM=b.getBool();break;case 12:c.transform=b.processMessage(q);break;case 9:g=b.getBool();c.exceededTransferLimit=g;break;case 13:a.addField(c,b.processMessage(d));break;case 15:e||(a.prepareFeatures(c),e=!0);a.addFeature(c,b.processMessageWithArgs(n,a,c,c.fields));break;default:b.skip()}a.finishFeatureResult(c);return c}function y(b,a){for(var d={};b.next();)switch(b.tag()){case 1:d.featureResult=b.processMessageWithArgs(v,
a);break;default:b.skip()}return d}Object.defineProperty(a,"__esModule",{value:!0});var z=m.getLogger("esri.tasks.operations.pbfFeatureServiceParser"),A="esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeString esriFieldTypeDate esriFieldTypeOID esriFieldTypeGeometry esriFieldTypeBlob esriFieldTypeRaster esriFieldTypeGUID esriFieldTypeGlobalID esriFieldTypeXML".split(" "),B="sqlTypeBigInt sqlTypeBinary sqlTypeBit sqlTypeChar sqlTypeDate sqlTypeDecimal sqlTypeDouble sqlTypeFloat sqlTypeGeometry sqlTypeGUID sqlTypeInteger sqlTypeLongNVarchar sqlTypeLongVarbinary sqlTypeLongVarchar sqlTypeNChar sqlTypeNVarchar sqlTypeOther sqlTypeReal sqlTypeSmallInt sqlTypeSqlXml sqlTypeTime sqlTypeTimestamp sqlTypeTimestamp2 sqlTypeTinyInt sqlTypeVarbinary sqlTypeVarchar".split(" "),
D=["upperLeft","lowerLeft"];a.parseFeatureQuery=function(b,a){a=a&&"dehydrated"===a.type?new l.Context(a):new g.Context(a);try{var d=new k(new Uint8Array(b),new DataView(b));for(b={};d.next();)switch(d.tag()){case 2:b.queryResult=d.processMessageWithArgs(y,a);break;default:d.skip()}return b}catch(I){return d=new e("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:I}),z.error(d),{queryResult:{featureResult:a.createFeatureResult()}}}}})},"esri/tasks/operations/pbfDehydratedFeatureSet":function(){define("require exports ../../Graphic ../../core/compilerUtils ../../geometry/SpatialReference ../../layers/graphics/dehydratedFeatures ../../layers/support/Field ./zscale".split(" "),
function(f,a,e,m,k,l,g,c){function h(b,a){return a}function b(b,a,d,c){switch(d){case 0:return r(b,a+c,0);case 1:return("lowerLeft"===b.originPosition?r:q)(b,a+c,1)}}function d(b,a,d,c){switch(d){case 0:return r(b,a+c,0);case 1:return("lowerLeft"===b.originPosition?r:q)(b,a+c,1);case 2:return r(b,a,2)}}function n(b,a,d,c){switch(d){case 0:return r(b,a+c,0);case 1:return("lowerLeft"===b.originPosition?r:q)(b,a+c,1);case 2:return r(b,a,3)}}function p(b,a,d,c){switch(d){case 0:return r(b,a+c,0);case 1:return("lowerLeft"===
b.originPosition?r:q)(b,a+c,1);case 2:return r(b,a,2);case 3:return r(b,a,3)}}function r(b,a,d){return b.translate[d]+a*b.scale[d]}function q(b,a,d){return b.translate[d]-a*b.scale[d]}Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(b){this.options=b;this.geometryTypes=["point","multipoint","polyline","polygon"];this.previousCoordinate=[0,0];this.transform=null;this.applyTransform=h;this.lengths=[];this.vertexDimension=this.toAddInCurrentPath=this.currentLengthIndex=0;this.coordinateBuffer=
null;this.coordinateBufferPtr=0;this.AttributesConstructor=function(){}}a.prototype.createFeatureResult=function(){return new l.DehydratedFeatureSetClass};a.prototype.finishFeatureResult=function(b){this.options.applyTransform&&(b.transform=null);this.AttributesConstructor=function(){};this.coordinateBuffer=null;this.lengths.length=0;if(b.hasZ){var a=c.getGeometryZScaler(b.geometryType,this.options.sourceSpatialReference,b.spatialReference);if(a){var d=0;for(b=b.features;d<b.length;d++)a(b[d].geometry)}}};
a.prototype.createSpatialReference=function(){return new k};a.prototype.addField=function(b,a){b.fields.push(g.fromJSON(a));var d=b.fields.map(function(b){return b.name});this.AttributesConstructor=function(){for(var b=0;b<d.length;b++)this[d[b]]=null}};a.prototype.addFeature=function(b,a){var d=this.options.maxStringAttributeLength?this.options.maxStringAttributeLength:0;if(0<d)for(var c in a.attributes){var e=a.attributes[c];"string"===typeof e&&e.length>d&&(a.attributes[c]="")}b.features.push(a)};
a.prototype.prepareFeatures=function(b){var a=this;this.options.applyTransform&&b.transform&&(this.transform=b.transform,this.applyTransform=this.deriveApplyTransform(b));this.vertexDimension=2;b.hasZ&&this.vertexDimension++;b.hasM&&this.vertexDimension++;switch(b.geometryType){case "point":this.addCoordinate=function(b,d,c,e){return a.addCoordinatePoint(b,d,e)};this.createGeometry=function(b){return a.createPointGeometry(b)};break;case "polygon":this.addCoordinate=function(b,d,c,e){return a.addCoordinatePolygon(b,
d,e)};this.createGeometry=function(b){return a.createPolygonGeometry(b)};break;case "polyline":this.addCoordinate=function(b,d,c,e){return a.addCoordinatePolyline(b,d,e)};this.createGeometry=function(b){return a.createPolylineGeometry(b)};break;case "multipoint":this.addCoordinate=function(b,d,c,e){return a.addCoordinateMultipoint(b,d,e)};this.createGeometry=function(b){return a.createMultipointGeometry(b)};break;default:m.neverReached(b.geometryType)}};a.prototype.createFeature=function(){this.currentLengthIndex=
this.lengths.length=0;this.previousCoordinate[0]=0;this.previousCoordinate[1]=0;this.coordinateBuffer=null;this.coordinateBufferPtr=0;return new l.DehydratedFeatureClass(e.generateUID(),null,new this.AttributesConstructor)};a.prototype.addLength=function(b,a,d){0===this.lengths.length&&(this.toAddInCurrentPath=a);this.lengths.push(a)};a.prototype.createPointGeometry=function(b){b={type:"point",x:0,y:0,spatialReference:b.spatialReference,hasZ:!!b.hasZ,hasM:!!b.hasM};b.hasZ&&(b.z=0);b.hasM&&(b.m=0);
return b};a.prototype.addCoordinatePoint=function(b,a,d){a=this.applyTransform(this.transform,a,d,0);switch(d){case 0:b.x=a;break;case 1:b.y=a;break;case 2:b.hasZ?b.z=a:b.m=a;break;case 3:b.m=a}};a.prototype.transformPathLikeValue=function(b,a){var d=0;1>=a&&(d=this.previousCoordinate[a],this.previousCoordinate[a]+=b);return this.applyTransform(this.transform,b,a,d)};a.prototype.addCoordinatePolyline=function(b,a,d){this.dehydratedAddPointsCoordinate(b.paths,a,d)};a.prototype.addCoordinatePolygon=
function(b,a,d){this.dehydratedAddPointsCoordinate(b.rings,a,d)};a.prototype.addCoordinateMultipoint=function(b,a,d){0===d&&b.points.push([]);a=this.transformPathLikeValue(a,d);b.points[b.points.length-1].push(a)};a.prototype.createPolygonGeometry=function(b){return{type:"polygon",rings:[[]],spatialReference:b.spatialReference,hasZ:!!b.hasZ,hasM:!!b.hasM}};a.prototype.createPolylineGeometry=function(b){return{type:"polyline",paths:[[]],spatialReference:b.spatialReference,hasZ:!!b.hasZ,hasM:!!b.hasM}};
a.prototype.createMultipointGeometry=function(b){return{type:"multipoint",points:[],spatialReference:b.spatialReference,hasZ:!!b.hasZ,hasM:!!b.hasM}};a.prototype.dehydratedAddPointsCoordinate=function(b,a,d){if(null===this.coordinateBuffer){var c=this.lengths.reduce(function(b,a){return b+a},0);this.coordinateBuffer=new Float64Array(c*this.vertexDimension)}0===d&&0===this.toAddInCurrentPath--&&(b.push([]),this.toAddInCurrentPath=this.lengths[++this.currentLengthIndex]-1,this.previousCoordinate[0]=
0,this.previousCoordinate[1]=0);a=this.transformPathLikeValue(a,d);b=b[b.length-1];0===d&&b.push(new Float64Array(this.coordinateBuffer.buffer,this.coordinateBufferPtr*Float64Array.BYTES_PER_ELEMENT,this.vertexDimension));this.coordinateBuffer[this.coordinateBufferPtr++]=a};a.prototype.deriveApplyTransform=function(a){var c=a.hasZ;a=a.hasM;return c&&a?p:c?d:a?n:b};return a}();a.Context=f})},"esri/layers/graphics/dehydratedFeatures":function(){define("require exports ../../geometry ../../Graphic ../../core/compilerUtils ../../core/has ../../core/lang ../../core/maybe ../../core/typedArrayUtil ../../geometry/SpatialReference ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/jsonUtils ../../geometry/support/quantizationUtils ../support/Field ./dehydratedFeatureComparison".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x){function u(b,a,d){if(!b)return null;switch(a){case "point":return b={x:b.x,y:b.y,z:b.z,m:b.m,hasZ:null!=b.z,hasM:null!=b.m,type:"point",spatialReference:d};case "polyline":return b={paths:b.paths,hasZ:!!b.hasZ,hasM:!!b.hasM,type:"polyline",spatialReference:d};case "polygon":return b={rings:b.rings,hasZ:!!b.hasZ,hasM:!!b.hasM,type:"polygon",spatialReference:d};case "multipoint":return b={points:b.points,hasZ:!!b.hasZ,hasM:!!b.hasM,type:"multipoint",spatialReference:d}}}
function v(b,a,d,c){return{x:b,y:a,z:d,hasZ:null!=d,hasM:!1,spatialReference:c,type:"point"}}function y(b){return"declaredClass"in b}function z(b){return"declaredClass"in b}function A(b){return"declaredClass"in b}function B(b){return c.isNone(b)?null:y(b)?b:p.fromJSON(E(b))}function D(b){if(!b)return 0;var a=32,d;for(d in b)if(b.hasOwnProperty(d)){var c=b[d];switch(typeof c){case "string":a+=O(c);break;default:case "number":a+=16}}return a}function C(b){if(c.isNone(b))return 0;var a=32;switch(b.type){case "point":a+=
42;break;case "polyline":case "polygon":var d=0,e=2+(b.hasZ?1:0)+(b.hasM?1:0);b="polyline"===b.type?b.paths:b.rings;for(var g=0;g<b.length;g++)d+=b[g].length;a=a+(8*d*e+64)+128*d+34;a+=32*(b.length+1);break;case "multipoint":d=b.points.length;a+=8*d*(2+(b.hasZ?1:0)+(b.hasM?1:0))+64;a+=128*d;a+=34;a+=32;break;case "extent":a+=98;b.hasM&&(a+=32);b.hasZ&&(a+=32);break;case "mesh":a+=h.estimateSize(b.vertexAttributes.position);a+=h.estimateSize(b.vertexAttributes.normal);a+=h.estimateSize(b.vertexAttributes.uv);
a+=h.estimateSize(b.vertexAttributes.tangent);break;default:k.neverReached(b)}return a}function E(b){var a=b.spatialReference.toJSON();switch(b.type){case "point":return{x:b.x,y:b.y,z:b.z,m:b.m,spatialReference:a};case "polygon":var d=b.hasZ,c=b.hasM;return{rings:F(b.rings),hasZ:d,hasM:c,spatialReference:a};case "polyline":var e=b.paths,d=b.hasZ,c=b.hasM;return{paths:F(e),hasZ:d,hasM:c,spatialReference:a};case "extent":var e=b.xmin,g=b.xmax,h=b.ymin,f=b.ymax,n=b.zmin,l=b.zmax,q=b.mmin,p=b.mmax,d=
b.hasZ,c=b.hasM;return{xmin:e,xmax:g,ymin:h,ymax:f,zmin:n,zmax:l,mmin:q,mmax:p,hasZ:d,hasM:c,spatialReference:a};case "multipoint":return e=b.points,d=b.hasZ,c=b.hasM,{points:G(e)?I(e):e,hasZ:d,hasM:c,spatialReference:a};default:k.neverReached(b)}}function F(b){return J(b)?b.map(function(b){return I(b)}):b}function I(b){return b.map(function(b){return h.toArray(b)})}function J(b){for(var a=0;a<b.length;a++){var d=b[a];if(0!==d.length)return G(d)}return!1}function G(b){return b.length&&(h.isFloat32Array(b[0])||
h.isFloat64Array(b[0]))}function H(b,a){d.empty(a);"mesh"===b.type&&(b=b.extent);switch(b.type){case "point":a[0]=a[3]=b.x;a[1]=a[4]=b.y;b.hasZ&&(a[2]=a[5]=b.z);break;case "polyline":for(var c=0;c<b.paths.length;c++)d.expandWithNestedArray(a,b.paths[c],b.hasZ);break;case "polygon":for(c=0;c<b.rings.length;c++)d.expandWithNestedArray(a,b.rings[c],b.hasZ);break;case "multipoint":d.expandWithNestedArray(a,b.points,b.hasZ);break;case "extent":a[0]=b.xmin;a[1]=b.ymin;a[3]=b.xmax;a[4]=b.ymax;null!=b.zmin&&
(a[2]=b.zmin);null!=b.zmax&&(a[5]=b.zmax);break;default:k.neverReached(b)}}function K(b,a){n.empty(a);"mesh"===b.type&&(b=b.extent);switch(b.type){case "point":a[0]=a[2]=b.x;a[1]=a[3]=b.y;break;case "polyline":for(var d=0;d<b.paths.length;d++)n.expandWithNestedArray(a,b.paths[d]);break;case "polygon":for(d=0;d<b.rings.length;d++)n.expandWithNestedArray(a,b.rings[d]);break;case "multipoint":n.expandWithNestedArray(a,b.points);break;case "extent":a[0]=b.xmin;a[1]=b.ymin;a[2]=b.xmax;a[3]=b.ymax;break;
default:k.neverReached(b)}}Object.defineProperty(a,"__esModule",{value:!0});a.equals=x.equals;f=function(){return function(b,a,d){this.uid=b;this.geometry=a;this.attributes=d;this.visible=!0;this.centroid=this.objectId=null}}();a.DehydratedFeatureClass=f;a.hasGeometry=function(b){return c.isSome(b.geometry)};a.isFeatureGeometry=function(b){return e.isFeatureGeometryType(b.type)};f=function(){return function(){this.exceededTransferLimit=!1;this.features=[];this.fields=[];this.hasZ=this.hasM=!1;this.transform=
this.spatialReference=this.geohashFieldName=this.geometryProperties=this.globalIdFieldName=this.objectIdFieldName=this.geometryType=null}}();a.DehydratedFeatureSetClass=f;a.isPoint=function(b){return"point"===b.type};a.fromFeatureSetJSON=function(a){var d=e.featureGeometryTypeKebabDictionary.fromJSON(a.geometryType),c=b.fromJSON(a.spatialReference),g=a.transform,h=a.features.map(function(b){var e=a.objectIdFieldName;b={uid:m.generateUID(),objectId:e&&b.attributes?b.attributes[e]:null,attributes:b.attributes,
geometry:u(b.geometry,d,c),visible:!0};if((e=b.geometry)&&g)switch(e.type){case "point":b.geometry=r.hydratePoint(g,e,e,e.hasZ,e.hasM);break;case "multipoint":b.geometry=r.hydrateMultipoint(g,e,e,e.hasZ,e.hasM);break;case "polygon":b.geometry=r.hydratePolygon(g,e,e,e.hasZ,e.hasM);break;case "polyline":b.geometry=r.hydratePolyline(g,e,e,e.hasZ,e.hasM);break;default:k.neverReached(e)}return b});return{geometryType:d,features:h,spatialReference:c,fields:a.fields?a.fields.map(function(b){return q.fromJSON(b)}):
null,objectIdFieldName:a.objectIdFieldName,globalIdFieldName:a.globalIdFieldName,geohashFieldName:a.geohashFieldName,geometryProperties:a.geometryProperties,hasZ:a.hasZ,hasM:a.hasM,exceededTransferLimit:a.exceededTransferLimit,transform:null}};a.fromJSONGeometry=u;a.makeDehydratedPoint=v;a.isHydratedGeometry=y;a.isHydratedPoint=z;a.isHydratedGraphic=A;a.hydrateGraphic=function(b,a){if(!b)return null;if(A(b))return b;a=new m({layer:a,sourceLayer:a});a.visible=b.visible;a.symbol=g.clone(b.symbol);a.attributes=
g.clone(b.attributes);a.geometry=B(b.geometry);return a};a.hydrateGeometry=B;a.clonePoint=function(b,a){if(!b)return null;if(z(b)){if(null==a)return b.clone();if(z(a))return a.copy(b)}null!=a?(a.x=b.x,a.y=b.y,a.spatialReference=b.spatialReference,b.hasZ?(a.z=b.z,a.hasZ=b.hasZ):(a.z=null,a.hasZ=!1),b.hasM?(a.m=b.m,a.hasM=!0):(a.m=null,a.hasM=!1)):(a=v(b.x,b.y,b.z,b.spatialReference),b.hasM&&(a.m=b.m,a.hasM=!0));return a};var O=l("esri-text-decoder")?function(b){return 32+b.length}:function(b){return 32*
b.length};a.estimateAttributesObjectSize=D;a.estimateGeometryObjectSize=C;a.estimateSize=function(b){var a;a=32+D(b.attributes);return a=a+3+(8+C(b.geometry))};a.numVertices=function(b){if(c.isNone(b))return 0;switch(b.type){case "point":return 1;case "polyline":var a=0,d=0;for(b=b.paths;d<b.length;d++)a+=b[d].length;return a;case "polygon":d=a=0;for(b=b.rings;d<b.length;d++)a+=b[d].length;return a;case "multipoint":return b.points.length;case "extent":return 2;case "mesh":return(a=b.vertexAttributes&&
b.vertexAttributes.position)?a.length/3:0;default:k.neverReached(b)}};a.hasVertices=function(b){if(!b)return!1;switch(b.type){case "extent":case "point":return!0;case "polyline":var a=0;for(b=b.paths;a<b.length;a++)if(0<b[a].length)return!0;return!1;case "polygon":a=0;for(b=b.rings;a<b.length;a++)if(0<b[a].length)return!0;return!1;case "multipoint":return 0<b.points.length;case "mesh":return b.vertexAttributes&&b.vertexAttributes.position&&0<b.vertexAttributes.position.length;default:k.neverReached(b)}};
a.computeAABB=H;a.expandAABB=function(b,a){H(b,L);d.expand(a,L)};a.computeAABR=K;a.expandAABR=function(b,a){K(b,N);n.expand(a,N)};a.getObjectId=function(b,a){return null!=b.objectId?b.objectId:b.attributes&&a?b.attributes[a]:null};var L=d.create(),N=n.create()})},"esri/geometry/support/aaBoundingBox":function(){define(["require","exports","../../core/maybe","../Extent","./aaBoundingRect"],function(f,a,e,m,k){function l(b){void 0===b&&(b=a.ZERO);return[b[0],b[1],b[2],b[3],b[4],b[5]]}function g(b,a,
d,c,e,g,h){void 0===h&&(h=l());h[0]=b;h[1]=a;h[2]=d;h[3]=c;h[4]=e;h[5]=g;return h}function c(b){return b[0]>=b[3]?0:b[3]-b[0]}function h(b){return b[1]>=b[4]?0:b[4]-b[1]}function b(b){return b[2]>=b[5]?0:b[5]-b[2]}function d(b,a){return Math.max(a[0],b[0])<=Math.min(a[3],b[3])&&Math.max(a[1],b[1])<=Math.min(a[4],b[4])&&Math.max(a[2],b[2])<=Math.min(a[5],b[5])}function n(b,a){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];return b}function p(b){return 6===b.length}Object.defineProperty(a,
"__esModule",{value:!0});a.create=l;a.fromValues=g;a.fromExtent=function(b,a){void 0===a&&(a=l());a[0]=b.xmin;a[1]=b.ymin;a[2]=b.zmin;a[3]=b.xmax;a[4]=b.ymax;a[5]=b.zmax;return a};a.toExtent=function(b,a){return isFinite(b[2])||isFinite(b[5])?new m({xmin:b[0],xmax:b[3],ymin:b[1],ymax:b[4],zmin:b[2],zmax:b[5],spatialReference:a}):new m({xmin:b[0],xmax:b[3],ymin:b[1],ymax:b[4],spatialReference:a})};a.fromMinMax=function(b,a,d){void 0===d&&(d=l());d[0]=b[0];d[1]=b[1];d[2]=b[2];d[3]=a[0];d[4]=a[1];d[5]=
a[2];return d};a.expandPointInPlace=function(b,a){a[0]<b[0]&&(b[0]=a[0]);a[0]>b[3]&&(b[3]=a[0]);a[1]<b[1]&&(b[1]=a[1]);a[1]>b[4]&&(b[4]=a[1]);a[2]<b[2]&&(b[2]=a[2]);a[2]>b[5]&&(b[5]=a[2])};a.expand=function(b,a,d){void 0===d&&(d=b);p(a)?(d[0]=Math.min(b[0],a[0]),d[1]=Math.min(b[1],a[1]),d[2]=Math.min(b[2],a[2]),d[3]=Math.max(b[3],a[3]),d[4]=Math.max(b[4],a[4]),d[5]=Math.max(b[5],a[5])):k.is(a)?(d[0]=Math.min(b[0],a[0]),d[1]=Math.min(b[1],a[1]),d[3]=Math.max(b[3],a[2]),d[4]=Math.max(b[4],a[3])):2===
a.length?(d[0]=Math.min(b[0],a[0]),d[1]=Math.min(b[1],a[1]),d[3]=Math.max(b[3],a[0]),d[4]=Math.max(b[4],a[1])):3===a.length&&(d[0]=Math.min(b[0],a[0]),d[1]=Math.min(b[1],a[1]),d[2]=Math.min(b[2],a[2]),d[3]=Math.max(b[3],a[0]),d[4]=Math.max(b[4],a[1]),d[5]=Math.max(b[5],a[2]));return d};a.expandWithBuffer=function(b,a,d,c,e){void 0===d&&(d=0);void 0===c&&(c=a.length/3);void 0===e&&(e=b);var g=b[0],h=b[1],f=b[2],n=b[3],l=b[4];b=b[5];for(var k=0;k<c;k++)g=Math.min(g,a[d+3*k]),h=Math.min(h,a[d+3*k+1]),
f=Math.min(f,a[d+3*k+2]),n=Math.max(n,a[d+3*k]),l=Math.max(l,a[d+3*k+1]),b=Math.max(b,a[d+3*k+2]);e[0]=g;e[1]=h;e[2]=f;e[3]=n;e[4]=l;e[5]=b;return e};a.expandWithOffset=function(b,a,d,c,e){void 0===e&&(e=b);e[0]=Math.min(b[0],b[0]+a);e[3]=Math.max(b[3],b[3]+a);e[1]=Math.min(b[1],b[1]+d);e[4]=Math.max(b[4],b[4]+d);e[2]=Math.min(b[2],b[2]+c);e[5]=Math.max(b[5],b[5]+c);return e};a.expandWithNestedArray=function(b,a,d,c){void 0===c&&(c=b);var e=a.length,g=b[0],h=b[1],f=b[2],n=b[3],l=b[4];b=b[5];if(d)for(d=
0;d<e;d++){var k=a[d],g=Math.min(g,k[0]),h=Math.min(h,k[1]),f=Math.min(f,k[2]),n=Math.max(n,k[0]),l=Math.max(l,k[1]);b=Math.max(b,k[2])}else for(d=0;d<e;d++)k=a[d],g=Math.min(g,k[0]),h=Math.min(h,k[1]),n=Math.max(n,k[0]),l=Math.max(l,k[1]);c[0]=g;c[1]=h;c[2]=f;c[3]=n;c[4]=l;c[5]=b;return c};a.allFinite=function(b){for(var a=0;6>a;a++)if(!isFinite(b[a]))return!1;return!0};a.width=c;a.depth=h;a.height=b;a.diameter=function(a){var d=c(a),e=b(a);a=h(a);return Math.sqrt(d*d+e*e+a*a)};a.center=function(a,
d){void 0===d&&(d=[0,0,0]);d[0]=a[0]+c(a)/2;d[1]=a[1]+h(a)/2;d[2]=a[2]+b(a)/2;return d};a.size=function(a,d){void 0===d&&(d=[0,0,0]);d[0]=c(a);d[1]=h(a);d[2]=b(a);return d};a.maximumDimension=function(a){return Math.max(c(a),b(a),h(a))};a.containsPoint=function(b,a){return a[0]>=b[0]&&a[1]>=b[1]&&a[2]>=b[2]&&a[0]<=b[3]&&a[1]<=b[4]&&a[2]<=b[5]};a.containsPointWithMargin=function(b,a,d){return a[0]>=b[0]-d&&a[1]>=b[1]-d&&a[2]>=b[2]-d&&a[0]<=b[3]+d&&a[1]<=b[4]+d&&a[2]<=b[5]+d};a.contains=function(b,
a){return a[0]>=b[0]&&a[1]>=b[1]&&a[2]>=b[2]&&a[3]<=b[3]&&a[4]<=b[4]&&a[5]<=b[5]};a.intersects=d;a.intersectsClippingArea=function(b,a){return e.isNone(a)?!0:d(b,a)};a.offset=function(b,a,d,c,e){void 0===e&&(e=b);e[0]=b[0]+a;e[1]=b[1]+d;e[2]=b[2]+c;e[3]=b[3]+a;e[4]=b[4]+d;e[5]=b[5]+c;return e};a.getMin=function(b,a){a[0]=b[0];a[1]=b[1];a[2]=b[2];return a};a.getMax=function(b,a){a[0]=b[3];a[1]=b[4];a[2]=b[5];return a};a.setMin=function(b,a,d){void 0===d&&(d=b);d[0]=a[0];d[1]=a[1];d[2]=a[2];d!==b&&
(d[3]=b[3],d[4]=b[4],d[5]=b[5]);return d};a.setMax=function(b,a,d){void 0===d&&(d=b);d[3]=a[0];d[4]=a[1];d[5]=a[2];d!==b&&(d[0]=b[0],d[1]=b[1],d[2]=b[2]);return b};a.set=n;a.empty=function(b){return b?n(b,a.NEGATIVE_INFINITY):l(a.NEGATIVE_INFINITY)};a.toRect=function(b,a){a||(a=k.create());a[0]=b[0];a[1]=b[1];a[2]=b[3];a[3]=b[4];return a};a.fromRect=function(b,a){b[0]=a[0];b[1]=a[1];b[2]=Number.NEGATIVE_INFINITY;b[3]=a[2];b[4]=a[3];b[5]=Number.POSITIVE_INFINITY;return b};a.is=p;a.isPoint=function(a){return 0===
c(a)&&0===h(a)&&0===b(a)};a.equals=function(b,a,d){if(e.isNone(b)||e.isNone(a))return b===a;if(!p(b)||!p(a))return!1;if(d)for(var c=0;c<b.length;c++){if(!d(b[c],a[c]))return!1}else for(c=0;c<b.length;c++)if(b[c]!==a[c])return!1;return!0};a.wrap=function(b,a,d,c,e,h){return g(b,a,d,c,e,h,r)};a.POSITIVE_INFINITY=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];a.NEGATIVE_INFINITY=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity];a.ZERO=[0,0,0,0,0,0];var r=l()})},"esri/layers/graphics/dehydratedFeatureComparison":function(){define(["require",
"exports","../../core/compilerUtils","../../core/maybe"],function(f,a,e,m){function k(b,a){if(b===a)return!0;if(null==b||null==a||b.length!==a.length)return!1;for(var d=0;d<b.length;d++){var c=b[d],e=a[d];if(c.length!==e.length)return!1;for(var g=0;g<c.length;g++)if(c[g]!==e[g])return!1}return!0}function l(b,a){if(b===a)return!0;if(null==b||null==a||b.length!==a.length)return!1;for(var d=0;d<b.length;d++)if(!k(b[d],a[d]))return!1;return!0}function g(b,a){return b===a||b&&a&&b.equals(a)}function c(b,
a){if(b===a)return!0;if(m.isNone(b)||m.isNone(a)||b.type!==a.type)return!1;switch(b.type){case "point":return b=g(b.spatialReference,a.spatialReference)?b.x===a.x&&b.y===a.y&&b.z===a.z&&b.m===a.m:!1,b;case "extent":return b=b.hasZ!==a.hasZ||b.hasM!==a.hasM?!1:g(b.spatialReference,a.spatialReference)?b.xmin===a.xmin&&b.ymin===a.ymin&&b.zmin===a.zmin&&b.xmax===a.xmax&&b.ymax===a.ymax&&b.zmax===a.zmax:!1,b;case "polyline":return b=b.hasZ!==a.hasZ||b.hasM!==a.hasM?!1:g(b.spatialReference,a.spatialReference)?
l(b.paths,a.paths):!1,b;case "polygon":return b=b.hasZ!==a.hasZ||b.hasM!==a.hasM?!1:g(b.spatialReference,a.spatialReference)?l(b.rings,a.rings):!1,b;case "multipoint":return b=b.hasZ!==a.hasZ||b.hasM!==a.hasM?!1:g(b.spatialReference,a.spatialReference)?k(b.points,a.points):!1,b;case "mesh":return!1;default:e.neverReached(b)}}function h(b,a){if(b===a)return!0;if(!b||!a)return!1;var d=Object.keys(b),c=Object.keys(a);if(d.length!==c.length)return!1;for(c=0;c<d.length;c++){var e=d[c];if(b[e]!==a[e])return!1}return!0}
Object.defineProperty(a,"__esModule",{value:!0});a.equals=function(b,a){return b===a?!0:null!=b&&null!=a&&b.objectId===a.objectId&&c(b.geometry,a.geometry)&&h(b.attributes,a.attributes)?!0:!1}})},"esri/tasks/operations/zscale":function(){define(["require","exports","../../core/unitUtils","../../geometry/support/spatialReferenceUtils"],function(f,a,e,m){function k(a,g,b){if(!g||!b||b.vcsWkid||m.equals(g,b))return null;g=e.getMetersPerVerticalUnitForSR(g);b=e.getMetersPerVerticalUnitForSR(b);var d=
g/b;if(1===d)return null;switch(a){case "point":case "esriGeometryPoint":return function(b){b&&null!=b.z&&(b.z*=d)};case "polyline":case "esriGeometryPolyline":return function(b){if(b){var a=0;for(b=b.paths;a<b.length;a++)for(var c=0,e=b[a];c<e.length;c++){var g=e[c];2<g.length&&(g[2]*=d)}}};case "polygon":case "esriGeometryPolygon":return function(b){if(b){var a=0;for(b=b.rings;a<b.length;a++)for(var c=0,e=b[a];c<e.length;c++){var g=e[c];2<g.length&&(g[2]*=d)}}};case "multipoint":case "esriGeometryMultipoint":return function(b){if(b){var a=
0;for(b=b.points;a<b.length;a++){var c=b[a];2<c.length&&(c[2]*=d)}}};default:return null}}function l(a,e,b){if(null==a.hasM||a.hasZ)for(a=0;a<e.length;a++)for(var d=0,c=e[a];d<c.length;d++){var g=c[d];2<g.length&&(g[2]*=b)}}function g(a,g,b){if(a)for(var d=0;d<a.length;d++){var c=a[d].geometry,h=b;if(c&&c.spatialReference&&!m.equals(c.spatialReference,g)&&(h=e.getMetersPerVerticalUnitForSR(c.spatialReference)/h,1!==h))if("x"in c)null!=c.z&&(c.z*=h);else if("rings"in c)l(c,c.rings,h);else if("paths"in
c)l(c,c.paths,h);else if("points"in c&&(null==c.hasM||c.hasZ))for(var f=0,c=c.points;f<c.length;f++){var k=c[f];2<k.length&&(k[2]*=h)}}}Object.defineProperty(a,"__esModule",{value:!0});a.getGeometryZScaler=k;a.applyFeatureSetZUnitScaling=function(a,e,b){if(b&&b.features&&b.hasZ&&(a=k(b.geometryType,e,a.outSpatialReference)))for(e=0,b=b.features;e<b.length;e++)a(b[e].geometry)};a.unapplyEditsZUnitScaling=function(a,h,b){if((a||h)&&b){var d=e.getMetersPerVerticalUnitForSR(b);g(a,b,d);g(h,b,d)}}})},
"esri/tasks/operations/pbfOptimizedFeatureSet":function(){define("require exports ../../core/unitUtils ../../geometry/support/spatialReferenceUtils ../../layers/graphics/OptimizedFeature ../../layers/graphics/OptimizedFeatureSet ../../layers/graphics/OptimizedGeometry".split(" "),function(f,a,e,m,k,l,g){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(a){this.options=a;this.geometryTypes=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"]}
a.prototype.createFeatureResult=function(){return new l.default};a.prototype.prepareFeatures=function(){};a.prototype.finishFeatureResult=function(a){if(a&&a.features&&a.hasZ&&this.options.sourceSpatialReference&&a.spatialReference&&!m.equals(a.spatialReference,this.options.sourceSpatialReference)&&!a.spatialReference.vcsWkid){var b=e.getMetersPerVerticalUnitForSR(this.options.sourceSpatialReference),d=e.getMetersPerVerticalUnitForSR(a.spatialReference),b=b/d;if(1!==b)for(d=0,a=a.features;d<a.length;d++){var c=
a[d];if(c.geometry&&c.geometry.coords)for(var c=c.geometry.coords,g=2;g<c.length;g+=3)c[g]*=b}}};a.prototype.addFeature=function(a,b){a.features.push(b)};a.prototype.createFeature=function(){return new k.default};a.prototype.createSpatialReference=function(){return{wkid:0}};a.prototype.createGeometry=function(){return new g.default};a.prototype.addField=function(a,b){a.fields.push(b)};a.prototype.addCoordinate=function(a,b){a.coords.push(b)};a.prototype.addCoordinatePoint=function(a,b){a.coords.push(b)};
a.prototype.addLength=function(a,b){a.lengths.push(b)};a.prototype.createPointGeometry=function(){return new g.default};return a}();a.Context=f})},"esri/tasks/operations/urlUtils":function(){define(["require","exports"],function(f,a){function e(a){var f={},l;for(l in a)if("declaredClass"!==l){var g=a[l];if(null!=g&&"function"!==typeof g)if(Array.isArray(g)){f[l]=[];for(var c=0;c<g.length;c++)f[l][c]=e(g[c])}else"object"===typeof g?g.toJSON&&(f[l]=JSON.stringify(g)):f[l]=g}return f}Object.defineProperty(a,
"__esModule",{value:!0});a.mapParameters=e})},"esri/views/2d/engine":function(){define("require exports ./engine/Bitmap ./engine/BitmapContainer ./engine/BitmapTile ./engine/Container ./engine/webgl/TileContainer ./engine/DisplayObject ./engine/RasterTile ./engine/RasterTileContainer ./engine/Stage ./engine/webgl/AttributeStoreView ./engine/webgl/collisions/CollisionGrid ./engine/webgl/collisions/CollisionEngine ./engine/webgl/collisions/LayerViewSorter ./engine/webgl/Geometry ./engine/webgl/alignmentUtils ./engine/webgl/color ./engine/webgl/definitions ./engine/webgl/enums ./engine/webgl/fontUtils ./engine/webgl/Utils ./engine/webgl/brushes/BrushBitmap ./engine/webgl/brushes/BrushClip ./engine/webgl/brushes/WGLBrushInfo ./engine/webgl/brushes/WGLBrushStencil ./engine/webgl/brushes/WGLBrushVTLBackground ./engine/webgl/brushes/WGLBrushVTLCircle ./engine/webgl/brushes/WGLBrushVTLFill ./engine/webgl/brushes/WGLBrushVTLLine ./engine/webgl/brushes/WGLBrushVTLSymbol ./engine/webgl/brushes/WGLGeometryBrush ./engine/webgl/brushes/WGLGeometryBrushFill ./engine/webgl/brushes/WGLGeometryBrushLabel ./engine/webgl/brushes/WGLGeometryBrushLine ./engine/webgl/brushes/WGLGeometryBrushMarker ./engine/webgl/brushes/WGLGeometryBrushText ./engine/webgl/brushes/raster/BrushRasterBitmap ./engine/webgl/util/debug ./engine/webgl/mesh/templates/shapingUtils ./engine/webgl/TileClipper ./engine/webgl/TurboLine ./engine/webgl/mesh/factories/matcherUtils ./engine/webgl/mesh/factories/WGLMeshFactory ./engine/webgl/mesh/MeshData ./engine/webgl/mesh/templates/WGLTemplateStore ./engine/webgl/Painter ./engine/webgl/TileData ./engine/webgl/util/BidiText ./engine/webgl/util/Matcher ./engine/webgl/util/vvFlagUtils ./engine/webgl/visualVariablesUtils ./engine/webgl/WGLRendererInfo ./engine/webgl/WGLTile ./engine/webgl/BitBlitRenderer ./engine/webgl/shaders/MagnifierPrograms ../../symbols/cim/CIMSymbolHelper ./engine/webgl/Rect ./engine/webgl/mesh/templates/util ./engine/webgl/painter/RenderPass ./engine/webgl/TiledDisplayObject ./engine/BitmapTileContainer ./engine/LevelDependentSizeVariable".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u,v,y,z,A,B,D,C,E,F,I,J,G,H,K,O,L,N,T,R,Q,S,U,X,V,ca,Y,aa,da,W,ea,pa,qa,oa,ra,va,Ca,Da,wa,Ba,xa,na,za,ia,la,ta,ma){Object.defineProperty(a,"__esModule",{value:!0});a.Bitmap=e.Bitmap;a.BitmapContainer=m.BitmapContainer;a.BitmapTile=k.BitmapTile;a.Container=l.Container;a.TileContainer=g.default;a.DisplayObject=c.DisplayObject;a.RasterTile=h.RasterTile;a.RasterTileContainer=b.RasterTileContainer;a.Stage=d.Stage;a.AttributeStoreView=n.AttributeStoreView;a.CollisionGrid=
p.CollisionGrid;a.CollisionEngine=r.CollisionEngine;a.LayerViewSorter=q.LayerViewSorter;a.Point=x.Point;a.alignmentUtils=u;a.color=v;a.definitions=y;a.enums=z;a.fontUtils=A;a.Utils=B;a.debug=U;a.ShapedGlyph=X.ShapedGlyph;a.shapeGlyphs=X.shapeGlyphs;a.ShapingInfo=X.ShapingInfo;a.TileClipper=V.TileClipper;a.SimpleBuilder=V.SimpleBuilder;a.tessellate=ca.tessellate;a.TessellationState=ca.TessellationState;a.splitVertex=ca.splitVertex;a.createMatcher=Y.createMatcher;a.WGLMeshFactory=aa.WGLMeshFactory;
a.MeshData=da.MeshData;a.WGLTemplateStore=W.WGLTemplateStore;a.Painter=ea.default;a.PainterOptions=ea.PainterOptions;a.TileData=pa.TileData;a.bidiText=qa.bidiText;a.FeatureMatcher=oa.FeatureMatcher;a.getVVFlags=ra.getVVFlags;a.getTypeOfSizeVisualVariable=va.getTypeOfSizeVisualVariable;a.WGLRendererInfo=Ca.WGLRendererInfo;a.WGLTile=Da.WGLTile;a.BitBlitRenderer=wa.BitBlitRenderer;a.createMagnifierProgram=Ba.createMagnifierProgram;a.magnifier=Ba.magnifier;a.CIMSymbolHelper=xa.CIMSymbolHelper;a.Rect=
na.default;a.getLimitCosine=za.getLimitCosine;f=a.brushes||(a.brushes={});f.Geometry=O.default;f.Marker=R.default;f.Line=T.default;f.Fill=L.default;f.Text=Q.default;f.Label=N.default;f.Clip=C.default;f.Stencil=F.default;f.Bitmap=D.default;f.Raster=S.default;f.TileInfo=E.default;f.VTLBackground=I.WGLBrushVTLBackground;f.VTLFill=G.WGLBrushVTLFill;f.VTLLine=H.WGLBrushVTLLine;f.VTLCircle=J.WGLBrushVTLCircle;f.VTLSymbol=K.WGLBrushVTLSymbol;a.RenderPass=ia.default;a.TiledDisplayObject=la.TiledDisplayObject;
a.BitmapTileContainer=ta.BitmapTileContainer;a.LevelDependentSizeVariable=ma.LevelDependentSizeVariable})},"esri/views/2d/engine/Bitmap":function(){define("require exports tslib ../../../core/libs/gl-matrix-2/mat3 ../../../core/libs/gl-matrix-2/mat3f32 ../../../core/libs/gl-matrix-2/vec2f32 ../../webgl ./DisplayObject ./ImageryBitmapSource".split(" "),function(f,a,e,m,k,l,g,c,h){function b(b){var a=document.createElement("canvas");a.width=b.width;a.height=b.height;b.render(a.getContext("2d"));return a}
function d(b,a,d){var c={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};a&&d&&(c.width=a,c.height=d);return new g.Texture(b,c)}Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function c(b,d){void 0===b&&(b=null);void 0===d&&(d=!0);var c=a.call(this)||this;c.requestRenderOnSourceChangedEnabled=d;c.stencilRef=0;c.coordScale=[1,1];c._height=void 0;c.pixelRatio=1;c.resolution=0;c.rotation=0;c._source=null;c._width=void 0;c.x=0;c.y=0;c.transforms={dvs:k.mat3f32.create()};
c.source=b;c.requestRender=c.requestRender.bind(c);return c}e.__extends(c,a);Object.defineProperty(c.prototype,"isSourceScaled",{get:function(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"height",{get:function(){return void 0!==this._height?this._height:this.sourceHeight},set:function(b){this._height=b},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"source",{get:function(){return this._source},
set:function(b){this._source=b;this.invalidateTexture()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"sourceHeight",{get:function(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"sourceWidth",{get:function(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"width",{get:function(){return void 0!==this._width?this._width:this.sourceWidth},set:function(b){this._width=b},enumerable:!0,configurable:!0});c.prototype.invalidateTexture=function(){this._updateTexture()};c.prototype.setTransform=function(b){var a=m.mat3.identity(this.transforms.dvs),d=b.toScreenNoRotation([0,0],this.x,this.y),c=this.resolution/this.pixelRatio/b.resolution,e=c*this.width,c=c*this.height,g=Math.PI*this.rotation/180;m.mat3.translate(a,a,l.vec2f32.fromValues(d[0],d[1]));m.mat3.translate(a,
a,l.vec2f32.fromValues(e/2,c/2));m.mat3.rotate(a,a,-g);m.mat3.translate(a,a,l.vec2f32.fromValues(-e/2,-c/2));m.mat3.scaleByVec2(a,a,l.vec2f32.fromValues(e,c));m.mat3.multiply(this.transforms.dvs,b.displayViewMat3,a)};c.prototype.setSamplingProfile=function(b){this._texture&&(b.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(b.samplingMode))};c.prototype.bind=function(b){this._texture&&this.stage.context.bindTexture(this._texture,b)};c.prototype.onAttach=
function(){this.invalidateTexture()};c.prototype.onDetach=function(){this.invalidateTexture()};c.prototype._updateTexture=function(){var a;this.stage?(this._texture||(this._texture=this.source?d(this.stage.context,this.sourceWidth,this.sourceHeight):d(this.stage.context)),(a=this.source)?(this._texture.resize(this.sourceWidth,this.sourceHeight),a&&"render"in a?a instanceof h.default?(a=a.getRenderedRasterPixels(),this._texture.setData(a.renderedRasterPixels)):this._texture.setData(b(a)):!a||"render"in
a||this._texture.setData(a),this.ready(),this.requestRenderOnSourceChangedEnabled&&this.requestRender()):this._texture.setData(null)):(null===(a=this._texture)||void 0===a?void 0:a.dispose(),this._texture=null)};return c}(c.DisplayObject);a.Bitmap=f})},"esri/views/webgl":function(){define("require exports ./webgl/BufferObject ./webgl/FramebufferObject ./webgl/Program ./webgl/Renderbuffer ./webgl/RenderingContext ./webgl/ShaderCompiler ./webgl/Texture ./webgl/VertexArrayObject ./webgl/ProgramCache ./webgl/programUtils ./webgl/context-util".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p){Object.defineProperty(a,"__esModule",{value:!0});a.BufferObject=e;a.FramebufferObject=m;a.Program=k;a.Renderbuffer=l;a.RenderingContext=g;a.ShaderCompiler=c;a.Texture=h;a.VertexArrayObject=b;a.ProgramCache=d.ProgramCache;a.createProgram=n.createProgram;a.glslifyDefineMap=n.glslifyDefineMap;a.createContextOrErrorHTML=p.createContextOrErrorHTML})},"esri/views/webgl/BufferObject":function(){define(["require","exports","../../core/has","../../core/typedArrayUtil"],
function(f,a,e,m){return function(){function a(e,g,c,h,b){this._glName=this._context=null;this._bufferType=void 0;this._usage=35044;this._size=-1;this._indexType=void 0;this._context=e;this._bufferType=g;this._usage=c;this._id=a._nextId++;this._glName=this._context.gl.createBuffer();h&&this.setData(h,b)}a.createIndex=function(e,g,c,h){return new a(e,34963,g,c,h)};a.createVertex=function(e,g,c){return new a(e,34962,g,c)};Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"usage",{get:function(){return this._usage},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"bufferType",{get:function(){return this._bufferType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"indexType",{get:function(){return this._indexType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"byteSize",{get:function(){return 34962===this._bufferType?this._size:5125===this._indexType?4*this._size:2*this._size},enumerable:!0,configurable:!0});a.prototype.dispose=function(){this._context&&(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context=null)};a.prototype.setData=function(a,e){if(a){if("number"===typeof a){if(0>a&&console.error("Buffer size cannot be negative!"),
34963===this._bufferType&&e)switch(this._indexType=e,this._size=a,e){case 5123:a*=2;break;case 5125:a*=4}}else e=a.byteLength,m.isUint16Array(a)&&(e/=2,this._indexType=5123),m.isUint32Array(a)&&(e/=4,this._indexType=5125),this._size=e;e=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);this._context.gl.bufferData(this._bufferType,a,this._usage);this._context.bindVAO(e)}};a.prototype.setSubData=function(a,e,c,h){void 0===e&&(e=0);void 0===c&&(c=0);if(a){(0>e||e>=
this._size)&&console.error("offset is out of range!");var b=e,d=c,g=h,f=a.byteLength;m.isUint16Array(a)&&(f/=2,b*=2,d*=2,g*=2);m.isUint32Array(a)&&(f/=4,b*=4,d*=4,g*=4);void 0===h&&(h=f-1);c>=h&&console.error("end must be bigger than start!");e+c-h>this._size&&console.error("An attempt to write beyond the end of the buffer!");e=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);c=this._context.gl;a=ArrayBuffer.isView(a)?a.buffer:a;c.bufferSubData(this._bufferType,
b,a.slice(d,g));this._context.bindVAO(e)}};a._nextId=0;return a}()})},"esri/views/webgl/FramebufferObject":function(){define(["require","exports","../../core/has","./Renderbuffer","./Texture"],function(f,a,e,m,k){return function(){function a(e,c,h,b){this._colorAttachment=this._stencilAttachment=this._depthAttachment=this._glName=this._context=null;this._initialized=!1;this._context=e;this._desc={colorTarget:c.colorTarget,depthStencilTarget:c.depthStencilTarget,width:c.width,height:c.height,multisampled:c.multisampled};
this._id=a._nextId++;h&&(e=void 0,h instanceof k?(this._colorAttachment=h,e=h.descriptor):(e=h,this._colorAttachment=new k(this._context,e)),0!==this._desc.colorTarget&&console.error("Framebuffer is initialized with a texture however the descriptor indicates using a renderbuffer color attachment!"),a._validateTextureDimensions(e,this._desc));b instanceof m?(2===c.depthStencilTarget?this._stencilAttachment=b:1===c.depthStencilTarget||3===c.depthStencilTarget?this._depthAttachment=b:console.error('If a Renderbuffer is provided, "depthStencilTarget" must be one of STENCIL_RENDER_BUFFER, DEPTH_RENDER_BUFFER or DEPTH_STENCIL_RENDER_BUFFER'),
a._validateBufferDimensions(b.descriptor,this._desc)):b&&(this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),c=void 0,b instanceof k?(this._depthStencilTexture=b,c=this._depthStencilTexture.descriptor):(c=b,this._depthStencilTexture=new k(this._context,c)),a._validateTextureDimensions(c,this._desc))}Object.defineProperty(a.prototype,"id",{get:function(){return this._id},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"colorTexture",{get:function(){return this._colorAttachment instanceof k?this._colorAttachment:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"colorAttachment",{get:function(){return this._colorAttachment},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"depthStencilAttachment",{get:function(){return this._depthStencilTexture||this._depthAttachment||this._stencilAttachment},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"depthStencilTexture",{get:function(){return this._depthStencilTexture},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"width",{get:function(){return this._desc.width},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"height",{get:function(){return this._desc.height},enumerable:!0,configurable:!0});a.prototype.dispose=function(){if(this._context){var a=this._context,c=a.getBoundFramebufferObject();this._disposeColorAttachment();this._disposeDepthStencilAttachments();this._glName&&(a.gl.deleteFramebuffer(this._glName),this._glName=null);a.bindFramebuffer(c);this._context=null}};a.prototype.attachColorTexture=function(e){if(e){a._validateTextureDimensions(e.descriptor,this._desc);this._disposeColorAttachment();
if(this._initialized){this._context.bindFramebuffer(this);var c=this._context.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,e.glName,0)}this._colorAttachment=e}};a.prototype.detachColorTexture=function(){if(this._colorAttachment instanceof k){var a=this._colorAttachment;if(this._initialized){this._context.bindFramebuffer(this);var c=this._context.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,null,0)}this._colorAttachment=null;return a}};a.prototype.attachDepthStencilTexture=
function(e){if(e){var c=e.descriptor;34041!==c.pixelFormat&&console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!");34042!==c.dataType&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8_WEBGL!");this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!");a._validateTextureDimensions(c,this._desc);4!==this._desc.depthStencilTarget&&(this._desc.depthStencilTarget=
4);this._disposeDepthStencilAttachments();this._initialized&&(this._context.bindFramebuffer(this),c=this._context.gl,c.framebufferTexture2D(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.TEXTURE_2D,e.glName,0));this._depthStencilTexture=e}};a.prototype.detachDepthStencilTexture=function(){var a=this._depthStencilTexture;if(a&&this._initialized){this._context.bindFramebuffer(this);var c=this._context.gl;this._context.gl.framebufferTexture2D(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.TEXTURE_2D,null,0)}this._depthStencilTexture=
null;return a};a.prototype.attachDepthStencilBuffer=function(e){if(e){var c=e.descriptor;34041!==c.internalFormat&&33189!==c.internalFormat&&console.error("Depth/Stencil buffer must have correct internalFormat");a._validateBufferDimensions(c,this._desc);this._disposeDepthStencilAttachments();this._desc.depthStencilTarget=34041===c.internalFormat?3:1;this._initialized&&(this._context.bindFramebuffer(this),c=this._context.gl,c.framebufferRenderbuffer(c.FRAMEBUFFER,1===this._desc.depthStencilTarget?
c.DEPTH_ATTACHMENT:c.DEPTH_STENCIL_ATTACHMENT,c.RENDERBUFFER,e.glName));this._depthAttachment=e}};a.prototype.detachDepthStencilBuffer=function(){var a=this._context.gl,c=this._depthAttachment;c&&this._initialized&&(this._context.bindFramebuffer(this),a.framebufferRenderbuffer(a.FRAMEBUFFER,1===this._desc.depthStencilTarget?a.DEPTH_ATTACHMENT:a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,null));this._depthAttachment=null;return c};a.prototype.copyToTexture=function(a,c,e,b,d,f,l){(0>a||0>c||0>d||0>f)&&
console.error("Offsets cannot be negative!");(0>=e||0>=b)&&console.error("Copy width and height must be greater than zero!");var g=this._desc,h=l.descriptor;3553!==l.descriptor.target&&console.error("Texture target must be TEXTURE_2D!");(a+e>g.width||c+b>g.height||d+e>h.width||f+b>h.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");g=this._context;g.bindTexture(l);g.bindFramebuffer(this);g.gl.copyTexSubImage2D(3553,0,d,f,a,c,e,b)};a.prototype.readPixels=
function(a,c,e,b,d,f,l){(0>=e||0>=b)&&console.error("Copy width and height must be greater than zero!");l||console.error("Target memory is not initialized!");this._context.bindFramebuffer(this);this._context.gl.readPixels(a,c,e,b,d,f,l)};a.prototype.resize=function(e,c){var g=this._desc;if(g.width!==e||g.height!==c)if(this._initialized){g.width=e;g.height=c;this._colorAttachment instanceof k?(b=this._colorAttachment,g=b.descriptor,g.width=e,g.height=c,this._colorAttachment.dispose(),this._colorAttachment=
new k(this._context,g),a._validateTextureDimensions(b.descriptor,this._desc)):this._colorAttachment&&this._disposeColorAttachment();if(null!=this._depthStencilTexture)g=this._depthStencilTexture.descriptor,g.width=e,g.height=c,this._depthStencilTexture.dispose(),this._depthStencilTexture=new k(this._context,g);else if(this._depthAttachment||this._stencilAttachment)this._depthAttachment&&this._depthAttachment.resize(e,c),this._stencilAttachment&&this._stencilAttachment.resize(e,c);this._context.getBoundFramebufferObject()===
this&&this._context.bindFramebuffer(null);this._initialized=!1}else{g.width=e;g.height=c;if(this._colorAttachment instanceof k){var b=this._colorAttachment;b.resize(e,c)}this._depthStencilTexture&&this._depthStencilTexture.resize(e,c)}};a.prototype.initialize=function(){if(this._initialized)return!1;var a=this._context.gl;this._glName&&a.deleteFramebuffer(this._glName);var c=a.createFramebuffer(),e=this._desc;a.bindFramebuffer(a.FRAMEBUFFER,c);if(!this._colorAttachment)if(0===e.colorTarget)this._colorAttachment=
new k(this._context,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:e.width,height:e.height});else{var b=new m(this._context,{internalFormat:32854,width:e.width,height:e.height});a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.RENDERBUFFER,b.glName);this._colorAttachment=b}this._colorAttachment instanceof k&&a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this._colorAttachment.glName,0);switch(e.depthStencilTarget){case 1:case 3:this._depthAttachment||
(this._depthAttachment=new m(this._context,{internalFormat:1===e.depthStencilTarget?33189:34041,width:e.width,height:e.height}));a.framebufferRenderbuffer(a.FRAMEBUFFER,1===e.depthStencilTarget?a.DEPTH_ATTACHMENT:a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,this._depthAttachment.glName);break;case 2:this._stencilAttachment||(this._stencilAttachment=new m(this._context,{internalFormat:36168,width:e.width,height:e.height}));a.framebufferRenderbuffer(a.FRAMEBUFFER,a.STENCIL_ATTACHMENT,a.RENDERBUFFER,this._stencilAttachment.glName);
break;case 4:this._depthStencilTexture||(this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),this._depthStencilTexture=new k(this._context,{target:3553,pixelFormat:34041,dataType:34042,samplingMode:9728,wrapMode:33071,width:e.width,height:e.height})),a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,this._depthStencilTexture.glName,0)}this._glName=
c;return this._initialized=!0};a.prototype._disposeColorAttachment=function(){if(this._colorAttachment instanceof k){var a=this._colorAttachment;if(this._initialized){this._context.bindFramebuffer(this);var c=this._context.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,null,0)}a.dispose()}else this._colorAttachment instanceof WebGLRenderbuffer&&(a=this._colorAttachment,c=this._context.gl,this._initialized&&(this._context.bindFramebuffer(this),c.framebufferRenderbuffer(c.FRAMEBUFFER,
c.COLOR_ATTACHMENT0,c.RENDERBUFFER,null)),this._context.gl.deleteRenderbuffer(a));this._colorAttachment=null};a.prototype._disposeDepthStencilAttachments=function(){var a=this._context.gl;this._depthAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),a.framebufferRenderbuffer(a.FRAMEBUFFER,1===this._desc.depthStencilTarget?a.DEPTH_ATTACHMENT:a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,null)),this._depthAttachment.dispose(),this._depthAttachment=null);this._stencilAttachment&&(this._initialized&&
(this._context.bindFramebuffer(this),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.STENCIL_ATTACHMENT,a.RENDERBUFFER,null)),this._stencilAttachment.dispose(),this._stencilAttachment=null);this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,null,0)),this._depthStencilTexture.dispose(),this._depthStencilTexture=null)};a._validateBufferDimensions=function(a,c){console.assert(0<=a.width&&0<=a.height);
void 0!==c.width&&0<=c.width&&void 0!==c.height&&0<=c.height?c.width===a.width&&c.height===a.height||console.error("Renderbuffer dimensions must match the framebuffer's!"):(c.width=a.width,c.height=a.height)};a._validateTextureDimensions=function(a,c){console.assert(0<=a.width&&0<=a.height);3553!==a.target&&console.error("Texture type must be TEXTURE_2D!");void 0!==c.width&&0<=c.width&&void 0!==c.height&&0<=c.height?c.width===a.width&&c.height===a.height||console.error("Color attachment texture must match the framebuffer's!"):
(c.width=a.width,c.height=a.height)};a._nextId=0;return a}()})},"esri/views/webgl/Renderbuffer":function(){define(["require","exports","../../core/has"],function(f,a,e){return function(){function a(e,f){this._context=e;this._desc=f;this._glName=null;this._id=-1;e=this._context.gl;this._id=++a._nextId;this._glName=e.createRenderbuffer();this._context.bindRenderbuffer(this);e.renderbufferStorage(e.RENDERBUFFER,f.internalFormat,f.width,f.height)}Object.defineProperty(a.prototype,"descriptor",{get:function(){return this._desc},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});a.prototype.resize=function(a,e){var g=this._context.gl,c=this._desc;if(c.width!==a||c.height!==e)c.width=a,c.height=e,this._context.bindRenderbuffer(this),g.renderbufferStorage(g.RENDERBUFFER,c.internalFormat,c.width,c.height)};a.prototype.dispose=function(){this._glName&&
(this._context.gl.deleteRenderbuffer(this._glName),this._glName=null);this._context=null};a._nextId=0;return a}()})},"esri/views/webgl/Texture":function(){define("require exports tslib ../../core/has ../../core/mathUtils ../../core/maybe".split(" "),function(f,a,e,m,k,l){return function(){function a(c,g,b){void 0===b&&(b=null);this._glName=this._context=null;this._id=-1;this._descriptor=void 0;this._wrapModeDirty=this._samplingModeDirty=!1;this._boundToUnits=new Set;this._context=c;this._descriptor=
e.__assign({target:3553,samplingMode:9729,wrapMode:10497,flipped:!1,hasMipmap:!1,isOpaque:!1,unpackAlignment:4,preMultiplyAlpha:!1},g);this._id=++a._nextId;this.setData(b)}Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"descriptor",{get:function(){return this._descriptor},enumerable:!0,configurable:!0});
a.prototype.dispose=function(){var a=this;if(this._context&&this._context.gl){if(this._glName){var e=this._context.gl;this._boundToUnits.forEach(function(b){a._context.bindTexture(null,b)});e.deleteTexture(this._glName);this._glName=null}this._context=null}};a.prototype.release=function(){this.dispose()};a.prototype.resize=function(a,e){var b=this._descriptor;if(b.width!==a||b.height!==e)b.width=a,b.height=e,this.setData(null)};a.prototype.setData=function(c){var e=this._context.gl;this._glName||
(this._glName=e.createTexture());void 0===c&&(c=null);null===c&&(this._descriptor.width=this._descriptor.width||4,this._descriptor.height=this._descriptor.height||4);var b=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var d=this._descriptor;a._validateTexture(d);e.pixelStorei(e.UNPACK_ALIGNMENT,d.unpackAlignment);e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,d.flipped?1:0);e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,d.preMultiplyAlpha?1:0);var g=d.pixelFormat,f=d.internalFormat?d.internalFormat:
g;if(c instanceof ImageData||c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement){var k=c.width,q=c.height;c instanceof HTMLVideoElement&&(k=c.videoWidth,q=c.videoHeight);d.width&&d.height&&console.assert(k===d.width&&q===d.height);e.texImage2D(e.TEXTURE_2D,0,f,g,d.dataType,c);d.hasMipmap&&this.generateMipmap();void 0===d.width&&(d.width=k);void 0===d.height&&(d.height=q)}else{null!=d.width&&null!=d.height||console.error("Width and height must be specified!");
e.DEPTH24_STENCIL8&&f===e.DEPTH_STENCIL&&(f=e.DEPTH24_STENCIL8);var k=d.width,q=d.height,m=c;if(l.isSome(m)&&"type"in m&&"compressed"===m.type)for(g=Math.round(Math.log(Math.max(k,q))/Math.LN2)+1,d.hasMipmap=d.hasMipmap&&g===c.levels.length,m=0;;++m){e.compressedTexImage2D(e.TEXTURE_2D,m,f,k,q,0,c.levels[Math.min(m,c.levels.length-1)]);if(1===k&&1===q||!d.hasMipmap)break;k=Math.max(1,k>>1);q=Math.max(1,q>>1)}else if(l.isSome(c))e.texImage2D(e.TEXTURE_2D,0,f,k,q,0,g,d.dataType,c),d.hasMipmap&&this.generateMipmap();
else for(m=0;;++m){e.texImage2D(e.TEXTURE_2D,m,f,k,q,0,g,d.dataType,null);if(1===k&&1===q||!d.hasMipmap)break;k=Math.max(1,k>>1);q=Math.max(1,q>>1)}}a._applySamplingMode(e,this._descriptor);a._applyWrapMode(e,this._descriptor);a._applyAnisotropicFilteringParameters(this._context,this._descriptor);this._context.bindTexture(b,0)};a.prototype.updateData=function(a,e,b,d,g,f){f||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");
var c=this._context.gl,h=this._descriptor,n=this._context.getBoundTexture(0);this._context.bindTexture(this,0);(0>e||0>b||d>h.width||g>h.height||e+d>h.width||b+g>h.height)&&console.error("An attempt to update out of bounds of the texture!");c.pixelStorei(c.UNPACK_ALIGNMENT,h.unpackAlignment);c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,h.flipped?1:0);c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,h.preMultiplyAlpha?1:0);f instanceof ImageData||f instanceof HTMLImageElement||f instanceof HTMLCanvasElement||
f instanceof HTMLVideoElement?c.texSubImage2D(c.TEXTURE_2D,a,e,b,h.pixelFormat,h.dataType,f):c.texSubImage2D(c.TEXTURE_2D,a,e,b,d,g,h.pixelFormat,h.dataType,f);this._context.bindTexture(n,0)};a.prototype.generateMipmap=function(){var c=this._descriptor;c.hasMipmap||(c.hasMipmap=!0,a._validateTexture(c));9729===c.samplingMode?(this._samplingModeDirty=!0,c.samplingMode=9985):9728===c.samplingMode&&(this._samplingModeDirty=!0,c.samplingMode=9984);c=this._context.getBoundTexture(0);this._context.bindTexture(this,
0);var e=this._context.gl;e.generateMipmap(e.TEXTURE_2D);this._context.bindTexture(c,0)};a.prototype.setSamplingMode=function(c){c!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=c,a._validateTexture(this._descriptor),this._samplingModeDirty=!0)};a.prototype.setWrapMode=function(c){c!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=c,a._validateTexture(this._descriptor),this._wrapModeDirty=!0)};a.prototype.applyChanges=function(){var c=this._context.gl,e=this._descriptor;this._samplingModeDirty&&
(a._applySamplingMode(c,e),this._samplingModeDirty=!1);this._wrapModeDirty&&(a._applyWrapMode(c,e),this._wrapModeDirty=!1)};a.prototype.setBoundToUnit=function(a,e){e?this._boundToUnits.add(a):this._boundToUnits.delete(a)};a._validateTexture=function(a){(0>a.width||0>a.height)&&console.error("Negative dimension parameters are not allowed!");k.isPowerOfTwo(a.width)&&k.isPowerOfTwo(a.height)||("number"===typeof a.wrapMode?33071!==a.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):
33071===a.wrapMode.s&&33071===a.wrapMode.t||console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),a.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))};a._applySamplingMode=function(a,e){var b=e.samplingMode,d=e.samplingMode;if(9985===b||9987===b)b=9729,e.hasMipmap||(d=9729);else if(9984===b||9986===b)b=9728,e.hasMipmap||(d=9728);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,b);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,d)};a._applyWrapMode=
function(a,e){"number"===typeof e.wrapMode?(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,e.wrapMode),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,e.wrapMode)):(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,e.wrapMode.s),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,e.wrapMode.t))};a._applyAnisotropicFilteringParameters=function(a,e){if(null!=e.maxAnisotropy){var b=a.capabilities.textureFilterAnisotropic;b&&(a=a.gl,a.texParameterf(a.TEXTURE_2D,b.TEXTURE_MAX_ANISOTROPY,e.maxAnisotropy))}};a._nextId=
0;return a}()})},"esri/views/webgl/Program":function(){define(["require","exports","../../core/has","../../core/maybe","./ShaderTranspiler"],function(f,a,e,m,k){function l(a,c){if(m.isNone(a)||a.length!==c.length)return!0;for(var e=0;e<a.length;++e)if(a[e]!==c[e])return!0;return!1}return function(){function a(c,e,b,d,g){void 0===g&&(g={});this._glName=this._context=null;this._locations={};this._id=void 0;this._initialized=!1;this._fShader=this._vShader=null;this._defines={};this._nameToUniformLocation=
{};this._nameToAttribLocation={};this._nameToUniform1={};this._nameToUniform1v={};this._nameToUniform2={};this._nameToUniform3={};this._nameToUniform4={};this._nameToUniformMatrix3={};this._nameToUniformMatrix4={};c||console.error("RenderingContext isn't initialized!");0===e.length&&console.error("Shaders source should not be empty!");this._context=c;this._vertexShaderSource=e;this._fragmentShaderSource=b;if(Array.isArray(g))for(c=0;c<g.length;c++)this._defines[g[c]]="1";else this._defines=g;this._id=
a._nextId++;this._locations=d}Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0});a.prototype.getDefine=function(a){return this._defines[a]};a.prototype.dispose=function(){if(this._context){var a=this._context.gl;this._vShader&&
(a.deleteShader(this._vShader),this._vShader=null);this._fShader&&(a.deleteShader(this._fShader),this._fShader=null);this._glName&&(a.deleteProgram(this._glName),this._glName=null);this._context=null}};a.prototype.initialize=function(){if(!this._initialized){this._vShader=this._loadShader(35633);this._fShader=this._loadShader(35632);this._vShader&&this._fShader||console.error("Error loading shaders!");var a=this._context.gl,e=a.createProgram();a.attachShader(e,this._vShader);a.attachShader(e,this._fShader);
for(var b in this._locations)a.bindAttribLocation(e,this._locations[b],b);a.linkProgram(e);this._glName=e;this._initialized=!0}};a.prototype.getUniformLocation=function(a){this.initialize();void 0===this._nameToUniformLocation[a]&&(this._nameToUniformLocation[a]=this._context.gl.getUniformLocation(this._glName,a));return this._nameToUniformLocation[a]};a.prototype.hasUniform=function(a){return null!==this.getUniformLocation(a)};a.prototype.getAttribLocation=function(a){this.initialize();void 0===
this._nameToAttribLocation[a]&&(this._nameToAttribLocation[a]=this._context.gl.getAttribLocation(this._glName,a));return this._nameToAttribLocation[a]};a.prototype.setUniform1i=function(a,e){var b=this._nameToUniform1[a];if(void 0===b||e!==b)this._context.bindProgram(this),this._context.gl.uniform1i(this.getUniformLocation(a),e),this._nameToUniform1[a]=e};a.prototype.setUniform1iv=function(c,e){var b=this._nameToUniform1v[c];l(b,e)&&(this._context.bindProgram(this),this._context.gl.uniform1iv(this.getUniformLocation(c),
e),void 0===b?this._nameToUniform1v[c]=a._arrayCopy(e):a._arrayAssign(e,b))};a.prototype.setUniform2iv=function(c,e){var b=this._nameToUniform2[c];l(b,e)&&(this._context.bindProgram(this),this._context.gl.uniform2iv(this.getUniformLocation(c),e),void 0===b?this._nameToUniform2[c]=a._arrayCopy(e):a._arrayAssign(e,b))};a.prototype.setUniform3iv=function(c,e){var b=this._nameToUniform3[c];l(b,e)&&(this._context.bindProgram(this),this._context.gl.uniform3iv(this.getUniformLocation(c),e),void 0===b?this._nameToUniform3[c]=
a._arrayCopy(e):a._arrayAssign(e,b))};a.prototype.setUniform4iv=function(c,e){var b=this._nameToUniform4[c];l(b,e)&&(this._context.bindProgram(this),this._context.gl.uniform4iv(this.getUniformLocation(c),e),void 0===b?this._nameToUniform4[c]=a._arrayCopy(e):a._arrayAssign(e,b))};a.prototype.setUniform1f=function(a,e){var b=this._nameToUniform1[a];if(void 0===b||e!==b)this._context.bindProgram(this),this._context.gl.uniform1f(this.getUniformLocation(a),e),this._nameToUniform1[a]=e};a.prototype.setUniform1fv=
function(c,e){var b=this._nameToUniform1v[c];l(b,e)&&(this._context.bindProgram(this),this._context.gl.uniform1fv(this.getUniformLocation(c),e),void 0===b?this._nameToUniform1v[c]=a._arrayCopy(e):a._arrayAssign(e,b))};a.prototype.setUniform2f=function(a,e,b){var d=this._nameToUniform2[a];if(void 0===d||e!==d[0]||b!==d[1])this._context.bindProgram(this),this._context.gl.uniform2f(this.getUniformLocation(a),e,b),void 0===d?this._nameToUniform2[a]=[e,b]:(d[0]=e,d[1]=b)};a.prototype.setUniform2fv=function(c,
e){var b=this._nameToUniform2[c];l(b,e)&&(this._context.bindProgram(this),this._context.gl.uniform2fv(this.getUniformLocation(c),e),void 0===b?this._nameToUniform2[c]=a._arrayCopy(e):a._arrayAssign(e,b))};a.prototype.setUniform3f=function(a,e,b,d){var c=this._nameToUniform3[a];if(void 0===c||e!==c[0]||b!==c[1]||d!==c[2])this._context.bindProgram(this),this._context.gl.uniform3f(this.getUniformLocation(a),e,b,d),void 0===c?this._nameToUniform3[a]=[e,b,d]:(c[0]=e,c[1]=b,c[2]=d)};a.prototype.setUniform3fv=
function(c,e){var b=this._nameToUniform3[c];l(b,e)&&(this._context.bindProgram(this),this._context.gl.uniform3fv(this.getUniformLocation(c),e),void 0===b?this._nameToUniform3[c]=a._arrayCopy(e):a._arrayAssign(e,b))};a.prototype.setUniform4f=function(a,e,b,d,g){var c=this._nameToUniform4[a];if(void 0===c||e!==c[0]||b!==c[1]||d!==c[2]||g!==c[3])this._context.bindProgram(this),this._context.gl.uniform4f(this.getUniformLocation(a),e,b,d,g),void 0===c?this._nameToUniform4[a]=[e,b,d,g]:(c[0]=e,c[1]=b,c[2]=
d,c[3]=g)};a.prototype.setUniform4fv=function(c,e){var b=this._nameToUniform4[c];l(b,e)&&(this._context.bindProgram(this),this._context.gl.uniform4fv(this.getUniformLocation(c),e),void 0===b?this._nameToUniform4[c]=a._arrayCopy(e):a._arrayAssign(e,b))};a.prototype.setUniformMatrix3fv=function(c,e,b){void 0===b&&(b=!1);var d=this._nameToUniformMatrix3[c],g;g=m.isNone(d)?!0:9!==d.length?l(d,e):9!==d.length||d[0]!==e[0]||d[1]!==e[1]||d[2]!==e[2]||d[3]!==e[3]||d[4]!==e[4]||d[5]!==e[5]||d[6]!==e[6]||d[7]!==
e[7]||d[8]!==e[8];g&&(this._context.bindProgram(this),this._context.gl.uniformMatrix3fv(this.getUniformLocation(c),b,e),void 0===d?this._nameToUniformMatrix3[c]=a._arrayCopy(e):a._arrayAssign(e,d))};a.prototype.setUniformMatrix4fv=function(c,e,b){void 0===b&&(b=!1);var d=this._nameToUniformMatrix4[c],g;g=m.isNone(d)?!0:16!==d.length?l(d,e):16!==d.length||d[0]!==e[0]||d[1]!==e[1]||d[2]!==e[2]||d[3]!==e[3]||d[4]!==e[4]||d[5]!==e[5]||d[6]!==e[6]||d[7]!==e[7]||d[8]!==e[8]||d[9]!==e[9]||d[10]!==e[10]||
d[11]!==e[11]||d[12]!==e[12]||d[13]!==e[13]||d[14]!==e[14]||d[15]!==e[15];g&&(this._context.bindProgram(this),this._context.gl.uniformMatrix4fv(this.getUniformLocation(c),b,e),void 0===d?this._nameToUniformMatrix4[c]=a._arrayCopy(e):a._arrayAssign(e,d))};a.prototype.assertCompatibleVertexAttributeLocations=function(a){(a=a.locations===this.locations)||console.error("VertexAttributeLocations are incompatible");return a};a._padToThree=function(a){var c=a.toString();1E3>a&&(c=("  "+a).slice(-3));return c};
a.prototype._addLineNumbers=function(c){var e=2;return c.replace(/\n/g,function(){return"\n"+a._padToThree(e++)+":"})};a.prototype._loadShader=function(a){var c=35633===a,b=c?this._vertexShaderSource:this._fragmentShaderSource,d="",e;for(e in this._defines)d+="#define "+e+" "+this._defines[e]+"\n";b=d+b;"webgl2"===this._context.contextVersion&&(b=k.transpileShader(b,c?"vertex":"fragment"));c=this._context.gl;a=c.createShader(a);c.shaderSource(a,b);c.compileShader(a);return a};a._arrayCopy=function(a){for(var c=
[],b=0;b<a.length;++b)c.push(a[b]);return c};a._arrayAssign=function(a,e){for(var b=0;b<a.length;++b)e[b]=a[b]};a._nextId=0;return a}()})},"esri/views/webgl/ShaderTranspiler":function(){define(["require","exports","./reservedWordsGLSL3","./lib/glsl-tokenizer/string"],function(f,a,e,m){function k(a){return a.map(function(b){return"eof"!==b.type?b.data:""}).join("")}function l(a,b,d,c){c=c||d;for(var e=0;e<a.length;e++){var g=a[e];if("ident"===g.type&&g.data===d)return c in b?b[c]++:b[c]=0,l(a,b,c+
"_"+b[c],c)}return d}function g(a,b,d){void 0===d&&(d="afterVersion");var c={data:"\n",type:"whitespace"},e=function(b){return b<a.length?/[^\r\n]$/.test(a[b].data):!1},g=function(b){for(var a=-1,c=0,e=-1,g=0;g<b.length;g++){var h=b[g];"preprocessor"===h.type&&(h.data.match(/\#(if|ifdef|ifndef)\s+.+/)?++c:h.data.match(/\#endif\s*.*/)&&--c);("afterVersion"===d||"afterPrecision"===d)&&"preprocessor"===h.type&&/^#version/.test(h.data)&&(e=Math.max(e,g));if("afterPrecision"===d&&"keyword"===h.type&&"precision"===
h.data){a:{for(h=g;h<b.length;h++){var f=b[h];if("operator"===f.type&&";"===f.data)break a}h=null}if(null===h)throw Error("precision statement not followed by any semicolons!");e=Math.max(e,h)}a<e&&0===c&&(a=g)}return a+1}(a);e(g-1)&&a.splice(g++,0,c);for(var h=0;h<b.length;h++){var f=b[h];a.splice(g++,0,f)}e(g-1)&&e(g)&&a.splice(g,0,c)}Object.defineProperty(a,"__esModule",{value:!0});var c=["GL_OES_standard_derivatives","GL_EXT_frag_depth","GL_EXT_draw_buffers","GL_EXT_shader_texture_lod"];a.transpileShader=
function(a,b){a=m(a);var d;a:{d="100";var h="300 es";void 0===d&&(d="100");void 0===h&&(h="300 es");for(var f=/^\s*\#version\s+([0-9]+(\s+[a-zA-Z]+)?)\s*/,r=0;r<a.length;r++){var q=a[r];if("preprocessor"===q.type){var x=f.exec(q.data);if(x){f=x[1].replace(/\s\s+/g," ");if(f===h){d=f;break a}if(f===d){q.data="#version "+h;break a}throw Error("unknown glsl version: "+f);}}}a.splice(0,0,{type:"preprocessor",data:"#version "+h},{type:"whitespace",data:"\n"});d=null}if("300 es"===d)throw Error("shader is already glsl 300 es");
f=q=null;r={};x={};for(d=0;d<a.length;++d)switch(h=a[d],h.type){case "keyword":"vertex"===b&&"attribute"===h.data?h.data="in":"varying"===h.data&&(h.data="vertex"===b?"out":"in");break;case "builtin":/^texture(2D|Cube)(Proj)?(Lod|Grad)?(EXT)?$/.test(h.data.trim())&&(h.data=h.data.replace(/(2D|Cube|EXT)/g,""));if("fragment"===b&&"gl_FragColor"===h.data){if(!q){var q=l(a,r,"fragColor"),u=void 0;void 0===u&&(u="lowp");g(a,[{type:"keyword",data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:u},
{type:"whitespace",data:" "},{type:"keyword",data:"vec4"},{type:"whitespace",data:" "},{type:"ident",data:q},{type:"operator",data:";"}],"afterPrecision")}h.data=q}else"fragment"===b&&"gl_FragDepthEXT"===h.data&&(f||(f=l(a,r,"gl_FragDepth")),h.data=f);break;case "ident":if(0<=e.indexOf(h.data)){if(u="vertex"===b)a:{for(u=d-1;0<=u;u--){var v=a[u];if("whitespace"!==v.type&&"block-comment"!==v.type)if("keyword"===v.type){if("attribute"===v.data||"in"===v.data){u=!0;break a}}else break}u=!1}if(u)throw Error("attribute in vertex shader uses a name that is a reserved word in glsl 300 es");
h.data in x||(x[h.data]=l(a,r,h.data));h.data=x[h.data]}}for(d=a.length-1;0<=d;--d)h=a[d],"preprocessor"===h.type&&((b=h.data.match(/\#extension\s+(.*)\:/))&&b[1]&&0<=c.indexOf(b[1].trim())&&(b=a[d+1],a.splice(d,b&&"whitespace"===b.type?2:1)),(b=h.data.match(/\#ifdef\s+(.*)/))&&b[1]&&0<=c.indexOf(b[1].trim())&&(h.data="#if 1"),(b=h.data.match(/\#ifndef\s+(.*)/))&&b[1]&&0<=c.indexOf(b[1].trim())&&(h.data="#if 0"));return k(a)}})},"esri/views/webgl/reservedWordsGLSL3":function(){define(["require","exports"],
function(f,a){return"layout centroid smooth case mat2x2 mat2x3 mat2x4 mat3x2 mat3x3 mat3x4 mat4x2 mat4x3 mat4x4 uint uvec2 uvec3 uvec4 samplerCubeShadow sampler2DArray sampler2DArrayShadow isampler2D isampler3D isamplerCube isampler2DArray usampler2D usampler3D usamplerCube usampler2DArray coherent restrict readonly writeonly resource atomic_uint noperspective patch sample subroutine common partition active filter image1D image2D image3D imageCube iimage1D iimage2D iimage3D iimageCube uimage1D uimage2D uimage3D uimageCube image1DArray image2DArray iimage1DArray iimage2DArray uimage1DArray uimage2DArray image1DShadow image2DShadow image1DArrayShadow image2DArrayShadow imageBuffer iimageBuffer uimageBuffer sampler1DArray sampler1DArrayShadow isampler1D isampler1DArray usampler1D usampler1DArray isampler2DRect usampler2DRect samplerBuffer isamplerBuffer usamplerBuffer sampler2DMS isampler2DMS usampler2DMS sampler2DMSArray isampler2DMSArray usampler2DMSArray trunc round roundEven isnan isinf floatBitsToInt floatBitsToUint intBitsToFloat uintBitsToFloat packSnorm2x16 unpackSnorm2x16 packUnorm2x16 unpackUnorm2x16 packHalf2x16 unpackHalf2x16 outerProduct transpose determinant inverse texture textureSize textureProj textureLod textureOffset texelFetch texelFetchOffset textureProjOffset textureLodOffset textureProjLod textureProjLodOffset textureGrad textureGradOffset textureProjGrad textureProjGradOffset".split(" ")})},
"esri/views/webgl/lib/glsl-tokenizer/string":function(){define(["./index"],function(f){"use strict;";return function(a){var e=f(),m=[],m=m.concat(e(a));return m=m.concat(e(null))}})},"esri/views/webgl/lib/glsl-tokenizer/index":function(){define(["./lib/literals","./lib/operators","./lib/builtins"],function(f,a,e){"use strict;";var m="block-comment line-comment preprocessor operator integer float ident builtin keyword whitespace eof integer".split(" ");return function(){function k(b){b.length&&v.push({type:m[r],
data:b,position:A,line:y,column:z})}function l(){u=u.length?[]:u;if("/"===x&&"*"===q)return A=p+n-1,r=0,x=q,n+1;if("/"===x&&"/"===q)return A=p+n-1,r=1,x=q,n+1;if("#"===q)return r=2,A=p+n,n;if(/\s/.test(q))return r=9,A=p+n,n;B=/\d/.test(q);D=/[^\w_]/.test(q);A=p+n;r=B?4:D?3:9999;return n}function g(){if(("\r"===q||"\n"===q)&&"\\"!==x)return k(u.join("")),r=999,n;u.push(q);x=q;return n+1}function c(){if("."===x&&/\d/.test(q))return r=5,n;if("/"===x&&"*"===q)return r=0,n;if("/"===x&&"/"===q)return r=
1,n;if("."===q&&u.length){for(;h(u););r=5;return n}if(";"===q||")"===q||"("===q){if(u.length)for(;h(u););k(q);r=999;return n+1}var b=2===u.length&&"\x3d"!==q;if(/[\w_\d\s]/.test(q)||b){for(;h(u););r=999;return n}u.push(q);x=q;return n+1}function h(b){var d=0,c,e;do{c=a.indexOf(b.slice(0,b.length+d).join(""));e=a[c];if(-1===c){if(0<d--+b.length)continue;e=b.slice(0,1).join("")}k(e);A+=e.length;u=u.slice(e.length);return u.length}while(1)}function b(){if("."===q||/[eE]/.test(q))return u.push(q),r=5,
x=q,n+1;if("x"===q&&1===u.length&&"0"===u[0])return r=11,u.push(q),x=q,n+1;if(/[^\d]/.test(q))return k(u.join("")),r=999,n;u.push(q);x=q;return n+1}function d(){"f"===q&&(u.push(q),x=q,n+=1);if(/[eE]/.test(q)||"-"===q&&/[eE]/.test(x))return u.push(q),x=q,n+1;if(/[^\d]/.test(q))return k(u.join("")),r=999,n;u.push(q);x=q;return n+1}var n=0,p=0,r=999,q,x,u=[],v=[],y=1,z=0,A=0,B=!1,D=!1,C="",E;return function(a){v=[];if(null!==a){a=a.replace?a.replace(/\r\n/g,"\n"):a;n=0;C+=a;for(E=C.length;q=C[n],n<
E;){a=n;switch(r){case 0:"/"===q&&"*"===x?(u.push(q),k(u.join("")),r=999):(u.push(q),x=q);n+=1;break;case 1:n=g();break;case 2:n=g();break;case 3:n=c();break;case 4:n=b();break;case 11:/[^a-fA-F0-9]/.test(q)?(k(u.join("")),r=999):(u.push(q),x=q,n+=1);break;case 5:n=d();break;case 9999:if(/[^\d\w_]/.test(q)){var h=u.join("");r=-1<f.indexOf(h)?8:-1<e.indexOf(h)?7:6;k(u.join(""));r=999}else u.push(q),x=q,n+=1;break;case 9:/[^\s]/g.test(q)?(k(u.join("")),r=999):(u.push(q),x=q,n+=1);break;case 999:n=l()}if(a!==
n)switch(C[a]){case "\n":z=0;++y;break;default:++z}}p+=n;C=C.slice(n);return v}u.length&&k(u.join(""));r=10;k("(eof)");return v}}})},"esri/views/webgl/lib/glsl-tokenizer/lib/literals":function(){define([],function(){return"precision highp mediump lowp attribute const uniform varying break continue do for while if else in out inout float int void bool true false discard return mat2 mat3 mat4 vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadow struct asm class union enum typedef template this packed goto switch default inline noinline volatile public static extern external interface long short double half fixed unsigned input output hvec2 hvec3 hvec4 dvec2 dvec3 dvec4 fvec2 fvec3 fvec4 sampler2DRect sampler3DRect sampler2DRectShadow sizeof cast namespace using".split(" ")})},
"esri/views/webgl/lib/glsl-tokenizer/lib/operators":function(){define([],function(){"use strict;";return"\x3c\x3c\x3d \x3e\x3e\x3d ++ -- \x3c\x3c \x3e\x3e \x3c\x3d \x3e\x3d \x3d\x3d !\x3d \x26\x26 || +\x3d -\x3d *\x3d /\x3d %\x3d \x26\x3d ^^ ^\x3d |\x3d ( ) [ ] . ! ~ * / % + - \x3c \x3e \x26 ^ | ? : \x3d , ; { }".split(" ")})},"esri/views/webgl/lib/glsl-tokenizer/lib/builtins":function(){define([],function(){return"abs acos all any asin atan ceil clamp cos cross dFdx dFdy degrees distance dot equal exp exp2 faceforward floor fract gl_BackColor gl_BackLightModelProduct gl_BackLightProduct gl_BackMaterial gl_BackSecondaryColor gl_ClipPlane gl_ClipVertex gl_Color gl_DepthRange gl_DepthRangeParameters gl_EyePlaneQ gl_EyePlaneR gl_EyePlaneS gl_EyePlaneT gl_Fog gl_FogCoord gl_FogFragCoord gl_FogParameters gl_FragColor gl_FragCoord gl_FragData gl_FragDepth gl_FragDepthEXT gl_FrontColor gl_FrontFacing gl_FrontLightModelProduct gl_FrontLightProduct gl_FrontMaterial gl_FrontSecondaryColor gl_LightModel gl_LightModelParameters gl_LightModelProducts gl_LightProducts gl_LightSource gl_LightSourceParameters gl_MaterialParameters gl_MaxClipPlanes gl_MaxCombinedTextureImageUnits gl_MaxDrawBuffers gl_MaxFragmentUniformComponents gl_MaxLights gl_MaxTextureCoords gl_MaxTextureImageUnits gl_MaxTextureUnits gl_MaxVaryingFloats gl_MaxVertexAttribs gl_MaxVertexTextureImageUnits gl_MaxVertexUniformComponents gl_ModelViewMatrix gl_ModelViewMatrixInverse gl_ModelViewMatrixInverseTranspose gl_ModelViewMatrixTranspose gl_ModelViewProjectionMatrix gl_ModelViewProjectionMatrixInverse gl_ModelViewProjectionMatrixInverseTranspose gl_ModelViewProjectionMatrixTranspose gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 gl_Normal gl_NormalMatrix gl_NormalScale gl_ObjectPlaneQ gl_ObjectPlaneR gl_ObjectPlaneS gl_ObjectPlaneT gl_Point gl_PointCoord gl_PointParameters gl_PointSize gl_Position gl_ProjectionMatrix gl_ProjectionMatrixInverse gl_ProjectionMatrixInverseTranspose gl_ProjectionMatrixTranspose gl_SecondaryColor gl_TexCoord gl_TextureEnvColor gl_TextureMatrix gl_TextureMatrixInverse gl_TextureMatrixInverseTranspose gl_TextureMatrixTranspose gl_Vertex greaterThan greaterThanEqual inversesqrt length lessThan lessThanEqual log log2 matrixCompMult max min mix mod normalize not notEqual pow radians reflect refract sign sin smoothstep sqrt step tan texture2D texture2DLod texture2DProj texture2DProjLod textureCube textureCubeLod texture2DLodEXT texture2DProjLodEXT textureCubeLodEXT texture2DGradEXT texture2DProjGradEXT textureCubeGradEXT".split(" ")})},
"esri/views/webgl/RenderingContext":function(){define("require exports ../../core/has ../../core/maybe ./enums ./InstanceCounter ./renderState ./capabilities/isWebGL2Context ./capabilities/load".split(" "),function(f,a,e,m,k,l,g,c,h){return function(){function b(b,a){var d=this;this.gl=null;this._blendEnabled=!1;this._blendColorState={r:0,g:0,b:0,a:0};this._blendFunctionState={srcRGB:1,dstRGB:0,srcAlpha:1,dstAlpha:0};this._blendEquationState={mode:32774,modeAlpha:32774};this._colorMaskState={r:!0,
g:!0,b:!0,a:!0};this._polygonCullingEnabled=!1;this._cullFace=1029;this._frontFace=2305;this._scissorTestEnabled=!1;this._scissorRect={x:0,y:0,width:0,height:0};this._depthTestEnabled=!1;this._depthFunction=513;this._clearDepth=1;this._depthWriteEnabled=!0;this._depthRange={zNear:0,zFar:1};this._viewport=null;this._polygonOffsetFillEnabled=this._stencilTestEnabled=!1;this._polygonOffset=[0,0];this._stencilFunction={face:1032,func:519,ref:0,mask:1};this._clearStencil=0;this._stencilWriteMask=1;this._stencilOperation=
{face:1032,fail:7680,zFail:7680,zPass:7680};this._clearColor={r:0,g:0,b:0,a:0};this._activeRenderbuffer=this._activeFramebuffer=this._activeIndexBuffer=this._activeVertexBuffer=this._activeShaderProgram=null;this._activeTextureUnit=0;this._textureUnitMap={};this._numOfTriangles=this._numOfDrawCalls=0;this.contextVersion=c.default(b)?"webgl2":"webgl";this.gl=b;b instanceof WebGLRenderingContext&&this.gl.getExtension("OES_element_index_uint");this._capabilities=h.loadCapabilities(b,a);b=this.gl.getParameter(this.gl.VIEWPORT);
this._viewport={x:b[0],y:b[1],width:b[2],height:b[3]};this._stateTracker=new g.StateTracker({setBlending:function(b){b?(d.setBlendingEnabled(!0),d.setBlendEquationSeparate(b.opRgb,b.opAlpha),d.setBlendFunctionSeparate(b.srcRgb,b.dstRgb,b.srcAlpha,b.dstAlpha),b=b.color,d.setBlendColor(b.r,b.g,b.b,b.a)):d.setBlendingEnabled(!1)},setCulling:function(b){b?(d.setFaceCullingEnabled(!0),d.setCullFace(b.face),d.setFrontFace(b.mode)):d.setFaceCullingEnabled(!1)},setPolygonOffset:function(b){b?(d.setPolygonOffsetFillEnabled(!0),
d.setPolygonOffset(b.factor,b.units)):d.setPolygonOffsetFillEnabled(!1)},setDepthTest:function(b){b?(d.setDepthTestEnabled(!0),d.setDepthFunction(b.func)):d.setDepthTestEnabled(!1)},setStencilTest:function(b){if(b){d.setStencilTestEnabled(!0);var a=b.function;d.setStencilFunction(a.func,a.ref,a.mask);b=b.operation;d.setStencilOp(b.fail,b.zFail,b.zPass)}else d.setStencilTestEnabled(!1)},setDepthWrite:function(b){b?(d.setDepthWriteEnabled(!0),d.setDepthRange(b.zNear,b.zFar)):d.setDepthWriteEnabled(!1)},
setColorWrite:function(b){b?d.setColorMask(b.r,b.g,b.b,b.a):d.setColorMask(!1,!1,!1,!1)},setStencilWrite:function(b){b?d.setStencilWriteMask(b.mask):d.setStencilWriteMask(0)}});this.enforceState()}Object.defineProperty(b.prototype,"contextAttributes",{get:function(){return this.gl.getContextAttributes()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"parameters",{get:function(){if(!this._parameters){var b=this.capabilities.textureFilterAnisotropic;this._parameters={versionString:this.gl.getParameter(this.gl.VERSION),
maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:b?this.gl.getParameter(b.MAX_TEXTURE_MAX_ANISOTROPY):void 0,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),maxTextureSize:this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE)}}return this._parameters},enumerable:!0,configurable:!0});b.prototype.dispose=function(){this.bindVAO(null);this.unbindBuffer(34962);
this.unbindBuffer(34963);this._textureUnitMap={};this.gl=null};b.prototype.setPipelineState=function(b){this._stateTracker.setPipeline(b)};b.prototype.setBlendingEnabled=function(b){this._blendEnabled!==b&&(!0===b?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._blendEnabled=b,this._stateTracker.invalidateBlending())};b.prototype.setBlendColor=function(b,a,c,e){if(b!==this._blendColorState.r||a!==this._blendColorState.g||c!==this._blendColorState.b||e!==this._blendColorState.a)this.gl.blendColor(b,
a,c,e),this._blendColorState.r=b,this._blendColorState.g=a,this._blendColorState.b=c,this._blendColorState.a=e,this._stateTracker.invalidateBlending()};b.prototype.setBlendFunction=function(b,a){if(b!==this._blendFunctionState.srcRGB||a!==this._blendFunctionState.dstRGB)this.gl.blendFunc(b,a),this._blendFunctionState.srcRGB=b,this._blendFunctionState.srcAlpha=b,this._blendFunctionState.dstRGB=a,this._blendFunctionState.dstAlpha=a,this._stateTracker.invalidateBlending()};b.prototype.setBlendFunctionSeparate=
function(b,a,c,e){if(this._blendFunctionState.srcRGB!==b||this._blendFunctionState.srcAlpha!==c||this._blendFunctionState.dstRGB!==a||this._blendFunctionState.dstAlpha!==e)this.gl.blendFuncSeparate(b,a,c,e),this._blendFunctionState.srcRGB=b,this._blendFunctionState.srcAlpha=c,this._blendFunctionState.dstRGB=a,this._blendFunctionState.dstAlpha=e,this._stateTracker.invalidateBlending()};b.prototype.setBlendEquation=function(b){this._blendEquationState.mode!==b&&(this.gl.blendEquation(b),this._blendEquationState.mode=
b,this._blendEquationState.modeAlpha=b,this._stateTracker.invalidateBlending())};b.prototype.setBlendEquationSeparate=function(b,a){if(this._blendEquationState.mode!==b||this._blendEquationState.modeAlpha!==a)this.gl.blendEquationSeparate(b,a),this._blendEquationState.mode=b,this._blendEquationState.modeAlpha=a,this._stateTracker.invalidateBlending()};b.prototype.setColorMask=function(b,a,c,e){if(this._colorMaskState.r!==b||this._colorMaskState.g!==a||this._colorMaskState.b!==c||this._colorMaskState.a!==
e)this.gl.colorMask(b,a,c,e),this._colorMaskState.r=b,this._colorMaskState.g=a,this._colorMaskState.b=c,this._colorMaskState.a=e,this._stateTracker.invalidateColorWrite()};b.prototype.setClearColor=function(b,a,c,e){if(this._clearColor.r!==b||this._clearColor.g!==a||this._clearColor.b!==c||this._clearColor.a!==e)this.gl.clearColor(b,a,c,e),this._clearColor.r=b,this._clearColor.g=a,this._clearColor.b=c,this._clearColor.a=e};b.prototype.setFaceCullingEnabled=function(b){this._polygonCullingEnabled!==
b&&(!0===b?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._polygonCullingEnabled=b,this._stateTracker.invalidateCulling())};b.prototype.setPolygonOffsetFillEnabled=function(b){this._polygonOffsetFillEnabled!==b&&(!0===b?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._polygonOffsetFillEnabled=b,this._stateTracker.invalidatePolygonOffset())};b.prototype.setPolygonOffset=function(b,a){if(this._polygonOffset[0]!==b||this._polygonOffset[1]!==
a)this._polygonOffset[0]=b,this._polygonOffset[1]=a,this.gl.polygonOffset(b,a),this._stateTracker.invalidatePolygonOffset()};b.prototype.setCullFace=function(b){this._cullFace!==b&&(this.gl.cullFace(b),this._cullFace=b,this._stateTracker.invalidateCulling())};b.prototype.setFrontFace=function(b){this._frontFace!==b&&(this.gl.frontFace(b),this._frontFace=b,this._stateTracker.invalidateCulling())};b.prototype.setScissorTestEnabled=function(b){this._scissorTestEnabled!==b&&(!0===b?this.gl.enable(this.gl.SCISSOR_TEST):
this.gl.disable(this.gl.SCISSOR_TEST),this._scissorTestEnabled=b)};b.prototype.setScissorRect=function(b,a,c,e){if(this._scissorRect.x!==b||this._scissorRect.y!==a||this._scissorRect.width!==c||this._scissorRect.height!==e)this.gl.scissor(b,a,c,e),this._scissorRect.x=b,this._scissorRect.y=a,this._scissorRect.width=c,this._scissorRect.height=e};b.prototype.setDepthTestEnabled=function(b){this._depthTestEnabled!==b&&(!0===b?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._depthTestEnabled=
b,this._stateTracker.invalidateDepthTest())};b.prototype.setClearDepth=function(b){this._clearDepth!==b&&(this.gl.clearDepth(b),this._clearDepth=b)};b.prototype.setDepthFunction=function(b){this._depthFunction!==b&&(this.gl.depthFunc(b),this._depthFunction=b,this._stateTracker.invalidateDepthTest())};b.prototype.setDepthWriteEnabled=function(b){this._depthWriteEnabled!==b&&(this.gl.depthMask(b),this._depthWriteEnabled=b,this._stateTracker.invalidateDepthWrite())};b.prototype.setDepthRange=function(b,
a){if(this._depthRange.zNear!==b||this._depthRange.zFar!==a)this.gl.depthRange(b,a),this._depthRange.zNear=b,this._depthRange.zFar=a,this._stateTracker.invalidateDepthWrite()};b.prototype.setStencilTestEnabled=function(b){this._stencilTestEnabled!==b&&(!0===b?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._stencilTestEnabled=b,this._stateTracker.invalidateStencilTest())};b.prototype.setClearStencil=function(b){b!==this._clearStencil&&(this.gl.clearStencil(b),this._clearStencil=
b)};b.prototype.setStencilFunction=function(b,a,c){if(this._stencilFunction.func!==b||this._stencilFunction.ref!==a||this._stencilFunction.mask!==c)this.gl.stencilFunc(b,a,c),this._stencilFunction.face=1032,this._stencilFunction.func=b,this._stencilFunction.ref=a,this._stencilFunction.mask=c,this._stateTracker.invalidateStencilTest()};b.prototype.setStencilFunctionSeparate=function(b,a,c,e){if(this._stencilFunction.face!==b||this._stencilFunction.func!==a||this._stencilFunction.ref!==c||this._stencilFunction.mask!==
e)this.gl.stencilFuncSeparate(b,a,c,e),this._stencilFunction.face=b,this._stencilFunction.func=a,this._stencilFunction.ref=c,this._stencilFunction.mask=e,this._stateTracker.invalidateStencilTest()};b.prototype.setStencilWriteMask=function(b){this._stencilWriteMask!==b&&(this.gl.stencilMask(b),this._stencilWriteMask=b,this._stateTracker.invalidateStencilWrite())};b.prototype.setStencilOp=function(b,a,c){if(this._stencilOperation.fail!==b||this._stencilOperation.zFail!==a||this._stencilOperation.zPass!==
c)this.gl.stencilOp(b,a,c),this._stencilOperation.face=1032,this._stencilOperation.fail=b,this._stencilOperation.zFail=a,this._stencilOperation.zPass=c,this._stateTracker.invalidateStencilTest()};b.prototype.setStencilOpSeparate=function(b,a,c,e){if(this._stencilOperation.face!==b||this._stencilOperation.fail!==a||this._stencilOperation.zFail!==c||this._stencilOperation.zPass!==e)this.gl.stencilOpSeparate(b,a,c,e),this._stencilOperation.face=b,this._stencilOperation.face=b,this._stencilOperation.fail=
a,this._stencilOperation.zFail=c,this._stencilOperation.zPass=e,this._stateTracker.invalidateStencilTest()};b.prototype.setActiveTexture=function(b){var a=this._activeTextureUnit;0<=b&&b!==this._activeTextureUnit&&(this.gl.activeTexture(k.BASE_TEXTURE_UNIT+b),this._activeTextureUnit=b);return a};b.prototype.clear=function(b){b&&this.gl.clear(b)};b.prototype.clearSafe=function(b,a){void 0===a&&(a=255);b&&(b&16384&&this.setColorMask(!0,!0,!0,!0),b&256&&this.setDepthWriteEnabled(!0),b&1024&&this.setStencilWriteMask(a),
this.gl.clear(b))};b.prototype.drawArrays=function(b,a,c){this.gl.drawArrays(b,a,c)};b.prototype.drawElements=function(b,a,c,e){5123===c?this.gl.drawElements(b,a,c,e):5125===c&&this.gl.drawElements(b,a,c,e)};b.prototype.logIno=function(){};Object.defineProperty(b.prototype,"capabilities",{get:function(){return this._capabilities},enumerable:!0,configurable:!0});b.prototype.setViewport=function(b,a,c,e){var d=this._viewport;if(d.x!==b||d.y!==a||d.width!==c||d.height!==e)d.x=b,d.y=a,d.width=c,d.height=
e,this.gl.viewport(b,a,c,e)};b.prototype.getViewport=function(){return{x:this._viewport.x,y:this._viewport.y,width:this._viewport.width,height:this._viewport.height}};b.prototype.bindProgram=function(b){b?this._activeShaderProgram!==b&&(b.initialize(),this.gl.useProgram(b.glName),this._activeShaderProgram=b):(this.gl.useProgram(null),this._activeShaderProgram=null)};b.prototype.bindTexture=function(a,c){void 0===c&&(c=0);-1===b._MAX_TEXTURE_IMAGE_UNITS&&(b._MAX_TEXTURE_IMAGE_UNITS=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS));
(c>=b._MAX_TEXTURE_IMAGE_UNITS||0>c)&&console.error("Input texture unit is out of range of available units!");var d=this._textureUnitMap[c];this.setActiveTexture(c);null==a||null==a.glName?(null!=d&&(this.gl.bindTexture(d.descriptor.target,null),d.setBoundToUnit(c,!1)),this._textureUnitMap[c]=null):d&&d.id===a.id?a.applyChanges():(d&&d.setBoundToUnit(c,!1),this.gl.bindTexture(a.descriptor.target,a.glName),a.setBoundToUnit(c,!0),a.applyChanges(),this._textureUnitMap[c]=a)};b.prototype.bindFramebuffer=
function(b){m.isNone(b)?(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this._activeFramebuffer=null):this._activeFramebuffer!==b&&(b.initialize()||this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,b.glName),this._activeFramebuffer=b)};b.prototype.bindBuffer=function(a){a&&(34962===a.bufferType?this._activeVertexBuffer=b._bindBuffer(this.gl,a,a.bufferType,this._activeVertexBuffer):this._activeIndexBuffer=b._bindBuffer(this.gl,a,a.bufferType,this._activeIndexBuffer))};b.prototype.bindRenderbuffer=function(b){var a=
this.gl;b||(a.bindRenderbuffer(a.RENDERBUFFER,null),this._activeRenderbuffer=null);this._activeRenderbuffer!==b&&(a.bindRenderbuffer(a.RENDERBUFFER,b.glName),this._activeRenderbuffer=b)};b.prototype.unbindBuffer=function(a){34962===a?this._activeVertexBuffer=b._bindBuffer(this.gl,null,a,this._activeVertexBuffer):this._activeIndexBuffer=b._bindBuffer(this.gl,null,a,this._activeIndexBuffer)};b.prototype.bindVAO=function(b){b?this._activeVertexArrayObject&&this._activeVertexArrayObject.id===b.id||(b.bind(),
this._activeVertexArrayObject=b):this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null)};b.prototype.getBoundTexture=function(b){return this._textureUnitMap[b]};b.prototype.getBoundFramebufferObject=function(){return this._activeFramebuffer};b.prototype.getBoundVAO=function(){return this._activeVertexArrayObject};b.prototype.resetState=function(){this.bindProgram(null);this.bindVAO(null);this.bindFramebuffer(null);this.unbindBuffer(34962);this.unbindBuffer(34963);
for(var b=0;b<this.parameters.maxTextureImageUnits;b++)this.bindTexture(null,b);this.setBlendingEnabled(!1);this.setBlendFunction(1,0);this.setBlendEquation(32774);this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);this.setCullFace(1029);this.setFrontFace(2305);this.setPolygonOffsetFillEnabled(!1);this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(513);this.setDepthRange(0,
1);this.setStencilTestEnabled(!1);this.setStencilFunction(519,0,0);this.setStencilOp(7680,7680,7680);this.setClearColor(0,0,0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)};b.prototype.enforceState=function(){var b=this.gl,a=this.capabilities.vao;a&&a.bindVertexArray(null);for(var c=0;c<this.parameters.maxVertexAttributes;c++)b.disableVertexAttribArray(c);
this._activeVertexBuffer?b.bindBuffer(this._activeVertexBuffer.bufferType,this._activeVertexBuffer.glName):b.bindBuffer(34962,null);this._activeIndexBuffer?b.bindBuffer(this._activeIndexBuffer.bufferType,this._activeIndexBuffer.glName):b.bindBuffer(34963,null);if(a&&this._activeVertexArrayObject){if(a=this._activeVertexArrayObject)this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null;this.bindVAO(a)}b.bindFramebuffer(b.FRAMEBUFFER,this._activeFramebuffer?this._activeFramebuffer.glName:
null);b.useProgram(this._activeShaderProgram?this._activeShaderProgram.glName:null);b.blendColor(this._blendColorState.r,this._blendColorState.g,this._blendColorState.b,this._blendColorState.a);b.bindRenderbuffer(b.RENDERBUFFER,this._activeRenderbuffer?this._activeRenderbuffer.glName:null);!0===this._blendEnabled?b.enable(this.gl.BLEND):b.disable(this.gl.BLEND);b.blendEquationSeparate(this._blendEquationState.mode,this._blendEquationState.modeAlpha);b.blendFuncSeparate(this._blendFunctionState.srcRGB,
this._blendFunctionState.dstRGB,this._blendFunctionState.srcAlpha,this._blendFunctionState.dstAlpha);b.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a);b.clearDepth(this._clearDepth);b.clearStencil(this._clearStencil);b.colorMask(this._colorMaskState.r,this._colorMaskState.g,this._colorMaskState.b,this._colorMaskState.a);b.cullFace(this._cullFace);b.depthFunc(this._depthFunction);b.depthRange(this._depthRange.zNear,this._depthRange.zFar);!0===this._depthTestEnabled?
b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST);b.depthMask(this._depthWriteEnabled);b.frontFace(this._frontFace);b.lineWidth(1);!0===this._polygonCullingEnabled?b.enable(b.CULL_FACE):b.disable(b.CULL_FACE);b.polygonOffset(this._polygonOffset[0],this._polygonOffset[1]);!0===this._polygonOffsetFillEnabled?b.enable(b.POLYGON_OFFSET_FILL):b.disable(b.POLYGON_OFFSET_FILL);b.scissor(this._scissorRect.x,this._scissorRect.y,this._scissorRect.width,this._scissorRect.height);!0===this._scissorTestEnabled?b.enable(b.SCISSOR_TEST):
b.disable(b.SCISSOR_TEST);b.stencilFunc(this._stencilFunction.func,this._stencilFunction.ref,this._stencilFunction.mask);b.stencilOpSeparate(this._stencilOperation.face,this._stencilOperation.fail,this._stencilOperation.zFail,this._stencilOperation.zPass);!0===this._stencilTestEnabled?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST);b.stencilMask(this._stencilWriteMask);for(a=0;a<this.parameters.maxTextureImageUnits;a++)b.activeTexture(k.BASE_TEXTURE_UNIT+a),b.bindTexture(3553,null),(c=this._textureUnitMap[a])&&
b.bindTexture(c.descriptor.target,c.glName);b.activeTexture(k.BASE_TEXTURE_UNIT+this._activeTextureUnit);b.viewport(this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height)};b._bindBuffer=function(b,a,c,e){if(!a)return b.bindBuffer(c,null),null;if(e===a)return e;b.bindBuffer(c,a.glName);return a};b._MAX_TEXTURE_IMAGE_UNITS=-1;return b}()})},"esri/views/webgl/enums":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});a.BASE_TEXTURE_UNIT=
33984})},"esri/views/webgl/InstanceCounter":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){this._current=[];this._max=[];for(this._allocations=new Map;6>this._current.length;)this._current.push(0),this._max.push(0)}a.prototype.increment=function(a,e){e=++this._current[a];this._max[a]=Math.max(e,this._max[a])};a.prototype.decrement=function(a,e){--this._current[a]};Object.defineProperty(a.prototype,"max",{get:function(){return this._max},
enumerable:!0,configurable:!0});a.prototype.printResourceCount=function(){console.log("Live objects:");console.log("Textures: "+this._current[0]);console.log("Buffers: "+this._current[1]);console.log("VAOs: "+this._current[2]);console.log("Programs: "+this._current[3]);console.log("Framebuffers: "+this._current[4]);console.log("Renderbuffers: "+this._current[5]);0<this._allocations.size&&(console.log(this._allocations.size+" live object allocations:"),this._allocations.forEach(function(a){return console.log(a)}))};
return a}();a.InstanceCounter=f})},"esri/views/webgl/renderState":function(){define(["require","exports","tslib"],function(f,a,e){function m(b){return A.intern(b)}function k(b){return B.intern(b)}function l(b){return D.intern(b)}function g(b){return C.intern(b)}function c(b){return E.intern(b)}function h(b){return F.intern(b)}function b(b){return I.intern(b)}function d(b){return J.intern(b)}function n(b){return"["+b.join(",")+"]"}function p(b){return b?n([b.srcRgb,b.srcAlpha,b.dstRgb,b.dstAlpha,b.opRgb,
b.opAlpha,b.color.r,b.color.g,b.color.b,b.color.a]):null}function r(b){return b?n([b.face,b.mode]):null}function q(b){return b?n([b.factor,b.units]):null}function x(b){return b?n([b.func]):null}function u(b){return b?n([b.function.func,b.function.ref,b.function.mask,b.operation.fail,b.operation.zFail,b.operation.zPass]):null}function v(b){return b?n([b.zNear,b.zFar]):null}function y(b){return b?n([b.r,b.g,b.b,b.a]):null}function z(b){return b?n([b.mask]):null}Object.defineProperty(a,"__esModule",
{value:!0});a.simpleBlendingParams=function(b,a,d,c){void 0===d&&(d=32774);void 0===c&&(c=[0,0,0,0]);return{srcRgb:b,srcAlpha:b,dstRgb:a,dstAlpha:a,opRgb:d,opAlpha:d,color:{r:c[0],g:c[1],b:c[2],a:c[3]}}};a.separateBlendingParams=function(b,a,d,c,e,g,h){void 0===e&&(e=32774);void 0===g&&(g=32774);void 0===h&&(h=[0,0,0,0]);return{srcRgb:b,srcAlpha:a,dstRgb:d,dstAlpha:c,opRgb:e,opAlpha:g,color:{r:h[0],g:h[1],b:h[2],a:h[3]}}};a.backFaceCullingParams={face:1029,mode:2305};a.defaultDepthWriteParams={zNear:0,
zFar:1};a.defaultColorWriteParams={r:!0,g:!0,b:!0,a:!0};a.makeBlending=m;a.makeCulling=k;a.makePolygonOffset=l;a.makeDepthTest=g;a.makeStencilTest=c;a.makeDepthWrite=h;a.makeColorWrite=b;a.makeStencilWrite=d;a.makePipelineState=function(b){return G.intern(b)};f=function(){function b(b,a){this.makeKey=b;this.makeRef=a;this.interns=new Map}b.prototype.intern=function(b){if(!b)return null;var a=this.makeKey(b),d=this.interns;d.has(a)||d.set(a,this.makeRef(b));return d.get(a)};return b}();var A=new f(p,
function(b){return e.__assign({__tag:"Blending"},b)}),B=new f(r,function(b){return e.__assign({__tag:"Culling"},b)}),D=new f(q,function(b){return e.__assign({__tag:"PolygonOffset"},b)}),C=new f(x,function(b){return e.__assign({__tag:"DepthTest"},b)}),E=new f(u,function(b){return e.__assign({__tag:"StencilTest"},b)}),F=new f(v,function(b){return e.__assign({__tag:"DepthWrite"},b)}),I=new f(y,function(b){return e.__assign({__tag:"ColorWrite"},b)}),J=new f(z,function(b){return e.__assign({__tag:"StencilWrite"},
b)}),G=new f(function(b){return b?n([p(b.blending),r(b.culling),q(b.polygonOffset),x(b.depthTest),u(b.stencilTest),v(b.depthWrite),y(b.colorWrite),z(b.stencilWrite)]):null},function(a){return{blending:m(a.blending),culling:k(a.culling),polygonOffset:l(a.polygonOffset),depthTest:g(a.depthTest),stencilTest:c(a.stencilTest),depthWrite:h(a.depthWrite),colorWrite:b(a.colorWrite),stencilWrite:d(a.stencilWrite)}});f=function(){function b(b){this._stencilWriteInvalid=this._colorWriteInvalid=this._depthWriteInvalid=
this._stencilTestInvalid=this._depthTestInvalid=this._polygonOffsetInvalid=this._cullingInvalid=this._blendingInvalid=this._pipelineInvalid=!0;this._stateSetters=b}b.prototype.setPipeline=function(b){if(this._pipelineInvalid||b!==this._pipeline)this.setBlending(b.blending),this.setCulling(b.culling),this.setPolygonOffset(b.polygonOffset),this.setDepthTest(b.depthTest),this.setStencilTest(b.stencilTest),this.setDepthWrite(b.depthWrite),this.setColorWrite(b.colorWrite),this.setStencilWrite(b.stencilWrite),
this._pipeline=b;this._pipelineInvalid=!1};b.prototype.invalidateBlending=function(){this._pipelineInvalid=this._blendingInvalid=!0};b.prototype.invalidateCulling=function(){this._pipelineInvalid=this._cullingInvalid=!0};b.prototype.invalidatePolygonOffset=function(){this._pipelineInvalid=this._polygonOffsetInvalid=!0};b.prototype.invalidateDepthTest=function(){this._pipelineInvalid=this._depthTestInvalid=!0};b.prototype.invalidateStencilTest=function(){this._pipelineInvalid=this._stencilTestInvalid=
!0};b.prototype.invalidateDepthWrite=function(){this._pipelineInvalid=this._depthWriteInvalid=!0};b.prototype.invalidateColorWrite=function(){this._pipelineInvalid=this._colorWriteInvalid=!0};b.prototype.invalidateStencilWrite=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};b.prototype.setBlending=function(b){this._blending=this.setSubState(b,this._blending,this._blendingInvalid,this._stateSetters.setBlending);this._blendingInvalid=!1};b.prototype.setCulling=function(b){this._culling=
this.setSubState(b,this._culling,this._cullingInvalid,this._stateSetters.setCulling);this._cullingInvalid=!1};b.prototype.setPolygonOffset=function(b){this._polygonOffset=this.setSubState(b,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset);this._polygonOffsetInvalid=!1};b.prototype.setDepthTest=function(b){this._depthTest=this.setSubState(b,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest);this._depthTestInvalid=!1};b.prototype.setStencilTest=
function(b){this._stencilTest=this.setSubState(b,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest);this._stencilTestInvalid=!1};b.prototype.setDepthWrite=function(b){this._depthWrite=this.setSubState(b,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite);this._depthWriteInvalid=!1};b.prototype.setColorWrite=function(b){this._colorWrite=this.setSubState(b,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite);this._colorWriteInvalid=
!1};b.prototype.setStencilWrite=function(b){this._stencilWrite=this.setSubState(b,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite);this._stencilTestInvalid=!1};b.prototype.setSubState=function(b,a,d,c){if(d||b!==a)c(b),this._pipelineInvalid=!0;return b};return b}();a.StateTracker=f})},"esri/views/webgl/capabilities/isWebGL2Context":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});a.default=function(a){return window.WebGL2RenderingContext&&
a instanceof window.WebGL2RenderingContext}})},"esri/views/webgl/capabilities/load":function(){define("require exports ./DisjointTimerQuery ./Instancing ./isWebGL2Context ./LoseContext ./VertexArrayObjects".split(" "),function(f,a,e,m,k,l,g){function c(a,b,d,c,e){if(c&&k.default(a))return!0;if(b[d])return!1;for(b=0;b<e.length;b++)if(a.getExtension(e[b]))return!0;return!1}Object.defineProperty(a,"__esModule",{value:!0});a.loadCapabilities=function(a,b){var d=b&&b.disabledExtensions||{},h=b&&b.debugWebGLExtensions||
{},f,r,q,x,u,v,y,z,A,B=null,D=null,C=null,E=null;return{get instancing(){f||(f=m.load(a));return f},get vao(){r||(r=g.load(a,d));return r},get compressedTextureS3TC(){if(!q)if(d.compressedTextureS3TC)q=null;else{var b=a.getExtension("WEBGL_compressed_texture_s3tc");q=b?{COMPRESSED_RGB_S3TC_DXT1:b.COMPRESSED_RGB_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT1:b.COMPRESSED_RGBA_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT3:b.COMPRESSED_RGBA_S3TC_DXT3_EXT,COMPRESSED_RGBA_S3TC_DXT5:b.COMPRESSED_RGBA_S3TC_DXT5_EXT}:
null}return q},get textureFilterAnisotropic(){if(!x)if(d.textureFilterAnisotropic)x=null;else{var b=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");x=b?{MAX_TEXTURE_MAX_ANISOTROPY:b.MAX_TEXTURE_MAX_ANISOTROPY_EXT,TEXTURE_MAX_ANISOTROPY:b.TEXTURE_MAX_ANISOTROPY_EXT}:null}return x},get disjointTimerQuery(){u||(u=e.load(a,d));return u},get textureFloat(){if(!v)if(k.default(a))v={textureFloat:!0,
textureFloatLinear:!d.textureFloatLinear&&!!a.getExtension("OES_texture_float_linear"),textureHalfFloat:!0,textureHalfFloatLinear:!d.textureHalfFloatLinear&&!!a.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:a.HALF_FLOAT};else if(a instanceof WebGLRenderingContext){var b=!d.textureHalfFloat&&a.getExtension("OES_texture_half_float");v={textureFloat:!d.textureFloat&&!!a.getExtension("OES_texture_float"),textureFloatLinear:!d.textureFloatLinear&&!!a.getExtension("OES_texture_float_linear"),
textureHalfFloat:!!b,textureHalfFloatLinear:!d.textureHalfFloatLinear&&!!a.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:b?b.HALF_FLOAT_OES:void 0}}else v=null;return v},get colorBufferFloat(){if(!y)if(k.default(a)){var b=!d.colorBufferFloat&&a.getExtension("EXT_color_buffer_half_float"),c=!d.colorBufferFloat&&a.getExtension("EXT_color_buffer_float");y=b||c?{textureFloat:!!c,textureHalfFloat:!!b,R16F:a.R16F,RG16F:a.RG16F,RGBA16F:a.RGBA16F,R32F:a.R32F,RG32F:a.RG32F,RGBA32F:a.RGBA32F,R11F_G11F_B10F:a.R11F_G11F_B10F,
RGB16F:a.RGB16F}:null}else a instanceof WebGLRenderingContext?(b=!d.colorBufferFloat&&a.getExtension("EXT_color_buffer_half_float"),c=!d.colorBufferFloat&&a.getExtension("WEBGL_color_buffer_float"),y=b||c?{textureFloat:!!c,textureHalfFloat:!!b,RGBA16F:b?b.RGBA16F_EXT:void 0,RGB16F:b?b.RGB16F_EXT:void 0,RGBA32F:c?c.RGBA32F_EXT:void 0}:null):y=null;return y},get blendMinMax(){if(!z)if(k.default(a))z={MIN:a.MIN,MAX:a.MAX};else if(d.blendMinMax)z=null;else{var b=a.getExtension("EXT_blend_minmax");z=b?
{MIN:b.MIN_EXT,MAX:b.MAX_EXT}:null}return z},get depthTexture(){null===B&&(B=c(a,d,"depthTexture",!0,["WEBGL_depth_texture","MOZ_WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]));return B},get standardDerivatives(){null===D&&(D=c(a,d,"standardDerivatives",!0,["OES_standard_derivatives"]));return D},get shaderTextureLOD(){null===C&&(C=c(a,d,"shaderTextureLOD",!0,["EXT_shader_texture_lod"]));return C},get fragDepth(){null===E&&(E=c(a,d,"fragDepth",!0,["EXT_frag_depth"]));return E},get loseContext(){A||
(A=l.load(a,h));return A}}}})},"esri/views/webgl/capabilities/DisjointTimerQuery":function(){define(["require","exports","./isWebGL2Context"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.load=function(a,f){if(f.disjointTimerQuery)return null;var k=a.getExtension("EXT_disjoint_timer_query")||a.getExtension("EXT_disjoint_timer_query_webgl2");return k?e.default(a)?{createQuery:function(){return a.createQuery()},resultAvailable:function(e){return a.getQueryParameter(e,a.QUERY_RESULT_AVAILABLE)},
getResult:function(e){return a.getQueryParameter(e,a.QUERY_RESULT)},disjoint:function(){return a.getParameter(k.GPU_DISJOINT_EXT)},beginTimeElapsed:function(e){return a.beginQuery(k.TIME_ELAPSED_EXT,e)},endTimeElapsed:function(){return a.endQuery(k.TIME_ELAPSED_EXT)},createTimestamp:function(a){return k.queryCounterEXT(a,k.TIMESTAMP_EXT)},timestampBits:function(){return a.getQuery(k.TIMESTAMP_EXT,k.QUERY_COUNTER_BITS_EXT)}}:{createQuery:function(){return k.createQueryEXT()},resultAvailable:function(a){return k.getQueryObjectEXT(a,
k.QUERY_RESULT_AVAILABLE_EXT)},getResult:function(a){return k.getQueryObjectEXT(a,k.QUERY_RESULT_EXT)},disjoint:function(){return a.getParameter(k.GPU_DISJOINT_EXT)},beginTimeElapsed:function(a){return k.beginQueryEXT(k.TIME_ELAPSED_EXT,a)},endTimeElapsed:function(){return k.endQueryEXT(k.TIME_ELAPSED_EXT)},createTimestamp:function(a){return k.queryCounterEXT(a,k.TIMESTAMP_EXT)},timestampBits:function(){return k.getQueryEXT(k.TIMESTAMP_EXT,k.QUERY_COUNTER_BITS_EXT)}}:null}})},"esri/views/webgl/capabilities/Instancing":function(){define(["require",
"exports","./isWebGL2Context"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.load=function(a){return e.default(a)?{drawArraysInstanced:a.drawArraysInstanced.bind(a),drawElementsInstanced:a.drawElementsInstanced.bind(a),vertexAttribDivisor:a.vertexAttribDivisor.bind(a)}:(a=a.getExtension("ANGLE_instanced_arrays"))?{drawArraysInstanced:a.drawArraysInstancedANGLE.bind(a),drawElementsInstanced:a.drawElementsInstancedANGLE.bind(a),vertexAttribDivisor:a.vertexAttribDivisorANGLE.bind(a)}:
null}})},"esri/views/webgl/capabilities/LoseContext":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});a.load=function(a,f){var e=f.loseContext&&a.getExtension("WEBGL_lose_context");return e?{loseRenderingContext:function(){return e.loseContext()}}:null}})},"esri/views/webgl/capabilities/VertexArrayObjects":function(){define(["require","exports","./isWebGL2Context"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.load=function(a,
f){return e.default(a)?{createVertexArray:a.createVertexArray.bind(a),deleteVertexArray:a.deleteVertexArray.bind(a),bindVertexArray:a.bindVertexArray.bind(a)}:f.vao?null:(a=a.getExtension("OES_vertex_array_object")||a.getExtension("MOZ_OES_vertex_array_object")||a.getExtension("WEBKIT_OES_vertex_array_object"))?{createVertexArray:a.createVertexArrayOES.bind(a),deleteVertexArray:a.deleteVertexArrayOES.bind(a),bindVertexArray:a.bindVertexArrayOES.bind(a)}:null}})},"esri/views/webgl/ShaderCompiler":function(){define(["require",
"exports"],function(f,a){return function(){function a(a){this.readFile=a}a.prototype.resolveIncludes=function(a){return this.resolve(a)};a.prototype.resolve=function(a,e){var f=this;void 0===e&&(e=new Map);if(e.has(a))return e.get(a);var g=this.read(a);if(!g)throw Error("cannot find shader file "+a);for(var c=/^[^\S\n]*#include\s+<(\S+)>[^\S\n]?/gm,h=c.exec(g),b=[];null!=h;)b.push({path:h[1],start:h.index,length:h[0].length}),h=c.exec(g);var d=0,n="";b.forEach(function(b){n+=g.slice(d,b.start);n+=
e.has(b.path)?"":f.resolve(b.path,e);d=b.start+b.length});n+=g.slice(d);e.set(a,n);return n};a.prototype.read=function(a){return this.readFile(a)};return a}()})},"esri/views/webgl/VertexArrayObject":function(){define(["require","exports","../../core/has","./Util"],function(f,a,e,m){return function(){function a(e,g,c,h,b){this._locations=this._layout=this._glName=this._context=null;this._indexBuffer=this._buffers=void 0;this._initialized=!1;this._context=e;this._layout=c;this._buffers=h;this._locations=
g;b&&(this._indexBuffer=b);this._id=a._nextId++}Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"vertexBuffers",{get:function(){return this._buffers},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"indexBuffer",{get:function(){return this._indexBuffer},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"size",{get:function(){var a=this;return Object.keys(this._buffers).reduce(function(e,c){return e+a._buffers[c].size},this._indexBuffer?this._indexBuffer.size:0)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"layout",{get:function(){return this._layout},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0});a.prototype.dispose=function(a){void 0===a&&
(a=!0);if(this._context){var e=this._context.capabilities.vao;e&&this._glName&&(e.deleteVertexArray(this._glName),this._glName=null);this._context.getBoundVAO()===this&&this._context.bindVAO(null);if(a){for(var c in this._buffers)this._buffers[c].dispose(),delete this._buffers[c];this._indexBuffer&&(this._indexBuffer.dispose(),this._indexBuffer=null)}this._context=null}};a.prototype.initialize=function(){if(!this._initialized){var a=this._context.capabilities.vao;if(a){var e=a.createVertexArray();
a.bindVertexArray(e);this._bindLayout();a.bindVertexArray(null);this._glName=e}this._initialized=!0}};a.prototype.bind=function(){this.initialize();var a=this._context.capabilities.vao;a?a.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())};a.prototype._bindLayout=function(){var a=this._buffers,e=!!this._context.capabilities.vao,c=this._layout,h=this._indexBuffer;a||console.error("Vertex buffer dictionary is empty!");var b=this._context.gl,d;for(d in a){var f=a[d];f||console.error("Vertex buffer is uninitialized!");
var k=c[d];k||console.error("Vertex element descriptor is empty!");m.bindVertexBufferLayout(this._context,this._locations,f,k)}h&&(e?b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,h.glName):this._context.bindBuffer(h))};a.prototype.unbind=function(){this.initialize();var a=this._context.capabilities.vao;a?a.bindVertexArray(null):this._unbindLayout()};a.prototype._unbindLayout=function(){var a=this._buffers,e=this._layout;a||console.error("Vertex buffer dictionary is empty!");for(var c in a){var h=a[c];h||console.error("Vertex buffer is uninitialized!");
m.unbindVertexBufferLayout(this._context,this._locations,h,e[c])}(a=this._indexBuffer)&&this._context.unbindBuffer(a.bufferType)};a._nextId=0;return a}()})},"esri/views/webgl/Util":function(){define(["require","exports","tslib","../../core/compilerUtils","../../core/maybe"],function(f,a,e,m,k){function l(b){return b[0].stride}function g(b){switch(b){case 5126:return 4;case 5124:return 4;case 5125:return 4;case 5122:return 2;case 5123:return 2;case 5120:return 1;case 5121:return 1;default:throw m.neverReached(b),
Error("Unknown data type");}}function c(b){switch(b){case 6406:case 6409:return 1;case 6410:return 2;case 6407:return 3;case 6408:return 4;case 34041:return 4;case 33325:return 2;case 33326:return 4;case 35898:return 4;case 33327:return 4;case 33328:return 8;case 34842:return 8;case 34836:return 16;case 33189:return 2;case 34041:return 4;case 32854:return 2;case 36168:return 1;default:m.neverReached(b)}return 0}function h(b){if(k.isNone(b))return 0;if("colorAttachment"in b)return b.glName?h(b.colorAttachment)+
h(b.depthStencilAttachment):0;if("descriptor"in b)return b.glName?h(b.descriptor):0;var a=b.internalFormat||"pixelFormat"in b&&b.pixelFormat;if(!a)return 0;var e="hasMipmap"in b&&b.hasMipmap?1.3:1;b=b.width*b.height;return c(a)*b*e}Object.defineProperty(a,"__esModule",{value:!0});a.vertexCount=function(b,a){return b.vertexBuffers[a].size/l(b.layout[a])};a.getStride=l;a.getBytesPerElement=g;a.getTypedArrayConstructor=function(b){switch(b){case 5120:return Int8Array;case 5126:return Float32Array;case 5124:return Int32Array;
case 5122:return Int16Array;case 5121:return Uint8Array;case 5125:return Uint32Array;case 5123:return Uint16Array;default:throw m.neverReached(b),Error("Unknown data type");}};a.addDescriptor=function(b,a,c,e,h,f){var d=g(e);if(0<b.length){var n=b[0].stride,k=n+d*c;b.forEach(function(b){return b.stride=k});b.push({name:a,count:c,type:e,offset:n,stride:k,normalized:h,divisor:f})}else b.push({name:a,count:c,type:e,offset:0,stride:d*c,normalized:h,divisor:f})};a.hasAttribute=function(b,a){for(var d=
0;d<b.length;d++)if(b[d].name===a)return!0;return!1};a.findAttribute=function(b,a){for(var d=0;d<b.length;d++)if(b[d].name===a)return b[d];return null};a.copyFramebufferToTexture=function(b,a,c,e,g){void 0===g&&(g=0);var d=b.getBoundFramebufferObject(),h=b.getBoundTexture(0);b.bindFramebuffer(a);b.bindTexture(c,0);b.gl.copyTexImage2D(b.gl.TEXTURE_2D,g,c.descriptor.pixelFormat,e[0],e[1],e[2],e[3],0);b.gl.flush();b.bindFramebuffer(d);b.bindTexture(h,0)};a.setBaseInstanceOffset=function(b,a){var d={},
c;for(c in b)d[c]=b[c].map(function(b){return b.divisor?e.__assign(e.__assign({},b),{baseInstance:a}):b});return d};a.bindVertexBufferLayout=function(b,a,c,e,g){var d=b.gl,h=b.capabilities.instancing;b.bindBuffer(c);for(b=0;b<e.length;b++){c=e[b];var f=a[c.name],n=(g?g:0+c.baseInstance?c.baseInstance:0)*c.stride;void 0===f&&console.error("There is no location for vertex attribute '"+c.name+"' defined.");c.baseInstance&&!c.divisor&&console.error("Vertex attribute '"+c.name+"' uses baseInstanceOffset without divisor.");
if(4>=c.count)d.vertexAttribPointer(f,c.count,c.type,c.normalized,c.stride,c.offset+n),d.enableVertexAttribArray(f),c.divisor&&0<c.divisor&&h&&h.vertexAttribDivisor(f,c.divisor);else if(9===c.count)for(var k=0;3>k;k++)d.vertexAttribPointer(f+k,3,c.type,c.normalized,c.stride,c.offset+12*k+n),d.enableVertexAttribArray(f+k),c.divisor&&0<c.divisor&&h&&h.vertexAttribDivisor(f+k,c.divisor);else if(16===c.count)for(k=0;4>k;k++)d.vertexAttribPointer(f+k,4,c.type,c.normalized,c.stride,c.offset+16*k+n),d.enableVertexAttribArray(f+
k),c.divisor&&0<c.divisor&&h&&h.vertexAttribDivisor(f+k,c.divisor);else console.error("Unsupported vertex attribute element count: "+c.count)}};a.unbindVertexBufferLayout=function(b,a,c,e){var d=b.gl,g=b.capabilities.instancing;b.bindBuffer(c);for(c=0;c<e.length;c++){var h=e[c],f=a[h.name];if(4>=h.count)d.disableVertexAttribArray(f),h.divisor&&0<h.divisor&&g&&g.vertexAttribDivisor(f,0);else if(9===h.count)for(var n=0;3>n;n++)d.disableVertexAttribArray(f+n),h.divisor&&0<h.divisor&&g&&g.vertexAttribDivisor(f+
n,0);else if(16===h.count)for(n=0;4>n;n++)d.disableVertexAttribArray(f+n),h.divisor&&0<h.divisor&&g&&g.vertexAttribDivisor(f+n,0);else console.error("Unsupported vertex attribute element count: "+h.count)}b.unbindBuffer(34962)};a.getBytesPerElementFormat=c;a.getGpuMemoryUsage=h})},"esri/views/webgl/ProgramCache":function(){define(["require","exports","./programUtils"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(a){this._programCacheByTemplate=new Map;this._rctx=
a}a.prototype.dispose=function(){this._programCacheByTemplate.forEach(function(a){a.programs.forEach(function(a){a.dispose()})});this._programCacheByTemplate=null};a.prototype.getProgram=function(a,f){var g=this;this._programCacheByTemplate.has(a)||this.addProgramTemplate(a,function(c){return e.createProgram(g._rctx,a,c)});return this.getProgramTemplateInstance(a,f)};a.prototype.addProgramTemplate=function(a,e){this._programCacheByTemplate.set(a,{constructor:e,programs:new Map})};a.prototype.getProgramTemplateInstance=
function(a,e){if(a=this._programCacheByTemplate.get(a)){var g=e?JSON.stringify(e):"default";a.programs.has(g)||(e=a.constructor(e),a.programs.set(g,e));return a.programs.get(g)}return null};return a}();a.ProgramCache=f})},"esri/views/webgl/programUtils":function(){define(["require","exports","./Program"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.glslifyDefineMap=function(a){var e="",f;for(f in a){var g=a[f];if("boolean"===typeof g)g&&(e+="#define "+f+"\n");else if("number"===
typeof g)e+="#define "+f+" "+g.toFixed()+"\n";else if("object"===typeof g){var c=g.options,h=0,b;for(b in c)e+="#define "+c[b]+" "+(h++).toFixed()+"\n";e+="#define "+f+" "+c[g.value]+"\n"}}return e};a.createProgram=function(a,f,l,g){l=l||{};g=g||"";l="function"===typeof f.shaders?f.shaders(l):f.shaders;return new e(a,g+l.vertexShader,g+l.fragmentShader,f.attributes)}})},"esri/views/2d/engine/DisplayObject":function(){define(["require","exports","tslib","../../../core/Evented"],function(f,a,e,m){Object.defineProperty(a,
"__esModule",{value:!0});f=function(a){function f(){var e=null!==a&&a.apply(this,arguments)||this;e._clips=null;e._isReady=!1;e._opacity=1;e._stage=null;e._visible=!0;return e}e.__extends(f,a);Object.defineProperty(f.prototype,"clips",{get:function(){return this._clips},set:function(a){this._clips=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"isReady",{get:function(){return this._isReady},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,
"opacity",{get:function(){return this._opacity},set:function(a){this._opacity!==a&&(this._opacity=a,this.requestRender())},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"stage",{get:function(){return this._stage},set:function(a){if(this._stage!==a){var c=this._stage;(this._stage=a)?this._stage.untrashDisplayObject(this)||(this.onAttach(),this.emit("attach")):c.trashDisplayObject(this)}},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"visible",{get:function(){return this._visible},
set:function(a){this._visible!==a&&(this._visible=a,this.requestRender())},enumerable:!0,configurable:!0});f.prototype.setTransform=function(a){};f.prototype.processRender=function(a){this.visible&&this.stage&&this.doRender(a)};f.prototype.requestRender=function(){this.stage&&this.stage.requestRender()};f.prototype.processDetach=function(){this.onDetach();this.emit("detach")};f.prototype.onAttach=function(){};f.prototype.onDetach=function(){};f.prototype.doRender=function(a){};f.prototype.ready=function(){this._isReady||
(this._isReady=!0,this.emit("isReady"),this.requestRender())};return f}(m);a.DisplayObject=f})},"esri/views/2d/engine/ImageryBitmapSource":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(a,e,f){this.pixelBlock=a;this.extent=e;this.originalPixelBlock=f}Object.defineProperty(a.prototype,"width",{get:function(){return this.pixelBlock?this.pixelBlock.width:0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"height",{get:function(){return this.pixelBlock?this.pixelBlock.height:0},enumerable:!0,configurable:!0});a.prototype.render=function(a){var e=this.pixelBlock;if(e){var f=this.filter({pixelBlock:e}),e=f.pixelBlock.getAsRGBA(),f=a.createImageData(f.pixelBlock.width,f.pixelBlock.height);f.data.set(e);a.putImageData(f,0,0)}};a.prototype.getRenderedRasterPixels=function(){var a=this.filter({pixelBlock:this.pixelBlock});return{width:a.pixelBlock.width,height:a.pixelBlock.height,renderedRasterPixels:new Uint8Array(a.pixelBlock.getAsRGBA().buffer)}};
return a}();a.default=f})},"esri/views/2d/engine/BitmapContainer":function(){define(["require","exports","tslib","../engine","./webgl/WGLContainer"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function g(){return null!==a&&a.apply(this,arguments)||this}e.__extends(g,a);g.prototype.prepareRenderPasses=function(c){var g=this,b=c.registerRenderPass({name:"bitmap",brushes:[m.brushes.Bitmap],target:function(){return g.children}});return e.__spreadArrays(a.prototype.prepareRenderPasses.call(this,
c),[b])};g.prototype.createRenderParams=function(c){return e.__assign(e.__assign({},a.prototype.createRenderParams.call(this,c)),{blendMode:this.blendMode})};return g}(k.default);a.BitmapContainer=f})},"esri/views/2d/engine/webgl/WGLContainer":function(){define("require exports tslib ../../../../core/maybe ../../engine ../Container ./ClippingInfo ./enums".split(" "),function(f,a,e,m,k,l,g,c){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||
this;b._lastTime=null;b.name=b.constructor.name;return b}e.__extends(b,a);Object.defineProperty(b.prototype,"clips",{set:function(b){this._clips=b;this.children.forEach(function(a){return a.clips=b});this._updateClippingInfo()},enumerable:!0,configurable:!0});b.prototype.doRender=function(b){var a=this.createRenderParams(b),d=a.painter,e=a.globalOpacity,g=a.profiler,e=a.drawPhase===c.WGLDrawPhase.LABEL?1:e*this.opacity;g.recordContainerStart(this.name);d.beforeRenderLayer(a,this._clippingInfos?255:
0,e);this.updateTransforms(b.state);this.renderChildren(a);d.compositeLayer(a,e);g.recordContainerEnd()};b.prototype.renderChildren=function(b){m.isNone(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(this.stage.painter));for(var a=0,d=this._renderPasses;a<d.length;a++)d[a].render(b)};b.prototype.createRenderParams=function(b){var a=Date.now(),d=(m.isSome(this._lastTime)?a-this._lastTime:0)/1E3;this._lastTime=a;return e.__assign(e.__assign({},b),{context:this.stage.context,painter:this.stage.painter,
profiler:this.stage.profiler,renderingOptions:this.stage.renderingOptions,driverTestResult:this.stage.driverTestResult,timeDelta:d,timeline:this.stage.timeline})};b.prototype.prepareRenderPasses=function(b){var a=this;return[b.registerRenderPass({name:"clip",brushes:[k.brushes.Clip],target:function(){return a._clippingInfos},drawPhase:c.WGLDrawPhase.MAP|c.WGLDrawPhase.LABEL|c.WGLDrawPhase.LABEL_ALPHA|c.WGLDrawPhase.DEBUG})]};b.prototype.updateTransforms=function(b){for(var a=0,d=this.children;a<d.length;a++)d[a].setTransform(b)};
b.prototype.onAttach=function(){a.prototype.onAttach.call(this);this._updateClippingInfo()};b.prototype.onDetach=function(){a.prototype.onDetach.call(this);this._updateClippingInfo()};b.prototype._updateClippingInfo=function(){var b=this;m.isSome(this._clippingInfos)&&(this._clippingInfos.forEach(function(b){return b.destroy()}),this._clippingInfos=null);if(this.stage){var a=this._clips;m.isSome(a)&&a.length&&(this._clippingInfos=a.items.map(function(a){return g.default.fromClipArea(b.stage,a)}));
this.requestRender()}};return b}(l.Container);a.default=f})},"esri/views/2d/engine/Container":function(){define(["require","exports","tslib","./DisplayObject"],function(f,a,e,m){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function f(){var e=null!==a&&a.apply(this,arguments)||this;e._childrenSet=new Set;e.children=[];return e}e.__extends(f,a);Object.defineProperty(f.prototype,"blendMode",{get:function(){return this._blendMode},set:function(a){this._blendMode=a;this.requestRender()},
enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"clips",{get:function(){return this._clips},set:function(a){this._clips=a;this.children.forEach(function(c){return c.clips=a})},enumerable:!0,configurable:!0});f.prototype.doRender=function(a){a=this.createRenderParams(a);this.renderChildren(a)};f.prototype.addChild=function(a){return this.addChildAt(a,this.children.length)};f.prototype.addChildAt=function(a,c){void 0===c&&(c=this.children.length);if(!a||this.contains(a))return a;var e=
a.parent;e&&e!==this&&e.removeChild(a);c>=this.children.length?this.children.push(a):this.children.splice(c,0,a);this._childrenSet.add(a);a.parent=this;a.stage=this.stage;this!==this.stage&&(a.clips=this.clips);this.requestRender();return a};f.prototype.contains=function(a){return this._childrenSet.has(a)};f.prototype.removeAllChildren=function(){this._childrenSet.clear();for(var a=0,c=this.children;a<c.length;a++){var e=c[a];this!==this.stage&&(e.clips=null);e.stage=null;e.parent=null}this.children.length=
0};f.prototype.removeChild=function(a){return this.contains(a)?this.removeChildAt(this.children.indexOf(a)):a};f.prototype.removeChildAt=function(a){if(0>a||a>=this.children.length)return null;a=this.children.splice(a,1)[0];this._childrenSet.delete(a);this!==this.stage&&(a.clips=null);a.stage=null;a.parent=null;return a};f.prototype.sortChildren=function(a){return this.children.sort(a)};f.prototype.onAttach=function(){a.prototype.onAttach.call(this);for(var e=this.stage,c=0,h=this.children;c<h.length;c++)h[c].stage=
e};f.prototype.onDetach=function(){a.prototype.onDetach.call(this);for(var e=0,c=this.children;e<c.length;e++)c[e].stage=null};f.prototype.renderChildren=function(a){for(var c=this.children,e=c.length,b=0;b<e;b++)c[b].processRender(a)};f.prototype.createRenderParams=function(a){return e.__assign(e.__assign({},a),{blendMode:this.blendMode,globalOpacity:a.globalOpacity*this.opacity})};return f}(m.DisplayObject);a.Container=f})},"esri/views/2d/engine/webgl/ClippingInfo":function(){define("require exports tslib ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../DisplayObject ./Mesh2D ../../../webgl/VertexArrayObject".split(" "),
function(f,a,e,m,k,l,g,c,h){Object.defineProperty(a,"__esModule",{value:!0});var b=k.getLogger("esri.views.2d.engine.webgl.ClippingInfo");f=function(a){function d(b,d){var c=a.call(this)||this;c._clip=d;c._cache={};c.stage=b;c._handle=d.watch("version",function(){return c._invalidate()});c.ready();return c}e.__extends(d,a);d.fromClipArea=function(b,a){return new d(b,a)};d.prototype._destroyGL=function(){l.isSome(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null);l.isSome(this._cache.vao)&&
(this._cache.vao.dispose(),this._cache.vao=null)};d.prototype.destroy=function(){this._destroyGL();this._handle.remove()};d.prototype.getVAO=function(b,a,d,c){var e=a.size,g=e[0],e=e[1];if("geometry"===this._clip.type||this._lastWidth!==g||this._lastHeight!==e)this._lastWidth=g,this._lastHeight=e,this._destroyGL();l.isNone(this._cache.vao)&&(a=this._createMesh(a,this._clip),g=a.getIndexBuffer(b),e=a.getVertexBuffers(b),this._cache.mesh=a,this._cache.vao=new h(b,d,c,e,g));return this._cache.vao};d.prototype._invalidate=
function(){this._destroyGL();this.requestRender()};d.prototype._createScreenRect=function(b,a){var d=b.size;b=d[0];var d=d[1],c="string"===typeof a.left?parseFloat(a.left)/100*b:a.left,e="string"===typeof a.right?parseFloat(a.right)/100*b:a.right,g="string"===typeof a.top?parseFloat(a.top)/100*d:a.top;a="string"===typeof a.bottom?parseFloat(a.bottom)/100*d:a.bottom;return{x:c,y:g,width:Math.max(b-e-c,0),height:Math.max(d-a-g,0)}};d.prototype._createMesh=function(a,d){switch(d.type){case "rect":return c.default.fromRect(this._createScreenRect(a,
d));case "path":return c.default.fromPath(d);case "geometry":return c.default.fromGeometry(a,d);default:return b.error(new m("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),c.default.fromRect({x:0,y:0,width:1,height:1})}};return d}(g.DisplayObject);a.default=f})},"esri/views/2d/engine/webgl/Mesh2D":function(){define("require exports tslib ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/libs/earcut/earcut ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./number ../../../webgl/BufferObject".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p){Object.defineProperty(a,"__esModule",{value:!0});var r=k.getLogger("esri.views.2d.engine.webgl.Mesh2D"),q=function(b,a){var d=b.coords;b=b.lengths;for(var c=[],e=0,h=0;e<b.length;h+=b[e],e+=1){for(var f=h,n=[];e<b.length-1;e+=1,h+=b[e]){for(var k=h+b[e],l=0,p=1;p<b[e+1];p++)l+=(d[2*(k+p)]-d[2*(k+p-1)])*(d[2*(k+p)+1]+d[2*(k+p-1)+1]);if(!(a?0<l:0>l))break;n.push(h+b[e]-f)}l=d.slice(2*f,2*(h+b[e]));k=0;for(n=g.earcut(l,n,2);k<n.length;k++)c.push(n[k]+f)}return c};
f=function(){function a(b,a,d,c){void 0===c&&(c=!1);this._cache={};this.vertices=b;this.indices=a;this.primitiveType=d;this.isMapSpace=c}a.fromRect=function(b){var d=b.x,c=b.y;return a.fromScreenExtent({xmin:d,ymin:c,xmax:d+b.width,ymax:c+b.height})};a.fromPath=function(c){var e=b.convertFromNestedArray(new d.default,c.path,!1,!1);c=e.coords;for(var e=new Uint32Array(q(e,!0)),g=new Uint32Array(c.length/2),h=0;h<g.length;h++)g[h]=n.i1616to32(Math.floor(c[2*h]),Math.floor(c[2*h+1]));return new a({geometry:g},
e,4)};a.fromGeometry=function(b,d){var c=d.geometry.type;switch(c){case "polygon":return a.fromPolygon(b,d.geometry);case "extent":return a.fromMapExtent(b,d.geometry);default:return r.error(new m("mapview-bad-type","Unable to create a mesh from type "+c,d)),a.fromRect({x:0,y:0,width:1,height:1})}};a.fromPolygon=function(e,g){var f=b.convertFromPolygon(new d.default,g,!1,!1);g=f.coords;for(var f=new Uint32Array(q(f,!1)),k=new Uint32Array(g.length/2),l=h.vec2f64.create(),p=h.vec2f64.create(),u=0;u<
k.length;u++)c.vec2.set(l,g[2*u],g[2*u+1]),e.toScreen(p,l),k[u]=n.i1616to32(Math.floor(p[0]),Math.floor(p[1]));return new a({geometry:k},f,4,!0)};a.fromScreenExtent=function(b){var d=b.xmin,c=b.xmax,e=b.ymin;b=b.ymax;d={geometry:new Uint32Array([n.i1616to32(d,e),n.i1616to32(c,e),n.i1616to32(d,b),n.i1616to32(d,b),n.i1616to32(c,e),n.i1616to32(c,b)])};c=new Uint32Array([0,1,2,3,4,5]);return new a(d,c,4)};a.fromMapExtent=function(b,d){var c=b.toScreen([0,0],[d.xmin,d.ymin]),e=c[0],c=c[1];d=b.toScreen([0,
0],[d.xmax,d.ymax]);b=d[0];d=d[1];e={geometry:new Uint32Array([n.i1616to32(e,c),n.i1616to32(b,c),n.i1616to32(e,d),n.i1616to32(e,d),n.i1616to32(b,c),n.i1616to32(b,d)])};c=new Uint32Array([0,1,2,3,4,5]);return new a(e,c,4)};a.prototype.destroy=function(){l.isSome(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(var b in this._cache.vertexBuffers)l.isSome(this._cache.vertexBuffers[b])&&this._cache.vertexBuffers[b].dispose()};Object.defineProperty(a.prototype,"elementType",{get:function(){var b;
a:switch(this.indices.BYTES_PER_ELEMENT){case 1:b=5121;break a;case 2:b=5123;break a;case 4:b=5125;break a;default:throw new m("Cannot get DataType of array");}return b},enumerable:!0,configurable:!0});a.prototype.getIndexBuffer=function(b,a){void 0===a&&(a=35044);this._cache.indexBuffer||(this._cache.indexBuffer=p.createIndex(b,a,this.indices));return this._cache.indexBuffer};a.prototype.getVertexBuffers=function(b,a){var d=this;void 0===a&&(a=35044);this._cache.vertexBuffers||(this._cache.vertexBuffers=
Object.keys(this.vertices).reduce(function(c,g){var h;return e.__assign(e.__assign({},c),(h={},h[g]=p.createVertex(b,a,d.vertices[g]),h))},{}));return this._cache.vertexBuffers};return a}();a.default=f})},"esri/views/2d/engine/webgl/number":function(){define(["require","exports"],function(f,a){function e(a,e,c){return Math.round(Math.max(Math.min(a,c),e))}Object.defineProperty(a,"__esModule",{value:!0});var m=new Float32Array(1),k=new Uint32Array(m.buffer);a.i8=function(a){return e(a,-128,127)};a.i16=
function(a){return e(a,-32768,32767)};a.i32=function(a){return e(a,-2147483648,2147483647)};a.u8=function(a){return e(a,0,255)};a.u16=function(a){return e(a,0,65535)};a.u32=function(a){return e(a,0,4294967295)};a.toUint32=function(a){m[0]=a;return k[0]};a.toFloat32=function(a){k[0]=a;return m[0]};a.u32to4Xu8=function(a){return[a&255,(a&65280)>>>8,(a&16711680)>>>16,(a&4278190080)>>>24]};a.i1616to32=function(a,e){return 65535&a|e<<16};a.i8888to32=function(a,e,c,h){return a&255|(e&255)<<8|(c&255)<<16|
h<<24};a.i8816to32=function(a,e,c){return a&255|(e&255)<<8|c<<16};a.numTo32=function(a){return a|0}})},"esri/views/2d/engine/webgl/enums":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});(function(a){a[a.FILL=0]="FILL";a[a.LINE=1]="LINE";a[a.MARKER=2]="MARKER";a[a.TEXT=3]="TEXT";a[a.LABEL=4]="LABEL"})(a.WGLGeometryType||(a.WGLGeometryType={}));(function(a){a[a.SUCCEEDED=0]="SUCCEEDED";a[a.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(a.WGLGeometryTransactionStatus||
(a.WGLGeometryTransactionStatus={}));(function(a){a[a.NONE=0]="NONE";a[a.MAP=1]="MAP";a[a.LABEL=2]="LABEL";a[a.LABEL_ALPHA=4]="LABEL_ALPHA";a[a.HITTEST=8]="HITTEST";a[a.HIGHLIGHT=16]="HIGHLIGHT";a[a.CLIP=32]="CLIP";a[a.DEBUG=64]="DEBUG";a[a.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(a.WGLDrawPhase||(a.WGLDrawPhase={}));(function(a){a[a.SIZE=0]="SIZE";a[a.COLOR=1]="COLOR";a[a.OPACITY=2]="OPACITY";a[a.ROTATION=3]="ROTATION"})(a.VVType||(a.VVType={}));(function(a){a[a.NONE=0]="NONE";a[a.OPACITY=1]="OPACITY";
a[a.COLOR=2]="COLOR";a[a.ROTATION=4]="ROTATION";a[a.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";a[a.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";a[a.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";a[a.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(a.WGLVVFlag||(a.WGLVVFlag={}));(function(a){a[a.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";a[a.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";a[a.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";a[a.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(a.WGLVVTarget||
(a.WGLVVTarget={}));(function(a){a[a.SPRITE=0]="SPRITE";a[a.GLYPH=1]="GLYPH"})(a.MosaicType||(a.MosaicType={}))})},"esri/views/2d/engine/BitmapTile":function(){define(["require","exports","tslib","./Bitmap","./webgl/TiledDisplayObject"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function g(c,e,b,d){void 0===d&&(d=null);var g=a.call(this,c,e,b,b)||this;g.bitmap=new m.Bitmap(d);g.bitmap.coordScale=b;g.bitmap.once("isReady",function(){return g.ready()});return g}
e.__extends(g,a);Object.defineProperty(g.prototype,"stencilRef",{get:function(){return this.bitmap.stencilRef},set:function(a){this.bitmap.stencilRef=a},enumerable:!0,configurable:!0});g.prototype.setTransform=function(c,e){a.prototype.setTransform.call(this,c,e);this.bitmap.transforms.dvs=this.transforms.dvs};g.prototype.onAttach=function(){this.bitmap.stage=this.stage};g.prototype.onDetach=function(){this.bitmap.stage=null};return g}(k.TiledDisplayObject);a.BitmapTile=f})},"esri/views/2d/engine/webgl/TiledDisplayObject":function(){define("require exports tslib ../../../../core/has ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f32 ../DisplayObject ../../tiling/TileKey".split(" "),
function(f,a,e,m,k,l,g,c){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function b(b,e,g,h){void 0===h&&(h=g);var d=a.call(this)||this;d.transforms={dvs:l.mat3f32.create(),tileMat3:l.mat3f32.create()};d.triangleCount=0;d.key=c.pool.acquire(b);d.bounds=e;d.size=g;d.coordRange=h;return d}e.__extends(b,a);b.prototype.destroy=function(){c.pool.release(this.key);this.key=null;this.texture&&(this.texture.dispose(),this.texture=null)};Object.defineProperty(b.prototype,"coords",{get:function(){return this._coords},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"bounds",{get:function(){return this._bounds},set:function(b){this._coords=[b[0],b[3]];this._bounds=b},enumerable:!0,configurable:!0});b.prototype.setTransform=function(b,a){a/=b.resolution*b.pixelRatio;var d=this.transforms.tileMat3,c=b.toScreenNoRotation([0,0],this.coords);k.mat3.set(d,this.size[0]/this.coordRange[0]*a,0,0,0,this.size[1]/this.coordRange[1]*a,0,c[0],c[1],1);k.mat3.multiply(this.transforms.dvs,b.displayViewMat3,d)};
return b}(g.DisplayObject);a.TiledDisplayObject=f})},"esri/views/2d/engine/webgl/TileContainer":function(){define("require exports tslib ./enums ./WGLContainer ./brushes/WGLBrushInfo ./brushes/WGLBrushStencil".split(" "),function(f,a,e,m,k,l,g){Object.defineProperty(a,"__esModule",{value:!0});a.sortByLevel=function(a,e){return 0!==a.key.level-e.key.level?a.key.level-e.key.level:0!==a.key.row-e.key.row?a.key.row-e.key.row:a.key.col-e.key.col};f=function(c){function h(b){var a=c.call(this)||this;a._tileInfoView=
b;return a}e.__extends(h,c);h.prototype.renderChildren=function(b){this.sortChildren(a.sortByLevel);this.setStencilReference();c.prototype.renderChildren.call(this,b)};h.prototype.createRenderParams=function(b){var a=b.state;return e.__assign(e.__assign({},c.prototype.createRenderParams.call(this,b)),{requiredLevel:this._tileInfoView.getClosestInfoForScale(a.scale).level,displayLevel:this._tileInfoView.tileInfo.scaleToZoom(a.scale)})};h.prototype.prepareRenderPasses=function(b){var a=this,h=b.registerRenderPass({name:"stencil",
brushes:[g.default],drawPhase:m.WGLDrawPhase.DEBUG|m.WGLDrawPhase.MAP,target:function(){return a.children}}),f=b.registerRenderPass({name:"tileInfo",brushes:[l.default],drawPhase:m.WGLDrawPhase.DEBUG,target:function(){return a.children},has:"esri-tiles-debug"});return e.__spreadArrays(c.prototype.prepareRenderPasses.call(this,b),[h,f])};h.prototype.updateTransforms=function(b){for(var a=0,c=this.children;a<c.length;a++){var e=c[a],g=this._tileInfoView.getTileResolution(e.key);e.setTransform(b,g)}};
h.prototype.setStencilReference=function(){for(var b=1,a=0,c=this.children;a<c.length;a++)c[a].stencilRef=b++};return h}(k.default);a.default=f})},"esri/views/2d/engine/webgl/brushes/WGLBrushInfo":function(){define("require exports tslib ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms".split(" "),function(f,a,e,m,k,l,g,c){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function b(){var b=null!==a&&a.apply(this,
arguments)||this;b._color=m.vec4f32.fromValues(1,0,0,1);return b}e.__extends(b,a);b.prototype.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null);this._tileInfoVertexArrayObject&&(this._tileInfoVertexArrayObject.dispose(),this._tileInfoVertexArrayObject=null);
this._canvas=null};b.prototype.prepareState=function(b){b=b.context;b.setBlendingEnabled(!0);b.setBlendFunctionSeparate(1,771,1,771);b.setColorMask(!0,!0,!0,!0);b.setStencilWriteMask(0);b.setStencilTestEnabled(!1)};b.prototype.draw=function(b,a){b=b.context;if(a.isReady){this._loadWGLResources(b);b.bindVAO(this._outlineVertexArrayObject);b.bindProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs);this._outlineProgram.setUniform2f("u_coord_range",a.coordRange[0],
a.coordRange[1]);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);b.drawArrays(3,0,4);b.bindVAO();var d=this._getTexture(b,a);d&&(b.bindVAO(this._tileInfoVertexArrayObject),b.bindProgram(this._tileInfoProgram),b.bindTexture(d,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",a.coordRange[0]/a.size[0],a.coordRange[1]/a.size[1]),
this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",d.descriptor.width,d.descriptor.height),b.drawArrays(5,0,4),b.bindVAO())}};b.prototype._loadWGLResources=function(b){if(!this._outlineProgram||!this._tileInfoProgram){var a=k.createProgram(b,g.background),d=k.createProgram(b,c.tileInfo),e={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},h=new Int8Array([0,0,1,0,1,1,0,1]),h=k.BufferObject.createVertex(b,35044,h),
h=new k.VertexArrayObject(b,g.background.attributes,e,{geometry:h}),f=new Int8Array([0,0,1,0,0,1,1,1]),f=k.BufferObject.createVertex(b,35044,f);b=new k.VertexArrayObject(b,c.tileInfo.attributes,e,{geometry:f});this._outlineProgram=a;this._tileInfoProgram=d;this._outlineVertexArrayObject=h;this._tileInfoVertexArrayObject=b}};b.prototype._getTexture=function(b,a){if(a.texture)return a.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width",
"300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var d=a.triangleCount,c=a.key.id;0<a.triangleCount&&(c+=", "+d);var e=this._canvas,g=e.getContext("2d");g.font="24px sans-serif";g.textAlign="left";g.textBaseline="top";g.clearRect(0,0,300,32);1E5<d?(g.fillStyle="red",g.fillRect(0,0,300,32),g.fillStyle="black"):(g.clearRect(0,0,300,32),g.fillStyle="blue");g.fillText(c,0,0);a.texture=new k.Texture(b,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,
wrapMode:33071},e);return a.texture};return b}(l.default);a.default=f})},"esri/core/libs/gl-matrix-2/vec4f32":function(){define(["require","exports","./factories/vec4f32"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.vec4f32=e})},"esri/core/libs/gl-matrix-2/factories/vec4f32":function(){define(["require","exports"],function(f,a){function e(){return new Float32Array(4)}function m(b,a,c,e){var d=new Float32Array(4);d[0]=b;d[1]=a;d[2]=c;d[3]=e;return d}function k(){return m(1,1,
1,1)}function l(){return m(1,0,0,0)}function g(){return m(0,1,0,0)}function c(){return m(0,0,1,0)}function h(){return m(0,0,0,1)}Object.defineProperty(a,"__esModule",{value:!0});a.create=e;a.clone=function(b){var a=new Float32Array(4);a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a};a.fromValues=m;a.createView=function(b,a){return new Float32Array(b,a,4)};a.zeros=function(){return e()};a.ones=k;a.unitX=l;a.unitY=g;a.unitZ=c;a.unitW=h;a.ZEROS=e();a.ONES=k();a.UNIT_X=l();a.UNIT_Y=g();a.UNIT_Z=c();
a.UNIT_W=h()})},"esri/views/2d/engine/webgl/brushes/WGLBrush":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){this.name=this.constructor.name||"UnnamedBrush"}a.prototype.prepareState=function(a,e,f){};a.prototype.draw=function(a,e,f){};a.prototype.drawMany=function(a,e,f){for(var g=0;g<e.length;g++)this.draw(a,e[g],f)};return a}();a.default=f})},"esri/views/2d/engine/webgl/shaders/BackgroundPrograms":function(){define(["require",
"exports","./sources/resolver"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.background={name:"background",shaders:{vertexShader:e.resolveIncludes("background/background.vert"),fragmentShader:e.resolveIncludes("background/background.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/shaders/sources/resolver":function(){define(["require","exports","../../../../../webgl","./shaderRepository"],function(f,a,e,m){Object.defineProperty(a,"__esModule",{value:!0});var k=new e.ShaderCompiler(function(a){var e=
m.default;a.split("/").forEach(function(a){e&&(e=e[a])});return e});a.resolveIncludes=function(a){return k.resolveIncludes(a)}})},"esri/views/2d/engine/webgl/shaders/sources/shaderRepository":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});a.default={background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\n  gl_FragColor \x3d u_color;\n}","background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\n  vec3 v_pos \x3d u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n}"},
bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\n  lowp vec4 color \x3d texture2D(u_tex, v_uv);\n  gl_FragColor \x3d color *  u_opacity;\n}","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n  v_uv \x3d a_tex;\n}"},blend:{"blend.frag":"precision mediump float;\nuniform sampler2D u_layerTexture;\nuniform lowp float u_opacity;\n#ifndef NORMAL\nuniform sampler2D u_backbufferTexture;\n#endif\nvarying mediump vec2 v_uv;\nfloat rgb2v(in vec3 c) {\n  return max(c.x, max(c.y, c.z));\n}\nvec3 rgb2hsv(in vec3 c) {\n  vec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n  vec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n  vec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n  float d \x3d q.x - min(q.w, q.y);\n  float e \x3d 1.0e-10;\n  return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(in vec3 c) {\n  vec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec3 tint(in vec3 Cb, in vec3 Cs) {\n  float vIn \x3d rgb2v(Cb);\n  vec3 hsvTint \x3d rgb2hsv(Cs);\n  vec3 hsvOut \x3d vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\n  return hsv2rgb(hsvOut);\n}\nfloat overlay(in float Cb, in float Cs) {\n  return (1.0 - step(0.5, Cs)) * (1.0 - 2.0 * (1.0 - Cs ) * (1.0 - Cb)) + step(0.5, Cs) * (2.0 * Cs * Cb);\n}\nfloat colorDodge(in float Cb, in float Cs) {\n  return (Cb \x3d\x3d 0.0) ? 0.0 : (Cs \x3d\x3d 1.0) ? 1.0 : min(1.0, Cb / (1.0 - Cs));\n}\nfloat colorBurn(in float Cb, in float Cs) {\n return (Cb \x3d\x3d 1.0) ? 1.0 : (Cs \x3d\x3d 0.0) ? 0.0 : 1.0 - min(1.0, (1.0 - Cb) / Cs);\n}\nfloat hardLight(in float Cb, in float Cs) {\n  return (1.0 - step(0.5, Cs)) * (2.0 * Cs * Cb) + step(0.5, Cs) * (1.0 - 2.0 * (1.0 - Cs) * (1.0 - Cb));\n}\nfloat reflectBlend(in float Cb, in float Cs) {\n\treturn (Cs \x3d\x3d 1.0) ? Cs : min(Cb * Cb / (1.0 - Cs), 1.0);\n}\nfloat softLight(in float Cb, in float Cs) {\n  if (Cs \x3c\x3d 0.5) {\n    return Cb - (1.0 - 2.0 * Cs) * Cb * (1.0 - Cb);\n  }\n  if (Cb \x3c\x3d 0.25) {\n    return Cb + (2.0 * Cs - 1.0) * Cb * ((16.0 * Cb - 12.0) * Cb + 3.0);\n  }\n  return Cb + (2.0 * Cs - 1.0) * (sqrt(Cb) - Cb);\n}\nfloat vividLight(in float Cb, in float Cs) {\n  return (1.0 - step(0.5, Cs)) * colorBurn(Cb, 2.0 * Cs) + step(0.5, Cs) * colorDodge(Cb, (2.0 * (Cs - 0.5)));\n}\nfloat minv3(in vec3 c) {\n  return min(min(c.r, c.g), c.b);\n}\nfloat maxv3(in vec3 c) {\n  return max(max(c.r, c.g), c.b);\n}\nfloat lumv3(in vec3 c) {\n  return dot(c, vec3(0.3, 0.59, 0.11));\n}\nfloat satv3(vec3 c) {\n  return maxv3(c) - minv3(c);\n}\nvec3 clipColor(vec3 color) {\n  float lum \x3d lumv3(color);\n  float mincol \x3d minv3(color);\n  float maxcol \x3d maxv3(color);\n  if (mincol \x3c 0.0) {\n    color \x3d lum + ((color - lum) * lum) / (lum - mincol);\n  }\n  if (maxcol \x3e 1.0) {\n    color \x3d lum + ((color - lum) * (1.0 - lum)) / (maxcol - lum);\n  }\n  return color;\n}\nvec3 setLum(vec3 cbase, vec3 clum) {\n  float lbase \x3d lumv3(cbase);\n  float llum \x3d lumv3(clum);\n  float ldiff \x3d llum - lbase;\n  vec3 color \x3d cbase + vec3(ldiff);\n  return clipColor(color);\n}\nvec3 setLumSat(vec3 cbase, vec3 csat, vec3 clum)\n{\n  float minbase \x3d minv3(cbase);\n  float sbase \x3d satv3(cbase);\n  float ssat \x3d satv3(csat);\n  vec3 color;\n  if (sbase \x3e 0.0) {\n    color \x3d (cbase - minbase) * ssat / sbase;\n  } else {\n    color \x3d vec3(0.0);\n  }\n  return setLum(color, clum);\n}\nvoid main() {\n  vec4 src \x3d texture2D(u_layerTexture, v_uv);\n#ifdef NORMAL\n  gl_FragColor \x3d src *  u_opacity;\n#else\n  vec4 dst \x3d texture2D(u_backbufferTexture, v_uv);\n  vec3 Cs \x3d src.a \x3d\x3d 0.0 ? src.rgb : vec3(src.rgb / src.a);\n  vec3 Cb \x3d dst.a \x3d\x3d 0.0 ? dst.rgb : vec3(dst.rgb / dst.a);\n  float as \x3d u_opacity * src.a;\n  float ab \x3d dst.a;\n  #ifdef DESTINATION_OVER\n    gl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb, as + ab - as * ab);\n  #endif\n  #ifdef SOURCE_IN\n    gl_FragColor \x3d vec4(as * Cs * ab, as * ab);\n  #endif\n  #ifdef DESTINATION_IN\n    gl_FragColor \x3d vec4(ab * Cb * as, ab * as);\n  #endif\n  #ifdef SOURCE_OUT\n    gl_FragColor \x3d vec4(as * Cs * (1.0 - ab), as * (1.0 - ab));\n  #endif\n  #ifdef DESTINATION_OUT\n    gl_FragColor \x3d vec4(ab * Cb * (1.0 - as), ab * (1.0 - as));\n  #endif\n  #ifdef SOURCE_ATOP\n    gl_FragColor \x3d vec4(as * Cs * ab + ab * Cb * (1.0 - as), ab);\n  #endif\n  #ifdef DESTINATION_ATOP\n    gl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * as, as);\n  #endif\n  #ifdef XOR\n    gl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * (1.0 - as),\n                        as * (1.0 - ab) + ab * (1.0 - as));\n  #endif\n  #ifdef MULTIPLY\n    gl_FragColor \x3d vec4(as * Cs * ab * Cb + (1.0 - ab) * as * Cs + (1.0 - as) * ab * Cb,\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef SCREEN\n    gl_FragColor \x3d vec4((Cs + Cb - Cs * Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef OVERLAY\n    vec3 f \x3d vec3(overlay(Cb.r, Cs.r), overlay(Cb.g, Cs.g), overlay(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef DARKEN\n    gl_FragColor \x3d vec4(min(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef LIGHTER\n    gl_FragColor \x3d vec4(as * Cs + ab * Cb, as + ab);\n  #endif\n  #ifdef LIGHTEN\n    gl_FragColor \x3d vec4(max(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef COLOR_DODGE\n    vec3 f \x3d vec3(colorDodge(Cb.r, Cs.r), colorDodge(Cb.g, Cs.g), colorDodge(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef COLOR_BURN\n    vec3 f \x3d vec3(colorBurn(Cb.r, Cs.r), colorBurn(Cb.g, Cs.g), colorBurn(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef HARD_LIGHT\n    vec3 f \x3d vec3(hardLight(Cb.r, Cs.r), hardLight(Cb.g, Cs.g), hardLight(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef SOFT_LIGHT\n    vec3 f \x3d vec3(softLight(Cb.r, Cs.r), softLight(Cb.g, Cs.g), softLight(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef DIFFERENCE\n    gl_FragColor \x3d vec4(abs(Cb - Cs) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef EXCLUSION\n     vec3 f \x3d Cs + Cb - 2.0 * Cs * Cb;\n     gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef INVERT\n    gl_FragColor \x3d vec4((1.0 - Cb) * as * ab + Cb * ab * (1.0 - as), ab);\n  #endif\n  #ifdef VIVID_LIGHT\n    vec3 f \x3d vec3(vividLight(Cb.r, Cs.r),\n                  vividLight(Cb.g, Cs.g),\n                  vividLight(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef HUE\n    vec3 f \x3d setLumSat(Cs,Cb,Cb);\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef SATURATION\n    vec3 f \x3d setLumSat(Cb,Cs,Cb);\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef COLOR\n    vec3 f \x3d setLum(Cs,Cb);\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef LUMINOSITY\n    vec3 f \x3d setLum(Cb,Cs);\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef PLUS\n    gl_FragColor \x3d clamp(vec4(src.r + Cb.r, src.g + Cb.g, src.b + Cb.b, as + ab), 0.0, 1.0);\n  #endif\n  #ifdef MINUS\n     gl_FragColor \x3d vec4(clamp(vec3(Cb.r - src.r, Cb.g - src.g, Cb.b - src.b), 0.0, 1.0), ab * as);\n  #endif\n  #ifdef AVERAGE\n     vec3 f \x3d (Cb + Cs) / 2.0;\n     gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef REFLECT\n    vec3 f \x3d vec3(reflectBlend(Cb.r, Cs.r),\n                  reflectBlend(Cb.g, Cs.g),\n                  reflectBlend(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n#endif\n}",
"blend.vert":"attribute vec2 a_position;\nvarying mediump vec2 v_uv;\nvoid main(void) {\n  gl_Position \x3d vec4(a_position , 0.0, 1.0);\n  v_uv \x3d (a_position + 1.0) / 2.0;\n}"},filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\n  float b \x3d 1.0 / 6.0;\n  float v2 \x3d v * v;\n  float v3 \x3d v2 * v;\n  float w0 \x3d b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\n  float w1 \x3d b * (3.0 * v3  - 6.0 * v2 + 4.0);\n  float w2 \x3d b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\n  float w3 \x3d b * v3;\n  return vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\n  vec4 w \x3d computeWeights(v);\n  float g0 \x3d w.x + w.y;\n  float g1 \x3d w.z + w.w;\n  float h0 \x3d 1.0 - (w.y / g0) + v;\n  float h1 \x3d 1.0 + (w.w / g1) - v;\n  return vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 eX \x3d vec2(1.0 / texSize.x, 0.0);\n  vec2 eY \x3d vec2(0.0, 1.0 / texSize.y);\n  vec2 texel \x3d coords * texSize - 0.5;\n  vec3 hgX \x3d bicubicOffsetsAndWeights(fract(texel).x).xyz;\n  vec3 hgY \x3d bicubicOffsetsAndWeights(fract(texel).y).xyz;\n  vec2 coords10 \x3d coords + hgX.x * eX;\n  vec2 coords00 \x3d coords - hgX.y * eX;\n  vec2 coords11 \x3d coords10 + hgY.x * eY;\n  vec2 coords01 \x3d coords00 + hgY.x * eY;\n  coords10 \x3d coords10 - hgY.y * eY;\n  coords00 \x3d coords00 - hgY.y * eY;\n  vec4 color00 \x3d texture2D(sampler, coords00);\n  vec4 color10 \x3d texture2D(sampler, coords10);\n  vec4 color01 \x3d texture2D(sampler, coords01);\n  vec4 color11 \x3d texture2D(sampler, coords11);\n  color00 \x3d mix(color00, color01, hgY.z);\n  color10 \x3d mix(color10, color11, hgY.z);\n  color00 \x3d mix(color00, color10, hgX.z);\n  return color00;\n}",
"bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 texelStart \x3d floor(coords * texSize);\n  vec2 coord0 \x3d texelStart / texSize;\n  vec2 coord1 \x3d (texelStart +  vec2(1.0, 0.0)) / texSize;\n  vec2 coord2 \x3d (texelStart +  vec2(0.0, 1.0)) / texSize;\n  vec2 coord3 \x3d (texelStart +  vec2(1.0, 1.0)) / texSize;\n  vec4 color0 \x3d texture2D(sampler, coord0);\n  vec4 color1 \x3d texture2D(sampler, coord1);\n  vec4 color2 \x3d texture2D(sampler, coord2);\n  vec4 color3 \x3d texture2D(sampler, coord3);\n  vec2 blend \x3d fract(coords * texSize);\n  vec4 color01 \x3d mix(color0, color1, blend.x);\n  vec4 color23 \x3d mix(color2, color3, blend.x);\n  return mix(color01, color23, blend.y);\n}",
"epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\n  vec2 invSize \x3d 1.0 / texSize;\n  vec2 texel \x3d coords * texSize;\n  vec2 texel_i \x3d floor(texel);\n  vec2 texel_frac \x3d fract(texel);\n  vec4 colorP \x3d texture2D(sampler, texel_i * invSize);\n  vec4 colorP1 \x3d vec4(colorP);\n  vec4 colorP2 \x3d vec4(colorP);\n  vec4 colorP3 \x3d vec4(colorP);\n  vec4 colorP4 \x3d vec4(colorP);\n  vec4 colorA \x3d texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\n  vec4 colorB \x3d texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\n  vec4 colorC \x3d texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\n  vec4 colorD \x3d texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\n  if (colorC \x3d\x3d colorA \x26\x26 colorC !\x3d colorD \x26\x26 colorA !\x3d colorB) {\n    colorP1 \x3d colorA;\n  }\n  if (colorA \x3d\x3d colorB \x26\x26 colorA !\x3d colorC \x26\x26 colorB !\x3d colorD) {\n    colorP2 \x3d colorB;\n  }\n  if (colorD \x3d\x3d colorC \x26\x26 colorD !\x3d colorB \x26\x26 colorC !\x3d colorA) {\n    colorP3 \x3d colorC;\n  }\n  if (colorB \x3d\x3d colorD \x26\x26 colorB !\x3d colorA \x26\x26 colorD !\x3d colorC) {\n    colorP4 \x3d colorD;\n  }\n  vec4 colorP12 \x3d mix(colorP1, colorP2, texel_frac.x);\n  vec4 colorP34 \x3d mix(colorP1, colorP2, texel_frac.x);\n  return mix(colorP12, colorP34, texel_frac.y);\n}"},
fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include \x3cmaterials/utils.glsl\x3e\nvoid main()\n{\n#ifdef DELTA\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  vec4 data0 \x3d texture2D(u_maskTexture, v_texcoord);\n  float flags \x3d data0.r * 255.0;\n  float groupMinZoom \x3d data0.g * 255.0;\n  float isVisible \x3d getFilterBit(flags, 0);\n  float wouldClip \x3d step(groupMinZoom, u_zoomLevel);\n  float direction \x3d wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\n  float dt \x3d u_timeDelta / max(u_animationTime, 0.0001);\n  vec4 nextState \x3d vec4(texel + direction * dt);\n  gl_FragColor \x3d  vec4(nextState);\n#elif defined(UPDATE)\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  gl_FragColor \x3d texel;\n#endif\n}",
"integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_texture;\nmediump vec4 gauss4(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas * u_sigmas));\n}\nmediump float gauss1(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas[3] * u_sigmas[3]));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\n  return u_channelSelector * sample;\n}\nvoid accumGauss4(mediump float i, inout mediump vec4 tot, inout mediump vec4 weight) {\n  mediump vec4 w \x3d gauss4(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw)) * w;\n  weight +\x3d w;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\n  mediump float w \x3d gauss1(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\n  weight +\x3d w;\n}\nvoid main(void) {\n  mediump float tot \x3d 0.0;\n  mediump float weight \x3d 0.0;\n  accumGauss1(-4.0, tot, weight);\n  accumGauss1(-3.0, tot, weight);\n  accumGauss1(-2.0, tot, weight);\n  accumGauss1(-1.0, tot, weight);\n  accumGauss1(0.0, tot, weight);\n  accumGauss1(1.0, tot, weight);\n  accumGauss1(2.0, tot, weight);\n  accumGauss1(3.0, tot, weight);\n  accumGauss1(4.0, tot, weight);\n  gl_FragColor \x3d vec4(0.0, 0.0, 0.0, tot / weight);\n}",
"highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\n  mediump float sigma \x3d u_sigmas[3];\n  mediump float y \x3d texture2D(u_texture, v_texcoord)[3];\n  const mediump float y0 \x3d 0.5;\n  mediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * sigma);\n  mediump float d \x3d (y - y0) / m0;\n  return d;\n}\nmediump vec4 shade(mediump float d) {\n  mediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\n  mappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\n  return texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\n  mediump float d \x3d estimateDistance();\n  gl_FragColor \x3d shade(d);\n}",
"textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\n  gl_Position \x3d vec4(a_position, 0.0, 1.0);\n  v_texcoord \x3d a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlyTexture;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\n  lowp vec4 color \x3d texture2D(u_readbackTexture, v_texCoord);\n  color \x3d color + (1.0 - color.a) * u_background;\n  lowp vec4 mask_color \x3d texture2D(u_maskTexture, v_texCoord);\n  lowp float gray \x3d 1.0 - dot(mask_color, vec4(0.3, 0.59, 0.11, 0));\n  color *\x3d gray;\n  lowp vec4 overley_color \x3d texture2D(u_overlyTexture, v_texCoord);\n  overley_color.rgb *\x3d overley_color.a;\n  gl_FragColor \x3d overley_color + (1.0 - overley_color.a) * color;\n}",
"magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec2 u_drawPos;\nuniform mediump float u_width;\nuniform mediump float u_height;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\n  v_texCoord \x3d a_pos;\n  vec2 coord \x3d u_drawPos + vec2(a_pos - 0.5) * vec2(u_width, u_height);\n  gl_Position \x3d vec4(coord, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec4 id) {\n  highp vec4 texel \x3d unpackLocalIdTexel(id);\n  highp float size \x3d float(u_attributeTextureSize);\n  highp float u32 \x3d float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256 + int(texel.a) * 256 * 256 * 256);\n  highp float col \x3d mod(u32, size);\n  highp float row \x3d (u32 - col) / size;\n  highp float u \x3d col / size;\n  highp float v \x3d row / size;\n  return vec2(u, v);\n}\nhighp vec4 getAttributeData0(in highp vec4 id) {\n  vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData3, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\n  bool isMagic \x3d v.x \x3d\x3d 255.0 \x26\x26 v.y \x3d\x3d 255.0;\n  if (isMagic) {\n    return NAN_MAGIC_NUMBER;\n  }\n  return (v.x + v.y * float(0x100)) - 32768.0;\n}",
"constants.glsl":"const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float SIGNED_BYTE_TO_UNSIGNED \x3d 128.0;\nconst float POSITION_PRECISION \x3d 1.0 / 8.0;\nconst float SOFT_EDGE_RATIO \x3d 1.0;\nconst float THIN_LINE_WIDTH_FACTOR \x3d 1.1;\nconst float THIN_LINE_HALF_WIDTH \x3d 1.0;\nconst float EXTRUDE_SCALE_PLACEMENT_PADDING \x3d 1.0 / 4.0;\nconst float OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float OUTLINE_SCALE \x3d 1.0 / 5.0;\nconst float SDF_FONT_SIZE \x3d 24.0;\nconst float MAX_SDF_DISTANCE \x3d 8.0;\nconst float PLACEMENT_PADDING \x3d 8.0;\nconst float EPSILON \x3d 0.0000001;\nconst int MAX_FILTER_COUNT \x3d 2;\nconst int ATTR_VV_SIZE \x3d 0;\nconst int ATTR_VV_COLOR \x3d 1;\nconst int ATTR_VV_OPACITY \x3d 2;\nconst int ATTR_VV_ROTATION \x3d 3;\nconst highp float NAN_MAGIC_NUMBER \x3d 1e-30;",
"effects.glsl":"uniform highp mat4 u_insideEffectMat4[ MAX_FILTER_COUNT ];\nuniform highp mat4 u_outsideEffectMat4[ MAX_FILTER_COUNT ];\nuniform highp float u_insideOpacities[ MAX_FILTER_COUNT ];\nuniform highp float u_outsideOpacities[ MAX_FILTER_COUNT ];\nvec4 getEffectColor(in vec4 color, in float filterFlags) {\n  vec4 rgbw \x3d vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  for (int i \x3d 1; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    rgbw \x3d u_insideEffectMat4[ i ] * (bit  * rgbw) + u_outsideEffectMat4[ i ] * ((1.0 - bit) * rgbw);\n    a    \x3d u_insideOpacities[ i ]  * (bit  * a)    + u_outsideOpacities[ i ]  * ((1.0 - bit) * a);\n  }\n  return vec4(rgbw.rgb * a, a);\n}\nvec3 applyFilter(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  vec4 rgbw \x3d vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  for (int i \x3d 0; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    rgbw \x3d u_insideEffectMat4[ i ] * (bit  * rgbw) + u_outsideEffectMat4[ i ] * ((1.0 - bit) * rgbw);\n    a    \x3d u_insideOpacities[ i ]  * (bit  * a)    + u_outsideOpacities[ i ]  * ((1.0 - bit) * a);\n  }\n  color.rgb \x3d rgbw.rgb * a;\n  color.a \x3d a;\n  pos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef HIGHLIGHT\n  pos.z +\x3d 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n  return pos;\n}\nvec3 applyFilterLabels(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  float bit \x3d getFilterBit(filterFlags, 0);\n  pos.z +\x3d 2.0 * (1.0 - bit);\n#ifndef OUTSIDE_LABELS_VISIBLE\n  for (int i \x3d 1; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    pos.z +\x3d 2.0 * (1.0 - bit);\n  }\n#endif\n  return pos;\n}",
fill:{"common.glsl":"#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\n#endif\n#ifdef DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp float v_flags;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef DOT_DENSITY\nvarying highp vec2 v_dotTextureCoords;\nvarying highp vec4 v_dotThresholds[ 2 ];\n#endif",
"fill.frag":"precision highp float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\n#include \x3cmaterials/effects.glsl\x3e\n#endif\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#ifdef DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\nvoid main() {\n#ifdef ID\n  gl_FragColor \x3d v_id;\n#elif defined(PATTERN)\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_opacity * v_color * color;\n#elif defined(DOT_DENSITY) \x26\x26 !defined(HIGHLIGHT)\n  vec4 textureThresholds0 \x3d texture2D(u_dotTextures[0], v_dotTextureCoords);\n  vec4 textureThresholds1 \x3d texture2D(u_dotTextures[1], v_dotTextureCoords);\n  vec4 difference0 \x3d v_dotThresholds[0] - textureThresholds0;\n  vec4 difference1 \x3d v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\n  vec4 isPositive0 \x3d step(0.0, difference0);\n  vec4 isPositive1 \x3d step(0.0, difference1);\n  float weightSum \x3d dot(isPositive0, difference0) + dot(isPositive1, difference1);\n  float lessThanEqZero \x3d step(weightSum, 0.0);\n  float greaterThanZero \x3d 1.0 - lessThanEqZero ;\n  float divisor \x3d (weightSum + lessThanEqZero);\n  vec4 weights0 \x3d difference0 * isPositive0 / divisor;\n  vec4 weights1 \x3d difference1 * isPositive1 / divisor;\n  vec4 dotColor \x3d u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\n  vec4 preEffectColor \x3d greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\n  float diffMax \x3d max(max4(difference0), max4(difference1));\n  float lessThanZero \x3d step(diffMax, 0.0);\n  float greaterOrEqZero \x3d 1.0 - lessThanZero;\n  vec4 isMax0 \x3d step(diffMax, difference0);\n  vec4 isMax1 \x3d step(diffMax, difference1);\n  vec4 dotColor \x3d u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\n  vec4 preEffectColor \x3d greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\n  gl_FragColor \x3d getEffectColor(preEffectColor, v_flags);\n#else\n  gl_FragColor \x3d v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d 1.0;\n#endif\n}",
"fill.vert":"precision highp float;\n#ifdef DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color \x3d vec4(0.0, 0.0, 0.0, 1.0);\nvec4 a_aux3 \x3d vec4(0.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_tlbr;\nattribute vec4 a_aux1;\nattribute vec2 a_aux2;\nattribute vec4 a_aux3;\n#endif\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\n  return featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\nvoid main()\n{\n  INIT;\n  float a_bitSet \x3d a_aux3.a;\n  v_color     \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity   \x3d getOpacity();\n  v_id        \x3d norm(a_id);\n  v_pos       \x3d u_dvsMat3 * vec3(a_pos * POSITION_PRECISION, 1.);\n  v_flags     \x3d getFilterFlags();\n#ifdef PATTERN\n  vec2 aux2 \x3d (1.0 / SIGNED_BYTE_TO_UNSIGNED) * a_aux2;\n  float width \x3d u_zoomFactor * a_aux1.x * aux2.x;\n  float height \x3d u_zoomFactor * a_aux1.y * aux2.y;\n  float angle \x3d C_256_TO_RAD * a_aux3.z;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  mat3 patternMatrix \x3d mat3(cosA / width, sinA / height, 0,\n                           -sinA / width, cosA / height, 0,\n                            0,            0,             1);\n  vec2 symbolOffset \x3d (a_aux1.zw - SIGNED_BYTE_TO_UNSIGNED) / vec2(width, height);\n  v_tileTextureCoord \x3d (patternMatrix * vec3(a_pos * POSITION_PRECISION, 1.0)).xy - symbolOffset;\n  v_tlbr \x3d a_tlbr / u_mosaicSize.xyxy;\n#elif defined(DOT_DENSITY)\n  vec4 ddAttributeData0 \x3d getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\n  vec4 ddAttributeData1 \x3d getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\n  float size \x3d u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\n  v_dotThresholds[0] \x3d dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\n  v_dotThresholds[1] \x3d dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\n  v_dotTextureCoords \x3d (a_pos * POSITION_PRECISION + 0.5) / size;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_flags), 1.0);\n}"},
icon:{"common.glsl":"uniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp vec4 v_sizeTex;\nvarying mediump vec3 v_pos;\nvarying highp float v_filters;\nvarying lowp float v_opacity;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying mediump float v_overridingOutlineColor;\nvarying mediump float v_isThin;\n#endif","icon.frag":"precision mediump float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/effects.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  vec2 v_size \x3d v_sizeTex.xy;\n  vec2 v_tex  \x3d v_sizeTex.zw;\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * size * SOFT_EDGE_RATIO * v_distRatio;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  float outlineWidth \x3d v_outlineWidth;\n  #ifdef HIGHLIGHT\n    outlineWidth \x3d max(outlineWidth, 4.0 * v_isThin);\n  #endif\n  if (outlineWidth \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\n    float clampedOutlineSize \x3d min(outlineWidth, size);\n    outlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\n    gl_FragColor \x3d v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_opacity * fillPixelColor;\n  }\n#else\n   lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n   gl_FragColor \x3d v_opacity * getEffectColor(texColor, v_filters);\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec4 a_bitSetAndDistRatio;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\n#ifdef VV_SIZE\n  float r \x3d getSize(baseSize.y) / referenceSize;\n  baseSize.xy *\x3d r;\n  offset.xy *\x3d r;\n  float scaleSymbolProportionally \x3d getBit(bitSet, 3);\n  outlineSize *\x3d scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\n  return baseSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\n  float isMapAligned \x3d getBit(a_bitSet, 0);\n  vec3  offset       \x3d getRotation() * vec3(in_offset, 0.0);\n  return getMatrix(isMapAligned) * offset;\n}\nvoid main()\n{\n  INIT;\n  vec2  a_size   \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\n  vec2  a_offset \x3d a_vertexOffset / 16.0;\n  float a_outlineSize \x3d a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 128.0;\n  float a_bitSet \x3d a_bitSetAndDistRatio.z;\n  vec2 v_size \x3d getMarkerSize(a_offset, a_size, a_outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0, a_bitSet);\n  vec2 v_tex      \x3d a_texCoords / u_mosaicSize;\n  v_color    \x3d getColor(a_color, a_bitSet, 1);\n  v_opacity  \x3d getOpacity();\n  v_id       \x3d norm(a_id);\n  v_filters  \x3d getFilterFlags();\n  v_pos      \x3d u_dvsMat3 * vec3(a_pos * POSITION_PRECISION, 1.0) + getOffset(a_offset, a_bitSet);\n  v_sizeTex  \x3d vec4(v_size.xy, v_tex.xy);\n#ifdef SDF\n  v_isThin   \x3d getBit(a_bitSet, 2);\n  #ifdef VV_COLOR\n    v_overridingOutlineColor \x3d v_isThin;\n  #else\n    v_overridingOutlineColor \x3d 0.0;\n  #endif\n  v_outlineWidth \x3d min(a_outlineSize, max(max(v_size.x, v_size.y) - 0.99, 0.0));\n  v_outlineColor \x3d getEffectColor(a_outlineColor, v_filters);\n  v_distRatio \x3d a_bitSetAndDistRatio.w / 126.0;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_filters), 1.0);\n}"},
label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform mediump float u_mapRotation;\nuniform mediump float u_mapAligned;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"#include \x3cmaterials/text/text.frag\x3e","label.vert":"precision highp float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_glyphData;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nuniform float u_zoomLevel;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\n  float glyphAngle \x3d angle * 360.0 / 254.0;\n  float mapAngle \x3d u_mapRotation * 360.0 / 254.0;\n  float diffAngle \x3d min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\n  float z \x3d 0.0;\n  z +\x3d u_mapAligned * (2.0 * (1.0 - step(minZoom, u_zoomLevel)));\n  z +\x3d u_mapAligned * 2.0 * step(90.0, diffAngle);\n  z +\x3d 2.0 * (1.0 - step(u_zoomLevel, maxZoom));\n  return z;\n}\nvoid main()\n{\n  INIT;\n  float groupMinZoom    \x3d getMinZoom();\n  float glyphMinZoom    \x3d a_glyphData.x;\n  float glyphMaxZoom    \x3d a_glyphData.y;\n  float glyphAngle      \x3d a_glyphData.z;\n  float a_minZoom          \x3d max(groupMinZoom, glyphMinZoom);\n  float a_placementPadding \x3d a_refSymbolAndPlacementOffset.x * EXTRUDE_SCALE_PLACEMENT_PADDING;\n  vec2  a_placementDir     \x3d unpack_u8_nf32(a_refSymbolAndPlacementOffset.zw);\n  float a_refSymbolSize    \x3d a_refSymbolAndPlacementOffset.y;\n  float fontSize           \x3d a_texAndSize.z;\n  float haloSize           \x3d a_texAndSize.w * OUTLINE_SCALE;\n  vec2  vertexOffset \x3d a_vertexOffset * OFFSET_PRECISION;\n  vec3  pos          \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\n  float z            \x3d getZ(a_minZoom, glyphMaxZoom, glyphAngle);\n  float fontScale    \x3d fontSize / SDF_FONT_SIZE;\n  float halfSize     \x3d getSize(a_refSymbolSize) / 2.0;\n  float animation    \x3d pow(getAnimationState(), vec4(2.0)).r;\n  v_color     \x3d animation * ((1.0 - u_isHalo) * a_color + (u_isHalo * a_haloColor));\n  v_opacity   \x3d 1.0;\n  v_tex       \x3d a_texCoords / u_mosaicSize;\n  v_edgeDistanceOffset \x3d u_isHalo * haloSize / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  vec2 placementOffset \x3d a_placementDir * (halfSize + a_placementPadding);\n  vec3 glyphOffset     \x3d u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\n  vec3 v_pos           \x3d vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\n  gl_Position \x3d vec4(applyFilterLabels(v_color, v_pos, getFilterFlags()), 1.0);\n#ifdef DEBUG\n  v_color \x3d vec4(a_color.rgb, z \x3d\x3d 0.0 ? 1.0 : 0.645);\n#endif\n}"},
line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\nvarying highp vec3 v_pos;\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif","line.frag":"precision lowp float;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nuniform lowp float u_blur;\nuniform mediump float u_zoomFactor;\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\n#endif\n#ifdef SDF\nconst float sdfPatternHalfWidth \x3d 15.5;\nconst float widthFactor \x3d 2.0;\n#endif\nvoid main()\n{\n  mediump float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(v_lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp(thinLineFactor * (v_lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  mediump float lineHalfWidth \x3d widthFactor * v_lineHalfWidth;\n  mediump float lineWidthRatio \x3d lineHalfWidth / sdfPatternHalfWidth;\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * lineHalfWidth) / (lineWidthRatio * v_patternSize.x), 1.0);\n  mediump float relativeTexY \x3d 0.5 + 0.5 * v_normal.y;\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n  mediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\n  float dist \x3d d * lineHalfWidth;\n  lowp vec4 fillPixelColor \x3d v_opacity * alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n  gl_FragColor \x3d fillPixelColor;\n#elif defined(PATTERN) \x26\x26 !defined(HIGHLIGHT)\n  mediump float lineHalfWidth \x3d v_lineHalfWidth;\n  mediump float adjustedPatternWidth \x3d v_patternSize.x * 2.0 * lineHalfWidth / v_patternSize.y;\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * lineHalfWidth) / adjustedPatternWidth, 1.0);\n  mediump float relativeTexY \x3d 0.5 + 0.5 * v_normal.y;\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexY, relativeTexX));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d v_opacity * alpha * v_color * color;\n#else\n  gl_FragColor \x3d v_opacity * alpha * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nconst float SCALE \x3d 1.0 / 31.0;\nconst float WIDTH_SCALE \x3d 1.0 / 1024.0;\nfloat getBaseLineHalfWidth(in float in_lineHalfWidth) {\n#ifdef VV_SIZE\n  float referenceHalfWidth \x3d a_aux.x * WIDTH_SCALE;\n  float lineWidth \x3d 2.0 * in_lineHalfWidth;\n  return 0.5 * (in_lineHalfWidth / referenceHalfWidth) * getSize(lineWidth);\n#else\n  return in_lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\n  float halfWidth \x3d max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\n  halfWidth \x3d max(halfWidth, 2.0);\n#endif\n  return halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\n  float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  thinLineFactor *\x3d 2.0;\n#endif\n  return thinLineFactor * halfWidth * offset * SCALE;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet          \x3d a_segmentDirection.w;\n  float a_accumulatedDist \x3d a_accumulatedDistanceAndHalfWidth.x;\n  float a_lineHalfWidth   \x3d a_accumulatedDistanceAndHalfWidth.y * WIDTH_SCALE;\n  float aa                \x3d 0.5 * u_antialiasing;\n  vec2  a_offset          \x3d a_offsetAndNormal.xy;\n  float baseWidth \x3d getBaseLineHalfWidth(a_lineHalfWidth);\n  float halfWidth \x3d getLineHalfWidth(baseWidth, aa);\n  float z         \x3d 2.0 * step(baseWidth, 0.0);\n  vec2  dist      \x3d getDist(a_offset, halfWidth);\n  vec3  offset    \x3d u_displayViewMat3 * vec3(dist, 0.0);\n  vec3  pos       \x3d u_dvsMat3 * vec3(a_pos * POSITION_PRECISION, 1.0) + offset;\n  v_color         \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity       \x3d getOpacity();\n  v_lineHalfWidth \x3d halfWidth;\n  v_id            \x3d norm(a_id);\n  v_normal        \x3d a_offsetAndNormal.zw * SCALE;\n  v_pos           \x3d vec3(pos.xy, z);\n#ifdef PATTERN\n  v_tlbr          \x3d a_tlbr / u_mosaicSize.xyxy;\n  v_patternSize   \x3d vec2(a_tlbr.z - a_tlbr.x, a_tlbr.w - a_tlbr.y);\n#endif\n#if defined(PATTERN) || defined(SDF)\n  v_accumulatedDistance \x3d a_accumulatedDist + dot(SCALE * a_segmentDirection.xy, dist / u_zoomFactor);\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
text:{"common.glsl":"uniform highp vec2 u_mosaicSize;\nvarying highp vec4 v_id;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec2 v_tex;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying lowp float v_transparency;","text.frag":"precision mediump float;\n#include \x3cmaterials/text/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  float SDF_CUTOFF \x3d (2.0 / 8.0);\n  float SDF_BASE_EDGE_DIST \x3d 1.0 - SDF_CUTOFF;\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  mediump float edge \x3d SDF_BASE_EDGE_DIST - v_edgeDistanceOffset;\n#ifdef HIGHLIGHT\n  edge /\x3d 2.0;\n#endif\n  lowp float aa \x3d v_antialiasingWidth;\n  lowp float alpha \x3d smoothstep(edge - aa, edge + aa, dist);\n  gl_FragColor \x3d alpha * v_color * v_opacity;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"precision highp float;\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nfloat getTextSize(inout vec2 offset, in float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\n   float ratio \x3d baseSize / referenceSize;\n   baseSize \x3d ratio * getSize(baseSize);\n#endif\n  return baseSize;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet      \x3d a_aux.w;\n  float a_fontSize    \x3d a_texFontSize.z;\n  vec2  a_offset      \x3d a_vertexOffset * OFFSET_PRECISION;\n  vec3  in_pos        \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\n  float fontSize      \x3d getTextSize(a_offset, a_fontSize, a_aux.z * a_aux.z / 256.0);\n  float scaleFactor   \x3d fontSize / a_fontSize;\n  float fontScale     \x3d fontSize / SDF_FONT_SIZE;\n  vec3  offset        \x3d getRotation() * vec3(scaleFactor * a_offset, 0.0);\n  mat3  extrudeMatrix \x3d getBit(a_bitSet, 0) \x3d\x3d 1.0 ? u_displayViewMat3 : u_displayMat3;\n  v_color   \x3d u_isHalo * a_haloColor + (1.0 - u_isHalo) * getColor(a_color, a_bitSet, 1);\n  v_opacity \x3d getOpacity();\n  v_id      \x3d norm(a_id);\n  v_tex     \x3d a_texCoords / u_mosaicSize;\n  v_pos     \x3d u_dvsMat3 * in_pos + extrudeMatrix * offset;\n  v_edgeDistanceOffset \x3d u_isHalo * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  gl_Position \x3d  vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
"utils.glsl":"float rshift(in float u32, in int amount) {\n  return floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n  return mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\n  return getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\n  return getBit(bitset, 0);\n}\nhighp vec4 unpackLocalIdTexel(in highp vec4 bitset) {\n  float isAggregate \x3d getBit(bitset.a, 7);\n  return (1.0 - isAggregate) * bitset + isAggregate * (vec4(bitset.rgba) - vec4(0.0, 0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\n  float r \x3d mod(rshift(u32, 0), 255.0);\n  float g \x3d mod(rshift(u32, 8), 255.0);\n  float b \x3d mod(rshift(u32, 16), 255.0);\n  float a \x3d mod(rshift(u32, 24), 255.0);\n  return vec4(r, g, b, a);\n}\nvec4 norm(in vec4 v) {\n  return v /\x3d 255.0;\n}\nfloat max4(vec4 target) {\n  return max(max(max(target.x, target.y), target.z), target.w);\n}\nvec2 unpack_u8_nf32(vec2 bytes) {\n  return (bytes - 127.0) / 127.0;\n}",
"vcommon.glsl":"#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/attributeData.glsl\x3e\n#include \x3cmaterials/vv.glsl\x3e\n#include \x3cmaterials/effects.glsl\x3e\nattribute vec2 a_pos;\nattribute highp vec4 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nvec4 VV_ADATA \x3d vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef OES_TEXTURE_FLOAT\n  target.rgba \x3d getAttributeData2(a_id);\n#else\n  vec4 data0 \x3d getAttributeData2(a_id);\n  vec4 data1 \x3d getAttributeData3(a_id);\n  target.r \x3d u88VVToFloat(data0.rg * 255.0);\n  target.g \x3d u88VVToFloat(data0.ba * 255.0);\n  target.b \x3d u88VVToFloat(data1.rg * 255.0);\n  target.a \x3d u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n  #define INIT loadVisualVariableData(VV_ADATA)\n#else\n  #define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\n  float isColorLocked   \x3d getBit(a_bitSet, index);\n  return getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\n  return a_color;\n#endif\n}\nfloat getOpacity() {\n#ifdef VV_OPACITY\n  return getVVOpacity(VV_ADATA[ATTR_VV_OPACITY]);\n#else\n  return 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\n  return getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\n  return in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\n  return getVVRotationMat3(mod(VV_ADATA[ATTR_VV_ROTATION], 360.0));\n#else\n  return mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\n  return ceil(getAttributeData0(a_id).x * 255.0);\n#else\n  return getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\n  return getAttributeData1(a_id);\n}\nfloat getMinZoom() {\n  vec4 data0 \x3d getAttributeData0(a_id) * 255.0;\n  return data0.g;\n}\nmat3 getMatrix(float isMapAligned) {\n  return isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}",
"vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n  #define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n  #define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\n  return (val \x3d\x3d NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  float interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n  interpolationRatio \x3d clamp(interpolationRatio, 0.0, 1.0);\n  return u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N \x3d 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  if (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\n    return u_vvSizeFieldStopsSizes[0];\n  }\n  for (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\n    if (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\n      float f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n      return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n    }\n  }\n  return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N \x3d 8;\nfloat getVVOpacity(float opacityValue) {\n  if (isNan(opacityValue)) {\n    return 1.0;\n  }\n  if (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\n    return u_vvOpacities[0];\n  }\n  for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\n    if (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\n      float f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n      return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n    }\n  }\n  return u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat4(1, 0, 0, 0,\n                0, 1, 0, 0,\n                0, 0, 1, 0,\n                0, 0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat4(cosA, sinA, 0, 0,\n              -sinA,  cosA, 0, 0,\n              0,     0, 1, 0,\n              0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat3(1, 0, 0,\n                0, 1, 0,\n                0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * -rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat3(cosA, -sinA, 0,\n             sinA, cosA, 0,\n              0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N \x3d 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\n  if (isNan(colorValue) || isColorLocked \x3d\x3d 1.0) {\n    return fallback;\n  }\n  if (colorValue \x3c\x3d u_vvColorValues[0]) {\n    return u_vvColors[0];\n  }\n  for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n    if (u_vvColorValues[i] \x3e\x3d colorValue) {\n      float f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n      return mix(u_vvColors[i-1], u_vvColors[i], f);\n    }\n  }\n  return u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\n  return getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\n  return u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\n  float outSize \x3d getVVStopsSize(vvSize, size);\n  return isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\n  return getVVUnitValue(vvSize, size);\n#else\n  return size;\n#endif\n}"},
raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\n#include \x3cfiltering/bicubic.glsl\x3e\nvoid main() {\n#ifdef BICUBIC\n  vec4 color \x3d sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\n  vec4 color \x3d texture2D(u_texture, v_texcoord);\n#endif\n  gl_FragColor \x3d vec4(color.rgb * color.a, color.a);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
common:{"common.glsl":"uniform sampler2D u_image;\nuniform int u_bandCount;\nuniform bool u_isFloatTexture;\nuniform bool u_flipY;\nuniform float u_opacity;\nuniform int u_resampling;\nuniform vec2 u_srcImageSize;\n#ifdef APPLY_PROJECTION\n#include \x3craster/common/projection.glsl\x3e\n#endif\n#ifdef BICUBIC\n#include \x3cfiltering/bicubic.glsl\x3e\n#endif\nvec2 getPixelLocation(vec2 coords) {\n  vec2 targetLocation \x3d u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\n#ifdef APPLY_PROJECTION\n  targetLocation \x3d projectPixelLocation(targetLocation);\n#endif\n  return targetLocation;\n}\nbool isOutside(vec2 coords){\n   if (coords.t\x3e1.00001 ||coords.t\x3c-0.00001 || coords.s\x3e1.00001 ||coords.s\x3c-0.00001) {\n     return true;\n   } else {\n     return false;\n   }\n}\nvec4 getPixel(vec2 pixelLocation) {\n#ifdef BICUBIC\n  vec4 color \x3d sampleBicubicBSpline(u_image, pixelLocation, u_srcImageSize);\n#else\n  vec4 color \x3d texture2D(u_image, pixelLocation);\n#endif\n  return color;\n}",
"contrastBrightness.glsl":"uniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nvec4 adjustContrastBrightness(vec4 currentPixel, bool isFloat) {\n  vec4 pixelValue \x3d isFloat ? currentPixel * 255.0 : currentPixel;\n  float maxI \x3d 255.0;\n  float mid \x3d 128.0;\n  float c \x3d u_contrastOffset;\n  float b \x3d u_brightnessOffset;\n  vec4 v;\n  if (c \x3e 0.0 \x26\x26 c \x3c 100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n  } else if (c \x3c\x3d 0.0 \x26\x26 c \x3e -100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n  } else if (c \x3d\x3d 100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\n    v \x3d (sign(v) + 1.0) / 2.0;\n  } else if (c \x3d\x3d -100.0) {\n    v \x3d vec4(mid, mid, mid, currentPixel.a);\n  }\n  return vec4(v.r / 255.0, v.g / 255.0, v.b / 255.0, currentPixel.a);\n}",
"projection.glsl":"uniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nvec2 projectPixelLocation(vec2 coords) {\n  vec2 index_image \x3d floor(coords * u_targetImageSize);\n  vec2 oneTransformPixel \x3d vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\n  vec2 index_transform \x3d floor(index_image / u_transformSpacing) / u_transformGridSize;\n  vec2 pos \x3d fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\n  vec2 srcLocation;\n  vec2 transform_location \x3d index_transform + oneTransformPixel * 0.5;\n  if (pos.s \x3c\x3d pos.t) {\n    vec4 ll_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\n    vec4 ll_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\n    srcLocation.s \x3d dot(ll_abc.rgb, vec3(pos, 1.0));\n    srcLocation.t \x3d dot(ll_def.rgb, vec3(pos, 1.0));\n  } else {\n    vec4 ur_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\n    vec4 ur_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\n    srcLocation.s \x3d dot(ur_abc.rgb, vec3(pos, 1.0));\n    srcLocation.t \x3d dot(ur_def.rgb, vec3(pos, 1.0));\n  }\n  return srcLocation;\n}"},
hillshade:{"hillshade.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform int u_hillshadeType;\nuniform float u_sinZcosAs[6];\nuniform float u_sinZsinAs[6];\nuniform float u_cosZs[6];\nuniform float u_weights[6];\nuniform vec2 u_factor;\nuniform float u_minValue;\nuniform float u_maxValue;\n#include \x3craster/lut/colorize.glsl\x3e\nfloat getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){\n  if (a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0) {\n    return 0.0;\n  }\n  else {\n    return e;\n  }\n}\nvec3 rgb2hsv(vec3 c) {\n  vec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n  vec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n  vec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n  float d \x3d q.x - min(q.w, q.y);\n  float e \x3d 1.0e-10;\n  return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(vec3 c) {\n  vec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec4 overlay(float val, float minValue, float maxValue, float hillshade, float alpha) {\n  val \x3d clamp((val - minValue) / (maxValue - minValue), 0.0, 1.0);\n  vec4 rgb \x3d colorize(vec4(val, val, val, 1.0), false);\n  vec3 hsv \x3d rgb2hsv(rgb.xyz);\n  hsv.z \x3d hillshade;\n  return vec4(hsv2rgb(hsv) * alpha, alpha);\n}\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  if (currentPixel.a \x3d\x3d 0.0) {\n    gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n    return;\n  }\n  vec2 axy \x3d vec2(-1.0, -1.0);\n  vec2 bxy \x3d vec2(0.0, -1.0);\n  vec2 cxy \x3d vec2(1.0, -1.0);\n  vec2 dxy \x3d vec2(-1.0, 0.0);\n  vec2 fxy \x3d vec2(1.0, 0.0);\n  vec2 gxy \x3d vec2(-1.0, 1.0);\n  vec2 hxy \x3d vec2(0.0, 1.0);\n  vec2 ixy \x3d vec2(1.0, 1.0);\n  vec2 onePixel \x3d 1.0 / u_srcImageSize;\n  if (pixelLocation.s \x3c onePixel.s) {\n    axy[0] \x3d 1.0;\n    dxy[0] \x3d 1.0;\n    gxy[0] \x3d 1.0;\n  }\n  if (pixelLocation.t \x3c onePixel.t) {\n    axy[1] \x3d 1.0;\n    bxy[1] \x3d 1.0;\n    cxy[1] \x3d 1.0;\n  }\n  if (pixelLocation.s \x3e 1.0 - onePixel.s) {\n    cxy[0] \x3d -1.0;\n    fxy[0] \x3d -1.0;\n    ixy[0] \x3d -1.0;\n  }\n  if (pixelLocation.t \x3e 1.0 - onePixel.t) {\n    gxy[1] \x3d -1.0;\n    hxy[1] \x3d -1.0;\n    ixy[1] \x3d -1.0;\n  }\n  vec4 va \x3d texture2D(u_image, pixelLocation + onePixel * axy);\n  vec4 vb \x3d texture2D(u_image, pixelLocation + onePixel * bxy);\n  vec4 vc \x3d texture2D(u_image, pixelLocation + onePixel * cxy);\n  vec4 vd \x3d texture2D(u_image, pixelLocation + onePixel * dxy);\n  vec4 ve \x3d texture2D(u_image, pixelLocation);\n  vec4 vf \x3d texture2D(u_image, pixelLocation + onePixel * fxy);\n  vec4 vg \x3d texture2D(u_image, pixelLocation + onePixel * gxy);\n  vec4 vh \x3d texture2D(u_image, pixelLocation + onePixel * hxy);\n  vec4 vi \x3d texture2D(u_image, pixelLocation + onePixel * ixy);\n  float dzx \x3d (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * u_factor.s;\n  float dzy \x3d (vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * u_factor.t;\n  float dzd \x3d sqrt(1.0 + dzx * dzx + dzy * dzy);\n  float hillshade \x3d 0.0;\n  if (u_hillshadeType \x3d\x3d 0){\n\t   float cosDelta \x3d u_sinZsinAs[0] * dzy - u_sinZcosAs[0] * dzx;\n     float z \x3d (u_cosZs[0] + cosDelta) / dzd;\n     if (z \x3c 0.0)  z \x3d 0.0;\n\t   hillshade \x3d z;\n  } else {\n\t  for (int k \x3d 0; k \x3c 6; k++) {\n\t\t float cosDelta \x3d u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;\n\t\t float z \x3d (u_cosZs[k] + cosDelta) / dzd;\n\t\t if (z \x3c 0.0) z \x3d 0.0;\n     hillshade \x3d hillshade + z * u_weights[k];\n\t\t if (k \x3d\x3d 5) break;\n    }\n  }\n  float alpha \x3d getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);\n#ifdef APPLY_COLORMAP\n  gl_FragColor \x3d overlay(ve.r, u_minValue, u_maxValue, hillshade, alpha);\n#else\n  hillshade *\x3d alpha;\n  gl_FragColor \x3d vec4(hillshade, hillshade, hillshade, alpha);\n#endif\n}",
"hillshade.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},lut:{"colorize.glsl":"uniform sampler2D u_colormap;\nuniform float u_colormapOffset;\nuniform float u_colormapMaxIndex;\nvec4 colorize(vec4 currentPixel, bool isFloat) {\n  float clrIndex \x3d isFloat ? currentPixel.r - u_colormapOffset : currentPixel.r * 255.0 - u_colormapOffset;\n  vec4 result;\n  if (currentPixel.a \x3d\x3d 0.0 || clrIndex \x3e u_colormapMaxIndex) {\n    result \x3d vec4(0.0, 0.0, 0.0, 0.0);\n  } else {\n    vec2 clrPosition \x3d vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\n    vec4 color \x3d texture2D(u_colormap, clrPosition);\n    result \x3d vec4(color.rgb, 1.0) * color.a * u_opacity;\n  }\n  return result;\n}",
"lut.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\n#include \x3craster/lut/colorize.glsl\x3e\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  gl_FragColor \x3d colorize(currentPixel, true);\n}","lut.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos * u_scale + u_offset;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
stretch:{"stretch.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform bool u_useGamma;\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\n#include \x3craster/lut/colorize.glsl\x3e\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\n  if (val \x3e\x3d maxCutOff) {\n    return maxOutput;\n  } else if (val \x3c\x3d minCutOff) {\n    return minOutput;\n  }\n  float stretchedVal;\n  if (useGamma) {\n  \tfloat tempf \x3d 1.0;\n\t  float outRange \x3d maxOutput - minOutput;\n\t  float relativeVal \x3d (val - minCutOff) / (maxCutOff - minCutOff);\n\t  if (gamma \x3e 1.0) {\n      tempf -\x3d pow(1.0 / outRange, relativeVal * gammaCorrection);\n    }\n    stretchedVal \x3d (tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput) / 255.0;\n  } else {\n    stretchedVal \x3d minOutput + (val - minCutOff) * factor;\n  }\n  return stretchedVal;\n}\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  if (currentPixel.a \x3d\x3d 0.0) {\n    gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n    return;\n  }\n  if (u_bandCount \x3d\x3d 1) {\n    float grayVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n#ifdef APPLY_COLORMAP\n      gl_FragColor \x3d colorize(vec4(grayVal, grayVal, grayVal, currentPixel.a * u_opacity), !u_useGamma);\n#else\n      gl_FragColor \x3d vec4(grayVal, grayVal, grayVal, 1.0) * currentPixel.a * u_opacity;\n#endif\n  } else {\n    float redVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n    float greenVal \x3d stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\n    float blueVal \x3d stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\n    gl_FragColor \x3d vec4(redVal, greenVal, blueVal, 1.0) * currentPixel.a * u_opacity;\n  }\n}",
"stretch.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos * u_scale + u_offset;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},stencil:{"stencil.frag":"void main() {\n  gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nvoid main() {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n}"},
tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d 0.75 * color;\n}","tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\n  mediump vec2 offset \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\n  vec3 v_pos \x3d u_dvsMat3 * vec3(offset, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n  v_tex \x3d a_pos;\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/shaders/TileInfoPrograms":function(){define(["require","exports","./sources/resolver"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.tileInfo={name:"tileInfo",shaders:{vertexShader:e.resolveIncludes("tileInfo/tileInfo.vert"),
fragmentShader:e.resolveIncludes("tileInfo/tileInfo.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/brushes/WGLBrushStencil":function(){define("require exports tslib ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ./WGLBrush ../shaders/BackgroundPrograms".split(" "),function(f,a,e,m,k,l,g){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b._color=m.vec4f32.fromValues(1,0,0,1);b._initialized=!1;return b}
e.__extends(c,a);c.prototype.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};c.prototype.prepareState=function(b,a){b=b.context;b.setDepthWriteEnabled(!1);b.setDepthTestEnabled(!1);b.setStencilTestEnabled(!0);b.setBlendingEnabled(!1);b.setColorMask(!1,!1,!1,!1);b.setStencilOp(7680,7680,7681);b.setStencilWriteMask(255);b.setStencilFunctionSeparate(1032,
516,a.stencilRef,255)};c.prototype.draw=function(b,a){b=b.context;this._initialized||this._initialize(b);b.bindVAO(this._solidVertexArrayObject);b.bindProgram(this._solidProgram);this._solidProgram.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs);this._solidProgram.setUniform2fv("u_coord_range",a.coordRange);this._solidProgram.setUniform1f("u_depth",0);this._solidProgram.setUniform4fv("u_color",this._color);b.drawArrays(5,0,4);b.bindVAO()};c.prototype._initialize=function(b){if(this._initialized)return!0;
var a=k.createProgram(b,g.background);if(!a)return!1;var c=new Int8Array([0,0,1,0,0,1,1,1]),c=k.BufferObject.createVertex(b,35044,c);b=new k.VertexArrayObject(b,g.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:c});this._solidProgram=a;this._solidVertexArrayObject=b;return this._initialized=!0};return c}(l.default);a.default=f})},"esri/views/2d/engine/RasterTile":function(){define(["require","exports","tslib","./RasterBitmap",
"./webgl/TiledDisplayObject"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function g(c,e,b,d){void 0===d&&(d=null);var g=a.call(this,c,e,b)||this;g.bitmap=new m.RasterBitmap(d,null,null);g.bitmap.coordScale=b;g.bitmap.once("isReady",function(){return g.ready()});return g}e.__extends(g,a);Object.defineProperty(g.prototype,"stencilRef",{get:function(){return this.bitmap.stencilRef},set:function(a){this.bitmap.stencilRef=a},enumerable:!0,configurable:!0});g.prototype.getMemoryUsage=
function(){return this.bitmap.getMemoryUsage()};g.prototype.setTransform=function(c,e){a.prototype.setTransform.call(this,c,e);this.bitmap.transforms.dvs=this.transforms.dvs};g.prototype.release=function(){this.destroy();this.stage=this.bitmap=null;return!0};g.prototype.onAttach=function(){this.bitmap.stage=this.stage};g.prototype.onDetach=function(){this.bitmap.stage=null};return g}(k.TiledDisplayObject);a.RasterTile=f})},"esri/views/2d/engine/RasterBitmap":function(){define("require exports tslib ../../../core/maybe ../../../core/libs/gl-matrix-2/mat3 ../../../core/libs/gl-matrix-2/mat3f32 ../../../core/libs/gl-matrix-2/vec2f32 ../../../layers/support/rasterFunctions/pixelUtils ./DisplayObject ../../webgl/rasterUtils".split(" "),
function(f,a,e,m,k,l,g,c,h,b){Object.defineProperty(a,"__esModule",{value:!0});var d={bandCount:3,outMin:0,outMax:1,minCutOff:[0,0,0],maxCutOff:[255,255,255],factor:[1/255,1/255,1/255],useGamma:!1,gamma:[1,1,1],gammaCorrection:[1,1,1],colormap:null,colormapOffset:null,type:"stretch"};f=function(a){function h(b,d,c){void 0===b&&(b=null);void 0===d&&(d=null);void 0===c&&(c=null);var e=a.call(this)||this;e._memoryUsed=null;e.stencilRef=0;e.coordScale=[1,1];e._symbolizerParameters=null;e.height=null;
e.pixelRatio=1;e.resolution=0;e.rotation=0;e._source=null;e.rawPixelData=null;e._suspended=!1;e._bandIds=null;e._interpolation=null;e._transformGrid=null;e.width=null;e.x=0;e.y=0;e.transforms={dvs:l.mat3f32.create()};e.source=b;e.transformGrid=d;e.interpolation=c;return e}e.__extends(h,a);Object.defineProperty(h.prototype,"symbolizerParameters",{get:function(){return this._symbolizerParameters||d},set:function(b){this._symbolizerParameters=b},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,
"source",{get:function(){return this._source},set:function(b){this._source=b;this._rasterTexture&&(this._rasterTexture.dispose(),this._memoryUsed=this._rasterTexture=null)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"suspended",{get:function(){return this._suspended},set:function(b){this._suspended&&!b&&this.stage&&(this.ready(),this.requestRender());this._suspended=b},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"bandIds",{get:function(){return this._bandIds},
set:function(b){this.stage&&this._updateRasterTexture(b);this._bandIds=b},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"interpolation",{get:function(){return this._interpolation},set:function(b){this._interpolation=b;this._rasterTexture&&this._rasterTexture.setSamplingMode("bilinear"===b||"cubic"===b?9729:9728)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"transformGrid",{get:function(){return this._transformGrid},set:function(b){this._transformGrid=b;this._transformGridTexture&&
(this._transformGridTexture.dispose(),this._memoryUsed=this._transformGridTexture=null)},enumerable:!0,configurable:!0});h.prototype.invalidateTexture=function(){this._updateTexture()};h.prototype.setTransform=function(b){var a=k.mat3.identity(this.transforms.dvs),d=b.toScreenNoRotation([0,0],this.x,this.y),c=this.resolution/this.pixelRatio/b.resolution,e=c*this.width,c=c*this.height,h=Math.PI*this.rotation/180;k.mat3.translate(a,a,g.vec2f32.fromValues(d[0],d[1]));k.mat3.translate(a,a,g.vec2f32.fromValues(e/
2,c/2));k.mat3.rotate(a,a,-h);k.mat3.translate(a,a,g.vec2f32.fromValues(-e/2,-c/2));k.mat3.scaleByVec2(a,a,g.vec2f32.fromValues(e,c));k.mat3.multiply(this.transforms.dvs,b.displayViewMat3,a)};h.prototype.getTextures=function(){if(!this._rasterTexture)return null;var b=[],a=[];this._transformGridTexture&&(a.push(this._transformGridTexture),b.push("u_transformGrid"));this._rasterTexture&&(a.push(this._rasterTexture),b.push("u_image"));this._colormapTexture&&(a.push(this._colormapTexture),b.push("u_colormap"));
return{names:b,textures:a}};h.prototype.getMemoryUsage=function(){if(m.isNone(this._memoryUsed)){var b=this.getTextures();if(null==b)return 0;this._memoryUsed=b.textures.map(function(b){return b.descriptor.width*b.descriptor.height*4}).reduce(function(b,a){return b+a})}return this._memoryUsed};h.prototype.onAttach=function(){this.invalidateTexture()};h.prototype.onDetach=function(){this.invalidateTexture()};h.prototype._updateTexture=function(){var a,d,c;this.stage?(a=this.stage.context,d=(d=this.source)&&
d.pixels&&0<d.pixels.length,!this._rasterTexture&&d&&this._updateRasterTexture(this.bandIds),this._rasterTexture&&d&&(this._updateColormapTexture(),this.transformGrid&&!this._transformGridTexture&&(this._transformGridTexture=b.createTransformTexture(a,this.transformGrid))),this._rasterTexture&&!d&&this._rasterTexture.setData(null),this.suspended||(this.ready(),this.requestRender())):(null===(a=this._rasterTexture)||void 0===a?void 0:a.dispose(),null===(d=this._transformGridTexture)||void 0===d?void 0:
d.dispose(),null===(c=this._colormapTexture)||void 0===c?void 0:c.dispose(),this._colormapTexture=this._transformGridTexture=this._rasterTexture=null)};h.prototype._updateRasterTexture=function(a){var d=this.source?c.extractBands(this.source,a):null;if(d&&d.pixels&&0<d.pixels.length){a=null==a&&null==this.bandIds||a&&this.bandIds&&a.join("")===this.bandIds.join("");if(this._rasterTexture){if(a)return;this._rasterTexture.dispose();this._rasterTexture=null}this._rasterTexture=b.createRasterTexture(this.stage.context,
d,this.interpolation||"nearest")}else this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null)};h.prototype._updateColormapTexture=function(){var a=this._colormap,d=this.symbolizerParameters.colormap;if(d){var c=this.stage.context;if(!a)this._colormapTexture=b.createColormapTexture(c,d),this._colormap=d;else if(d.length!==a.length||d.some(function(b,d){return b!==a[d]}))this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormapTexture=b.createColormapTexture(c,
d),this._colormap=d}else this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormap=null};return h}(h.DisplayObject);a.RasterBitmap=f})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["require","exports","../PixelBlock"],function(f,a,e){function m(a,e){a=Math.min(Math.max(a,-100),100);e=Math.min(Math.max(e,-100),100);var b,d,c=new Uint8Array(256);for(b=0;256>b;b++)0<a&&100>a?d=(200*b-25500+510*e)/(2*(100-a))+128:0>=a&&-100<a?d=(200*b-25500+
510*e)*(100+a)/2E4+128:100===a?(d=200*b-25500+256*(100-a)+510*e,d=0<d?255:0):-100===a&&(d=128),c[b]=255<d?255:0>d?0:d;return c}function k(a,e,b,d,g,f,k,l){return{xmin:g<=b*a?0:g<b*a+a?g-b*a:a,ymin:f<=d*e?0:f<d*e+e?f-d*e:e,xmax:g+k<=b*a?0:g+k<b*a+a?g+k-b*a:a,ymax:f+l<=d*e?0:f+l<d*e+e?f+l-d*e:e}}function l(a,h,b,d){var c=a.filter(function(b){return g(b)})[0];if(null==c)return null;var f=d?d.width:h.width;d=d?d.height:h.height;var l=c.width,q=c.height,m=h.width/l;h=h.height/q;var u=b?b.x:0;b=b?b.y:0;
var v=c.pixelType,y=e.getPixelArrayConstructor(v),z=c.pixels.length,c=[],A,B,D,C,E,F,I,J,G,H;for(E=0;E<z;E++){B=new y(f*d);for(F=0;F<h;F++)for(I=0;I<m;I++)if(D=a[F*m+I])for(A=D.pixels[E],H=k(l,q,I,F,u,b,f,d),J=H.ymin;J<H.ymax;J++)for(D=(F*q+J-b)*f+(I*l-u),C=J*l,G=H.xmin;G<H.xmax;G++)B[D+G]=A[C+G];c.push(B)}var K;if(a.some(function(b){return null==b||b.mask&&0<b.mask.length}))for(K=new Uint8Array(f*d),F=0;F<h;F++)for(I=0;I<m;I++)if(y=(D=a[F*m+I])?D.mask:null,H=k(l,q,I,F,u,b,f,d),y)for(J=H.ymin;J<H.ymax;J++)for(D=
(F*q+J-b)*f+(I*l-u),C=J*l,G=H.xmin;G<H.xmax;G++)K[D+G]=y[C+G];else if(D)for(J=H.ymin;J<H.ymax;J++)for(D=(F*q+J-b)*f+(I*l-u),C=J*l,G=H.xmin;G<H.xmax;G++)K[D+G]=1;else for(J=H.ymin;J<H.ymax;J++)for(D=(F*q+J-b)*f+(I*l-u),C=J*l,G=H.xmin;G<H.xmax;G++)K[D+G]=0;a=new e({width:f,height:d,pixels:c,pixelType:v,mask:K});a.updateStatistics();return a}Object.defineProperty(a,"__esModule",{value:!0});var g=function(a){return a&&"esri.layers.support.PixelBlock"===a.declaredClass&&a.pixels&&0<a.pixels.length};a.extractBands=
function(a,h){if(!h||!g(a))return a;var b=a.pixels.length;return h&&h.some(function(a){return a>=b})||1===b&&1===h.length&&0===h[0]||b===h.length&&!h.some(function(b,a){return b!==a})?a:new e({pixelType:a.pixelType,width:a.width,height:a.height,mask:a.mask,validPixelCount:a.validPixelCount,maskIsAlpha:a.maskIsAlpha,pixels:h.map(function(b){return a.pixels[b]}),statistics:a.statistics&&h.map(function(b){return a.statistics[b]})})};a.createColormapLUT=function(a){if(a){var c=a.colormap;if(c&&0!==c.length){var c=
c.sort(function(b,a){return b[0]-a[0]}),b=0;0>c[0][0]&&(b=c[0][0]);var d=Math.max(256,c[c.length-1][0]-b+1),e=new Uint8Array(4*d),g=[],f=0,k=0,l=5===c[0].length;if(65536<d)return c.forEach(function(a){g[a[0]-b]=l?a.slice(1):a.slice(1).concat([255])}),{indexed2DColormap:g,offset:b,alphaSpecified:l};if(a.fillUnspecified)for(a=c[k],f=a[0]-b;f<d;f++)e[4*f]=a[1],e[4*f+1]=a[2],e[4*f+2]=a[3],e[4*f+3]=l?a[4]:255,f===a[0]-b&&(a=k===c.length-1?a:c[++k]);else for(f=0;f<c.length;f++)a=c[f],k=4*(a[0]-b),e[k]=
a[1],e[k+1]=a[2],e[k+2]=a[3],e[k+3]=l?a[4]:255;return{indexedColormap:e,offset:b,alphaSpecified:l}}}};a.colorize=function(a,e){if(!g(a)||!e&&(e.indexedColormap||e.indexed2DColormap))return a;var b=a.clone(),d=b.pixels,c=b.mask,h=b.width*b.height;if(1!==d.length)return a;var f=e.indexedColormap;a=e.indexed2DColormap;var k=e.offset;e=e.alphaSpecified;var l=f.length-1,m=0,d=d[0],v=new Uint8Array(d.length),y=new Uint8Array(d.length),z=new Uint8Array(d.length),A=0;if(f)if(c)for(m=0;m<h;m++)c[m]&&(A=4*
(d[m]-k),A<k||A>l?c[m]=0:(v[m]=f[A],y[m]=f[A+1],z[m]=f[A+2],c[m]=f[A+3]));else{c=new Uint8Array(h);for(m=0;m<h;m++)A=4*(d[m]-k),A<k||A>l?c[m]=0:(v[m]=f[A],y[m]=f[A+1],z[m]=f[A+2],c[m]=f[A+3]);b.mask=c}else if(c)for(m=0;m<h;m++)c[m]&&(f=a[d[m]],v[m]=f[0],y[m]=f[1],z[m]=f[2],c[m]=f[3]);else{c=new Uint8Array(h);for(m=0;m<h;m++)f=a[d[m]],v[m]=f[0],y[m]=f[1],z[m]=f[2],c[m]=f[3];b.mask=c}b.pixels=[v,y,z];b.statistics=null;b.pixelType="u8";b.maskIsAlpha=e;return b};a.estimateStatisticsHistograms=function(a){if(!g(a))return null;
a.statistics||a.updateStatistics();var c=a.pixels,b=a.mask,d=a.pixelType,e=a.statistics;a=a.width*a.height;var f=c.length,k,l,m,u,v,y=[],z=[],A,B,D;for(u=0;u<f;u++){A=new Uint32Array(256);D=c[u];if("u8"===d)if(k=-.5,l=255.5,b)for(v=0;v<a;v++)b[v]&&A[D[v]]++;else for(v=0;v<a;v++)A[D[v]]++;else{k=e[u].minValue;l=e[u].maxValue;m=(l-k)/256;B=new Uint32Array(257);if(b)for(v=0;v<a;v++)b[v]&&B[Math.floor((D[v]-k)/m)]++;else for(v=0;v<a;v++)B[Math.floor((D[v]-k)/m)]++;for(v=0;255>v;v++)A[v]=B[v];A[255]=B[255]+
B[256]}y.push({min:k,max:l,size:256,counts:A});for(v=D=B=m=0;256>v;v++)m+=A[v],B+=v*A[v];B/=m;for(v=0;256>v;v++)D+=A[v]*Math.pow(v-B,2);A=Math.sqrt(D/(m-1));m=(l-k)/256;v=(B+.5)*m+k;A*=m;z.push({min:k,max:l,avg:v,stddev:A})}return{statistics:z,histograms:y}};a.createStretchLUT=function(a){var c=a.minCutOff,b=a.maxCutOff,d=a.gamma,e=a.pixelType,g=a.outMin||0,f=a.outMax||255;if(-1===["u8","u16","s8","s16"].indexOf(e))return null;var k=c.length,l,u=0;"s8"===e?u=-127:"s16"===e&&(u=-32767);var v=256;-1<
["u16","s16"].indexOf(e)&&(v=65536);for(var y=[],z=f-g,e=0;e<k;e++)y[e]=b[e]-c[e];l=d&&d.length>=k;var A=[];if(l)for(e=0;e<k;e++)A[e]=1<d[e]?2<d[e]?6.5+Math.pow(d[e]-2,2.5):6.5+100*Math.pow(2-d[e],4):1;var B,D=[],C,E,F;if(l)for(e=0;e<k;e++){F=[];for(l=0;l<v;l++)C=l+u,B=(C-c[e])/y[e],E=1,1<d[e]&&(E-=Math.pow(1/z,B*A[e])),F[l]=C<b[e]&&C>c[e]?Math.floor(E*z*Math.pow(B,1/d[e]))+g:C>=b[e]?f:g;D[e]=F}else for(e=0;e<k;e++){F=[];for(l=0;l<v;l++)C=l+u,F[l]=C<=c[e]?g:C>=b[e]?f:Math.floor((C-c[e])/y[e]*z)+g;
D[e]=F}if(null!=a.contrastOffset)for(a=m(a.contrastOffset,a.brightnessOffset),e=0;e<k;e++)for(F=D[e],l=0;l<v;l++)F[l]=a[F[l]];return{lut:D,offset:u}};a.createContrastBrightnessLUT=m;a.stretch=function(a,e){if(!g(a))return null;a=a.clone();var b=a.pixels,d=a.mask,c=e.minCutOff,h=e.maxCutOff,f=e.gamma,k=e.outMin||0;e=e.outMax||255;var l=a.width*a.height,m=b.length,v,y,z,A,B,D=e-k,C=[];for(v=0;v<m;v++)C[v]=h[v]-c[v];y=f&&f.length>=m;var E=[];if(y)for(v=0;v<m;v++)E[v]=1<f[v]?2<f[v]?6.5+Math.pow(f[v]-
2,2.5):6.5+100*Math.pow(2-f[v],4):1;if(y)if(null!=d)for(y=0;y<l;y++){if(d[y])for(v=0;v<m;v++)z=b[v][y],B=(z-c[v])/C[v],A=1,1<f[v]&&(A-=Math.pow(1/D,B*E[v])),b[v][y]=z<h[v]&&z>c[v]?Math.floor(A*D*Math.pow(B,1/f[v]))+k:z>=h[v]?e:k}else for(y=0;y<l;y++)for(v=0;v<m;v++)z=b[v][y],B=(z-c[v])/C[v],A=1,1<f[v]&&(A-=Math.pow(1/D,B*E[v])),b[v][y]=z<h[v]&&z>c[v]?Math.floor(A*D*Math.pow(B,1/f[v]))+k:z>=h[v]?e:k;else if(null!=d)for(y=0;y<l;y++){if(d[y])for(v=0;v<m;v++)z=b[v][y],b[v][y]=z<h[v]&&z>c[v]?Math.floor((z-
c[v])/C[v]*D)+k:z>=h[v]?e:k}else for(y=0;y<l;y++)for(v=0;v<m;v++)z=b[v][y],b[v][y]=z<h[v]&&z>c[v]?Math.floor((z-c[v])/C[v]*D)+k:z>=h[v]?e:k;a.pixelType="u8";a.updateStatistics();return a};a.lookupPixels=function(a,h){if(!g(a))return null;var b=a.pixels,d=a.mask,c=a.width*a.height,f=b.length,k=h.lut;h=h.offset;var l,m;k&&1===k[0].length&&(k=b.map(function(){return k}));var u=[],v,y,z;if(h)if(null==d)for(l=0;l<f;l++){v=b[l];y=k[l];z=new Uint8Array(c);for(m=0;m<c;m++)z[m]=y[v[m]-h];u.push(z)}else for(l=
0;l<f;l++){v=b[l];y=k[l];z=new Uint8Array(c);for(m=0;m<c;m++)d[m]&&(z[m]=y[v[m]-h]);u.push(z)}else if(null==d)for(l=0;l<f;l++){v=b[l];y=k[l];z=new Uint8Array(c);for(m=0;m<c;m++)z[m]=y[v[m]];u.push(z)}else for(l=0;l<f;l++){v=b[l];y=k[l];z=new Uint8Array(c);for(m=0;m<c;m++)d[m]&&(z[m]=y[v[m]]);u.push(z)}a=new e({width:a.width,height:a.height,pixels:u,mask:d,pixelType:"u8"});a.updateStatistics();return a};a.remapColor=function(a,e){if(!g(a))return null;a=a.clone();var b=a.width*a.height,d=e.length,c=
Math.floor(d/2),h=e[Math.floor(c)],f=a.pixels[0],k,l,m,v,y,z,A=!1,B=new Uint8Array(b),D=new Uint8Array(b),C=new Uint8Array(b),E=a.mask,F=4===e[0].mappedColor.length;E||(E=new Uint8Array(b),E.fill(F?255:1),a.mask=E);for(y=0;y<b;y++)if(E[y]){k=f[y];A=!1;z=c;l=h;m=0;for(v=d-1;1<v-m;){if(k===l.value){A=!0;break}k>l.value?m=z:v=z;z=Math.floor((m+v)/2);l=e[Math.floor(z)]}A||(k===e[m].value?(l=e[m],A=!0):k===e[v].value?(l=e[v],A=!0):k<e[m].value?(A=!1,l=null):k>e[m].value&&(k<e[v].value?(l=e[m],A=!0):v===
d-1?(A=!1,l=null):(l=e[v],A=!0)));A?(B[y]=l.mappedColor[0],D[y]=l.mappedColor[1],C[y]=l.mappedColor[2],E[y]=l.mappedColor[3]):B[y]=D[y]=C[y]=E[y]=0}a.pixels=[B,D,C];a.mask=E;a.pixelType="u8";a.maskIsAlpha=F;return a};a.getClipBounds=k;a.mosaicPixelData=function(a,e){if(!a||0===a.length)return null;var b=a.filter(function(b){return b.pixelBlock})[0];if(!b)return null;var d=(b.extent.xmax-b.extent.xmin)/b.pixelBlock.width,c=(b.extent.ymax-b.extent.ymin)/b.pixelBlock.height,g=.01*Math.min(d,c),h=a.sort(function(b,
a){return Math.abs(b.extent.ymax-a.extent.ymax)>g?a.extent.ymax-b.extent.ymax:Math.abs(b.extent.xmin-a.extent.xmin)>g?b.extent.xmin-a.extent.xmin:0}),f=Math.min.apply(null,h.map(function(b){return b.extent.xmin})),k=Math.min.apply(null,h.map(function(b){return b.extent.ymin})),m=Math.max.apply(null,h.map(function(b){return b.extent.xmax})),v=Math.max.apply(null,h.map(function(b){return b.extent.ymax}));a={x:Math.round((e.xmin-f)/d),y:Math.round((v-e.ymax)/c)};f={width:Math.round((m-f)/d),height:Math.round((v-
k)/c)};d={width:Math.round((e.xmax-e.xmin)/d),height:Math.round((e.ymax-e.ymin)/c)};if(Math.round(f.width/b.pixelBlock.width)*Math.round(f.height/b.pixelBlock.height)!==h.length||0>a.x||0>a.y||f.width<d.width||f.height<d.height)return null;b=h.map(function(b){return b.pixelBlock});b=l(b,f,a,d);return{extent:e,pixelBlock:b}};a.mosaic=l;a.setValidBoundary=function(a,e,b){if(!g(a))return null;var d=a.width,c=a.height,h=e.x;e=e.y;var f=b.width+h;b=b.height+e;if(0>h||0>e||f>d||b>c||0===h&&0===e&&f===d&&
b===c)return a;a.mask||(a.mask=new Uint8Array(d*c));for(var k=a.mask,l=0;l<c;l++)for(var m=l*d,v=0;v<d;v++)k[m+v]=l<e||l>=b||v<h||v>=f?0:1;a.updateStatistics();return a};a.clip=function(a,h,b){if(!g(a))return null;var d=h.x,c=h.y,f=h.x+b.width;h=h.x+b.height;if(h===a.height&&f===a.width)return a;for(var k=a.pixels,l=a.mask,m=a.width,u=m*a.height,v=k.length,y=[],z=0;z<v;z++){for(var A=k[z],B=e.createEmptyBand(a.pixelType,u),D=0,C=c;C<=h;C++)for(var E=C*m,F=d;F<=f;F++)B[D++]=A[E+F];y.push(B)}var I;
if(l)for(I=new Uint8Array(b.width*b.height),D=0,C=c;C<=h;C++)for(E=C*m,F=d;F<=f;F++)I[D++]=l[E+F];a=new e({width:b.width,height:b.height,pixels:y,mask:I});a.updateStatistics();return a};a.approximateTransform=function(a,h,b,d){if(!g(a))return null;var c=a.pixels,f=a.mask,k=a.pixelType,l=a.width,m=a.height;a=e.getPixelArrayConstructor(k);var u=c.length,v=h.width,y=h.height;h=d.cols;var z=d.rows,A=Math.ceil(v/h),B=Math.ceil(y/z),D=!1;for(d=0;d<b.length;d+=3)-1===b[d]&&-1===b[d+1]&&-1===b[d+2]&&(D=!0);
var C,E,F,I,J,G,H,K=new Float32Array(v*y),O=new Float32Array(v*y),L=0,N,T;for(d=0;d<B;d++)for(var R=0;R<A;R++){C=12*(d*A+R);E=b[C];F=b[C+1];I=b[C+2];J=b[C+3];G=b[C+4];H=b[C+5];for(var Q=0;Q<z;Q++){L=(d*z+Q)*v+R*h;T=(Q+.5)/z;for(var S=0;S<Q;S++)N=(S+.5)/h,K[L+S]=Math.round((E*N+F*T+I)*l-.5),O[L+S]=Math.round((J*N+G*T+H)*m-.5)}C+=6;E=b[C];F=b[C+1];I=b[C+2];J=b[C+3];G=b[C+4];H=b[C+5];for(Q=0;Q<z;Q++)for(L=(d*z+Q)*v+R*h,T=(Q+.5)/z,S=Q;S<h;S++)N=(S+.5)/h,K[L+S]=Math.round((E*N+F*T+I)*l-.5),O[L+S]=Math.round((J*
N+G*T+H)*m-.5)}b=function(b,a){for(var d=0;d<y;d++){C=d*v;for(var c=0;c<v;c++)b[C]=D&&(0>K[C]||0>O[C])?0:a[K[C]+O[C]*l],C++}};m=[];for(d=0;d<u;d++)h=new a(v*y),b(h,c[d]),m.push(h);c=new e({width:v,height:y,pixelType:k,pixels:m});if(f)c.mask=new Uint8Array(v*y),b(c.mask,f);else if(D)for(c.mask=new Uint8Array(v*y),d=0;d<v*y;d++)c.mask[d]=0>K[d]||0>O[d]?0:1;c.updateStatistics();return c}})},"esri/layers/support/PixelBlock":function(){define("require exports tslib ../../core/compilerUtils ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators".split(" "),
function(f,a,e,m,k,l,g,c,h,b){var d=c.getLogger("esri.layers.support.PixelBlock");return function(a){function c(b){b=a.call(this,b)||this;b.width=null;b.height=null;b.pixelType="f32";b.validPixelCount=null;b.mask=null;b.maskIsAlpha=!1;b.pixels=null;b.statistics=null;return b}e.__extends(c,a);f=c;c.createEmptyBand=function(b,a){return new (f.getPixelArrayConstructor(b))(a)};c.getPixelArrayConstructor=function(b){var a;switch(b){case "u1":case "u2":case "u4":case "u8":a=Uint8Array;break;case "u16":a=
Uint16Array;break;case "u32":a=Uint32Array;break;case "s8":a=Int8Array;break;case "s16":a=Int16Array;break;case "s32":a=Int32Array;break;case "u32":a=Uint32Array;break;case "f32":a=Float32Array;break;case "f64":a=Float64Array;break;case "c64":case "c128":case "unknown":a=Float32Array;break;default:m.neverReached(b)}return a};c.prototype.castPixelType=function(b){if(!b)return"f32";b=b.toLowerCase();-1<["u1","u2","u4"].indexOf(b)?b="u8":-1==="unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").indexOf(b)&&
(b="f32");return b};c.prototype.getPlaneCount=function(){return this.pixels&&this.pixels.length};c.prototype.addData=function(b){if(!b.pixels||b.pixels.length!==this.width*this.height)throw new k("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(b.pixels);this.statistics.push(b.statistics||{minValue:null,maxValue:null})};c.prototype.getAsRGBA=
function(){var b=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(b);break;default:this._fillFrom8Bit(b)}return new Uint8ClampedArray(b)};c.prototype.getAsRGBAFloat=function(){var b=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(b);return b};c.prototype.updateStatistics=function(){var b=this;this.statistics=this.pixels.map(function(a){return b._calculateBandStatistics(a,
b.mask)});var a=this.mask,d=0;if(a)for(var c=0;c<a.length;c++)a[c]&&d++;else d=this.width*this.height;this.validPixelCount=d};c.prototype.clamp=function(b){if(b&&"f64"!==b&&"f32"!==b){var a;switch(b){case "u8":a=[0,255];break;case "u16":a=[0,65535];break;case "u32":a=[0,4294967295];break;case "s8":a=[-128,127];break;case "s16":a=[-32768,32767];break;case "s32":a=[-2147483648,2147483647];break;default:a=[-3.4*1E39,3.4*1E39]}var d=a[0];a=a[1];for(var c=this.pixels,e=this.width*this.height,g=c.length,
h,k,l,n=[],m=0;m<g;m++){l=f.createEmptyBand(b,e);h=c[m];for(var p=0;p<e;p++)k=h[p],l[p]=k>a?a:k<d?d:k;n.push(l)}this.pixels=n;this.pixelType=b}};c.prototype.extractBands=function(b){var a=this;if(h.isNone(b)||0===b.length||null==this.pixels||0===this.pixels.length)return this;var d=this.pixels.length,c=b.some(function(b){return b>=a.pixels.length}),d=d===b.length&&!b.some(function(b,a){return b!==a});return c||d?this:new f({pixelType:this.pixelType,width:this.width,height:this.height,mask:this.mask,
validPixelCount:this.validPixelCount,maskIsAlpha:this.maskIsAlpha,pixels:b.map(function(b){return a.pixels[b]}),statistics:this.statistics&&b.map(function(b){return a.statistics[b]})})};c.prototype.clone=function(){var b=new f({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});this.mask&&(b.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));var a,d=f.getPixelArrayConstructor(this.pixelType);
if(this.pixels&&0<this.pixels.length){b.pixels=[];var c=this.pixels[0].slice;for(a=0;a<this.pixels.length;a++)b.pixels[a]=c?this.pixels[a].slice(0,this.pixels[a].length):new d(this.pixels[a])}if(this.statistics)for(b.statistics=[],a=0;a<this.statistics.length;a++)b.statistics[a]=g.clone(this.statistics[a]);return b};c.prototype._fillFrom8Bit=function(b){var a=this.mask,c=this.maskIsAlpha,e=this.pixels;if(b&&e&&e.length){var g,h,f;g=h=f=e[0];3<=e.length?(h=e[1],f=e[2]):2===e.length&&(h=e[1]);b=new Uint32Array(b);
e=this.width*this.height;if(g.length!==e)d.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(a&&a.length===e)if(c)for(c=0;c<e;c++)a[c]&&(b[c]=a[c]<<24|f[c]<<16|h[c]<<8|g[c]);else for(c=0;c<e;c++)a[c]&&(b[c]=-16777216|f[c]<<16|h[c]<<8|g[c]);else for(c=0;c<e;c++)b[c]=-16777216|f[c]<<16|h[c]<<8|g[c]}else d.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};c.prototype._fillFromNon8Bit=function(b){var a=this.pixels,c=this.mask,e=this.statistics;
if(b&&a&&a.length){var g=this.pixelType,h=1,f=0,h=1;e&&0<e.length?(f=e.map(function(b){return b.minValue}).reduce(function(b,a){return Math.min(b,a)}),h=e.map(function(b){return b.maxValue-b.minValue}).reduce(function(b,a){return Math.max(b,a)}),h=255/h):(h=255,"s8"===g?(f=-128,h=127):"u16"===g?h=65535:"s16"===g?(f=-32768,h=32767):"u32"===g?h=4294967295:"s32"===g?(f=-2147483648,h=2147483647):"f32"===g?(f=-3.4*1E39,h=3.4*1E39):"f64"===g&&(f=-Number.MAX_VALUE,h=Number.MAX_VALUE),h=255/(h-f));b=new Uint32Array(b);
var g=this.width*this.height,k,l,e=k=l=a[0];if(e.length!==g)return d.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=a.length)if(k=a[1],3<=a.length&&(l=a[2]),c&&c.length===g)for(a=0;a<g;a++)c[a]&&(b[a]=-16777216|(l[a]-f)*h<<16|(k[a]-f)*h<<8|(e[a]-f)*h);else for(a=0;a<g;a++)b[a]=-16777216|(l[a]-f)*h<<16|(k[a]-f)*h<<8|(e[a]-f)*h;else if(c&&c.length===g)for(a=0;a<g;a++)k=(e[a]-f)*h,c[a]&&(b[a]=-16777216|k<<16|k<<8|k);else for(a=0;a<g;a++)k=(e[a]-f)*h,b[a]=-16777216|
k<<16|k<<8|k}else d.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};c.prototype._fillFrom32Bit=function(b){var a=this.pixels,c=this.mask;if(!b||!a||!a.length)return d.error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");var e,g,h;e=g=h=a[0];3<=a.length?(g=a[1],h=a[2]):2===a.length&&(g=a[1]);var f=this.width*this.height;if(e.length!==f)return d.error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");var k=
0;if(c&&c.length===f)for(a=0;a<f;a++)b[k++]=e[a],b[k++]=g[a],b[k++]=h[a],b[k++]=c[a]&1;else for(a=0;a<f;a++)b[k++]=e[a],b[k++]=g[a],b[k++]=h[a],b[k++]=1};c.prototype._calculateBandStatistics=function(b,a){var d=Infinity,c=-Infinity,e=b.length,g,h=0;if(a)for(g=0;g<e;g++)a[g]&&(h=b[g],d=h<d?h:d,c=h>c?h:c);else for(g=0;g<e;g++)h=b[g],d=h<d?h:d,c=h>c?h:c;return{minValue:d,maxValue:c}};var f;e.__decorate([b.property({json:{write:!0}})],c.prototype,"width",void 0);e.__decorate([b.property({json:{write:!0}})],
c.prototype,"height",void 0);e.__decorate([b.property({json:{write:!0}})],c.prototype,"pixelType",void 0);e.__decorate([b.cast("pixelType")],c.prototype,"castPixelType",null);e.__decorate([b.property({json:{write:!0}})],c.prototype,"validPixelCount",void 0);e.__decorate([b.property({json:{write:!0}})],c.prototype,"mask",void 0);e.__decorate([b.property({json:{write:!0}})],c.prototype,"maskIsAlpha",void 0);e.__decorate([b.property({json:{write:!0}})],c.prototype,"pixels",void 0);e.__decorate([b.property({json:{write:!0}})],
c.prototype,"statistics",void 0);return c=f=e.__decorate([b.subclass("esri.layers.support.PixelBlock")],c)}(l.JSONSupport)})},"esri/views/webgl/rasterUtils":function(){define(["require","exports","../webgl"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.createRasterTexture=function(a,f,l,g){void 0===l&&(l="nearest");void 0===g&&(g=!1);var c=!(g&&"u8"===f.pixelType);g=c?5126:5121;c=null==f.pixels||0===f.pixels.length?null:c?f.getAsRGBAFloat():f.getAsRGBA();return new e.Texture(a,
{width:f.width,height:f.height,target:3553,pixelFormat:6408,internalFormat:6408,samplingMode:"bilinear"===l||"cubic"===l?9729:9728,dataType:g,wrapMode:33071,flipped:!1},c)};a.createFrameBuffer=function(a,f,l,g){g=new e.Texture(a,{width:f,height:l,target:3553,pixelFormat:6408,internalFormat:6408,samplingMode:9728,dataType:g?5121:5126,wrapMode:33071,flipped:!1});return new e.FramebufferObject(a,{colorTarget:0,depthStencilTarget:3,width:f,height:l},g)};a.createTransformTexture=function(a,f){for(var k=
4*f.size[0],g=f.size[1],c={width:k,height:g,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5126,samplingMode:9728,wrapMode:33071,flipped:!1},k=new Float32Array(k*g*4),h=g=0;h<f.coefficients.length;h++)k[g++]=f.coefficients[h],2===h%3&&(k[g++]=1);return new e.Texture(a,c,k)};a.createColormapTexture=function(a,f){return new e.Texture(a,{width:f.length/4,height:1,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,flipped:!1},f)};a.getCommonUniforms=
function(a,e,f,g,c,h){void 0===g&&(g=1);void 0===c&&(c=!0);void 0===h&&(h=!1);return{u_flipY:c,u_isFloatTexture:h,u_applyTransform:a?!0:!1,u_opacity:g,u_transformSpacing:a?a.spacing:null,u_transformGridSize:a?a.size:null,u_targetImageSize:e,u_srcImageSize:f}};a.getColormapUniforms=function(a,e){return{u_colormapOffset:e||0,u_colormapMaxIndex:a?a.length/4-1:null}};a.getBasicGridUniforms=function(a,e){return{u_scale:a,u_offset:e}};a.getStretchUniforms=function(a){return{u_bandCount:a.bandCount,u_minOutput:a.outMin,
u_maxOutput:a.outMax,u_minCutOff:a.minCutOff,u_maxCutOff:a.maxCutOff,u_factor:a.factor,u_useGamma:a.useGamma,u_gamma:a.gamma,u_gammaCorrection:a.gammaCorrection}};a.getShadedReliefUniforms=function(a){return{u_hillshadeType:a.hillshadeType,u_sinZcosAs:a.sinZcosAs,u_sinZsinAs:a.sinZsinAs,u_cosZs:a.cosZs,u_weights:a.weights,u_factor:a.factor,u_minValue:a.minValue,u_maxValue:a.maxValue}};a.getUniformLocationInfos=function(a,e){a=a.gl;e=e.glName;for(var f=a.getProgramParameter(e,a.ACTIVE_UNIFORMS),g=
new Map,c,h=0;h<f;h++)(c=a.getActiveUniform(e,h))&&g.set(c.name,{location:a.getUniformLocation(e,c.name),info:c});return g};a.setUniforms=function(a,e,f){Object.keys(f).forEach(function(g){var c=e.get(g)||e.get(g+"[0]");if(c){var h=f[g];if(null!==c&&null!=h)switch(c=c.info,c.type){case 5126:1<c.size?a.setUniform1fv(g,h):a.setUniform1f(g,h);break;case 35664:a.setUniform2fv(g,h);break;case 35665:a.setUniform3fv(g,h);break;case 35666:a.setUniform4fv(g,h);break;case 35675:a.setUniformMatrix3fv(g,h);break;
case 35676:a.setUniformMatrix4fv(g,h);break;case 5124:1<c.size?a.setUniform1iv(g,h):a.setUniform1i(g,h);break;case 35670:a.setUniform1i(g,h?1:0);break;case 35667:case 35671:a.setUniform2iv(g,h);break;case 35668:case 35672:a.setUniform3iv(g,h);break;case 35669:case 35673:a.setUniform4iv(g,h)}}})};a.setTextures=function(a,e,f,g){f.length===g.length&&(g.some(function(a){return null==a})||f.some(function(a){return null==a})||f.forEach(function(c,h){e.setUniform1i(c,h);a.bindTexture(g[h],h)}))}})},"esri/views/2d/engine/RasterTileContainer":function(){define("require exports tslib ../../../geometry/support/aaBoundingRect ../engine ./RasterTile ./webgl/enums ./webgl/TileContainer".split(" "),
function(f,a,e,m,k,l,g,c){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e.__extends(b,a);b.prototype.createTile=function(b){var a=this._tileInfoView.getTileBounds(m.create(),b);return new l.RasterTile(b,a,this._tileInfoView.tileInfo.size)};b.prototype.destroyTile=function(){};b.prototype.prepareRenderPasses=function(b){var d=this,c=b.registerRenderPass({name:"bitmap (tile)",brushes:[k.brushes.Raster],target:function(){return d.children.map(function(b){return b.bitmap})},
drawPhase:g.WGLDrawPhase.MAP});return e.__spreadArrays(a.prototype.prepareRenderPasses.call(this,b),[c])};b.prototype.doRender=function(b){this.visible&&b.drawPhase===g.WGLDrawPhase.MAP&&a.prototype.doRender.call(this,b)};return b}(c.default);a.RasterTileContainer=f})},"esri/views/2d/engine/Stage":function(){define("require exports tslib ../../../core/Error ../../../core/events ../../../core/has ../../../core/promiseUtils ../../../core/scheduling ../../../core/SetUtils ../../../core/watchUtils ../../../core/libs/gl-matrix-2/common ../../../core/libs/gl-matrix-2/mat2d ../../../core/libs/gl-matrix-2/mat2df64 ../../../core/libs/gl-matrix-2/vec2 ../../../core/libs/gl-matrix-2/vec2f64 ../../webgl ./Container ./webgl/definitions ./webgl/enums ./webgl/Painter ./webgl/Profiler ./webgl/WebGLDriverTest ./webgl/shaders/StencilPrograms ../support/Timeline ../../support/screenshotUtils".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u,v,y,z,A,B,D,C,E){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function f(b,d){var e=a.call(this)||this;e._renderParameters={drawPhase:0,state:e.state,pixelRatio:window.devicePixelRatio,stationary:!1,globalOpacity:1,blendMode:null};e._trash=new Set;e._clipData=new Float32Array(8);e._upperLeft=q.vec2f64.create();e._upperRight=q.vec2f64.create();e._lowerLeft=q.vec2f64.create();e._lowerRight=q.vec2f64.create();e._mat2=p.mat2df64.create();e._clipRendererInitialized=
!1;e._supersampleScreenshots=!0;e.dataUploadCounter=0;e.renderRequested=!1;e.stage=e;e._stationary=!0;var g=d.canvas,g=void 0===g?document.createElement("canvas"):g,h=d.alpha,f=d.stencil,n=d.renderContext,u=d.supersampleScreenshots,u=void 0===u?!0:u,r=d.contextOptions,r=void 0===r?{}:r;e._canvas=g;h=x.createContextOrErrorHTML(g,{alpha:void 0===h?!0:h,antialias:!1,depth:!0,stencil:void 0===f?!0:f},void 0===n?"webgl":n);e.context=new x.RenderingContext(h,r);e.painter=new z.default(e.context,e);e._taskHandle=
c.addFrameTask({render:function(){return e.renderFrame()}});e._taskHandle.pause();e._supersampleScreenshots=u;e._lostWebGLContextHandle=k.on(g,"webglcontextlost",function(){e.emit("webgl-error",{error:new m("webgl-context-lost")})});l("esri-2d-profiler")&&(e._debugOutput=document.createElement("div"),e._debugOutput.setAttribute("style","margin: 24px 64px; position: absolute; color: red;"),b.appendChild(e._debugOutput));g.setAttribute("style","width: 100%; height:100%; display:block;");e.profiler=
new A.Profiler(e.context,e._debugOutput);e.renderingOptions=d.renderingOptions;e.timeline=d.timeline||new C.Timeline;e.driverTestResult=B.testWebGLDriver(e.context);b.appendChild(g);return e}e.__extends(f,a);f.prototype.destroy=function(){this.removeAllChildren();this.renderFrame();this._taskHandle.remove();this._boundFBO=this._taskHandle=null;this._clipFBO&&(this._clipFBO.dispose(),this._clipFBO=null);this._clipVAO&&(this._clipVAO.dispose(),this._clipVBO=this._clipVAO=null);this._clipStencilProgram&&
(this._clipStencilProgram.dispose(),this._clipStencilProgram=null);this._lostWebGLContextHandle&&(this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null);this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas);this._debugOutput&&this._debugOutput.parentNode&&this._debugOutput.parentNode.removeChild(this._debugOutput);this.painter.dispose();this.context.dispose();this._canvas=null};Object.defineProperty(f.prototype,"background",{get:function(){return this._background},
set:function(b){this._background=b;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"highlightOptions",{get:function(){return this._highlightOptions},set:function(a){var d=this;this._highlightOptionsHandle&&(this._highlightOptionsHandle.remove(),this._highlightOptionsHandle=null);if(this._highlightOptions=a)this._highlightOptionsHandle=b.init(this._highlightOptions,"version",function(){d.painter.setHighlightOptions(a);d.requestRender()})},enumerable:!0,configurable:!0});
Object.defineProperty(f.prototype,"renderingOptions",{get:function(){return this._renderingOptions},set:function(b){this._renderingOptions=b;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"state",{get:function(){return this._state},set:function(b){this._state=b;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"stationary",{get:function(){return this._stationary},set:function(b){this._stationary!==b&&(this._stationary=
b,this.requestRender())},enumerable:!0,configurable:!0});f.prototype.trashDisplayObject=function(b){this._trash.add(b);this.requestRender()};f.prototype.untrashDisplayObject=function(b){return this._trash.delete(b)};f.prototype.requestRender=function(){this._lastRenderRequestTime=Date.now();this.renderRequested||(this.renderRequested=!0,this.emit("will-render"),this._taskHandle&&this._taskHandle.resume())};f.prototype.renderFrame=function(){Date.now()-this._lastRenderRequestTime>=v.MAX_ANIMATION_TIME_MS&&
this._taskHandle.pause();this.renderRequested=!1;this._renderParameters.state=this._state;this._renderParameters.stationary=this.stationary;this._renderParameters.pixelRatio=window.devicePixelRatio;this._renderParameters.globalOpacity=1;for(this.processRender(this._renderParameters);0<this._trash.size;){var b=h.valuesOfSet(this._trash);this._trash.clear();for(var a=0;a<b.length;a++)b[a].processDetach()}this.emit("post-render")};f.prototype.renderChildren=function(b){var a=this.context,d=this.children,
d=b.children?b.children:d;this.profiler.recordStart("drawLayers");this.dataUploadCounter=0;this.beforeRenderChildren(b);b.drawPhase=y.WGLDrawPhase.MAP;this.painter.beforeRenderLayers(a,this.background);for(var c=0;c<d.length;c++){var e=d[c];e.processRender(b)}this.painter.renderLayers(a);b.drawPhase=y.WGLDrawPhase.LABEL;this.painter.beforeRenderLayers(a);for(c=0;c<d.length;c++)e=d[c],e.processRender(b);this.painter.renderLayers(a);if(l("esri-tiles-debug")){b.drawPhase=y.WGLDrawPhase.DEBUG;this.painter.beforeRenderLayers(a);
for(c=0;c<d.length;c++)e=d[c],e.processRender(b);this.painter.renderLayers(a)}this.profiler.recordEnd("drawLayers");this.afterRenderChildren()};f.prototype.beforeRenderChildren=function(b){var a=this.context,c=b.state,e=b.pixelRatio;if(this.painter){a.enforceState();var g=c.size;b=c.rotation;var h=Math.round(g[0]*e),g=Math.round(g[1]*e);this._boundFBO=a.getBoundFramebufferObject();if(c.spatialReference&&(c.spatialReference._isWrappable?c.spatialReference._isWrappable():c.spatialReference.isWrappable)){var f=
d.common.toRadian(b),k=Math.abs(Math.cos(f)),l=Math.abs(Math.sin(f)),m=Math.round(c.worldScreenWidth);if(Math.round(h*k+g*l)<=m)this._clipFrame=!1;else{this._clipFBO&&this._clipFBO.width===h&&this._clipFBO.height===g||(this._clipFBO=new x.FramebufferObject(a,{colorTarget:0,depthStencilTarget:3,width:h,height:g}));var p=(this.state.padding.left-this.state.padding.right)/2,q=(this.state.padding.bottom-this.state.padding.top)/2,u=.5*h,v=.5*g,c=1/h,y=1/g,e=.5*m*e,z=.5*(h*l+g*k),h=this._upperLeft,k=this._upperRight,
l=this._lowerLeft,m=this._lowerRight;r.vec2.set(h,-e,-z);r.vec2.set(k,e,-z);r.vec2.set(l,-e,z);r.vec2.set(m,e,z);n.mat2d.identity(this._mat2);n.mat2d.translate(this._mat2,this._mat2,[u+p,v+q]);0!==b&&n.mat2d.rotate(this._mat2,this._mat2,f);r.vec2.transformMat2d(h,h,this._mat2);r.vec2.transformMat2d(k,k,this._mat2);r.vec2.transformMat2d(l,l,this._mat2);r.vec2.transformMat2d(m,m,this._mat2);b=this._clipData;b.set([2*l[0]*c-1,2*(g-l[1])*y-1,2*m[0]*c-1,2*(g-m[1])*y-1,2*h[0]*c-1,2*(g-h[1])*y-1,2*k[0]*
c-1,2*(g-k[1])*y-1]);this._clipRendererInitialized||this._initializeClipRenderer(a);this._clipVBO.setData(b);this._boundFBO=a.getBoundFramebufferObject();a.bindFramebuffer(this._clipFBO);a.setDepthWriteEnabled(!0);a.setStencilWriteMask(255);a.setClearColor(0,0,0,0);a.setClearDepth(1);a.setClearStencil(0);a.clear(a.gl.COLOR_BUFFER_BIT|a.gl.DEPTH_BUFFER_BIT|a.gl.STENCIL_BUFFER_BIT);a.setDepthWriteEnabled(!1);this._clipFrame=!0}}else this._clipFrame=!1}};f.prototype.afterRenderChildren=function(){var b=
this.context;b.logIno();if(this._clipFrame&&this._clipRendererInitialized){b.bindFramebuffer(this._boundFBO);this._boundFBO=null;b.bindVAO(this._clipVAO);b.bindProgram(this._clipStencilProgram);b.setDepthWriteEnabled(!1);b.setDepthTestEnabled(!1);b.setStencilTestEnabled(!0);b.setBlendingEnabled(!1);b.setColorMask(!1,!1,!1,!1);b.setStencilOp(7680,7680,7681);b.setStencilWriteMask(255);b.setStencilFunction(519,1,255);b.drawElements(4,6,5123,0);b.bindVAO();b.setColorMask(!0,!0,!0,!0);if(null!=this.background){var a=
this.background.color,d=a.a;b.setClearColor(d*a.r/255,d*a.g/255,d*a.b/255,d)}else b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT);b.setBlendingEnabled(!0);b.setStencilFunction(514,1,255);this.painter.blitTexture(b,this._clipFBO.colorTexture,9728,1);b.setStencilTestEnabled(!1)}};f.prototype.doRender=function(b){var d=this.context,c=b.state,e=b.pixelRatio;this._resizeCanvas(b);this.context.enforceState();d.setViewport(0,0,e*c.size[0],e*c.size[1]);d.setDepthWriteEnabled(!0);d.setStencilWriteMask(255);
a.prototype.doRender.call(this,b)};f.prototype.takeScreenshot=function(b,a){var d=E.screenshotSuperSampleSettings(b,this._supersampleScreenshots,this._state.padding),c=d.framebufferWidth,e=d.framebufferHeight,h=this.context,f=b.layers,k={drawPhase:null,globalOpacity:1,stationary:!0,state:this._renderParameters.state.clone(),pixelRatio:d.pixelRatio,blendMode:null};if(null!=b.rotation){var l=k.state.viewpoint;l.rotation=b.rotation;k.state.viewpoint=l}0<f.length&&(k.children=[],f.forEach(function(b){var d=
a.find(function(a){return a.layer.id===b.id});d&&"container"in d&&d.container&&k.children.push(d.container)}));var n=new x.FramebufferObject(h,{colorTarget:0,depthStencilTarget:3,width:c,height:e}),f=h.getBoundFramebufferObject(),l=h.getViewport();h.bindFramebuffer(n);h.setViewport(0,0,c,e);this.renderChildren(k);d=this._readbackScreenshot(d);h.bindFramebuffer(f);h.setViewport(l.x,l.y,l.width,l.height);this.requestRender();h=this._ensureScreenshotEncodeCanvas();b=E.encodeResult(d,b,h,{flipY:!0,premultipliedAlpha:!0});
return g.resolve(b)};f.prototype._ensureScreenshotEncodeCanvas=function(){this._screenshotEncodeCanvas||(this._screenshotEncodeCanvas=document.createElement("canvas"));return this._screenshotEncodeCanvas};f.prototype._readbackScreenshot=function(b){var a=b.framebufferWidth,d=b.framebufferHeight,c=b.region;b=b.resample;var e=this.context.gl;if(b){var g=E.createEmptyImageData(a,d,this._ensureScreenshotEncodeCanvas());e.readPixels(0,0,a,d,6408,5121,new Uint8Array(g.data.buffer));a=E.createEmptyImageData(c.width,
c.height,this._ensureScreenshotEncodeCanvas());return E.resampleHermite(g,a,!0,b.region.x,d-(b.region.y+b.region.height),b.region.width,b.region.height)}g=E.createEmptyImageData(c.width,c.height,this._ensureScreenshotEncodeCanvas());e.readPixels(c.x,d-(c.y+c.height),c.width,c.height,6408,5121,new Uint8Array(g.data.buffer));return g};f.prototype._resizeCanvas=function(b){var a=this._canvas,d=a.style,c=b.state.size,e=b.pixelRatio;b=c[0];var c=c[1],g=Math.round(b*e),e=Math.round(c*e);if(a.width!==g||
a.height!==e)a.width=g,a.height=e;d.width=b+"px";d.height=c+"px"};f.prototype._initializeClipRenderer=function(b){if(this._clipRendererInitialized)return!0;var a=D.stencil.attributes,d=x.createProgram(b,D.stencil);if(!d)return!1;var c=x.BufferObject.createVertex(b,35040,32),e=new Uint16Array([0,1,2,2,1,3]),e=x.BufferObject.createIndex(b,35044,e);b=new x.VertexArrayObject(b,a,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,stride:8,normalized:!1,divisor:0}]},{geometry:c},e);this._clipStencilProgram=
d;this._clipVBO=c;this._clipVAO=b;return this._clipRendererInitialized=!0};return f}(u.Container);a.Stage=f})},"esri/views/2d/engine/webgl/Painter":function(){define("require exports ../../../../core/maybe ../../../webgl ../../engine ../vectorTiles/shaders/ProgramCache ./BitBlitRenderer ./enums ./MaterialManager ./TextureManager ./effects/AnimationEffect ./effects/BlendEffect ./effects/HighlightEffect ./effects/HittestEffect ./painter/RenderPass".split(" "),function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q){function x(b,
a){return 1!==a||e.isSome(b)&&"normal"!==b}Object.defineProperty(a,"__esModule",{value:!0});f=function(){return function(){}}();a.PainterOptions=f;f=function(){function a(a,c){this.context=a;this._blitRenderer=new g.BitBlitRenderer;this._brushCache=new Map;this._vtlProgramCache=null;this._blendEffect=new n.BlendEffect;this.brushNameToCtor={marker:k.brushes.Marker,line:k.brushes.Line,fill:k.brushes.Fill,text:k.brushes.Text,label:k.brushes.Label,clip:k.brushes.Clip,stencil:k.brushes.Stencil,bitmap:k.brushes.Bitmap,
tileInfo:k.brushes.TileInfo,vtlBackground:k.brushes.VTLBackground,vtlFill:k.brushes.VTLFill,vtlLine:k.brushes.VTLLine,vtlCircle:k.brushes.VTLCircle,vtlSymbol:k.brushes.VTLSymbol};this.effects={highlight:new p.default,hittest:new r.HittestEffect,integrate:new d.AnimationEffect};this.materialManager=new h(a);this._vtlProgramCache=new l.default(a);this.textureManager=new b(c)}a.prototype.getRenderTarget=function(){return this._renderTarget};a.prototype.setRenderTarget=function(b){this._renderTarget=
b};a.prototype.getFbos=function(b,a){if(b!==this._lastWidth||a!==this._lastHeight){this._lastWidth=b;this._lastHeight=a;if(this._fbos){for(var d in this._fbos)this._fbos[d].resize(b,a);return this._fbos}d={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:b,height:a};var c={colorTarget:0,depthStencilTarget:3};this._stencilBuf=b=new m.Renderbuffer(this.context,{width:b,height:a,internalFormat:34041});this._fbos={output:new m.FramebufferObject(this.context,c,d,b),blend:new m.FramebufferObject(this.context,
c,d,b),effect0:new m.FramebufferObject(this.context,c,d,b)}}return this._fbos};a.prototype.getSharedStencilBuffer=function(){return this._stencilBuf};a.prototype.beforeRenderLayers=function(b,a){void 0===a&&(a=null);var d=b.getViewport(),c=d.width,d=d.height;this._prevFBO=b.getBoundFramebufferObject();c=this.getFbos(c,d);b.bindFramebuffer(c.output);b.setDepthWriteEnabled(!0);e.isSome(a)?(a=a.color,c=a.a,b.setClearColor(c*a.r/255,c*a.g/255,c*a.b/255,c)):b.setClearColor(0,0,0,0);b.setClearDepth(1);
b.clear(b.gl.COLOR_BUFFER_BIT|b.gl.DEPTH_BUFFER_BIT);b.setDepthWriteEnabled(!1)};a.prototype.beforeRenderLayer=function(b,a,d){var c=b.context;x(b.blendMode,d)?(c.bindFramebuffer(this._fbos.blend),c.setColorMask(!0,!0,!0,!0),c.setClearColor(0,0,0,0),c.clear(c.gl.COLOR_BUFFER_BIT)):(b=this._getOutputFBO(),c.bindFramebuffer(b));c.setDepthWriteEnabled(!1);c.setDepthTestEnabled(!1);c.setStencilTestEnabled(!0);c.setClearStencil(a);c.setStencilWriteMask(255);c.clear(c.gl.STENCIL_BUFFER_BIT)};a.prototype.compositeLayer=
function(b,a){var d=b.context,c=b.blendMode;if(x(c,a)){var g=this._getOutputFBO();d.bindFramebuffer(g);d.setStencilTestEnabled(!1);d.setStencilWriteMask(0);d.setBlendingEnabled(!0);d.setBlendFunctionSeparate(1,771,1,771);d.setColorMask(!0,!0,!0,!0);d=e.isSome(c)?c:"normal";this._blendEffect.draw(b,this._fbos.blend.colorTexture,9728,d,a)}};a.prototype.renderLayers=function(b){b.bindFramebuffer(this._prevFBO);if(this._fbos){var a=this._getOutputFBO();b.setStencilTestEnabled(!1);b.setStencilWriteMask(0);
this.blitTexture(b,a.colorTexture,9728)}};a.prototype.dispose=function(){this.materialManager.dispose();this.textureManager.dispose();this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._vtlProgramCache&&(this._vtlProgramCache.dispose(),this._vtlProgramCache=null);this._brushCache&&(this._brushCache.forEach(function(b){return b.dispose()}),this._brushCache.clear(),this._brushCache=null);if(this._fbos)for(var b in this._fbos)this._fbos[b]&&this._fbos[b].dispose();if(this.effects)for(var a in this.effects)this.effects[a]&&
this.effects[a].dispose();this._prevFBO=null};a.prototype.getGeometryBrush=function(b){var a;b=(a={},a[c.WGLGeometryType.FILL]=k.brushes.Fill,a[c.WGLGeometryType.LINE]=k.brushes.Line,a[c.WGLGeometryType.MARKER]=k.brushes.Marker,a[c.WGLGeometryType.TEXT]=k.brushes.Text,a)[b];a=this._brushCache.get(b);void 0===a&&(a=new b,this._brushCache.set(b,a));return this._brushCache.get(b)};a.prototype.renderObject=function(b,a,d,c){d=this.brushNameToCtor[d];if(!d)return null;var e=this._brushCache.get(d);void 0===
e&&(e=new d,this._brushCache.set(d,e));e.prepareState(b,a,c);e.draw(b,a,c)};a.prototype.renderObjects=function(b,a,d,c){d=this.brushNameToCtor[d];if(!d)return null;var e=this._brushCache.get(d);void 0===e&&(e=new d,this._brushCache.set(d,e));e.drawMany(b,a,c)};a.prototype.getVectorTileProgramCach=function(){return this._vtlProgramCache};a.prototype.registerRenderPass=function(b){var a=this,d=b.brushes.map(function(b){a._brushCache.has(b)||a._brushCache.set(b,new b);return a._brushCache.get(b)});return new q.default(d,
b)};a.prototype.setHighlightOptions=function(b){this.effects.highlight.setHighlightOptions(b)};a.prototype.blitTexture=function(b,a,d,c){void 0===c&&(c=1);b.setBlendingEnabled(!0);b.setBlendFunctionSeparate(1,771,1,771);b.setColorMask(!0,!0,!0,!0);this._blitRenderer.render(b,a,d,c)};a.prototype._getOutputFBO=function(){return null!=this._renderTarget?this._renderTarget:this._fbos.output};return a}();a.default=f})},"esri/views/2d/engine/vectorTiles/shaders/ProgramCache":function(){define(["require",
"exports","../../../../webgl","./Programs"],function(f,a,e,m){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(a){this._cache=Array(8);for(var g=0;8>g;g++)this._cache[g]={};this._programRepo=new e.ProgramCache(a)}a.prototype.dispose=function(){this._programRepo&&(this._programRepo.dispose(),this._programRepo=null)};a.prototype.getProgram=function(a,e,c){var g=this._cache[a];g[e]||(a=this._programRepo.getProgram(this._getProgramTemplate(a),c),g[e]=a);return g[e]};a.prototype.getProgramAttributes=
function(a){switch(a){case 0:return m.background.attributes;case 5:return m.circle.attributes;case 1:return m.fill.attributes;case 4:return m.icon.attributes;case 3:return m.line.attributes;case 2:return m.outline.attributes;case 6:return m.text.attributes;default:return null}};a.prototype._getProgramTemplate=function(a){switch(a){case 0:return m.background;case 5:return m.circle;case 1:return m.fill;case 4:return m.icon;case 3:return m.line;case 2:return m.outline;case 6:return m.text;default:return null}};
return a}();a.default=f})},"esri/views/2d/engine/vectorTiles/shaders/Programs":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(f,a,e,m){Object.defineProperty(a,"__esModule",{value:!0});a.background={name:"background",shaders:function(a){return{vertexShader:e.glslifyDefineMap({ID:a.id,PATTERN:a.pattern})+m.resolveIncludes("background/background.vert"),fragmentShader:e.glslifyDefineMap({ID:a.id,PATTERN:a.pattern})+m.resolveIncludes("background/background.frag")}},
attributes:{a_pos:0}};a.circle={name:"circle",shaders:function(a){return{vertexShader:e.glslifyDefineMap({ID:a.id})+m.resolveIncludes("circle/circle.vert"),fragmentShader:e.glslifyDefineMap({ID:a.id})+m.resolveIncludes("circle/circle.frag")}},attributes:{a_pos:0,a_color:1,a_stroke_color:2,a_data:3}};var k=function(a){return e.glslifyDefineMap({ID:a.id,DD:a.dd,PATTERN:a.pattern})};a.fill={name:"fill",shaders:function(a){return{vertexShader:k(a)+m.resolveIncludes("fill/fill.vert"),fragmentShader:k(a)+
m.resolveIncludes("fill/fill.frag")}},attributes:{a_pos:0,a_color:1}};a.outline={name:"outline",shaders:function(a){return{vertexShader:e.glslifyDefineMap({ID:a.id,DD:a.dd})+m.resolveIncludes("outline/outline.vert"),fragmentShader:e.glslifyDefineMap({ID:a.id,DD:a.dd})+m.resolveIncludes("outline/outline.frag")}},attributes:{a_pos:0,a_offset:1,a_xnormal:2,a_color:3}};a.icon={name:"icon",shaders:function(a){return{vertexShader:e.glslifyDefineMap({ID:a.id,DD:a.dd,SDF:a.sdf})+m.resolveIncludes("icon/icon.vert"),
fragmentShader:e.glslifyDefineMap({ID:a.id,DD:a.dd,SDF:a.sdf})+m.resolveIncludes("icon/icon.frag")}},attributes:{a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3,a_visInfo:4,a_color:5,a_size:6}};var l=function(a){return e.glslifyDefineMap({ID:a.id,DD:a.dd,PATTERN:a.pattern})};a.line={name:"line",shaders:function(a){return{vertexShader:l(a)+m.resolveIncludes("line/line.vert"),fragmentShader:l(a)+m.resolveIncludes("line/line.frag")}},attributes:{a_pos:0,a_offsetAndNormal:1,a_accumulatedDistance:2,a_color:3,
a_width:4}};a.text={name:"text",shaders:function(a){return{vertexShader:e.glslifyDefineMap({ID:a.id,DD:a.dd})+m.resolveIncludes("text/text.vert"),fragmentShader:e.glslifyDefineMap({ID:a.id,DD:a.dd})+m.resolveIncludes("text/text.frag")}},attributes:{a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3,a_visInfo:4,a_color:5,a_size:6}}})},"esri/views/2d/engine/vectorTiles/shaders/sources/resolver":function(){define(["require","exports","../../../../../webgl","./shaderRepository"],function(f,a,e,m){Object.defineProperty(a,
"__esModule",{value:!0});var k=new e.ShaderCompiler(function(a){var e=m.default;a.split("/").forEach(function(a){e&&(e=e[a])});return e});a.resolveIncludes=function(a){return k.resolveIncludes(a)}})},"esri/views/2d/engine/vectorTiles/shaders/sources/shaderRepository":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});a.default={background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d u_opacity * color;\n#else\n  gl_FragColor \x3d u_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\nvoid main() {\n  gl_Position \x3d vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n}"},
circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float dist \x3d length(v_offset);\n  mediump float alpha \x3d smoothstep(0.0, -v_blur, dist - 1.0);\n  lowp float color_mix_ratio \x3d v_stroke_width \x3c 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\n  gl_FragColor \x3d alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"circle.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec4 a_color;\nattribute vec4 a_stroke_color;\nattribute vec4 a_data;\nconst float sizePrecision \x3d 0.25;\nconst float blurPrecision \x3d 0.03125;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_radius;\nuniform lowp vec4 u_color;\nuniform mediump float u_blur;\nuniform mediump float u_stroke_width;\nuniform lowp vec4 u_stroke_color;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n  v_color \x3d a_color * u_color;\n  v_stroke_color \x3d a_stroke_color * u_stroke_color;\n  v_stroke_width \x3d a_data[1] * sizePrecision * u_stroke_width;\n  v_radius \x3d a_data[2] * u_radius;\n  v_blur \x3d max(a_data[0] * blurPrecision + u_blur, u_antialiasingWidth / (v_radius + v_stroke_width));\n  mediump vec2 offset \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n  v_offset \x3d offset;\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d fract(v_tileTextureCoord);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_color[3] * color;\n#else\n  gl_FragColor \x3d v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"fill.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\n#ifdef DD\nattribute vec4 a_color;\n#endif\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\nvoid main()\n{\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n  vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\nuniform mediump float u_outlineSize;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include \x3cutil/encoding.glsl\x3e\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d rgba2float(texture2D(u_texture, v_tex)) - 0.5;\n  const float sofetEdgeRatio \x3d 0.248062016;\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * sofetEdgeRatio * size;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  if (u_outlineSize \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d u_outlineColor;\n    const float outlineLimitRatio \x3d (16.0 / 86.0);\n    float clampedOutlineSize \x3d sofetEdgeRatio * min(u_outlineSize, outlineLimitRatio * max(v_size.x, v_size.y));\n    outlinePixelColor *\x3d clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\n    gl_FragColor \x3d v_transparency * mixColors(fillPixelColor, outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_transparency * fillPixelColor;\n  }\n#else\n  lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d v_transparency * texColor;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_size;\n#endif\nuniform lowp vec4 u_color;\nuniform mediump float u_size;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeSpeed;\nuniform mediump float u_minfadeLevel;\nuniform mediump float u_maxfadeLevel;\nuniform mediump float u_fadeChange;\nuniform mediump float u_opacity;\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float tileCoordRatio \x3d 1.0 / 8.0;\nvoid main()\n{\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\n  mediump float a_angle         \x3d a_levelInfo[1];\n  mediump float a_minLevel      \x3d a_levelInfo[2];\n  mediump float a_maxLevel      \x3d a_levelInfo[3];\n  mediump float delta_z \x3d 0.0;\n  mediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  mediump float alpha \x3d u_fadeSpeed !\x3d 0.0 ? clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0) : 1.0;\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\n  {\n    v_transparency \x3d 0.0;\n  }\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n  {\n    v_transparency \x3d 1.0;\n  }\n  delta_z +\x3d step(v_transparency, 0.0);\n  vec2 offset \x3d C_OFFSET_PRECISION * a_vertexOffset;\n  v_size \x3d abs(offset);\n#ifdef SDF\n  offset \x3d (120.0 / 86.0) * offset;\n#endif\n#ifdef DD\n  mediump float icon_size \x3d a_size * u_size;\n#else\n  mediump float icon_size \x3d u_size;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(icon_size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n  v_transparency *\x3d v_color.w;\n}"},
line:{"line.frag":"varying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform mediump vec2 u_spriteSize;\nuniform sampler2D u_texture;\nconst mediump float tileCoordRatio \x3d 8.0;\n#else\nvarying mediump vec2 v_dasharray;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\n  mediump float relativeTexX \x3d mod((v_accumulatedDistance + v_normal.x * v_lineHalfWidth * tileCoordRatio) / u_spriteSize.x, 1.0);\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / u_spriteSize.y);\n  mediump vec2 texCoord \x3d mix(u_pattern_tl, u_pattern_br, vec2(relativeTexX, relativeTexY));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d alpha * v_color[3] * color;\n#else\n  lowp float dashPos \x3d  mod(v_accumulatedDistance, v_dasharray.x + v_dasharray.y);\n  lowp float dashAlpha \x3d clamp(min(dashPos, v_dasharray.x - dashPos) + 0.5, 0.0, 1.0);\n  dashAlpha \x3d max(sign(-v_dasharray.y), dashAlpha);\n  alpha *\x3d dashAlpha;\n  gl_FragColor \x3d alpha * v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"attribute vec2 a_pos;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistance;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_blur;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale \x3d 1.0 / 31.0;\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_width;\n#endif\nuniform lowp vec4 u_color;\nuniform mediump float u_width;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\n#ifndef PATTERN\nuniform mediump vec2 u_dasharray;\nvarying mediump vec2 v_dasharray;\n#endif\nvoid main()\n{\n  v_normal \x3d a_offsetAndNormal.zw * scale;\n#ifdef DD\n  v_lineHalfWidth \x3d a_width * u_width;\n#else\n  v_lineHalfWidth \x3d u_width;\n#endif\n  v_lineHalfWidth +\x3d u_antialiasing;\n  v_lineHalfWidth *\x3d 0.5;\n#ifndef PATTERN\n#ifdef DD\n  v_dasharray \x3d u_dasharray * a_width;\n#else\n  v_dasharray \x3d u_dasharray * u_width;\n#endif\n#endif\n  mediump vec2 dist \x3d v_lineHalfWidth * scale * a_offsetAndNormal.xy;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) +  u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n  v_accumulatedDistance \x3d a_accumulatedDistance.x;\n  v_blur \x3d u_blur + u_antialiasing;\n  #ifdef DD\n    v_color \x3d a_color * u_color;\n  #else\n    v_color \x3d u_color;\n  #endif\n  #ifdef ID\n    v_id \x3d u_id / 255.0;\n  #endif\n}"},
outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d abs(v_normal.y);\n  lowp float alpha \x3d smoothstep(1.0, 0.0, dist);\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#ifdef DD\nattribute vec4 a_color;\n#endif\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale \x3d 1.0 / 15.0;\nvoid main()\n{\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_normal \x3d a_xnormal;\n  mediump vec2 dist \x3d u_outline_width * scale * a_offset;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
text:{"text.frag":"uniform lowp sampler2D u_texture;\nuniform mediump float u_edgeDistance;\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  mediump float alpha \x3d smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist) * v_transparency;\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\nattribute vec4 a_visInfo;\nuniform lowp vec4 u_color;\n#ifdef DD\nattribute vec4 a_color;\n#endif\nvarying lowp vec4 v_color;\nuniform mediump float u_size;\n#ifdef DD\nattribute mediump float a_size;\n#endif\nvarying mediump float v_size;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeSpeed;\nuniform mediump float u_minfadeLevel;\nuniform mediump float u_maxfadeLevel;\nuniform mediump float u_fadeChange;\nuniform mediump float u_opacity;\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\nconst float offsetPrecision \x3d 1.0 / 8.0;\nconst mediump float edgePos \x3d 0.75;\nuniform mediump float u_edgeDistance;\nuniform mediump float u_edgeBlur;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale \x3d 1.0 / 24.0;\nvoid main()\n{\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\n  mediump float a_angle        \x3d a_levelInfo[1];\n  mediump float a_minLevel    \x3d a_levelInfo[2];\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\n  mediump float a_visMinAngle    \x3d a_visInfo[0];\n  mediump float a_visMaxAngle    \x3d a_visInfo[1];\n  mediump float delta_z \x3d 0.0;\n  mediump float angle \x3d mod(a_angle + u_mapRotation, 256.0);\n  if (a_visMinAngle \x3c a_visMaxAngle)\n  {\n    delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) + (1.0 - step(a_visMinAngle, angle)));\n  }\n  else\n  {\n    delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) * (1.0 - step(a_visMinAngle, angle)));\n  }\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  mediump float alpha \x3d u_fadeSpeed !\x3d 0.0 ? clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0) : 1.0;\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\n  {\n    v_transparency \x3d 0.0;\n  }\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n  {\n    v_transparency \x3d 1.0;\n  }\n  delta_z +\x3d step(v_transparency, 0.0);\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n#ifdef DD\n  if (u_halo \x3e 0.5)\n  {\n    v_color \x3d u_color;\n  }\n  else\n  {\n    v_color \x3d a_color * u_color;\n  }\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef DD\n  v_size \x3d a_size * u_size;\n#else\n  v_size \x3d u_size;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_edgeDistance \x3d edgePos - u_edgeDistance / v_size;\n  v_edgeWidth \x3d (u_antialiasingWidth + u_edgeBlur) / v_size;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * v_size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define(["require","exports","../../../webgl","./shaders/BitBlitPrograms"],function(f,a,e,m){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){this._initialized=
!1}a.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null);this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)};a.prototype.render=function(a,e,c,h){a&&(this._initialized||this._initialize(a),a.setBlendFunctionSeparate(1,771,1,771),a.bindVAO(this._vertexArrayObject),a.bindProgram(this._program),e.setSamplingMode(c),a.bindTexture(e,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",h),a.drawArrays(5,
0,4),a.bindTexture(null,0),a.bindVAO())};a.prototype._initialize=function(a){if(this._initialized)return!0;var g=m.bitBlit.attributes,c=e.createProgram(a,m.bitBlit);if(!c)return!1;var h=new Int8Array(16);h[0]=-1;h[1]=-1;h[2]=0;h[3]=0;h[4]=1;h[5]=-1;h[6]=1;h[7]=0;h[8]=-1;h[9]=1;h[10]=0;h[11]=1;h[12]=1;h[13]=1;h[14]=1;h[15]=1;a=new e.VertexArrayObject(a,g,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,
divisor:0}]},{geometry:e.BufferObject.createVertex(a,35044,h)});this._program=c;this._vertexArrayObject=a;return this._initialized=!0};return a}();a.BitBlitRenderer=f})},"esri/views/2d/engine/webgl/shaders/BitBlitPrograms":function(){define(["require","exports","./sources/resolver"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.bitBlit={name:"bitBlit",shaders:{vertexShader:e.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:e.resolveIncludes("bitBlit/bitBlit.frag")},attributes:{a_pos:0,
a_tex:1}}})},"esri/views/2d/engine/webgl/MaterialManager":function(){define("require exports tslib ../../../../core/maybe ../../../webgl ./enums ./shaders/MaterialPrograms".split(" "),function(f,a,e,m,k,l,g){var c=function(b){return b===l.WGLDrawPhase.HITTEST||b===l.WGLDrawPhase.LABEL_ALPHA},h=function(b,a,g,h){h=h.reduce(function(a,d){var c;return e.__assign(e.__assign({},a),(c={},c[d]=b.driverTestResult[d],c))},{});a=e.__assign(e.__assign(e.__assign(e.__assign({},a.getVariation()),b.rendererInfo.getVariation()),
{highlight:b.drawPhase===l.WGLDrawPhase.HIGHLIGHT,id:c(b.drawPhase)}),h);if(m.isSome(g))for(h=0;h<g.length;h++)a[g[h]]=!0;return a};return function(){function b(b){this._programByKey=new Map;this._programCache=new k.ProgramCache(b)}b.prototype.dispose=function(){this._programCache&&this._programCache.dispose()};b.prototype.getProgram=function(b,a,c,h){void 0===c&&(c=[]);void 0===h&&(h=[]);var d=a.path+c.join(".")+h.join(".");if(this._programByKey.has(d))return this._programByKey.get(d);h=h.reduce(function(a,
d){var c;return e.__assign(e.__assign({},a),(c={},c[d]=b.driverTestResult[d],c))},{});c=e.__assign(e.__assign({},c.reduce(function(b,a){var d;return e.__assign(e.__assign({},b),(d={},d[a]=!0,d))},{})),h);a=this._programCache.getProgram(g.createProgramTemplate(a.path,a.attributes),c);if(!a)throw Error("Unable to get program for key: ${key}");this._programByKey.set(d,a);return a};b.prototype.getMaterialProgram=function(b,a,e,f,k,x){void 0===x&&(x=["ignoresSamplerPrecision"]);var d,n=x;d=b.rendererInfo;
var p=b.drawPhase,n=a.getVariationHash()+"-"+n.join(".")+"-",p=(c(p)?1:0)|(p===l.WGLDrawPhase.HIGHLIGHT?2:0);d=n+p+"-"+d.getVariationHash()+"-"+(m.isSome(k)&&k.join("."));if(this._programByKey.has(d))return this._programByKey.get(d);b=h(b,a,k,x);e=this._programCache.getProgram(g.createProgramTemplate(e,f),b);if(!e)throw Error("Unable to get program for key: ${key}");this._programByKey.set(d,e);return e};return b}()})},"esri/views/2d/engine/webgl/shaders/MaterialPrograms":function(){define(["require",
"exports","../../../../webgl","./sources/resolver"],function(f,a,e,m){Object.defineProperty(a,"__esModule",{value:!0});var k=function(a){var g={},c;for(c in a){for(var h=c,b=void 0,b=""+h[0].toUpperCase(),d=1;d<h.length;d++){var f=h[d];f===f.toUpperCase()?(b+="_",b+=f):b+=f.toUpperCase()}g[b]=a[c]}return e.glslifyDefineMap(g)};a.createProgramTemplate=function(a,e){var c=a+a.substring(a.lastIndexOf("/"));return{name:name,attributes:e,shaders:function(a){return{vertexShader:k(a)+m.resolveIncludes(c+
".vert"),fragmentShader:k(a)+m.resolveIncludes(c+".frag")}}}}})},"esri/views/2d/engine/webgl/TextureManager":function(){define("require exports tslib ../../../../config ../../../../request ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ../../../../symbols/cim/Rasterizer ./definitions ./enums ./fontUtils ./GlyphMosaic ./GlyphSource ./SDFConverter ./SpriteMosaic ./animatedFormats/apng ./animatedFormats/gif ./util/BidiText ./util/Result ./util/symbolUtils".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u,v,y,z,A,B,D,C,E){function F(b){switch(b.type){case "CIMSolidStroke":case "CIMSolidFill":return!0;case "esriSFS":return"esriSFSSolid"===b.style||"esriSFSNull"===b.style;case "esriSLS":return"esriSLSSolid"===b.style||"esriSLSNull"===b.style;default:return!1}}function I(b){switch(b.type){case "esriSMS":case "esriPMS":case "CIMPointSymbol":case "CIMVectorMarker":case "CIMPictureMarker":case "CIMCharacterMarker":return!1;default:return!0}}function J(b){return e.__awaiter(this,
void 0,void 0,function(){var a,d;return e.__generator(this,function(c){switch(c.label){case 0:a=window.URL.createObjectURL(b),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,k(a,{responseType:"image"})];case 2:return d=c.sent().data,window.URL.revokeObjectURL(a),[2,d];case 3:return c.sent(),window.URL.revokeObjectURL(a),[2,new l("mapview-invalid-resource","Could not fetch requested resource at "+a)];case 4:return[2]}})})}function G(b,a){return e.__awaiter(this,void 0,void 0,function(){var d,c,g,
f,n,m,p,q,u;return e.__generator(this,function(r){switch(r.label){case 0:d=b.imageData?"data:"+b.contentType+";base64,"+b.imageData:b.url;if(-1===d.indexOf(";base64,"))return[3,1];g=d.indexOf(";base64,")+8;f=d.substring(g);n=atob(f);m=new Uint8Array(n.length);for(p=0;p<n.length;p++)m[p]=n.charCodeAt(p);c=m.buffer;return[3,4];case 1:return r.trys.push([1,3,,4]),[4,k(d,e.__assign({responseType:"array-buffer"},a))];case 2:return c=q=r.sent().data,[3,4];case 3:return u=r.sent(),h.isAbortError(u)?[3,4]:
[2,new l("mapview-invalid-resource","Could not fetch requested resource at "+d)];case 4:return[2,c]}})})}var H=n.vec2f32.create(),K=g.getLogger("esri.views.2d.engine.webgl.TextureManager"),O=function(){function b(b,a,d){this.mosaicType=b;this.page=a;this.sdf=d}b.fromMosaic=function(a,d){return new b(a,d.page,d.sdf)};return b}();return function(){function a(b){this._invalidFontsMap=new Map;this._sdfConverter=new y.default(126);this._bindingInfos=[];this._hashToBindingIndex=new Map;this._rasterizer=
new p.default;this._spriteMosaic=new z(b,2048,2048,500);this._glyphSource=new v(m.fontsUrl+"/{fontstack}/{range}.pbf");this._glyphMosaic=new u(1024,1024,this._glyphSource)}a.prototype.dispose=function(){this._spriteMosaic.dispose();this._glyphMosaic.dispose();this._rasterizer.dispose();this._rasterizer=this._glyphMosaic=this._spriteMosaic=null};Object.defineProperty(a.prototype,"sprites",{get:function(){return this._spriteMosaic},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glyphs",
{get:function(){return this._glyphMosaic},enumerable:!0,configurable:!0});a.prototype.rasterizeItem=function(b,a,d){return e.__awaiter(this,void 0,void 0,function(){var g,h,f,k=this;return e.__generator(this,function(e){switch(e.label){case 0:if(c.isNone(b))return K.error(new l("mapview-null-resource","Unable to rasterize null resource",void 0)),[2,null];g=b.type;switch(g){case "CIMTextSymbol":return[3,1];case "esriTS":return[3,1]}return[3,3];case 1:return[4,this._rasterizeText(b,a,d)];case 2:return h=
e.sent(),h.forEach(function(b){return k._setTextureBinding(q.MosaicType.GLYPH,b)}),[2,{glyphMosaicItems:h}];case 3:return b.type&&-1!==b.type.toLowerCase().indexOf("3d")?(K.error(new l("mapview-invalid-type","MapView does not support symbol type: "+b.type,b)),[2,null]):[4,this._rasterizeSpriteSymbol(b,d)];case 4:return f=e.sent(),C.ok(f)&&f&&this._setTextureBinding(q.MosaicType.SPRITE,f),[2,{spriteMosaicItem:f}]}})})};a.prototype.bindTextures=function(b,a,c){if(0!==c.textureBinding){var e=this._bindingInfos[c.textureBinding-
1];c=e.page;switch(e.mosaicType){case q.MosaicType.SPRITE:var e=this.sprites.getWidth(c),g=this.sprites.getHeight(c),e=d.vec2.set(H,e,g);this._spriteMosaic.bind(b,9729,c,r.TEXTURE_BINDING_SPRITE_ATLAS);a.setUniform1i("u_texture",r.TEXTURE_BINDING_SPRITE_ATLAS);a.setUniform2fv("u_mosaicSize",e);break;case q.MosaicType.GLYPH:e=this.glyphs.width;g=this.glyphs.height;e=d.vec2.set(H,e,g);this._glyphMosaic.bind(b,9729,c,r.TEXTURE_BINDING_GLYPH_ATLAS);a.setUniform1i("u_texture",r.TEXTURE_BINDING_GLYPH_ATLAS);
a.setUniform2fv("u_mosaicSize",e);break;default:K.error("mapview-texture-manager","Cannot handle unknown type "+e.mosaicType)}}};a.prototype._hashMosaic=function(b,a){return 1|b<<1|(a.sdf?1:0)<<2|a.page<<3};a.prototype._setTextureBinding=function(b,a){var d=this._hashMosaic(b,a);this._hashToBindingIndex.has(d)||(b=O.fromMosaic(b,a),this._hashToBindingIndex.set(d,this._bindingInfos.length+1),this._bindingInfos.push(b));a.textureBinding=this._hashToBindingIndex.get(d)};a.prototype._rasterizeText=function(b,
a,d){return e.__awaiter(this,void 0,void 0,function(){var c,g,h;return e.__generator(this,function(e){switch(e.label){case 0:c=x.getFullyQualifiedFontName(b.font);g=this._invalidFontsMap.has(c);var f;if(a)f=a;else{f=D.bidiText(b.text)[0];for(var k=[],n=0;n<f.length;n++)k.push(f.charCodeAt(n));f=k}h=f;e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this._glyphMosaic.getGlyphItems(g?"arial-unicode-ms-regular":c,h,d)];case 2:return[2,e.sent()];case 3:return e.sent(),K.error(new l("mapview-invalid-resource",
"Couldn't find font "+c+". Falling back to Arial Unicode MS Regular",void 0)),this._invalidFontsMap.set(c,!0),[2,this._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",h,d)];case 4:return[2]}})})};a.prototype._rasterizeSpriteSymbol=function(b,a){return e.__awaiter(this,void 0,void 0,function(){var d,c,g,h,f,k;return e.__generator(this,function(e){if(F(b))return[2,null];d=E.keyFromSymbol(b);return this._spriteMosaic.has(d)?[2,this._spriteMosaic.getSpriteItem(d)]:"esriSMS"===b.type&&b.path?[2,this._handleSVG(b,
d,a)]:b.url||b.imageData?[2,this._handleImage(b,d,a)]:(c=this._rasterizer.rasterizeJSONResource(b))?(g=c.size,h=c.image,f=c.sdf,k=c.simplePattern,[2,this._addItemToMosaic(d,g,{type:"static",data:h},I(b),f,k)]):[2,new l("TextureManager","unrecognized or null rasterized image")]})})};a.prototype._handleSVG=function(b,a,d){return e.__awaiter(this,void 0,void 0,function(){var c,g;return e.__generator(this,function(e){switch(e.label){case 0:return c=[126,126],[4,this._sdfConverter.draw(b.path,d)];case 1:return g=
e.sent(),[2,this._addItemToMosaic(a,c,{type:"static",data:new Uint32Array(g.buffer)},!1,!0,!0)]}})})};a.prototype._handleGIFOrPNG=function(b,a,d){return e.__awaiter(this,void 0,void 0,function(){var c,g,f,k,n,m,p,q,u,r,v,y;return e.__generator(this,function(e){switch(e.label){case 0:return[4,G(b,d)];case 1:c=e.sent();if(!C.ok(c))return[3,10];g=B.isGIF(c);f=A.isPNG(c);if(!g&&!f)return[2,new l("mapview-invalid-resource","Image data is neither GIF nor PNG!")];k=void 0;e.label=2;case 2:return e.trys.push([2,
7,,8]),g&&B.isAnimatedGIF(c)?[4,B.default.create(c,d)]:[3,4];case 3:return k=e.sent(),[3,6];case 4:return f&&A.isAnimatedPNG(c)?[4,A.default.create(c,d)]:[3,6];case 5:k=e.sent(),e.label=6;case 6:return[3,8];case 7:return n=e.sent(),h.isAbortError(n)?[3,8]:[2,new l("mapview-invalid-resource","Could not fetch requested resource!")];case 8:if(k&&C.ok(k))return[2,this._addItemToMosaic(a,[k.width,k.height],{type:"animated",data:k},I(b),!1,!1)];m=g?"image/gif":"image/png";p=new Blob([c],{type:m});return[4,
J(p)];case 9:if((q=e.sent())&&q instanceof HTMLImageElement)return u=this._rasterizer.rasterizeImageResource(q,b.colorSubstitutions),r=u.size,v=u.sdf,y=u.image,[2,this._addItemToMosaic(a,r,{type:"static",data:y},I(b),v,!1)];e.label=10;case 10:return[2,new l("mapview-invalid-resource","Could not handle resource!")]}})})};a.prototype._handleImage=function(a,d,c){return e.__awaiter(this,void 0,void 0,function(){var g,f,n,m,p,q,u;return e.__generator(this,function(r){switch(r.label){case 0:var v;(v=a.url&&
-1!==a.url.indexOf(".gif")||a.contentType&&"image/gif"===a.contentType||a.imageData&&-1!==a.imageData.indexOf("data:image/gif"))||(v=a.url&&-1!==a.url.indexOf(".png")||a.contentType&&"image/png"===a.contentType||a.imageData&&-1!==a.imageData.indexOf("data:image/png"));if(v)return[2,this._handleGIFOrPNG(a,d,c)];g=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url;r.label=1;case 1:return r.trys.push([1,3,,4]),[4,k(g,e.__assign({responseType:"image"},c))];case 2:return f=r.sent().data,-1!==
g.indexOf("data:image/svg+xml")&&(f.width=b.pt2px(a.width),f.height=b.pt2px(a.height)),n=this._rasterizer.rasterizeImageResource(f,a.colorSubstitutions),m=n.size,p=n.sdf,q=n.image,[2,this._addItemToMosaic(d,m,{type:"static",data:q},I(a),p,!1)];case 3:return u=r.sent(),h.isAbortError(u)?[3,4]:[2,new l("mapview-invalid-resource","Could not fetch requested resource at "+g)];case 4:return[2,void 0]}})})};a.prototype._addItemToMosaic=function(b,a,d,c,e,g){return this._spriteMosaic.addSpriteItem(b,a,d,
c,e,g)};return a}()})},"esri/symbols/cim/Rasterizer":function(){define("require exports ./CIMSymbolHelper ./Rect ./SDFHelper ./utils".split(" "),function(f,a,e,m,k,l){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){}a.prototype.dispose=function(){this._rasterizationCanvas=null};a.prototype.rasterizeJSONResource=function(a,g){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===a.type||"esriSFS"===a.type)return g=e.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,
a.style),{size:[g[1],g[2]],image:new Uint32Array(g[0].buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0};if("simple-line"===a.type||"esriSLS"===a.type)return g=e.SymbolHelper.rasterizeSimpleLine(a.style,a.cap),{size:[g[1],g[2]],image:new Uint32Array(g[0].buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0};var b,d;"simple-marker"===a.type||"esriSMS"===a.type||"line-marker"===a.type?(a=e.CIMSymbolHelper.fromSimpleMarker(a),d=k.getSDFInfo(a)):"CIMHatchFill"===a.type?(a=e.CIMSymbolHelper.fromCIMHatchFill(a),
b=new m.default(a.frame.xmin,-a.frame.ymax,a.frame.xmax-a.frame.xmin,a.frame.ymax-a.frame.ymin)):a.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===a.markerPlacement.type?(a=e.CIMSymbolHelper.fromCIMInsidePolygon(a),b=new m.default(a.frame.xmin,-a.frame.ymax,a.frame.xmax-a.frame.xmin,a.frame.ymax-a.frame.ymin)):d=k.getSDFInfo(a);if(d&&!g)return g=k.buildSDF(d),(b=g[0])?{size:[g[1],g[2]],image:new Uint32Array(b.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null;g=e.CIMSymbolHelper.rasterize(this._rasterizationCanvas,
a,b,!g);b=g[0];d=g[3];a=g[4];return b?{size:[g[1],g[2]],image:new Uint32Array(b.buffer),sdf:!1,simplePattern:!1,anchorX:d,anchorY:a}:null};a.prototype.rasterizeImageResource=function(a,e){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=a.width;this._rasterizationCanvas.height=a.height;var b=this._rasterizationCanvas.getContext("2d");a instanceof ImageData?b.putImageData(a,0,0):(a.setAttribute("width",a.width.toString()),a.setAttribute("height",
a.height.toString()),b.drawImage(a,0,0,a.width,a.height));b=b.getImageData(0,0,a.width,a.height);b=new Uint8Array(b.data);if(e)for(var d=0;d<e.length;d++){var c=e[d];if(c&&c.oldColor&&4===c.oldColor.length&&c.newColor&&4===c.newColor.length){var g=c.oldColor,h=g[0],f=g[1],k=g[2],g=g[3],m=c.newColor,c=m[0],v=m[1],y=m[2],z=m[3];if(h!==c||f!==v||k!==y||g!==z)for(m=0;m<b.length;m+=4)h===b[m]&&f===b[m+1]&&k===b[m+2]&&g===b[m+3]&&(b[m]=c,b[m+1]=v,b[m+2]=y,b[m+3]=z)}}for(m=0;m<b.length;m+=4)e=b[m+3]/255,
b[m]*=e,b[m+1]*=e,b[m+2]*=e;e=a.width;d=a.height;h=b;if(512<=e||512<=d)h=a.width/a.height,1<h?(e=512,d=Math.round(512/h)):(d=512,e=Math.round(512*h)),h=new Uint8Array(4*e*d),l.resampleHermite(b,a.width,a.height,new Uint8ClampedArray(h.buffer),e,d,!1);return{size:[e,d],image:new Uint32Array(h.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};return a}();a.default=f})},"esri/views/2d/engine/webgl/fontUtils":function(){define(["require","exports"],function(f,a){function e(a){a=a.toLowerCase().split(" ").join("-");
switch(a){case "serif":return"noto-serif";case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return a}}Object.defineProperty(a,"__esModule",{value:!0});a.getFullyQualifiedFontName=function(a){var f;a:{if(a.weight)switch(a.weight.toLowerCase()){case "bold":case "bolder":f="-bold";break a}f=""}var l;a:{if(a.style)switch(a.style.toLowerCase()){case "italic":case "oblic":l="-italic";break a}l=""}f+=
l;return e(a.family)+(0<f.length?f:"-regular")};a.getFontDecorationTop=function(a){switch(a){case "underline":return-26;case "line-through":return-18}return NaN}})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define("require exports tslib ../../../../core/has ../../../../core/promiseUtils ../../../webgl ./Rect ./RectangleBinPack".split(" "),function(f,a,e,m,k,l,g,c){function h(b){for(var a=new Set,d=0;d<b.length;d++)a.add(Math.floor(b[d]/256));return a}function b(b,a,c){b.has(a)||b.set(a,
c().then(function(){b.delete(a)}).catch(function(d){b.delete(a);k.throwIfNotAbortError(d)}));return b.get(a)}return function(){function a(b,a,d){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphCache={};this._textures=[];this._rangePromises=new Map;this.width=b;this.height=a;this._glyphSource=d;this._binPack=new c(b-4,a-4);this._glyphData.push(new Uint8Array(b*a));this._dirties.push(!0);this._textures.push(null);this._initDecorationGlyph()}a.prototype.dispose=
function(){this._binPack=null;for(var b=0,a=this._textures;b<a.length;b++){var d=a[b];d&&d.dispose()}this._textures.length=0;this._glyphData.length=0};a.prototype._initDecorationGlyph=function(){for(var b=[117,149,181,207,207,181,149,117],a=[],d=0;d<b.length;d++)for(var c=b[d],e=0;11>e;e++)a.push(c);b={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(a)};this._recordGlyph(b)};a.prototype.getGlyphItems=function(b,a,d){return e.__awaiter(this,void 0,void 0,function(){var c,g=
this;return e.__generator(this,function(e){switch(e.label){case 0:return c=this._getGlyphCache(b),[4,this._fetchRanges(b,a,d)];case 1:return e.sent(),[2,a.map(function(a){return g._getMosaicItem(c,b,a)})]}})})};a.prototype.bind=function(b,a,d,c){var e=this._getTexture(b,d);e.setSamplingMode(a);this._dirties[d]&&(e.setData(this._glyphData[d]),this._dirties[d]=!1);b.bindTexture(e,c)};a.prototype._getGlyphCache=function(b){this._glyphCache[b]||(this._glyphCache[b]={});return this._glyphCache[b]};a.prototype._getTexture=
function(b,a){this._textures[a]||(this._textures[a]=new l.Texture(b,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));return this._textures[a]};a.prototype._invalidate=function(){this._dirties[this._currentPage]=!0};a.prototype._fetchRanges=function(b,a,d){return e.__awaiter(this,void 0,void 0,function(){var c,g,f=this;return e.__generator(this,function(e){switch(e.label){case 0:return c=h(a),g=[],c.forEach(function(a){g.push(f._fetchRange(b,
a,d))}),[4,k.all(g)];case 1:return e.sent(),[2]}})})};a.prototype._fetchRange=function(a,d,c){return e.__awaiter(this,void 0,void 0,function(){var g,h=this;return e.__generator(this,function(e){if(256<d)return[2,null];g=a+d;return[2,b(this._rangePromises,g,function(){return h._glyphSource.getRange(a,d,c)})]})})};a.prototype._getMosaicItem=function(b,a,d){if(!b[d]){a=this._glyphSource.getGlyph(a,d);if(!a||!a.metrics)return{rect:new g.default(0,0,0,0),page:0,metrics:{left:0,width:0,height:0,advance:0,
top:0},code:d,sdf:!0};var c=this._recordGlyph(a);b[d]={rect:c,page:this._currentPage,metrics:a.metrics,code:d,sdf:!0};this._invalidate()}return b[d]};a.prototype._getMosaicItemsStable=function(b,a,d){var c=this,e=[],g=d.map(function(b){return b});d.map(function(b){return b}).sort().map(function(d){return c._getMosaicItem(b,a,d)}).forEach(function(b){var a=g.indexOf(b.code);e[a]=b;g[a]=null});return e};a.prototype._recordGlyph=function(b){var a=b.metrics;if(0===a.width)a=new g.default(0,0,0,0);else{var d=
a.width+6,e=a.height+6,a=this._binPack.allocate(d,e);a.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(null),this._initDecorationGlyph(),this._binPack=new c(this.width-4,this.height-4),a=this._binPack.allocate(d,e));var h=this._glyphData[this._currentPage];b=b.bitmap;var f=void 0,k=void 0;if(b)for(var l=0;l<e;l++)for(var f=
d*l,k=this.width*(a.y+l)+a.x,n=0;n<d;n++)h[k+n]=b[f+n];m("esri-glyph-debug")&&this._showDebugPage(h)}return a};a.prototype._showDebugPage=function(b){var a=document.createElement("canvas"),d=a.getContext("2d"),c=new ImageData(this.width,this.height),e=c.data;a.width=this.width;a.height=this.height;a.style.border="1px solid black";for(var g=0;g<b.length;++g)e[4*g+0]=b[g],e[4*g+1]=0,e[4*g+2]=0,e[4*g+3]=255;d.putImageData(c,0,0);document.body.appendChild(a)};return a}()})},"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["require",
"exports","./Rect"],function(f,a,e){return function(){function a(a,f){this._height=this._width=0;this._free=[];this._width=a;this._height=f;this._free.push(new e.default(0,0,a,f))}Object.defineProperty(a.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0});a.prototype.allocate=function(a,f){if(a>this._width||f>this._height)return new e.default;for(var g=
null,c=-1,h=0;h<this._free.length;++h){var b=this._free[h];a<=b.width&&f<=b.height&&(null===g||b.y<=g.y&&b.x<=g.x)&&(g=b,c=h)}if(null===g)return new e.default;this._free.splice(c,1);g.width<g.height?(g.width>a&&this._free.push(new e.default(g.x+a,g.y,g.width-a,f)),g.height>f&&this._free.push(new e.default(g.x,g.y+f,g.width,g.height-f))):(g.width>a&&this._free.push(new e.default(g.x+a,g.y,g.width-a,g.height)),g.height>f&&this._free.push(new e.default(g.x,g.y+f,a,g.height-f)));return new e.default(g.x,
g.y,a,f)};a.prototype.release=function(a){for(var e=0;e<this._free.length;++e){var g=this._free[e];if(g.y===a.y&&g.height===a.height&&g.x+g.width===a.x)g.width+=a.width;else if(g.x===a.x&&g.width===a.width&&g.y+g.height===a.y)g.height+=a.height;else if(a.y===g.y&&a.height===g.height&&a.x+a.width===g.x)g.x=a.x,g.width+=a.width;else if(a.x===g.x&&a.width===g.width&&a.y+a.height===g.y)g.y=a.y,g.height+=a.height;else continue;this._free.splice(e,1);this.release(a)}this._free.push(a)};return a}()})},"esri/views/2d/engine/webgl/GlyphSource":function(){define("require exports tslib ../../../../request ../../../../core/pbf ../../../../core/promiseUtils".split(" "),
function(f,a,e,m,k,l){var g=function(){function a(b){this._metrics=[];for(this._bitmaps=[];b.next();)switch(b.tag()){case 1:for(var a=b.getMessage();a.next();)switch(a.tag()){case 3:for(var c=a.getMessage(),e=void 0,g=void 0,h=void 0,f=void 0,k=void 0,l=void 0,m=void 0;c.next();)switch(c.tag()){case 1:e=c.getUInt32();break;case 2:g=c.getBytes();break;case 3:h=c.getUInt32();break;case 4:f=c.getUInt32();break;case 5:k=c.getSInt32();break;case 6:l=c.getSInt32();break;case 7:m=c.getUInt32();break;default:c.skip()}c.release();
e&&(this._metrics[e]={width:h,height:f,left:k,top:l,advance:m},this._bitmaps[e]=g);break;default:a.skip()}a.release();break;default:b.skip()}}a.prototype.getMetrics=function(b){return this._metrics[b]};a.prototype.getBitmap=function(b){return this._bitmaps[b]};return a}(),c=function(){function a(){this._ranges=[]}a.prototype.getRange=function(b){return this._ranges[b]};a.prototype.addRange=function(b,a){this._ranges[b]=a};return a}();return function(){function a(b){this._glyphInfo={};this._baseURL=
b}a.prototype.getRange=function(b,a,c){var d=this._getFontStack(b);if(d.getRange(a))return l.resolve();var h=256*a,f=h+255;b=this._baseURL.replace("{fontstack}",b).replace("{range}",h+"-"+f);return m(b,e.__assign({responseType:"array-buffer"},c)).then(function(b){d.addRange(a,new g(new k(new Uint8Array(b.data),new DataView(b.data))))})};a.prototype.getGlyph=function(b,a){if(b=this._getFontStack(b)){var d=Math.floor(a/256);if(!(256<d)&&(b=b.getRange(d)))return{metrics:b.getMetrics(a),bitmap:b.getBitmap(a)}}};
a.prototype._getFontStack=function(b){var a=this._glyphInfo[b];a||(a=this._glyphInfo[b]=new c);return a};return a}()})},"esri/views/2d/engine/webgl/SDFConverter":function(){define(["require","exports","../../../../core/promiseUtils","../../../../core/promiseUtils","./packingUtils"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(a){this.size=a;this.canvas=document.createElement("canvas");this.canvas.width=this.canvas.height=a;this.context=this.canvas.getContext("2d");
this._gridOuter=new Float64Array(a*a);this._gridInner=new Float64Array(a*a);this._f=new Float64Array(a);this._d=new Float64Array(a);this._z=new Float64Array(a+1);this._v=new Int16Array(a)}a.prototype.draw=function(a,c,h){var b=this;void 0===h&&(h=31);this._initSVG();var d=this._createSVGString(a);return e.create(function(a,e){var g=new Image;g.src="data:image/svg+xml; charset\x3dutf8, "+encodeURIComponent(d);g.onload=function(){b.context.clearRect(0,0,b.size,b.size);b.context.drawImage(g,0,0,b.size,
b.size);for(var d=b.context.getImageData(0,0,b.size,b.size),c=new Uint8Array(b.size*b.size*4),e=0;e<b.size*b.size;e++){var f=d.data[4*e+3]/255;b._gridOuter[e]=1===f?0:0===f?1E20:Math.pow(Math.max(0,.5-f),2);b._gridInner[e]=1===f?1E20:0===f?0:Math.pow(Math.max(0,f-.5),2)}b._edt(b._gridOuter,b.size,b.size);b._edt(b._gridInner,b.size,b.size);for(e=0;e<b.size*b.size;e++)k.packFloatRGBA(.5-(b._gridOuter[e]-b._gridInner[e])/(2*h),c,4*e);a(c)};var f=c&&c.signal;if(f)m.onAbort(f,function(){return e(m.createAbortError())})})};
a.prototype._initSVG=function(){if(!this._svg){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("style","position: absolute;");a.setAttribute("width","0");a.setAttribute("height","0");a.setAttribute("aria-hidden","true");a.setAttribute("role","presentation");document.body.appendChild(a);this._svg=a}};a.prototype._createSVGString=function(a){var c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d",a);this._svg.appendChild(c);a=c.getBBox();
var e=a.width/a.height,b=this.size/2,d,g,f;1<e?(g=d=b/a.width,f=this.size/4,e=b-1/e*b/2):(d=g=b/a.height,f=b-b*e/2,e=this.size/4);c.setAttribute("style","transform: matrix("+d+", 0, 0, "+g+", "+(-a.x*d+f)+", "+(-a.y*g+e)+")");a='\x3csvg style\x3d"fill:red;" height\x3d"'+this.size+'" width\x3d"'+this.size+'" xmlns\x3d"http://www.w3.org/2000/svg"\x3e'+this._svg.innerHTML+"\x3c/svg\x3e";this._svg.removeChild(c);return a};a.prototype._edt=function(a,c,e){for(var b=this._f,d=this._d,g=this._v,h=this._z,
f=0;f<c;f++){for(var k=0;k<e;k++)b[k]=a[k*c+f];this._edt1d(b,d,g,h,e);for(k=0;k<e;k++)a[k*c+f]=d[k]}for(k=0;k<e;k++){for(f=0;f<c;f++)b[f]=a[k*c+f];this._edt1d(b,d,g,h,c);for(f=0;f<c;f++)a[k*c+f]=Math.sqrt(d[f])}};a.prototype._edt1d=function(a,c,e,b,d){e[0]=0;b[0]=-1E20;b[1]=1E20;for(var g=1,h=0;g<d;g++){for(var f=(a[g]+g*g-(a[e[h]]+e[h]*e[h]))/(2*g-2*e[h]);f<=b[h];)h--,f=(a[g]+g*g-(a[e[h]]+e[h]*e[h]))/(2*g-2*e[h]);h++;e[h]=g;b[h]=f;b[h+1]=1E20}for(h=g=0;g<d;g++){for(;b[h+1]<g;)h++;c[g]=(g-e[h])*(g-
e[h])+a[e[h]]}};return a}();a.default=f})},"esri/views/2d/engine/webgl/packingUtils":function(){define(["require","exports"],function(f,a){function e(a){return a-Math.floor(a)}Object.defineProperty(a,"__esModule",{value:!0});var m=[1,256,65536,16777216],k=[1/256,1/65536,1/16777216,1/4294967296],l=function(a,c){void 0===c&&(c=0);for(var e=0,b=0;4>b;b++)e+=a[c+b]*k[b];return e}(new Uint8ClampedArray([255,255,255,255]));a.packFloatRGBA=function(a,c,h){void 0===h&&(h=0);a=0>a?0:a>l?l:a;for(var b=0;4>
b;b++)c[h+b]=Math.floor(256*e(a*m[b]))}})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("require exports ../../../../core/Error ../../../../core/has ../../../../core/maybe ../../../webgl ./GeometryUtils ./Rect ./RectangleBinPack".split(" "),function(f,a,e,m,k,l,g,c,h){function b(b){return b&&"static"===b.type}return function(){function a(b,a,d,c){void 0===c&&(c=0);this._mosaicPages=[];this._currentPage=this._maxItemSize=0;this._fixSpriteLocationsTable=m("fix-sprite-locations");this._testId=
m("test-id");this._pageHeight=this._pageWidth=0;this._mosaicRects=new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=a||0>=d)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=a;this._pageHeight=d;this._requestRender=b;0<c&&(this._maxItemSize=c);this.pixelRatio=window.devicePixelRatio||1;if(this._fixSpriteLocationsTable){b=[];for(var e in this._fixSpriteLocationsTable[this._testId])a=this._fixSpriteLocationsTable[this._testId][e],b[a.page]=
a.pageSize;for(e=0;e<b.length;e++)a=b[e],this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(a[0]*a[1])},size:[a[0],a[1]],dirty:!0,texture:void 0})}this._binPack=new h(this._pageWidth,this._pageHeight);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight))},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0})}a.prototype.getWidth=function(b){return b>=this._mosaicPages.length?-1:this._mosaicPages[b].size[0]};
a.prototype.getHeight=function(b){return b>=this._mosaicPages.length?-1:this._mosaicPages[b].size[1]};a.prototype.getPageTexture=function(b){return b<this._mosaicPages.length?this._mosaicPages[b].texture:null};a.prototype.has=function(b){return this._mosaicRects.has(b)};Object.defineProperty(a.prototype,"itemCount",{get:function(){return this._mosaicRects.size},enumerable:!0,configurable:!0});a.prototype.getSpriteItem=function(b){return this._mosaicRects.get(b)};a.prototype.addSpriteItem=function(a,
d,e,g,h,f){var k;if(this._mosaicRects.has(a))return this._mosaicRects.get(a);var l,n;b(e)?this._fixSpriteLocationsTable&&this._fixSpriteLocationsTable[this._testId]&&this._fixSpriteLocationsTable[this._testId][a]?(k=this._fixSpriteLocationsTable[this._testId][a],l=k.rect,n=k.page,k=k.pageSize):(k=this._allocateImage(d[0],d[1]),l=k[0],n=k[1],k=k[2]):(l=new c.default(0,0,d[0],d[1]),n=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:e,size:d,dirty:!0,texture:void 0}));if(0>=l.width||0>=l.height)return null;
f={rect:l,width:d[0],height:d[1],sdf:h,simplePattern:f,pixelRatio:1,page:n};this._mosaicRects.set(a,f);b(e)&&this._copy({rect:l,spriteSize:d,spriteData:e.data,page:n,pageSize:k,repeat:g,sdf:h});return f};a.prototype.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length};a.prototype.processNextItem=function(){var b=this._spriteCopyQueue.pop();b&&this._copy(b)};a.prototype.getSpriteItems=function(b){for(var a={},d=0;d<b.length;d++){var c=b[d];a[c]=this.getSpriteItem(c)}return a};a.prototype.getMosaicItemPosition=
function(b){var a=(b=this.getSpriteItem(b))&&b.rect;if(!a)return null;a.width=b.width;a.height=b.height;var d=this._mosaicPages[b.page];return{size:[b.width,b.height],tl:[(a.x+1)/d[0],(a.y+1)/d[1]],br:[(a.x+1+b.width)/d[0],(a.y+1+b.height)/d[1]],page:b.page}};a.prototype.bind=function(a,d,c,e){void 0===c&&(c=0);void 0===e&&(e=0);c=this._mosaicPages[c];var g=c.mosaicsData,h=c.texture;h||(h=c.size,h=b(g)?new l.Texture(a,{pixelFormat:6408,dataType:5121,width:h[0],height:h[1]},new Uint8Array(g.data.buffer)):
new l.Texture(a,{pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:h[0],height:h[1]},null),c.texture=h);h.setSamplingMode(d);b(g)?(a.bindTexture(h,e),c.dirty&&(h.setData(new Uint8Array(g.data.buffer)),h.generateMipmap())):(d=g.data,g=d.bindFrame(a,h,e),k.isSome(this._requestRender)&&g&&0<d.frameCount&&this._requestRender.requestRender(),d.bindFrame(a,h,e));c.dirty=!1};a._copyBits=function(b,a,d,c,e,g,h,f,k,l,m){var n=c*a+d;h=f*g+h;if(m)for(h-=g,m=-1;m<=l;m++,n=((m+l)%l+c)*a+d,
h+=g)for(f=-1;f<=k;f++)e[h+f]=b[n+(f+k)%k];else for(m=0;m<l;m++){for(f=0;f<k;f++)e[h+f]=b[n+f];n+=a;h+=g}};a.prototype._copy=function(d){if(!(d.page>=this._mosaicPages.length)){var c=this._mosaicPages[d.page],g=c.mosaicsData;if(!b(c.mosaicsData))throw new e("mapview-invalid-resource","unsuitable data type!");var h=d.spriteData;(g=g.data)&&h||console.error("Source or target images are uninitialized!");a._copyBits(h,d.spriteSize[0],0,0,g,d.pageSize[0],d.rect.x+1,d.rect.y+1,d.spriteSize[0],d.spriteSize[1],
d.repeat);c.dirty=!0}};a.prototype._allocateImage=function(a,d){a+=2;d+=2;var e=Math.max(a,d);if(this._maxItemSize&&this._maxItemSize<e){var e=Math.pow(2,Math.ceil(g.log2(a))),f=Math.pow(2,Math.ceil(g.log2(d)));a=new c.default(0,0,a,d);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(e*f)},size:[e,f],dirty:!0,texture:void 0});return[a,this._mosaicPages.length-1,[e,f]]}e=this._binPack.allocate(a,d);return 0>=e.width?(e=this._mosaicPages[this._currentPage],!e.dirty&&b(e.mosaicsData)&&
(e.mosaicsData=null),this._currentPage=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(this._pageWidth*this._pageHeight)},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0}),this._binPack=new h(this._pageWidth,this._pageHeight),this._allocateImage(a,d)):[e,this._currentPage,[this._pageWidth,this._pageHeight]]};a.prototype.dispose=function(){this._binPack=null;for(var a=0,d=this._mosaicPages;a<d.length;a++){var c=d[a],e=c.texture;e&&e.dispose();
c=c.mosaicsData;b(c)||c.data.pause()}this._mosaicPages=null;this._mosaicRects.clear()};return a}()})},"esri/views/2d/engine/webgl/animatedFormats/apng":function(){define(["require","exports","tslib","../../../../../core/Error","../../../../../core/promiseUtils"],function(f,a,e,m,k){function l(b){var a=b.constructor===Uint8Array?b:new Uint8Array(b);return v.some(function(b,d){return b!==a[d]})?!1:!0}function g(a,e){var g=new Uint8Array(e);if(v.some(function(b,a){return b!==g[a]}))return x;var h=!1;
c(g,function(b){return!(h="acTL"===b)});if(!h)return u;var f=[],k=[],l=null,m=null,p=0;c(g,function(d,c,e,g){var h=new DataView(c.buffer);switch(d){case "IHDR":l=c.subarray(e+8,e+8+g);a.width=h.getUint32(e+8);a.height=h.getUint32(e+12);break;case "acTL":a.numPlays=h.getUint32(e+8+4);break;case "fcTL":m&&(a.frames.push(m),p++);m=new y;m.width=h.getUint32(e+8+4);m.height=h.getUint32(e+8+8);m.left=h.getUint32(e+8+12);m.top=h.getUint32(e+8+16);d=h.getUint16(e+8+20);c=h.getUint16(e+8+22);0===c&&(c=100);
m.delay=1E3*d/c;10>=m.delay&&(m.delay=100);a.playTime+=m.delay;m.disposeOp=h.getUint8(e+8+24);m.blendOp=h.getUint8(e+8+25);m.dataParts=[];0===p&&2===m.disposeOp&&(m.disposeOp=1);break;case "fdAT":m&&m.dataParts.push(c.subarray(e+8+4,e+8+g));break;case "IDAT":m&&m.dataParts.push(c.subarray(e+8,e+8+g));break;case "IEND":k.push(b(c,e,12+g));break;default:f.push(b(c,e,12+g))}});if(0===a.frames.length)return u;a.frameCount=a.frames.length;var q=new Blob(f),r=new Blob(k);a.frames.forEach(function(b){var a=
[];a.push(v);l.set(n(b.width),0);l.set(n(b.height),4);a.push(d("IHDR",l));a.push(q);b.dataParts.forEach(function(b){return a.push(d("IDAT",b))});a.push(r);b.data=new Blob(a,{type:"image/png"});delete b.dataParts;a=null});return a}function c(b,a){var d=new DataView(b.buffer),c=8,e,g,h;do g=d.getUint32(c),e=c+4,e=Array.prototype.slice.call(b.subarray(e,e+4)),e=String.fromCharCode.apply(String,e),h=a(e,b,c,g),c+=12+g;while(!1!==h&&"IEND"!==e&&c<b.length)}function h(b){for(var a=new Uint8Array(b.length),
d=0;d<b.length;d++)a[d]=b.charCodeAt(d);return a}function b(b,a,d){var c=new Uint8Array(d);c.set(b.subarray(a,a+d));return c}function d(b,a){var d=b.length+a.length,c=new Uint8Array(d+8),e=new DataView(c.buffer);e.setUint32(0,a.length);c.set(h(b),4);c.set(a,8);var g=4,f=d;void 0===g&&(g=0);void 0===f&&(f=c.length-g);b=-1;a=g;for(g+=f;a<g;a++)b=b>>>8^p[(b^c[a])&255];e.setUint32(d+4,b^-1);return c}function n(b){return new Uint8Array([b>>>24&255,b>>>16&255,b>>>8&255,b&255])}Object.defineProperty(a,"__esModule",
{value:!0});var p=new Uint32Array(256);for(f=0;256>f;f++){for(var r=f,q=0;8>q;q++)r=0!==(r&1)?3988292384^r>>>1:r>>>1;p[f]=r}var x=new m("Not a PNG"),u=new m("Not an animated PNG"),v=new Uint8Array([137,80,78,71,13,10,26,10]);a.isPNG=l;a.getPNGSize=function(b){b=new Uint8Array(b);var a,d;c(b,function(b,c,e){c=new DataView(c.buffer);"IHDR"===b&&(a=c.getUint32(e+8),d=c.getUint32(e+12))});return[a,d]};a.isAnimatedPNG=function(b){b=new Uint8Array(b);if(!l(b))return!1;var a=!1;c(b,function(b){return!(a=
"acTL"===b)});return a};f=function(){function b(){this.playTime=this.numPlays=this.height=this.width=0;this.frames=[];this.playing=this.paused=!1;this.playSpeed=1;this.currentFrameNumber=0;this._lastUsedFrame=-1}b.create=function(a,d){return e.__awaiter(this,void 0,void 0,function(){var c,g;return e.__generator(this,function(e){switch(e.label){case 0:c=new b,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,c._load(a,d)];case 2:return e.sent(),[3,4];case 3:return g=e.sent(),k.isAbortError(g)?[3,4]:
[2,new m("invalid-resource","Could not load PNG: "+g.message)];case 4:return[2,c]}})})};b.prototype.play=function(){this.playing||(this.paused=!1,this.playing=!0,this._play())};b.prototype.pause=function(){this.paused=!0;this.playing=!1;clearTimeout(this.timerID)};b.prototype.togglePlay=function(){this.paused||!this.playing?this.play():this.pause()};b.prototype.bindFrame=function(b,a,d){b.bindTexture(a,d);b=this.frameChanged();if(!b)return!1;d=this.currentFrame;var c=d.frameData,e=a.descriptor;(d.left||
d.top||d.width!==e.width||d.height!==e.height)&&a.setData(null);a.updateData(0,d.left,d.top,d.width,d.height,c);this.updateUsedFrame();return b};b.prototype.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};b.prototype.updateUsedFrame=function(){this._lastUsedFrame=this.currentFrameNumber};b.prototype._load=function(b,a){return e.__awaiter(this,void 0,void 0,function(){var a,d,c=this;return e.__generator(this,function(e){switch(e.label){case 0:e.trys.push([0,2,,3]);a=g(this,
b);if(a!==this)return[2,a];this._resizeCanvas=document.createElement("canvas");this._resizeCanvas.width=this.width;this._resizeCanvas.height=this.height;return[4,k.all(this.frames.map(function(b){return b.createImage(c._resizeCanvas)}))];case 1:return e.sent(),[3,3];case 2:return d=e.sent(),k.isAbortError(d)?[3,3]:[2,new m("invalid-resource","Could not parse PNG")];case 3:return this.play(),[2]}})})};b.prototype._play=function(){var b=this,a;if(0===this.playSpeed)this.pause();else{0>this.playSpeed?
(--this.currentFrameNumber,0>this.currentFrameNumber&&(this.currentFrameNumber=this.frames.length-1),a=this.currentFrameNumber,--a,0>a&&(a=this.frames.length-1),a=1*-this.frames[a].delay/this.playSpeed):(this.currentFrameNumber+=1,this.currentFrameNumber%=this.frames.length,a=1*this.frames[this.currentFrameNumber].delay/this.playSpeed);var d=this.frames[this.currentFrameNumber];this.currentFrame={frameData:d.imageData,top:d.top,left:d.left,width:d.width,height:d.height};this.timerID=window.setTimeout(function(){return b._play()},
a)}};return b}();a.default=f;var y=function(){function b(){this.blendOp=this.disposeOp=this.delay=this.height=this.width=this.top=this.left=0;this.imageData=this.data=null}b.prototype.createImage=function(b){return e.__awaiter(this,void 0,void 0,function(){var a=this;return e.__generator(this,function(d){return null!==this.imageData?[2]:[2,k.create(function(d,c){var e=URL.createObjectURL(a.data),g=document.createElement("img");g.onload=function(){URL.revokeObjectURL(e);var c;b.width=g.width;b.height=
g.height;c=b.getContext("2d");c.drawImage(g,0,0,g.width,g.height);c=c.getImageData(0,0,g.width,g.height);c=new Uint8Array(c.data);for(var h,f=0;f<c.length;f+=4)h=c[f+3]/255,c[f]*=h,c[f+1]*=h,c[f+2]*=h;c=new ImageData(new Uint8ClampedArray(c.buffer),g.width,g.height);a.imageData=c;d()};g.onerror=function(){URL.revokeObjectURL(e);a.imageData=null;c(Error("Image creation error"))};g.src=e})]})})};return b}()})},"esri/views/2d/engine/webgl/animatedFormats/gif":function(){define(["require","exports","tslib",
"../../../../../core/Error","../../../../../core/promiseUtils"],function(f,a,e,m,k){function l(a){if(!a||0===a.byteLength)return!1;a=a.constructor===Uint8Array?a:new Uint8Array(a);return 71===a[0]&&73===a[1]&&70===a[2]&&56===a[3]}Object.defineProperty(a,"__esModule",{value:!0});a.isGIF=l;a.getGIFSize=function(a){var c=new Uint8ClampedArray(a),b=6;a=c[b++]+(c[b++]<<8);c=c[b++]+(c[b++]<<8);return[a,c]};a.isAnimatedGIF=function(a){if(!a||0===a.byteLength)return!1;a=new Uint8Array(a);if(!l(a))return!1;
for(var c=0,b=0,d=a.length-9;b<d&&(0!==a[b]||33!==a[b+1]||249!==a[b+2]||4!==a[b+3]||0!==a[b+8]||44!==a[b+9]&&33!==a[b+9]||(c++,!(1<c)));++b);return 1<c};f=function(){function a(){this.playing=this.paused=!1;this.waitTillDone=!0;this.firstFrameOnly=this.loading=!1;this.frames=[];this.comment="";this.frameCount=this.currentFrameNumber=this.length=0;this.playSpeed=1;this.lastFrame=null;this.playOnLoad=!0;this.complete=!1;this.interlaceOffsets=[0,4,2,1];this.interlaceSteps=[8,8,4,2];this._lastUsedFrame=
-1}a.create=function(c,b){return e.__awaiter(this,void 0,void 0,function(){var d,g;return e.__generator(this,function(e){switch(e.label){case 0:d=new a,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,d._load(c,b)];case 2:return e.sent(),[3,4];case 3:return g=e.sent(),k.isAbortError(g)?[3,4]:[2,new m("invalid-resource","Could not load PNG: "+g.message)];case 4:return[2,d]}})})};a.prototype.play=function(){this.playing||(this.paused=!1,this.playing=!0,this._play())};a.prototype.pause=function(){this.paused=
!0;this.playing=!1;clearTimeout(this.timerID)};a.prototype.togglePlay=function(){this.paused||!this.playing?this.play():this.pause()};a.prototype.bindFrame=function(a,b,d){a.bindTexture(b,d);if(a=this.frameChanged())d=this.currentFrame,b.updateData(0,0,0,d.width,d.height,d.frameData),this.updateUsedFrame();return a};a.prototype.seekFrame=function(a){clearTimeout(this.timerID);this.currentFrameNumber=a%this.frames.length;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};a.prototype.seek=
function(a){clearTimeout(this.timerID);0>a&&(a=0);a=1E3*a%this.length;for(var b=0;a>this.frames[b].time+this.frames[b].delay&&b<this.frames.length;)b+=1;this.currentFrameNumber=b;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};a.prototype.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};a.prototype.updateUsedFrame=function(){this._lastUsedFrame=this.currentFrameNumber};a.prototype._load=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var d;
return e.__generator(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),this.loading=!0,[4,this._parse(a,b)];case 1:return c.sent(),this.loading=!1,this.play(),[3,3];case 2:return d=c.sent(),k.isAbortError(d)?[3,3]:[2,new m("invalid-resource","Could not parse gif!")];case 3:return[2]}})})};a.prototype._parse=function(a,b){var d=this,c=new g(a);c.pos+=6;this.width=c.data[c.pos++]+(c.data[c.pos++]<<8);this.height=c.data[c.pos++]+(c.data[c.pos++]<<8);a=c.data[c.pos++];this.globalColourCount=
1<<(a&7)+1;c.pos++;c.pos++;a&128&&(this.globalColourTable=this._parseColourTable(this.globalColourCount,c));return k.create(function(a,e){setTimeout(function(){return d._parseBlock(c,a,e,b)},0)})};a.prototype._parseBlock=function(a,b,d,c){return e.__awaiter(this,void 0,void 0,function(){var g,h=this;return e.__generator(this,function(e){if(c&&c.signal&&k.isAborted(c.signal))return d(k.createAbortError()),[2];g=a.data[a.pos++];if(44===g){if(this._parseImg(a),this.firstFrameOnly)return this._finishedLoading(),
b(),[2]}else{if(59===g)return this._finishedLoading(),b(),[2];this._parseExt(a)}if("function"===typeof this.onprogress)this.onprogress({bytesRead:a.pos,totalBytes:a.data.length,frame:this.frames.length});setTimeout(function(){return h._parseBlock(a,b,d,c)},0);return[2]})})};a.prototype._parseColourTable=function(a,b){for(var d=[],c=0;c<a;c++)d.push([b.data[b.pos++],b.data[b.pos++],b.data[b.pos++]]);return d};a.prototype._parseImg=function(a){var b={};this.frames.push(b);b.disposalMethod=this.disposalMethod;
b.time=this.length;b.delay=10*this.delayTime;this.length+=b.delay;b.transparencyIndex=this.transparencyGiven?this.transparencyIndex:void 0;b.leftPos=a.data[a.pos++]+(a.data[a.pos++]<<8);b.topPos=a.data[a.pos++]+(a.data[a.pos++]<<8);b.width=a.data[a.pos++]+(a.data[a.pos++]<<8);b.height=a.data[a.pos++]+(a.data[a.pos++]<<8);var d=a.data[a.pos++];b.localColourTableFlag=d&128?!0:!1;b.localColourTableFlag&&(b.localColourTable=this._parseColourTable(1<<(d&7)+1,a));this.pixelBufSize!==b.width*b.height&&(this.pixelBuf=
new Uint8Array(b.width*b.height),this.pixelBufSize=b.width*b.height);this._lzwDecode(a.data[a.pos++],a.readSubBlocksB());if(d&64){b.interlaced=!0;a=b.width;d=this.pixelBufSize/a;this.interlacedBufSize!==this.pixelBufSize&&(this.deinterlaceBuf=new Uint8Array(this.pixelBufSize),this.interlacedBufSize=this.pixelBufSize);for(var c=0,e=0;4>e;e++)for(var g=this.interlaceOffsets[e];g<d;g+=this.interlaceSteps[e])this.deinterlaceBuf.set(this.pixelBuf.subarray(c,c+a),g*a),c+=a}else b.interlaced=!1;this._processFrame(b)};
a.prototype._lzwDecode=function(a,b){var d,c,e,g,h,f,k,l,m,z;e=c=0;var A=[];g=1<<a;h=g+1;f=a+1;for(z=!1;!z;){l=k;for(d=k=0;d<f;d++)b[e>>3]&1<<(e&7)&&(k|=1<<d),e++;if(k===g){A=[];f=a+1;for(d=0;d<g;d++)A[d]=[d];A[g]=[];A[h]=null}else{if(k===h){z=!0;break}k>=A.length?A.push(A[l].concat(A[l][0])):l!==g&&A.push(A[l].concat(A[k][0]));l=A[k];m=l.length;for(d=0;d<m;d++)this.pixelBuf[c++]=l[d];A.length===1<<f&&12>f&&f++}}};a.prototype._processFrame=function(a){a.image=document.createElement("canvas");a.image.width=
this.width;a.image.height=this.height;a.ctx=a.image.getContext("2d");var b=a.localColourTableFlag?a.localColourTable:this.globalColourTable;null===this.lastFrame&&(this.lastFrame=a);var d=2===this.lastFrame.disposalMethod||3===this.lastFrame.disposalMethod?!0:!1;d||a.ctx.drawImage(this.lastFrame.image,0,0,this.width,this.height);for(var c=a.ctx.getImageData(a.leftPos,a.topPos,a.width,a.height),e=a.transparencyIndex,g=c.data,h=a.interlaced?this.deinterlaceBuf:this.pixelBuf,f=h.length,k=0,l,m,z=0;z<
f;z++)l=h[z],m=b[l],e!==l?(g[k++]=m[0],g[k++]=m[1],g[k++]=m[2],g[k++]=255):(d&&(g[k+3]=0),k+=4);a.ctx.putImageData(c,a.leftPos,a.topPos);this.lastFrame=a};a.prototype._parseExt=function(a){var b=a.data[a.pos++];249===b?this._parseGCExt(a):254===b?this.comment+=a.readSubBlocks():255===b?this._parseAppExt(a):(1===b&&(a.pos+=13),a.readSubBlocks())};a.prototype._parseAppExt=function(a){a.pos+=1;"NETSCAPE"===a.getString(8)?a.pos+=8:(a.pos+=3,a.readSubBlocks())};a.prototype._parseGCExt=function(a){var b;
a.pos++;b=a.data[a.pos++];this.disposalMethod=(b&28)>>2;this.transparencyGiven=b&1?!0:!1;this.delayTime=a.data[a.pos++]+(a.data[a.pos++]<<8);this.transparencyIndex=a.data[a.pos++];a.pos++};a.prototype._finishedLoading=function(){this.loading=!1;this.frameCount=this.frames.length;this.lastFrame=null;this.complete=!0;this.deinterlaceBuf=this.pixelBufSize=this.deinterlaceBuf=this.pixelBuf=this.waitTillDone=this.transparencyIndex=this.delayTime=this.transparencyGiven=this.disposalMethod=void 0;this.currentFrameNumber=
0;0<this.frames.length&&this._setCurrentFrame(0);this.playOnLoad&&this.play()};a.prototype._play=function(){var a=this,b;0===this.playSpeed?this.pause():(0>this.playSpeed?(--this.currentFrameNumber,0>this.currentFrameNumber&&(this.currentFrameNumber=this.frames.length-1),b=this.currentFrameNumber,--b,0>b&&(b=this.frames.length-1),b=1*-this.frames[b].delay/this.playSpeed):(this.currentFrameNumber+=1,this.currentFrameNumber%=this.frames.length,b=1*this.frames[this.currentFrameNumber].delay/this.playSpeed),
this._setCurrentFrame(this.currentFrameNumber),this.timerID=window.setTimeout(function(){return a._play()},b))};a.prototype._setCurrentFrame=function(a){this.currentFrame={frameData:this.frames[a].image,top:0,left:0,width:this.width,height:this.height}};return a}();a.default=f;var g=function(){function a(a){this.pos=0;this.data=new Uint8ClampedArray(a);this.len=this.data.length}a.prototype.getString=function(a){for(var b="";a--;)b+=String.fromCharCode(this.data[this.pos++]);return b};a.prototype.readSubBlocks=
function(){var a,b,d="";do for(b=a=this.data[this.pos++];b--;)d+=String.fromCharCode(this.data[this.pos++]);while(0!==a&&this.pos<this.len);return d};a.prototype.readSubBlocksB=function(){var a,b,d=[];do for(b=a=this.data[this.pos++];b--;)d.push(this.data[this.pos++]);while(0!==a&&this.pos<this.len);return d};return a}()})},"esri/views/2d/engine/webgl/util/BidiText":function(){define(["require","exports","../../../../../core/BidiEngine"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});
var m=new e.default;a.bidiText=function(a){if(!m.hasBidiChar(a))return[a,!1];var e;e="rtl"===m.checkContextual(a)?"IDNNN":"ICNNN";return[m.bidiTransform(a,e,"VLYSN"),!0]}})},"esri/views/2d/engine/webgl/util/Result":function(){define(["require","exports","../../../../../core/Error"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.ok=function(a,f){return a&&"name"in a?(f&&f.error(new e(a.name,a.message,a.details)),!1):!0}})},"esri/views/2d/engine/webgl/util/symbolUtils":function(){define(["require",
"exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});a.keyFromSymbol=function(a){switch(a.type){case "esriSMS":return a.style+"."+a.path;case "esriSLS":return a.style+"."+a.cap;case "esriSFS":return""+a.style;case "esriPFS":case "esriPMS":return a.imageData?a.imageData:""+a.url+a.width+a.height;default:return a.mosaicHash?a.mosaicHash:JSON.stringify(a)}}})},"esri/views/2d/engine/webgl/effects/AnimationEffect":function(){define("require exports tslib ../../../../../core/maybe ../definitions ../VertexStream ./Effect".split(" "),
function(f,a,e,m,k,l,g){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b.defines=[];b._desc={path:"fx/integrate",attributes:{a_position:0}};return b}e.__extends(c,a);c.prototype.dispose=function(){this._quad&&this._quad.dispose()};c.prototype.bind=function(){};c.prototype.unbind=function(){};c.prototype.draw=function(a,d){if(d.size){var b=a.context,c=a.renderingOptions;this._quad||(this._quad=new l(b,[0,0,1,0,0,1,1,1]));var e=
b.getBoundFramebufferObject(),g=b.getViewport(),h=g.x,f=g.y,v=g.width,g=g.height;d.bindTextures(b);var y=d.getBlock(k.ATTRIBUTE_DATA_ANIMATION);if(!m.isNone(y)){var z=y.getFBO(b),y=y.getFBO(b,1);b.setViewport(0,0,d.size,d.size);this._computeDelta(a,y,c.labelsAnimationTime);this._updateAnimationState(a,y,z);b.bindFramebuffer(e);b.setViewport(h,f,v,g)}}};c.prototype._computeDelta=function(a,d,c){var b=a.context,e=a.displayLevel,g=a.painter.materialManager.getProgram(a,this._desc,["delta"]);b.bindFramebuffer(d);
b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT);b.bindProgram(g);g.setUniform1i("u_maskTexture",k.TEXTURE_BINDING_ATTRIBUTE_DATA_0);g.setUniform1i("u_sourceTexture",k.TEXTURE_BINDING_ATTRIBUTE_DATA_1);g.setUniform1f("u_timeDelta",a.timeDelta);g.setUniform1f("u_animationTime",c/1E3);g.setUniform1f("u_zoomLevel",Math.round(10*e));this._quad.draw()};c.prototype._updateAnimationState=function(a,d,c){var b=a.context;a=a.painter.materialManager.getProgram(a,this._desc,["update"]);b.bindTexture(d.colorTexture,
1);b.bindProgram(a);a.setUniform1i("u_sourceTexture",1);b.bindFramebuffer(c);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT);this._quad.draw()};return c}(g.Effect);a.AnimationEffect=f})},"esri/views/2d/engine/webgl/VertexStream":function(){define(["require","exports","../../../webgl"],function(f,a,e){return function(){function a(a,f){this.rctx=a;this._vertexBuffer=e.BufferObject.createVertex(a,35044,new Uint16Array(f));this._vao=new e.VertexArrayObject(a,{a_position:0},{geometry:[{name:"a_position",
count:2,type:5122,offset:0,stride:4,normalized:!1}]},{geometry:this._vertexBuffer})}a.prototype.bind=function(){this._vao.bind()};a.prototype.unbind=function(){this._vao.unbind()};a.prototype.dispose=function(){this._vao.dispose(!1);this._vertexBuffer.dispose()};a.prototype.draw=function(){this.rctx.bindVAO(this._vao);this.rctx.drawArrays(5,0,4)};return a}()})},"esri/views/2d/engine/webgl/effects/Effect":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});
f=function(){return function(){this.name=this.constructor.name}}();a.Effect=f})},"esri/views/2d/engine/webgl/effects/BlendEffect":function(){define("require exports ../../../../../core/Error ../../../../../core/Logger ../../../../webgl ../VertexStream ../shaders/BlendPrograms".split(" "),function(f,a,e,m,k,l,g){Object.defineProperty(a,"__esModule",{value:!0});var c=m.getLogger("esri.views.2d.engine.webgl.effects.blendEffects.BlendEffect");f=function(){function a(){this._size=[0,0]}a.prototype.dispose=
function(a){this._backBufferTexture&&(this._backBufferTexture.dispose(),this._backBufferTexture=null);this._programCache&&(this._programCache.dispose(),this._programCache=null);this._quad&&(this._quad.dispose(),this._quad=null)};a.prototype.draw=function(a,d,h,f,k){var b=a.context;this._setupShader(b);f&&"normal"!==f?this._drawBlended(a,d,h,f,k):(a=this._programCache.getProgram(g.blend,"normal"))?(b.bindProgram(a),d.setSamplingMode(h),b.bindTexture(d,0),a.setUniform1i("u_layerTexture",0),a.setUniform1f("u_opacity",
k),b.setBlendingEnabled(!0),b.setBlendFunction(1,771),d=this._quad,d.draw(),d.unbind()):c.error(new e("mapview-BlendEffect",'Error creating shader program for blend mode "normal"'))};a.prototype._drawBlended=function(a,d,h,f,k){var b=a.context,l=a.pixelRatio,n=a.state.size;this._createOrResizeTexture(a);a=l*n[0];var n=l*n[1],m=b.getBoundFramebufferObject(),l=this._backBufferTexture;m.copyToTexture(0,0,a,n,0,0,l);b.setStencilTestEnabled(!1);b.setStencilWriteMask(0);b.setBlendingEnabled(!0);b.setDepthTestEnabled(!1);
b.setDepthWriteEnabled(!1);(a=this._programCache.getProgram(g.blend,f))?(b.bindProgram(a),l.setSamplingMode(h),b.bindTexture(l,0),a.setUniform1i("u_backbufferTexture",0),d.setSamplingMode(h),b.bindTexture(d,1),a.setUniform1i("u_layerTexture",1),a.setUniform1f("u_opacity",k),b.setBlendFunction(1,0),d=this._quad,d.draw(),d.unbind(),b.setBlendFunction(1,771)):c.error(new e("mapview-BlendEffect","Error creating shader program for blend mode "+f))};a.prototype._setupShader=function(a){this._programCache||
(this._programCache=new k.ProgramCache(a),this._quad||(this._quad=new l(a,[-1,-1,1,-1,-1,1,1,1])))};a.prototype._createOrResizeTexture=function(a){var b=a.context,c=a.pixelRatio,e=a.state.size;a=c*e[0];c*=e[1];if(null===this._backBufferTexture||a!==this._size[0]||c!==this._size[1])this._backBufferTexture?this._backBufferTexture.resize(a,c):this._backBufferTexture=new k.Texture(b,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:a,height:c}),
this._size[0]=a,this._size[1]=c};return a}();a.BlendEffect=f})},"esri/views/2d/engine/webgl/shaders/BlendPrograms":function(){define(["require","exports","./sources/resolver"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.blend={name:"blend",attributes:{a_pos:0,a_tex:1},shaders:function(a){return{vertexShader:"#define "+a.replace("-","_").toUpperCase()+"\n"+e.resolveIncludes("blend/blend.vert"),fragmentShader:"#define "+a.replace("-","_").toUpperCase()+"\n"+e.resolveIncludes("blend/blend.frag")}}}})},
"esri/views/2d/engine/webgl/effects/HighlightEffect":function(){define("require exports tslib ../../../../../core/has ../BitBlitRenderer ./Effect ./highlight/HighlightGradient ./highlight/HighlightRenderer ./highlight/HighlightSurfaces".split(" "),function(f,a,e,m,k,l,g,c,h){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.defines=["highlight"];b._hlRenderer=new c.default;b._hlGradient=new g.default;b._width=void 0;b._height=
void 0;b._hlSurfaces=new h.default;b._adjustedWidth=void 0;b._adjustedHeight=void 0;b._blitRenderer=new k.BitBlitRenderer;return b}e.__extends(b,a);b.prototype.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose();this._hlRenderer&&this._hlRenderer.dispose();this._hlGradient&&this._hlGradient.destroy();this._boundFBO=null};b.prototype.bind=function(a){var b=a.context,d=a.painter,c=b.getViewport(),e=c.width,c=c.height,d=d.getFbos(e,c).effect0;this.setup(a,e,c);b.bindFramebuffer(d);b.setClearColor(0,
0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT)};b.prototype.unbind=function(){};b.prototype.setup=function(a,b,d){a=a.context;this._width=b;this._height=d;var c=b%4,e=d%4;b+=2>c?-c:4-c;d+=2>e?-e:4-e;this._adjustedWidth=b;this._adjustedHeight=d;this._boundFBO=a.getBoundFramebufferObject();b=Math.round(.75*b);d=Math.round(.75*d);this._hlRenderer.setup(a,b,d);this._hlSurfaces.setup(a,b,d)};b.prototype.draw=function(a){a=a.context;var b=a.getBoundFramebufferObject();a.setViewport(0,0,.75*this._adjustedWidth,.75*
this._adjustedHeight);a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);a.setStencilTestEnabled(!1);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._blitRenderer.render(a,b.colorTexture,9728,1);a.setStencilTestEnabled(!1);a.setBlendingEnabled(!1);a.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._hlRenderer.preBlur(a,this._hlSurfaces.sharedBlur1Tex);a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);a.setClearColor(0,0,0,
0);a.clear(a.gl.COLOR_BUFFER_BIT);this._hlRenderer.finalBlur(a,this._hlSurfaces.sharedBlur2Tex);a.bindFramebuffer(this._boundFBO);a.setBlendingEnabled(!0);a.setViewport(0,0,this._width,this._height);this._hlRenderer.renderHighlight(a,this._hlSurfaces.sharedBlur1Tex,this._hlGradient);this._boundFBO=null};b.prototype.setHighlightOptions=function(a){this._hlGradient.setHighlightOptions(a)};return b}(l.Effect);a.default=f})},"esri/views/2d/engine/webgl/effects/highlight/HighlightGradient":function(){define("require exports ../../../../../../core/Logger ../../../../../webgl ../../definitions ./parameters".split(" "),
function(f,a,e,m,k,l){function g(a,d){d.fillColor[0]=a.color.r/255;d.fillColor[1]=a.color.g/255;d.fillColor[2]=a.color.b/255;d.fillColor[3]=a.color.a;a.haloColor?(d.outlineColor[0]=a.haloColor.r/255,d.outlineColor[1]=a.haloColor.g/255,d.outlineColor[2]=a.haloColor.b/255,d.outlineColor[3]=a.haloColor.a):(d.outlineColor[0]=d.fillColor[0],d.outlineColor[1]=d.fillColor[1],d.outlineColor[2]=d.fillColor[2],d.outlineColor[3]=d.fillColor[3]);d.fillColor[3]*=a.fillOpacity;d.outlineColor[3]*=a.haloOpacity;
d.fillColor[0]*=d.fillColor[3];d.fillColor[1]*=d.fillColor[3];d.fillColor[2]*=d.fillColor[3];d.outlineColor[0]*=d.outlineColor[3];d.outlineColor[1]*=d.outlineColor[3];d.outlineColor[2]*=d.outlineColor[3];d.outlineWidth=l.HIGHLIGHT_SIZING.outlineWidth;d.outerHaloWidth=l.HIGHLIGHT_SIZING.outerHaloWidth;d.innerHaloWidth=l.HIGHLIGHT_SIZING.innerHaloWidth;d.outlinePosition=l.HIGHLIGHT_SIZING.outlinePosition}Object.defineProperty(a,"__esModule",{value:!0});var c=e.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),
h=[0,0,0,0];f=function(){function a(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:l.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:l.HIGHLIGHT_SIZING.outlineWidth,innerHaloWidth:l.HIGHLIGHT_SIZING.innerHaloWidth,outerHaloWidth:l.HIGHLIGHT_SIZING.outerHaloWidth};this.shadeTexChanged=!0;this.texelData=new Uint8Array(4*l.SHADE_TEXTURE_SIZE);this.minMaxDistance=[0,0]}a.prototype.setHighlightOptions=function(a){function b(a,b,d){z[0]=
(1-d)*a[0]+d*b[0];z[1]=(1-d)*a[1]+d*b[1];z[2]=(1-d)*a[2]+d*b[2];z[3]=(1-d)*a[3]+d*b[3]}var d,e=this._convertedHighlightOptions;g(a,e);a=e.outlinePosition-e.outlineWidth/2-e.outerHaloWidth;var f=e.outlinePosition-e.outlineWidth/2,k=e.outlinePosition+e.outlineWidth/2,m=e.outlinePosition+e.outlineWidth/2+e.innerHaloWidth,v=Math.sqrt(Math.PI/2)*l.SIGMAS[3],y=Math.abs(a)>v?Math.round(10*(Math.abs(a)-v))/10:0,v=Math.abs(m)>v?Math.round(10*(Math.abs(m)-v))/10:0;y&&!v?c.error("The outer rim of the highlight is "+
y+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!y&&v?c.error("The inner rim of the highlight is "+v+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):y&&v&&c.error("The highlight is "+Math.max(y,v)+"px away from the edge of the feature; consider reducing some width values.");for(var z=[void 0,void 0,void 0,
void 0],y=this.texelData,v=0;v<l.SHADE_TEXTURE_SIZE;++v)d=a+v/(l.SHADE_TEXTURE_SIZE-1)*(m-a),d<a?(z[4*v+0]=0,z[4*v+1]=0,z[4*v+2]=0,z[4*v+3]=0):d<f?b(h,e.outlineColor,(d-a)/(f-a)):d<k?(d=e.outlineColor,z[0]=d[0],z[1]=d[1],z[2]=d[2],z[3]=d[3]):d<m?b(e.outlineColor,e.fillColor,(d-k)/(m-k)):(d=e.fillColor,z[4*v+0]=d[0],z[4*v+1]=d[1],z[4*v+2]=d[2],z[4*v+3]=d[3]),y[4*v+0]=255*z[0],y[4*v+1]=255*z[1],y[4*v+2]=255*z[2],y[4*v+3]=255*z[3];this.minMaxDistance[0]=a;this.minMaxDistance[1]=m;this.shadeTexChanged=
!0};a.prototype.applyHighlightOptions=function(a,b){this.shadeTex||(this.shadeTex=new m.Texture(a,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:l.SHADE_TEXTURE_SIZE,height:1,samplingMode:9729}));this.shadeTexChanged&&(this.shadeTex.updateData(0,0,0,l.SHADE_TEXTURE_SIZE,1,this.texelData),this.shadeTexChanged=!1);a.bindTexture(this.shadeTex,k.TEXTURE_BINDING_HIGHLIGHT_1);b.setUniform2fv("u_minMaxDistance",this.minMaxDistance)};a.prototype.destroy=function(){this.shadeTex&&(this.shadeTex.dispose(),
this.shadeTex=null)};return a}();a.default=f})},"esri/views/2d/engine/webgl/effects/highlight/parameters":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});a.SIGMAS=[void 0,void 0,void 0,1];a.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1];a.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];a.SHADE_TEXTURE_SIZE=256;a.HIGHLIGHT_SIZING={outlineWidth:.7,outerHaloWidth:.7,innerHaloWidth:.7,outlinePosition:0}})},
"esri/views/2d/engine/webgl/effects/highlight/HighlightRenderer":function(){define("require exports ../../../../../webgl ../../definitions ./parameters ../../shaders/HighlightPrograms".split(" "),function(f,a,e,m,k,l){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){this._height=this._width=void 0;this._resources=null}a.prototype.dispose=function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),
this._resources.blurProgram.dispose(),this._resources=null)};a.prototype.preBlur=function(a,e){a.bindTexture(e,m.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",k.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};a.prototype.finalBlur=function(a,e){a.bindTexture(e,m.TEXTURE_BINDING_HIGHLIGHT_0);
a.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",k.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};a.prototype.renderHighlight=function(a,e,b){a.bindTexture(e,m.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.highlightProgram);b.applyHighlightOptions(a,this._resources.highlightProgram);a.bindVAO(this._resources.quadVAO);
a.setBlendingEnabled(!0);a.setBlendFunction(1,771);a.drawArrays(5,0,4);a.bindVAO()};a.prototype._initialize=function(a,g,b){this._width=g;this._height=b;g=new e.BufferObject(a,34962,35044,(new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1])).buffer);b=new e.VertexArrayObject(a,{a_position:0,a_texcoord:1},{geometry:[{name:"a_position",count:2,type:5120,offset:0,stride:4,normalized:!1},{name:"a_texcoord",count:2,type:5121,offset:2,stride:4,normalized:!1}]},{geometry:g});var d=e.createProgram(a,l.highlight);
a=e.createProgram(a,l.blur);d.setUniform1i("u_texture",m.TEXTURE_BINDING_HIGHLIGHT_0);d.setUniform1i("u_shade",m.TEXTURE_BINDING_HIGHLIGHT_1);d.setUniform4fv("u_sigmas",k.SIGMAS);a.setUniform1i("u_texture",m.TEXTURE_BINDING_HIGHLIGHT_0);a.setUniform4fv("u_sigmas",k.SIGMAS);this._resources={quadGeometry:g,quadVAO:b,highlightProgram:d,blurProgram:a}};a.prototype.setup=function(a,e,b){this._resources?(this._width=e,this._height=b):this._initialize(a,e,b)};return a}();a.default=f})},"esri/views/2d/engine/webgl/shaders/HighlightPrograms":function(){define(["require",
"exports","./sources/resolver"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.highlight={name:"highlight",shaders:{vertexShader:e.resolveIncludes("highlight/textured.vert"),fragmentShader:e.resolveIncludes("highlight/highlight.frag")},attributes:{a_position:0,a_texcoord:1}};a.blur={name:"blur",shaders:{vertexShader:e.resolveIncludes("highlight/textured.vert"),fragmentShader:e.resolveIncludes("highlight/blur.frag")},attributes:{a_position:0,a_texcoord:1}}})},"esri/views/2d/engine/webgl/effects/highlight/HighlightSurfaces":function(){define(["require",
"exports","../../../../../webgl"],function(f,a,e){function m(a,f,g){f=new e.Texture(a,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:f,height:g,samplingMode:9729});a=new e.FramebufferObject(a,{colorTarget:0,depthStencilTarget:2},f);return[f,a]}Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){this._height=this._width=void 0;this._resources=null}a.prototype.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),
this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),this._resources=null)};a.prototype._initialize=function(a,e,c){this._width=e;this._height=c;var g=m(a,e,c),b=g[0],g=g[1];a=m(a,e,c);this._resources={sharedBlur1Tex:b,sharedBlur1Fbo:g,sharedBlur2Tex:a[0],sharedBlur2Fbo:a[1]}};a.prototype.setup=function(a,e,c){!this._resources||this._width===e&&this._height===c||this.dispose();this._resources||this._initialize(a,e,c)};Object.defineProperty(a.prototype,"sharedBlur1Tex",
{get:function(){return this._resources.sharedBlur1Tex},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sharedBlur1Fbo",{get:function(){return this._resources.sharedBlur1Fbo},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sharedBlur2Tex",{get:function(){return this._resources.sharedBlur2Tex},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sharedBlur2Fbo",{get:function(){return this._resources.sharedBlur2Fbo},enumerable:!0,configurable:!0});
return a}();a.default=f})},"esri/views/2d/engine/webgl/effects/HittestEffect":function(){define("require exports tslib ../../../../../core/MapUtils ../../../../../core/maybe ../definitions ./Effect".split(" "),function(f,a,e,m,k,l,g){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b.name=b.constructor.name;b.defines=["id"];b._lastSize=0;return b}e.__extends(c,a);c.prototype.dispose=function(){k.isSome(this._fbo)&&this._fbo.dispose()};
c.prototype.bind=function(a){var b=a.context;a=a.painter;var c=b.getViewport();a=a.getFbos(c.width,c.height).effect0;b.bindFramebuffer(a);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT)};c.prototype.unbind=function(){};c.prototype.draw=function(a,d,c){var b=this,e=a.context,g=a.state,h=a.pixelRatio;void 0===c&&(c=l.HITTEST_SEARCH_SIZE);var f=e.getBoundFramebufferObject(),k=g.size[1]*h,n=Math.round(c*h),z=n/2,A=n/2;this._ensureBuffer(n);d.forEach(function(a,c){var e=new Map;f.readPixels(Math.floor(c[0]*
h-n/2),Math.floor(k-c[1]*h-n/2),n,n,6408,5121,b._buf);for(var g=0;g<b._buf32.length;g++){var l=b._buf32[g];if(4294967295!==l&&0!==l){var p=g%n,q=n-Math.floor(g/n),p=(z-p)*(z-p)+(A-q)*(A-q),q=e.has(l)?e.get(l):4294967295;e.set(l,Math.min(p,q))}}e=m.pairsOfMap(e).sort(function(a,b){return a[1]-b[1]}).map(function(a){return a[0]});a.resolve(e);d.delete(c)})};c.prototype._ensureBuffer=function(a){this._lastSize!==a&&(this._lastSize=a,this._buf=new Uint8Array(4*a*a),this._buf32=new Uint32Array(this._buf.buffer))};
return c}(g.Effect);a.HittestEffect=f})},"esri/core/MapUtils":function(){define(["require","exports"],function(f,a){function e(a){if(0===a.size)throw Error("Map is empty");return a.keys().next().value}function m(a){if(0===a.size)throw Error("Map is empty");var b,d=!1;a.forEach(function(a,c){d||(b=c,d=!0)});return b}function k(a){if(0===a.size)throw Error("Map is empty");return a.values().next().value}function l(a){if(0===a.size)throw Error("Map is empty");var b,d=!1;a.forEach(function(a){d||(b=a,
d=!0)});return b}Object.defineProperty(a,"__esModule",{value:!0});a.someMap=Map.prototype.entries?function(a,b){a=a.entries();for(var d=a.next();!d.done;d=a.next())if(b(d.value[1],d.value[0]))return!0;return!1}:function(a,b){var d=!0;a.forEach(function(a,c){d&&(d=!b(a,c))});return!d};f=!!Map.prototype.values;var g=!!Map.prototype.keys,c=!!Array.from;a.pairsOfMap=function(a){var b=[];a.forEach(function(a,c){return b.push([c,a])});return b};a.valuesOfMap=f&&c?function(a){return Array.from(a.values())}:
function(a){var b=Array(a.size),d=0;a.forEach(function(a){return b[d++]=a});return b};a.keysOfMap=g&&c?function(a){return Array.from(a.keys())}:function(a){var b=Array(a.size),d=0;a.forEach(function(a,c){return b[d++]=c});return b};a.MapFromValues=f?function(a){return new Map(a)}:function(a){for(var b=new Map,d=0;d<a.length;d++){var c=a[d];b.set(c[0],c[1])}return b};a.firstKeyOfMap=g?e:m;a.firstValueOfMap=f?k:l;a.test={firstKeyOfMapFallback:m,firstValueOfMapFallback:l}})},"esri/views/2d/engine/webgl/painter/RenderPass":function(){define("require exports @dojo/framework/shim/iterator ../../../../../core/has ../../../../../core/maybe ../enums".split(" "),
function(f,a,e,m,k,l){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(a,e){this.brushes=a;this.name=e.name;this.drawPhase=e.drawPhase||l.WGLDrawPhase.MAP;this._targetFn=e.target;this.effects=e.effects||[];this.has=e.has}a.prototype.render=function(a){var c=a.context,b=a.profiler,d=this._targetFn(),e=this.drawPhase&a.drawPhase;b.recordPassStart(this.name);if(e&&(!this.has||m(this.has))){this._doRender(a,d);b.recordPassEnd();for(var e=0,g=this.effects;e<g.length;e++){var f=
g[e];if(f.enable()){var k=f.apply;b.recordPassStart(this.name+"."+k.name);b.recordBrushStart(k.name);var f=f.args&&f.args(),l=c.getViewport(),u=l.x,v=l.y,y=l.width,l=l.height,z=c.getBoundFramebufferObject();k.bind(a,f);this._doRender(a,d,k.defines);k.draw(a,f);k.unbind(a,f);c.bindFramebuffer(z);c.setViewport(u,v,y,l);b.recordBrushEnd();b.recordPassEnd()}}}};a.prototype._doRender=function(a,g,b){if(!k.isNone(g))if(e.isArrayLike(g))for(var d=0;d<g.length;d++){var c=g[d];if(c.isReady&&c.visible)for(var f=
0,h=this.brushes;f<h.length;f++){var l=h[f];a.profiler.recordBrushStart(l.name);l.prepareState(a,c,b);l.draw(a,c,b);a.profiler.recordBrushEnd()}}else for(d=0,c=this.brushes;d<c.length;d++)l=c[d],a.profiler.recordBrushStart(l.name),l.prepareState(a,g,b),l.draw(a,g,b),a.profiler.recordBrushEnd()};return a}();a.default=f})},"esri/views/2d/engine/webgl/Profiler":function(){define("require exports ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../webgl/capabilities/DisjointTimerQuery".split(" "),
function(f,a,e,m,k,l,g){Object.defineProperty(a,"__esModule",{value:!0});var c=k("esri-2d-profiler");f=function(){function a(a,d){var b=this;this._events=new m;this._entries=new Map;this._timings=new e.default(10);if(c){this._ext=g.load(a.gl,{});this._debugOutput=d;var f=a.gl;if(this.enableCommandLogging){a=function(a){if("function"===typeof f[a]){var d=f[a],c=-1!==a.indexOf("draw");f[a]=function(){for(var e=[],g=0;g<arguments.length;g++)e[g]=arguments[g];b._events.emit("command",{container:b._currentContainer,
pass:b._currentPass,brush:b._currentBrush,method:a,args:e,isDrawCommand:c});b._currentSummary&&(b._currentSummary.commands++,c&&b._currentSummary.drawCommands++);return d.apply(f,e)}}};for(var h in f)a(h)}}}Object.defineProperty(a.prototype,"enableCommandLogging",{get:function(){return!("object"===typeof c&&c.disableCommands)},enumerable:!0,configurable:!0});a.prototype.recordContainerStart=function(a){c&&(this._currentContainer=a)};a.prototype.recordContainerEnd=function(){c&&(this._currentContainer=
null)};a.prototype.recordPassStart=function(a){c&&(this._currentPass=a,this._initSummary())};a.prototype.recordPassEnd=function(){c&&(this._currentPass=null,this._emitSummary())};a.prototype.recordBrushStart=function(a){c&&(this._currentBrush=a)};a.prototype.recordBrushEnd=function(){c&&(this._currentBrush=null)};a.prototype.recordStart=function(a){if(c&&l.isSome(this._ext)){if(this._entries.has(a)){var b=this._entries.get(a),e=this._ext.resultAvailable(b.query),g=this._ext.disjoint();if(e&&!g){e=
this._ext.getResult(b.query)/1E6;g=0;if(l.isSome(this._timings.enqueue(e))){for(var g=this._timings.entries,f=g.length,h=0,k=0;k<g.length;k++)h+=g[k];g=h/f}e=e.toFixed(2);g=g?g.toFixed(2):"--";this.enableCommandLogging?(console.groupCollapsed("Frame report for "+a+", "+e+" ms ("+g+" last 10 avg)\n"+b.commandsLen+" Commands ("+b.drawCommands+" draw)"),console.log("RenderPass breakdown: "),console.table(b.summaries),console.log("Commands: ",b.commands),console.groupEnd()):console.log("Frame report for "+
a+", "+e+" ms ("+g+" last 10 avg)");this._debugOutput.innerHTML=e+" ("+g+")"}e=0;for(b=b.handles;e<b.length;e++)b[e].remove();this._entries.delete(a)}var m={name:a,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(m.handles.push(this._events.on("command",function(a){m.commandsLen++;m.commands.push(a);a.isDrawCommand&&m.drawCommands++})),m.handles.push(this._events.on("summary",function(a){m.summaries.push(a)})));this._ext.beginTimeElapsed(m.query);
this._entries.set(a,m)}};a.prototype.recordEnd=function(a){c&&l.isSome(this._ext)&&this._entries.has(a)&&this._ext.endTimeElapsed()};a.prototype._initSummary=function(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})};a.prototype._emitSummary=function(){this.enableCommandLogging&&this._events.emit("summary",this._currentSummary)};return a}();a.Profiler=f})},"esri/core/CircularArray":function(){define(["require",
"exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(a){void 0===a&&(a=Number.POSITIVE_INFINITY);this._start=this.size=0;this.maxSize=a;this._buffer=isFinite(a)?Array(a):[]}Object.defineProperty(a.prototype,"entries",{get:function(){return this._buffer},enumerable:!0,configurable:!0});a.prototype.enqueue=function(a){if(this.size===this.maxSize){var e=this._buffer[this._start];this._buffer[this._start]=a;this._start=(this._start+1)%this.maxSize;return e}isFinite(this.maxSize)?
this._buffer[(this._start+this.size++)%this.maxSize]=a:this._buffer[this._start+this.size++]=a;return null};a.prototype.dequeue=function(){if(0===this.size)return null;var a=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;return a};return a}();a.default=f})},"esri/views/2d/engine/webgl/WebGLDriverTest":function(){define("require exports ../../../../core/Logger ../../../../core/maybe ../../../webgl ./VertexStream".split(" "),function(f,
a,e,m,k,l){Object.defineProperty(a,"__esModule",{value:!0});var g=e.getLogger("esri.views.2d.engine.webgl.WebGLDriverTest"),c=function(){function c(a){this._ignoresSamplerPrecision=null;this._context=a}Object.defineProperty(c.prototype,"ignoresSamplerPrecision",{get:function(){m.isNone(this._ignoresSamplerPrecision)&&(this._ignoresSamplerPrecision=a.testSamplerPrecision(this._context));return this._ignoresSamplerPrecision},enumerable:!0,configurable:!0});return c}();a.testWebGLDriver=function(a){return new c(a)};
a.testSamplerPrecision=function(a){var b=new k.FramebufferObject(a,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1}),d=new Uint8Array(4),c=new l(a,[0,0,1,0,0,1,1,1]),e=new k.Program(a,"\nprecision highp float;\n\nattribute vec2 a_pos;\n\nuniform highp sampler2D u_texture;\nvarying vec4 v_color;\n\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n\n  return mod(floor(bitset / offset), 2.0);\n}\n\nvoid main() {\n  vec4 value \x3d texture2D(u_texture, vec2(0.0));\n\n  float bit \x3d getBit(value.x * 255.0, 1);\n\n  v_color \x3d bit * vec4(1.0);\n\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}\n",
"\nprecision highp float;\n\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor \x3d v_color;\n}\n",{a_pos:0}),f=new k.Texture(a,{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([2,255,0,0]));e.setUniform1i("u_texture",0);a.bindTexture(f,0);a.bindFramebuffer(b);a.bindProgram(e);var h=a.getViewport(),f=h.x,m=h.y,u=h.width,h=h.height;a.setViewport(0,0,1,1);c.draw();a.setViewport(f,m,u,h);b.readPixels(0,0,1,1,6408,5121,d);e.dispose();c.dispose();
b.dispose();(a=255!==d[0]||255!==d[1]||255!==d[2]||255!==d[3])&&g.warn("A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. ["+d[0]+"."+d[1]+"."+d[2]+"."+d[3]+"]");return a}})},"esri/views/2d/engine/webgl/shaders/StencilPrograms":function(){define(["require",
"exports","./sources/resolver"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.stencil={name:"stencil",shaders:{vertexShader:e.resolveIncludes("stencil/stencil.vert"),fragmentShader:e.resolveIncludes("stencil/stencil.frag")},attributes:{a_pos:0}}})},"esri/views/2d/support/Timeline":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){this._names=new Map}a.prototype.begin=function(a){this._names.has(a)||
(this._names.set(a,!1),-1!==a.indexOf("Brush")&&this.record("Esri.FirstDraw"),performance.mark("Esri."+a+".Start"))};a.prototype.end=function(a){this._names.has(a)&&!this._names.get(a)&&(this._names.set(a,!0),performance.mark("Esri."+a+".End"))};a.prototype.record=function(a){this._names.has(a)||(this._names.set(a,!0),performance.mark("Esri."+a))};return a}();a.Timeline=f})},"esri/views/support/screenshotUtils":function(){define(["require","exports","tslib","../../core/compilerUtils","../../core/mathUtils"],
function(f,a,e,m,k){function l(a,c){var e=a||{},g=e.format,f=e.quality,l=e.rotation,e=e.disableSlice,n=d(a,c.padding),p;p=c.width-n.left-n.right;c=c.height-n.top-n.bottom;n={x:0,y:0,width:p,height:c};if(a&&a.area){null!=a.area.x&&(n.x=Math.floor(a.area.x));null!=a.area.y&&(n.y=Math.floor(a.area.y));var u=null!=a.area.width?Math.floor(a.area.width):null,v=null!=a.area.height?Math.floor(a.area.height):null;n.width=p-n.x;n.height=c-n.y;null!=u&&null!=v?(n.width=Math.min(n.width,u),n.height=Math.min(n.height,
v)):null==u&&null!=v?(u=Math.min(n.width,u),n.height*=u/n.width,n.width=u):null!=u&&null==v&&(u=Math.min(n.height,v),n.width*=u/n.height,n.height=u)}n=b(n,a);u=Math.floor(Math.max(n.x,0));v=Math.floor(Math.max(n.y,0));p={x:u,y:v,width:Math.floor(Math.min(n.width,p-u)),height:Math.floor(Math.min(n.height,c-v))};c=p.width/p.height;n=n.width/n.height;n!==c&&(n>c?(c=Math.floor(p.width/n),p={x:p.x,y:Math.floor(p.y+(p.height-c)/2),width:p.width,height:c}):(c=Math.floor(p.height*n),p={x:Math.floor(p.x+(p.width-
c)/2),y:p.y,width:c,height:p.height}));n=h(a,p);c=n.width;n=n.height;a:switch(g){case "png":case "jpg":case "jpeg":break a;case null:case void 0:g=q;break a;default:m.neverReached(g),g=q}u=x[g];f=k.clamp(null!=f?f:u,0,100);return{format:g,quality:f,area:p,width:c,height:n,rotation:l,disableSlice:!!e,ignoreBackground:!(!a||!a.ignoreBackground),ignorePadding:!(!a||!a.ignorePadding)}}function g(a,b){return a.toDataURL(r[b.format],b.quality/100)}function c(a,b,d){d||(n||(n=document.createElement("canvas"),
n.width=1,n.height=1),d=n);return d.getContext("2d").createImageData(a,b)}function h(a,b){if(!a)return b;var d=a.width;a=a.height;if(null!=d&&null!=a)return{width:Math.floor(d),height:Math.floor(a)};if(null==d&&null==a)return b;b=b.width/b.height;return null==a?{width:Math.floor(d),height:Math.floor(d/b)}:{width:Math.floor(a*b),height:Math.floor(a)}}function b(a,b){if(!b||null==b.width||null==b.height)return a;b=b.width/b.height;var d=a.width/a.height;if(d===b)return a;if(d<b)return b=Math.floor(a.height*
b),a.x-=(b-a.width)/2,a.width=b,a;b=Math.floor(a.width/b);a.y-=(b-a.height)/2;a.height=b;return a}function d(a,b){return!b||a&&a.ignorePadding?u:b}Object.defineProperty(a,"__esModule",{value:!0});a.completeUserSettings=l;a.toRenderSettings=function(a,b){var c=l(a,b),e=c.area,g=c.width/e.width,f=d(c,b.padding),h=f.left+f.right,k=f.top+f.bottom;return{framebufferWidth:Math.floor((b.width-h)*g+h),framebufferHeight:Math.floor((b.height-k)*g+k),region:{x:Math.floor(e.x*g)+f.left,y:Math.floor(e.y*g)+f.top,
width:c.width,height:c.height},format:c.format,quality:c.quality,rotation:c.rotation,pixelRatio:g,layers:a&&a.layers?a.layers:[],disableSlice:c.disableSlice,ignoreBackground:c.ignoreBackground,ignorePadding:c.ignorePadding}};a.encodeResult=function(a,b,d,c){if(c.premultipliedAlpha)for(var e=a.data,f=e.length,h=0;h<f;h+=4){var k=e[h+3];0<k&&(k/=255,e[h+0]/=k,e[h+1]/=k,e[h+2]/=k)}d.width=a.width;d.height=a.height;e=d.getContext("2d");e.putImageData(a,0,0);c.flipY&&(e.save(),e.globalCompositeOperation=
"copy",e.scale(1,-1),e.translate(0,-e.canvas.height),e.drawImage(e.canvas,0,0),e.restore());a=e.getImageData(0,0,a.width,a.height);b=g(d,b);d.width=0;d.height=0;return{dataUrl:b,data:a}};a.toDataUrl=g;a.createEmptyImageData=function(a,b,d){if(!a||!b)throw Error("Cannot construct image data without dimensions");if(p)try{return new ImageData(a,b)}catch(A){p=!1}return c(a,b,d)};a.wrapImageData=function(a,b,d,e){if(!b||!d)throw Error("Cannot construct image data without dimensions");if(p)try{return new ImageData(a,
b,d)}catch(B){p=!1}b=c(b,d,e);b.data.set(a,0);return b};a.resampleHermite=function(a,b,d,c,e,g,f,h){void 0===c&&(c=0);void 0===e&&(e=0);void 0===g&&(g=a.width-c);void 0===f&&(f=a.height-e);void 0===h&&(h=!1);var k=a.data,l=b.width,n=b.height,m=b.data;g/=l;f/=n;var p=Math.ceil(g/2),u=Math.ceil(f/2);a=a.width;for(var q=0;q<n;q++)for(var r=0;r<l;r++){for(var x=4*(r+(h?n-q-1:q)*l),v=0,y=0,z=0,A=0,B=0,C=0,E=(q+.5)*f,D=Math.floor(q*f);D<(q+1)*f;D++)for(var Y=Math.abs(E-(D+.5))/u,aa=(r+.5)*g,Y=Y*Y,da=Math.floor(r*
g);da<(r+1)*g;da++){var W=Math.abs(aa-(da+.5))/p,W=Math.sqrt(Y+W*W);if(!(1<=W)){var W=2*W*W*W-3*W*W+1,ea=4*(c+da+(e+D)*a),C=C+W*k[ea+3],y=y+W;!d&&255>k[ea+3]&&(W=W*k[ea+3]/255);z+=W*k[ea];A+=W*k[ea+1];B+=W*k[ea+2];v+=W}}m[x]=z/v;m[x+1]=A/v;m[x+2]=B/v;m[x+3]=C/y}return b};a.screenshotSuperSampleSettings=function(a,b,c){if(!b)return a;b=a.framebufferWidth;var g=a.framebufferHeight,f=a.pixelRatio,h=a.region;c=d(a,c);var k=c.left+c.right,l=c.top+c.bottom,n=b-k,m=g-l,p=Math.min(8,Math.min((2048-k)/n,(2048-
l)/m));return 1.5>p?a:e.__assign(e.__assign({},a),{framebufferWidth:Math.round(n*p)+k,framebufferHeight:Math.round(m*p)+l,pixelRatio:f*p,resample:{region:{x:Math.round((h.x-c.left)*p)+c.left,y:Math.round((h.y-c.top)*p)+c.top,width:Math.round(h.width*p),height:Math.round(h.height*p)},width:b,height:g}})};var n=null,p=!0,r={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},q="jpg",x={png:100,jpg:98,jpeg:98},u={top:0,right:0,bottom:0,left:0}})},"esri/views/2d/engine/webgl/AttributeStoreView":function(){define("require exports tslib ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../webgl ./definitions ./Utils ./util/debug ../../../webgl/FramebufferObject".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p){Object.defineProperty(a,"__esModule",{value:!0});var r=l.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),q=n.createDebugLogger(n.DEBUG_ATTR_UPDATES,r),x=function(){function a(a,b,c){this._lastTexture=this._texture=null;this._fbos={};this.texelSize=4;var e=a.buffer,f=a.pixelType;a=a.textureOnly;var h=d.getPixelArrayCtor(f);this.shared=c;this.pixelType=f;this.size=b;this.textureOnly=a;a||(this.data=new h(g.unwrap(e)));this._resetRange()}a.prototype.destroy=
function(){g.andThen(this._texture,function(a){return a.dispose()});var a=function(a){g.andThen(b._fbos[a],function(b){"0"===a&&b.detachColorTexture();b.dispose()});b._fbos[a]=null},b=this,d;for(d in this._fbos)a(d);this._texture=null};Object.defineProperty(a.prototype,"_textureDesc",{get:function(){return{target:3553,wrapMode:33071,pixelFormat:6408,dataType:this.pixelType,samplingMode:9728,width:this.size,height:this.size}},enumerable:!0,configurable:!0});a.prototype.setData=function(a,b,d){a&=2147483647;
var c=g.unwrap(this.data);b=a*this.texelSize+b;!c||b>=c.length||(c[b]=d,this.dirtyStart=Math.min(this.dirtyStart,a),this.dirtyEnd=Math.max(this.dirtyEnd,a))};a.prototype.getData=function(a,b){if(g.isNone(this.data))return null;a=(a&2147483647)*this.texelSize+b;return!this.data||a>=this.data.length?null:this.data[a]};a.prototype.getTexture=function(a){var b=this;return g.unwrapOr(this._texture,function(){return b._initTexture(a)})};a.prototype.getFBO=function(a,b){void 0===b&&(b=0);if(g.isNone(this._fbos[b])){var d=
0===b?this.getTexture(a):this._textureDesc;this._fbos[b]=new p(a,{colorTarget:0,depthStencilTarget:0},d)}return this._fbos[b]};Object.defineProperty(a.prototype,"locked",{get:function(){return 5121===this.pixelType&&this.shared&&!this.textureOnly&&k("esri-atomics")&&this.data?1===Atomics.load(this.data,0):!1},enumerable:!0,configurable:!0});a.prototype.updateTexture=function(a){if(!this.locked)try{var b=this.dirtyStart,c=this.dirtyEnd;if(!(b>c)){this._resetRange();var e=g.unwrap(this.data).buffer,
f=this.getTexture(a),h=(b-b%this.size)/this.size,k=(c-c%this.size)/this.size,l=h*this.size*4,n=4*(this.size+k*this.size)-l,p=d.getPixelArrayCtor(this.pixelType),u=p.BYTES_PER_ELEMENT;try{new p(e,l*u,n)}catch(K){console.debug(K)}var q=new p(e,l*u,n),x=this.size;a=k-h+1;a>this.size?r.error(new m("mapview-webgl","Out-of-bounds index when updating AttributeData")):f.updateData(0,0,h,x,a,q)}}catch(K){console.debug(K)}};a.prototype.update=function(a){var b=a.data,d=a.start,c=a.end;if(g.isSome(b))for(var e=
this.data,f=d*this.texelSize,h=0;h<b.length;h++)a.layout&1<<h%this.texelSize&&(e[f+h]=b[h]);this.dirtyStart=Math.min(this.dirtyStart,d);this.dirtyEnd=Math.max(this.dirtyEnd,c)};a.prototype.resize=function(a,b){var c=this.size;this.size=b;this.textureOnly?c!==this.size&&(this._lastTexture=this._texture,this._texture=null):(b=d.getPixelArrayCtor(this.pixelType),this.destroy(),this.data=new b(g.unwrap(a.buffer)))};a.prototype._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};a.prototype._initTexture=
function(a){var b=new h.Texture(a,this._textureDesc,g.unwrapOr(this.data,void 0));if(g.isSome(this._lastTexture)&&this._fbos[0]){var c=this._lastTexture.descriptor.width,e=this._lastTexture.descriptor.height,f=this._lastTexture.descriptor.dataType,k=this._lastTexture.descriptor.pixelFormat,l=this.getFBO(a),n=d.getPixelBytes(f),m=d.getPixelArrayCtor(f),n=new ArrayBuffer(c*e*n*this.texelSize),m=new m(n),n=a.getBoundFramebufferObject(),p=a.getViewport(),u=p.x,q=p.y,r=p.width,p=p.height;a.bindFramebuffer(l);
l.readPixels(0,0,c,e,k,f,m);b.updateData(0,0,0,2*c,e/2,m);a.setViewport(u,q,r,p);a.bindFramebuffer(n)}this.destroy();return this._texture=b};return a}();f=function(){function a(){this._locked=this._forceNextUpload=this._initialized=!1}a.prototype.initialize=function(a){var b=a.blocks,d=a.shared,c=a.size;this.shared=d;this.size=c;q("Initializing AttributeStoreView",a);if(g.isNone(this._data))this._data=g.mapMany(b,function(a){return new x(a,c,d)});else for(a=0;a<this._data.length;a++){var e=this._data[a],
f=b[a];g.isSome(f)&&(g.isNone(e)?this._data[a]=new x(f,c,d):e.resize(f,c))}this._initialized=!0};a.prototype.destroy=function(){g.andThen(this._data,function(a){return g.mapMany(a,function(a){return a.destroy()})});g.andThen(this._defaultTexture,function(a){return a.dispose()})};a.prototype.getBlock=function(a){return g.isNone(this._data)?null:this._data[a]};a.prototype.setLabelMinZoom=function(a,b){this.setData(a,0,1,b)};a.prototype.getLabelMinZoom=function(a){return this.getData(a,0,1,255)};a.prototype.getFilterFlags=
function(a){return this.getData(a,0,0,0)};a.prototype.getVVSize=function(a){return this.getData(a,b.ATTRIBUTE_DATA_VV,0,0)};a.prototype.getData=function(a,b,d,c){if(!this._data)return 0;b=g.unwrap(this._data)[b];if(g.isNone(b))return 0;a=b.getData(a,d);return g.isSome(a)?a:c};a.prototype.setData=function(a,b,d,c){b=g.unwrap(this._data)[b];g.unwrap(b).setData(a,d,c)};a.prototype.lockTextureUpload=function(){this._locked=!0};a.prototype.unlockTextureUpload=function(){this._locked=!1};a.prototype.forceTextureUpload=
function(){this._forceNextUpload=!0};a.prototype.requestUpdate=function(a){return e.__awaiter(this,void 0,void 0,function(){var b;return e.__generator(this,function(d){if(this._pendingAttributeUpdate)return r.error(new m("mapview-webgl","Tried to update attribute data with a pending update")),[2];b=c.createResolver();q("AttributeStoreView Update Requested",a);this._pendingAttributeUpdate={data:a,resolver:b};return[2,b.promise]})})};a.prototype.update=function(){if(this._initialized&&g.isSome(this._pendingAttributeUpdate)){for(var a=
this._pendingAttributeUpdate,b=a.data,a=a.resolver,d=g.unwrap(this._data),c=function(a){var c=b.blocks[a];g.andThen(d[a],function(b){return g.andThen(c,function(d){q("Updating block "+a,d);b.update(d)})})},e=0;e<b.blocks.length;e++)c(e);this._pendingAttributeUpdate=null;a()}};a.prototype.bindTextures=function(a){this.update();var d=this._getDefaultTexture(a);if(this._initialized){var c=g.unwrap(this._data);if(!this._locked||this._forceNextUpload)g.forEachSome(c,function(b){return b.updateTexture(a)}),
this._forceNextUpload=!1;a.bindTexture(g.mapOr(c[0],d,function(b){return b.getTexture(a)}),b.TEXTURE_BINDING_ATTRIBUTE_DATA_0);a.bindTexture(g.mapOr(c[1],d,function(b){return b.getTexture(a)}),b.TEXTURE_BINDING_ATTRIBUTE_DATA_1);a.bindTexture(g.mapOr(c[2],d,function(b){return b.getTexture(a)}),b.TEXTURE_BINDING_ATTRIBUTE_DATA_2);a.bindTexture(g.mapOr(c[3],d,function(b){return b.getTexture(a)}),b.TEXTURE_BINDING_ATTRIBUTE_DATA_3)}else a.bindTexture(d,b.TEXTURE_BINDING_ATTRIBUTE_DATA_0),a.bindTexture(d,
b.TEXTURE_BINDING_ATTRIBUTE_DATA_1),a.bindTexture(d,b.TEXTURE_BINDING_ATTRIBUTE_DATA_2),a.bindTexture(d,b.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};a.prototype._getDefaultTexture=function(a){g.isNone(this._defaultTexture)&&(this._defaultTexture=new h.Texture(a,{wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array(4)));return this._defaultTexture};return a}();a.AttributeStoreView=f})},"esri/views/2d/engine/webgl/Utils":function(){define("require exports tslib ../../../../core/Error ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ../../../webgl ./color ./enums ./SymbolProperties".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d){function n(a){for(var b={},d=0;d<a.length;d++){var c=a[d];b[c.name]=c.strideInBytes}return b}function p(a){switch(a){case b.WGLGeometryType.MARKER:return z;case b.WGLGeometryType.FILL:return A;case b.WGLGeometryType.LINE:return B;case b.WGLGeometryType.TEXT:return D;case b.WGLGeometryType.LABEL:return C}}function r(a){switch(a%4){case 0:case 2:return 4;case 1:case 3:return 1}}function q(a){return"string"===typeof a}function x(a){switch(a){case 5120:case 5121:return 1;
case 5122:case 5123:return 2;case 5126:case 5124:case 5125:return 4}}function u(a){var b={},d=function(d){var c=0;b[d]=a[d].map(function(a){var b=e.__assign(e.__assign({},a),{normalized:a.normalized||!1,divisor:a.divisor||0,offset:c,stride:0});c+=a.count*x(a.type);return b});b[d].forEach(function(a){return a.stride=c})},c;for(c in a)d(c);return b}var v;Object.defineProperty(a,"__esModule",{value:!0});var y=k.getLogger("esri.views.2d.engine.webgl.Utils");a.C_VBO_GEOMETRY="geometry";a.C_VBO_PERINSTANCE=
"per_instance";a.C_VBO_PERINSTANCE_VV="per_instance_vv";a.C_ICON_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];a.C_FILL_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];a.C_FILL_VERTEX_DEF_DD=[{name:a.C_VBO_GEOMETRY,strideInBytes:12,divisor:0}];a.C_LINE_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:36,divisor:0}];a.C_TEXT_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];a.C_LABEL_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:36,divisor:0}];a.C_ICON_STRIDE_SPEC=
n(a.C_ICON_VERTEX_DEF);a.C_FILL_STRIDE_SPEC=n(a.C_FILL_VERTEX_DEF);a.C_FILL_STRIDE_SPEC_DD=n(a.C_FILL_VERTEX_DEF_DD);a.C_LINE_STRIDE_SPEC=n(a.C_LINE_VERTEX_DEF);a.C_TEXT_STRIDE_SPEC=n(a.C_TEXT_VERTEX_DEF);a.C_LABEL_STRIDE_SPEC=n(a.C_LABEL_VERTEX_DEF);a.getStrides=function(d,c){switch(d){case b.WGLGeometryType.MARKER:return a.C_ICON_STRIDE_SPEC;case b.WGLGeometryType.FILL:return c?a.C_FILL_STRIDE_SPEC_DD:a.C_FILL_STRIDE_SPEC;case b.WGLGeometryType.LINE:return a.C_LINE_STRIDE_SPEC;case b.WGLGeometryType.TEXT:return a.C_TEXT_STRIDE_SPEC;
case b.WGLGeometryType.LABEL:return a.C_LABEL_STRIDE_SPEC}};var z=[a.C_VBO_GEOMETRY],A=[a.C_VBO_GEOMETRY],B=[a.C_VBO_GEOMETRY],D=[a.C_VBO_GEOMETRY],C=[a.C_VBO_GEOMETRY];a.getNamedBuffers=p;a.strideToPackingFactor=r;a.allocateTypedArrayBuffer=function(a,b){switch(b%4){case 0:case 2:return new Uint32Array(Math.floor(a*b/4));case 1:case 3:return new Uint8Array(a*b)}};a.allocateTypedArrayBufferwithData=function(a,b){switch(b%4){case 0:case 2:return new Uint32Array(a);case 1:case 3:return new Uint8Array(a)}};
a.getTextProperties=function(a){return d.TextProperties.pool.acquire(a.color?h.copyAndPremultiply(a.color):[255,255,255,255],a.haloColor?h.copyAndPremultiply(a.haloColor):[255,255,255,255],g.pt2px(a.haloSize),g.pt2px(a.font.size),a.angle*Math.PI/180,a.xoffset/a.font.size,a.yoffset/a.font.size,"left"===a.horizontalAlignment?0:"right"===a.horizontalAlignment?1:.5,"top"===a.verticalAlignment?0:"bottom"===a.verticalAlignment?1:.5)};a.isDefined=function(a){return null!=a};a.isNumber=function(a){return"number"===
typeof a};a.isString=q;a.isStringOrNull=function(a){return null==a||q(a)};a.getCapType=function(a,b){switch(a){case "butt":return 0;case "round":return b?2:1;case "square":return 2;default:return y.error(new m("mapview-invalid-type","Cap type "+a+" is not a valid option. Defaulting to round")),1}};a.getJoinType=function(a){switch(a){case "miter":return 2;case "bevel":return 0;case "round":return 1;default:return y.error(new m("mapview-invalid-type","Join type "+a+" is not a valid option. Defaulting to round")),
1}};a.getVVType=function(a){switch(a){case "opacity":return b.VVType.OPACITY;case "color":return b.VVType.COLOR;case "rotation":return b.VVType.ROTATION;case "size":return b.VVType.SIZE;default:return y.error("Cannot interpret unknown vv: "+a),null}};a.getTransformParams=function(a){return{transform:a.transform,hasZ:a.hasZ,hasM:a.hasM}};a.copyMeshData=function(a,b,d,c,e,g,f){for(var h in g)for(var k=g[h].stride,l=r(k),n=g[h].data,m=d[h].data,p=k*e.vertexCount/l,q=k*a/l,l=k*e.vertexFrom/l,k=0;k<p;++k)m[k+
q]=n[k+l];d=e.indexCount;for(k=0;k<d;++k)c[k+b]=f[k+e.indexFrom]-e.vertexFrom+a};a.C_VBO_INFO=(v={},v[a.C_VBO_GEOMETRY]=35044,v);a.createGeometryData=function(a,b){for(var d=[],c=0;5>c;++c){for(var e={},g=0,f=p(c);g<f.length;g++){var h=f[g];e[h]={data:b(c,h)}}d.push({data:a(c),buffers:e})}return d};a.createTextureFromTexelData=function(a,b){var d,e;l.isPowerOfTwo(b.width)&&l.isPowerOfTwo(b.height)?(d=!0,e=9987):(d=!1,e=9729);return new c.Texture(a,{target:3553,pixelFormat:6408,internalFormat:6408,
dataType:5121,hasMipmap:d,samplingMode:e,wrapMode:33071,flipped:!0},b)};a.geometryToMappedGeometry=function(a){return{vertexFrom:void 0,vertexTo:void 0,geometry:a}};a.getBytes=x;a.getPixelBytes=function(a){switch(a){case 5121:return 1;case 32819:return 2;case 5126:return 4;default:y.error(new m("webgl-utils","Unable to handle type "+a))}};a.getPixelArrayCtor=function(a){switch(a){case 5121:return Uint8Array;case 32819:return Uint16Array;case 5126:return Float32Array;default:y.error(new m("webgl-utils",
"Unable to handle type "+a))}};var E=new Map;a.createProgramDescriptor=function(a,b){if(!E.has(a)){var d=u(b),c={},e;for(e in d){var g=d[e];c[e]=g.length?g[0].stride:0}e={};for(var f in b)for(var g=0,h=b[f];g<h.length;g++){var k=h[g];e[k.name]=k.location}E.set(a,{strides:c,bufferLayouts:d,attributes:e})}return E.get(a)}})},"esri/views/2d/engine/webgl/color":function(){define(["require","exports","./number"],function(f,a,e){function m(a,c){Array.isArray(c)?(a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3]):
(a[0]=c.r,a[1]=c.g,a[2]=c.b,a[3]=c.a);return a}function k(a,c,e){void 0===c&&(c=0);void 0===e&&(e=!1);var b=a[c+3];a[c+0]*=b;a[c+1]*=b;a[c+2]*=b;e||(a[c+3]*=255);return a}Object.defineProperty(a,"__esModule",{value:!0});a.white=[255,255,255,1];var l=[0,0,0,0];a.premultiplyAlpha=k;a.copyAndPremultiply=function(a){return k(m([],a))};a.premultiplyAlphaUint32=function(a){k(m(l,a));return e.i8888to32(l[0],l[1],l[2],l[3])};a.premultiplyAlphaRGBA=function(a){if(!a)return 0;var c=a.a;return e.i8888to32(a.r*
c,a.g*c,a.b*c,255*c)}})},"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["require","exports","../../../../core/ObjectPool"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=0}a.prototype.acquire=function(a,e,g,c,f,b,d,n,m){this.color=a;this.haloColor=e;this.haloSize=g;this.size=c;this.angle=f;this.offsetX=
b;this.offsetY=d;this.hAnchor=n;this.vAnchor=m};a.prototype.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};a.pool=new e(a);return a}();a.TextProperties=f})},"esri/views/2d/engine/webgl/util/debug":function(){define(["require","exports","tslib"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});
a.createDebugLogger=function(a,f){return a&&function(){for(var a=[],g=0;g<arguments.length;g++)a[g]=arguments[g];return f.warn.apply(f,e.__spreadArrays(["DEBUG:"],a))}||function(){return null}};a.DEBUG_ATTR_UPDATES=!1})},"esri/views/2d/engine/webgl/collisions/CollisionGrid":function(){define(["require","exports","../definitions"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(a,f){void 0===f&&(f=2);this._bucketSize=a;this._rowsLength=e.TILE_SIZE/a;this._colsLength=
e.TILE_SIZE/a;this._elementsPerBucket=f;this._grid=this._initGrid()}a.prototype.checkOverlap=function(a,e){a=Math.floor(a/this._bucketSize);e=Math.floor(e/this._bucketSize);return 0>a||a>=this._rowsLength||0>e||e>=this._colsLength?!0:this._grid[e*this._colsLength+a]>=this._elementsPerBucket};a.prototype.markUsed=function(a,e){this._grid[Math.floor(e/this._bucketSize)*this._colsLength+Math.floor(a/this._bucketSize)]+=1};a.prototype.reset=function(){this._grid=this._initGrid()};a.prototype._initGrid=
function(){return new Uint8Array(this._rowsLength*this._colsLength)};return a}();a.CollisionGrid=f})},"esri/views/2d/engine/webgl/collisions/CollisionEngine":function(){define("require exports ../../../../../core/Error ../../../../../core/Logger ../../../../../core/MapUtils ../../../../../core/mathUtils ../definitions ./CollisionBucket ./LayerCollisionInfo".split(" "),function(f,a,e,m,k,l,g,c,h){Object.defineProperty(a,"__esModule",{value:!0});var b=g.TILE_SIZE/g.COLLISION_BUCKET_SIZE,d=m.getLogger("esri.views.2d.engine.webgl.collisions.CollisionEngine");
f=function(){function a(a){this._layers=new Map;this._collisionBuckets=new Map;this._didError=!1;this._tilingScheme=a}Object.defineProperty(a.prototype,"collisionInfos",{get:function(){return k.valuesOfMap(this._layers)},enumerable:!0,configurable:!0});a.prototype.registerLayerView=function(a,b){if(!this._layers.has(a)){var d=h.default.create(a,b,this.collisionInfos,this._tilingScheme);this._layers.set(a,d);this._collisionBuckets.forEach(function(a){return a.onRegisterLayer(d.index)})}};a.prototype.unregisterLayerView=
function(a){var b=this;if(this._layers.has(a)){var d=this._layers.get(a);h.default.delete(d.index,this.collisionInfos);this._layers.delete(a);this._collisionBuckets.forEach(function(a,c){var e=a.getTile(d.index);e&&(a.onUnregisterLayer(d.index),a.canDelete()&&b._collisionBuckets.delete(c),e.reference&&(e.reference.isDirty=!1))})}};a.prototype.addTile=function(a,b){var d=b.key.id;this._layers.has(a)&&(this._collisionBuckets.has(d)||this._collisionBuckets.set(d,new c.default(b.key,this._layers.size)),
a=this._getIndex(a),this._collisionBuckets.get(d).getTile(a).reference=b)};a.prototype.removeTile=function(a,b){this._layers.has(a)&&this._collisionBuckets.has(b)&&(a=this._getIndex(a),b=this._collisionBuckets.get(b).getTile(a),b.dirty=!1,b.reference=null)};a.prototype.run=function(a,b){var c=k.valuesOfMap(this._collisionBuckets).sort(function(a,b){return a.key.compareRowMajor(b.key)}),g=!0,f=a.renderingOptions.labelCollisionsEnabled&&!this._didError,l=this.collisionInfos;try{for(var n=0;n<c.length;n++){var m=
c[n],g=g||m.isDirty;m.computeNeighbors(this._collisionBuckets);for(var p=0;p<this._layers.size;p++){var r=h.default.find(p,l);m.reset(a,g,r)}}for(a=0;a<this._layers.size;a++)for(r=h.default.find(a,l),g=0,n=c;g<n.length;g++)m=n[g],this._run(f,m,r,b)}catch(D){d.error(new e("mapview-labeling","Encountered an error during decluttering. Disabling collisions",D)),this._didError=!0}for(b=0;b<c.length;b++)m=c[b],m.ready()};a.prototype._run=function(a,b,d,c){var e=b.getReference(d.index);e&&e.hasData&&(e.key.level!==
c?this._resetLabelsMinZoom(b,d):this._runVisibility(a,b,e,d,c))};a.prototype._resetLabelsMinZoom=function(a,b){if(a&&"polyline"!==b.geometryType&&(a=a.getReference(b.index))&&a.hasData){b=b.layerView.tileRenderer.featuresView.attributeView;var d=0;for(a=a.displayObjects;d<a.length;d++)b.setLabelMinZoom(a[d].id,255)}};a.prototype._checkLabelsVisible=function(a,b){var d=!b.effect||b.effect.excludedLabelsVisible||!!(a&g.EFFECT_FLAG_0);return(!b.filter||!!(a&g.FILTER_FLAG_0))&&d};a.prototype._runVisibility=
function(a,b,d,c,e){var g=c.layerView.tileRenderer.featuresView.attributeView;d=d.displayObjects.sort(function(a,b){a=g.getLabelMinZoom(a.id);b=g.getLabelMinZoom(b.id);return a-b});for(var f=c.zoomRanges.some(function(a){return"none"===a.deconflictionStrategy}),h=0;h<d.length;h++){var k=d[h];if(k.metrics.length){var l="polyline"===c.geometryType?0:10*(e-1),n=g.getFilterFlags(k.id),m=this._checkLabelsVisible(n,c.layerView);if(a&&!f)for(var p=0;p<k.metrics.length;p++)n=k.metrics[p],n=m?-1!==n.minZoom?
n.minZoom:this._computeLabelVisibility(k,n,c.index,b,n.baseZoom,e):255,l=Math.max(n,l);l=Math.max(l,0);g.setLabelMinZoom(k.id,l);m=0;for(k=k.metrics;m<k.length;m++)n=k[m],n.minZoom=l}}};a.prototype._computeLabelVisibility=function(a,d,c,e,g,f){for(var h=d.xBucket,k=d.yBucket,l=d.xOverflow,n=d.yOverflow,m=h-l,h=h+l+1,l=k+n+1,k=k-n;k<l;k++)for(n=m;n<h;n++)if(!(n<-b||k<-b||n>b||k>b))for(var p=0;p<=c;p++){var u=this._getRelativeSubBucket(p,e,n,k);if(u)for(var q=0;q<u.length;q++){var r=u[q];if(p!==c||
r.id!==a.id)r=this._compareLabels(d,r,g,f),g=Math.max(r,g)}}return g};a.prototype._compareLabels=function(a,b,d,c){if(-1===b.minZoom||b.minZoom>10*(c+1))return d;a=a.findCollisionDelta(b);c=l.clamp(Math.ceil(10*(a+c)),0,255);return b.minZoom>=c?d:Math.max(d,c)};a.prototype._getNeighboringTile=function(a,b,d,c){return(b=b.neighbors[3*(1+c)+(1+d)])&&b.getTile(a)};a.prototype._getRelativeSubBucket=function(a,b,d,c){var e=l.sign(Math.floor(d/4)),g=l.sign(Math.floor(c/4));return(a=this._getNeighboringTile(a,
b,e,g))&&a.reference&&a.index&&a.reference.hasData?a.index[c-4*g][d-4*e]:null};a.prototype._getIndex=function(a){return this._layers.get(a).index};return a}();a.CollisionEngine=f})},"esri/views/2d/engine/webgl/collisions/CollisionBucket":function(){define(["require","exports","../../../tiling","./CollisionBucketEntry"],function(f,a,e,m){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(a,e){this.neighbors=Array(9);this._tiles=Array(e);for(var c=0;c<e;c++)this._tiles[c]=new m.default;
this.key=a}Object.defineProperty(a.prototype,"isDirty",{get:function(){for(var a=0,e=this._tiles;a<e.length;a++)if(e[a].dirty)return!0;return!1},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._tiles.length},enumerable:!0,configurable:!0});a.prototype.getTile=function(a){return this._tiles[a]};a.prototype.getReference=function(a){return(a=this._tiles[a])&&a.reference};a.prototype.onRegisterLayer=function(a){this.invalidateRange(a);this._add(a)};
a.prototype.onUnregisterLayer=function(a){this.invalidateRange(a);this._remove(a)};a.prototype.onLabelsRendered=function(){};a.prototype.invalidateRange=function(a){for(;a<this._tiles.length;a++)this._tiles[a].dirty=!0};a.prototype.add=function(a){this._add(a)};a.prototype.remove=function(a){this._remove(a)};a.prototype.canDelete=function(){return 0===this._tiles.length};a.prototype.ready=function(){for(var a=0,e=this._tiles;a<e.length;a++)e[a].dirty=!1};a.prototype.computeNeighbors=function(a){this.neighbors[0]=
this._getNeighbor(a,-1,-1);this.neighbors[1]=this._getNeighbor(a,0,-1);this.neighbors[2]=this._getNeighbor(a,1,-1);this.neighbors[3]=this._getNeighbor(a,-1,0);this.neighbors[4]=this;this.neighbors[5]=this._getNeighbor(a,1,0);this.neighbors[6]=this._getNeighbor(a,-1,1);this.neighbors[7]=this._getNeighbor(a,0,1);this.neighbors[8]=this._getNeighbor(a,1,1)};a.prototype.reset=function(a,e,c){var g=this._tiles[c.index];g&&g.reset(a,e,c)};a.prototype._add=function(a){var e=[];if(a>=this._tiles.length)this._tiles.push(new m.default);
else{for(var c=0;c<this._tiles.length;c++)c===a&&e.push(new m.default),e.push(this._tiles[c]);this._tiles=e}};a.prototype._remove=function(a){for(var e=[],c=0;c<this._tiles.length;c++)c!==a&&e.push(this._tiles[c]);this._tiles=e};a.prototype._getNeighbor=function(a,g,c){var f=this.key;g=e.TileKey.getId(f.level,f.row+c,f.col+g,f.world);return a.has(g)?a.get(g):null};return a}();a.default=f})},"esri/views/2d/tiling":function(){define("require exports ./tiling/TileInfoView ./tiling/TileKey ./tiling/TileQueue ./tiling/TileStrategy".split(" "),
function(f,a,e,m,k,l){Object.defineProperty(a,"__esModule",{value:!0});a.TileInfoView=e;a.TileKey=m;a.TileQueue=k;a.TileStrategy=l})},"esri/views/2d/tiling/TileQueue":function(){define("require exports tslib ../../../core/Accessor ../../../core/SetUtils ../../../core/accessorSupport/decorators ../../../core/libs/gl-matrix-2/vec2 ../../support/QueueProcessor".split(" "),function(f,a,e,m,k,l,g,c){function h(a,b){a.length=0;b.forEach(function(b){return a.push(b)});return a}var b=new Set,d=[],n=new Map,
p=[0,0];return function(a){function f(b){b=a.call(this,b)||this;b._keyToItem=new Map;b.concurrency=6;b.strategy="scale-first";b.tileInfoView=null;return b}e.__extends(f,a);f.prototype.initialize=function(){var a=this,b=this.process;this._queue=new c.QueueProcessor({concurrency:this.concurrency,process:function(d,c){d=a._keyToItem.get(d);return b(d,{signal:c})},peeker:"scale-first"===this.strategy?function(b){return a._peekByScaleFirst(b)}:function(b){return a._peekByCenterFirst(b)}})};f.prototype.destroy=
function(){this.clear();this._queue.destroy();this._queue=null};Object.defineProperty(f.prototype,"length",{get:function(){return this._queue?this._queue.length:0},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"onGoingCount",{get:function(){return this._keyToItem.size},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"updating",{get:function(){return 0<this.length||0<this.onGoingCount},enumerable:!0,configurable:!0});f.prototype.abort=function(a){this._queue.abort("string"===
typeof a?a:a.id)};f.prototype.clear=function(){this._queue.clear();this._keyToItem.clear();this.notifyChange("updating")};f.prototype.has=function(a){return"string"===typeof a?this._keyToItem.has(a):this._keyToItem.has(a.id)};f.prototype.isOngoing=function(a){a="string"===typeof a?a:a.id;return this.has(a)&&this._queue.isOngoing(a)};f.prototype.pause=function(){this._queue.pause()};f.prototype.push=function(a){var b=this,d=a.key.id;if(this.has(d))return this.get(d);var c=this._queue.push(d),e=function(){b._keyToItem.delete(d);
b.notifyChange("updating")};this._keyToItem.set(d,a);c.then(e,e);this.notifyChange("updating");return c};f.prototype.reset=function(){this._queue.reset();this.notifyChange("updating")};f.prototype.resume=function(){this._queue.resume()};f.prototype._peekByScaleFirst=function(a){var c=this;if(!this.state)return k.firstOfSet(a);var e=this.tileInfoView,g=Number.NEGATIVE_INFINITY,f=Number.POSITIVE_INFINITY;a.forEach(function(a){a=c._keyToItem.get(a);var d=c.tileInfoView.getTileScale(a.key);n.has(d)||
(n.set(d,[]),g=Math.max(d,g),f=Math.min(d,f));n.get(d).push(a.key);b.add(d)});var l=this.state.scale;n.has(l)||(h(d,b),d.sort(),l=d.reduce(function(a,b){return Math.abs(b-l)<Math.abs(a-l)?b:a},d[0]));l=Math.min(l,g);l=Math.max(l,f);a=n.get(l);var m=e.getClosestInfoForScale(l),p=m.getColumnForX(this.state.center[0]),q=m.getRowForY(this.state.center[1]);a.sort(function(a,b){var d=m.denormalizeCol(a.col,a.world),c=m.denormalizeCol(b.col,b.world);return Math.sqrt((p-d)*(p-d)+(q-a.row)*(q-a.row))-Math.sqrt((p-
c)*(p-c)+(q-b.row)*(q-b.row))});b.clear();n.clear();return a[0].id};f.prototype._peekByCenterFirst=function(a){var b=this;if(!this.state)return k.firstOfSet(a);var d=this.tileInfoView,c=this.state.center,e=Number.POSITIVE_INFINITY,f=null;a.forEach(function(a){a=b._keyToItem.get(a);d.getTileCoords(p,a.key);var h=g.vec2.distance(p,c);h<e&&(e=h,f=a.key)});return f.id};e.__decorate([l.property({constructOnly:!0})],f.prototype,"concurrency",void 0);e.__decorate([l.property({constructOnly:!0})],f.prototype,
"process",void 0);e.__decorate([l.property()],f.prototype,"state",void 0);e.__decorate([l.property({constructOnly:!0})],f.prototype,"strategy",void 0);e.__decorate([l.property({constructOnly:!0})],f.prototype,"tileInfoView",void 0);e.__decorate([l.property({readOnly:!0})],f.prototype,"updating",null);return f=e.__decorate([l.subclass("esri.views.2d.tiling.TileQueue")],f)}(m)})},"esri/views/support/QueueProcessor":function(){define("require exports ../../core/maybe ../../core/promiseUtils ../../core/Queue ../../core/scheduling".split(" "),
function(f,a,e,m,k,l){Object.defineProperty(a,"__esModule",{value:!0});var g=function(){return function(a,e){this.item=a;this.controller=e;this.promise=null}}();f=function(){function a(a){var b=this;this._deferreds=new Map;this._controllers=new Map;this._processingItems=new Map;this._isPaused=!1;this._task=this._schedule=null;this.concurrency=1;a.concurrency&&(this.concurrency=a.concurrency);this._queue=new k.default(a.peeker);this.process=a.process;var d=a.scheduler;a.task&&e.isSome(d)&&(this._task=
d.registerTask(a.task,function(a){return b.update(a)},function(){return b.needsUpdate()}))}a.prototype.destroy=function(){this.clear();this._schedule&&(this._schedule.remove(),this._schedule=null);this._task&&(this._task.remove(),this._task=null)};Object.defineProperty(a.prototype,"length",{get:function(){return this._processingItems.size+this._queue.length},enumerable:!0,configurable:!0});a.prototype.abort=function(a){(a=this._controllers.get(a))&&a.abort()};a.prototype.clear=function(){this._queue.clear();
var a=[];this._controllers.forEach(function(b){return a.push(b)});this._controllers.clear();a.forEach(function(a){return a.abort()});this._processingItems.clear();this._cancelNext()};a.prototype.get=function(a){return(a=this._deferreds.get(a))?a.promise:void 0};a.prototype.isOngoing=function(a){return this._processingItems.has(a)};a.prototype.has=function(a){return this._deferreds.has(a)};a.prototype.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())};a.prototype.push=function(a){var b=
this,d=this.get(a);if(d)return d;var c,d=m.createAbortController(),e=function(){g.remove();b._deferreds.delete(a);b._controllers.delete(a);b._queue.remove(a);b._processingItems.delete(a);b._scheduleNext()},g=m.onAbortOrThrow(d.signal,function(){var d=b._processingItems.get(a);d&&d.controller.abort();e();c.reject(m.createAbortError())});c=m.createDeferred();this._deferreds.set(a,c);this._controllers.set(a,d);c.promise.then(e,e);this._queue.push(a);this._scheduleNext();return c.promise};a.prototype.reset=
function(){var a=[];this._processingItems.forEach(function(b){return a.push(b)});this._processingItems.clear();for(var b=0;b<a.length;b++){var d=a[b];this._queue.push(d.item);d.controller.abort()}this._scheduleNext()};a.prototype.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())};a.prototype.needsUpdate=function(){return!this._isPaused&&0<this._queue.length&&this._processingItems.size<this.concurrency};a.prototype.update=function(a){for(;!a.done&&0<this._queue.length&&this._processingItems.size<
this.concurrency;)this._process(this._queue.pop()),a.madeProgress()};a.prototype._scheduleNext=function(){var a=this;this._task||this._isPaused||this._schedule||(this._schedule=l.schedule(function(){a._schedule=null;a._next()}))};a.prototype._next=function(){for(;0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())};a.prototype._cancelNext=function(){this._schedule&&(this._schedule.remove(),this._schedule=null)};a.prototype._processResult=function(a,
b){this._canProcessFulfillment(a)&&(this._scheduleNext(),this._deferreds.get(a.item).resolve(b))};a.prototype._processError=function(a,b){this._canProcessFulfillment(a)&&(this._scheduleNext(),this._deferreds.get(a.item).reject(b))};a.prototype._canProcessFulfillment=function(a){return this._deferreds.get(a.item)&&this._processingItems.get(a.item)===a?!0:!1};a.prototype._process=function(a){var b=this;if(!e.isNone(a)){var d,c=m.createAbortController(),f=new g(a,c);this._processingItems.set(a,f);try{d=
this.process(a,c.signal)}catch(r){this._processError(f,r)}d&&"function"===typeof d.then?(f.promise=d,d.then(function(a){return b._processResult(f,a)},function(a){return b._processError(f,a)})):this._processResult(f,d)}};Object.defineProperty(a.prototype,"test",{get:function(){var a=this;return{update:function(b){return a.update(b)}}},enumerable:!0,configurable:!0});return a}();a.QueueProcessor=f})},"esri/core/Queue":function(){define(["require","exports","./SetUtils"],function(f,a,e){Object.defineProperty(a,
"__esModule",{value:!0});f=function(){function a(a){void 0===a&&(a=function(a){return e.firstOfSet(a)});this._peeker=a;this._items=new Set}Object.defineProperty(a.prototype,"length",{get:function(){return this._items.size},enumerable:!0,configurable:!0});a.prototype.clear=function(){this._items.clear()};a.prototype.peek=function(){if(0!==this._items.size)return this._peeker(this._items)};a.prototype.push=function(a){this.contains(a)||this._items.add(a)};a.prototype.contains=function(a){return this._items.has(a)};
a.prototype.pop=function(){if(0!==this.length){var a=this.peek();this._items.delete(a);return a}};a.prototype.remove=function(a){this._items.delete(a)};return a}();a.default=f})},"esri/views/2d/tiling/TileStrategy":function(){define(["require","exports","./TileCache","./TileCoverage","./TileKey"],function(f,a,e,m,k){var l=new k(0,0,0,0),g=new Map,c=[],h=[];return function(){function a(a){var b=this;this._previousScale=Number.POSITIVE_INFINITY;this.cachePolicy="keep";this.coveragePolicy="closest";
this.resampling=!0;this.tileIndex=new Map;this.tiles=[];this.buffer=192;this.acquireTile=a.acquireTile;this.releaseTile=a.releaseTile;this.tileInfoView=a.tileInfoView;this.resampling=null==a.resampling||!!a.resampling;a.cachePolicy&&(this.cachePolicy=a.cachePolicy);a.coveragePolicy&&(this.coveragePolicy=a.coveragePolicy);null!=a.buffer&&(this.buffer=a.buffer);a.cacheSize&&(this._tileCache=new e.default(a.cacheSize,this.tileInfoView,function(a){b.releaseTile(a)}))}a.prototype.destroy=function(){this.tileIndex.clear()};
a.prototype.update=function(a){var b=this,d=this.resampling,e=this.tileIndex,f=this.tileInfoView.getTileCoverage(a.state,this.buffer,this.coveragePolicy);h.length=0;c.length=0;g.clear();if(f){var k=this.tileInfoView.tileInfo,u=k.minScale,v=k.maxScale,y=f.spans,z=f.lodInfo,A=z.level,B=a.state,D=B.scale,k=B.center,B=B.resolution,C=!a.stationary&&D>this._previousScale;this._previousScale=D;this.tiles.length=0;if(!d&&(D>u||D<v))return this.tiles.length=0,g.clear(),e.forEach(function(a){b.releaseTile(a)}),
e.clear(),h.length=0,c.length=0,g.clear(),m.pool.release(f),!0;e.forEach(function(a){return a.visible=!0});v=u=0;if(0<y.length)for(D=0;D<y.length;D++){a=y[D];for(var E=a.row,F=a.colTo,I=a.colFrom;I<=F;I++)if(u++,a=l.set(A,E,z.normalizeCol(I),z.getWorldForColumn(I)).id,e.has(a))d=e.get(a),d.isReady?(g.set(a,d),v++):C||this._addParentTile(a,g);else{d=void 0;if(this._tileCache&&this._tileCache.has(a)){if(d=this._tileCache.pop(a),this.tileIndex.set(a,d),d.isReady){g.set(a,d);v++;continue}}else d=this.acquireTile(l),
this.tileIndex.set(a,d);C||this._addParentTile(a,g)}}var J=v===u;e.forEach(function(a,d){l.set(d);if(!g.has(d)){var e=b.tileInfoView.intersects(f,l);!e||!C&&J?"purge"===b.cachePolicy?l.level===A&&e||c.push(d):(l.level>A||!e)&&c.push(d):a.isReady?h.push(d):l.level>A&&c.push(d)}});for(y=0;y<h.length;y++)a=h[y],(d=e.get(a))&&d.isReady&&g.set(a,d);for(y=0;y<c.length;y++)a=c[y],d=e.get(a),this._tileCache?this._tileCache.add(d):this.releaseTile(d),e["delete"](a);g.forEach(function(a){return b.tiles.push(a)});
e.forEach(function(a){g.has(a.key.id)||(a.visible=!1)});this._tileCache&&this._tileCache.prune(A,k,B);m.pool.release(f);return J}};a.prototype.clear=function(a){var b=this;void 0===a&&(a=!0);var d=this.tileIndex;a&&d.forEach(function(a){b.releaseTile(a)});d.clear()};a.prototype._addParentTile=function(a,b){for(var d=null;;){a=this.tileInfoView.getTileParentId(a);if(!a)break;if(this.tileIndex.has(a)){if((d=this.tileIndex.get(a))&&d.isReady){b.has(d.key.id)||b.set(d.key.id,d);break}}else if(this._tileCache&&
this._tileCache.has(a)&&(d=this._tileCache.pop(a),this.tileIndex.set(a,d),d&&d.isReady)){b.has(d.key.id)||b.set(d.key.id,d);break}}};return a}()})},"esri/views/2d/tiling/TileCache":function(){define(["require","exports","../../../core/libs/gl-matrix-2/vec2"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(a,e,g){this.maxSize=a;this.tileInfoView=e;this.removedFunc=g;this._tilePerId=new Map;this._tileKeysPerLevel=[]}a.prototype.has=function(a){return this._tilePerId.has(a)};
a.prototype.get=function(a){return this._tilePerId.get(a)};a.prototype.pop=function(a){var e=this._tilePerId.get(a);if(!e)return null;var g=this._tileKeysPerLevel[e.key.level];this._tilePerId["delete"](a);for(var c=0;c<g.length;c++)if(g[c].id===a){g.splice(c,1);break}e.visible=!0;return e};a.prototype.add=function(a){a.visible=!1;var e=a.key,g=e.id;this._tilePerId.has(g)||(this._tilePerId.set(g,a),a=e.level,this._tileKeysPerLevel[a]||(this._tileKeysPerLevel[a]=[]),this._tileKeysPerLevel[a].push(e))};
a.prototype.prune=function(a,e,g){var c=this._tilePerId.size;if(!(c<=this.maxSize)){for(var f=this._tileKeysPerLevel.length-1;c>this.maxSize&&0<=f;)f!==a&&(c=this._pruneAroundCenterTile(c,e,g,f)),f--;c>this.maxSize&&(c=this._pruneAroundCenterTile(c,e,g,a))}};a.prototype._pruneAroundCenterTile=function(a,f,g,c){c=this._tileKeysPerLevel[c];if(!c||0===c.length)return a;var h=this.tileInfoView.tileInfo,b=h.size,d=h.origin,k=g*b[0],l=g*b[1],m=[0,0],q=[0,0];for(c.sort(function(a,b){m[0]=d.x+k*(a.col+.5);
m[1]=d.y-l*(a.row+.5);q[0]=d.x+k*(b.col+.5);q[1]=d.y-l*(b.row+.5);return e.vec2.squaredDistance(m,f)-e.vec2.squaredDistance(q,f)});0<c.length&&(g=c.pop(),this._removeTile(g.id),a--,a!==this.maxSize););return a};a.prototype._removeTile=function(a){var e=this._tilePerId.get(a);this.removedFunc&&this.removedFunc(e);this._tilePerId["delete"](a)};return a}();a.default=f})},"esri/views/2d/engine/webgl/collisions/CollisionBucketEntry":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/vec2"],
function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){this._reference=null}Object.defineProperty(a.prototype,"dirty",{get:function(){return this.reference&&this.reference.isDirty},set:function(a){this.reference&&this.reference.hasData&&(a||this.reference.isDirty)&&(this.reference.isDirty=a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"index",{get:function(){return this._reference&&this._reference.labelIndex},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"reference",{get:function(){return this._reference},set:function(a){this._reference=a},enumerable:!0,configurable:!0});a.prototype.reset=function(a,f,g){a=a.state;var c=g.layerView.tileRenderer,h=this.reference;if(!h||!h.hasData)return!1;f&&(h.isDirty=!0);f=h.transforms.labelMat2d;for(var b=f[4],d=f[5],k=0,l=h.displayObjects;k<l.length;k++)for(var m=l[k],q=c.featuresView.attributeView,q=g.hasVV()?q.getVVSize(m.id):0,x=0,m=m.metrics;x<m.length;x++){var u=m[x];g.hasVV()&&
u.computeVVOffset(q,g.vvEval);var v=u.bounds.center,y=u.bounds.centerT;h.isDirty&&(u.minZoom=-1);var z=e.vec2.copy(y,u.anchor);a.rotation?e.vec2.transformMat2d(z,z,f):(y[0]=z[0]+b,y[1]=z[1]+d);e.vec2.add(y,z,v);y[0]+=u.offsetX;y[1]+=u.offsetY;if(u.boxes)for(v=0,y=u.boxes;v<y.length;v++){var z=y[v],A=z.centerT;e.vec2.add(A,u.anchor,z.center);a.rotation?e.vec2.transformMat2d(A,A,f):(A[0]+=b,A[1]+=d)}}return!0};return a}();a.default=f})},"esri/views/2d/engine/webgl/collisions/LayerCollisionInfo":function(){define("require exports tslib ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/screenUtils ./visualVariableSimpleUtils".split(" "),
function(f,a,e,m,k,l,g){function c(a,b){var d=!!a.maxScale,c=!!a.minScale&&b.scaleToZoom(a.minScale)||0;b=d&&b.scaleToZoom(a.maxScale)||255;return{deconflictionStrategy:a.deconflictionStrategy,minZoom:k.clamp(Math.floor(10*c),0,255),maxZoom:k.clamp(Math.floor(10*b),0,255)}}function h(a){return function(b){return l.pt2px(g.getSizeForValueSimple(b,a))}}function b(a){if(!a)return null;for(var b=0;b<a.length;b++){var d=a[b];if("size"===d.type)return h(d)}return null}Object.defineProperty(a,"__esModule",
{value:!0});var d=function(a,b){return a.order-b.order},n=function(a,b){return a.index-b.index},p=m.getLogger("esri/views/2d/engine/webgl/collisions/CollisionEngine");a.createLabelVVEvaluator=b;f=function(){function a(a,d,g,f){var h=this;this._vvHandle=null;var k=a.layer,l=k.geometryType,n=k.labelingInfo,m=k.renderer;m&&(this.vvEval=b("visualVariables"in m&&m.visualVariables));this._vvHandle=k.watch("renderer",function(a){a&&(h.vvEval=b("visualVariables"in a&&a.visualVariables))});k=(k=k.featureReduction)&&
"cluster"===k.type&&k.labelingInfo;n=(n||[]).map(function(a){return c(a,f)});k=(k||[]).map(function(a){return c(a,f)});this.layerView=a;this.geometryType=l;this.index=d;this.order=g;this.zoomRanges=e.__spreadArrays(n,k);this.layerView=a}a.prototype.hasVV=function(){return!!this.vvEval};a.prototype.allOrNothing=function(){return"polyline"!==this.geometryType};a.prototype.destroy=function(){this._vvHandle.remove()};a.create=function(b,c,e,g){e=e.sort(d);for(var f=!1,h=-1,k=0;k<e.length;k++){var l=e[k];
!f&&l.order>c&&(h=l.index,f=!0);f&&l.index++}f||(h=e.length);return new a(b,h,c,g)};a.delete=function(a,b){for(var d=b.sort(n),c=a+1;c<d.length;c++)b[c].index--;b[a].destroy();b.splice(a,1)};a.find=function(a,b){for(var d=0;d<b.length;d++){var c=b[d];if(c.index===a)return c}p.error("Tried to get a LayerCollisionInfo for an index that doesn't exist!");return null};return a}();a.default=f})},"esri/views/2d/engine/webgl/collisions/visualVariableSimpleUtils":function(){define(["require","exports","../../../../../core/mathUtils",
"../../../../../renderers/support/utils"],function(f,a,e,m){function k(a,b){switch(b.transformationType){case "additive":var d=l(b.minSize,a);return a+(d||b.minDataValue);case "constant":return d=(d=b.stops)&&d.length&&d[0].size,null==d&&(d=b.minSize),l(d,a);case "clamped-linear":var d=(a-b.minDataValue)/(b.maxDataValue-b.minDataValue),f=l(b.minSize,a),h=l(b.maxSize,a);a=a<=b.minDataValue?f:a>=b.maxDataValue?h:f+d*(h-f);return a;case "proportional":return d=a/b.minDataValue,f=l(b.minSize,a),a=l(b.maxSize,
a),e.clamp(d*f,f,a);case "stops":return f=g(a,b.cache.ipData),h=f[0],d=f[1],f=f[2],h===d?a=l(b.stops[h].size,a):(h=l(b.stops[h].size,a),a=l(b.stops[d].size,a),a=h+(a-h)*f),a;case "real-world-size":d=m.meterIn[b.valueUnit];f=l(b.minSize,a);h=l(b.maxSize,a);b=b.valueRepresentation;var k=null,k="area"===b?2*Math.sqrt(a/c)/d:"radius"===b||"distance"===b?2*a/d:a/d;return e.clamp(k,f,h);case "identity":return a;case "unknown":return null}}function l(a,b){return"number"===typeof a?a:k(b,a)}function g(a,
b){if(b){var d=0,c=b.length-1;b.some(function(b,e){if(a<b)return c=e,!0;d=e;return!1});return[d,c,(a-b[d])/(b[c]-b[d])]}}Object.defineProperty(a,"__esModule",{value:!0});var c=Math.PI;a.getSizeForValueSimple=k})},"esri/renderers/support/utils":function(){define("require exports ../../core/arrayUtils ../../core/Logger ../../core/unitUtils ../../intl/date ./numberUtils ../visualVariables/support/ColorStop".split(" "),function(f,a,e,m,k,l,g,c){function h(a,b,d){var c="";0===b?c=p.lt+" ":b===d&&(c=p.gt+
" ");return c+a}function b(a){var b=a.minValue,d=a.maxValue,c=a.isFirstBreak?"":p.gt+" ";a="percent-of-total"===a.normalizationType?p.pct:"";b=null==b?"":g.format(b);d=null==d?"":g.format(d);return c+b+a+" "+p.ld+" "+d+a}function d(a,b){return"normalizationField"in a&&a.normalizationField?{type:"normalized-field",field:a.field,normalizationField:a.normalizationField}:"field"in a&&a.field?{type:"field",field:a.field}:"valueExpression"in a&&a.valueExpression?{type:"expression",expression:a.valueExpression,
title:a.valueExpressionTitle,returnType:b}:null}Object.defineProperty(a,"__esModule",{value:!0});var n=m.getLogger("esri.renderers.support.utils"),p={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},r={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},q={millisecond:"long-month-day-year-long-time",second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",month:"long-month-day-year",
year:"year"};a.meterIn={inches:k.convertUnit(1,"meters","inches"),feet:k.convertUnit(1,"meters","feet"),"us-feet":k.convertUnit(1,"meters","us-feet"),yards:k.convertUnit(1,"meters","yards"),miles:k.convertUnit(1,"meters","miles"),"nautical-miles":k.convertUnit(1,"meters","nautical-miles"),millimeters:k.convertUnit(1,"meters","millimeters"),centimeters:k.convertUnit(1,"meters","centimeters"),decimeters:k.convertUnit(1,"meters","decimeters"),meters:k.convertUnit(1,"meters","meters"),kilometers:k.convertUnit(1,
"meters","kilometers"),"decimal-degrees":1/k.lengthToDegrees(1,"meters")};a.timelineDateFormatOptions=l.convertDateFormatToIntlOptions("short-date");a.createColorStops=function(a){var b=a.values,d=a.colors,e=a.labelIndexes,f=a.isDate,k=a.dateFormatOptions;return b.map(function(a,n){var m=null;if(!e||-1<e.indexOf(n)){var p=void 0;(p=f?l.formatDate(a,k):g.format(a))&&(m=h(p,n,b.length-1))}return new c({value:a,color:d[n],label:m})})};a.updateColorStops=function(a){var b=a.stops,d=a.changes,c=a.isDate,
e=a.dateFormatOptions,f=b.map(function(a){return a.value});a=[];for(var k=0;k<d.length;k++){var n=d[k];a.push(n.index);f[n.index]=n.value}var m=g.round(f,{indexes:a});b.forEach(function(a,d){a.value=f[d];if(null!=a.label){var k=void 0,n=null;(k=c?l.formatDate(m[d],e):g.format(m[d]))&&(n=h(k,d,b.length-1));a.label=n}})};a.createClassBreakLabel=b;a.setLabelsForClassBreaks=function(a){var d=a.classBreakInfos,c=a.normalizationType,e=[];if(d&&d.length)if("standard-deviation"===a.classificationMethod)n.warn("setLabelsForClassBreaks",
"cannot set labels for class breaks generated using 'standard-deviation' method.");else if(a.round){e.push(d[0].minValue);for(a=0;a<d.length;a++)e.push(d[a].maxValue);e=g.round(e);d.forEach(function(a,d){a.label=b({minValue:0===d?e[0]:e[d],maxValue:e[d+1],isFirstBreak:0===d,normalizationType:c})})}else d.forEach(function(a,d){a.label=b({minValue:a.minValue,maxValue:a.maxValue,isFirstBreak:0===d,normalizationType:c})})};a.updateClassBreak=function(a){if("standard-deviation"===a.classificationMethod)n.warn("updateClassBreak",
"cannot update labels for class breaks generated using 'standard-deviation' method.");else{var d=a.classBreaks,c=a.change,e=c.index,c=c.value,g=d.length,f=-1,h=-1;0===e?f=e:e===g?h=e-1:(h=e-1,f=e);a=a.normalizationType;e=null;-1<f&&f<g&&(e=d[f],e.minValue=c,e.label=b({minValue:e.minValue,maxValue:e.maxValue,isFirstBreak:0===f,normalizationType:a}));-1<h&&h<g&&(e=d[h],e.maxValue=c,e.label=b({minValue:e.minValue,maxValue:e.maxValue,isFirstBreak:0===h,normalizationType:a}))}};a.calculateDateFormatInterval=
function(a){a=a.map(function(a){return new Date(a)});for(var b=a.length,d=Infinity,c=null,e=0;e<b-1;e++){for(var g=a[e],f=[],h=Infinity,k=null,l=e+1;l<b;l++){var n=a[l],n=g.getFullYear()!==n.getFullYear()&&"year"||g.getMonth()!==n.getMonth()&&"month"||g.getDate()!==n.getDate()&&"day"||g.getHours()!==n.getHours()&&"hour"||g.getMinutes()!==n.getMinutes()&&"minute"||g.getSeconds()!==n.getSeconds()&&"second"||"millisecond",m=r[n];m<h&&(h=m,k=n);f.push(n)}h<d&&(d=h,c=k)}return c};a.createUniqueValueLabel=
function(a){var b=a.value,d=a.domain,c=a.fieldInfo;a=a.dateFormatInterval;var e=String(b);(d=d&&"codedValues"in d&&d.codedValues?d.getName(b):null)?e=d:"number"===typeof b&&(e=c&&"date"===c.type?l.formatDate(b,a&&l.convertDateFormatToIntlOptions(q[a])):g.format(b));return e};a.getAttribute=d;a.getAttributes=function(a,b){var c=[];if("class-breaks"===a.type||"heatmap"===a.type)c.push(d(a,"number"));else if("unique-value"===a.type){var g=a.authoringInfo;if(g&&"relationship"===g.type){if(g.field1&&g.field2){var f=
g.field2.field,h=g.field2.normalizationField;c.push(d({field:g.field1.field,normalizationField:g.field1.normalizationField}));c.push(d({field:f,normalizationField:h}))}}else f=a.uniqueValueInfos[0],g=null,f&&f.value&&(f=typeof a.uniqueValueInfos[0].value,"string"===f||"number"===f)&&(g=f),c.push(d(a,g)),[a.field2,a.field3].forEach(function(a){return a&&c.push({type:"field",field:a})})}else"dot-density"===a.type&&a.attributes.forEach(function(a){return c.push(d(a,"number"))});(a=b?b(a):"visualVariables"in
a?a.visualVariables:null)&&a.forEach(function(a){return c.push(d(a,"number"))});return e.unique(c.filter(Boolean),function(a,b){return"field"===a.type&&"field"===b.type?a.field===b.field:"normalized-field"===a.type&&"normalized-field"===b.type?a.field===b.field&&a.normalizationField===b.normalizationField:"expression"===a.type&&"expression"===b.type?a.expression===b.expression:!1})}})},"esri/renderers/support/numberUtils":function(){define(["require","exports","../../intl"],function(f,a,e){function m(a,
b){return a-b}function k(a,b){var d;d=Number(a.toFixed(b));d<a?a=d+1/Math.pow(10,b):(a=d,d-=1/Math.pow(10,b));d=Number(d.toFixed(b));a=Number(a.toFixed(b));return[d,a]}function l(a,b,e,g,f){a=c(a,b,e,g);b=null==a.next||a.next<=f;return(null==a.previous||a.previous<=f)&&b||a.previous+a.next<=2*f}function g(a){a=String(a);var b=a.match(h);if(b&&b[1])return{integer:b[1].split("").length,fractional:b[3]?b[3].split("").length:0};if(-1<a.toLowerCase().indexOf("e")&&(b=a.split("e"),a=b[0],b=b[1],a&&b)){a=
Number(a);var b=Number(b),d=0<b;d||(b=Math.abs(b));a=g(a);d?(a.integer+=b,a.fractional=b>a.fractional?0:a.fractional-b):(a.fractional+=b,a.integer=b>a.integer?1:a.integer-b);return a}return{integer:0,fractional:0}}function c(a,b,c,e){var d={previous:null,next:null};if(null!=c){var g=a-c;d.previous=Math.floor(Math.abs(100*(b-c-g)/g))}null!=e&&(g=e-a,d.next=Math.floor(Math.abs(100*(e-b-g)/g)));return d}Object.defineProperty(a,"__esModule",{value:!0});var h=/^-?(\d+)(\.(\d+))?$/i;a.numDigits=g;a.percentChange=
c;a.round=function(a,b){void 0===b&&(b={});a=a.slice(0);var d=b.tolerance,d=void 0===d?2:d,c=b.strictBounds,c=void 0===c?!1:c;b=b.indexes;b=void 0===b?a.map(function(a,b){return b}):b;b.sort(m);for(var e=0;e<b.length;e++){var f=b[e],h=a[f],n=0===f?null:a[f-1],y=f===a.length-1?null:a[f+1],z=g(h).fractional;if(z){for(var A=0,B=!1,D=void 0;A<=z&&!B;)B=k(h,A),D=c&&0===e?B[1]:B[0],B=l(h,D,n,y,d),A++;B&&(a[f]=D)}}return a};var b={maximumFractionDigits:20};a.format=function(a){return e.formatNumber(a,b)}})},
"esri/renderers/visualVariables/support/ColorStop":function(){define("require exports tslib ../../../Color ../../../core/JSONSupport ../../../core/accessorSupport/decorators ../../../core/accessorSupport/ensureType".split(" "),function(f,a,e,m,k,l,g){return function(a){function c(b){b=a.call(this,b)||this;b.color=null;b.label=null;b.value=null;return b}e.__extends(c,a);b=c;c.prototype.writeValue=function(a,b,c){b[c]=null==a?0:a};c.prototype.clone=function(){return new b({color:this.color&&this.color.clone(),
label:this.label,value:this.value})};var b;e.__decorate([l.property({type:m,json:{type:[g.Integer],write:!0}})],c.prototype,"color",void 0);e.__decorate([l.property({type:String,json:{write:!0}})],c.prototype,"label",void 0);e.__decorate([l.property({type:Number,json:{write:{allowNull:!0}}})],c.prototype,"value",void 0);e.__decorate([l.writer("value")],c.prototype,"writeValue",null);return c=b=e.__decorate([l.subclass("esri.renderers.visualVariables.support.ColorStop")],c)}(k.JSONSupport)})},"esri/views/2d/engine/webgl/collisions/LayerViewSorter":function(){define(["require",
"exports","../../../../../core/Error","../../../../../core/Logger"],function(f,a,e,m){function k(a){return"esri.views.2d.layers.FeatureLayerView2D"===a.declaredClass||"esri.views.2d.layers.StreamLayerView2D"===a.declaredClass}Object.defineProperty(a,"__esModule",{value:!0});var l=m.getLogger("esri.views.2d.engine.collisions.LayerViewSorter");f=function(){function a(a,e){this.registerLayer=a;this.unregisterLayer=e;this._layerViewState=new Map}a.prototype.findIndex=function(a){return a.view.allLayerViews.findIndex(function(c){return c.uid===
a.uid})};a.prototype.update=function(a){for(var c=a.added,b=0,d=a.removed;b<d.length;b++)a=d[b],k(a)&&this._layerViewState.has(a)&&this._deleteState(a);for(b=0;b<c.length;b++){a=c[b];if(d=k(a))a:if(a.layer&&a.layer.renderer)switch(a.layer.renderer.type){case "class-breaks":case "simple":case "unique-value":case "dictionary":case "dot-density":d=!0;break a;default:l.error(new e("mapview-labeling","Renderer of type "+a.layer.renderer.type+" does not currently support labeling")),d=!1}else d=!1;d&&!this._layerViewState.has(a)&&
this._createState(a)}this._recomputeOrder()};a.prototype.destroy=function(){this._layerViewState.forEach(function(a){return a.handles.forEach(function(a){return a.remove()})})};a.prototype._createState=function(a){var c={priority:-1,handles:null};c.handles=[a.layer.watch("visible",this._recomputeOrder.bind(this)),a.layer.watch("labelsVisible",this._recomputeOrder.bind(this)),a.layer.watch("labelingInfo",this._recomputeOrder.bind(this)),a.layer.watch("featureReduction",this._recomputeOrder.bind(this))];
this._layerViewState.set(a,c);return c};a.prototype._deleteState=function(a){if(this._layerViewState.has(a)){var c=this._layerViewState.get(a);c.handles.forEach(function(a){return a.remove()});-1!==c.priority&&this.unregisterLayer(a);this._layerViewState.delete(a)}};a.prototype._recomputeOrder=function(){var a=this;this._layerViewState.forEach(function(c,b){var d=b.view.map.allLayers.findIndex(function(a){return a.uid===b.layer.uid}),e=b.layer,g=e.featureReduction,g=g&&"cluster"===g.type&&g.labelsVisible&&
g.labelingInfo&&g.labelingInfo.length,g=e.labelingInfo&&e.labelingInfo.length||g,d=e.visible&&e.labelsVisible&&g?4294967295-d:-1;d!==c.priority&&(c.priority=d,a.unregisterLayer(b),-1!==d&&a.registerLayer(b,d))})};return a}();a.LayerViewSorter=f})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});var e;(function(a){a[a.Left=-1]="Left";a[a.Center=0]="Center";a[a.Right=1]="Right"})(e=a.HAlign||(a.HAlign=
{}));var m;(function(a){a[a.Top=1]="Top";a[a.Center=0]="Center";a[a.Bottom=-1]="Bottom";a[a.Baseline=2]="Baseline"})(m=a.VAlign||(a.VAlign={}));a.getXAnchorDirection=function(a){switch(a){case "left":return e.Left;case "right":return e.Right;case "center":case "justify":return e.Center}};a.getYAnchorDirection=function(a){switch(a){case "top":return m.Top;case "middle":return m.Center;case "baseline":return m.Baseline;case "bottom":return m.Bottom}};a.getAlignmentFromPlacement=function(a){switch(a){case "above-left":return[e.Right,
m.Bottom];case "above-center":case "above-along":return[e.Center,m.Bottom];case "above-right":return[e.Left,m.Bottom];case "center-left":return[e.Right,m.Center];case "center-center":case "center-along":return[e.Center,m.Center];case "center-right":return[e.Left,m.Center];case "below-left":return[e.Right,m.Top];case "below-center":case "below-along":return[e.Center,m.Top];case "below-right":return[e.Left,m.Top];case "always-horizontal":return[e.Center,m.Baseline];default:return console.debug("Found invalid placement type "+
a),[e.Center,m.Center]}};a.getXDirection=function(a){switch(a){case e.Right:return-1;case e.Center:return 0;case e.Left:return 1;default:return console.debug("Found invalid horizontal alignment "+a),0}};a.getYDirection=function(a){switch(a){case m.Top:return 1;case m.Center:return 0;case m.Bottom:case m.Baseline:return-1;default:return console.debug("Found invalid vertical alignment "+a),0}};a.getJustification=function(a){switch(a){case "left":return e.Left;case "right":return e.Right;case "center":case "justify":return e.Center}}})},
"esri/views/2d/engine/webgl/brushes/BrushBitmap":function(){define("require exports tslib ../definitions ../VertexStream ./WGLBrush".split(" "),function(f,a,e,m,k,l){Object.defineProperty(a,"__esModule",{value:!0});var g={nearest:{defines:[],samplingMode:9728,mips:!1},bilinear:{defines:[],samplingMode:9729,mips:!1},bicubic:{defines:["bicubic"],samplingMode:9729,mips:!1},trilinear:{defines:[],samplingMode:9987,mips:!0}};f=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b._desc=
{path:"raster/bitmap",attributes:{a_position:0,a_texcoord:1}};return b}e.__extends(c,a);c.prototype.dispose=function(){this._quad&&this._quad.dispose()};c.prototype.prepareState=function(a,d){a=a.context;a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,d.stencilRef,255)};c.prototype.draw=function(a,d){var b=a.context,c=a.renderingOptions,e=a.painter;if(d.source){a.timeline.begin(this.name);
this._quad||(this._quad=new k(b,[0,0,1,0,0,1,1,1]));if("dynamic"===c.samplingMode)var c=a.state,f=d.resolution/d.pixelRatio/c.resolution,h=Math.round(a.pixelRatio)!==a.pixelRatio,c=c.rotation||1.05<f||.95>f||h||d.isSourceScaled||d.rotation?g.bilinear:g.nearest;else c=g[c.samplingMode];e=e.materialManager.getProgram(a,this._desc,c.defines);d.setSamplingProfile(c);d.bind(m.TEXTURE_BINDING_BITMAP);b.bindProgram(e);e.setUniformMatrix3fv("u_dvsMat3",d.transforms.dvs);e.setUniform1i("u_texture",m.TEXTURE_BINDING_BITMAP);
e.setUniform2fv("u_coordScale",d.coordScale);this._quad.draw();a.timeline.end(this.name)}};return c}(l.default);a.default=f})},"esri/views/2d/engine/webgl/brushes/BrushClip":function(){define("require exports tslib ../../../../../core/libs/gl-matrix-2/vec4f32 ../Utils ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/programUtils".split(" "),function(f,a,e,m,k,l,g,c){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;
b._color=m.vec4f32.fromValues(0,1,0,1);return b}e.__extends(b,a);b.prototype.dispose=function(){this._program&&this._program.dispose()};b.prototype.prepareState=function(a){a=a.context;a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setFaceCullingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setStencilWriteMask(255);a.setStencilFunction(519,0,255)};b.prototype.draw=function(a,b){var d=a.context;a=a.state;this._program||(this._program=c.createProgram(d,g.background));
var e=this._program,f=k.createProgramDescriptor("clip",{geometry:[{location:0,name:"a_pos",count:2,type:5122}]});b=b.getVAO(d,a,f.attributes,f.bufferLayouts);d.bindProgram(this._program);e.setUniform2fv("u_coord_range",[1,1]);e.setUniform4fv("u_color",this._color);e.setUniformMatrix3fv("u_dvsMat3",a.displayMat3);d.bindVAO(b);d.drawElements(4,b.indexBuffer.size,5125,0);d.bindVAO()};return b}(l.default);a.default=f})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLBackground":function(){define("require exports tslib ../../../../../core/libs/gl-matrix-2/mat3f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../../vectorTiles/shaders/Programs ../definitions ../enums ../number ./WGLBrush".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b._color=k.vec4f32.fromValues(1,0,0,1);b._patternMatrix=m.mat3f32.create();b._programOptions={id:!1,pattern:!1};return b}e.__extends(d,a);d.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null);this._vao&&(this._vao.dispose(),this._vao=null)};d.prototype.drawMany=function(a,d){var e=a.context,g=a.styleLayerId;this._loadWGLResources(e);
var f=a.displayLevel,k=a.styleLayer,l=a.painter.getVectorTileProgramCach(),n=k.getPaintValue("background-color",f),m=k.getPaintValue("background-opacity",f),p=k.getPaintValue("background-pattern",f),q=void 0!==p,r=n[3]*m,F=a.spriteMosaic,I,J=(window.devicePixelRatio|1)>c.VTL_HIGH_RES_CUTOFF?2:1;a=a.drawPhase===h.WGLDrawPhase.HITTEST;var G=this._programOptions;G.id=a;G.pattern=q;l=l.getProgram(0,(a?1:0)<<1|(q?1:0),G);e.bindVAO(this._vao);e.bindProgram(l);if(q){I=F.getMosaicItemPosition(p,!0);if(!I)return;
l.setUniform1f("u_opacity",m);l.setUniform2f("u_pattern_tl",I.tl[0],I.tl[1]);l.setUniform2f("u_pattern_br",I.br[0],I.br[1]);l.setUniform1i("u_texture",c.VTL_TEXTURE_BINDING_UNIT_SPRITES);F.bind(e,9729,I.page,c.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else this._color[0]=r*n[0],this._color[1]=r*n[1],this._color[2]=r*n[2],this._color[3]=r,l.setUniform4fv("u_color",this._color);l.setUniform1f("u_depth",k.z||0);a&&(g=b.u32to4Xu8(g+1),l.setUniform4fv("u_id",g));for(g=0;g<d.length;g++)k=d[g],l.setUniform1f("u_coord_range",
k.coordRange[0]),l.setUniformMatrix3fv("u_dvsMat3",k.transforms.dvs),q&&(n=J*k.size[0]*Math.max(Math.pow(2,Math.round(f)-k.key.level),1),m=n/I.size[1],this._patternMatrix[0]=n/I.size[0],this._patternMatrix[4]=m,l.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),e.setStencilFunction(514,k.stencilRef,255),e.drawArrays(5,0,4)};d.prototype._loadWGLResources=function(a){if(!this._program||!this._vao){var b=l.createProgram(a,g.background);if(b){var d=new Int8Array([0,0,1,0,0,1,1,1]),d=l.BufferObject.createVertex(a,
35044,d);a=new l.VertexArrayObject(a,g.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:d});this._program=b;this._vao=a}}};return d}(d.default);a.WGLBrushVTLBackground=f})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLCircle":function(){define("require exports tslib ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../enums ../number ./WGLBrush".split(" "),function(f,a,e,m,k,l,g,c){Object.defineProperty(a,"__esModule",
{value:!0});var h=[1,1,1,1];f=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._color=m.vec4f32.create();b._strokeColor=m.vec4f32.create();b._programOptions={id:!1};b._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:16,normalized:!0,divisor:0},{name:"a_stroke_color",count:4,type:5121,offset:8,stride:16,normalized:!0,divisor:0},{name:"a_data",count:4,type:5121,offset:12,
stride:16,normalized:!1,divisor:0}]};return b}e.__extends(b,a);b.prototype.dispose=function(){};b.prototype.drawMany=function(a,b){var d=a.context,c=a.state,e=a.drawPhase,f=a.styleLayerId,k=a.displayLevel,m=a.styleLayer;a=a.painter.getVectorTileProgramCach();var n=m.hasDataDrivenRadius?1:m.getPaintValue("circle-radius",k),p=m.hasDataDrivenColor?h:m.getPaintValue("circle-color",k),B=m.hasDataDrivenOpacity?1:m.getPaintValue("circle-opacity",k),D=m.hasDataDrivenStrokeWidth?1:m.getPaintValue("circle-stroke-width",
k),C=m.hasDataDrivenStrokeColor?h:m.getPaintValue("circle-stroke-color",k),E=m.hasDataDrivenStrokeOpacity?1:m.getPaintValue("circle-stroke-opacity",k),F=m.hasDataDrivenBlur?0:m.getPaintValue("circle-blur",k),B=B*p[3];this._color[0]=B*p[0];this._color[1]=B*p[1];this._color[2]=B*p[2];this._color[3]=B;B=E*C[3];this._strokeColor[0]=B*C[0];this._strokeColor[1]=B*C[1];this._strokeColor[2]=B*C[2];this._strokeColor[3]=B;p=m.getPaintValue("circle-translate",k);k=m.getPaintValue("circle-translate-anchor",k);
C=e===l.WGLDrawPhase.HITTEST;e=this._programOptions;e.id=C;e=a.getProgram(5,C?1:0,e);d.bindProgram(e);e.setUniformMatrix3fv("u_displayMat3",1===k?c.displayMat3:c.displayViewMat3);e.setUniform2fv("u_circleTranslation",p);e.setUniform1f("u_depth",m.z);e.setUniform1f("u_radius",n);e.setUniform4fv("u_color",this._color);e.setUniform1f("u_blur",F);e.setUniform1f("u_stroke_width",D);e.setUniform4fv("u_stroke_color",this._strokeColor);e.setUniform1f("u_antialiasingWidth",1.2);C&&(c=g.u32to4Xu8(f+1),e.setUniform4fv("u_id",
c));for(c=0;c<b.length;c++)if(m=b[c],m.layerData[f]&&(n=m.layerData[f],D=this._getCircleVAO(d,m,a)))d.bindVAO(D),e.setUniformMatrix3fv("u_dvsMat3",m.transforms.dvs),d.setStencilFunction(514,m.stencilRef,255),d.drawElements(4,n.triangleElementCount,5125,12*n.triangleElementStart),m.triangleCount+=n.triangleElementCount/3};b.prototype._getCircleVAO=function(a,b,d){if(b.circleVertexArrayObject)return b.circleVertexArrayObject;var c=b.circleVertexBuffer,e=b.circleIndexBuffer;if(!c||!e)return null;b.circleVertexArrayObject=
new k.VertexArrayObject(a,d.getProgramAttributes(5),this._vertexAttributes,{geometry:c},e);return b.circleVertexArrayObject};return b}(c.default);a.WGLBrushVTLCircle=f})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLFill":function(){define("require exports tslib ../../../../../core/libs/gl-matrix-2/mat3f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../number ./WGLBrush".split(" "),function(f,a,e,m,k,l,g,c,h,b){Object.defineProperty(a,"__esModule",{value:!0});
var d=1/65536,n=[1,1,1,1];f=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._fillVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]};b._fillVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:8,normalized:!0,divisor:0}]};b._outlineVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,
divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,normalized:!1,divisor:0}]};b._outlineVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:12,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:12,normalized:!0,
divisor:0}]};b._color=k.vec4f32.create();b._outlineColor=k.vec4f32.create();b._fillProgramOptions={id:!1,dd:!1,pattern:!1};b._outlineProgramOptions={id:!1,dd:!1};b._patternMatrix=m.mat3f32.create();return b}e.__extends(b,a);b.prototype.dispose=function(){};b.prototype.drawMany=function(a,b){var d=a.displayLevel,e=a.drawPhase,g=a.renderPass,f=a.styleLayerId,k=a.styleLayer,l=k.getPaintValue("fill-pattern",d),m=k.hasDataDrivenColor?n:k.getPaintValue("fill-color",d),p=k.hasDataDrivenOpacity?1:k.getPaintValue("fill-opacity",
d),q=p*m[3],r=void 0!==l||1>q||k.hasDataDrivenFill;if(!r||"opaque"!==g){this._color[0]=q*m[0];this._color[1]=q*m[1];this._color[2]=q*m[2];this._color[3]=q;var x;e===c.WGLDrawPhase.HITTEST&&(x=h.u32to4Xu8(f+1));e=k.getPaintValue("fill-translate",d);d=k.getPaintValue("fill-translate-anchor",d);this._drawFill(a,f,k,b,e,d,l,r,x);this._drawOutline(a,f,k,b,e,d,l,x,p)}};b.prototype._drawFill=function(a,b,e,f,h,k,l,m,n){var p=a.context,u=a.displayLevel,q=a.drawPhase,r=a.renderPass,v=a.spriteMosaic,y=a.state;
if(m||"translucent"!==r){m=void 0!==l;var r=a.pixelRatio>g.VTL_HIGH_RES_CUTOFF?2:1,x=e.hasDataDrivenFill;a=a.painter.getVectorTileProgramCach();var z,A=q===c.WGLDrawPhase.HITTEST,q=this._fillProgramOptions;q.id=A;q.dd=x;q.pattern=m;q=a.getProgram(1,(A?1:0)<<2|(x?1:0)<<1|(m?1:0),q);p.bindProgram(q);if(m){z=v.getMosaicItemPosition(l,!0);if(!z){p.bindProgram();return}q.setUniform2f("u_pattern_tl",z.tl[0],z.tl[1]);q.setUniform2f("u_pattern_br",z.br[0],z.br[1]);q.setUniform1i("u_texture",g.VTL_TEXTURE_BINDING_UNIT_SPRITES);
v.bind(p,9729,z.page,g.VTL_TEXTURE_BINDING_UNIT_SPRITES)}q.setUniformMatrix3fv("u_displayMat3",1===k?y.displayMat3:y.displayViewMat3);q.setUniform2fv("u_fillTranslation",h);q.setUniform1f("u_depth",e.z+d);q.setUniform4fv("u_color",this._color);A&&q.setUniform4fv("u_id",n);for(e=0;e<f.length;e++)if(h=f[e],h.layerData[b]&&(l=this._getFillVAO(p,h,x,a)))k=h.layerData[b],p.bindVAO(l),q.setUniformMatrix3fv("u_dvsMat3",h.transforms.dvs),m&&(l=h.coordRange[0]/(r*h.size[0]*Math.max(Math.pow(2,Math.round(u)-
h.key.level),1)),n=1/(z.size[1]*l),this._patternMatrix[0]=1/(z.size[0]*l),this._patternMatrix[4]=n,q.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),p.setStencilFunction(514,h.stencilRef,255),p.drawElements(4,k.triangleElementCount,5125,12*k.triangleElementStart),h.triangleCount+=k.triangleElementCount/3}};b.prototype._drawOutline=function(a,b,e,g,f,h,k,l,m){var p=a.context,u=a.displayLevel,q=a.drawPhase,r=a.pixelRatio,v=a.state;if("opaque"!==a.renderPass&&(k=void 0!==k,e.getPaintValue("fill-antialias",
u)&&!k||e.hasDataDrivenOutlineColor)){a=a.painter.getVectorTileProgramCach();k=e.hasDataDrivenOutline;if(e.outlineUsesFillColor){if(1!==this._color[3])return;this._outlineColor[0]=this._color[0];this._outlineColor[1]=this._color[1];this._outlineColor[2]=this._color[2];this._outlineColor[3]=this._color[3]}else u=e.hasDataDrivenOutlineColor?n:e.getPaintValue("fill-outline-color",u),m*=u[3],this._outlineColor[0]=m*u[0],this._outlineColor[1]=m*u[1],this._outlineColor[2]=m*u[2],this._outlineColor[3]=m;
r=.75/r;m=q===c.WGLDrawPhase.HITTEST;q=this._outlineProgramOptions;q.id=m;q.dd=k;q=a.getProgram(2,(m?1:0)<<1|(k?1:0),q);p.bindProgram(q);q.setUniformMatrix3fv("u_displayMat3",1===h?v.displayMat3:v.displayViewMat3);q.setUniform2fv("u_fillTranslation",f);q.setUniform1f("u_depth",e.z+d);q.setUniform1f("u_outline_width",r);q.setUniform4fv("u_color",this._outlineColor);m&&q.setUniform4fv("u_id",l);for(e=0;e<g.length;e++)if(f=g[e],f.layerData[b]&&(h=f.layerData[b],l=this._getOutlineVAO(p,f,k,a)))p.bindVAO(l),
q.setUniformMatrix3fv("u_dvsMat3",f.transforms.dvs),p.setStencilFunction(514,f.stencilRef,255),p.drawElements(4,h.outlineElementCount,5125,12*h.outlineElementStart),f.triangleCount+=h.outlineElementCount/3}};b.prototype._getFillVAO=function(a,b,d,c){if(d){if(b.fillDDVertexArrayObject)return b.fillDDVertexArrayObject;d=b.fillDDVertexBuffer;var e=b.fillIndexBuffer;if(!d||!e)return null;b.fillDDVertexArrayObject=new l.VertexArrayObject(a,c.getProgramAttributes(1),this._fillVertexAttributesDD,{geometry:d},
e);return b.fillDDVertexArrayObject}if(b.fillVertexArrayObject)return b.fillVertexArrayObject;d=b.fillVertexBuffer;e=b.fillIndexBuffer;if(!d||!e)return null;b.fillVertexArrayObject=new l.VertexArrayObject(a,c.getProgramAttributes(1),this._fillVertexAttributes,{geometry:d},e);return b.fillVertexArrayObject};b.prototype._getOutlineVAO=function(a,b,d,c){if(d){if(b.outlineDDVertexArrayObject)return b.outlineDDVertexArrayObject;d=b.outlineDDVertexBuffer;var e=b.outlineIndexBuffer;if(!d||!e)return null;
b.outlineDDVertexArrayObject=new l.VertexArrayObject(a,c.getProgramAttributes(2),this._outlineVertexAttributesDD,{geometry:d},e);return b.outlineDDVertexArrayObject}if(b.outlineVertexArrayObject)return b.outlineVertexArrayObject;d=b.outlineVertexBuffer;e=b.outlineIndexBuffer;if(!d||!e)return null;b.outlineVertexArrayObject=new l.VertexArrayObject(a,c.getProgramAttributes(2),this._outlineVertexAttributes,{geometry:d},e);return b.outlineVertexArrayObject};return b}(b.default);a.WGLBrushVTLFill=f})},
"esri/views/2d/engine/webgl/brushes/WGLBrushVTLLine":function(){define("require exports tslib ../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../number ./WGLBrush".split(" "),function(f,a,e,m,k,l,g,c,h,b){Object.defineProperty(a,"__esModule",{value:!0});a.C_DEG_TO_RAD=Math.PI/180;var d=[1,1,1,1];f=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._color=k.vec4f32.create();b._dashArray=m.vec2f32.create();
b._programOptions={id:!1,dd:!1,pattern:!1};b._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5123,offset:8,stride:12,normalized:!1,divisor:0}]};b._vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:20,normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:20,
normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5122,offset:8,stride:20,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:20,normalized:!0,divisor:0},{name:"a_width",count:1,type:5126,offset:16,stride:20,normalized:!1,divisor:0}]};return b}e.__extends(b,a);b.prototype.dispose=function(){};b.prototype.drawMany=function(a,b){var e=a.context,f=a.displayLevel,k=a.state,l=a.drawPhase,m=a.styleLayerId,n=a.styleLayer,p=a.painter.getVectorTileProgramCach(),q=
n.getPaintValue("line-translate",f),r=n.getPaintValue("line-translate-anchor",f),E=n.getPaintValue("line-pattern",f),F=void 0!==E,I=1/a.pixelRatio,J=n.getPaintValue("line-blur",f),G=n.hasDataDrivenColor?d:n.getPaintValue("line-color",f),H=n.hasDataDrivenOpacity?1:n.getPaintValue("line-opacity",f),K=n.hasDataDrivenWidth?1:n.getPaintValue("line-width",f),H=H*G[3];this._color[0]=H*G[0];this._color[1]=H*G[1];this._color[2]=H*G[2];this._color[3]=H;var G=n.hasDataDrivenLine,H=l===c.WGLDrawPhase.HITTEST,
O;H&&(O=h.u32to4Xu8(m+1));l=this._programOptions;l.id=H;l.dd=G;l.pattern=F;l=p.getProgram(3,(H?1:0)<<2|(G?1:0)<<1|(F?1:0),l);e.bindProgram(l);l.setUniformMatrix3fv("u_displayViewMat3",k.displayViewMat3);l.setUniformMatrix3fv("u_displayMat3",1===r?k.displayMat3:k.displayViewMat3);l.setUniform2fv("u_lineTranslation",q);l.setUniform1f("u_depth",n.z);l.setUniform1f("u_blur",J);l.setUniform1f("u_antialiasing",I);l.setUniform4fv("u_color",this._color);l.setUniform1f("u_width",K);H&&l.setUniform4fv("u_id",
O);if(F){if(a=a.spriteMosaic,E=a.getMosaicItemPosition(E,!0))a.bind(e,9729,E.page,g.VTL_TEXTURE_BINDING_UNIT_SPRITES),l.setUniform2f("u_pattern_tl",E.tl[0],E.br[1]),l.setUniform2f("u_pattern_br",E.br[0],E.tl[1]),l.setUniform2f("u_spriteSize",8*E.size[0],E.size[1]),l.setUniform1i("u_texture",g.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else E=n.getPaintValue("line-dasharray",f),2>E.length&&(E=[1,-1]),this._dashArray[0]=8*E[0],this._dashArray[1]=8*E[1],l.setUniform2fv("u_dasharray",this._dashArray);for(E=0;E<
b.length;E++)if(a=b[E],a.layerData[m]&&(f=a.layerData[m],k=this._getLineVAO(e,a,G,p)))e.bindVAO(k),l.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs),e.setStencilFunction(514,a.stencilRef,255),e.drawElements(4,f.triangleElementCount,5125,12*f.triangleElementStart),a.triangleCount+=f.triangleElementCount/3};b.prototype._getLineVAO=function(a,b,d,c){if(d){if(b.lineDDVertexArrayObject)return b.lineDDVertexArrayObject;d=b.lineDDVertexBuffer;var e=b.lineIndexBuffer;if(!d||!e)return null;b.lineDDVertexArrayObject=
new l.VertexArrayObject(a,c.getProgramAttributes(3),this._vertexAttributesDD,{geometry:d},e);return b.lineDDVertexArrayObject}if(b.lineVertexArrayObject)return b.lineVertexArrayObject;d=b.lineVertexBuffer;e=b.lineIndexBuffer;if(!d||!e)return null;b.lineVertexArrayObject=new l.VertexArrayObject(a,c.getProgramAttributes(3),this._vertexAttributes,{geometry:d},e);return b.lineVertexArrayObject};return b}(b.default);a.WGLBrushVTLLine=f})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLSymbol":function(){define("require exports tslib ../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../GeometryUtils ../number ./WGLBrush".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d){Object.defineProperty(a,"__esModule",{value:!0});var n=1/65536,p=[1,1,1,1];f=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:20,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:20,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:20,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:20,
normalized:!1,divisor:0},{name:"a_visInfo",count:4,type:5121,offset:16,stride:20,normalized:!1,divisor:0}]};b._vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:28,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:28,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:28,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:28,normalized:!1,divisor:0},{name:"a_visInfo",count:4,type:5121,offset:16,
stride:28,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:20,stride:28,normalized:!0,divisor:0},{name:"a_size",count:1,type:5126,offset:24,stride:28,normalized:!1,divisor:0}]};b._iconProgramOptions={id:!1,dd:!1,sdf:!1};b._sdfProgramOptions={id:!1,dd:!1};b._spritesTextureSize=m.vec2f32.create();b._haloColor=k.vec4f32.create();b._sdfColor=k.vec4f32.create();b._color=k.vec4f32.create();return b}e.__extends(d,a);d.prototype.dispose=function(){};d.prototype.drawMany=function(a,d){var e=
a.drawPhase,g=a.styleLayerId,f=a.styleLayer,h=a.fadeRecorder.getFadeValues(),k;e===c.WGLDrawPhase.HITTEST&&(k=b.u32to4Xu8(g+1));this._drawIcons(a,f,d,h,k);this._drawText(a,f,d,h,k)};d.prototype._drawIcons=function(a,b,d,e,f){for(var k=this,l=a.context,m=a.displayLevel,n=a.drawPhase,q=a.painter,u=a.state,r=a.styleLayerId,v,y=!1,x=0;x<d.length;x++){var z=d[x];if(z.layerData[r]&&(v=z.layerData[r],0<v.iconPerPageElementsMap.size)){y=!0;break}}if(y){var z=b.hasDataDrivenIconSize?1:b.getLayoutValue("icon-size",
m),O=b.hasDataDrivenIconColor?p:b.getPaintValue("icon-color",m),L=b.hasDataDrivenIconOpacity?1:b.getPaintValue("icon-opacity",m),y=b.getPaintValue("icon-translate",m),x=b.getPaintValue("icon-translate-anchor",m),N=q.getVectorTileProgramCach(),q=O[3]*L;this._color[0]=q*O[0];this._color[1]=q*O[1];this._color[2]=q*O[2];this._color[3]=q;q=b.getLayoutValue("icon-rotation-alignment",m);2===q&&(q=1===b.getLayoutValue("symbol-placement",m)?0:1);var O=v.isSDF,T=b.hasDataDrivenIcon,n=n===c.WGLDrawPhase.HITTEST,
L=this._iconProgramOptions;L.id=n;L.dd=T;L.sdf=O;var R=N.getProgram(4,(n?1:0)<<2|(T?1:0)<<1|(O?1:0),L);l.bindProgram(R);O&&(O=b.getPaintValue("icon-halo-color",m),L=b.getPaintValue("icon-halo-width",m),R.setUniform4f("u_outlineColor",O[0],O[1],O[2],O[3]),R.setUniform1f("u_outlineSize",L));R.setUniformMatrix3fv("u_displayViewMat3",0===q?u.displayViewMat3:u.displayMat3);R.setUniformMatrix3fv("u_displayMat3",1===x?u.displayMat3:u.displayViewMat3);R.setUniform2fv("u_iconTranslation",y);R.setUniform1f("u_depth",
b.z);R.setUniform1f("u_mapRotation",h.degToByte(u.rotation));R.setUniform1f("u_keepUpright",0);R.setUniform1f("u_level",10*m);R.setUniform1f("u_fadeSpeed",10*e.fadeSpeed);R.setUniform1f("u_minfadeLevel",10*e.minfadeLevel);R.setUniform1f("u_maxfadeLevel",10*e.maxfadeLevel);R.setUniform1f("u_fadeChange",10*(m+e.fadeChange));R.setUniform1i("u_texture",g.VTL_TEXTURE_BINDING_UNIT_SPRITES);R.setUniform1f("u_size",z);R.setUniform4fv("u_color",this._color);n&&R.setUniform4fv("u_id",f);b=function(b){if(!b.layerData[r])return"continue";
v=b.layerData[r];if(0===v.iconPerPageElementsMap.size)return"continue";var d=Q._getIconVAO(l,b,T,N);if(!d)return"continue";l.bindVAO(d);R.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs);v.iconPerPageElementsMap.forEach(function(d,c){k._renderIconRange(a,R,d,c,b)})};var Q=this;for(e=0;e<d.length;e++)z=d[e],b(z)}};d.prototype._renderIconRange=function(a,b,d,c,e){var f=a.context,h=a.hasClipping,k=a.requiredLevel;a=a.spriteMosaic;this._spritesTextureSize[0]=a.getWidth(c)/4;this._spritesTextureSize[1]=
a.getHeight(c)/4;b.setUniform2fv("u_mosaicSize",this._spritesTextureSize);a.bind(f,9729,c,g.VTL_TEXTURE_BINDING_UNIT_SPRITES);b=!0;k!==e.key.level||h?f.setStencilFunction(514,e.stencilRef,255):b=!1;f.setStencilTestEnabled(b);f.drawElements(4,d[1],5125,12*d[0]);e.triangleCount+=d[1]/3};d.prototype._drawText=function(a,b,d,e,f){for(var k=this,l=a.context,q=a.displayLevel,u=a.drawPhase,r=a.glyphMosaic,v=a.hasClipping,y=a.painter,x=a.pixelRatio,z=a.requiredLevel,H=a.state,K=a.styleLayerId,O,L=!1,N=0;N<
d.length;N++)if(a=d[N],a.layerData[K]&&(O=a.layerData[K],0<O.glyphPerPageElementsMap.size)){L=!0;break}if(L){a=b.getLayoutValue("text-rotation-alignment",q);2===a&&(a=1===b.getLayoutValue("symbol-placement",q)?0:1);var L=0===a,L=b.getLayoutValue("text-keep-upright",q)&&L,u=u===c.WGLDrawPhase.HITTEST,x=.8*3/x,N=b.hasDataDrivenTextSize?1:b.getLayoutValue("text-size",q),T=b.hasDataDrivenTextColor?p:b.getPaintValue("text-color",q),R=b.hasDataDrivenTextOpacity?1:b.getPaintValue("text-opacity",q),Q=b.getPaintValue("text-halo-color",
q),S=b.getPaintValue("text-halo-width",q),U=3*b.getPaintValue("text-halo-blur",q),X=3*S,V=y.getVectorTileProgramCach(),y=T[3]*R;this._sdfColor[0]=y*T[0];this._sdfColor[1]=y*T[1];this._sdfColor[2]=y*T[2];this._sdfColor[3]=y;y=Q[3]*R;this._haloColor[0]=y*Q[0];this._haloColor[1]=y*Q[1];this._haloColor[2]=y*Q[2];this._haloColor[3]=y;this._glyphTextureSize||(this._glyphTextureSize=m.vec2f32.fromValues(r.width/4,r.height/4));var y=b.getPaintValue("text-translate",q),T=b.getPaintValue("text-translate-anchor",
q),ca=b.hasDataDrivenText,R=this._sdfProgramOptions;R.id=u;R.dd=ca;var Y=V.getProgram(6,(u?1:0)<<1|(ca?1:0),R);l.bindProgram(Y);Y.setUniformMatrix3fv("u_displayViewMat3",0===a?H.displayViewMat3:H.displayMat3);Y.setUniformMatrix3fv("u_displayMat3",1===T?H.displayMat3:H.displayViewMat3);Y.setUniform2fv("u_textTranslation",y);Y.setUniform1f("u_depth",b.z+n);Y.setUniform2fv("u_mosaicSize",this._glyphTextureSize);Y.setUniform1f("u_mapRotation",h.degToByte(H.rotation));Y.setUniform1f("u_keepUpright",L?
1:0);Y.setUniform1f("u_level",10*q);Y.setUniform1f("u_fadeSpeed",10*e.fadeSpeed);Y.setUniform1f("u_minfadeLevel",10*e.minfadeLevel);Y.setUniform1f("u_maxfadeLevel",10*e.maxfadeLevel);Y.setUniform1f("u_fadeChange",10*(q+e.fadeChange));Y.setUniform1i("u_texture",g.VTL_TEXTURE_BINDING_UNIT_GLYPHS);Y.setUniform1f("u_size",N);Y.setUniform1f("u_antialiasingWidth",x);u&&Y.setUniform4fv("u_id",f);b=function(a){if(!a.layerData[K])return"continue";O=a.layerData[K];if(0===O.glyphPerPageElementsMap.size)return"continue";
var b=aa._getSDFVAO(l,a,ca,V);if(!b)return"continue";l.bindVAO(b);Y.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs);b=!0;z!==a.key.level||v?l.setStencilFunction(514,a.stencilRef,255):b=!1;l.setStencilTestEnabled(b);O.glyphPerPageElementsMap.forEach(function(b,d){k._renderGlyphRange(l,b,d,r,Y,Q[3],S,U,X,a)})};var aa=this;for(e=0;e<d.length;e++)a=d[e],b(a)}};d.prototype._renderGlyphRange=function(a,b,d,c,e,f,h,k,l,m){c.bind(a,9729,d,g.VTL_TEXTURE_BINDING_UNIT_GLYPHS);0<f&&0<h&&(e.setUniform4fv("u_color",
this._haloColor),e.setUniform1f("u_halo",1),e.setUniform1f("u_edgeDistance",l),e.setUniform1f("u_edgeBlur",k),a.drawElements(4,b[1],5125,12*b[0]),m.triangleCount+=b[1]/3);0<this._sdfColor[3]&&(e.setUniform4fv("u_color",this._sdfColor),e.setUniform1f("u_halo",0),e.setUniform1f("u_edgeDistance",0),e.setUniform1f("u_edgeBlur",0),a.drawElements(4,b[1],5125,12*b[0]),m.triangleCount+=b[1]/3)};d.prototype._getIconVAO=function(a,b,d,c){if(d){if(b.iconDDVertexArrayObject)return b.iconDDVertexArrayObject;d=
b.iconDDVertexBuffer;var e=b.iconIndexBuffer;if(!d||!e)return null;b.iconDDVertexArrayObject=new l.VertexArrayObject(a,c.getProgramAttributes(4),this._vertexAttributesDD,{geometry:d},e);return b.iconDDVertexArrayObject}if(b.iconVertexArrayObject)return b.iconVertexArrayObject;d=b.iconVertexBuffer;e=b.iconIndexBuffer;if(!d||!e)return null;b.iconVertexArrayObject=new l.VertexArrayObject(a,c.getProgramAttributes(4),this._vertexAttributes,{geometry:d},e);return b.iconVertexArrayObject};d.prototype._getSDFVAO=
function(a,b,d,c){if(d){if(b.textDDVertexArrayObject)return b.textDDVertexArrayObject;d=b.textDDVertexBuffer;var e=b.textIndexBuffer;if(!d||!e)return null;b.textDDVertexArrayObject=new l.VertexArrayObject(a,c.getProgramAttributes(6),this._vertexAttributesDD,{geometry:d},e);return b.textDDVertexArrayObject}if(b.textVertexArrayObject)return b.textVertexArrayObject;d=b.textVertexBuffer;e=b.textIndexBuffer;if(!d||!e)return null;b.textVertexArrayObject=new l.VertexArrayObject(a,c.getProgramAttributes(6),
this._vertexAttributes,{geometry:d},e);return b.textVertexArrayObject};return d}(d.default);a.WGLBrushVTLSymbol=f})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrush":function(){define("require exports tslib ../../../../webgl ../definitions ./WGLBrush".split(" "),function(f,a,e,m,k,l){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}e.__extends(c,a);c.prototype.prepareState=function(a,b,d){a=a.context;d=d&&-1!==d.indexOf("id");
a.setBlendingEnabled(!d);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,b.stencilRef,255)};c.prototype.draw=function(a,b,d){var c=this;if(b.isReady&&b.hasData){b.commitChanges();var e=this.getGeometryType(),g=b.getDisplayList(),f=b.getGeometry(e);f&&g&&(a.timeline.begin(this.name),g.byType(e,function(e){c.drawGeometry(a,b,e,f,d)}),a.timeline.end(this.name))}};c.prototype._getVAO=function(a,b,d,c){c.vao||
(c.vao=new m.VertexArrayObject(a,d,b,c.vertexBufferMap,c.indexBuffer));return c.vao};c.prototype._setSharedUniforms=function(a,b,d){a.setUniform1f("u_pixelRatio",b.pixelRatio);a.setUniformMatrix3fv("u_dvsMat3",d.transforms.dvs);a.setUniformMatrix3fv("u_displayViewMat3",b.state.displayViewMat3);a.setUniformMatrix4fv("u_insideEffectMat4",b.rendererInfo.insideEffect);a.setUniformMatrix4fv("u_outsideEffectMat4",b.rendererInfo.outsideEffect);a.setUniform1fv("u_insideOpacities",b.rendererInfo.insideOpacities);
a.setUniform1fv("u_outsideOpacities",b.rendererInfo.outsideOpacities);a.setUniform1i("u_attributeTextureSize",b.attributeView.size);a.setUniform1i("u_attributeData0",k.TEXTURE_BINDING_ATTRIBUTE_DATA_0);a.setUniform1i("u_attributeData1",k.TEXTURE_BINDING_ATTRIBUTE_DATA_1);a.setUniform1i("u_attributeData2",k.TEXTURE_BINDING_ATTRIBUTE_DATA_2);a.setUniform1i("u_attributeData3",k.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};return c}(l.default);a.default=f})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":function(){define("require exports tslib ../../../../../core/RandomLCG ../../../../webgl ../definitions ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),
function(f,a,e,m,k,l,g,c,h,b){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b._dotTextureSize=0;b._dotTextures=null;b._dotSamplers=new Int32Array([l.TEXTURE_BINDING_RENDERER_0,l.TEXTURE_BINDING_RENDERER_1]);return b}e.__extends(d,a);d.prototype.dispose=function(){this._disposeTextures()};d.prototype.getGeometryType=function(){return g.WGLGeometryType.FILL};d.prototype.drawGeometry=function(a,d,g,f,h){var k=a.context,m=a.painter,
n=a.rendererInfo,p=a.requiredLevel,q=g.indexCount,u=g.indexFrom;g=b.FillMaterialKey.load(g.materialKey);var r=c.createProgramDescriptor(g.data,{geometry:e.__spreadArrays([{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121}],g.dotDensity?[]:[{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_tlbr",count:4,type:5123},{location:4,name:"a_aux1",count:4,type:5121},{location:5,name:"a_aux2",count:2,type:5123},{location:6,name:"a_aux3",count:4,
type:5121}],g.dotDensity?[{location:2,name:"a_inverseArea",count:1,type:5126}]:[])}),x=r.bufferLayouts,r=r.attributes;h=m.materialManager.getMaterialProgram(a,g,"materials/fill",r,h);f=this._getVAO(k,x,r,f);k.bindProgram(h);k.bindVAO(f);this._setSharedUniforms(h,a,d);g.textureBinding&&(m.textureManager.bindTextures(k,h,g),m=1/Math.pow(2,p-d.key.level)/a.pixelRatio,h.setUniform1f("u_zoomFactor",m));g.vvColor&&(h.setUniform1fv("u_vvColorValues",n.vvColorValues),h.setUniform4fv("u_vvColors",n.vvColors));
g.vvOpacity&&(h.setUniform1fv("u_vvOpacityValues",n.vvOpacityValues),h.setUniform1fv("u_vvOpacities",n.vvOpacities));g.dotDensity&&(g=l.TILE_SIZE/n.ddDotSize,f=g*window.devicePixelRatio*g*window.devicePixelRatio,m=1/Math.pow(2,p-d.key.level),d=1/m*(1/m),a=n.ddDotScale?a.state.scale/n.ddDotScale:1,h.setUniform1f("u_tileZoomFactor",m),h.setUniform1f("u_tileDotsOverArea",f/(l.TILE_SIZE*window.devicePixelRatio*l.TILE_SIZE*window.devicePixelRatio)),h.setUniformMatrix4fv("u_dotColors",n.ddColors),h.setUniform4fv("u_isActive",
n.ddActiveDots),h.setUniform4fv("u_dotBackgroundColor",n.ddBackgroundColor),h.setUniform1f("u_dotValue",Math.max(1,n.ddDotValue*a*d)),this._bindDotDensityTextures(k,h,n,g));k.drawElements(4,q,5125,4*u);k.bindVAO(null)};d.prototype._disposeTextures=function(){if(this._dotTextures){for(var a=0;a<this._dotTextures.length;a++)this._dotTextures[a].dispose();this._dotTextures=null}};d.prototype._bindDotDensityTextures=function(a,b,d,c){d=this._createDotDensityTextures(a,c,d.ddSeed);b.setUniform1iv("u_dotTextures",
this._dotSamplers);for(b=0;b<d.length;b++)a.bindTexture(d[b],this._dotSamplers[b])};d.prototype._createDotDensityTextures=function(a,b,d){if(this._dotTextureSize!==b||this._seed!==d)this._disposeTextures(),this._dotTextureSize=b,this._seed=d;null===this._dotTextures&&(d=new m(d),this._dotTextures=[this._allocDotDensityTexture(a,b,d),this._allocDotDensityTexture(a,b,d)]);return this._dotTextures};d.prototype._allocDotDensityTexture=function(a,b,d){for(var c=new Float32Array(b*b*4),e=0;e<c.length;e++)c[e]=
d.getFloat();return new k.Texture(a,{wrapMode:10497,pixelFormat:6408,dataType:5126,samplingMode:9728,width:b,height:b},c)};return d}(h.default);a.default=f})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define("require exports tslib ../../../../../renderers ../../../../../core/Error ../../../../../core/maybe ../enums ../mesh/templates/WGLLabelTemplate ../util/vvFlagUtils".split(" "),function(f,a,e,m,k,l,g,c,h){Object.defineProperty(a,"__esModule",{value:!0});a.createMaterialKey=
function(a,b,d,c){if(l.isSome(b)){a:{if("heatmap"===b.type)throw Error("Symbol processor does not support heatmap renderer");switch(a){case g.WGLGeometryType.FILL:a=r.from(b);break a;case g.WGLGeometryType.LINE:a=x.from(b,d);break a;case g.WGLGeometryType.MARKER:if("dot-density"===b.type)throw Error("Dot Density renderer does not support Marker GeometryTypes");a=q.from(b);break a;case g.WGLGeometryType.TEXT:a=u.from(b);break a;case g.WGLGeometryType.LABEL:a=v.from(b,c);break a;default:throw Error("Unable to createMaterialKey for unknown geometryType "+
a);}}return a}switch(a){case g.WGLGeometryType.FILL:return r.from(null);case g.WGLGeometryType.LINE:return x.from(null,d);case g.WGLGeometryType.MARKER:return q.from(null);case g.WGLGeometryType.TEXT:return u.from(null);case g.WGLGeometryType.LABEL:return v.from(null,c);default:throw Error("Unable to createMaterialKey for unknown geometryType "+a);}};f=function(){function a(a){this._data=0;this._data=a}a.load=function(a){var b=this.shared;b.data=a;return b};Object.defineProperty(a.prototype,"data",
{get:function(){return this._data},set:function(a){this._data=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"geometryType",{get:function(){return this.bits(8,11)},set:function(a){this.setBits(a,8,11)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"mapAligned",{get:function(){return!!this.bit(20)},set:function(a){this.setBit(20,a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sdf",{get:function(){return!!this.bit(11)},set:function(a){this.setBit(11,
a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"pattern",{get:function(){return!!this.bit(12)},set:function(a){this.setBit(12,a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"textureBinding",{get:function(){return this.bits(0,8)},set:function(a){this.setBits(a,0,8)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"geometryTypeString",{get:function(){switch(this.geometryType){case g.WGLGeometryType.FILL:return"fill";case g.WGLGeometryType.MARKER:return"marker";
case g.WGLGeometryType.LINE:return"line";case g.WGLGeometryType.TEXT:return"text";case g.WGLGeometryType.LABEL:return"label";default:throw new k("Unable to handle unknown geometryType: "+this.geometryType);}},enumerable:!0,configurable:!0});a.prototype.setBit=function(a,b){a=1<<a;this._data=b?this._data|a:this._data&~a};a.prototype.bit=function(a){return(this._data&1<<a)>>a};a.prototype.setBits=function(a,b,d){for(var c=0;b<d;b++,c++)this.setBit(b,0!==(a&1<<c))};a.prototype.bits=function(a,b){for(var d=
0,c=0;a<b;a++,c++)d|=this.bit(a)<<c;return d};a.prototype.hasVV=function(){return!1};a.prototype.setVV=function(a,b){};a.prototype.getVariation=function(){var a={},b;for(b in this)"boolean"===typeof this[b]&&(a[b]=this[b]);return a};a.prototype.getVariationHash=function(){return this._data&~(7&this.textureBinding)};a.shared=new a(0);return a}();a.MaterialKeyBase=f;var b=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e.__extends(b,a);Object.defineProperty(b.prototype,
"vvSizeMinMaxValue",{get:function(){return 0!==this.bit(16)},set:function(a){this.setBit(16,a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"vvSizeScaleStops",{get:function(){return 0!==this.bit(17)},set:function(a){this.setBit(17,a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"vvSizeFieldStops",{get:function(){return 0!==this.bit(18)},set:function(a){this.setBit(18,a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"vvSizeUnitValue",
{get:function(){return 0!==this.bit(19)},set:function(a){this.setBit(19,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue};b.prototype.setVV=function(b,d){a.prototype.setVV.call(this,b,d);b&=h.getSizeFlagsMask(b,d);this.vvSizeMinMaxValue=!!(b&g.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(b&g.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(b&g.WGLVVFlag.SIZE_UNIT_VALUE);
this.vvSizeScaleStops=!!(b&g.WGLVVFlag.SIZE_SCALE_STOPS)};return b}(a)},d=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e.__extends(b,a);Object.defineProperty(b.prototype,"vvRotation",{get:function(){return 0!==this.bit(15)},set:function(a){this.setBit(15,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvRotation};b.prototype.setVV=function(b,d){a.prototype.setVV.call(this,b,d);this.vvRotation=
!d&&!!(b&g.WGLVVFlag.ROTATION)};return b}(a)},n=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e.__extends(b,a);Object.defineProperty(b.prototype,"vvColor",{get:function(){return 0!==this.bit(13)},set:function(a){this.setBit(13,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvColor};b.prototype.setVV=function(b,d){a.prototype.setVV.call(this,b,d);this.vvColor=!d&&!!(b&g.WGLVVFlag.COLOR)};return b}(a)},
p=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e.__extends(b,a);Object.defineProperty(b.prototype,"vvOpacity",{get:function(){return 0!==this.bit(14)},set:function(a){this.setBit(14,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvOpacity};b.prototype.setVV=function(b,d){a.prototype.setVV.call(this,b,d);this.vvOpacity=!d&&!!(b&g.WGLVVFlag.OPACITY)};return b}(a)},r=function(a){function b(){return null!==
a&&a.apply(this,arguments)||this}e.__extends(b,a);b.load=function(a){var b=this.shared;b.data=a;return b};b.from=function(a){var b=this.load(0);b.geometryType=g.WGLGeometryType.FILL;l.isSome(a)&&(a instanceof m.DotDensityRenderer?b.dotDensity=!0:(a=h.getVVFlags(a.visualVariables),b.setVV(a,!1)));return b.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};Object.defineProperty(b.prototype,"dotDensity",{get:function(){return!!this.bit(15)},set:function(a){this.setBit(15,
a)},enumerable:!0,configurable:!0});b.shared=new b(0);return b}(n(p(f)));a.FillMaterialKey=r;var q=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e.__extends(b,a);b.load=function(a){var b=this.shared;b.data=a;return b};b.from=function(a){var b=this.load(0);b.geometryType=g.WGLGeometryType.MARKER;l.isSome(a)&&(a=h.getVVFlags(a.visualVariables),b.setVV(a,!1));return b.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};b.shared=new b(0);return b}(n(p(d(b(f)))));
a.MarkerMaterialKey=q;var x=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e.__extends(b,a);b.load=function(a){var b=this.shared;b.data=a;return b};b.from=function(a,b){var d=this.load(0);d.geometryType=g.WGLGeometryType.LINE;l.isSome(a)&&(a=h.getVVFlags(a.visualVariables),d.setVV(a,b));return d.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};b.shared=new b(0);return b}(n(p(b(f))));a.LineMaterialKey=x;var u=function(a){function b(){return null!==
a&&a.apply(this,arguments)||this}e.__extends(b,a);b.load=function(a){var b=this.shared;b.data=a;return b};b.from=function(a){var b=this.load(0);b.geometryType=g.WGLGeometryType.TEXT;l.isSome(a)&&(a=h.getVVFlags(a.visualVariables),b.setVV(a,!1));return b.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};b.shared=new b(0);return b}(n(p(d(b(f)))));a.TextMaterialKey=u;var v=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e.__extends(b,a);b.load=
function(a){var b=this.shared;b.data=a;return b};b.from=function(a,b){var d=this.load(0);d.geometryType=g.WGLGeometryType.LABEL;l.isSome(a)&&(a=h.getVVFlags(a.visualVariables),d.setVV(a,!1));d.mapAligned=!!c.isMapAligned(b.labelPlacement);return d.data};b.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};b.shared=new b(0);return b}(b(f));a.LabelMaterialKey=v})},"esri/renderers":function(){define("require exports ./renderers/ClassBreaksRenderer ./renderers/DictionaryRenderer ./renderers/DotDensityRenderer ./renderers/HeatmapRenderer ./renderers/Renderer ./renderers/SimpleRenderer ./renderers/UniqueValueRenderer ./renderers/support/jsonUtils".split(" "),
function(f,a,e,m,k,l,g,c,h,b){Object.defineProperty(a,"__esModule",{value:!0});a.ClassBreaksRenderer=e;a.DictionaryRenderer=m;a.DotDensityRenderer=k;a.HeatmapRenderer=l;a.BaseRenderer=g;a.SimpleRenderer=c;a.UniqueValueRenderer=h;a.isRenderer=function(a){return a instanceof g};a.read=b.read;a.write=b.write;a.fromJSON=b.fromJSON;a.rendererTypes={key:"type",base:g,typeMap:{heatmap:l,simple:c,"unique-value":h,"class-breaks":e,"dot-density":k,dictionary:m}};a.webSceneRendererTypes={key:"type",base:g,typeMap:{simple:c,
"unique-value":h,"class-breaks":e}}})},"esri/renderers/ClassBreaksRenderer":function(){define("require exports tslib ../symbols ../symbols ../core/jsonMap ../core/lang ../core/Logger ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ../layers/support/fieldUtils ./Renderer ./mixins/VisualVariablesMixin ./support/ClassBreakInfo ./support/LegendOptions ../support/arcadeOnDemand ../symbols/support/jsonUtils".split(" "),function(f,a,e,m,k,l,g,c,h,
b,d,n,p,r,q,x,u,v,y){var z=c.getLogger("esri.renderers.ClassBreaksRenderer"),A=new l.default({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"}),B=n.ensureType(x);return function(a){function c(b){b=a.call(this,b)||this;b.backgroundFillSymbol=null;b.classBreakInfos=null;b.defaultLabel=null;b.defaultSymbol=null;b.field=null;b.isMaxInclusive=!0;b.legendOptions=null;b.normalizationField=null;b.normalizationTotal=null;b.type="class-breaks";b.valueExpression=
null;b.valueExpressionTitle=null;b._set("classBreakInfos",[]);return b}e.__extends(c,a);f=c;Object.defineProperty(c.prototype,"_cache",{get:function(){return{compiledFunc:null}},enumerable:!0,configurable:!0});c.prototype.readClassBreakInfos=function(a,b,d){if(Array.isArray(a)){var c=b.minValue;return a.map(function(a){var b=new x;b.read(a,d);null==b.minValue&&(b.minValue=c);null==b.maxValue&&(b.maxValue=b.minValue);c=b.maxValue;return b})}};c.prototype.writeClassBreakInfos=function(a,b,d,c){a=a.map(function(a){return a.write({},
c)});this._areClassBreaksConsecutive()&&a.forEach(function(a){return delete a.classMinValue});b[d]=a};c.prototype.readDefaultSymbol=function(a,b,d){return y.read(a,b,d)};c.prototype.writeDefaultSymbolWebScene=function(a,b,d,c){y.writeTarget(a,b,d,c)};c.prototype.writeDefaultSymbol=function(a,b,d,c){y.writeTarget(a,b,d,c)};c.prototype.castField=function(a){return null==a?a:"function"===typeof a?(z.error(".field: field must be a string value"),null):n.ensureString(a)};Object.defineProperty(c.prototype,
"minValue",{get:function(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"normalizationType",{get:function(){var a=this._get("normalizationType"),b=!!this.normalizationField,d=null!=this.normalizationTotal;if(b||d)a=b&&"field"||d&&"percent-of-total"||null,b&&d&&z.warn("warning: both normalizationField and normalizationTotal are set!");else if("field"===a||"percent-of-total"===a)a=null;return a},
set:function(a){this._set("normalizationType",a)},enumerable:!0,configurable:!0});c.prototype.addClassBreakInfo=function(a,b,d){var c=null,c="number"===typeof a?new x({minValue:a,maxValue:b,symbol:k.ensureType(d)}):B(g.clone(a));this.classBreakInfos.push(c);1===this.classBreakInfos.length&&this.notifyChange("minValue")};c.prototype.removeClassBreakInfo=function(a,b){for(var d=this.classBreakInfos.length,c=0;c<d;c++){var e=[this.classBreakInfos[c].minValue,this.classBreakInfos[c].maxValue];if(e[0]===
a&&e[1]===b){this.classBreakInfos.splice(c,1);break}}};c.prototype.getBreakIndex=function(a,b){this.valueExpression&&(h.isNone(b)||h.isNone(b.arcade))&&z.warn("");return this.valueExpression?this._getBreakIndexForExpression(a,b):this._getBreakIndexForField(a)};c.prototype.getClassBreakInfo=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var d,c,g,f;return e.__generator(this,function(k){switch(k.label){case 0:d=b;if(!this.valueExpression||!h.isNone(b)&&!h.isNone(b.arcade))return[3,2];
c=[e.__assign({},d)];g={};return[4,v.loadArcade()];case 1:d=e.__assign.apply(void 0,c.concat([(g.arcade=k.sent(),g)])),k.label=2;case 2:return f=this.getBreakIndex(a,d),[2,-1!==f?this.classBreakInfos[f]:null]}})})};c.prototype.getSymbol=function(a,b){if(this.valueExpression&&(h.isNone(b)||h.isNone(b.arcade)))z.error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");else return a=this.getBreakIndex(a,b),-1<a?this.classBreakInfos[a].symbol:this.defaultSymbol};c.prototype.getSymbolAsync=
function(a,b){return e.__awaiter(this,void 0,void 0,function(){var d,c,g,f;return e.__generator(this,function(k){switch(k.label){case 0:d=b;if(!this.valueExpression||!h.isNone(b)&&!h.isNone(b.arcade))return[3,2];c=[e.__assign({},d)];g={};return[4,v.loadArcade()];case 1:d=e.__assign.apply(void 0,c.concat([(g.arcade=k.sent(),g)])),k.label=2;case 2:return f=this.getBreakIndex(a,d),[2,-1<f?this.classBreakInfos[f].symbol:this.defaultSymbol]}})})};c.prototype.getSymbols=function(){var a=[];this.classBreakInfos.forEach(function(b){b.symbol&&
a.push(b.symbol)});this.defaultSymbol&&a.push(this.defaultSymbol);return a};c.prototype.getAttributeHash=function(){return this.visualVariables&&this.visualVariables.reduce(function(a,b){return a+b.getAttributeHash()},"")};c.prototype.getMeshHash=function(){var a=JSON.stringify(this.backgroundFillSymbol),b=JSON.stringify(this.defaultSymbol),d=this.normalizationField+"."+this.normalizationType+"."+this.normalizationTotal,c=this.classBreakInfos.reduce(function(a,b){return a+b.getMeshHash()},"");return a+
"."+b+"."+c+"."+d+"."+this.field+"."+this.valueExpression};Object.defineProperty(c.prototype,"arcadeRequired",{get:function(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression},enumerable:!0,configurable:!0});c.prototype.clone=function(){return new f({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol&&this.backgroundFillSymbol.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol&&this.defaultSymbol.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,
classBreakInfos:g.clone(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:g.clone(this.visualVariables),legendOptions:g.clone(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})};c.prototype.collectRequiredFields=function(a,d){return e.__awaiter(this,void 0,void 0,function(){var c;return e.__generator(this,function(e){switch(e.label){case 0:return c=
[this.collectVVRequiredFields(a,d),this.collectSymbolFields(a,d)],[4,b.all(c)];case 1:return e.sent(),[2]}})})};c.prototype.collectSymbolFields=function(a,d){return e.__awaiter(this,void 0,void 0,function(){var c;return e.__generator(this,function(g){switch(g.label){case 0:return c=e.__spreadArrays(this.getSymbols().map(function(b){return b.collectRequiredFields(a,d)}),[p.collectArcadeFieldNames(a,d,this.valueExpression)]),p.collectField(a,d,this.field),p.collectField(a,d,this.normalizationField),
[4,b.all(c)];case 1:return g.sent(),[2]}})})};c.prototype._getBreakIndexForExpression=function(a,b){var d=h.unwrapOr(b,{});b=d.viewingMode;var c=d.scale,e=d.spatialReference,g=this._cache.compiledFunc,d=h.unwrap(d.arcade).arcadeUtils;g||(g=d.createSyntaxTree(this.valueExpression),g=d.createFunction(g),this._cache.compiledFunc=g);a=d.executeFunction(g,d.createExecContext(a,d.getViewInfo({viewingMode:b,scale:c,spatialReference:e})));return this._getBreakIndexfromInfos(a)};c.prototype._getBreakIndexForField=
function(a){var b=a.attributes;a=this.normalizationType;var d=parseFloat(b[this.field]);if(a){var c=this.normalizationTotal,b=parseFloat(b[this.normalizationField]);if("log"===a)d=Math.log(d)*Math.LOG10E;else if("percent-of-total"===a&&!isNaN(c))d=d/c*100;else if("field"===a&&!isNaN(b)){if(isNaN(d)||isNaN(b))return-1;d/=b}}return this._getBreakIndexfromInfos(d)};c.prototype._getBreakIndexfromInfos=function(a){var b=this.isMaxInclusive;if(null!=a&&"number"===typeof a&&!isNaN(a))for(var d=0;d<this.classBreakInfos.length;d++){var c=
[this.classBreakInfos[d].minValue,this.classBreakInfos[d].maxValue];if(c[0]<=a&&(b?a<=c[1]:a<c[1]))return d}return-1};c.prototype._areClassBreaksConsecutive=function(){for(var a=this.classBreakInfos,b=a.length,d=1;d<b;d++)if(a[d-1].maxValue!==a[d].minValue)return!1;return!0};var f;e.__decorate([d.property({readOnly:!0,dependsOn:["valueExpression"]})],c.prototype,"_cache",null);e.__decorate([d.property({types:{base:m.BaseSymbol,key:"type",typeMap:{"simple-fill":k.symbolTypesRenderer.typeMap["simple-fill"],
"picture-fill":k.symbolTypesRenderer.typeMap["picture-fill"],"polygon-3d":k.symbolTypesRenderer.typeMap["polygon-3d"]}},json:{origins:{"web-scene":{type:m.PolygonSymbol3D,read:y.read,write:y.writeTarget}},read:y.read,write:y.writeTarget}})],c.prototype,"backgroundFillSymbol",void 0);e.__decorate([d.property({type:[x]})],c.prototype,"classBreakInfos",void 0);e.__decorate([d.reader("classBreakInfos")],c.prototype,"readClassBreakInfos",null);e.__decorate([d.writer("classBreakInfos")],c.prototype,"writeClassBreakInfos",
null);e.__decorate([d.property({type:String,json:{write:!0}})],c.prototype,"defaultLabel",void 0);e.__decorate([d.property({types:k.symbolTypesRenderer})],c.prototype,"defaultSymbol",void 0);e.__decorate([d.reader("defaultSymbol")],c.prototype,"readDefaultSymbol",null);e.__decorate([d.writer("web-scene","defaultSymbol",{defaultSymbol:{types:k.symbolTypesRenderer3D}})],c.prototype,"writeDefaultSymbolWebScene",null);e.__decorate([d.writer("defaultSymbol")],c.prototype,"writeDefaultSymbol",null);e.__decorate([d.property({type:String,
json:{write:!0}})],c.prototype,"field",void 0);e.__decorate([d.cast("field")],c.prototype,"castField",null);e.__decorate([d.property({type:Boolean})],c.prototype,"isMaxInclusive",void 0);e.__decorate([d.property({type:u.default,json:{write:!0}})],c.prototype,"legendOptions",void 0);e.__decorate([d.property({type:Number,readOnly:!0,value:null,dependsOn:["classBreakInfos"],json:{read:!1,write:{overridePolicy:function(){return 0!==this.classBreakInfos.length&&this._areClassBreaksConsecutive()?{enabled:!0}:
{enabled:!1}}}}})],c.prototype,"minValue",null);e.__decorate([d.property({type:String,json:{write:!0}})],c.prototype,"normalizationField",void 0);e.__decorate([d.property({type:Number,cast:function(a){return n.ensureNumber(a)},json:{write:!0}})],c.prototype,"normalizationTotal",void 0);e.__decorate([d.property({type:A.apiValues,value:null,dependsOn:["normalizationField","normalizationTotal"],json:{type:A.jsonValues,read:A.read,write:A.write}})],c.prototype,"normalizationType",null);e.__decorate([d.enumeration({classBreaks:"class-breaks"})],
c.prototype,"type",void 0);e.__decorate([d.property({type:String,json:{write:!0}})],c.prototype,"valueExpression",void 0);e.__decorate([d.property({type:String,json:{write:!0}})],c.prototype,"valueExpressionTitle",void 0);return c=f=e.__decorate([d.subclass("esri.renderers.ClassBreaksRenderer")],c)}(q.VisualVariablesMixin(r))})},"esri/renderers/Renderer":function(){define("require exports tslib ../core/jsonMap ../core/JSONSupport ../core/SetUtils ../core/accessorSupport/decorators ./support/AuthoringInfo".split(" "),
function(f,a,e,m,k,l,g,c){var h=new m.default({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary"},{ignoreUnknown:!0});return function(a){function b(b){b=a.call(this,b)||this;b.authoringInfo=null;b.type=null;return b}e.__extends(b,a);b.prototype.getRequiredFields=function(a){return e.__awaiter(this,void 0,void 0,function(){var b;return e.__generator(this,function(d){switch(d.label){case 0:if(!this.collectRequiredFields)return[2,
[]];b=new Set;return[4,this.collectRequiredFields(b,a)];case 1:return d.sent(),[2,l.valuesOfSet(b).sort()]}})})};b.prototype.getSymbol=function(a,b){};b.prototype.getSymbolAsync=function(a,b){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(a){return[2]})})};b.prototype.getSymbols=function(){return[]};b.prototype.getAttributeHash=function(){return JSON.stringify(this)};b.prototype.getMeshHash=function(){return JSON.stringify(this)};e.__decorate([g.property({type:c,
json:{write:!0}})],b.prototype,"authoringInfo",void 0);e.__decorate([g.property({type:h.apiValues,readOnly:!0,json:{type:h.jsonValues,read:!1,write:{writer:h.write,ignoreOrigin:!0}}})],b.prototype,"type",void 0);return b=e.__decorate([g.subclass("esri.renderers.Renderer")],b)}(k.JSONSupport)})},"esri/renderers/support/AuthoringInfo":function(){define("require exports tslib ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ./AuthoringInfoFieldInfo ./AuthoringInfoVisualVariable ../../tasks/support/colorRamps".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d){var n=new m.default({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),p=new m.default({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),
r="inches feet yards miles nautical-miles millimeters centimeters decimeters meters kilometers decimal-degrees".split(" ");return function(a){function f(b){b=a.call(this,b)||this;b.colorRamp=null;b.lengthUnit=null;b.maxSliderValue=null;b.minSliderValue=null;b.visualVariables=null;return b}e.__extends(f,a);k=f;Object.defineProperty(f.prototype,"classificationMethod",{get:function(){var a=this._get("classificationMethod"),b=this.type;return b&&"relationship"!==b?"class-breaks-size"===b||"class-breaks-color"===
b?a||"manual":null:a},set:function(a){this._set("classificationMethod",a)},enumerable:!0,configurable:!0});f.prototype.readColorRamp=function(a){if(a)return d.fromJSON(a)};Object.defineProperty(f.prototype,"fields",{get:function(){return this.type&&"predominance"!==this.type?null:this._get("fields")},set:function(a){this._set("fields",a)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"field1",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("field1")},
set:function(a){this._set("field1",a)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"field2",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("field2")},set:function(a){this._set("field2",a)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"focus",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("focus")},set:function(a){this._set("focus",a)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,
"numClasses",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("numClasses")},set:function(a){this._set("numClasses",a)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"standardDeviationInterval",{get:function(){var a=this.type;return a&&"relationship"!==a&&"class-breaks-size"!==a&&"class-breaks-color"!==a?null:this.classificationMethod&&"standard-deviation"!==this.classificationMethod?null:this._get("standardDeviationInterval")},set:function(a){this._set("standardDeviationInterval",
a)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"type",{get:function(){return this._get("type")},set:function(a){var b=a;"classed-size"===a?b="class-breaks-size":"classed-color"===a&&(b="class-breaks-color");this._set("type",b)},enumerable:!0,configurable:!0});f.prototype.clone=function(){return new k({classificationMethod:this.classificationMethod,colorRamp:l.clone(this.colorRamp),fields:this.fields&&this.fields.slice(0),field1:l.clone(this.field1),field2:l.clone(this.field2),
focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map(function(a){return a.clone()})})};var k;e.__decorate([g.property({type:n.apiValues,value:null,dependsOn:["type"],json:{type:n.jsonValues,read:n.read,write:n.write,origins:{"web-document":{default:"manual",type:n.jsonValues,read:n.read,
write:n.write}}}})],f.prototype,"classificationMethod",null);e.__decorate([g.property({types:d.types,json:{write:!0}})],f.prototype,"colorRamp",void 0);e.__decorate([g.reader("colorRamp")],f.prototype,"readColorRamp",null);e.__decorate([g.property({type:[String],value:null,dependsOn:["type"],json:{write:!0}})],f.prototype,"fields",null);e.__decorate([g.property({type:h.default,value:null,dependsOn:["type"],json:{write:!0}})],f.prototype,"field1",null);e.__decorate([g.property({type:h.default,value:null,
dependsOn:["type"],json:{write:!0}})],f.prototype,"field2",null);e.__decorate([g.property({type:["HH","HL","LH","LL"],value:null,dependsOn:["type"],json:{write:!0}})],f.prototype,"focus",null);e.__decorate([g.property({type:Number,value:null,dependsOn:["type"],json:{type:c.Integer,write:!0}})],f.prototype,"numClasses",null);e.__decorate([g.property({type:r,json:{type:r,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],f.prototype,"lengthUnit",void 0);e.__decorate([g.property({type:Number,
json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],f.prototype,"maxSliderValue",void 0);e.__decorate([g.property({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],f.prototype,"minSliderValue",void 0);e.__decorate([g.property({type:[.25,.33,.5,1],value:null,dependsOn:["classificationMethod","type"],json:{type:[.25,.33,.5,1],write:!0}})],f.prototype,"standardDeviationInterval",null);e.__decorate([g.property({type:String,value:null,json:{type:p.jsonValues,read:p.read,
write:p.write,origins:{"web-scene":{type:p.jsonValues.filter(function(a){return"dotDensity"!==a}),read:p.read,write:p.write}}}})],f.prototype,"type",null);e.__decorate([g.property({type:[b],json:{write:!0}})],f.prototype,"visualVariables",void 0);return f=k=e.__decorate([g.subclass("esri.renderers.support.AuthoringInfo")],f)}(k.JSONSupport)})},"esri/renderers/support/AuthoringInfoFieldInfo":function(){define("require exports tslib ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ./AuthoringInfoClassBreakInfo".split(" "),
function(f,a,e,m,k,l,g){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function c(b){b=a.call(this,b)||this;b.field="";b.normalizationField="";b.label="";b.classBreakInfos=[];return b}e.__extends(c,a);b=c;c.prototype.clone=function(){return new b({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:k.clone(this.classBreakInfos)})};var b;e.__decorate([l.property({type:String,json:{write:!0}})],c.prototype,"field",void 0);e.__decorate([l.property({type:String,
json:{write:!0}})],c.prototype,"normalizationField",void 0);e.__decorate([l.property({type:String,json:{write:!0}})],c.prototype,"label",void 0);e.__decorate([l.property({type:[g.default],json:{write:!0}})],c.prototype,"classBreakInfos",void 0);return c=b=e.__decorate([l.subclass("esri.renderers.support.AuthoringInfoFieldInfo")],c)}(m.JSONSupport);a.AuthoringInfoFieldInfo=f;a.default=f})},"esri/renderers/support/AuthoringInfoClassBreakInfo":function(){define(["require","exports","tslib","../../core/JSONSupport",
"../../core/accessorSupport/decorators"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function g(c){c=a.call(this,c)||this;c.minValue=0;c.maxValue=0;return c}e.__extends(g,a);c=g;g.prototype.clone=function(){return new c({minValue:this.minValue,maxValue:this.maxValue})};var c;e.__decorate([k.property({type:Number,json:{write:!0}})],g.prototype,"minValue",void 0);e.__decorate([k.property({type:Number,json:{write:!0}})],g.prototype,"maxValue",void 0);return g=c=
e.__decorate([k.subclass("esri.renderer.support.AuthoringInfoClassBreakInfo")],g)}(m.JSONSupport);a.AuthoringInfoClassBreakInfo=f;a.default=f})},"esri/renderers/support/AuthoringInfoVisualVariable":function(){define("require exports tslib ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/decorators/cast".split(" "),function(f,a,e,m,k,l,g){var c=new m.default({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),h=new m.default({sizeInfo:"size",
colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),b={key:function(a){return"number"===typeof a?"number":"string"},typeMap:{number:Number,string:String},base:null},d=["high-to-low","above-and-below","centered-on","extremes"],n="seconds minutes hours days months years".split(" ");return function(a){function f(b){b=a.call(this,b)||this;b.endTime=null;b.field=null;b.maxSliderValue=null;b.minSliderValue=null;b.startTime=null;b.type=null;b.units=null;return b}e.__extends(f,a);k=f;f.prototype.castEndTime=
function(a){return"string"===typeof a||"number"===typeof a?a:null};f.prototype.castStartTime=function(a){return"string"===typeof a||"number"===typeof a?a:null};Object.defineProperty(f.prototype,"style",{get:function(){return"color"===this.type?this._get("style"):null},set:function(a){this._set("style",a)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"theme",{get:function(){return"color"===this.type?this._get("theme")||"high-to-low":null},set:function(a){this._set("theme",a)},
enumerable:!0,configurable:!0});f.prototype.clone=function(){return new k({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})};var k;e.__decorate([l.property({types:b,json:{write:!0}})],f.prototype,"endTime",void 0);e.__decorate([g.cast("endTime")],f.prototype,"castEndTime",null);e.__decorate([l.property({type:String,json:{write:!0}})],f.prototype,"field",
void 0);e.__decorate([l.property({type:Number,json:{write:!0}})],f.prototype,"maxSliderValue",void 0);e.__decorate([l.property({type:Number,json:{write:!0}})],f.prototype,"minSliderValue",void 0);e.__decorate([l.property({types:b,json:{write:!0}})],f.prototype,"startTime",void 0);e.__decorate([g.cast("startTime")],f.prototype,"castStartTime",null);e.__decorate([l.property({type:c.apiValues,value:null,dependsOn:["type"],json:{type:c.jsonValues,read:c.read,write:c.write}})],f.prototype,"style",null);
e.__decorate([l.property({type:d,value:null,dependsOn:["type"],json:{type:d,write:!0}})],f.prototype,"theme",null);e.__decorate([l.property({type:h.apiValues,json:{type:h.jsonValues,read:h.read,write:h.write}})],f.prototype,"type",void 0);e.__decorate([l.property({type:n,json:{type:n,write:!0}})],f.prototype,"units",void 0);return f=k=e.__decorate([l.subclass("esri.renderers.support.AuthoringInfoVisualVariable")],f)}(k.JSONSupport)})},"esri/tasks/support/colorRamps":function(){define(["require","exports",
"./AlgorithmicColorRamp","./ColorRamp","./MultipartColorRamp"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});a.types={key:"type",base:m,typeMap:{algorithmic:e,multipart:k}};a.fromJSON=function(a){return a&&a.type?"algorithmic"===a.type?e.fromJSON(a):"multipart"===a.type?k.fromJSON(a):null:null}})},"esri/tasks/support/AlgorithmicColorRamp":function(){define("require exports tslib ../../Color ../../core/lang ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ./ColorRamp".split(" "),
function(f,a,e,m,k,l,g,c){return function(a){function b(b){b=a.call(this,b)||this;b.algorithm=null;b.fromColor=null;b.toColor=null;b.type="algorithmic";return b}e.__extends(b,a);d=b;b.prototype.clone=function(){return new d({fromColor:k.clone(this.fromColor),toColor:k.clone(this.toColor),algorithm:this.algorithm})};var d;e.__decorate([l.enumeration({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],b.prototype,"algorithm",void 0);e.__decorate([l.property({type:m,
json:{type:[g.Integer],write:!0}})],b.prototype,"fromColor",void 0);e.__decorate([l.property({type:m,json:{type:[g.Integer],write:!0}})],b.prototype,"toColor",void 0);e.__decorate([l.property({type:["algorithmic"]})],b.prototype,"type",void 0);return b=d=e.__decorate([l.subclass("esri.tasks.support.AlgorithmicColorRamp")],b)}(c)})},"esri/tasks/support/ColorRamp":function(){define(["require","exports","tslib","../../core/JSONSupport","../../core/accessorSupport/decorators"],function(f,a,e,m,k){return function(a){function g(c){c=
a.call(this,c)||this;c.type=null;return c}e.__extends(g,a);e.__decorate([k.property({readOnly:!0,json:{read:!1,write:!0}})],g.prototype,"type",void 0);return g=e.__decorate([k.subclass("esri.tasks.support.ColorRamp")],g)}(m.JSONSupport)})},"esri/tasks/support/MultipartColorRamp":function(){define("require exports tslib ../../core/lang ../../core/accessorSupport/decorators ./AlgorithmicColorRamp ./ColorRamp".split(" "),function(f,a,e,m,k,l,g){return function(a){function c(b){b=a.call(this,b)||this;
b.colorRamps=null;b.type="multipart";return b}e.__extends(c,a);b=c;c.prototype.clone=function(){return new b({colorRamps:m.clone(this.colorRamps)})};var b;e.__decorate([k.property({type:[l],json:{write:!0}})],c.prototype,"colorRamps",void 0);e.__decorate([k.property({type:["multipart"]})],c.prototype,"type",void 0);return c=b=e.__decorate([k.subclass("esri.tasks.support.MultipartColorRamp")],c)}(g)})},"esri/renderers/mixins/VisualVariablesMixin":function(){define("require exports tslib ../../core/accessorSupport/decorators ../../layers/support/fieldUtils ../visualVariables/ColorVariable ../visualVariables/OpacityVariable ../visualVariables/RotationVariable ../visualVariables/SizeVariable ../visualVariables/VisualVariable ../visualVariables/VisualVariableFactory".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d){Object.defineProperty(a,"__esModule",{value:!0});var n={base:b,key:"type",typeMap:{opacity:g,color:l,rotation:c,size:h}};a.VisualVariablesMixin=function(a){return function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._vvFactory=new d;return b}e.__extends(b,a);Object.defineProperty(b.prototype,"visualVariables",{set:function(a){this._vvFactory.visualVariables=a;this._set("visualVariables",this._vvFactory.visualVariables)},enumerable:!0,configurable:!0});
b.prototype.readVisualVariables=function(a,b,d){return this._vvFactory.readVariables(a,b,d)};b.prototype.writeVisualVariables=function(a,b,d,c){b[d]=this._vvFactory.writeVariables(a,c)};Object.defineProperty(b.prototype,"arcadeRequiredForVisualVariables",{get:function(){if(!this.visualVariables)return!1;for(var a=0,b=this.visualVariables;a<b.length;a++)if(b[a].arcadeRequired)return!0;return!1},enumerable:!0,configurable:!0});b.prototype.hasVisualVariables=function(a,b){return a?!!this.getVisualVariablesForType(a,
b):!!(this.getVisualVariablesForType("size",b)||this.getVisualVariablesForType("color",b)||this.getVisualVariablesForType("opacity",b)||this.getVisualVariablesForType("rotation",b))};b.prototype.getVisualVariablesForType=function(a,b){var d=this.visualVariables;if(d&&(d=d.filter(function(d){return d.type===a&&("string"===typeof b?d.target===b:!1===b?!d.target:!0)}),!d||0!==d.length))return d};b.prototype.collectVVRequiredFields=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var d,
c,g,f;return e.__generator(this,function(e){switch(e.label){case 0:d=[],this.visualVariables&&(d=d.concat(this.visualVariables)),c=0,g=d,e.label=1;case 1:if(!(c<g.length))return[3,4];f=g[c];if(!f)return[3,3];f.field&&k.collectField(a,b,f.field);f.normalizationField&&k.collectField(a,b,f.normalizationField);return f.valueExpression?[4,k.collectArcadeFieldNames(a,b,f.valueExpression)]:[3,3];case 2:e.sent(),e.label=3;case 3:return c++,[3,1];case 4:return[2]}})})};e.__decorate([m.property({types:[n],
value:null,json:{write:!0}})],b.prototype,"visualVariables",null);e.__decorate([m.reader("visualVariables",["visualVariables","rotationType","rotationExpression"])],b.prototype,"readVisualVariables",null);e.__decorate([m.writer("visualVariables")],b.prototype,"writeVisualVariables",null);return b=e.__decorate([m.subclass("esri.renderers.mixins.VisualVariablesMixin")],b)}(a)}})},"esri/renderers/visualVariables/ColorVariable":function(){define("require exports tslib ../../core/accessorSupport/decorators ./VisualVariable ./support/ColorStop".split(" "),
function(f,a,e,m,k,l){return function(a){function c(b){b=a.call(this,b)||this;b.type="color";b.normalizationField=null;return b}e.__extends(c,a);g=c;Object.defineProperty(c.prototype,"cache",{get:function(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"stops",{set:function(a){a&&Array.isArray(a)&&(a=a.filter(function(a){return!!a}),a.sort(function(a,b){return a.value-b.value}));this._set("stops",
a)},enumerable:!0,configurable:!0});c.prototype.clone=function(){return new g({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(function(a){return a.clone()}),legendOptions:this.legendOptions&&this.legendOptions.clone()})};c.prototype.getAttributeHash=function(){return a.prototype.getAttributeHash.call(this)+"-"+this.normalizationField};c.prototype._interpolateData=function(){return this.stops&&
this.stops.map(function(a){return a.value||0})};var g;e.__decorate([m.property({readOnly:!0,dependsOn:["valueExpression","stops"]})],c.prototype,"cache",null);e.__decorate([m.property({type:["color"],json:{type:["colorInfo"]}})],c.prototype,"type",void 0);e.__decorate([m.property({type:String,json:{write:!0}})],c.prototype,"normalizationField",void 0);e.__decorate([m.property({type:[l],json:{write:!0}})],c.prototype,"stops",null);return c=g=e.__decorate([m.subclass("esri.renderers.visualVariables.ColorVariable")],
c)}(k)})},"esri/renderers/visualVariables/VisualVariable":function(){define("require exports tslib ../../core/jsonMap ../../core/JSONSupport ../../core/Logger ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ./support/VisualVariableLegendOptions".split(" "),function(f,a,e,m,k,l,g,c,h){var b=l.getLogger("esri.renderers.visualVariables.VisualVariable"),d=new m.default({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});return function(a){function f(b){b=
a.call(this,b)||this;b.index=null;b.type=null;b.field=null;b.valueExpression=null;b.valueExpressionTitle=null;b.legendOptions=null;return b}e.__extends(f,a);f.prototype.castField=function(a){return null==a?a:"function"===typeof a?(b.error(".field: field must be a string value"),null):c.ensureString(a)};Object.defineProperty(f.prototype,"arcadeRequired",{get:function(){return!!this.valueExpression},enumerable:!0,configurable:!0});f.prototype.clone=function(){};f.prototype.getAttributeHash=function(){return this.type+
"-"+this.field+"-"+this.valueExpression};e.__decorate([g.property()],f.prototype,"index",void 0);e.__decorate([g.property({type:d.apiValues,readOnly:!0,json:{read:d.read,write:d.write}})],f.prototype,"type",void 0);e.__decorate([g.property({type:String,json:{write:!0}})],f.prototype,"field",void 0);e.__decorate([g.cast("field")],f.prototype,"castField",null);e.__decorate([g.property({type:String,json:{write:!0}})],f.prototype,"valueExpression",void 0);e.__decorate([g.property({type:String,json:{write:!0}})],
f.prototype,"valueExpressionTitle",void 0);e.__decorate([g.property({readOnly:!0,dependsOn:["valueExpression"]})],f.prototype,"arcadeRequired",null);e.__decorate([g.property({type:h,json:{write:!0}})],f.prototype,"legendOptions",void 0);return f=e.__decorate([g.subclass("esri.renderers.visualVariables.VisualVariable")],f)}(k.JSONSupport)})},"esri/renderers/visualVariables/support/VisualVariableLegendOptions":function(){define(["require","exports","tslib","../../../core/accessorSupport/decorators",
"../../support/LegendOptions"],function(f,a,e,m,k){return function(a){function g(){var c=null!==a&&a.apply(this,arguments)||this;c.showLegend=null;return c}e.__extends(g,a);c=g;g.prototype.clone=function(){return new c({title:this.title,showLegend:this.showLegend})};var c;e.__decorate([m.property({type:Boolean,json:{write:!0}})],g.prototype,"showLegend",void 0);return g=c=e.__decorate([m.subclass("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],g)}(k.default)})},"esri/renderers/support/LegendOptions":function(){define(["require",
"exports","tslib","../../core/JSONSupport","../../core/accessorSupport/decorators"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function g(){var c=null!==a&&a.apply(this,arguments)||this;c.title=null;return c}e.__extends(g,a);c=g;g.prototype.clone=function(){return new c({title:this.title})};var c;e.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"title",void 0);return g=c=e.__decorate([k.subclass("esri.renderers.support.LegendOptions")],g)}(m.JSONSupport);
a.LegendOptions=f;a.default=f})},"esri/renderers/visualVariables/OpacityVariable":function(){define("require exports tslib ../../core/accessorSupport/decorators ./VisualVariable ./support/OpacityStop".split(" "),function(f,a,e,m,k,l){return function(a){function c(b){b=a.call(this,b)||this;b.type="opacity";b.normalizationField=null;return b}e.__extends(c,a);g=c;Object.defineProperty(c.prototype,"cache",{get:function(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"stops",{set:function(a){a&&Array.isArray(a)&&(a=a.filter(function(a){return!!a}),a.sort(function(a,b){return a.value-b.value}));this._set("stops",a)},enumerable:!0,configurable:!0});c.prototype.clone=function(){return new g({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(function(a){return a.clone()}),legendOptions:this.legendOptions&&
this.legendOptions.clone()})};c.prototype.getAttributeHash=function(){return a.prototype.getAttributeHash.call(this)+"-"+this.normalizationField};c.prototype._interpolateData=function(){return this.stops&&this.stops.map(function(a){return a.value||0})};var g;e.__decorate([m.property({readOnly:!0,dependsOn:["valueExpression","stops"]})],c.prototype,"cache",null);e.__decorate([m.property({type:["opacity"],json:{type:["transparencyInfo"]}})],c.prototype,"type",void 0);e.__decorate([m.property({type:String,
json:{write:!0}})],c.prototype,"normalizationField",void 0);e.__decorate([m.property({type:[l],json:{write:!0}})],c.prototype,"stops",null);return c=g=e.__decorate([m.subclass("esri.renderers.visualVariables.OpacityVariable")],c)}(k)})},"esri/renderers/visualVariables/support/OpacityStop":function(){define("require exports tslib ../../../core/JSONSupport ../../../core/accessorSupport/decorators ../../../core/accessorSupport/ensureType ../../../webdoc/support/opacityUtils".split(" "),function(f,a,
e,m,k,l,g){return function(a){function c(b){b=a.call(this,b)||this;b.label=null;b.opacity=null;b.value=null;return b}e.__extends(c,a);b=c;c.prototype.readOpacity=function(a,b){return g.transparencyToOpacity(b.transparency)};c.prototype.writeOpacity=function(a,b,c){b[c]=g.opacityToTransparency(a)};c.prototype.clone=function(){return new b({label:this.label,opacity:this.opacity,value:this.value})};var b;e.__decorate([k.property({type:String,json:{write:!0}})],c.prototype,"label",void 0);e.__decorate([k.property({type:Number,
json:{type:l.Integer,write:{target:"transparency"}}})],c.prototype,"opacity",void 0);e.__decorate([k.reader("opacity",["transparency"])],c.prototype,"readOpacity",null);e.__decorate([k.writer("opacity")],c.prototype,"writeOpacity",null);e.__decorate([k.property({type:Number,json:{write:!0}})],c.prototype,"value",void 0);return c=b=e.__decorate([k.subclass("esri.renderers.visualVariables.support.OpacityStop")],c)}(m.JSONSupport)})},"esri/renderers/visualVariables/RotationVariable":function(){define("require exports tslib ../../core/Error ../../core/accessorSupport/decorators ./VisualVariable".split(" "),
function(f,a,e,m,k,l){return function(a){function c(b){b=a.call(this,b)||this;b.axis=null;b.type="rotation";b.rotationType="geographic";b.valueExpressionTitle=null;return b}e.__extends(c,a);g=c;Object.defineProperty(c.prototype,"cache",{get:function(){return{hasExpression:!!this.valueExpression,compiledFunc:null}},enumerable:!0,configurable:!0});c.prototype.writeValueExpressionTitleWebScene=function(a,d,c,e){e&&e.messages&&e.messages.push(new m("property:unsupported",this.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",
{instance:this,propertyName:"visualVariables["+this.index+"].valueExpressionTitle",context:e}))};c.prototype.clone=function(){return new g({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions&&this.legendOptions.clone()})};var g;e.__decorate([k.property({readOnly:!0,dependsOn:["valueExpression"]})],c.prototype,"cache",null);e.__decorate([k.property({type:["heading","tilt",
"roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],c.prototype,"axis",void 0);e.__decorate([k.property({type:["rotation"],json:{type:["rotationInfo"]}})],c.prototype,"type",void 0);e.__decorate([k.property({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],c.prototype,"rotationType",void 0);e.__decorate([k.property({type:String,json:{write:!0}})],c.prototype,"valueExpressionTitle",void 0);e.__decorate([k.writer("web-scene",
"valueExpressionTitle")],c.prototype,"writeValueExpressionTitleWebScene",null);return c=g=e.__decorate([k.subclass("esri.renderers.visualVariables.RotationVariable")],c)}(l)})},"esri/renderers/visualVariables/SizeVariable":function(){define("require exports tslib ../../core/Error ../../core/jsonMap ../../core/Logger ../../core/screenUtils ../../core/accessorSupport/decorators ./VisualVariable ./support/SizeStop ./support/SizeVariableLegendOptions ./support/sizeVariableUtils ./support/visualVariableUtils".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p){function r(a){if(null!=a){if("string"===typeof a||"number"===typeof a)return g.toPt(a);if("size"===a.type){if(n.isSizeVariable(a))return a;a=e.__assign({},a);delete a.type;return new y(a)}}}function q(a,b,d){if("object"!==typeof a)return a;b=new y;b.read(a,d);return b}var x=l.getLogger("esri.renderers.visualVariables.SizeVariable"),u=new k.default({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),v=new k.default({unknown:"unknown",
inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"}),y=function(a){function g(b){b=a.call(this,b)||this;b.axis=null;b.legendOptions=null;b.normalizationField=null;b.scaleBy=null;b.target=null;b.type="size";b.useSymbolValue=null;b.valueExpression=null;b.valueRepresentation=null;b.valueUnit=null;return b}e.__extends(g,a);
f=g;Object.defineProperty(g.prototype,"cache",{get:function(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:p.viewScaleRE.test(this.valueExpression)}},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"expression",{set:function(a){x.warn("'expression' is deprecated since version 4.2. Use 'valueExpression' instead. The only supported expression is 'view.scale'.");"view.scale"===a?(this.valueExpression="$view.scale",this._set("expression",
a)):this._set("expression",null)},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"index",{set:function(a){n.isSizeVariable(this.maxSize)&&(this.maxSize.index="visualVariables["+a+"].maxSize");n.isSizeVariable(this.minSize)&&(this.minSize.index="visualVariables["+a+"].minSize");this._set("index",a)},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"inputValueType",{get:function(){return n.getInputValueType(this)},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,
"maxDataValue",{set:function(a){a&&this.stops&&(x.warn("cannot set maxDataValue when stops is not null."),a=null);this._set("maxDataValue",a)},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"maxSize",{set:function(a){a&&this.stops&&(x.warn("cannot set maxSize when stops is not null."),a=null);this._set("maxSize",a)},enumerable:!0,configurable:!0});g.prototype.castMaxSize=function(a){return r(a)};g.prototype.readMaxSize=function(a,b,d){return q(a,b,d)};Object.defineProperty(g.prototype,
"minDataValue",{set:function(a){a&&this.stops&&(x.warn("cannot set minDataValue when stops is not null."),a=null);this._set("minDataValue",a)},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"minSize",{set:function(a){a&&this.stops&&(x.warn("cannot set minSize when stops is not null."),a=null);this._set("minSize",a)},enumerable:!0,configurable:!0});g.prototype.castMinSize=function(a){return r(a)};g.prototype.readMinSize=function(a,b,d){return q(a,b,d)};Object.defineProperty(g.prototype,
"arcadeRequired",{get:function(){return this.valueExpression?!0:this.minSize&&"object"===typeof this.minSize&&this.minSize.arcadeRequired||this.maxSize&&"object"===typeof this.maxSize&&this.maxSize.arcadeRequired},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"stops",{set:function(a){null==this.minDataValue&&null==this.maxDataValue&&null==this.minSize&&null==this.maxSize?a&&Array.isArray(a)&&(a=a.filter(function(a){return!!a}),a.sort(function(a,b){return a.value-b.value})):a&&
(x.warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),a=null);this._set("stops",a)},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"transformationType",{get:function(){return n.getTransformationType(this,this.inputValueType)},enumerable:!0,configurable:!0});g.prototype.readValueExpression=function(a,b){return a||b.expression&&"$view.scale"};g.prototype.writeValueExpressionWebScene=function(a,b,d,c){"$view.scale"===a?c&&c.messages&&(a=
this.index,c.messages.push(new m("property:unsupported",this.type+"VisualVariable.valueExpression \x3d '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:("string"===typeof a?a:"visualVariables["+a+"]")+".valueExpression",context:c}))):b[d]=a};g.prototype.readValueUnit=function(a){return a?v.read(a):null};g.prototype.clone=function(){return new f({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,
maxDataValue:this.maxDataValue,maxSize:n.isSizeVariable(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:n.isSizeVariable(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(function(a){return a.clone()}),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone()})};
g.prototype.flipSizes=function(){if("clamped-linear"===this.transformationType){var a=this.minSize;this.minSize=this.maxSize;this.maxSize=a;return this}if("stops"===this.transformationType)for(var a=this.stops,b=a.map(function(a){return a.size}).reverse(),d=a.length,c=0;c<d;c++)a[c].size=b[c];return this};g.prototype.getAttributeHash=function(){return a.prototype.getAttributeHash.call(this)+"-"+this.target+"-"+this.normalizationField};g.prototype._interpolateData=function(){return this.stops&&this.stops.map(function(a){return a.value||
0})};var f;e.__decorate([c.property({readOnly:!0,dependsOn:["valueExpression","stops"]})],g.prototype,"cache",null);e.__decorate([c.property({type:u.apiValues,json:{type:u.jsonValues,origins:{"web-map":{read:!1}},read:u.read,write:u.write}})],g.prototype,"axis",void 0);e.__decorate([c.property({type:String,value:null,json:{read:!1}})],g.prototype,"expression",null);e.__decorate([c.property()],g.prototype,"index",null);e.__decorate([c.property({type:String,readOnly:!0,dependsOn:["field","valueExpression"]})],
g.prototype,"inputValueType",null);e.__decorate([c.property({type:d,json:{write:!0}})],g.prototype,"legendOptions",void 0);e.__decorate([c.property({type:Number,value:null,json:{write:!0}})],g.prototype,"maxDataValue",null);e.__decorate([c.property({type:Number,value:null,json:{write:!0}})],g.prototype,"maxSize",null);e.__decorate([c.cast("maxSize")],g.prototype,"castMaxSize",null);e.__decorate([c.reader("maxSize")],g.prototype,"readMaxSize",null);e.__decorate([c.property({type:Number,value:null,
json:{write:!0}})],g.prototype,"minDataValue",null);e.__decorate([c.property({type:Number,value:null,json:{write:!0}})],g.prototype,"minSize",null);e.__decorate([c.cast("minSize")],g.prototype,"castMinSize",null);e.__decorate([c.reader("minSize")],g.prototype,"readMinSize",null);e.__decorate([c.property({type:String,json:{write:!0}})],g.prototype,"normalizationField",void 0);e.__decorate([c.property({readOnly:!0,dependsOn:["valueExpression","minSize.arcadeRequired","maxSize.arcadeRequired"]})],g.prototype,
"arcadeRequired",null);e.__decorate([c.property({type:String})],g.prototype,"scaleBy",void 0);e.__decorate([c.property({type:[b],value:null,json:{write:!0}})],g.prototype,"stops",null);e.__decorate([c.property({type:["outline"],json:{write:!0}})],g.prototype,"target",void 0);e.__decorate([c.property({type:String,readOnly:!0,dependsOn:"minDataValue maxDataValue minSize maxSize valueUnit inputValueType stops".split(" ")})],g.prototype,"transformationType",null);e.__decorate([c.property({type:["size"],
json:{type:["sizeInfo"]}})],g.prototype,"type",void 0);e.__decorate([c.property({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],g.prototype,"useSymbolValue",void 0);e.__decorate([c.property({type:String,json:{write:!0}})],g.prototype,"valueExpression",void 0);e.__decorate([c.reader("valueExpression",["valueExpression","expression"])],g.prototype,"readValueExpression",null);e.__decorate([c.writer("web-scene","valueExpression")],g.prototype,"writeValueExpressionWebScene",null);e.__decorate([c.property({type:["radius",
"diameter","area","width","distance"],json:{write:!0}})],g.prototype,"valueRepresentation",void 0);e.__decorate([c.property({type:v.apiValues,json:{write:v.write,origins:{"web-map":{read:!1},"web-scene":{write:!0}}}})],g.prototype,"valueUnit",void 0);e.__decorate([c.reader("valueUnit")],g.prototype,"readValueUnit",null);return g=f=e.__decorate([c.subclass("esri.renderers.visualVariables.SizeVariable")],g)}(h);return y})},"esri/renderers/visualVariables/support/SizeStop":function(){define("require exports tslib ../../../core/JSONSupport ../../../core/screenUtils ../../../core/accessorSupport/decorators".split(" "),
function(f,a,e,m,k,l){return function(a){function c(b){b=a.call(this,b)||this;b.label=null;b.size=null;b.value=null;return b}e.__extends(c,a);g=c;c.prototype.clone=function(){return new g({label:this.label,size:this.size,value:this.value})};var g;e.__decorate([l.property({type:String,json:{write:!0}})],c.prototype,"label",void 0);e.__decorate([l.property({type:Number,cast:k.toPt,json:{write:!0}})],c.prototype,"size",void 0);e.__decorate([l.property({type:Number,json:{write:!0}})],c.prototype,"value",
void 0);return c=g=e.__decorate([l.subclass("esri.renderers.visualVariables.support.SizeStop")],c)}(m.JSONSupport)})},"esri/renderers/visualVariables/support/SizeVariableLegendOptions":function(){define(["require","exports","tslib","../../../core/accessorSupport/decorators","./VisualVariableLegendOptions"],function(f,a,e,m,k){return function(a){function g(){var c=null!==a&&a.apply(this,arguments)||this;c.customValues=null;return c}e.__extends(g,a);c=g;g.prototype.clone=function(){return new c({title:this.title,
showLegend:this.showLegend,customValues:this.customValues&&this.customValues.slice(0)})};var c;e.__decorate([m.property({type:[Number],json:{write:!0}})],g.prototype,"customValues",void 0);return g=c=e.__decorate([m.subclass("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],g)}(k)})},"esri/renderers/visualVariables/support/sizeVariableUtils":function(){define(["require","exports"],function(f,a){function e(a){return a.valueExpression?"expression":a.field&&"string"===typeof a.field?
"field":"unknown"}Object.defineProperty(a,"__esModule",{value:!0});a.isSizeVariable=function(a){return a&&"esri.renderers.visualVariables.SizeVariable"===a.declaredClass};a.isValidNumber=function(a){return null!=a&&!isNaN(a)&&isFinite(a)};a.getInputValueType=e;a.getTransformationType=function(a,f){return"unknown"===(f||e(a))?"constant":a.stops?"stops":null!=a.minSize&&null!=a.maxSize&&null!=a.minDataValue&&null!=a.maxDataValue?"clamped-linear":"unknown"===(a.valueUnit||"unknown")?null!=a.minSize&&
null!=a.minDataValue?a.minSize&&a.minDataValue?"proportional":"additive":"identity":"real-world-size"}})},"esri/renderers/visualVariables/support/visualVariableUtils":function(){define("require exports ../../../Color ../../../Graphic ../../../core/compilerUtils ../../../core/Logger ../../../core/maybe ../../support/utils ./sizeVariableUtils".split(" "),function(f,a,e,m,k,l,g,c,h){function b(a,b,d){if(a="visualVariables"in a&&a.visualVariables?a.visualVariables.filter(function(a){return"color"===a.type})[0]:
a)if("esri.renderers.visualVariables.ColorVariable"!==a.declaredClass)y.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable");else{var c="number"===typeof b,f=c?null:b,h=f&&f.attributes,k=c?b:null,l=a.field,m=a.cache;b=m.ipData;var n=m.hasExpression,m=a.cache.compiledFunc;if(!l&&!n)return(d=a.stops)&&d[0]&&d[0].color;if("number"!==typeof k)if(n){if(!g.isSome(d)||!g.isSome(d.arcade)){y.error("Use of arcade expressions requires an arcade context");return}k=
d.arcade.arcadeUtils;l=k.getViewInfo({viewingMode:d.viewingMode,scale:d.scale,spatialReference:d.spatialReference});f=k.createExecContext(f,l);m||(m=k.createSyntaxTree(a.valueExpression),m=k.createFunction(m),a.cache.compiledFunc=m);k=k.executeFunction(m,f)}else h&&(k=h[l]);f=a.normalizationField;h=h?parseFloat(h[f]):void 0;if(null!=k&&(!f||c||!isNaN(h)&&0!==h)&&(isNaN(h)||c||(k/=h),c=v(k,b)))return h=c[0],b=c[1],d=h===b?a.stops[h].color:e.blendColors(a.stops[h].color,a.stops[b].color,c[2],g.isSome(d)?
d.color:void 0),new e(d)}}function d(a,b,d){if(a="visualVariables"in a&&a.visualVariables?a.visualVariables.filter(function(a){return"opacity"===a.type})[0]:a)if("esri.renderers.visualVariables.OpacityVariable"!==a.declaredClass)y.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable");else{var c="number"===typeof b,e=c?null:b,f=e&&e.attributes,h=c?b:null,k=a.field,l=a.cache;b=l.ipData;var m=l.hasExpression,l=a.cache.compiledFunc;if(!k&&!m)return(a=a.stops)&&
a[0]&&a[0].opacity;if("number"!==typeof h)if(m){if(g.isNone(d)||g.isNone(d.arcade)){y.error("Use of arcade expressions requires an arcade context");return}h=d.arcade.arcadeUtils;d=h.getViewInfo({viewingMode:d.viewingMode,scale:d.scale,spatialReference:d.spatialReference});d=h.createExecContext(e,d);l||(e=h.createSyntaxTree(a.valueExpression),l=h.createFunction(e),a.cache.compiledFunc=l);h=h.executeFunction(l,d)}else f&&(h=f[k]);d=a.normalizationField;f=f?parseFloat(f[d]):void 0;if(null!=h&&(!d||c||
!isNaN(f)&&0!==f)&&(isNaN(f)||c||(h/=f),c=v(h,b))){b=c[0];f=c[1];if(b===f)return a.stops[b].opacity;b=a.stops[b].opacity;return b+(a.stops[f].opacity-b)*c[2]}}}function n(a,b,d){if(a="visualVariables"in a&&a.visualVariables?a.visualVariables.filter(function(a){return"rotation"===a.type})[0]:a)if("esri.renderers.visualVariables.RotationVariable"!==a.declaredClass)y.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable");else{var c=a.axis||"heading",e="heading"===
c&&"arithmetic"===a.rotationType?90:0,c="heading"===c&&"arithmetic"===a.rotationType?-1:1,f="number"===typeof b?null:b,h=f&&f.attributes,k=a.field,l=a.cache.hasExpression;b=a.cache.compiledFunc;var m=0;if(!k&&!l)return m;if(l){if(g.isNone(d)||g.isNone(d.arcade)){y.error("Use of arcade expressions requires an arcade context");return}h=d.arcade.arcadeUtils;d=h.getViewInfo({viewingMode:d.viewingMode,scale:d.scale,spatialReference:d.spatialReference});d=h.createExecContext(f,d);b||(b=h.createSyntaxTree(a.valueExpression),
b=h.createFunction(b),a.cache.compiledFunc=b);m=h.executeFunction(b,d)}else h&&(m=h[k]||0);return m="number"!==typeof m||isNaN(m)?null:e+c*m}}function p(a,b,d){var c="number"===typeof b,e=c?null:b,f=e&&e.attributes,k=c?b:null;b=a.cache.compiledFunc;if(a.cache.isScaleDriven)e=g.isSome(d)?d.scale:void 0,d=g.isSome(d)?d.view:void 0,null==e||d&&"3d"===d.type?(e=d=null,(e=a.stops)?(d=e[0].value,e=e[e.length-1].value):(d=a.minDataValue||0,e=a.maxDataValue||0),d=(d+e)/2):d=e,k=d;else if(!c)switch(a.inputValueType){case "expression":if(g.isNone(d)||
g.isNone(d.arcade)){y.error("Use of arcade expressions requires an arcade context");return}k=d.arcade.arcadeUtils;d=k.getViewInfo({viewingMode:d.viewingMode,scale:d.scale,spatialReference:d.spatialReference});d=k.createExecContext(e,d);b||(e=k.createSyntaxTree(a.valueExpression),b=k.createFunction(e),a.cache.compiledFunc=b);k=k.executeFunction(b,d);break;case "field":f&&(k=f[a.field]);break;case "unknown":k=null}if(!h.isValidNumber(k))return null;if(c||!a.normalizationField)return k;a=f?parseFloat(f[a.normalizationField]):
null;return h.isValidNumber(a)&&0!==a?k/a:null}function r(a,b,d){if(a="visualVariables"in a&&a.visualVariables?a.visualVariables.filter(function(a){return"size"===a.type})[0]:a)if("esri.renderers.visualVariables.SizeVariable"!==a.declaredClass)y.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable");else{var c=p(a,b,d);b=u(c,a,b,d,a.cache.ipData);return null===b||void 0===b||isNaN(b)?0:b}}function q(a,b,d){return null==a?null:h.isSizeVariable(a)?r(a,b,d):h.isValidNumber(a)?
a:null}function x(a,b,d){return h.isValidNumber(d)&&a>d?d:h.isValidNumber(b)&&a<b?b:a}function u(a,b,d,e,f){switch(b.transformationType){case "additive":return e=q(b.minSize,d,e),a+(e||b.minDataValue);case "constant":return a=(a=b.stops)&&a.length&&a[0].size,null==a&&(a=b.minSize),q(a,d,e);case "clamped-linear":f=(a-b.minDataValue)/(b.maxDataValue-b.minDataValue);var h=q(b.minSize,d,e);d=q(b.maxSize,d,e);e=g.isSome(e)?e.shape:void 0;a<=b.minDataValue?b=h:a>=b.maxDataValue?b=d:"area"===b.scaleBy&&
e?(e=(b="circle"===e)?A*Math.pow(h/2,2):h*h,e+=f*((b?A*Math.pow(d/2,2):d*d)-e),b=b?2*Math.sqrt(e/A):Math.sqrt(e)):b=h+f*(d-h);return b;case "proportional":return f=g.isSome(e)?e.shape:void 0,a/=b.minDataValue,h=q(b.minSize,d,e),b=q(b.maxSize,d,e),e=null,e="circle"===f?2*Math.sqrt(a*Math.pow(h/2,2)):"square"===f||"diamond"===f||"image"===f?Math.sqrt(a*Math.pow(h,2)):a*h,x(e,h,b);case "stops":return f=v(a,f),h=f[0],a=f[1],f=f[2],h===a?b=q(b.stops[h].size,d,e):(h=q(b.stops[h].size,d,e),b=q(b.stops[a].size,
d,e),b=h+(b-h)*f),b;case "real-world-size":return f=(g.isSome(e)&&e.resolution?e.resolution:1)*c.meterIn[b.valueUnit],h=q(b.minSize,d,e),e=q(b.maxSize,d,e),b=b.valueRepresentation,d=null,d="area"===b?2*Math.sqrt(a/A)/f:"radius"===b||"distance"===b?2*a/f:a/f,x(d,h,e);case "identity":return a;case "unknown":return null}}function v(a,b){if(b){var d=0,c=b.length-1;b.some(function(b,e){if(a<b)return c=e,!0;d=e;return!1});return[d,c,(a-b[d])/(b[c]-b[d])]}}Object.defineProperty(a,"__esModule",{value:!0});
var y=l.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),z=new m,A=Math.PI;a.viewScaleRE=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;a.getColor=b;a.getOpacity=d;a.getRotationAngle=n;a.getSize=r;a.getSizeFromNumberOrVariable=q;a.getSizeForValue=u;a.getSizeRangeAtScale=function(a,b,d){var c=d&&"3d"===d.type;if(!(a.cache.isScaleDriven&&c||b))return null;d={scale:b,view:d};b=q(a.minSize,z,d);a=q(a.maxSize,z,d);if(null!=b||null!=a)return b>a&&(d=a,a=b,b=d),{minSize:b,maxSize:a}};
a.getVisualVariableValues=function(a,c,e){if(a.visualVariables){var g=[],f=[],h=[],k=[],l=[],m=0;for(a=a.visualVariables;m<a.length;m++){var p=a[m];switch(p.type){case "color":f.push(p);break;case "opacity":h.push(p);break;case "rotation":l.push(p);break;case "size":k.push(p)}}f.forEach(function(a){var d=b(a,c,e);g.push({variable:a,value:d})});h.forEach(function(a){var b=d(a,c,e);g.push({variable:a,value:b})});l.forEach(function(a){var b=n(a,c,e);g.push({variable:a,value:b})});k.forEach(function(a){var b=
r(a,c,e);g.push({variable:a,value:b})});return g.filter(function(a){return null!=a.value})}};a.getAllSizes=function(a,b,d){for(var c=["proportional","proportional","proportional"],e=0;e<a.length;e++){var g=a[e],f=g.useSymbolValue?"symbol-value":r(g,b,d);switch(g.axis){case "width":c[0]=f;break;case "depth":c[1]=f;break;case "height":c[2]=f;break;case "width-and-depth":c[0]=f;c[1]=f;break;case "all":case void 0:case null:c[0]=f;c[1]=f;c[2]=f;break;default:k.neverReached(g.axis)}}return c}})},"esri/renderers/visualVariables/VisualVariableFactory":function(){define("require exports tslib ../../core/Accessor ../../core/jsonMap ../../core/Logger ../../core/Warning ../../core/accessorSupport/decorators ./ColorVariable ./OpacityVariable ./RotationVariable ./SizeVariable".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n){var p=l.getLogger("esri.renderers.visualVariables.VisualVariableFactory"),r={color:h,size:n,opacity:b,rotation:d},q=new k.default({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),x=/^\[([^\]]+)\]$/i;return function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.colorVariables=null;b.opacityVariables=null;b.rotationVariables=null;b.sizeVariables=null;return b}e.__extends(b,a);Object.defineProperty(b.prototype,
"visualVariables",{set:function(a){this._resetVariables();if((a=a&&a.filter(function(a){return!!a}))&&a.length){for(var b=0,d=a;b<d.length;b++){var c=d[b];switch(c.type){case "color":this.colorVariables.push(c);break;case "opacity":this.opacityVariables.push(c);break;case "rotation":this.rotationVariables.push(c);break;case "size":this.sizeVariables.push(c)}}this.sizeVariables.length&&this.sizeVariables.some(function(a){return!!a.target})&&a.sort(function(a,b){var d=null;return d=a.target===b.target?
0:a.target?1:-1});for(b=0;b<a.length;b++)c=a[b],c.index=b}this._set("visualVariables",a)},enumerable:!0,configurable:!0});b.prototype.readVariables=function(a,b,d){var c=b.rotationExpression;b=b.rotationType;if(c=(c=c&&c.match(x))&&c[1])a||(a=[]),a.push({type:"rotationInfo",rotationType:b,field:c});if(a)return a.map(function(a){var b=q.read(a.type),c=r[b];c||(p.warn("Unknown variable type: "+b),d&&d.messages&&d.messages.push(new g("visual-variable:unsupported","visualVariable of type '"+b+"' is not supported",
{definition:a,context:d})));b=new c;b.read(a,d);return b})};b.prototype.writeVariables=function(a,b){for(var d=[],c=0;c<a.length;c++){var e=a[c].toJSON(b);e&&d.push(e)}return d};b.prototype._resetVariables=function(){this.colorVariables=[];this.opacityVariables=[];this.rotationVariables=[];this.sizeVariables=[]};e.__decorate([c.property()],b.prototype,"visualVariables",null);return b=e.__decorate([c.subclass("esri.renderers.visualVariables.VisualVariableFactory")],b)}(m)})},"esri/renderers/support/ClassBreakInfo":function(){define("require exports tslib ../../symbols ../../core/JSONSupport ../../core/accessorSupport/decorators ../../symbols/support/jsonUtils".split(" "),
function(f,a,e,m,k,l,g){return function(a){function c(b){b=a.call(this,b)||this;b.description=null;b.label=null;b.minValue=null;b.maxValue=0;b.symbol=null;return b}e.__extends(c,a);b=c;c.prototype.clone=function(){return new b({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?this.symbol.clone():null})};c.prototype.getMeshHash=function(){var a=JSON.stringify(this.symbol);return this.minValue+"."+this.maxValue+"."+a};var b;e.__decorate([l.property({type:String,
json:{write:!0}})],c.prototype,"description",void 0);e.__decorate([l.property({type:String,json:{write:!0}})],c.prototype,"label",void 0);e.__decorate([l.property({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],c.prototype,"minValue",void 0);e.__decorate([l.property({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],c.prototype,"maxValue",void 0);e.__decorate([l.property({types:m.symbolTypesRenderer,json:{origins:{"web-scene":{types:m.symbolTypesRenderer3D,
read:g.read,write:g.writeTarget}},read:g.read,write:g.writeTarget}})],c.prototype,"symbol",void 0);return c=b=e.__decorate([l.subclass("esri.renderers.support.ClassBreakInfo")],c)}(k.JSONSupport)})},"esri/renderers/DictionaryRenderer":function(){define("require exports tslib ../Color ../request ../core/Error ../core/lang ../core/Logger ../core/LRUCache ../core/maybe ../core/promiseUtils ../core/SetUtils ../core/string ../core/accessorSupport/decorators ../layers/support/fieldUtils ./Renderer ./mixins/VisualVariablesMixin ../support/arcadeOnDemand ../symbols/CIMSymbol".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u,v,y){var z=c.getLogger("esri.renderers.DictionaryRenderer");return function(a){function c(b){b=a.call(this,b)||this;b._ongoingRequests=new Map;b._symbolCache=new h(100);b.config=null;b.description=null;b.fieldMap=null;b.label=null;b.scaleExpression=null;b.url=null;b.type="dictionary";return b}e.__extends(c,a);f=c;c.prototype.clone=function(){return new f({config:g.clone(this.config),scaleExpression:g.clone(this.scaleExpression),description:g.clone(this.description),
fieldMap:g.clone(this.fieldMap),label:g.clone(this.label),url:g.clone(this.url),visualVariables:g.clone(this.visualVariables)})};c.prototype.getSymbolAsync=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,g,f,h,k,l,n,q,u,r,v,y,x,z,A,C,E,B,D,da,W,ea,pa,qa,oa,ra,va=this;return e.__generator(this,function(e){switch(e.label){case 0:this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(b)),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this._dictionaryPromise];case 2:return c=
e.sent(),[3,4];case 3:return g=e.sent(),d.isAbortError(g)?(this._dictionaryPromise=null,[2,null]):[3,4];case 4:f={};h=0;for(k=this._symbolAttributes;h<k.length;h++)l=k[h],(n=this.fieldMap[l])&&null!==a.attributes[n]&&void 0!==a.attributes[n]?(q=""+a.attributes[n],f[l]=q):f[l]="";u=c(f,b);if(!u||"string"!==typeof u)return[2,null];r=p.numericHash(u).toString();if(v=this._symbolCache.get(r))return v.catch(function(){va._symbolCache.pop(r)}),[2,v];y=u.split(";");x=[];z=[];A=0;for(C=y;A<C.length;A++)if((E=
C[A])&&0!==E.length)if(-1!==E.indexOf("po:"))B=E.substr(3).split("|"),3===B.length&&(D=B[0],da=B[1],W=B[2],"DashTemplate"===da?W=W.split(" ").map(function(a){return Number(a)}):"Color"===da?(ea=(new m(W)).toRgba(),W=[ea[0],ea[1],ea[2],255*ea[3]]):W=Number(W),z.push({primitiveName:D,propertyName:da,value:W}));else if(-1!==E.indexOf("|"))for(pa=0,qa=E.split("|");pa<qa.length;pa++)oa=qa[pa],this._itemNames.has(oa)&&x.push(oa);else this._itemNames.has(E)&&x.push(E);ra=this._cimPartsToCIMSymbol(x,z,b);
this._symbolCache.put(r,ra,1);return[2,ra]}})})};c.prototype.collectRequiredFields=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var d,c;return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.collectVVRequiredFields(a,b)];case 1:return e.sent(),this.scaleExpression?[4,q.collectArcadeFieldNames(a,b,this.scaleExpression)]:[3,3];case 2:e.sent(),e.label=3;case 3:d=b.map(function(a){return a.name});for(c in this.fieldMap)0>d.indexOf(this.fieldMap[c])||a.add(this.fieldMap[c]);
return[2]}})})};Object.defineProperty(c.prototype,"arcadeRequired",{get:function(){return!0},enumerable:!0,configurable:!0});c.prototype.fetchResources=function(a){return e.__awaiter(this,void 0,void 0,function(){var c,g,f,h,m,p,q,u,r,y,x,A,C,B,D,X,V;return e.__generator(this,function(E){switch(E.label){case 0:if(!this.url)return z.error("no valid URL!"),[2,void 0];c=b.isSome(a)?a.abortOptions:null;g=k(this.url+"/resources/styles/dictionary-info.json",e.__assign({responseType:"json",query:{f:"json"}},
c));return[4,d.all([g,v.loadArcade()])];case 1:f=E.sent()[0].data;if(!f)throw new l("esri.renderers.DictionaryRenderer","Bad dictionary data!");h=f.expression;m=f.authoringInfo;this._refSymbolUrlTemplate=this.url+"/"+f.cimRefTemplateUrl;this._itemNames=n.SetFromValues(f.itemsNames);this._symbolAttributes=m.symbol;p={};if(this.config)for(u in q=this.config,q)p[u]=q[u];r=0;for(y=m.configuration;r<y.length;r++)u=y[r],p.hasOwnProperty(u.name)||(p[u.name]=u.value);x=[];if(b.isSome(a)&&a.fields)for(A=function(b){var d=
C.fieldMap[b],c=a.fields.filter(function(a){return a.name===d});0<c.length&&x.push(e.__assign(e.__assign({},c[0]),{name:b}))},C=this,B=0,D=this._symbolAttributes;B<D.length;B++)u=D[B],A(u);return[4,v.createDictionaryExpression(h,b.isSome(a)?a.spatialReference:null,x,p)];case 2:return X=E.sent(),V={scale:0},[2,function(a,d){a=X.repurposeFeature({geometry:null,attributes:a});V.scale=b.isSome(d)?d.scale:void 0;return X.evaluate({$feature:a,$view:V})}]}})})};c.prototype.getSymbol=function(){return null};
c.prototype.getSymbols=function(){return[]};c.prototype.getAttributeHash=function(){return this.visualVariables&&this.visualVariables.reduce(function(a,b){return a+b.getAttributeHash()},"")};c.prototype.getMeshHash=function(){return this.url+"-"+JSON.stringify(this.fieldMap)};c.prototype._getSymbolPart=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,g,f,h;return e.__generator(this,function(l){switch(l.label){case 0:if(this._ongoingRequests.has(a))return[2,this._ongoingRequests.get(a).then(function(a){return a.data})];
c=this._refSymbolUrlTemplate.replace(/\{itemName\}/gi,a);g=k(c,e.__assign({responseType:"json",query:{f:"json"}},b));this._ongoingRequests.set(a,g);l.label=1;case 1:return l.trys.push([1,3,,4]),[4,g];case 2:return f=l.sent(),[2,f.data];case 3:return h=l.sent(),this._ongoingRequests.delete(a),[2,d.reject(h)];case 4:return[2]}})})};c.prototype._combineSymbolParts=function(a,b){var d;if(!a||0===a.length)return null;if(1===a.length)return{type:"CIMSymbolReference",symbol:a[0],primitiveOverrides:b};var c=
e.__assign({},a[0]);c.symbolLayers=[];for(var g=0;g<a.length;g++){var f=a[g];(d=c.symbolLayers).unshift.apply(d,f.symbolLayers)}return{type:"CIMSymbolReference",symbol:c,primitiveOverrides:b}};c.prototype._cimPartsToCIMSymbol=function(a,b,c){return e.__awaiter(this,void 0,void 0,function(){var g,f,h;return e.__generator(this,function(e){switch(e.label){case 0:g=Array(a.length);for(f=0;f<a.length;f++)g[f]=this._getSymbolPart(a[f],c);return[4,d.all(g)];case 1:return h=e.sent(),[2,new y({data:this._combineSymbolParts(h,
b)})]}})})};var f;e.__decorate([r.property({type:Object,json:{write:!0}})],c.prototype,"config",void 0);e.__decorate([r.property({type:String,json:{write:!0}})],c.prototype,"description",void 0);e.__decorate([r.property({type:Object,json:{write:!0}})],c.prototype,"fieldMap",void 0);e.__decorate([r.property({type:String,json:{write:!0}})],c.prototype,"label",void 0);e.__decorate([r.property({type:String,json:{write:!0}})],c.prototype,"scaleExpression",void 0);e.__decorate([r.property({type:String,
json:{write:!0}})],c.prototype,"url",void 0);return c=f=e.__decorate([r.subclass("esri.renderers.DictionaryRenderer")],c)}(u.VisualVariablesMixin(x))})},"esri/core/LRUCache":function(){define(["require","exports","./MemCache"],function(f,a,e){return function(){function a(a,f){this._storage=new e.MemCacheStorage;this._storage.maxSize=a;f&&this._storage.registerRemoveFunc("",f)}a.prototype.put=function(a,e,g){this._storage.put(a,e,g,1)};a.prototype.pop=function(a){return this._storage.pop(a)};a.prototype.get=
function(a){return this._storage.get(a)};a.prototype.clear=function(){this._storage.clearAll()};a.prototype.destroy=function(){this._storage.clearAll()};Object.defineProperty(a.prototype,"maxSize",{get:function(){return this._storage.maxSize},set:function(a){this._storage.maxSize=a},enumerable:!0,configurable:!0});return a}()})},"esri/core/MemCache":function(){define(["require","exports","./MapUtils","./PooledArray","./string"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});
a.MIN_PRIORITY=-3;f=function(){function a(a,c,e){this._namespace=a;this._storage=c;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);this._namespace+=":";e&&(this._storage.registerRemoveFunc(this._namespace,e),this._removeFunc=!0)}Object.defineProperty(a.prototype,"namespace",{get:function(){return this._namespace.slice(0,-1)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hitRate",{get:function(){return this._hit/(this._hit+this._miss)},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"size",{get:function(){return this._storage.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"maxSize",{get:function(){return this._storage.maxSize},enumerable:!0,configurable:!0});a.prototype.resetHitRate=function(){this._hit=this._miss=0};a.prototype.destroy=function(){this._storage.clear(this._namespace);this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace);this._storage.deregister(this)};a.prototype.put=function(a,c,e,b){void 0===
b&&(b=0);this._storage.put(this._namespace+a,c,e,b)};a.prototype.get=function(a){a=this._storage.get(this._namespace+a);void 0===a?++this._miss:++this._hit;return a};a.prototype.pop=function(a){a=this._storage.pop(this._namespace+a);void 0===a?++this._miss:++this._hit;return a};a.prototype.updateSize=function(a,c,e){this._storage.updateSize(this._namespace+a,c,e)};a.prototype.clear=function(){this._storage.clear(this._namespace)};a.prototype.clearAll=function(){this._storage.clearAll()};a.prototype.getStats=
function(){return this._storage.getStats()};a.prototype.resetStats=function(){this._storage.resetStats()};return a}();a.MemCache=f;f=function(){function f(a){void 0===a&&(a=10485760);this._maxSize=a;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=[];this._users=new m}f.prototype.register=function(a){this._users.push(a)};f.prototype.deregister=function(a){this._users.removeUnordered(a)};f.prototype.registerRemoveFunc=function(a,c){this._removeFuncs.push([a,c])};f.prototype.deregisterRemoveFunc=
function(a){this._removeFuncs=this._removeFuncs.filter(function(c){return c[0]!==a})};Object.defineProperty(f.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"maxSize",{get:function(){return this._maxSize},set:function(a){this._maxSize=Math.max(a,0);this._checkSizeLimit()},enumerable:!0,configurable:!0});f.prototype.put=function(e,c,f,b){var d=this._db.get(e);d&&(this._size-=d.size,this._db.delete(e),d.entry!==c&&this._notifyRemoved(e,
d.entry));f>this._maxSize?this._notifyRemoved(e,c):void 0===c?console.warn("Refusing to cache undefined entry "):!f||0>f?console.warn("Refusing to cache entry with invalid size "+f):(b=1+Math.max(b,a.MIN_PRIORITY)-a.MIN_PRIORITY,this._db.set(e,{entry:c,size:f,lifetime:b,lives:b}),this._size+=f,this._checkSizeLimit())};f.prototype.updateSize=function(a,c,e){var b=this._db.get(a);b&&b.entry===c&&(this._size-=b.size,e>this._maxSize?this._notifyRemoved(a,c):(b.size=e,this._size+=e,this._checkSizeLimit()))};
f.prototype.pop=function(a){var c=this._db.get(a);if(c)return this._size-=c.size,this._db.delete(a),++this._hit,c.entry;++this._miss};f.prototype.get=function(a){var c=this._db.get(a);if(void 0===c)++this._miss;else return this._db.delete(a),c.lives=c.lifetime,this._db.set(a,c),++this._hit,c.entry};f.prototype.getStats=function(){var e=this,c={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},
f={},b=[];this._db.forEach(function(a,d){var c=a.lifetime;b[c]=(b[c]||0)+a.size;e._users.forEach(function(b){b=b.namespace;k.startsWith(d,b)&&(f[b]=(f[b]||0)+a.size)})});var d={};this._users.forEach(function(a){var b=a.namespace;!isNaN(a.hitRate)&&0<a.hitRate?(f[b]=f[b]||0,d[b]=Math.round(100*a.hitRate)+"%"):d[b]="0%"});var l=Object.keys(f);l.forEach(function(a){return f[a]=f[a]/e._size*100});l.sort(function(a,b){return f[b]-f[a]});l.forEach(function(a){return c[a]=Math.round(f[a])+"% / "+d[a]});
for(l=b.length-1;0<=l;--l){var m=b[l];m&&(c["Priority "+(l+a.MIN_PRIORITY-1)]=Math.round(m/this.size*100)+"%")}return c};f.prototype.resetStats=function(){this._hit=this._miss=0;this._users.forEach(function(a){return a.resetHitRate()})};f.prototype.clear=function(a){var c=this;this._db.forEach(function(e,b){k.startsWith(b,a)&&(c._size-=e.size,c._db.delete(b),c._notifyRemoved(b,e.entry))})};f.prototype.clearAll=function(){var a=this;this._db.forEach(function(c,e){a._notifyRemoved(e,c.entry)});this._size=
0;this._db.clear()};f.prototype._getHitRate=function(){return this._hit/(this._hit+this._miss)};f.prototype._notifyRemoved=function(a,c){this._removeFuncs.forEach(function(e){if(k.startsWith(a,e[0]))e[1](c)})};f.prototype._checkSizeLimit=function(){var a=this;this._size<=this._maxSize||e.someMap(this._db,function(c,e){a._db.delete(e);1>=c.lives?(a._size-=c.size,a._notifyRemoved(e,c.entry)):(--c.lives,a._db.set(e,c));return a._size<=.9*a.maxSize})};return f}();a.MemCacheStorage=f})},"esri/renderers/DotDensityRenderer":function(){define("require exports tslib ../Color ../core/lang ../core/accessorSupport/decorators ../layers/support/fieldUtils ./Renderer ./mixins/VisualVariablesMixin ./support/AttributeColorInfo ./support/DotDensityLegendOptions ../symbols/SimpleFillSymbol ../symbols/SimpleLineSymbol".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p){return function(a){function c(b){b=a.call(this,b)||this;b.attributes=null;b.backgroundColor=new m([0,0,0,0]);b.blendDots=!0;b.dotBlendingEnabled=!0;b.dotShape="square";b.dotSize=1;b.legendOptions=null;b.outline=new p;b.dotValue=null;b.referenceDotValue=null;b.referenceScale=null;b.seed=1;b.type="dot-density";return b}e.__extends(c,a);f=c;c.prototype.calculateDotValue=function(a){if(null==this.referenceScale)return this.dotValue;a=a/this.referenceScale*this.dotValue;
return 1>a?1:a};c.prototype.getSymbol=function(){return new n({outline:this.outline})};c.prototype.getSymbolAsync=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(a){return[2,this.getSymbol()]})})};c.prototype.getSymbols=function(){return[this.getSymbol()]};c.prototype.getAttributeHash=function(){return this.attributes&&this.attributes.reduce(function(a,b){return a+b.getAttributeHash()},"")};c.prototype.getMeshHash=function(){return JSON.stringify(this.outline)};
c.prototype.clone=function(){return new f({attributes:k.clone(this.attributes),backgroundColor:k.clone(this.backgroundColor),dotBlendingEnabled:k.clone(this.dotBlendingEnabled),dotShape:k.clone(this.dotShape),dotSize:k.clone(this.dotSize),dotValue:k.clone(this.dotValue),legendOptions:k.clone(this.legendOptions),outline:k.clone(this.outline),referenceScale:k.clone(this.referenceScale),visualVariables:k.clone(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})};c.prototype.getControllerHash=
function(){var a=this.attributes.map(function(a){return a.field||a.valueExpression||""}),b=this.outline&&JSON.stringify(this.outline.toJSON())||"";return a+"-"+b};c.prototype.collectRequiredFields=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d,f;return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.collectVVRequiredFields(a,b)];case 1:e.sent(),c=0,d=this.attributes,e.label=2;case 2:if(!(c<d.length))return[3,6];f=d[c];return f.valueExpression?[4,g.collectArcadeFieldNames(a,
b,f.valueExpression)]:[3,4];case 3:e.sent(),e.label=4;case 4:f.field&&a.add(f.field),e.label=5;case 5:return c++,[3,2];case 6:return[2]}})})};var f;e.__decorate([l.property({type:[b],json:{write:!0}})],c.prototype,"attributes",void 0);e.__decorate([l.property({type:m,json:{write:!0}})],c.prototype,"backgroundColor",void 0);e.__decorate([l.property({type:Boolean}),l.aliasOf("dotBlendingEnabled")],c.prototype,"blendDots",void 0);e.__decorate([l.property({type:Boolean,json:{write:!0}})],c.prototype,
"dotBlendingEnabled",void 0);e.__decorate([l.property({type:String,json:{write:!0}})],c.prototype,"dotShape",void 0);e.__decorate([l.property({type:Number,json:{write:!0}})],c.prototype,"dotSize",void 0);e.__decorate([l.property({type:d,json:{write:!0}})],c.prototype,"legendOptions",void 0);e.__decorate([l.property({type:p,json:{default:null,write:!0}})],c.prototype,"outline",void 0);e.__decorate([l.property({type:Number,json:{write:!0}})],c.prototype,"dotValue",void 0);e.__decorate([l.property({type:Number}),
l.aliasOf("dotValue")],c.prototype,"referenceDotValue",void 0);e.__decorate([l.property({type:Number,json:{write:!0}})],c.prototype,"referenceScale",void 0);e.__decorate([l.property({type:Number,json:{write:!0}})],c.prototype,"seed",void 0);e.__decorate([l.enumeration({dotDensity:"dot-density"})],c.prototype,"type",void 0);return c=f=e.__decorate([l.subclass("esri.renderers.DotDensityRenderer")],c)}(h.VisualVariablesMixin(c))})},"esri/renderers/support/AttributeColorInfo":function(){define("require exports tslib ../../Color ../../core/JSONSupport ../../core/Logger ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType".split(" "),
function(f,a,e,m,k,l,g,c){var h=l.getLogger("esri.renderers.support.AttributeColorInfo");return function(a){function b(b){b=a.call(this,b)||this;b.color=null;b.field=null;b.label=null;b.valueExpression=null;b.valueExpressionTitle=null;return b}e.__extends(b,a);f=b;b.prototype.castField=function(a){return null==a?a:"function"===typeof a?(h.error(".field: field must be a string value"),null):c.ensureString(a)};b.prototype.getAttributeHash=function(){return this.field+"-"+this.valueExpression};b.prototype.clone=
function(){return new f({color:this.color&&this.color.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})};var f;e.__decorate([g.property({type:m,json:{type:[Number],write:!0}})],b.prototype,"color",void 0);e.__decorate([g.property({type:String,json:{write:!0}})],b.prototype,"field",void 0);e.__decorate([g.cast("field")],b.prototype,"castField",null);e.__decorate([g.property({type:String,json:{write:!0}})],b.prototype,"label",
void 0);e.__decorate([g.property({type:String,json:{write:!0}})],b.prototype,"valueExpression",void 0);e.__decorate([g.property({type:String,json:{write:!0}})],b.prototype,"valueExpressionTitle",void 0);return b=f=e.__decorate([g.subclass("esri.renderers.support.AttributeColorInfo")],b)}(k.JSONSupport)})},"esri/renderers/support/DotDensityLegendOptions":function(){define(["require","exports","tslib","../../core/JSONSupport","../../core/accessorSupport/decorators"],function(f,a,e,m,k){return function(a){function g(){var c=
null!==a&&a.apply(this,arguments)||this;c.unit=null;return c}e.__extends(g,a);c=g;g.prototype.clone=function(){return new c({unit:this.unit})};var c;e.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"unit",void 0);return g=c=e.__decorate([k.subclass("esri.renderers.support.DotDensityLegendOptions")],g)}(m.JSONSupport)})},"esri/renderers/HeatmapRenderer":function(){define("require exports tslib ../Color ../core/lang ../core/accessorSupport/decorators ../layers/support/fieldUtils ./Renderer ./support/HeatmapColorStop".split(" "),
function(f,a,e,m,k,l,g,c,h){return function(a){function b(b){b=a.call(this,b)||this;b.blurRadius=10;b.colorStops=[new h({ratio:0,color:new m("rgba(255, 140, 0, 0)")}),new h({ratio:.75,color:new m("rgba(255, 140, 0, 1)")}),new h({ratio:.9,color:new m("rgba(255, 0,   0, 1)")})];b.field=null;b.fieldOffset=0;b.maxPixelIntensity=100;b.minPixelIntensity=0;b.type="heatmap";return b}e.__extends(b,a);c=b;b.prototype.collectRequiredFields=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c;
return e.__generator(this,function(d){(c=this.field)&&"string"===typeof c&&g.collectField(a,b,c);return[2]})})};b.prototype.getAttributeHash=function(){return null};b.prototype.getMeshHash=function(){return JSON.stringify(this.colorStops)+"."+this.blurRadius+"."+this.field};b.prototype.clone=function(){return new c({blurRadius:this.blurRadius,colorStops:k.clone(this.colorStops),field:this.field,maxPixelIntensity:this.maxPixelIntensity,minPixelIntensity:this.minPixelIntensity})};var c;e.__decorate([l.property({type:Number,
json:{write:!0}})],b.prototype,"blurRadius",void 0);e.__decorate([l.property({type:[h],json:{write:!0}})],b.prototype,"colorStops",void 0);e.__decorate([l.property({type:String,json:{write:!0}})],b.prototype,"field",void 0);e.__decorate([l.property({type:Number,json:{write:{overridePolicy:function(a,b,c){return{enabled:null==c}}}}})],b.prototype,"fieldOffset",void 0);e.__decorate([l.property({type:Number,json:{write:!0}})],b.prototype,"maxPixelIntensity",void 0);e.__decorate([l.property({type:Number,
json:{write:!0}})],b.prototype,"minPixelIntensity",void 0);e.__decorate([l.enumeration({heatmap:"heatmap"})],b.prototype,"type",void 0);return b=c=e.__decorate([l.subclass("esri.renderers.HeatmapRenderer")],b)}(c)})},"esri/renderers/support/HeatmapColorStop":function(){define("require exports tslib ../../Color ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(f,a,e,m,k,l){return function(a){function c(b){b=a.call(this,b)||this;b.color=null;b.ratio=null;return b}e.__extends(c,
a);g=c;c.prototype.clone=function(){return new g({color:this.color,ratio:this.ratio})};var g;e.__decorate([l.property({type:m,json:{write:!0}})],c.prototype,"color",void 0);e.__decorate([l.property({type:Number,json:{write:!0}})],c.prototype,"ratio",void 0);return c=g=e.__decorate([l.subclass("esri.renderers.support.HeatmapColorStop")],c)}(k.JSONSupport)})},"esri/renderers/SimpleRenderer":function(){define("require exports tslib ../symbols ../core/lang ../core/promiseUtils ../core/accessorSupport/decorators ./Renderer ./mixins/VisualVariablesMixin ../symbols/support/jsonUtils".split(" "),
function(f,a,e,m,k,l,g,c,h,b){return function(a){function c(b){b=a.call(this,b)||this;b.description=null;b.label=null;b.symbol=null;b.type="simple";return b}e.__extends(c,a);d=c;c.prototype.writeSymbolWebScene=function(a,c,d,e){b.writeTarget(a,c,d,e)};c.prototype.writeSymbol=function(a,c,d,e){b.writeTarget(a,c,d,e)};c.prototype.readSymbol=function(a,c,d){return b.read(a,c,d)};c.prototype.collectRequiredFields=function(a,b){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,
function(c){switch(c.label){case 0:return[4,l.all([this.collectSymbolFields(a,b),this.collectVVRequiredFields(a,b)])];case 1:return c.sent(),[2]}})})};c.prototype.collectSymbolFields=function(a,b){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(c){switch(c.label){case 0:return[4,l.all(this.getSymbols().map(function(c){return c.collectRequiredFields(a,b)}))];case 1:return c.sent(),[2]}})})};c.prototype.getSymbol=function(a,b){return this.symbol};c.prototype.getSymbolAsync=
function(a,b){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(a){return[2,this.symbol]})})};c.prototype.getSymbols=function(){return this.symbol?[this.symbol]:[]};c.prototype.getAttributeHash=function(){return this.visualVariables&&this.visualVariables.reduce(function(a,b){return a+b.getAttributeHash()},"")};c.prototype.getMeshHash=function(){return this.getSymbols().reduce(function(a,b){return a+=JSON.stringify(b)},"")};Object.defineProperty(c.prototype,"arcadeRequired",
{get:function(){return this.arcadeRequiredForVisualVariables},enumerable:!0,configurable:!0});c.prototype.clone=function(){return new d({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:k.clone(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})};var d;e.__decorate([g.property({type:String,json:{write:!0}})],c.prototype,"description",void 0);e.__decorate([g.property({type:String,json:{write:!0}})],c.prototype,"label",
void 0);e.__decorate([g.property({types:m.symbolTypesRenderer})],c.prototype,"symbol",void 0);e.__decorate([g.writer("web-scene","symbol",{symbol:{types:m.symbolTypesRenderer3D}})],c.prototype,"writeSymbolWebScene",null);e.__decorate([g.writer("symbol")],c.prototype,"writeSymbol",null);e.__decorate([g.reader("symbol")],c.prototype,"readSymbol",null);e.__decorate([g.enumeration({simple:"simple"})],c.prototype,"type",void 0);return c=d=e.__decorate([g.subclass("esri.renderers.SimpleRenderer")],c)}(h.VisualVariablesMixin(c))})},
"esri/renderers/UniqueValueRenderer":function(){define("require exports tslib ../symbols ../symbols ../core/arrayUtils ../core/Error ../core/lang ../core/Logger ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators ../core/accessorSupport/diffUtils ../core/accessorSupport/ensureType ../layers/support/fieldUtils ../portal/Portal ./Renderer ./mixins/VisualVariablesMixin ./support/LegendOptions ./support/UniqueValueInfo ../support/arcadeOnDemand ../support/persistableUrlUtils ../symbols/support/jsonUtils ../symbols/support/styleUtils".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u,v,y,z,A,B,D,C){var E=h.getLogger("esri.renderers.UniqueValueRenderer"),F=r.ensureType(z);return function(a){function f(b){b=a.call(this,b)||this;b._valueInfoMap={};b._isDefaultSymbolDerived=!1;b.type="unique-value";b.backgroundFillSymbol=null;b.field=null;b.field2=null;b.field3=null;b.valueExpression=null;b.valueExpressionTitle=null;b.legendOptions=null;b.defaultLabel=null;b.fieldDelimiter=null;b.portal=null;b.styleOrigin=null;b.diff={uniqueValueInfos:function(a,
b){if(a||b){if(!a||!b)return{type:"complete",oldValue:a,newValue:b};for(var c=!1,d={type:"collection",added:[],removed:[],changed:[],unchanged:[]},e=function(e){var g=l.find(a,function(a){return a.value===b[e].value});g?p.diff(g,b[e])?(d.changed.push({type:"complete",oldValue:g,newValue:b[e]}),c=!0):d.unchanged.push({oldValue:g,newValue:b[e]}):(d.added.push(b[e]),c=!0)},g=0;g<b.length;g++)e(g);e=function(e){l.find(b,function(b){return b.value===a[e].value})||(d.removed.push(a[e]),c=!0)};for(g=0;g<
a.length;g++)e(g);return c?d:void 0}}};b._set("uniqueValueInfos",[]);return b}e.__extends(f,a);h=f;Object.defineProperty(f.prototype,"_cache",{get:function(){return{compiledFunc:null}},enumerable:!0,configurable:!0});f.prototype.writeBackgroundFillSymbolWebScene=function(a,b,c,d){D.writeTarget(a,b,c,d)};f.prototype.castField=function(a){return null==a||"function"===typeof a?a:r.ensureString(a)};f.prototype.writeField=function(a,b,c,d){"string"===typeof a?b[c]=a:d&&d.messages?d.messages.push(new g("property:unsupported",
"UniqueValueRenderer.field set to a function cannot be written to JSON")):E.error(".field: cannot write field to JSON since it's not a string value")};Object.defineProperty(f.prototype,"defaultSymbol",{set:function(a){this._isDefaultSymbolDerived=!1;this._set("defaultSymbol",a)},enumerable:!0,configurable:!0});f.prototype.readDefaultSymbol=function(a,b,c){return D.read(a,b,c)};f.prototype.writeDefaultSymbolWebScene=function(a,b,c,d){this._isDefaultSymbolDerived||D.writeTarget(a,b,c,d)};f.prototype.writeDefaultSymbol=
function(a,b,c,d){this._isDefaultSymbolDerived||D.writeTarget(a,b,c,d)};f.prototype.readPortal=function(a,b,c){return c.portal||x.getDefault()};f.prototype.readStyleOrigin=function(a,b,c){if(b.styleName)return Object.freeze({styleName:b.styleName});if(b.styleUrl)return a=B.fromJSON(b.styleUrl,c),Object.freeze({styleUrl:a})};f.prototype.writeStyleOrigin=function(a,b,c,d){a.styleName?b.styleName=a.styleName:a.styleUrl&&(b.styleUrl=B.toJSON(a.styleUrl,d))};Object.defineProperty(f.prototype,"uniqueValueInfos",
{set:function(a){this.styleOrigin?E.error("#uniqueValueInfos\x3d","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",a),this._updateValueInfoMap())},enumerable:!0,configurable:!0});f.prototype.addUniqueValueInfo=function(a,b){this.styleOrigin?E.error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(a="object"===typeof a?F(a):new z({value:a,symbol:k.ensureType(b)}),this.uniqueValueInfos.push(a),
this._valueInfoMap[a.value]=a)};f.prototype.removeUniqueValueInfo=function(a){if(this.styleOrigin)E.error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");else for(var b=0;b<this.uniqueValueInfos.length;b++)if(this.uniqueValueInfos[b].value===a+""){delete this._valueInfoMap[a];this.uniqueValueInfos.splice(b,1);break}};f.prototype.getUniqueValueInfo=function(a,c){return e.__awaiter(this,void 0,void 0,function(){var d,g,f;return e.__generator(this,
function(h){switch(h.label){case 0:d=c;if(!this.valueExpression||!b.isNone(c)&&!b.isNone(c.arcade))return[3,2];g=[e.__assign({},d)];f={};return[4,A.loadArcade()];case 1:d=e.__assign.apply(void 0,g.concat([(f.arcade=h.sent(),f)])),h.label=2;case 2:return[2,this._getUniqueValueInfo(a,d)]}})})};f.prototype.getSymbol=function(a,c){if(this.valueExpression&&(b.isNone(c)||b.isNone(c.arcade)))E.error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");else return(a=this._getUniqueValueInfo(a,
c))&&a.symbol||this.defaultSymbol};f.prototype.getSymbolAsync=function(a,c){return e.__awaiter(this,void 0,void 0,function(){var d,g,f,h;return e.__generator(this,function(k){switch(k.label){case 0:d=c;if(!this.valueExpression||!b.isNone(d)&&!b.isNone(d.arcade))return[3,2];g=[e.__assign({},d)];f={};return[4,A.loadArcade()];case 1:d=e.__assign.apply(void 0,g.concat([(f.arcade=k.sent(),f)])),k.label=2;case 2:return h=this._getUniqueValueInfo(a,d),[2,h&&h.symbol||this.defaultSymbol]}})})};f.prototype.getSymbols=
function(){for(var a=[],b=0,c=this.uniqueValueInfos;b<c.length;b++){var d=c[b];d.symbol&&a.push(d.symbol)}this.defaultSymbol&&a.push(this.defaultSymbol);return a};f.prototype.getAttributeHash=function(){return this.visualVariables&&this.visualVariables.reduce(function(a,b){return a+b.getAttributeHash()},"")};f.prototype.getMeshHash=function(){var a=JSON.stringify(this.backgroundFillSymbol),b=JSON.stringify(this.defaultSymbol),c=this.uniqueValueInfos.reduce(function(a,b){return a+b.getMeshHash()},
"");return a+"."+b+"."+c+"."+(this.field+"."+this.field2+"."+this.field3+"."+this.fieldDelimiter)+"."+this.valueExpression};f.prototype.clone=function(){var a=new h({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:c.clone(this.defaultSymbol),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:c.clone(this.visualVariables),legendOptions:c.clone(this.legendOptions),
authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),backgroundFillSymbol:c.clone(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(a._isDefaultSymbolDerived=!0);a._set("portal",this.portal);var b=c.clone(this.uniqueValueInfos);this.styleOrigin&&(a._set("styleOrigin",Object.freeze(c.clone(this.styleOrigin))),Object.freeze(b));a._set("uniqueValueInfos",b);a._updateValueInfoMap();return a};Object.defineProperty(f.prototype,"arcadeRequired",{get:function(){return this.arcadeRequiredForVisualVariables||
!!this.valueExpression},enumerable:!0,configurable:!0});f.prototype.collectRequiredFields=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c;return e.__generator(this,function(e){switch(e.label){case 0:return c=[this.collectVVRequiredFields(a,b),this.collectSymbolFields(a,b)],[4,d.all(c)];case 1:return e.sent(),[2]}})})};f.prototype.collectSymbolFields=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c;return e.__generator(this,function(g){switch(g.label){case 0:return c=
e.__spreadArrays(this.getSymbols().map(function(c){return c.collectRequiredFields(a,b)}),[q.collectArcadeFieldNames(a,b,this.valueExpression)]),q.collectField(a,b,this.field),q.collectField(a,b,this.field2),q.collectField(a,b,this.field3),[4,d.all(c)];case 1:return g.sent(),[2]}})})};f.prototype.populateFromStyle=function(){var a=this;return C.fetchStyle(this.styleOrigin,{portal:this.portal}).then(function(b){var c=[];a._valueInfoMap={};b&&b.data&&Array.isArray(b.data.items)&&b.data.items.forEach(function(d){var e=
new m.WebStyleSymbol({styleUrl:b.styleUrl,styleName:b.styleName,portal:a.portal,name:d.name});a.defaultSymbol||d.name!==b.data.defaultItem||(a.defaultSymbol=e,a._isDefaultSymbolDerived=!0);e=new z({value:d.name,symbol:e});c.push(e);a._valueInfoMap[d.name]=e});a._set("uniqueValueInfos",Object.freeze(c));!a.defaultSymbol&&a.uniqueValueInfos.length&&(a.defaultSymbol=a.uniqueValueInfos[0].symbol,a._isDefaultSymbolDerived=!0);return a})};f.prototype._updateValueInfoMap=function(){var a=this;this._valueInfoMap=
{};this.uniqueValueInfos.forEach(function(b){return a._valueInfoMap[b.value+""]=b})};f.prototype._getUniqueValueInfo=function(a,b){return this.valueExpression?this._getUnqiueValueInfoForExpression(a,b):this._getUnqiueValueInfoForFields(a)};f.prototype._getUnqiueValueInfoForExpression=function(a,c){var d=b.unwrapOr(c,{});c=d.viewingMode;var e=d.scale,g=d.spatialReference,f=this._cache.compiledFunc,d=b.unwrap(d.arcade).arcadeUtils;f||(f=d.createSyntaxTree(this.valueExpression),f=d.createFunction(f),
this._cache.compiledFunc=f);a=d.executeFunction(f,d.createExecContext(a,d.getViewInfo({viewingMode:c,scale:e,spatialReference:g})));return this._valueInfoMap[a+""]};f.prototype._getUnqiueValueInfoForFields=function(a){var b=this.field,c=a.attributes,d;if("function"!==typeof b&&this.field2){a=this.field2;d=this.field3;var e=[];b&&e.push(c[b]);a&&e.push(c[a]);d&&e.push(c[d]);d=e.join(this.fieldDelimiter||"")}else"function"===typeof b?d=b(a):b&&(d=c[b]);return this._valueInfoMap[d+""]};f.fromPortalStyle=
function(a,b){var c=new h(b&&b.properties);c._set("styleOrigin",Object.freeze({styleName:a}));c._set("portal",b&&b.portal||x.getDefault());b=c.populateFromStyle();b.catch(function(b){E.error("#fromPortalStyle('"+a+"'[, ...])","Failed to create unique value renderer from style name",b)});return b};f.fromStyleUrl=function(a,b){b=new h(b&&b.properties);b._set("styleOrigin",Object.freeze({styleUrl:a}));b=b.populateFromStyle();b.catch(function(b){E.error("#fromStyleUrl('"+a+"'[, ...])","Failed to create unique value renderer from style URL",
b)});return b};var h;e.__decorate([n.property({readOnly:!0,dependsOn:["valueExpression"]})],f.prototype,"_cache",null);e.__decorate([n.enumeration({uniqueValue:"unique-value"})],f.prototype,"type",void 0);e.__decorate([n.property({types:{base:m.BaseSymbol,key:"type",typeMap:{"simple-fill":k.symbolTypesRenderer.typeMap["simple-fill"],"picture-fill":k.symbolTypesRenderer.typeMap["picture-fill"],"polygon-3d":k.symbolTypesRenderer.typeMap["polygon-3d"]}},json:{read:D.read,write:D.writeTarget}})],f.prototype,
"backgroundFillSymbol",void 0);e.__decorate([n.writer("web-scene","backgroundFillSymbol",{backgroundFillSymbol:{type:m.PolygonSymbol3D}})],f.prototype,"writeBackgroundFillSymbolWebScene",null);e.__decorate([n.property({json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],f.prototype,"field",void 0);e.__decorate([n.cast("field")],f.prototype,"castField",null);e.__decorate([n.writer("field")],f.prototype,"writeField",null);e.__decorate([n.property({type:String,json:{write:!0}})],f.prototype,
"field2",void 0);e.__decorate([n.property({type:String,json:{write:!0}})],f.prototype,"field3",void 0);e.__decorate([n.property({type:String,json:{write:!0}})],f.prototype,"valueExpression",void 0);e.__decorate([n.property({type:String,json:{write:!0}})],f.prototype,"valueExpressionTitle",void 0);e.__decorate([n.property({type:y.default,json:{write:!0}})],f.prototype,"legendOptions",void 0);e.__decorate([n.property({type:String,json:{write:!0}})],f.prototype,"defaultLabel",void 0);e.__decorate([n.property({types:k.symbolTypesRenderer})],
f.prototype,"defaultSymbol",null);e.__decorate([n.reader("defaultSymbol")],f.prototype,"readDefaultSymbol",null);e.__decorate([n.writer("web-scene","defaultSymbol",{defaultSymbol:{types:k.symbolTypesRenderer3D}})],f.prototype,"writeDefaultSymbolWebScene",null);e.__decorate([n.writer("defaultSymbol")],f.prototype,"writeDefaultSymbol",null);e.__decorate([n.property({type:String,json:{write:!0}})],f.prototype,"fieldDelimiter",void 0);e.__decorate([n.property({type:x,readOnly:!0})],f.prototype,"portal",
void 0);e.__decorate([n.reader("portal",["styleName"])],f.prototype,"readPortal",null);e.__decorate([n.property({readOnly:!0,json:{write:{enabled:!1,overridePolicy:function(){return{enabled:!0}}}}})],f.prototype,"styleOrigin",void 0);e.__decorate([n.reader("styleOrigin",["styleName","styleUrl"])],f.prototype,"readStyleOrigin",null);e.__decorate([n.writer("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],f.prototype,"writeStyleOrigin",null);e.__decorate([n.property({type:[z],json:{write:{overridePolicy:function(){return this.styleOrigin?
{enabled:!1}:{enabled:!0}}}}})],f.prototype,"uniqueValueInfos",null);return f=h=e.__decorate([n.subclass("esri.renderers.UniqueValueRenderer")],f)}(v.VisualVariablesMixin(u))})},"esri/core/accessorSupport/diffUtils":function(){define("require exports ../Accessor ../Collection ../maybe ./utils".split(" "),function(f,a,e,m,k,l){function g(a){return a instanceof m?Object.keys(a.items):a instanceof e?l.getProperties(a).keys():a?Object.keys(a):[]}function c(a,b){return a instanceof m?a.items[b]:a[b]}function h(a,
b){return Array.isArray(a)&&Array.isArray(b)?a.length!==b.length:!1}function b(a){return a?a.declaredClass:null}function d(a,f){var l,m=a.diff;if(m&&"function"===typeof m)return m(a,f);var n=g(a),q=g(f);if(0!==n.length||0!==q.length){if(!n.length||!q.length||h(a,f))return{type:"complete",oldValue:a,newValue:f};var r=q.filter(function(a){return-1===n.indexOf(a)}),A=n.filter(function(a){return-1===q.indexOf(a)}),r=n.filter(function(b){return-1<q.indexOf(b)&&c(a,b)!==c(f,b)}).concat(r,A).sort();if((A=
b(a))&&-1<p.indexOf(A)&&r.length)return{type:"complete",oldValue:a,newValue:f};for(var B,A=a instanceof e&&f instanceof e,D=0;D<r.length;D++){var C=r[D],E=c(a,C),F=c(f,C),I=void 0;!(A||"function"!==typeof E&&"function"!==typeof F)||E===F||null==E&&null==F||(I=m&&m[C]&&"function"===typeof m[C]?m[C](E,F):"object"===typeof E&&"object"===typeof F&&b(E)===b(F)?d(E,F):{type:"complete",oldValue:E,newValue:F},k.isSome(I)&&(k.isSome(B)?B.diff[C]=I:B={type:"partial",diff:(l={},l[C]=I,l)}))}return B}}function n(a){if(k.isNone(a))return!0;
switch(a.type){case "complete":return!1;case "collection":for(var b=0,c=a.added;b<c.length;b++){var d=c[b];if(!n(d))return!1}b=0;for(c=a.removed;b<c.length;b++)if(d=c[b],!n(d))return!1;b=0;for(a=a.changed;b<a.length;b++)if(d=a[b],!n(d))return!1;return!0;case "partial":for(b in a.diff)if(d=a.diff[b],!n(d))return!1;return!0}}Object.defineProperty(a,"__esModule",{value:!0});var p=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];
a.diff=function(a,c){if("function"!==typeof a&&"function"!==typeof c&&(a||c))return!a||!c||"object"===typeof a&&"object"===typeof c&&b(a)!==b(c)?{type:"complete",oldValue:a,newValue:c}:d(a,c)};a.isEmpty=n})},"esri/renderers/support/UniqueValueInfo":function(){define("require exports tslib ../../symbols ../../core/JSONSupport ../../core/accessorSupport/decorators ../../symbols/support/jsonUtils".split(" "),function(f,a,e,m,k,l,g){return function(a){function c(b){b=a.call(this,b)||this;b.description=
null;b.label=null;b.symbol=null;b.value=null;return b}e.__extends(c,a);b=c;c.prototype.clone=function(){return new b({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})};c.prototype.getMeshHash=function(){var a=JSON.stringify(this.symbol&&this.symbol.toJSON());return this.value+"."+a};var b;e.__decorate([l.property({type:String,json:{write:!0}})],c.prototype,"description",void 0);e.__decorate([l.property({type:String,json:{write:!0}})],c.prototype,
"label",void 0);e.__decorate([l.property({types:m.symbolTypesRenderer,json:{origins:{"web-scene":{types:m.symbolTypesRenderer3D,read:g.read,write:g.writeTarget}},read:g.read,write:g.writeTarget}})],c.prototype,"symbol",void 0);e.__decorate([l.property({type:String,json:{write:!0}})],c.prototype,"value",void 0);return c=b=e.__decorate([l.subclass("esri.renderers.support.UniqueValueInfo")],c)}(k.JSONSupport)})},"esri/symbols/support/styleUtils":function(){define("require exports tslib ../../request ../../symbols ../../core/arrayUtils ../../core/devEnvironmentUtils ../../core/Error ../../core/promiseUtils ../../core/urlUtils ../../portal/Portal ../../portal/PortalQueryParams ../../support/featureFlags ../../support/persistableUrlUtils ./jsonUtils ./StyleOrigin ./Thumbnail".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u){function v(a,c){return F(a,c).then(function(c){return{data:c.data,baseUrl:b.removeFile(a),styleUrl:a}})}function y(a,b,c){b=b.portal||d.getDefault();var e,g=b.url+" - "+(b.user&&b.user.username)+" - "+a;I[g]||(I[g]=z(a,b,c).then(function(a){e=a;return a.fetchData()}).then(function(b){return{data:b,baseUrl:e.itemUrl,styleName:a}}));return I[g]}function z(a,b,d){return b.load(d).then(function(){var c=new n({disableExtraQuery:!0,query:"owner:"+J+" AND type:"+
G+' AND typekeywords:"'+a+'"'});return b.queryItems(c,d)}).then(function(b){b=b.results;var e=null,g=a.toLowerCase();if(b&&Array.isArray(b))for(var f=0;f<b.length;f++){var h=b[f];if(h.typeKeywords.some(function(a){return a.toLowerCase()===g})&&h.type===G&&h.owner===J){e=h;break}}if(!e)throw new c("symbolstyleutils:style-not-found","The style '"+a+"' could not be found",{styleName:a});return e.load(d)})}function A(a,b,d){return a.styleUrl?v(a.styleUrl,d):a.styleName?y(a.styleName,b,d):h.reject(new c("symbolstyleutils:style-url-and-name-missing",
"Either styleUrl or styleName is required to resolve a style"))}function B(a,d,e,f,m){var n=a.data,p={portal:e.portal,url:b.urlToObject(a.baseUrl),origin:"portal-item"},n=l.find(n.items,function(a){return a.name===d});if(!n)return h.reject(new c("symbolstyleutils:symbol-name-not-found","The symbol name '"+d+"' could not be found",{symbolName:d}));var v=r.fromJSON(C(n,f),p),y=n.thumbnail&&n.thumbnail.href,z=n.thumbnail&&n.thumbnail.imageData;g.isDevEnvironment()&&(v=g.adjustStaticAGOUrl(v),y=g.adjustStaticAGOUrl(y));
var A={portal:e.portal,url:b.urlToObject(b.removeFile(v)),origin:"portal-item"};return F(v,m).then(function(b){b="cimRef"===f?D(b.data):b.data;if((b=q.fromJSON(b,A))&&k.isSymbol3D(b)){if(y){var c=r.fromJSON(y,p);b.thumbnail=new u.default({url:c})}else z&&(b.thumbnail=new u.default({url:"data:image/png;base64,"+z}));a.styleUrl?b.styleOrigin=new x({portal:e.portal,styleUrl:a.styleUrl,name:d}):a.styleName&&(b.styleOrigin=new x({portal:e.portal,styleName:a.styleName,name:d}))}return b})}function D(a){return null===
a||"CIMSymbolReference"===a.type?a:{type:"CIMSymbolReference",symbol:a}}function C(a,b){if("cimRef"===b)return a.cimRef;if(a.formatInfos&&!p.enableWebStyleForceWOSR()){b=0;for(var c=a.formatInfos;b<c.length;b++){var d=c[b];if("gltf"===d.type)return d.href}}return a.webRef}function E(a,c,d){var e=H.replace(/\{SymbolName\}/gi,a.name);return F(e,d).then(function(a){a=D(a.data);return q.fromJSON(a,{portal:c.portal,url:b.urlToObject(b.removeFile(e)),origin:"portal-item"})})}function F(a,c){c=e.__assign({responseType:"json",
query:{f:"json"}},c);return m(b.normalize(a),c)}Object.defineProperty(a,"__esModule",{value:!0});var I={};a.fetchStyle=A;a.resolveWebStyleSymbol=function(a,b,d,e){return a.name?a.styleName&&"Esri2DPointSymbolsStyle"===a.styleName?E(a,b,e):A(a,b,e).then(function(c){return B(c,a.name,b,d,e)}):h.reject(new c("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))};a.fetchSymbolFromStyle=B;a.styleNameFromItem=function(a){var b=0;for(a=a.typeKeywords;b<a.length;b++){var c=
a[b];if(/^Esri.*Style$/.test(c)&&"Esri Style"!==c)return c}};var J="esri_en",G="Style",H="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f\x3djson"})},"esri/core/devEnvironmentUtils":function(){define(["require","exports","./global"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.isDevEnvironment=function(a){a=a||e.location.hostname;return c.some(function(b){return null!=a.match(b)})};a.adjustStaticAGOUrl=
function(a,b){if(!a)return a;b=b||e.location.hostname;return null!=b.match(m)||null!=b.match(l)?a.replace("static.arcgis.com","staticdev.arcgis.com"):null!=b.match(k)||null!=b.match(g)?a.replace("static.arcgis.com","staticqa.arcgis.com"):a};a.isTelemetryDevEnvironment=function(a){a=a||e.location.hostname;return[/^zrh-.+?\.esri\.com$/].concat(c).some(function(b){return null!=a.match(b)})};var m=/^devext.arcgis.com$/,k=/^qaext.arcgis.com$/,l=/^[\w-]*\.mapsdevext.arcgis.com$/,g=/^[\w-]*\.mapsqa.arcgis.com$/,
c=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,m,k,/^jsapps.esri.com$/,l,g]})},"esri/support/featureFlags":function(){define(["require","exports","../core/has"],function(f,a,e){function m(a,f){return!!e("enable-feature:"+a+"/"+f)}Object.defineProperty(a,"__esModule",{value:!0});a.hasEnableFeature=m;a.enableWebStyleForceWOSR=function(){return m("jschmid","force-wosr")}})},"esri/renderers/support/jsonUtils":function(){define("require exports ../../core/compilerUtils ../../core/Error ../../core/object ../../core/Warning ../ClassBreaksRenderer ../DictionaryRenderer ../DotDensityRenderer ../HeatmapRenderer ../SimpleRenderer ../UniqueValueRenderer".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n){function p(a,b,c){if(!a)return null;if(a&&(a.styleName||a.styleUrl)&&"uniqueValue"!==a.type)return c&&c.messages&&c.messages.push(new l("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+a.type+"'",{definition:a,context:c})),null;b=a?x[a.type]||null:null;if(b)return b=new b,b.read(a,c),b;c&&c.messages&&a&&c.messages.push(new l("renderer:unsupported","Renderers of type '"+(a.type||"unknown")+"' are not supported",{definition:a,
context:c}));return null}function r(a,b){if(!b||"web-scene"!==b.origin)return!0;switch(a.type){case "simple":case "unique-value":case "class-breaks":return!0;case "heatmap":case "dictionary":case "dot-density":return!1;default:return e.neverReached(a),!1}}function q(a,b,c){return a?r(a,c)?a.write(b,c):(c.messages&&c.messages.push(new m("renderer:unsupported","Renderer of type '"+a.declaredClass+"' are not supported in scenes.",{renderer:a,context:c})),null):null}Object.defineProperty(a,"__esModule",
{value:!0});var x={simple:d,uniqueValue:n,classBreaks:g,heatmap:b,dotDensity:h,dictionary:c};a.read=p;a.writeTarget=function(a,b,c,d){(a=q(a,{},d))&&k.setDeepValue(c,a,b)};a.write=q;a.fromJSON=function(a,b){return p(a,null,b)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("require exports tslib ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/mathUtils ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../engine ../../color ../../definitions ../../enums ../../number ../../WGLDisplayRecord ../../collisions/Metric ../../materialKey/MaterialKey ./segmentUtils ./WGLTextTemplate".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u,v,y){function z(a){switch(a){case "above-along":case "below-along":case "center-along":return 1;default:return 0}}Object.defineProperty(a,"__esModule",{value:!0});var A=k.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate");a.isMapAligned=z;var B=function(a){var b=new Map;return function(c){b.has(c)||b.set(c,a(c));return b.get(c)}}(function(a){var b=0;if(0===a)return Infinity;for(;!(a%2);)b++,a/=2;return b}),D=function(a,b){return r.i1616to32(Math.round(8*
a),Math.round(8*b))};f=function(a){function f(c,e,f,g){var k=a.call(this,c,f.font.size,f.haloSize||0,f.color&&d.premultiplyAlphaRGBA(f.color)||0,f.haloColor&&d.premultiplyAlphaRGBA(f.haloColor)||0,f.horizontalAlignment,f.verticalAlignment,z(e.labelPlacement)?1:0,f.font.decoration,!1,f.angle||0,f.xoffset,f.yoffset,f.id,f.lineWidth,f.lineHeight,null,null)||this;k._outLineLabelAngle=0;k._refPlacementPadding=0;k._refPlacementDirX=0;k._refPlacementDirY=0;k._refOffsetX=0;k._refOffsetY=0;k.geometryType=
p.WGLGeometryType.LABEL;var m;m=!!e.minScale&&g.scaleToZoom(e.minScale)||0;m=l.clamp(m,0,25.5);g=!!e.maxScale&&g.scaleToZoom(e.maxScale)||255;g=l.clamp(g,0,25.5);var q=b.alignmentUtils.getAlignmentFromPlacement(e.labelPlacement),r=q[1];k._xAlignD=q[0];k._yAlignD=r;k._minZoom=m;k._maxZoom=g;k._refPlacementPadding=h.pt2px(f.haloSize)+n.TEXT_PLACEMENT_PADDING;c=u.LabelMaterialKey.load(u.createMaterialKey(k.geometryType,c,!1,e));c.sdf=!0;k._materialKey=c.data;return k}e.__extends(f,a);f.fromLabelClass=
function(a,b,c){if("center-along"===b.labelPlacement){var d=b.symbol;d.xoffset=0;d.yoffset=0;d.angle=0;d.font.decoration="none"}return new f(a,b,b.symbol,c)};Object.defineProperty(f.prototype,"_shapedBox",{get:function(){return c.unwrap(this._shapingInfo).bounds},enumerable:!0,configurable:!0});f.prototype.bindReferenceTemplate=function(a){var d=b.alignmentUtils.getXDirection(this._xAlignD),e=b.alignmentUtils.getYDirection(this._yAlignD);this._refOffsetY=this._refOffsetX=0;if(c.isNone(a))this._refSymbolAndPlacementOffset=
r.i8888to32(0,0,Math.floor(127*d+127),Math.floor(127*e+127));else{if("circle"===a.boundsType&&(d||e))var f=Math.sqrt(d*d+e*e),d=d/f,e=e/f;f=Math.max(a.height,a.width);this._refSymbolAndPlacementOffset=r.i8888to32(4*this._refPlacementPadding,f,Math.floor(127*d+127),Math.floor(127*e+127));this._referenceSize=f;this._refPlacementDirX=d;this._refPlacementDirY=e;this._refOffsetX=a.xOffset;this._refOffsetY=a.yOffset}};f.prototype.writeMesh=function(a,b,d,e,f,g,h){if(!c.isNone(this._shapingInfo))switch(this.current=
{outRecords:a,outVecs:b,outMetrics:h,inId:e,inShaping:this._shapingInfo,zoomLevel:g},d){case "esriGeometryPolyline":return this._placeLineLabels(f.geometry);case "esriGeometryPoint":return this._placePointLabels(f.geometry);case "esriGeometryPolygon":return this._placePointLabels(f.centroid);default:a="Geometry of type "+d+" is not supported",void 0===a&&(a="mapview-labeling"),A.error(new m(a,"mapview-labeling"))}};f.prototype._isVisible=function(a,b){var c=Math.floor(10*this.current.zoomLevel);return Math.floor(10*
a)<=c&&c<=Math.floor(10*b)};f.prototype._placePointLabels=function(a){var b=this.current;this._writeGlyphs(b.outRecords,b.outVecs,b.inId,a,b.outMetrics)};f.prototype._placeLineLabels=function(a){a=v.smoothPaths(a.paths,this.current.inShaping.bounds.width);for(var b=this._placeSubdivGlyphs.bind(this),c=(this._shapedBox.width+128)/4,d=0;d<a.length;d++)v.pathDivide(a[d],c,b)};f.prototype._placeSubdivGlyphs=function(a,b,c,d){var e=B(b);c=g.log2(Math.min(c,d-c)/(4+this._shapedBox.width/4/2));e=Math.max(this._minZoom,
this.current.zoomLevel+2-(0===b?c:Math.min(e,c)));c=this._shapedBox.width/2*Math.pow(2,this.current.zoomLevel-e);this.current.inShaping.isMultiline?0===b&&this._placeStraight(a,e):this._placeCurved(a,e,c)};f.prototype._placeStraight=function(a,b){var c=this.current;this._writeGlyphs(c.outRecords,c.outVecs,c.inId,a,c.outMetrics,b)};f.prototype._placeCurved=function(a,b,c){var d=new x.default(this.current.inId,{from:this.current.outRecords.length,count:-1},a.x,a.y,b),e=a.clone(),f=(180/Math.PI*a.angle+
180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*a.angle%360*(254/360));this._placeFirst(e,d,b,1);this._placeBack(a,e,d,b,c,1);this._placeForward(a,e,d,b,c,1);this._outLineLabelAngle=Math.round(254/360*f);this._placeFirst(e,d,b,0);this._placeBack(a,e,d,b,c,0);this._placeForward(a,e,d,b,c,0);d.range.count=this.current.outRecords.length-d.range.from;d.bounds&&this.current.outMetrics.push(d)};f.prototype._placeBack=function(a,b,c,d,e,f){var g=a.clone();for(a=a.backwardLength+0;g.prev()&&!(a>=
e);)this._placeOnSegment(g,b,c,a,d,-1,f),a+=g.length+0};f.prototype._placeForward=function(a,b,c,d,e,f){var g=a.clone();for(a=a.remainingLength+0;g.next()&&!(a>=e);)this._placeOnSegment(g,b,c,a,d,1,f),a+=g.length+0};f.prototype._placeFirst=function(a,b,c,d){for(var e=this.current.inShaping,f=e.glyphs,h=this.current.zoomLevel,k=this.current,l=k.outRecords,m=k.outVecs,k=k.inId,n=D(a.x,a.y),p=0;p<f.length;p++){var q=f[p],u=q.x>e.bounds.x?d:1-d,u=Math.max(0,h+g.log2(Math.abs(q.x+q.width/2-e.bounds.x)/
(u*a.remainingLength+(1-u)*a.backwardLength+0))),u=Math.max(c,u);q.maxZoom=25;q.angle=a.angle+(1-d)*Math.PI;q.minZoom=u;this._writeGlyph(l,m,q,k,n);d&&this._isVisible(q.minZoom,q.maxZoom)&&b.add(q.bounds,0,0)}};f.prototype._placeOnSegment=function(a,b,c,d,e,f,h){for(var k=this.current.inShaping.glyphs,l=this.current,m=l.outRecords,n=l.outVecs,l=l.inId,p=this.current.inShaping,q=this.current.zoomLevel,u=D(a.x+a.dx/a.length*-f*d,a.y+a.dy/a.length*-f*d),r=0;r<k.length;r++){var v=k[r],y=v.x>p.bounds.x?
h:1-h;if(y&&1===f||!y&&-1===f){var x=Math.abs(v.x+v.width/2-p.bounds.x),y=Math.max(0,q+g.log2(x/d)-.1),x=Math.max(e,q+g.log2(x/(d+a.length+0)));0!==y&&(v.angle=a.angle+(1-h)*Math.PI,v.minZoom=x,v.maxZoom=y,this._writeGlyph(m,n,v,l,u),h&&this._isVisible(v.minZoom,v.maxZoom)&&c.add(v.bounds,a.x-b.x,a.y-b.y))}}};f.prototype._writeGlyphs=function(a,b,d,e,f,g){void 0===g&&(g=this._minZoom);var h=this._shapingInfo;if(!(c.isNone(h)||0>e.x||512<=e.x||0>e.y||512<=e.y)){var k=D(e.x+this._refOffsetX,e.y-this._refOffsetY);
e=new x.default(d,{from:a.length,count:-1},e.x+this._refOffsetX,e.y-this._refOffsetY,g);for(var l=0,m=h.glyphs;l<m.length;l++){var n=m[l];n.minZoom=g;n.maxZoom=this._maxZoom;this._writeGlyph(a,b,n,d,k)}e.range.count=a.length-e.range.from;e.bounds=h.boundsT;a=u.LabelMaterialKey.load(this._materialKey);e.setPlacementOffset(a.vvSizeFieldStops||a.vvSizeMinMaxValue||a.vvSizeScaleStops||a.vvSizeUnitValue,this._referenceSize,this._refPlacementPadding,this._refPlacementDirX,this._refPlacementDirY);f.push(e)}};
f.prototype._writeGlyph=function(a,b,c,d,e){var f=u.MaterialKeyBase.load(this._materialKey),g=new q(d,this.geometryType,f.data,0,0);f.textureBinding=c.textureBinding;g.materialKey=f.data;g.indexFrom=b.indexVector.length;g.indexCount=this._writeIndices(b);g.vertexFrom=b.getVector("geometry").vertexCount;g.vertexCount=this._writeVertex(b,d,e,c);a.push(g)};f.prototype._writeVertexCommon=function(a,b,c,d){var e=this._color,f=this._haloColor,g=r.i8888to32(0,0,this._size,this._haloSize);d=r.i8888to32(Math.floor(10*
Math.max(d.minZoom,this._minZoom)),Math.floor(10*Math.min(d.maxZoom,this._maxZoom)),this._outLineLabelAngle,0);a.push(c);a.push(b);a.push(e);a.push(f);a.push(g);a.push(this._refSymbolAndPlacementOffset);a.push(d)};return f}(y.default);a.default=f})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define(["require","exports","./MeshData","./Utils"],function(f,a,e,m){return function(){function a(a,e,c,f,b){void 0===f&&(f=0);void 0===b&&(b=0);this.id=a;this.geometryType=e;this.materialKey=c;
this.minZoom=f;this.maxZoom=b;this.meshData=null;this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}Object.defineProperty(a.prototype,"sortKey",{get:function(){void 0===this._sortKey&&this._computeSortKey();return this._sortKey},enumerable:!0,configurable:!0});a.prototype.clone=function(){return this.copy()};a.prototype.copy=function(){var e=new a(this.id,this.geometryType,this.materialKey);e.vertexFrom=this.vertexFrom;e.vertexCount=this.vertexCount;e.indexFrom=
this.indexFrom;e.indexCount=this.indexCount;e.zOrder=this.zOrder;e.symbolLevel=this.symbolLevel;e.meshData=this.meshData;e.minZoom=this.minZoom;e.maxZoom=this.maxZoom;return e};a.prototype.setMeshDataFromBuffers=function(a,f,c){var g=new e,b;for(b in f){for(var d=f[b].stride,k=f[b].data,l=[],r=m.strideToPackingFactor(d),q=0;q<d*a.vertexCount/r;++q)l[q]=k[q+d*a.vertexFrom/r];g.vertexData.set(b,l)}for(q=g.indexData.length=0;q<a.indexCount;++q)g.indexData[q]=c[q+a.indexFrom]-a.vertexFrom;g.vertexCount=
a.vertexCount;this.meshData=g};a.prototype.readMeshDataFromBuffers=function(a,f){this.meshData?this.meshData.clear():this.meshData=new e;for(var c in a){for(var g=a[c].stride,b=a[c].data,d=[],k=m.strideToPackingFactor(g),l=0;l<g*this.vertexCount/k;++l)d[l]=b[l+g*this.vertexFrom/k];this.meshData.vertexData.set(c,d)}for(l=this.meshData.indexData.length=0;l<this.indexCount;++l)this.meshData.indexData[l]=f[l+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount};a.prototype.writeMeshDataToBuffers=
function(a,e,c,f){for(var b in e)for(var d=e[b].stride,g=this.meshData.vertexData.get(b),h=e[b].data,k=m.strideToPackingFactor(d),l=0;l<d*this.meshData.vertexCount/k;++l)h[l+d*a/k]=g[l];for(l=0;l<this.meshData.indexData.length;++l)f[l+c]=this.meshData.indexData[l]+a;this.vertexFrom=a;this.vertexCount=this.meshData.vertexCount;this.indexFrom=c;this.indexCount=this.meshData.indexData.length};a.writeAllMeshDataToBuffers=function(a,e,c){for(var f=0,b=0,d=0;d<a.length;d++){var g=a[d];g.writeMeshDataToBuffers(f,
e,b,c);f+=g.vertexCount;b+=g.indexCount}};a.prototype._computeSortKey=function(){this._sortKey=(this.symbolLevel&31)<<12|(this.zOrder&127)<<4|this.geometryType&7};a.prototype.serialize=function(a){a.push(this.geometryType);a.push(this.materialKey);a.push(this.symbolLevel);a.push(this.zOrder);a.push(this.vertexFrom);a.push(this.vertexCount);a.push(this.indexFrom);a.push(this.indexCount);a.push(this.minZoom);a.push(this.maxZoom);return a};a.deserialize=function(e,f){var c=e.readInt32(),g=e.readInt32();
f=new a(f.id,c,g);f.symbolLevel=e.readInt32();f.zOrder=e.readInt32();f.vertexFrom=e.readInt32();f.vertexCount=e.readInt32();f.indexFrom=e.readInt32();f.indexCount=e.readInt32();f.minZoom=e.readInt32();f.maxZoom=e.readInt32();return f};return a}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(["require","exports"],function(f,a){return function(){function a(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}a.prototype.clear=function(){this.vertexData.clear();this.vertexCount=
0;this.indexData=[]};a.prototype.update=function(a,e,f){for(var g in a)this.vertexData.set(g,a[g]);for(g in this.vertexData)null===a[g]&&this.vertexData.delete(g);this.vertexCount=e;this.indexData=f};return a}()})},"esri/views/2d/engine/webgl/collisions/Metric":function(){define("require exports ../../../../../core/Logger ../../../../../core/libs/gl-matrix-2/vec2f32 ../definitions ./BoundingBox ../util/serializationUtils".split(" "),function(f,a,e,m,k,l,g){Object.defineProperty(a,"__esModule",{value:!0});
var c=e.getLogger("esri/views/2d/engine/webgl/collisions/Metric");f=function(){function a(a,c,e,f,g){this.id=a;this.range=c;this.boxes=null;this.minZoom=-1;this.placementPadding=this.offsetY=this.offsetX=this.directionY=this.directionX=this.size=0;this.anchor=m.vec2f32.fromValues(e,f);this.baseZoom=g}a.prototype.add=function(a,c,e){a.x+=c;a.y+=e;this.bounds?(this.boxes?this.boxes.push(a):(this.boxes=[this.bounds,a],this.bounds=this.bounds.clone()),this.bounds.extend(a)):this.bounds=a};a.prototype.computeIndex=
function(){var a=Math.floor(this.anchor[1]/k.COLLISION_BUCKET_SIZE);this.xBucket=Math.floor(this.anchor[0]/k.COLLISION_BUCKET_SIZE);this.yBucket=a;a=k.TILE_SIZE/k.COLLISION_BUCKET_SIZE;this.hasVV?this.yOverflow=this.xOverflow=a:(this.xOverflow=Math.min(a,Math.ceil(2*this.bounds.width/k.COLLISION_BUCKET_SIZE)),this.yOverflow=Math.min(a,Math.ceil(2*this.bounds.height/k.COLLISION_BUCKET_SIZE)))};a.prototype.findCollisionDelta=function(a){var b=this.bounds.findCollisionDelta(a.bounds),c=this.boxes&&this.boxes.length,
e=a.boxes&&a.boxes.length;return Math.abs(b)>k.COLLISION_MAX_ZOOM_DELTA||!c&&!e?b:c&&e?this._boxesToBoxes(a):c?this._boxesToBox(a):this._boxToBoxes(a)};a.prototype.computeVVOffset=function(a,d){d||c.error("mapview-labeling","Unable to compute label offset. Expected an evaluator function but found "+d);var b=this.size;this.hasVV&&(a=d(a),b=isNaN(a)||null==a||Infinity===a?this.size:a);this._computeOffset(b)};a.prototype.setPlacementOffset=function(a,c,e,f,g){this.hasVV=a;this.size=c;this.placementPadding=
Math.round(e);this.directionX=f;this.directionY=g};a.prototype.clone=function(){var b=new a(this.id,this.range,this.anchor[0],this.anchor[1],this.baseZoom);b.minZoom=this.minZoom;this.bounds&&(b.bounds=this.bounds.clone());this.boxes&&(b.boxes=this.boxes.map(function(a){return a.clone()}));b.xBucket=this.xBucket;b.yBucket=this.yBucket;b.xOverflow=this.xOverflow;b.yOverflow=this.yOverflow;b.hasVV=this.hasVV;b.size=this.size;b.directionX=this.directionX;b.directionY=this.directionY;b.offsetX=this.offsetX;
b.offsetY=this.offsetY;return b};a.prototype._boxToBoxes=function(a){var b=-Infinity,c=0;for(a=a.boxes;c<a.length;c++)var e=this.bounds.findCollisionDelta(a[c]),b=Math.max(e,b);return b};a.prototype._boxesToBox=function(a){for(var b=this.boxes[0].findCollisionDelta(a.bounds),c=1;c<this.boxes.length;c++)var e=this.boxes[c].findCollisionDelta(a.bounds),b=Math.max(e,b);return b};a.prototype._boxesToBoxes=function(a){for(var b=-Infinity,c=0;c<this.boxes.length;c++)for(var e=this.boxes[c],f=0,g=a.boxes;f<
g.length;f++)var h=e.findCollisionDelta(g[f]),b=Math.max(h,b);return b};a.prototype._computeOffset=function(a){this.offsetX=this.directionX*(a/2+this.placementPadding);this.offsetY=this.directionY*(a/2+this.placementPadding)};a.prototype.serialize=function(a){a.push(this.id);this.bounds.serialize(a);a.push(this.range.from);a.push(this.range.count);a.push(this.anchor[0]);a.push(this.anchor[1]);a.push(this.baseZoom);a.push(this.hasVV?1:0);a.push(this.size);a.writeF32(this.directionX);a.writeF32(this.directionY);
a.push(this.offsetX);a.push(this.offsetY);a.push(this.placementPadding);g.serializeList(a,this.boxes);return a};a.deserialize=function(b){var c=b.readInt32(),e=l.default.deserialize(b),f=b.readInt32(),h=b.readInt32(),k={from:f,count:h},m=b.readInt32(),u=b.readInt32(),v=b.readInt32(),f=b.readInt32(),h=b.readInt32(),y=b.readF32(),z=b.readF32(),A=b.readInt32(),B=b.readInt32(),D=b.readInt32();b=g.deserializeList(b,l.default);c=new a(c,k,m,u,v);c.bounds=e;c.boxes=b;c.setPlacementOffset(!!f,h,D,y,z);c.offsetX=
A;c.offsetY=B;c.computeIndex();f||c._computeOffset(h);return c};return a}();a.default=f})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["require","exports","../../../../../core/mathUtils","../../../../../core/libs/gl-matrix-2/vec2f32"],function(f,a,e,m){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(a,e,c,f){this.center=m.vec2f32.fromValues(a,e);this.centerT=m.vec2f32.create();this.halfWidth=c/2;this.halfHeight=f/2;this.width=c;this.height=f}Object.defineProperty(a.prototype,
"x",{get:function(){return this.center[0]},set:function(a){this.center[0]=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"y",{get:function(){return this.center[1]},set:function(a){this.center[1]=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"blX",{get:function(){return this.center[0]+this.halfWidth},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"blY",{get:function(){return this.center[1]+this.halfHeight},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"trX",{get:function(){return this.center[0]-this.halfWidth},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"trY",{get:function(){return this.center[1]-this.halfHeight},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"xmin",{get:function(){return this.x-this.halfWidth},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"xmax",{get:function(){return this.x+this.halfWidth},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"ymin",{get:function(){return this.y-this.halfHeight},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"ymax",{get:function(){return this.y+this.halfHeight},enumerable:!0,configurable:!0});a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height)};a.prototype.serialize=function(a){a.writeF32(this.center[0]);a.writeF32(this.center[1]);a.push(this.width);a.push(this.height);return a};a.prototype.findCollisionDelta=function(a,f){void 0===f&&(f=4);return e.log2(Math.min((a.halfWidth+
this.halfWidth+f)/Math.abs(a.centerT[0]-this.centerT[0]),(a.halfHeight+this.halfHeight+f)/Math.abs(a.centerT[1]-this.centerT[1])))};a.prototype.extend=function(a){var e=Math.min(this.xmin,a.xmin),c=Math.min(this.ymin,a.ymin),f=Math.max(this.xmax,a.xmax)-e;a=Math.max(this.ymax,a.ymax)-c;this.width=f;this.height=a;this.halfWidth=f/2;this.halfHeight=a/2;this.x=e+f/2;this.y=c+a/2};a.deserialize=function(e){var f=e.readF32(),c=e.readF32(),h=e.readInt32();e=e.readInt32();return new a(f,c,h,e)};return a}();
a.default=f})},"esri/views/2d/engine/webgl/util/serializationUtils":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});a.serializeList=function(a,f){if(null===f)a.push(0);else{a.push(f.length);for(var e=0;e<f.length;e++)f[e].serialize(a);return a}};a.deserializeList=function(a,f,k){for(var e=a.readInt32(),e=Array(e),g=0;g<e.length;g++)e[g]=f.deserialize(a,k);return e}})},"esri/views/2d/engine/webgl/mesh/templates/segmentUtils":function(){define(["require",
"exports","../../../../../../core/maybe","./util"],function(f,a,e,m){function k(a){return a.length-1}function l(a){for(var b=0,c=0;c<k(a);c++)b+=g(a,c);return b}function g(a,c,e){void 0===e&&(e=1);c=a[c+1];a=c[0];c=c[1];return Math.sqrt(a*a+c*c)*e}function c(a,d,f,g,h){if(!(f<d)){var b=g.clone().seek(f/2);e.isNone(b)||(a(b.clone(),f,h),f=(f-d)/2,b=e.unwrap(b.seek(d/2)),c(a,d,f,g,h+1),c(a,d,f,b,h+1))}}Object.defineProperty(a,"__esModule",{value:!0});a.segmentAt=function(a,c){return a[c+1]};a.segmentCount=
k;a.pathLength=l;a.segmentLength=g;var h=function(){function a(a,b,c,e,f){this._segments=a;this._index=b;this._distance=c;this._xStart=e;this._yStart=f;this._done=!1}a.create=function(b){return new a(b,0,0,b[0][0],b[0][1])};a.prototype.clone=function(){return new a(this._segments,this._index,this._distance,this.xStart,this.yStart)};a.prototype.equals=function(a){return this._index===a._index||a._index===this._index-1&&(0===this._distance||1===a._distance)||a._index===this._index+1&&(1===this._distance||
0===a._distance)};a.prototype.leq=function(a){return this._index<a._index||this._index===a._index&&this._distance<=a._distance};a.prototype.geq=function(a){return this._index>a._index||this._index===a._index&&this._distance>=a._distance};Object.defineProperty(a.prototype,"_segment",{get:function(){return this._segments[this._index+1]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"angle",{get:function(){var a=this.dy,b=Math.acos((0*a+-1*-this.dx)/(1*this.length));0<a&&(b=2*Math.PI-
b);return b},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"xStart",{get:function(){return this._xStart},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"yStart",{get:function(){return this._yStart},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"x",{get:function(){return this.xStart+this.distance*this.dx},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"y",{get:function(){return this.yStart+this.distance*this.dy},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"dx",{get:function(){return this._segment[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"dy",{get:function(){return this._segment[1]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"xMidpoint",{get:function(){return this.xStart+.5*this.dx},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"yMidpoint",{get:function(){return this.yStart+.5*this.dy},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"xEnd",{get:function(){return this.xStart+this.dx},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"yEnd",{get:function(){return this.yStart+this.dy},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"length",{get:function(){var a=this.dx,b=this.dy;return Math.sqrt(a*a+b*b)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"remainingLength",{get:function(){return this.length*(1-this._distance)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"backwardLength",{get:function(){return this.length*this._distance},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"done",{get:function(){return this._done},enumerable:!0,configurable:!0});a.prototype.hasPrev=function(){return 0<=this._index-1};a.prototype.hasNext=function(){return this._index+1<k(this._segments)};a.prototype.next=function(){if(!this.hasNext())return null;
this._xStart+=this.dx;this._yStart+=this.dy;this._distance=0;this._index+=1;return this};a.prototype.prev=function(){if(!this.hasPrev())return this._done=!0,null;--this._index;this._xStart-=this.dx;this._yStart-=this.dy;this._distance=1;return this};a.prototype._seekBackwards=function(a,b){var c=this.backwardLength;if(a<=c)return this._distance=(c-a)/this.length,this;for(c=this.backwardLength;this.prev();){if(c+this.length>a)return this._seekBackwards(a-c);c+=this.length}this._distance=0;return b?
this:null};a.prototype.seek=function(a,b){void 0===b&&(b=!1);if(0>a)return this._seekBackwards(Math.abs(a),b);if(a<=this.remainingLength)return this._distance=(this.backwardLength+a)/this.length,this;for(var c=this.remainingLength;this.next();){if(c+this.length>a)return this.seek(a-c,b);c+=this.length}this._distance=1;return b?this:null};return a}();a.SegmentCursor=h;a.pathDivide=function(a,c,e){var b=l(a);a=h.create(a);var d=b/2,f=Math.floor((b-c)/2/c);a.seek(d-f*c);for(var g=-f;g<=f;g++)512>a.x&&
0<=a.x&&512>a.y&&0<=a.y&&e(a.clone(),g,d+g*c,b),a.seek(c)};a.pathSubdivide=function(a,d,e){c(e,d,l(a),h.create(a),0)};a.smoothPaths=function(a,c){for(var b=0;b<a.length;b++){var d=a[b],e=[];e.push(d[0]);for(var f=1;f<d.length;f++){var g=e[f-1],h=g[0],g=g[1],h=h+d[f][0],g=g+d[f][1];e.push([h,g])}h=e;g=c;if(!(0>=g||(d=h.length,3>d))){var f=[],k=0;f.push(0);for(var l=1;l<d;l++)k+=m.dist(h[l],h[l-1]),f.push(k);g=Math.min(g,.2*k);k=[];k.push(h[0][0]);k.push(h[0][1]);var z=h[d-1][0],A=h[d-1][1],l=m.sub([0,
0],h[0],h[1]);m.normalize(l);h[0][0]+=g*l[0];h[0][1]+=g*l[1];m.sub(l,h[d-1],h[d-2]);m.normalize(l);h[d-1][0]+=g*l[0];h[d-1][1]+=g*l[1];for(l=1;l<d;l++)f[l]+=g;f[d-1]+=g;for(var B=.5*g,l=1;l<d-1;l++){for(var D=0,C=0,E=0,F=l-1;0<=F&&!(f[F+1]<f[l]-B);F--){var I=B+f[F+1]-f[l],J=f[F+1]-f[F],G=f[l]-f[F]<B?1:I/J;if(1E-6>Math.abs(G))break;var H=G*G,K=G*I-.5*H*J,O=G*J/g,L=h[F+1],N=h[F][0]-L[0],T=h[F][1]-L[1],D=D+O/K*(L[0]*G*I+.5*H*(I*N-J*L[0])-H*G*J*N/3),C=C+O/K*(L[1]*G*I+.5*H*(I*T-J*L[1])-H*G*J*T/3),E=E+
O}for(F=l+1;F<d&&!(f[F-1]>f[l]+B);F++){I=B-f[F-1]+f[l];J=f[F]-f[F-1];G=f[F]-f[l]<B?1:I/J;if(1E-6>Math.abs(G))break;H=G*G;K=G*I-.5*H*J;O=G*J/g;L=h[F-1];N=h[F][0]-L[0];T=h[F][1]-L[1];D+=O/K*(L[0]*G*I+.5*H*(I*N-J*L[0])-H*G*J*N/3);C+=O/K*(L[1]*G*I+.5*H*(I*T-J*L[1])-H*G*J*T/3);E+=O}k.push(D/E);k.push(C/E)}k.push(z);k.push(A);for(F=l=0;l<d;l++)h[l][0]=k[F++],h[l][1]=k[F++]}d=[];d.push(e[0]);for(f=1;f<e.length;f++)h=e[f-1],l=h[0],k=h[1],g=e[f],h=g[0],g=g[1],d.push([Math.round(h-l),Math.round(g-k)]);a[b]=
d}return a}})},"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("require exports tslib ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../materialKey/MaterialKey ./WGLBaseTextTemplate ./WGLMeshTemplate ../../util/BidiText".split(" "),function(f,a,e,m,k,l,g,c,h,b){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function c(b,c,d,e,f,h,l,n,A,B,D,C,E,F,I,J,G,H,K){void 0===K&&(K=!1);var p=a.call(this)||this;p._xOffset=m.pt2px(C);p._yOffset=
m.pt2px(E);p._decoration=A||"none";p._color=e;p._haloColor=f;p._haloSize=Math.min(Math.floor(5*m.pt2px(m.toPt(d))),127);p._size=Math.min(Math.round(m.pt2px(c)),127);c=Math.min(Math.round(m.pt2px(c)),127);p._referenceSize=Math.round(Math.sqrt(256*c));p._scale=p._size/24;p._angle=D;p._justify=k.getJustification(h||"center");p._xAlignD=k.getXAnchorDirection(h||"center");p._yAlignD=k.getYAnchorDirection(l||"baseline");p._baseline="baseline"===(l||"baseline");p._bitset=(1===n?1:0)|(B?1:0)<<1;b=g.MaterialKeyBase.load(g.createMaterialKey(p.geometryType,
b,!1));b.sdf=!0;p._materialKey=b.data;p.symbolId=F;p._lineWidth=m.pt2px(I)||512;p._lineHeight=J||1;p._textPlacement=G;p.effects=H;p._isCIM=K;return p}e.__extends(c,a);c.fromText=function(a,d,e){a=new c(a,d.font.size,d.haloSize||0,d.color&&l.premultiplyAlphaRGBA(d.color)||0,d.haloColor&&l.premultiplyAlphaRGBA(d.haloColor)||0,d.horizontalAlignment,d.verticalAlignment,0,d.font.decoration,!1,d.angle||0,d.xoffset,d.yoffset,d.id,d.lineWidth,d.lineHeight,null,null,!1);d=b.bidiText(d.text)[1];a.bindTextInfo(e,
d);return a};c.fromCIMText=function(a,d,e){var f=d.scaleFactor||1;a=new c(a,d.size*d.sizeRatio*f,d.outlineSize*d.sizeRatio,l.premultiplyAlphaRGBA(d.color),l.premultiplyAlphaRGBA(d.outlineColor),d.horizontalAlignment,d.verticalAlignment,d.alignment,d.decoration,d.colorLocked,d.angle,d.offsetX*d.sizeRatio*f,d.offsetY*d.sizeRatio*f,d.materialHash,512,1,d.markerPlacement,d.effects,!0);d=b.bidiText(d.text)[1];a.bindTextInfo(e,d);return a};return c}(c.default(h.default));a.default=f})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("require exports tslib ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../../../engine ../../definitions ../../enums ../../number ../../WGLDisplayRecord ../../materialKey/MaterialKey ./util".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q){Object.defineProperty(a,"__esModule",{value:!0});var x=k.getLogger("esri.views.2d.engine.webgl.WGLTextTemplate"),u=function(a,b){void 0===b&&(b="mapview-processing");return x.error(new m(b,a))};a.default=function(a){return function(a){function f(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;b._isCIM=!1;b.geometryType=d.WGLGeometryType.TEXT;b._aux=n.i8888to32(0,0,b._referenceSize,b._bitset);return b}e.__extends(f,a);f.prototype.bindTextInfo=
function(a,c){var d=this;this._shapingInfo=a&&a.length?l.andThen(a,function(a){return h.shapeGlyphs(a,c,{scale:d._scale,angle:d._angle,xOffset:d._xOffset,yOffset:d._yOffset,hAlign:d._xAlignD,vAlign:d._yAlignD,maxLineWidth:Math.max(32,Math.min(d._lineWidth,512)),lineHeight:b.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(d._lineHeight,4)),decoration:d._decoration,isCIM:d._isCIM})}):null};f.prototype.writeMeshWithGeometry=function(a,b,c,d,e,f){var g=this;if(l.isSome(this._textPlacement))this._writePlacedText(a,
b,d,e,f);else if(q.isPoint(f))this._writeGlyphs(a,b,d,f);else if(q.isPolygon(f))l.andThen(e.centroid,function(c){return g._writeGlyphs(a,b,d,c)});else if(q.isMultipoint(f)){var h=e=c=0;for(f=f.points;h<f.length;h++){var k=f[h],m=k[1];c+=k[0];e+=m;this._writeGlyphs(a,b,d,{x:c,y:e})}}else u("Unable to handle geometryType: "+c)};f.prototype._writePlacedText=function(a,b,d,e,f){e=this._shapingInfo;if(!l.isNone(e)){var h=r.MaterialKeyBase.load(this._materialKey);if(f=c.CIMMarkerPlacementHelper.getPlacement(f,
l.unwrap(this._textPlacement),g.pt2px(1))){var k,m;for(k=f.next();null!=k;){m=n.i1616to32(Math.round(8*k.tx),Math.round(8*k.ty));k=k.getAngle();e.setRotation(k);for(var q=0,u=e.glyphs;q<u.length;q++){var v=u[q],y=new p(d,this.geometryType,h.data,0,0);h.textureBinding=v.textureBinding;y.materialKey=h.data;y.indexFrom=b.indexVector.length;y.indexCount=this._writeIndices(b);y.vertexFrom=b.getVector("geometry").vertexCount;y.vertexCount=this._writeVertex(b,d,m,v);a.push(y)}e.setRotation(-k);k=f.next()}}}};
f.prototype._writeGlyphs=function(a,b,c,d){var e=this._shapingInfo;if(!l.isNone(e)){var f=r.MaterialKeyBase.load(this._materialKey);d=n.i1616to32(Math.round(8*d.x),Math.round(8*d.y));for(var g=0,e=e.glyphs;g<e.length;g++){var h=e[g],k=new p(c,this.geometryType,f.data,0,0);f.textureBinding=h.textureBinding;k.materialKey=f.data;k.indexFrom=b.indexVector.length;k.indexCount=this._writeIndices(b);k.vertexFrom=b.getVector("geometry").vertexCount;k.vertexCount=this._writeVertex(b,c,d,h);a.push(k)}}};f.prototype._writeVertexCommon=
function(a,b,c,d){d=this._color;var e=this._haloColor,f=n.i8888to32(0,0,this._referenceSize,this._bitset),g=n.i8888to32(0,0,this._size,this._haloSize);a.push(c);a.push(b);a.push(d);a.push(e);a.push(g);a.push(f)};f.prototype._writeVertex=function(a,b,c,d){a=a.get("geometry");this._writeVertexCommon(a,b,c,d);a.push(d.offsets.upperLeft);a.push(d.texcoords.upperLeft);this._writeVertexCommon(a,b,c,d);a.push(d.offsets.upperRight);a.push(d.texcoords.upperRight);this._writeVertexCommon(a,b,c,d);a.push(d.offsets.lowerLeft);
a.push(d.texcoords.lowerLeft);this._writeVertexCommon(a,b,c,d);a.push(d.offsets.lowerRight);a.push(d.texcoords.lowerRight);return 4};f.prototype._writeIndices=function(a){var b=a.getVector("geometry").vertexCount;a=a.indexVector;a.push(b+0);a.push(b+1);a.push(b+2);a.push(b+1);a.push(b+3);a.push(b+2);return 6};return f}(a)}})},"esri/symbols/cim/placements/CIMMarkerPlacementHelper":function(){define(["require","exports","../CIMCursor","../CIMOperators"],function(f,a,e,m){Object.defineProperty(a,"__esModule",
{value:!0});f=function(){function a(){}a.getPlacement=function(a,f,c){var g=m.getPlacementOperator(f);if(!g)return null;a=e.cloneAndDecodeGeometry(a);return g.execute(a,f,c)};return a}();a.CIMMarkerPlacementHelper=f})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["require","exports","../../../../../../core/maybe","../../../../../../geometry/support/jsonUtils","../../../../../../symbols/cim/effects/CIMEffectHelper"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",
{value:!0});f=function(){function a(){}a.prototype.writeMesh=function(a,c,f,b,d){if(e.isSome(this.effects)){var g=k.CIMEffectHelper.executeEffects(this.effects,d.geometry),h=k.CIMEffectHelper.next(g);for(f=m.getJsonType(h);h;)this.writeMeshWithGeometry(a,c,f,b,d,h),h=k.CIMEffectHelper.next(g),f=m.getJsonType(h)}else this.writeMeshWithGeometry(a,c,f,b,d,d.geometry)};a.prototype.writeMeshWithGeometry=function(a,c,e,b,d,f){};a.prototype.bindFeature=function(a,c,e){};return a}();a.default=f})},"esri/symbols/cim/effects/CIMEffectHelper":function(){define(["require",
"exports","../CIMCursor","../CIMEffects","../CIMOperators"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});var l=96/72;f=function(){function a(){}a.executeEffects=function(a,f){f=e.cloneAndDecodeGeometry(f);f=new m.SimpleGeometryCursor(f);for(var b=0;b<a.length;b++){var c=a[b],g=k.getEffectOperator(c);g&&(f=g.execute(f,c,l))}return f};a.next=function(a){a=a.next();e.deltaEncodeGeometry(a);return a};return a}();a.CIMEffectHelper=f})},"esri/views/2d/engine/webgl/util/vvFlagUtils":function(){define(["require",
"exports","../enums","../visualVariablesUtils"],function(f,a,e,m){function k(a,c){void 0===c&&(c=!1);var f=e.WGLVVFlag.SIZE_FIELD_STOPS|e.WGLVVFlag.SIZE_MINMAX_VALUE|e.WGLVVFlag.SIZE_SCALE_STOPS|e.WGLVVFlag.SIZE_UNIT_VALUE;a=(a&(e.WGLVVTarget.FIELD_TARGETS_OUTLINE|e.WGLVVTarget.MINMAX_TARGETS_OUTLINE|e.WGLVVTarget.SCALE_TARGETS_OUTLINE|e.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return c?f&a:f&~a}function l(a){var c=k(a,!1);return a&(e.WGLVVFlag.COLOR|e.WGLVVFlag.OPACITY|e.WGLVVFlag.ROTATION|c)}Object.defineProperty(a,
"__esModule",{value:!0});a.getVVFlags=function(a){if(!a)return e.WGLVVFlag.NONE;for(var c=0,f=0;f<a.length;f++){var b=a[f];if("size"===b.type){var d=m.getTypeOfSizeVisualVariable(b),c=c|d;"outline"===b.target&&(c|=d<<4)}else"color"===b.type?c|=e.WGLVVFlag.COLOR:"opacity"===b.type?c|=e.WGLVVFlag.OPACITY:"rotation"===b.type&&(c|=e.WGLVVFlag.ROTATION)}return c};a.getSizeFlagsMask=k;a.getMarkerVVFlags=l;a.getFillVVFlags=function(a){return a&(e.WGLVVFlag.COLOR|e.WGLVVFlag.OPACITY)};a.getLineVVFlags=function(a,
c){if(c)return c=k(a,!0),a&c;c=k(a,!1);return a&(e.WGLVVFlag.COLOR|e.WGLVVFlag.OPACITY|c)};a.getTextVVFlags=function(a){return l(a)};a.getLabelVVFlags=function(a){var c=k(a,!1);return a&c}})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define("require exports ../../../../core/Error ../../../../core/Logger ./enums ./Utils".split(" "),function(f,a,e,m,k,l){Object.defineProperty(a,"__esModule",{value:!0});var g=m.getLogger("esri.views.2d.engine.webgl");a.getTypeOfSizeVisualVariable=
function(a){if(l.isNumber(a.minDataValue)&&l.isNumber(a.maxDataValue)&&null!=a.minSize&&null!=a.maxSize)return k.WGLVVFlag.SIZE_MINMAX_VALUE;if((a.expression&&"view.scale"===a.expression||a.valueExpression&&"$view.scale"===a.valueExpression)&&Array.isArray(a.stops))return k.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=a.field||a.expression&&"view.scale"!==a.expression||a.valueExpression&&"$view.scale"!==a.valueExpression)&&(Array.isArray(a.stops)||"levels"in a&&a.levels))return k.WGLVVFlag.SIZE_FIELD_STOPS;
if((null!=a.field||a.expression&&"view.scale"!==a.expression||a.valueExpression&&"$view.scale"!==a.valueExpression)&&null!=a.valueUnit)return k.WGLVVFlag.SIZE_UNIT_VALUE;g.error(new e("mapview-bad-type","Found invalid size VisualVariable",a));return k.WGLVVFlag.NONE}})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":function(){define("require exports tslib ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(f,a,e,m,k,l,g){Object.defineProperty(a,"__esModule",
{value:!0});f=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}e.__extends(c,a);c.prototype.dispose=function(){};c.prototype.getGeometryType=function(){return m.WGLGeometryType.LABEL};c.prototype.drawGeometry=function(a,c,e,f,h){var b=a.context,d=a.painter,l=a.state,m=a.rendererInfo,n=e.indexCount,p=e.indexFrom;e=g.LabelMaterialKey.load(e.materialKey);var r=e.mapAligned?1:0;if(r||!(1<=Math.abs(c.key.level-Math.round(100*a.displayLevel)/100))){var B=k.createProgramDescriptor(e.data,
{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_haloColor",count:4,type:5121,normalized:!0},{location:4,name:"a_texAndSize",count:4,type:5121},{location:5,name:"a_refSymbolAndPlacementOffset",count:4,type:5121},{location:6,name:"a_glyphData",count:4,type:5121},{location:7,name:"a_vertexOffset",count:2,type:5122},{location:8,name:"a_texCoords",count:2,type:5123}]}),D=B.bufferLayouts,
B=B.attributes;h=d.materialManager.getMaterialProgram(a,e,"materials/label",B,h);f=this._getVAO(b,D,B,f);a.context.setStencilFunction(514,0,255);b.bindProgram(h);b.bindVAO(f);this._setSharedUniforms(h,a,c);d.textureManager.bindTextures(b,h,e);d=1===r?l.displayViewMat3:l.displayMat3;e.vvSizeMinMaxValue&&h.setUniform4fv("u_vvSizeMinMaxValue",m.vvSizeMinMaxValue);e.vvSizeScaleStops&&h.setUniform1f("u_vvSizeScaleStopsValue",m.vvSizeScaleStopsValue);e.vvSizeFieldStops&&(c=m.getSizeVVFieldStops(c.key.level),
h.setUniform1fv("u_vvSizeFieldStopsValues",c.values),h.setUniform1fv("u_vvSizeFieldStopsSizes",c.sizes));e.vvSizeUnitValue&&h.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",m.vvSizeUnitValueToPixelsRatio);h.setUniform1f("u_mapRotation",Math.floor(l.rotation/360*254));h.setUniform1f("u_mapAligned",r);h.setUniformMatrix3fv("u_displayMat3",d);h.setUniform1f("u_opacity",1);h.setUniform1f("u_zoomLevel",Math.round(10*a.displayLevel));h.setUniform2fv("u_screenSize",a.state.size);h.setUniform1f("u_isHalo",
1);b.drawElements(4,n,5125,4*p);h.setUniform1f("u_isHalo",0);b.drawElements(4,n,5125,4*p);b.bindVAO(null);b.setStencilTestEnabled(!0);b.setBlendingEnabled(!0)}};return c}(l.default);a.default=f})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":function(){define("require exports tslib ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(f,a,e,m,k,l,g){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function c(){return null!==a&&a.apply(this,
arguments)||this}e.__extends(c,a);c.prototype.dispose=function(){};c.prototype.getGeometryType=function(){return m.WGLGeometryType.LINE};c.prototype.drawGeometry=function(a,c,e,f,h){var b=a.context,d=a.painter,l=a.rendererInfo,m=a.requiredLevel,n=e.indexFrom,p=e.indexCount;e=g.LineMaterialKey.load(e.materialKey);var r=k.createProgramDescriptor(e.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},
{location:3,name:"a_offsetAndNormal",count:4,type:5120},{location:4,name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123},{location:5,name:"a_tlbr",count:4,type:5123},{location:6,name:"a_segmentDirection",count:4,type:5120},{location:7,name:"a_aux",count:2,type:5123}]}),B=r.bufferLayouts,r=r.attributes;h=d.materialManager.getMaterialProgram(a,e,"materials/line",r,h);f=this._getVAO(b,B,r,f);B=1/a.pixelRatio;b.bindProgram(h);b.bindVAO(f);this._setSharedUniforms(h,a,c);e.textureBinding&&d.textureManager.bindTextures(b,
h,e);h.setUniform1f("u_zoomFactor",Math.pow(2,m-c.key.level)/a.pixelRatio);h.setUniform1f("u_blur",0+B);h.setUniform1f("u_antialiasing",B);e.vvSizeMinMaxValue&&h.setUniform4fv("u_vvSizeMinMaxValue",l.vvSizeMinMaxValue);e.vvSizeScaleStops&&h.setUniform1f("u_vvSizeScaleStopsValue",l.vvSizeScaleStopsValue);e.vvSizeFieldStops&&(a=l.getSizeVVFieldStops(c.key.level),h.setUniform1fv("u_vvSizeFieldStopsValues",a.values),h.setUniform1fv("u_vvSizeFieldStopsSizes",a.sizes));e.vvSizeUnitValue&&h.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",
l.vvSizeUnitValueToPixelsRatio);e.vvColor&&(h.setUniform1fv("u_vvColorValues",l.vvColorValues),h.setUniform4fv("u_vvColors",l.vvColors));e.vvOpacity&&(h.setUniform1fv("u_vvOpacityValues",l.vvOpacityValues),h.setUniform1fv("u_vvOpacities",l.vvOpacities));b.setFaceCullingEnabled(!0);b.setFrontFace(2305);b.setCullFace(1029);b.drawElements(4,p,5125,4*n);b.setFaceCullingEnabled(!1);b.bindVAO(null)};return c}(l.default);a.default=f})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":function(){define("require exports tslib ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),
function(f,a,e,m,k,l,g){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}e.__extends(c,a);c.prototype.dispose=function(){};c.prototype.getGeometryType=function(){return m.WGLGeometryType.MARKER};c.prototype.drawGeometry=function(a,c,e,f,h){var b=a.context,d=a.painter,l=a.rendererInfo,m=a.state,n=e.indexCount,p=e.indexFrom;e=g.MarkerMaterialKey.load(e.materialKey);var r=k.createProgramDescriptor(e.data,{geometry:[{location:0,
name:"a_pos",count:2,type:5122},{location:1,name:"a_vertexOffset",count:2,type:5122},{location:2,name:"a_texCoords",count:2,type:5123},{location:3,name:"a_bitSetAndDistRatio",count:4,type:5121},{location:4,name:"a_id",count:4,type:5121},{location:5,name:"a_color",count:4,type:5121,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:5121,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:5121}]}),B=r.bufferLayouts,r=r.attributes;h=d.materialManager.getMaterialProgram(a,
e,"materials/icon",r,h);f=this._getVAO(b,B,r,f);b.bindProgram(h);b.bindVAO(f);e.textureBinding&&d.textureManager.bindTextures(b,h,e);this._setSharedUniforms(h,a,c);h.setUniformMatrix3fv("u_displayMat3",e.vvRotation?m.displayViewMat3:m.displayMat3);e.vvSizeMinMaxValue&&h.setUniform4fv("u_vvSizeMinMaxValue",l.vvSizeMinMaxValue);e.vvSizeScaleStops&&h.setUniform1f("u_vvSizeScaleStopsValue",l.vvSizeScaleStopsValue);e.vvSizeFieldStops&&(a=l.getSizeVVFieldStops(c.key.level),h.setUniform1fv("u_vvSizeFieldStopsValues",
a.values),h.setUniform1fv("u_vvSizeFieldStopsSizes",a.sizes));e.vvSizeUnitValue&&h.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",l.vvSizeUnitValueToPixelsRatio);e.vvColor&&(h.setUniform1fv("u_vvColorValues",l.vvColorValues),h.setUniform4fv("u_vvColors",l.vvColors));e.vvOpacity&&(h.setUniform1fv("u_vvOpacityValues",l.vvOpacityValues),h.setUniform1fv("u_vvOpacities",l.vvOpacities));e.vvRotation&&h.setUniform1f("u_vvRotationType","geographic"===l.vvMaterialParameters.vvRotationType?0:1);b.drawElements(4,
n,5125,4*p);b.bindVAO(null)};return c}(l.default);a.default=f})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushText":function(){define("require exports tslib ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(f,a,e,m,k,l,g){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}e.__extends(c,a);c.prototype.dispose=function(){};c.prototype.getGeometryType=function(){return m.WGLGeometryType.TEXT};
c.prototype.drawGeometry=function(a,c,e,f,h){var b=a.context,d=a.painter,l=a.rendererInfo,m=a.state,n=e.indexCount,p=e.indexFrom;e=g.TextMaterialKey.load(e.materialKey);var r=k.createProgramDescriptor(e.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_haloColor",count:4,type:5121,normalized:!0},{location:4,name:"a_texFontSize",count:4,type:5121},{location:5,name:"a_aux",
count:4,type:5120},{location:6,name:"a_vertexOffset",count:2,type:5122},{location:7,name:"a_texCoords",count:2,type:5123}]}),B=r.bufferLayouts,r=r.attributes;h=d.materialManager.getMaterialProgram(a,e,"materials/text",r,h);f=this._getVAO(b,B,r,f);b.bindProgram(h);b.bindVAO(f);this._setSharedUniforms(h,a,c);d.textureManager.bindTextures(b,h,e);h.setUniformMatrix3fv("u_displayMat3",m.displayMat3);h.setUniformMatrix3fv("u_displayViewMat3",m.displayViewMat3);e.vvSizeMinMaxValue&&h.setUniform4fv("u_vvSizeMinMaxValue",
l.vvSizeMinMaxValue);e.vvSizeScaleStops&&h.setUniform1f("u_vvSizeScaleStopsValue",l.vvSizeScaleStopsValue);e.vvSizeFieldStops&&(a=l.getSizeVVFieldStops(c.key.level),h.setUniform1fv("u_vvSizeFieldStopsValues",a.values),h.setUniform1fv("u_vvSizeFieldStopsSizes",a.sizes));e.vvSizeUnitValue&&h.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",l.vvSizeUnitValueToPixelsRatio);e.vvColor&&(h.setUniform1fv("u_vvColorValues",l.vvColorValues),h.setUniform4fv("u_vvColors",l.vvColors));e.vvOpacity&&(h.setUniform1fv("u_vvOpacityValues",
l.vvOpacityValues),h.setUniform1fv("u_vvOpacities",l.vvOpacities));e.vvRotation&&h.setUniform1f("u_vvRotationType","geographic"===l.vvMaterialParameters.vvRotationType?0:1);h.setUniform1f("u_isHalo",1);b.drawElements(4,n,5125,4*p);h.setUniform1f("u_isHalo",0);b.drawElements(4,n,5125,4*p);b.bindVAO(null)};return c}(l.default);a.default=f})},"esri/views/2d/engine/webgl/brushes/raster/BrushRasterBitmap":function(){define("require exports tslib ../../VertexStream ../WGLBrush ../../../../../webgl/rasterUtils".split(" "),
function(f,a,e,m,k,l){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c._desc={lut:{path:"raster/lut",attributes:{a_position:0,a_texcoord:1}},stretch:{path:"raster/stretch",attributes:{a_position:0,a_texcoord:1}},hillshade:{path:"raster/hillshade",attributes:{a_position:0,a_texcoord:1}}};c._rendererUniformInfos=new Map;return c}e.__extends(c,a);c.prototype.dispose=function(){this._quad&&this._quad.dispose()};c.prototype.prepareState=
function(a,b){a=a.context;a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,b.stencilRef,255)};c.prototype.draw=function(a,b){if(b.source&&!b.suspended){a.timeline.begin(this.name);var c=a.context,e=this.getShaderVariations(b),e=a.painter.materialManager.getProgram(a,this._desc[b.symbolizerParameters.type],e);this.drawWithProgram(c,e,b);a.timeline.end(this.name)}};c.prototype.drawWithProgram=
function(a,b,c,f,g,k){void 0===f&&(f=1);void 0===g&&(g=[0,0]);void 0===k&&(k=!1);this._quad||(this._quad=new m(a,[0,0,1,0,0,1,1,1]));var d=c.symbolizerParameters,h=c.transformGrid,n=c.width,p=c.height,r=c.opacity,z=d.type;a.bindProgram(b);var A=this.getShaderVariations(c),z=this.getUniformInfos(z,a,b,A),A=c.getTextures();l.setTextures(a,b,A.names,A.textures);a=l.getBasicGridUniforms(f,g);k=l.getCommonUniforms(h,[n,p],[c.source.width,c.source.height],r,k);l.setUniforms(b,z,e.__assign(e.__assign({u_coordScale:c.coordScale,
u_dvsMat3:c.transforms.dvs},a),k));d.colormap&&(c=l.getColormapUniforms(d.colormap,d.colormapOffset),l.setUniforms(b,z,c));"stretch"===d.type?(d=l.getStretchUniforms(d),l.setUniforms(b,z,d)):"hillshade"===d.type&&(d=l.getShadedReliefUniforms(d),l.setUniforms(b,z,d));this._quad.draw()};c.prototype.getUniformInfos=function(a,b,c,e){a=0<e.length?a+"-"+e.join("-"):a;if(this._rendererUniformInfos.has(a))return this._rendererUniformInfos.get(a);b=l.getUniformLocationInfos(b,c);this._rendererUniformInfos.set(a,
b);return b};c.prototype.getShaderVariations=function(a){var b=[];"cubic"===a.interpolation&&b.push("bicubic");a.symbolizerParameters.colormap&&b.push("applyColormap");a.transformGrid&&b.push("applyProjection");return b};return c}(k.default);a.default=f})},"esri/views/2d/engine/webgl/mesh/templates/shapingUtils":function(){define("require exports ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../.. ../../alignmentUtils ../../number ../../collisions/BoundingBox".split(" "),
function(f,a,e,m,k,l,g,c,h,b){Object.defineProperty(a,"__esModule",{value:!0});var d=Math.PI/180,n=function(){function a(a,b,c,d){this._rotationT=m.mat2df32.create();this.minZoom=this._yBounds=this._xBounds=0;this.maxZoom=255;var e=c.rect,f=new Float32Array(8);a*=d;b*=d;var g=c.code?e.width*d:c.metrics.width,h=c.code?e.height*d:c.metrics.height;f[0]=a;f[1]=b;f[2]=a+g;f[3]=b;f[4]=a;f[5]=b+h;f[6]=a+g;f[7]=b+h;this._data=f;this._setTextureCoords(e);this._scale=d;this._mosaic=c;this.x=a;this.y=b}Object.defineProperty(a.prototype,
"width",{get:function(){return this._mosaic.metrics.width*this._scale},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"mosaic",{get:function(){return this._mosaic},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"angle",{get:function(){return this._angle},set:function(a){this._angle=a;e.mat2d.identity(this._rotationT);e.mat2d.rotate(this._rotationT,this._rotationT,-a);this._setOffsets(this._data)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"xTopLeft",{get:function(){return this._data[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"yTopLeft",{get:function(){return this._data[1]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"xBottomRight",{get:function(){return this._data[6]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"yBottomRight",{get:function(){return this._data[7]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"texcoords",{get:function(){return this._texcoords},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"textureBinding",{get:function(){return this._mosaic.textureBinding},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"offsets",{get:function(){this._offsets||this._setOffsets(this._data);return this._offsets},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"char",{get:function(){return String.fromCharCode(this._mosaic.code)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"code",
{get:function(){return this._mosaic.code},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"bounds",{get:function(){var a=this._mosaic.metrics,c=a.width*this._scale,d=Math.abs(a.height)*this._scale,a=new Float32Array(8);a[0]=this.x;a[1]=this.y;a[2]=this.x+c;a[3]=this.y;a[4]=this.x;a[5]=this.y+d;a[6]=this.x+c;a[7]=this.y+d;c=e.mat2d.multiply(m.mat2df32.create(),this._rotationT,this._T);m.mat2df32.transformMany(a,a,c);for(var d=c=Infinity,f=0,g=0,h=0;4>h;h++)var k=a[2*h],l=a[2*h+1],
c=Math.min(c,k),d=Math.min(d,l),f=Math.max(f,k),g=Math.max(g,l);a=f-c;g-=d;return new b.default(c+a/2,d+g/2,a,g)},enumerable:!0,configurable:!0});a.prototype.setTransform=function(a){this._T=a;this._offsets=null};a.prototype._setOffsets=function(a){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});var b=this._offsets,c=new Float32Array(8),d=e.mat2d.multiply(m.mat2df32.create(),this._rotationT,this._T);m.mat2df32.transformMany(c,a,d);b.upperLeft=h.i1616to32(8*c[0],
8*c[1]);b.upperRight=h.i1616to32(8*c[2],8*c[3]);b.lowerLeft=h.i1616to32(8*c[4],8*c[5]);b.lowerRight=h.i1616to32(8*c[6],8*c[7])};a.prototype._setTextureCoords=function(a){var b=a.x,c=a.y,d=a.width;a=a.height;this._texcoords={upperLeft:h.i1616to32(b,c),upperRight:h.i1616to32(b+d,c),lowerLeft:h.i1616to32(b,c+a),lowerRight:h.i1616to32(b+d,c+a)}};return a}();a.ShapedGlyph=n;var p=function(a,b){return{code:0,page:0,sdf:!0,rect:new g.Rect(0,0,11,8),textureBinding:b,metrics:{advance:0,height:4,width:a,left:0,
top:0}}},r=function(){function a(a,b,c){this._rotation=0;this._decorate(a,b,c);this.glyphs=a;this.bounds=this._createBounds(a);this.isMultiline=1<b.length;this._hasRotation=0!==c.angle;this._T=this._createGlyphTransform(this.bounds,c);for(b=0;b<a.length;b++)a[b].setTransform(this._T)}a.prototype.setRotation=function(a){if(0!==a||0!==this._rotation){this._rotation=a;var b=this._T;e.mat2d.rotate(b,b,a);a=0;for(b=this.glyphs;a<b.length;a++)b[a].setTransform(this._T)}};a.prototype._decorate=function(a,
b,c){if(c.decoration&&"none"!==c.decoration&&a.length){var d=c.scale;c="underline"===c.decoration?30:20;for(var e=a[0].textureBinding,f=0;f<b.length;f++){var g=b[f];a.push(new n(g.startX*d,g.startY*d+c*d,p((g.width+g.glyphWidthEnd)*d,e),1))}}};Object.defineProperty(a.prototype,"boundsT",{get:function(){var a=this.bounds,c=k.vec2.set(l.vec2f32.create(),a.x,a.y);k.vec2.transformMat2d(c,c,this._T);return this._hasRotation?(a=Math.max(a.width,a.height),new b.default(c[0],c[1],a,a)):new b.default(c[0],
c[1],a.width,a.height)},enumerable:!0,configurable:!0});a.prototype._createBounds=function(a){for(var c=Infinity,d=Infinity,e=0,f=0,g=0;g<a.length;g++)var h=a[g],c=Math.min(c,h.xTopLeft),d=Math.min(d,h.yTopLeft),e=Math.max(e,h.xTopLeft+h.width),f=Math.max(f,h.yBottomRight);a=e-c;f-=d;return new b.default(c+a/2,d+f/2,a,f)};a.prototype._createGlyphTransform=function(a,b){var c=d*b.angle,f=m.mat2df32.create(),g=l.vec2f32.create();e.mat2d.translate(f,f,k.vec2.set(g,b.xOffset,-b.yOffset));b.isCIM?e.mat2d.rotate(f,
f,c):(e.mat2d.translate(f,f,k.vec2.set(g,a.x,a.y)),e.mat2d.rotate(f,f,c),e.mat2d.translate(f,f,k.vec2.set(g,-a.x,-a.y)));return f};return a}();a.ShapingInfo=r;var q=function(){return function(a,b,c,d,e,f){this.startY=this.startX=this.glyphWidthEnd=0;this.start=Math.max(0,Math.min(b,c));this.end=Math.max(0,Math.max(b,c));this.end<a.length&&(this.glyphWidthEnd=a[this.end].metrics.width);this.width=d;this.yMin=e;this.yMax=f}}();a.shapeGlyphs=function(a,b,d){var e=d.scale,f=[],g=[],h=1/d.scale*d.maxLineWidth,
k=b?a.length-1:0,l=b?-1:a.length;b=b?-1:1;for(var m=k,p=0,u=0,v=m,x=v,H=0,K=Infinity,O=0;m!==l;){var L=a[m],N=L.code,L=L.metrics,T=Math.abs(L.top);10!==N&&32!==N&&(K=Math.min(K,T),O=Math.max(O,T+L.height));10===N?(m!==k&&(g.push(new q(a,v,m-b,p,K,O)),K=Infinity,O=0),p=0,v=m+b,x=m+b,u=0):32===N?(x=m+b,u=0,H=L.advance,p+=L.advance):(p>h&&(x!==v?(N=x-2*b,p-=H,g.push(new q(a,v,N,p-u,K,O)),K=Infinity,O=0,v=x,p=u):(g.push(new q(a,v,m-b,p,K,O)),K=Infinity,O=0,x=v=m,p=0)),p+=L.advance,u+=L.advance);m+=b}h=
new q(a,v,m-b,p,K,O);0<=h.start&&h.end<a.length&&g.push(h);for(h=0;h<g.length;h++);k=g[0].yMin;l=d.vAlign;h=d.hAlign;b=l===c.VAlign.Baseline?1:0;k=(1-b)*-k+(g[g.length-1].yMax+d.lineHeight*(g.length-1)+("underline"===d.decoration?4:0)-k)/2*(b?0:l-1)+-26*(b?1:0);for(l=0;l<g.length;l++)for(m=g[l],u=m.start,b=m.end,m=m.width/2*(h+1)*-1-3,p=l*d.lineHeight+k-3,g[l].startX=m,g[l].startY=p;u<=b;u++)v=a[u],10!==v.code&&(x=new n(m+v.metrics.left,p-v.metrics.top,v,e),m+=v.metrics.advance,f.push(x));return new r(f,
g,d)}})},"esri/views/2d/engine/webgl/mesh/factories/matcherUtils":function(){define("require exports tslib ../../../../../../core/Error ../../../../../../core/Logger ../../util/Matcher".split(" "),function(f,a,e,m,k,l){Object.defineProperty(a,"__esModule",{value:!0});var g=k.getLogger("esri/views/2d/engine/webgl/mesh/factories/matcherUtils");a.createMatcher=function(a,f,b){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(c){if(!b)return[2,new l.GraphicMatcher(a)];
switch(b.type){case "simple":case "dot-density":return[2,l.FeatureMatcher.fromBasicRenderer(b,a,f)];case "unique-value":return[2,l.MapMatcher.fromUVRenderer(b,a,f)];case "class-breaks":return[2,l.IntervalMatcher.fromCBRenderer(b,a,f)];case "dictionary":return[2,l.DictionaryMatcher.fromDictionaryRenderer(b,a,f)];default:return g.error(new m("mapview-mesh:invalid-renderer","Unable to handle unknown renderer type")),[2,null]}})})}})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports tslib ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../support/arcadeOnDemand ../../../../../symbols/cim/cimSymbolUtils ../../../../../symbols/cim/utils ../../../arcade/utils".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d){function n(a,b){return e.__awaiter(this,void 0,void 0,function(){var f,g;return e.__generator(this,function(e){switch(e.label){case 0:return f=a||1,"number"===typeof f?[2,function(a,b,c){return f}]:[4,c.createRendererExpression(f,b.spatialReference,b.fields)];case 1:return g=e.sent(),[2,function(a,c,e){return d.callWithFeature(g,a,{$view:e},b.geometryType,c)||1}]}})})}Object.defineProperty(a,"__esModule",{value:!0});var p=k.getLogger("esri/views/2d/engine/webgl/util/Matcher");
f=function(){function a(){this._defaultResult=null}a.fromBasicRenderer=function(b,c,d){return e.__awaiter(this,void 0,void 0,function(){var f,g,k;return e.__generator(this,function(e){switch(e.label){case 0:return[4,h.expandSymbols(b.getSymbols(),d)];case 1:return f=e.sent(),g=new a,f.length?[4,c.createTemplateGroup(f[0],null,b)]:[3,3];case 2:k=e.sent(),g.setDefault(k),e.label=3;case 3:return[2,g]}})})};a.prototype.size=function(){return 1};a.prototype.getDefault=function(){return this._defaultResult};
a.prototype.setDefault=function(a){this._defaultResult=a};a.prototype.match=function(a,b,c,d,e){return this.getDefault()};a.prototype.analyze=function(a,b,c,d,f){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(a){return[2]})})};return a}();a.FeatureMatcher=f;k=function(a){function b(b,c,e,f){var g=a.call(this)||this;g._intervals=[];g._isMaxInclusive=c;f?g._getValue=d.callWithFeature.bind(null,f):b&&b.length?"function"===typeof b?(g._field=null,g._getValue=b):(g._field=
b,g._normalizationInfo=e,g._getValue=g._getValueFromField.bind(g)):g._field=null;return g}e.__extends(b,a);b.fromCBRenderer=function(a,d,f){return e.__awaiter(this,void 0,void 0,function(){var k,l,m,n,p,q,u,r,v,x,G,H,K,O=this;return e.__generator(this,function(y){switch(y.label){case 0:return k=a.isMaxInclusive,l=a.normalizationField,m=a.normalizationTotal,n=a.normalizationType,p=a.field,q={normalizationField:l,normalizationTotal:m,normalizationType:n},(v=u=a.valueExpression)?[4,c.createRendererExpression(u,
f.spatialReference,f.fields)]:[3,2];case 1:v=y.sent(),y.label=2;case 2:return r=v,x=new b(p,k,q,r),[4,h.expandSymbol(a.backgroundFillSymbol,f)];case 3:return G=y.sent(),[4,g.all(a.classBreakInfos.map(function(b){return e.__awaiter(O,void 0,void 0,function(){var c,g,k;return e.__generator(this,function(e){switch(e.label){case 0:return[4,h.expandSymbol(b.symbol,f)];case 1:return c=e.sent(),[4,d.createTemplateGroup(c,G,a)];case 2:return g=e.sent(),k={min:b.minValue,max:b.maxValue},x.add(k,g),[2]}})})}))];
case 4:return y.sent(),[4,h.expandSymbol(a.defaultSymbol,f)];case 5:return(H=y.sent())?[4,d.createTemplateGroup(H,G,a)]:[3,7];case 6:K=y.sent(),x.setDefault(K),y.label=7;case 7:return[2,x]}})})};b.prototype.add=function(a,b){this._intervals.push({interval:a,result:b});this._intervals.sort(function(a,b){return a.interval.min-b.interval.min})};b.prototype.size=function(){return a.prototype.size.call(this)+this._intervals.length};b.prototype.match=function(a,b,c,d,e){if(!this._getValue)return this.getDefault();
a=this._getValue(b,{$view:e},c,d);if(!a&&(null===a||void 0===a||isNaN(a)))return this.getDefault();for(b=0;b<this._intervals.length;b++)if(d=this._intervals[b],c=d.interval,d=d.result,e=this._isMaxInclusive?a<=c.max:a<c.max,a>=c.min&&e)return d;return this.getDefault()};b.prototype._needsNormalization=function(){var a=this._normalizationInfo;return a&&(a.normalizationField||a.normalizationTotal||a.normalizationType)};b.prototype._getValueFromField=function(a){var b=a.attributes[this._field];if(!this._needsNormalization())return b;
var c=this._normalizationInfo,d=c.normalizationField,e=c.normalizationTotal,c=c.normalizationType;a=!!d&&a.attributes[d];if(c)switch(c){case "field":return(a||void 0)&&b/a;case "log":return Math.log(b)*Math.LOG10E;case "percent-of-total":return b/e*100;default:p.error("Found unknown normalization type: "+c)}else p.error("Normalization is required, but no type was set!")};return b}(f);a.IntervalMatcher=k;k=function(a){function b(b,c,e){var f=a.call(this)||this;f._nullResult=null;f._resultsMap=new Map;
e?f._getValue=d.callWithFeature.bind(null,e):b&&b.length?"function"===typeof b[0]?(f._fields=null,f._getValue=b[0]):(f._fields=b,f._seperator=c||"",f._getValue=f._getValueFromFields.bind(f)):f._fields=null;return f}e.__extends(b,a);b.fromUVRenderer=function(a,d,f){return e.__awaiter(this,void 0,void 0,function(){var k,l,m,n,p,q,u,r,v,x,G=this;return e.__generator(this,function(y){switch(y.label){case 0:return k=a.uniqueValueInfos,l=a.fieldDelimiter,m=[a.field],n=a.valueExpression,a.field2&&m.push(a.field2),
a.field3&&m.push(a.field3),[4,h.expandSymbol(a.backgroundFillSymbol,f)];case 1:return p=y.sent(),(u=n)?[4,c.createRendererExpression(n,f.spatialReference,f.fields)]:[3,3];case 2:u=y.sent(),y.label=3;case 3:return q=u,r=new b(m,l,q),[4,g.all(k.map(function(b){return e.__awaiter(G,void 0,void 0,function(){var c,g;return e.__generator(this,function(e){switch(e.label){case 0:return[4,h.expandSymbol(b.symbol,f)];case 1:return c=e.sent(),[4,d.createTemplateGroup(c,p,a)];case 2:return g=e.sent(),"\x3cNull\x3e"===
b.value?r.setNullResult(g):r.add(b.value,g),[2]}})})}))];case 4:return y.sent(),[4,h.expandSymbol(a.defaultSymbol,f)];case 5:return(v=y.sent())?[4,d.createTemplateGroup(v,p,a)]:[3,7];case 6:x=y.sent(),r.setDefault(x),y.label=7;case 7:return[2,r]}})})};b.prototype.setNullResult=function(a){this._nullResult=a};b.prototype.add=function(a,b){this._resultsMap.set(a.toString(),b)};b.prototype.size=function(){return a.prototype.size.call(this)+this._resultsMap.size};b.prototype.match=function(a,b,c,d,e){if(!this._getValue)return this.getDefault();
a=this._getValue(b,{$view:e},c,d);if(null!==this._nullResult&&(null==a||""===a||"\x3cNull\x3e"===a))return this._nullResult;if(!a&&null==a)return this.getDefault();a=a.toString();return this._resultsMap.has(a)?this._resultsMap.get(a):this.getDefault()};b.prototype._getValueFromFields=function(a){for(var b=[],c=0,d=this._fields;c<d.length;c++)b.push(a.attributes[d[c]]);return b.join(this._seperator)};return b}(f);a.MapMatcher=k;k=function(a){function c(b,c,d,e){var f=a.call(this)||this;f._fidToAttributeHash=
new Map;f._attributeHashToGroup=new Map;f._renderer=b;f._fieldMap=b.fieldMap;f._templates=c;f._info=d;f._scaleFn=e;return f}e.__extends(c,a);c.fromDictionaryRenderer=function(a,b,d){return e.__awaiter(this,void 0,void 0,function(){var f;return e.__generator(this,function(e){switch(e.label){case 0:return a.fetchResources({spatialReference:d.spatialReference,fields:d.fields}),[4,n(a.scaleExpression,d)];case 1:return f=e.sent(),[2,new c(a,b,d,f)]}})})};c.prototype._analyzeFeature=function(a,c,d,f,g){return e.__awaiter(this,
void 0,void 0,function(){var k,l,n,q,u,r,v,y,x,z,K,O;return e.__generator(this,function(A){switch(A.label){case 0:k=a.attributes[c];l=this._fidToAttributeHash.get(k);n=this._hashAttributes(a);if(l===n)return[2];if(q=this._attributeHashToGroup.has(n))return[3,4];u=e.__assign(e.__assign({},f),{spatialReference:this._info.spatialReference,abortOptions:g,fields:this._info.fields});r=this._scaleFn(a,d,f);return[4,this._renderer.getSymbolAsync(a,u)];case 1:return v=A.sent(),[4,h.expandSymbol(v,this._info,
g)];case 2:y=A.sent();if("expanded-cim"!==y.type)return p.error(new m("mapview-bad-type","Found unexpected type "+y.type+" in dictionary response")),[2];x=0;for(z=y.layers;x<z.length;x++)K=z[x],K.scaleFactor=r,K.templateHash+="-"+r,"text"===K.type&&"string"===typeof K.text&&-1<K.text.indexOf("[")&&(K.text=b.createLabelOverrideFunction(this._fieldMap,K.text,K.cim.textCase));return[4,this._templates.createTemplateGroup(y,null,this._renderer)];case 3:O=A.sent(),this._attributeHashToGroup.set(n,O),A.label=
4;case 4:return this._fidToAttributeHash.set(k,n),[2]}})})};c.prototype.analyze=function(a,b,c,d,f){return e.__awaiter(this,void 0,void 0,function(){var h,k=this;return e.__generator(this,function(e){switch(e.label){case 0:return h=b.map(function(b){return k._analyzeFeature(b,a,c,d,f)}),[4,g.all(h)];case 1:return e.sent(),[2]}})})};c.prototype.match=function(a,b){a=this._fidToAttributeHash.get(b.attributes[a]);return this._attributeHashToGroup.get(a)};c.prototype._hashAttributes=function(a){var b=
"",c;for(c in this._fieldMap)b+=". "+a.attributes[this._fieldMap[c]];return b};return c}(f);a.DictionaryMatcher=k;f=function(a){function b(b){var c=a.call(this)||this;c._templates=b;return c}e.__extends(b,a);b.prototype.match=function(a,b){return l.isNone(b.symbol)?0:b.groupId?b.groupId:this._templates.createTemplateGroup(b.symbol,null,null)};return b}(f);a.GraphicMatcher=f})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("require exports tslib ../../../../../../core/Error ../../../../../../core/has ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../../../geometry/support/jsonUtils ../../../../../../symbols/SimpleLineSymbol ../../definitions ../../enums ../../WGLDisplayObject ../MeshData ../VertexVector ../templates/WGLLabelTemplate ../templates/WGLLineTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u,v,y){Object.defineProperty(a,"__esModule",{value:!0});var z=l.getLogger("esri.views.2d.engine.webgl.WGLMeshFactory"),A={esriGeometryPoint:"above-right above-center above-left center-center center-left center-right below-center below-left below-right".split(" "),esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null,esriGeometryEnvelope:null};f=function(){function a(a,b,c,d){this._isDD=!1;this._labelsDebugTemplate=
null;this._isDD=g.isSome(c)&&"dot-density"===c.type;this._geometryType=a;this._idField=b;this._templateStore=d}a.prototype.update=function(a,b,c){this._isDD=g.isSome(b)&&"dot-density"===b.type;this._setLabelTemplates(a,b,c)};a.prototype._setLabelTemplates=function(a,b,c){a&&this._validateLabelingInfo(a)&&(this._labelTemplates=a.map(function(a){return x.default.fromLabelClass(b,a.labelClass,c)}))};Object.defineProperty(a.prototype,"templates",{get:function(){return this._templateStore},enumerable:!0,
configurable:!0});a.prototype.createMeshData=function(a){var b=Array(5),c=this._labelTemplates&&0<this._labelTemplates.length,e="esriGeometryPolyline"===this._geometryType?d.HEURISTIC_GLYPHS_PER_LINE:d.HEURISTIC_GLYPHS_PER_FEATURE;b[n.WGLGeometryType.MARKER]=new q.VertexVectors(n.WGLGeometryType.MARKER,a);b[n.WGLGeometryType.FILL]=new q.VertexVectors(n.WGLGeometryType.FILL,a,this._isDD);b[n.WGLGeometryType.LINE]=new q.VertexVectors(n.WGLGeometryType.LINE,a);b[n.WGLGeometryType.TEXT]=new q.VertexVectors(n.WGLGeometryType.TEXT,
a);b[n.WGLGeometryType.LABEL]=new q.VertexVectors(n.WGLGeometryType.LABEL,c?e:0);return new r.MeshData([],b)};a.prototype.analyze=function(a,b,d,f,h){return e.__awaiter(this,void 0,void 0,function(){var k,l,m,n,p,q,u,r,v;return e.__generator(this,function(e){switch(e.label){case 0:return k=a,c.isAborted(h)?[2,[]]:g.isSome(b)?[4,b.analyze(this._idField,a,d,f,h)]:[3,2];case 1:e.sent(),e.label=2;case 2:l=0;for(m=k;l<m.length;l++){n=m[l];p=n.groupId;if(null==p||-1===p)p=b.match(this._idField,n,this._geometryType,
d,f);if(y.isDynamicId(p))for(q=this._templateStore.getDynamicTemplateGroup(p),u=0,r=q;u<r.length;u++)(v=r[u])&&v.analyze&&v.analyze(this._templateStore,n,d,f);n.groupId=p}return[2,this._templateStore.finalize(h).then(function(){return k})]}})})};a.prototype.write=function(a,b,c,d,e,f){var k=this._templateStore.getTemplateGroup(b.groupId),l=b.localId;if(null!=l){var m=new p(l);if(y.isDynamicId(b.groupId))for(var n=0;n<k.length;n++){var q=k[n];q&&q.bindFeature(b,c,d)}if(k&&(b.geometry||b.centroid)){c=
m.displayRecords;q=b.insertAfter;void 0!==q&&(m.insertAfter=q);(d=this._geometryType)||(d=null!=b.centroid?"esriGeometryPolygon":h.getJsonType(b.geometry));for(n=0;n<k.length;n++)if(q=k[n]){var u=a.get(q.geometryType);q.writeMesh(c,u,d,l,b)}q=m.displayRecords.length;g.isSome(f)&&q&&(k=f&&this._findLabelRef(k),this._writeLabels(m,a,l,b,f,k,e));a.pushDisplayObject(m)}}};a.prototype._hasBadLabelClass=function(a,b){var c=a.labelPlacement,d=A[b];if(!a.symbol)return z.warn("No LabelClass symbol specified."),
!0;if(!d)return z.error(new m("mapview-labeling:unsupported-geometry-type","Unable to create labels for Feature Layer, "+b+" is not supported")),!0;d.some(function(a){return a===c})||(d=d[0],c&&z.warn("Found invalid label placement type "+c+" for "+b+". Defaulting to "+d),a.labelPlacement=d);return!1};a.prototype._validateLabelingInfo=function(a){var b=this;return!a.some(function(a){return b._hasBadLabelClass(a.labelClass,b._geometryType)})};a.prototype._findLabelRef=function(a){for(var b=0;b<a.length;b++){var c=
a[b];if(c instanceof v.default)return c}return null};a.prototype._writeLabels=function(a,b,c,e,f,h,k){for(var l=a.displayRecords,m=[],n=0;n<f.length;n++){var p=f[n];if(g.isSome(p)){var q=p.glyphs,u=p.rtl,p=this._labelTemplates[p.classIndex],r=b.get(p.geometryType);p.bindReferenceTemplate(h);p.bindTextInfo(q,u);p.writeMesh(l,r,this._geometryType,c,e,k,m)}}a.metrics=m;d.DEBUG_LABELS&&this._debugLabels(a,b)};a.prototype._debugLabels=function(a,b){var c=a.displayRecords,d=a.id,e=0;for(a=a.metrics;e<a.length;e++)for(var f=
a[e],g=0,h=f.boxes?f.boxes.concat([f.bounds]):[f.bounds];g<h.length;g++){var k=h[g],k={geometry:{paths:[[[f.anchor[0]+f.offsetX+k.center[0]-k.width/2,f.anchor[1]+f.offsetY+k.center[1]+k.height/2],[0,-k.height],[k.width,0],[0,k.height],[-k.width,0]]]},attributes:{}},l=this._getLabelDebugTemplate(),m=b.get(l.geometryType);l.writeMesh(c,m,"esriGeometryPolyline",d,k)}};a.prototype._getLabelDebugTemplate=function(){this._labelsDebugTemplate||(this._labelsDebugTemplate=this._createLabelsDebugTemplate());
return this._labelsDebugTemplate};a.prototype._createLabelsDebugTemplate=function(){var a=new b({style:"solid",width:1,color:[255,0,0,1]});return u.default.fromSimpleLine(null,!1,a,null,!1)};return a}();a.WGLMeshFactory=f})},"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["require","exports","./WGLDisplayRecord","./collisions/Metric","./util/serializationUtils"],function(f,a,e,m,k){return function(){function a(a){this.insertAfter=null;this.id=a;this.displayRecords=[];this.metrics=
[]}a.prototype.copy=function(){var e=new a(this.id);e.set(this);return e};a.prototype.clone=function(){var e=new a(this.id);e.displayRecords=this.displayRecords.map(function(a){return a.clone()});e.metrics=this.metrics.map(function(a){return a.clone()});e.insertAfter=this.insertAfter;return e};a.prototype.set=function(a){this.id=a.id;this.displayRecords=a.displayRecords;this.metrics=a.metrics;this.insertAfter=a.insertAfter};a.prototype.serialize=function(a){a.push(this.id);k.serializeList(a,this.metrics);
k.serializeList(a,this.displayRecords);return a};a.deserialize=function(f){var c=f.readInt32(),g=new a(c),c={id:c},b=k.deserializeList(f,m.default);b.length&&(g.metrics=b);g.displayRecords=k.deserializeList(f,e,c);return g};return a}()})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define(["require","exports","../util/serializationUtils","../util/Writer"],function(f,a,e,m){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(a,e){this.displayObjects=a;this.vertexVectorsMap=
e}Object.defineProperty(a.prototype,"vertexBuffersMap",{get:function(){if(!this._vertexBuffersMap){this._vertexBuffersMap={};for(var a=0;a<this.vertexVectorsMap.length;a++)this._vertexBuffersMap[a]=this.vertexVectorsMap[a].intoBuffers();this.vertexVectorsMap=null}return this._vertexBuffersMap},enumerable:!0,configurable:!0});a.prototype.get=function(a){return this.vertexVectorsMap[a]};a.prototype.pushDisplayObject=function(a){this.displayObjects.push(a)};a.prototype.encode=function(a,f){var c=e.serializeList(new m.default(Uint32Array,
this._guessSize()),this.displayObjects).buffer(),g={};f.push(c);for(var b=0;b<this.vertexVectorsMap.length;b++){var d=this.vertexVectorsMap[b];g[b]={};d.transfer(g[b],f)}a.displayObjects=c;a.vertexBuffersMap=g;this.destroy()};a.prototype.destroy=function(){this.displayObjects=this.vertexVectorsMap=null};a.prototype._guessSize=function(){for(var a=this.displayObjects,e=Math.min(a.length,4),c=0,f=0;f<e;f++)c=Math.max(c,a[f].displayRecords.length);return 2*(12*a.length+a.length*c*40)};return a}();a.MeshData=
f})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(a,e){this._pos=0;e=e?this._roundToNearest(e,a.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(e);this._buffer=new a(this._array);this._ctor=a}Object.defineProperty(a.prototype,"length",{get:function(){return this._pos},enumerable:!0,configurable:!0});a.prototype._roundToNearest=function(a,e){a=Math.round(a);return a+(e-a%e)};
a.prototype._ensureSize=function(a){if(this._pos+a>=this._buffer.length){a=this._roundToNearest(1.5*(this._array.byteLength+a*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);a=new ArrayBuffer(a);var e=new this._ctor(a);e.set(this._buffer,0);this._array=a;this._buffer=e}};a.prototype.writeF32=function(a){this._ensureSize(1);var e=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=a;this._pos++;return e};a.prototype.push=function(a){this._ensureSize(1);var e=this._pos;this._buffer[this._pos++]=
a;return e};a.prototype.writeRegion=function(a){this._ensureSize(a.length);var e=this._pos;this._buffer.set(a,this._pos);this._pos+=a.length;return e};a.prototype.buffer=function(){var a=this._array.slice(0,4*this._pos);this.destroy();return a};a.prototype.seek=function(a){this._pos=a};a.prototype.destroy=function(){this._buffer=this._array=null};return a}();a.default=f})},"esri/views/2d/engine/webgl/mesh/VertexVector":function(){define(["require","exports","../Utils","./VertexBuffer","../util/Writer"],
function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});var l=function(){function a(a,e){this.data=a;this.stride=e}Object.defineProperty(a.prototype,"vertexCount",{get:function(){return this.data.length/(this.stride/4)},enumerable:!0,configurable:!0});a.prototype.transfer=function(a,e){var b=this.data.buffer();a.vertexCount=this.vertexCount;a.data=b;a.stride=this.stride;e.push(b)};return a}();a.default=l;f=function(){function a(a,f,b){void 0===b&&(b=!1);this.geometryType=a;this.indexVector=
new k.default(Uint32Array,f);this.namedVectors={};a=e.getStrides(a,b);for(var c in a){b=a[c];var g=void 0;switch(b%4){case 0:case 2:g=new k.default(Uint32Array,b/4*f);break;case 1:case 3:g=new k.default(Uint8Array,b*f)}this.namedVectors[c]=new l(g,b)}}a.prototype.get=function(a){return this.namedVectors[a].data};a.prototype.getVector=function(a){return this.namedVectors[a]};a.prototype.transfer=function(a,e){var b=this.indexVector.buffer(),c={};e.push(b);for(var f in this.namedVectors){var g=this.namedVectors[f];
c[f]={};g.transfer(c[f],e)}a.geometryType=this.geometryType;a.indexBuffer=b;a.namedBuffers=c;this.destroy()};a.prototype.intoBuffers=function(){var a=m.VertexBuffers.fromVertexVectors(this);this.destroy();return a};a.prototype.destroy=function(){this.namedVectors=this.indexVector=null};return a}();a.VertexVectors=f})},"esri/views/2d/engine/webgl/mesh/VertexBuffer":function(){define(["require","exports","../Utils"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});var m=function(){function a(a,
e,c){this.data=a;this.stride=e;this.vertexCount=c}a.decode=function(f){var g=e.allocateTypedArrayBufferwithData(f.data,f.stride);return new a(g,f.stride,f.vertexCount)};a.fromVertexVector=function(f){var g=e.allocateTypedArrayBufferwithData(f.data.buffer(),f.stride);return new a(g,f.stride,f.vertexCount)};return a}();a.default=m;f=function(){function a(a,e,c){this.geometryType=a;this.indexBuffer=new Uint32Array(e);this.namedBuffers=c}a.decode=function(e){var f=e.geometryType,c=e.indexBuffer,h={},
b;for(b in e.namedBuffers)h[b]=m.decode(e.namedBuffers[b]);return new a(f,c,h)};a.fromVertexVectors=function(e){var f=e.geometryType,c=e.indexVector.buffer(),h={},b;for(b in e.namedVectors)h[b]=m.fromVertexVector(e.namedVectors[b]);return new a(f,c,h)};return a}();a.VertexBuffers=f})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("require exports tslib ../../../../../../core/Logger ../../../../../../core/screenUtils ../../color ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n){Object.defineProperty(a,"__esModule",{value:!0});var p=m.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");f=function(a){function d(c,d,e,f,g,k,l,m,n,p,q,r,J,G,H,K,O){var u=a.call(this)||this;c=h.LineMaterialKey.load(h.createMaterialKey(u.geometryType,c,J));d&&(c.sdf=d.sdf,c.pattern=!0,c.textureBinding=d.textureBinding);u._capType=f;u._joinType=g;u._miterLimitCosine=b.getLimitCosine(k);u.tessellationProperties._fillColor=l;u.tessellationProperties._tl=m;u.tessellationProperties._br=
n;u._hasPattern=p;u._isDashed=q;u._joinOnUTurn=K;u._isColorLocked=r;u._isOutline=J;u._zOrder=H;u.effects=O;u._materialKey=c.data;u.tessellationProperties._bitset=r?1:0;u.tessellationProperties._halfWidth=.5*e;u.tessellationProperties._halfReferenceWidth=.5*G;u._initializeTessellator(!1);return u}e.__extends(d,a);d.fromCIMLine=function(a,b,c,e,f){var h=b.color,m=b.scaleFactor||1,n=b.isDashed,p=b.cap;n&&1===p&&(p=2);var q=b.join,m=k.pt2px(b.width)*m,u=k.pt2px(b.referenceWidth),r=k.pt2px(b.miterLimit),
h=h&&l.premultiplyAlphaRGBA(h)||0;if(!c)return new d(a,c,m,p,q,r,h,0,0,!1,n,b.colorLocked,e,u,b.zOrder,f,b.effects);var v=c.rect,y=v.x+1+c.width,x=v.y+1+c.height,v=g.i1616to32(v.x+1,v.y+1),y=g.i1616to32(y,x);return new d(a,c,m,p,q,r,h,v,y,!0,n,b.colorLocked,e,u,b.zOrder,f,b.effects)};d.fromSimpleLine=function(a,b,e,f,h){var m=e.color,n="solid"!==e.style&&"none"!==e.style,p=c.getCapType(e.cap||"round",n),q=c.getJoinType(e.join||"round"),m=m&&"none"!==e.style&&l.premultiplyAlphaRGBA(m)||0;"none"===
e.style&&(m=0);var u=k.pt2px(e.width);e=e.miterLimit;if(!f)return new d(a,f,u,p,q,e,m,0,0,!1,n,!1,b,u,0,h,null);var r=f.rect,v=r.x+1+f.width,y=r.y+1+f.height,r=g.i1616to32(r.x+1,r.y+1),v=g.i1616to32(v,y);return new d(a,f,u,p,q,e,m,r,v,!0,n,!1,b,u,0,h,null)};d.fromPictureLineSymbol=function(a,b,c,d){p.error("PictureLineSymbol support does not exist!");return null};return d}(d.default(n.default));a.default=f})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("require exports tslib ../../../../../../core/has ../../definitions ../../enums ../../number ../../TileClipper ../../TurboLine ../../WGLDisplayRecord ../../materialKey/MaterialKey ./util".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n){Object.defineProperty(a,"__esModule",{value:!0});var p=k.TILE_SIZE+16,r=1/3.8,q=new c.TileClipper(0,0,0,1,16);q.setExtent(k.TILE_SIZE);var x=new Uint32Array(9),u=new Uint32Array(36),v=new Uint32Array(3),y=new Uint32Array(6),z=function(a){return function(b){var c=Math.ceil(1024*a._halfWidth),d=Math.ceil(1024*a._halfReferenceWidth);b.entry0=a.offset+a.vertexCount++;var e=g.i1616to32(b.distance,c),f=g.i8888to32(Math.round(31*b.prevNormal.x),Math.round(31*b.prevNormal.y),
Math.round(0),Math.round(-31)),h=g.i8888to32(0,0,0,a._bitset);u[0]=g.i1616to32(8*b.currentVertex.x,8*b.currentVertex.y);u[1]=a.id;u[2]=a._fillColor;u[3]=f;u[4]=e;u[5]=a._tl;u[6]=a._br;u[7]=h;u[8]=g.i1616to32(d,0);b.entry2=a.offset+a.vertexCount++;e=g.i1616to32(b.distance,c);f=g.i8888to32(Math.round(31*-b.prevNormal.x),Math.round(31*-b.prevNormal.y),Math.round(0),Math.round(31));h=g.i8888to32(0,0,0,a._bitset);u[9]=g.i1616to32(8*b.currentVertex.x,8*b.currentVertex.y);u[10]=a.id;u[11]=a._fillColor;u[12]=
f;u[13]=e;u[14]=a._tl;u[15]=a._br;u[16]=h;u[17]=g.i1616to32(d,0);b.exit0=a.offset+a.vertexCount++;e=g.i1616to32(b.distance,c);f=g.i8888to32(Math.round(31*b.nextNormal.x),Math.round(31*b.nextNormal.y),Math.round(0),Math.round(-31));h=g.i8888to32(0,0,0,a._bitset);u[18]=g.i1616to32(8*b.currentVertex.x,8*b.currentVertex.y);u[19]=a.id;u[20]=a._fillColor;u[21]=f;u[22]=e;u[23]=a._tl;u[24]=a._br;u[25]=h;u[26]=g.i1616to32(d,0);b.exit2=a.offset+a.vertexCount++;e=g.i1616to32(b.distance,c);f=g.i8888to32(Math.round(31*
-b.nextNormal.x),Math.round(31*-b.nextNormal.y),Math.round(0),Math.round(31));h=g.i8888to32(0,0,0,a._bitset);u[27]=g.i1616to32(8*b.currentVertex.x,8*b.currentVertex.y);u[28]=a.id;u[29]=a._fillColor;u[30]=f;u[31]=e;u[32]=a._tl;u[33]=a._br;u[34]=h;u[35]=g.i1616to32(d,0);a.geometryBuf.writeRegion(u)}},A=function(a){return function(b){y[0]=b.leftExit0;y[1]=b.rightEntry0;y[2]=b.leftExit2;y[3]=b.rightEntry0;y[4]=b.rightEntry2;y[5]=b.leftExit2;a.indexCount+=6;a.indexBuf.writeRegion(y)}},B=function(a){return function(b,
c,d,e,f,h,k,l,m){m=g.i1616to32(m,Math.ceil(1024*a._halfWidth));f=g.i8888to32(Math.round(31*f),Math.round(31*h),Math.round(31*k),Math.round(31*l));d=g.i8888to32(31*d,31*e,0,a._bitset);x[0]=g.i1616to32(8*b,8*c);x[1]=a.id;x[2]=a._fillColor;x[3]=f;x[4]=m;x[5]=a._tl;x[6]=a._br;x[7]=d;x[8]=g.i1616to32(Math.ceil(1024*a._halfReferenceWidth),0);a.geometryBuf.writeRegion(x);return a.offset+a.vertexCount++}},D=function(a){return function(b,c,d){v[0]=b;v[1]=c;v[2]=d;a.indexCount+=3;a.indexBuf.writeRegion(v)}};
a.default=function(a){return function(a){function c(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;b.tessellationProperties={_fillColor:null,_tl:null,_br:null,_halfWidth:null,_bitset:null,_halfReferenceWidth:null,id:null,indexBuf:null,indexCount:null,geometryBuf:null,vertexCount:null,offset:null};b._tessellationOptions={};b.geometryType=l.WGLGeometryType.LINE;return b}e.__extends(c,a);c.prototype.writeMeshWithGeometry=function(a,c,d,e,f,g){d=c.indexVector;f=c.get("geometry");
var h=new b(e,this.geometryType,this._materialKey);c=c.getVector("geometry").vertexCount;h.vertexFrom=c;h.indexFrom=d.length;n.isPolyline(g)?(g=this._clipLines(g.paths),0!==g.length&&(this._write(h,d,f,c,e,g),a.push(h))):n.isPolygon(g)&&(g=this._clipLines(g.rings),0!==g.length&&(this._write(h,d,f,c,e,g),a.push(h)))};c.prototype._clipLines=function(a){for(var b=[],c=!1,d=0;d<a.length;){var e=[],f=a[d];q.reset(2);var g=f[0],h=g[0],g=g[1];if(c)q.moveTo(h,g);else{if(-16>h||h>p||-16>g||g>p){c=!0;continue}e.push({x:h,
y:g})}for(var k=!1,l=f.length,m=1;m<l;++m)if(h+=f[m][0],g+=f[m][1],c)q.lineTo(h,g);else{if(-16>h||h>p||-16>g||g>p){k=!0;break}e.push({x:h,y:g})}if(k)c=!0;else{if(c){if(e=q.resultWithStarts())for(c=0;c<e.length;c++)b.push(e[c])}else b.push({line:e,start:0});d++;c=!1}}return b};c.prototype._write=function(a,b,c,d,e,f){this.tessellationProperties.id=e;this.tessellationProperties.indexBuf=b;this.tessellationProperties.indexCount=0;this.tessellationProperties.geometryBuf=c;this.tessellationProperties.vertexCount=
0;this.tessellationProperties.offset=d;for(b=0;b<f.length;b++)c=f[b],d=c.line,2>d.length||(this._tessellationOptions.initialDistance=c.start%65535,this._tessellationCallbacks instanceof h.StandardTessellationCallbacks&&(this._tessellationCallbacks.capType=this._capType,this._tessellationCallbacks.joinType=this._joinType),h.tessellate(d,this._tessellationOptions,this._tessellationCallbacks),h.cleanup());a.vertexCount=this.tessellationProperties.vertexCount;a.indexCount=this.tessellationProperties.indexCount;
a.zOrder=this._zOrder};c.prototype._initializeTessellator=function(a){var b=d.LineMaterialKey.load(this._materialKey);this._tessellationOptions.trackDistance=this._isDashed||this._hasPattern;this._tessellationOptions.thin=!a&&this.tessellationProperties._halfWidth<k.THIN_LINE_THRESHOLD/2&&!(b.vvSizeFieldStops||b.vvSizeMinMaxValue||b.vvSizeScaleStops||b.vvSizeUnitValue);this._tessellationOptions.wrapDistance=65535;this._tessellationOptions.outerBisectorAutoSplitThreshold=r;this._tessellationOptions.enableOuterBisectorSplit=
this._isDashed||this._hasPattern;this._tessellationOptions.innerBisectorAutoSplitThreshold=r;this._tessellationOptions.enableInnerBisectorSplit=this._isDashed||this._hasPattern;this._tessellationOptions.thin?this._tessellationCallbacks={vertex:z(this.tessellationProperties),bridge:A(this.tessellationProperties)}:(a=new h.StandardTessellationCallbacks(B(this.tessellationProperties),D(this.tessellationProperties)),a.miterLimitCosine=this._miterLimitCosine,a.textured=this._isDashed||this._hasPattern,
a.joinOnUTurn=this._joinOnUTurn,this._tessellationCallbacks=a)};return c}(a)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("require exports tslib ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),function(f,a,e,m,k,l,g,c,h,b,
d,n,p){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function f(c,e,f,h,k,m,n,p,q,r,F,I,J,G,H,K,O,L,N,T,R){var u=a.call(this)||this;u.angle=h;u.height=n;u.width=m;u.xOffset=e*N;u.yOffset=f*N;u._markerPlacement=T;u.effects=R;u._anchorX=.5-((.5+K)*H.width+1)/H.rect.width;u._anchorY=.5-((.5+O)*H.height+1)/H.rect.height;e=(1===G?1:0)|(F?1:0)<<1|(J?1:0)<<2|(I?1:0)<<3;f=H&&H.sdf;c=d.MarkerMaterialKey.load(d.createMaterialKey(u.geometryType,c,!1));c.sdf=f;c.pattern=!0;c.textureBinding=H.textureBinding;
u._materialKey=c.data;u._fillColor=k;u._outlineColor=q;u._sizeOutlineWidth=b.i8888to32(Math.round(Math.min(Math.sqrt(128*m),255)),Math.round(Math.min(Math.sqrt(128*n),255)),Math.round(Math.min(Math.sqrt(128*r),255)),Math.round(Math.min(Math.sqrt(128*p),255)));k=H.rect.x;p=H.rect.y;q=k+H.rect.width;r=p+H.rect.height;u._texUpperLeft=b.i1616to32(k,p);u._texUpperRight=b.i1616to32(q,p);u._texBottomLeft=b.i1616to32(k,r);u._texBottomRight=b.i1616to32(q,r);m=m*L*N;n=n*L*N;u._bitestAndDistRatio=b.i8888to32(0,
0,e,Math.round(Math.min(64*L,255)));m*=H.rect.width/H.width;n*=H.rect.height/H.height;u._computedWidth=m;u._computedHeight=n;m=g.vec2f32.create();n=l.mat2df32.create();u._applyTransformation(n,m);return u}e.__extends(f,a);f.fromCIMMarker=function(a,b,d){var e=b.size,g=(d&&d.width||1)/(d&&d.height||1)*b.scaleX,h=b.scaleSymbolsProportionally&&b.frameHeight?e/b.frameHeight:1,l=c.premultiplyAlphaRGBA(b.color),n=c.premultiplyAlphaRGBA(b.outlineColor),p=k.pt2px(e),q=p*g,u=k.pt2px(b.offsetX||0),r=k.pt2px(b.offsetY||
0),h=k.pt2px(b.outlineWidth||0)*h,v=b.alignment||0,x=k.pt2px(b.referenceSize),H=b.rotation||0;b.rotateClockwise||(H=-H);var K=0,O=0,L=b.anchorPoint;L&&(b.isAbsoluteAnchorPoint?e&&(K=-L.x/(e*g),O=L.y/e):(K=L.x,O=L.y));return new f(a,u,r,H,l,q,p,x,n,h,b.colorLocked,b.scaleSymbolsProportionally,!1,v,d,K,O,b.sizeRatio,m.unwrapOr(b.scaleFactor,1),b.markerPlacement,b.effects)};f.fromPictureMarker=function(a,b,c){var d=Math.round(k.pt2px(b.width)),e=Math.round(k.pt2px(b.height)),g=h.PICTURE_FILL_COLOR,l=
Math.round(k.pt2px(b.xoffset||0)),m=Math.round(k.pt2px(b.yoffset||0));return new f(a,l,m,b.angle,g,d,e,e,0,0,!1,!1,!1,0,c,0,0,1,1,null,null)};f.fromSimpleMarker=function(a,b,d){var e=c.premultiplyAlphaRGBA(b.color),g=Math.round(k.pt2px(b.size)),h=Math.round(k.pt2px(b.xoffset||0)),l=Math.round(k.pt2px(b.yoffset||0)),m=b.style,n=b.outline,p=(n&&n.color&&c.premultiplyAlphaRGBA(n.color))|0,n=(n&&n.width&&Math.round(k.pt2px(n.width)))|0;a=new f(a,h,l,b.angle,e,g,g,g,p,n,!1,!1,"cross"===m||"x"===m,0,d,
0,0,1.96875,1,null,null);a.boundsType="circle"===m?"circle":"square";return a};f.fromLineSymbolMarker=function(a,b,d){var e=b.marker,g=e.color?c.premultiplyAlphaRGBA(e.color):c.premultiplyAlphaRGBA(b.color),h=Math.round(k.pt2px(6*b.width)),l=e.style,m="cross"===l||"x"===l;switch(e.placement){case "begin-end":e="Both";break;case "begin":e="JustBegin";break;case "end":e="JustEnd";break;default:e="None"}e={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:e,offsetAlongLine:0};
a=new f(a,0,0,0,g,h,h,h/6,g,m?Math.round(k.pt2px(b.width)):0,!1,!1,m,1,d,0,0,1.96875,1,e,null);a.boundsType="circle"===l?"circle":"square";return a};return f}(n.default(p.default));a.default=f})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("require exports tslib ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../enums ../../number ../../WGLDisplayRecord ./util".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q){Object.defineProperty(a,"__esModule",{value:!0});var x=m.getLogger("esri.views.2d.engine.webgl.WGLMarkerTemplateBase"),u=3.14159265359/180;a.default=function(a){return function(a){function f(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;b.angle=0;b.xOffset=0;b.yOffset=0;b.width=0;b.height=0;b.boundsType="square";b._anchorX=0;b._anchorY=0;b._computedWidth=0;b._computedHeight=0;b.geometryType=n.WGLGeometryType.MARKER;return b}
e.__extends(f,a);f.prototype.writeMeshWithGeometry=function(a,b,c,d,e,f){c=b.indexVector;var g=b.get("geometry"),h=new r(d,this.geometryType,this._materialKey);b=b.getVector("geometry").vertexCount;a.push(h);h.vertexFrom=b;h.indexFrom=c.length;this._markerPlacement?this._writePlacedMarkers(h,g,c,b,d,e,f):q.isPoint(f)?(a=f.x,f=f.y,this._writeVertices(h,g,d,this._getPos(a,f)),this._writeIndices(h,c,b)):q.isPolyline(f)?this._writeMany(h,c,g,b,d,f.paths[0]):q.isPolygon(f)?(f=e.centroid)?(a=f.x,f=f.y,
this._writeVertices(h,g,d,this._getPos(a,f)),this._writeIndices(h,c,b)):x.error("Tried to render polygon geometries as markers, but found no centroid!"):q.isMultipoint(f)&&this._writeMany(h,c,g,b,d,f.points)};f.prototype._applyTransformation=function(a,c,d){void 0===d&&(d=0);g.mat2d.identity(a);g.mat2d.translate(a,a,b.vec2f32.fromValues(this.xOffset,-this.yOffset));0!==this.angle+d&&g.mat2d.rotate(a,a,u*(this.angle+d));d=this._computedWidth;var e=this._computedHeight,f=(this._anchorX-.5)*d,k=(this._anchorY-
.5)*e;h.vec2.set(c,f,k);h.vec2.transformMat2d(c,c,a);this._offsetUpperLeft=p.i1616to32(16*c[0],16*c[1]);h.vec2.set(c,f+d,k);h.vec2.transformMat2d(c,c,a);this._offsetUpperRight=p.i1616to32(16*c[0],16*c[1]);h.vec2.set(c,f,k+e);h.vec2.transformMat2d(c,c,a);this._offsetBottomLeft=p.i1616to32(16*c[0],16*c[1]);h.vec2.set(c,f+d,k+e);h.vec2.transformMat2d(c,c,a);this._offsetBottomRight=p.i1616to32(16*c[0],16*c[1])};f.prototype._writePlacedMarkers=function(a,e,f,g,h,m,n){if(m=d.CIMMarkerPlacementHelper.getPlacement(n,
k.unwrap(this._markerPlacement),l.pt2px(1))){n=b.vec2f32.create();for(var p=c.mat2df32.create(),q=0,r=m.next();null!=r;)-128<=r.tx&&640>=r.tx&&-128<=r.ty&&640>=r.ty&&(this._applyTransformation(p,n,r.getAngle()/u),this._writeVertices(a,e,h,this._getPos(r.tx,r.ty)),this._writeIndices(a,f,g+q),q+=4),r=m.next()}};f.prototype._getPos=function(a,b){return p.i1616to32(Math.round(8*a),Math.round(8*b))};f.prototype._writeMany=function(a,b,c,d,e,f){for(var g=0,h=0,k=0,l=0;l<f.length;l++){var m=f[l],n=m[0],
m=m[1],p=this._getPos(n+g,m+h);this._writeVertices(a,c,e,p);this._writeIndices(a,b,d+k);g+=n;h+=m;k+=4}};f.prototype._writeVertices=function(a,b,c,d){b.push(d);b.push(this._offsetUpperLeft);b.push(this._texUpperLeft);b.push(this._bitestAndDistRatio);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);b.push(d);b.push(this._offsetUpperRight);b.push(this._texUpperRight);b.push(this._bitestAndDistRatio);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);
b.push(this._sizeOutlineWidth);b.push(d);b.push(this._offsetBottomLeft);b.push(this._texBottomLeft);b.push(this._bitestAndDistRatio);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);b.push(d);b.push(this._offsetBottomRight);b.push(this._texBottomRight);b.push(this._bitestAndDistRatio);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);a.vertexCount+=4};f.prototype._writeIndices=function(a,b,c){b.push(c+0);b.push(c+
1);b.push(c+2);b.push(c+1);b.push(c+3);b.push(c+2);a.indexCount+=6};return f}(a)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("require exports tslib ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaults ./WGLDynamicFillTemplate ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/Lock ../../util/Result ../../../../layers/features/textUtils".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u,v){function y(a,b){var c=a.length;a.push(null);b.then(function(b){return a[c]=b});return a}function z(a){return!!(a&1)}Object.defineProperty(a,"__esModule",{value:!0});var A=k.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),B=[];a.isDynamicId=z;f=function(){function a(a,b){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=
new Map;this._cimAnalyses=[];this._lock=new x.default;this._fetchResource=a;this._joinOnUTurn=b}Object.defineProperty(a.prototype,"_markerError",{get:function(){return this._errorTemplates.marker[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"_fillError",{get:function(){return this._errorTemplates.fill[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"_lineError",{get:function(){return this._errorTemplates.line[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"_textError",{get:function(){return this._errorTemplates.line[0]},enumerable:!0,configurable:!0});a.prototype.createTemplateGroup=function(a,b,c){this._initErrorTemplates();var d=a.hash();if(this._symbolToTemplate.has(d))return this._symbolToTemplate.get(d);var e=[];b&&this._createMeshTemplates(e,b,c,!0);this._createMeshTemplates(e,a,c,!1);a=this._createGroupId("expanded-cim"===a.type);this._idToTemplateGroup.set(a,e);this._symbolToTemplate.set(d,a);return a};a.prototype.getTemplateGroup=function(a){return this._idToTemplateGroup.has(a)?
this._idToTemplateGroup.get(a):B};a.prototype.getDynamicTemplateGroup=function(a){if(!this._idToTemplateGroup.has(a))return B;z(a)||A.error("mapview-template-store","Id "+a+" does not refer to a dynamic template");return this._idToTemplateGroup.get(a)};a.prototype.getMosaicItem=function(a,b,c){var d=this,e=this._createTemplateId(),f=l.create(function(a){return d._idToResolver.set(e,a)});a=b?a.toJSON():a;this._fetchQueue.push({symbol:a,id:e,glyphIds:c});return f};a.prototype.finalize=function(a){return this._fetchQueue.length||
this._lock.isHeld()?x.withLock(this._lock,this._fetchAllQueuedResources.bind(this),a):l.resolve()};a.prototype._initErrorTemplates=function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],g.errorPolygonSymbol2D,null,!1),marker:this._createMeshTemplates([],g.errorPointSymbol2D,null,!1),line:this._createMeshTemplates([],g.errorPolylineSymbol2D,null,!1)})};a.prototype._fetchAllQueuedResources=function(a){var b=this;if(!this._fetchQueue.length)return l.resolve();var c=
this._fetchQueue,d=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return l.all(d).then(function(){return b._fetchResource(c,a).then(function(a){for(var c=0;c<a.length;c++){var d=a[c],e=d.id,d=d.mosaicItem;b._idToResolver.get(e)(d);b._idToResolver.delete(e)}})}).catch(function(a){l.isAbortError(a)?b._fetchQueue=b._fetchQueue.concat(c):A.error(new m("mapview-template-store","Unable to fetch requested texture resources",a))})};a.prototype._createGroupId=function(a){return this._idCounter++<<
1|(a?1:0)};a.prototype._createTemplateId=function(){return this._templateIdCounter++};a.prototype._createSMS=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c;return e.__generator(this,function(d){switch(d.label){case 0:return[4,this.getMosaicItem(a,!0)];case 1:return c=d.sent().spriteMosaicItem,u.ok(c,A)?[2,r.default.fromSimpleMarker(b,a,c)]:[2,this._markerError]}})})};a.prototype._createPMS=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c;return e.__generator(this,
function(d){switch(d.label){case 0:return[4,this.getMosaicItem(a,!0)];case 1:return c=d.sent().spriteMosaicItem,u.ok(c,A)?[2,r.default.fromPictureMarker(b,a,c)]:[2,this._markerError]}})})};a.prototype._createSFS=function(a,b,c){return e.__awaiter(this,void 0,void 0,function(){var d,f;return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.getMosaicItem(a,!0)];case 1:return d=e.sent().spriteMosaicItem,f=a,u.ok(d,A)?[2,n.default.fromSimpleFill(b,f,d,c)]:[2,this._fillError]}})})};
a.prototype._createPFS=function(a,b,c){return e.__awaiter(this,void 0,void 0,function(){var d,f;return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.getMosaicItem(a,!0)];case 1:return d=e.sent().spriteMosaicItem,f=a,u.ok(d,A)?[2,n.default.fromPictureFill(b,f,d,c)]:[2,this._fillError]}})})};a.prototype._createSLS=function(a,b,c){return e.__awaiter(this,void 0,void 0,function(){var d,f;return e.__generator(this,function(e){switch(e.label){case 0:return[4,this.getMosaicItem(a,!0)];
case 1:return d=e.sent().spriteMosaicItem,f=a,u.ok(d,A)?[2,p.default.fromSimpleLine(b,c,f,d,this._joinOnUTurn)]:[2,this._lineError]}})})};a.prototype._createLMS=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d;return e.__generator(this,function(e){switch(e.label){case 0:return c=a,[4,this.getMosaicItem(c.marker,!0)];case 1:return d=e.sent().spriteMosaicItem,u.ok(d,A)?[2,r.default.fromLineSymbolMarker(b,c,d)]:[2,this._markerError]}})})};a.prototype._createTS=function(a,b){return e.__awaiter(this,
void 0,void 0,function(){var c;return e.__generator(this,function(d){switch(d.label){case 0:return[4,this.getMosaicItem(a,!0)];case 1:return c=d.sent().glyphMosaicItems,[2,q.default.fromText(b,a,c)]}})})};a.prototype._createCIMText=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c;return e.__generator(this,function(d){switch(d.label){case 0:return[4,this.getMosaicItem(a.cim,!1,v.codepoints(a.text))];case 1:return c=d.sent().glyphMosaicItems,a.cim.mosaicHash=a.materialHash,u.ok(c,
A)?[2,q.default.fromCIMText(b,a,c)]:[2,this._textError]}})})};a.prototype._createCIMFill=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c;return e.__generator(this,function(d){switch(d.label){case 0:return a.cim.mosaicHash=a.materialHash,[4,this.getMosaicItem(a.cim,!1)];case 1:return c=d.sent().spriteMosaicItem,u.ok(c,A)?[2,n.default.fromCIMFill(b,a,c,!1)]:[2,this._fillError]}})})};a.prototype._createCIMLine=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c;
return e.__generator(this,function(d){switch(d.label){case 0:return a.cim.mosaicHash=a.materialHash,[4,this.getMosaicItem(a.cim,!1)];case 1:return c=d.sent().spriteMosaicItem,u.ok(c,A)?[2,p.default.fromCIMLine(b,a,c,!1,this._joinOnUTurn)]:[2,this._lineError]}})})};a.prototype._createCIMMarker=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c;return e.__generator(this,function(d){switch(d.label){case 0:return a.cim.mosaicHash=a.materialHash,[4,this.getMosaicItem(a.cim,!1)];case 1:return c=
d.sent().spriteMosaicItem,u.ok(c,A)?[2,r.default.fromCIMMarker(b,a,c)]:[2,this._markerError]}})})};a.prototype._createCIM=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d,f=this;return e.__generator(this,function(e){c=a.templateHash;if(this._cimTemplateCache.has(c))return[2,this._cimTemplateCache.get(c)];switch(a.type){case "marker":d=this._createCIMMarker(a,b);break;case "line":d=this._createCIMLine(a,b);break;case "fill":d=this._createCIMFill(a,b);break;case "text":d=this._createCIMText(a,
b)}d.then(function(a){return f._cimTemplateCache.set(c,a)});return[2,d]})})};a.prototype._createDynamicCIM=function(a,e){var f=a.templateHash;if(this._cimTemplateCache.has(f))return this._cimTemplateCache.get(f);var g;switch(a.type){case "marker":g=b.default.fromCIMMarker(e,a);break;case "line":g=h.default.fromCIMLine(e,a);break;case "fill":g=c.default.fromCIMFill(e,a);break;case "text":g=d.default.fromCIMText(e,a)}this._cimTemplateCache.set(f,g);return g};a.prototype._createMeshTemplates=function(a,
b,c,d){if(-1!==b.type.indexOf("3d"))return A.error("3D symbols are not supported with MapView"),a;switch(b.type){case "cim":return A.error(new m("mapview-bad-type","Found a cim type not yet expanded")),a;case "expanded-cim":d=0;for(b=b.layers;d<b.length;d++){var e=b[d];"function"===typeof e.materialHash?a.push(this._createDynamicCIM(e,c)):y(a,this._createCIM(e,c))}return a;case "simple-marker":return y(a,this._createSMS(b,c));case "picture-marker":return y(a,this._createPMS(b,c));case "simple-fill":return y(a,
this._createSFS(b,c,d)),b.outline&&y(a,this._createSLS(b.outline,c,!0)),a;case "picture-fill":return y(a,this._createPFS(b,c,d)),b.outline&&y(a,this._createSLS(b.outline,c,!0)),a;case "simple-line":return y(a,this._createSLS(b,c,!1)),b.marker&&y(a,this._createLMS(b,c)),a;case "text":return y(a,this._createTS(b,c));default:return A.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),a}};return a}();a.WGLTemplateStore=f})},"esri/symbols/support/defaults":function(){define("require exports ../../core/compilerUtils ../../core/maybe ../SimpleFillSymbol ../SimpleLineSymbol ../SimpleMarkerSymbol ../TextSymbol ./defaultsJSON".split(" "),
function(f,a,e,m,k,l,g,c,h){Object.defineProperty(a,"__esModule",{value:!0});a.defaultPointSymbol2D=g.fromJSON(h.defaultPointSymbolJSON);a.defaultPolylineSymbol2D=l.fromJSON(h.defaultPolylineSymbolJSON);a.defaultPolygonSymbol2D=k.fromJSON(h.defaultPolygonSymbolJSON);a.defaultTextSymbol2D=c.fromJSON(h.defaultTextSymbolJSON);a.getDefaultSymbol2D=function(b){if(m.isNone(b))return null;switch(b.type){case "mesh":break;case "point":case "multipoint":return a.defaultPointSymbol2D;case "polyline":return a.defaultPolylineSymbol2D;
case "polygon":case "extent":return a.defaultPolygonSymbol2D;default:e.neverReached(b)}return null};a.errorPointSymbol2D=g.fromJSON(h.errorPointSymbolJSON);a.errorPolylineSymbol2D=l.fromJSON(h.errorPolylineSymbolJSON);a.errorPolygonSymbol2D=k.fromJSON(h.errorPolygonSymbolJSON)})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicFillTemplate":function(){define("require exports tslib ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../color ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function d(c,d){var e=a.call(this,d)||this;if(b.isFunction(d.color))e._dynamicPropertyMap.set("_fillColor",function(a,b,c){return(a=d.color(a,b,c))&&l.premultiplyAlphaRGBA(a)||0});else{var f=d.color;e.fillColor=f&&l.premultiplyAlphaRGBA(f)||0}var m=0;b.isFunction(d.height)||(m=d.height||0);e._dynamicPropertyMap.set("_height",function(a,c,e){return b.isFunction(d.height)?d.height(a,c,e):m});var n=0;b.isFunction(d.offsetX)||
(n=k.pt2px(d.offsetX||0)+128,255<n&&(n=255));e._dynamicPropertyMap.set("_offsetX",function(a,c,e){return b.isFunction(d.offsetX)?(a=k.pt2px(d.offsetX(a,c,e))+128,255<a&&(a=255),a):n});var p=1;b.isFunction(d.scaleX)||(p=d.scaleX||1);e._dynamicPropertyMap.set("_scaleX",function(a,c,e){return b.isFunction(d.scaleX)?d.scaleX(a,c,e):p});var q=0;b.isFunction(d.offsetY)||(q=k.pt2px(-d.offsetY||0)+128,255<q&&(q=255));e._dynamicPropertyMap.set("_offsetY",function(a,c,e){return b.isFunction(d.offsetY)?(a=k.pt2px(-d.offsetY(a,
c,e))+128,255<a&&(a=255),a):q});var r=0;b.isFunction(d.angle)||(r=g.radToByte(d.angle)||0);e._dynamicPropertyMap.set("_angle",function(a,c,e){return b.isFunction(d.angle)?g.radToByte(d.angle(a,c,e)):r});e.isBFS=!1;e.effects=d.effects;e._cimFillLayer=d;e._fillMaterialKey=h.FillMaterialKey.load(h.createMaterialKey(e.geometryType,c,!1));return e}e.__extends(d,a);d.fromCIMFill=function(a,b){return new d(a,b)};d.prototype.bindFeature=function(a,b,d){var e=this;this._dynamicPropertyMap.forEach(function(c,
f){e[f]=c(a,b,d)});var f=this._fillMaterialKey,g=this._materialCache,h=this._cimFillLayer;this.aux3=c.i8888to32(0,0,this._angle,h.colorLocked?1:0);h=h.materialHash;h=h(a,b,d);h=g.get(h);g=null;h&&p.ok(h.spriteMosaicItem)&&(g=h.spriteMosaicItem);if(g){var l=g.rect,n=g.width,q=g.height,h=l.x+1,l=l.y+1,r=h+n,u=l+q,v=m.nextHighestPowerOfTwo(k.pt2px(this._height));255<v?v=255:0>=v&&(v=m.nextHighestPowerOfTwo(u-l));n=m.nextHighestPowerOfTwo(k.pt2px(this._height/q*n||0));255<n?n=255:0>=n&&(n=m.nextHighestPowerOfTwo(r-
h));q=this._scaleX;this.tl=c.i1616to32(h,l);this.br=c.i1616to32(r,u);this.aux1=c.i8888to32(n,v,this._offsetX,this._offsetY);this.aux2=c.i1616to32(128*q,128);f.sdf=g.sdf;f.pattern=!0;f.textureBinding=g.textureBinding}else this.aux2=this.aux1=this.br=this.tl=0,f.sdf=!1,f.pattern=!1,f.textureBinding=0;this._materialKey=f.data};return d}(d.default(n.default));a.default=f})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseFillTemplate":function(){define("require exports tslib ../../../../../../core/Logger ../../../../../../core/libs/earcut/earcut ../../definitions ../../enums ../../number ../../TileClipper ../../WGLDisplayRecord ../../materialKey/MaterialKey ../Tesselator".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n){Object.defineProperty(a,"__esModule",{value:!0});var p=m.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLBaseFillTemplate"),r=[],q=[];a.default=function(a){return function(a){function f(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;b.forceLibtess=!1;b.geometryType=g.WGLGeometryType.FILL;b._tesselator=new n.default;b._tileClipper=new h.TileClipper(0,0,0,1,8);b._tileClipper.setExtent(l.TILE_SIZE);return b}e.__extends(f,
a);f.prototype.writeMeshWithGeometry=function(a,b,c,e,f,g){r.length=0;if("esriGeometryPolygon"!==c)"esriGeometryPolyline"!==c&&p.error("Unable to handle geometryType: "+c);else{c=d.FillMaterialKey.load(this._materialKey);var h=(f=this._isClippingRequired(g))?this._clip(g,!1):g.rings;if(c.dotDensity){g=g.rings;for(var k=0,l=0;l<g.length;l++)for(var m=g[l],n=m[0],q=n[0],n=n[1],u=1;u<m.length;u++)var v=m[u],y=q+v[0],v=n+v[1],k=k-(y-q)*(v+n)/2,q=y,n=v;g=k}else g=0;this.forceLibtess?this._writeMeshLibtess(a,
b,e,h,f,c,g):this._writeMeshEarcut(a,b,e,h,f,c,g)||this._writeMeshLibtess(a,b,e,h,f,c,g)}};f.prototype._isClippingRequired=function(a){var b=l.TILE_SIZE+8,c=0;for(a=a.rings;c<a.length;c++){var d=a[c],e=d.length;if(!(3>e)){var f=d[0][0],g=d[0][1];if(-8>f||f>b||-8>g||g>b)return!0;for(var h=1;h<e;++h)if(f+=d[h][0],g+=d[h][1],-8>f||f>b||-8>g||g>b)return!0}}return!1};f.prototype._clip=function(a,b){var c;this._tileClipper.reset(3);for(var d=0,e=a.rings;d<e.length;d++){var f=e[d],g=f.length;if(!(3>g)){a=
f[0][0];c=f[0][1];this._tileClipper.moveTo(a,c);for(var h=1;h<g;++h)a+=f[h][0],c+=f[h][1],this._tileClipper.lineTo(a,c);this._tileClipper.close()}}return this._tileClipper.result(b)};f.prototype._writeMeshLibtess=function(a,c,d,e,f,g,h){if(e&&e.length){var k=[],l=c.indexVector;c=c.getVector("geometry");var m=new b(d,this.geometryType,this._materialKey),n=c.vertexCount;m.vertexFrom=n;m.indexFrom=l.length;this._tesselator.beginPolygon(r,k);for(var p=0;p<e.length;p++){var q=e[p];if(!(3>q.length)){this._tesselator.beginContour();
var u=void 0,v=void 0;f?(u=q[0].x,v=q[0].y):(u=q[0][0],v=q[0][1]);var y=[u,v,0];this._tesselator.addVertex(y,y);for(y=1;y<q.length-1;y++){var x=void 0,z=void 0;f?(u=q[y].x,v=q[y].y):(x=q[y][0],z=q[y][1],u+=x,v+=z);x=[u,v,0];this._tesselator.addVertex(x,x)}this._tesselator.endContour()}}this._tesselator.endPolygon();this._writeVerticesLibTess(m,c,d,r,g,h);this._writeIndicesLibTess(m,l,n,k);0<m.indexCount&&a.push(m)}};f.prototype._writeMeshEarcut=function(a,c,d,e,f,g,h){if(e&&e.length){var k=c.indexVector;
c=c.getVector("geometry");var l=new b(d,this.geometryType,this._materialKey),m=k.length,n=c.data.length;l.vertexFrom=c.vertexCount;l.indexFrom=k.length;for(var p=0,u=0,v=0;v<e.length;v++){var y=e[v],x=u,z=void 0,A=void 0;f?(z=y[0].x,A=y[0].y):(z=y[0][0],A=y[0][1]);r[u++]=z;r[u++]=A;for(var B=0,E=1;E<y.length;++E){var C=void 0,D=void 0;f?(C=z,D=A,z=y[E].x,A=y[E].y,C=z-C,D=A-D):(C=y[E][0],D=y[E][1],z+=C,A+=D);B-=C*(A+A-D);r[u++]=z;r[u++]=A}if(0<B){if(0<x-p){if(!this._write(l,k,c,d,r,q,p,x,g,h))return k.seek(m),
c.data.seek(n),r.length=q.length=0,!1;p=x}q.length=0}else 0>B?0<x-p?q.push(.5*(x-p)):u=x:u=x}if(0<u-p&&!this._write(l,k,c,d,r,q,p,u,g,h))return k.seek(m),c.data.seek(n),r.length=q.length=0,!1;r.length=q.length=0;a.push(l);return!0}};f.prototype._write=function(a,b,c,d,e,f,g,h,l,m){e=e.slice(g,h);g=k.earcut(e,f,2);if(0<k.deviation(e,f,2,g))return!1;if(g.length)return f=c.vertexCount,this._writeVertices(a,c,d,e,l,m),this._writeIndices(a,b,f,g),!0};f.prototype._writeVertices=function(a,b,d,e,f,g){for(var h=
0;h<e.length;h+=2){var k=c.i1616to32(8*e[h],8*e[h+1]);b.data.push(k);b.data.push(d);f.dotDensity?b.data.writeF32(1/g):(b.data.push(this.fillColor),b.data.push(this.tl),b.data.push(this.br),b.data.push(this.aux1),b.data.push(this.aux2),b.data.push(this.aux3));a.vertexCount++}};f.prototype._writeIndices=function(a,b,c,d){for(var e=0;e<d.length;e+=3)b.push(c+d[e]),b.push(c+d[e+1]),b.push(c+d[e+2]),a.indexCount+=3};f.prototype._writeVerticesLibTess=function(a,b,d,e,f,g){for(var h=0;h<e.length;h+=2){var k=
c.i1616to32(8*e[h],8*e[h+1]);b.data.push(k);b.data.push(d);f.dotDensity?b.data.writeF32(1/g):(b.data.push(this.fillColor),b.data.push(this.tl),b.data.push(this.br),b.data.push(this.aux1),b.data.push(this.aux2),b.data.push(this.aux3));a.vertexCount++}};f.prototype._writeIndicesLibTess=function(a,b,c,d){for(var e=0;e<d.length;e++)b.push(c+d[e]),a.indexCount++};return f}(a)}})},"esri/views/2d/engine/webgl/mesh/Tesselator":function(){define(["require","exports","../../../../../core/Logger","../../../../../core/libs/libtess/libtess"],
function(f,a,e,m){Object.defineProperty(a,"__esModule",{value:!0});var k=e.getLogger("esri.views.2d.engine.webgl.mesh.templates.Tesselator");f=function(){function a(){this._indexCounter=this._currentVertexIndex=0;this._triangleIndices=[-1,-1,-1];this.glu=new m.GluTesselator;this.glu.gluTessCallback(m.gluEnum.GLU_TESS_BEGIN,this._begincallback.bind(this));this.glu.gluTessCallback(m.gluEnum.GLU_TESS_VERTEX_DATA,this._vertexCallback.bind(this));this.glu.gluTessCallback(m.gluEnum.GLU_TESS_END,this._endcallback.bind(this));
this.glu.gluTessCallback(m.gluEnum.GLU_TESS_COMBINE,this._combinecallback.bind(this));this.glu.gluTessCallback(m.gluEnum.GLU_TESS_ERROR,this._errorcallback.bind(this));this.glu.gluTessCallback(m.gluEnum.GLU_TESS_EDGE_FLAG,this._edgeCallback.bind(this));this.glu.gluTessProperty(m.gluEnum.GLU_TESS_WINDING_RULE,m.windingRule.GLU_TESS_WINDING_ODD)}a.prototype.beginPolygon=function(a,c){this._triangleIndices[0]=-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._indexCounter=this._currentVertexIndex=
0;this.glu.gluTessBeginPolygon(a);this._indices=c};a.prototype.endPolygon=function(){this.glu.gluTessEndPolygon()};a.prototype.beginContour=function(){this.glu.gluTessBeginContour()};a.prototype.endContour=function(){this.glu.gluTessEndContour()};a.prototype.addVertex=function(a,c){this.glu.gluTessVertex(a,c)};a.prototype._vertexCallback=function(a,c){c[c.length]=a[0];c[c.length]=a[1];this._triangleIndices[this._currentVertexIndex]=-1;if(2<=this._currentVertexIndex){for(a=0;3>a;a++)-1===this._triangleIndices[a]&&
(this._triangleIndices[a]=this._indexCounter++),this._indices[this._indices.length]=this._triangleIndices[a];this._currentVertexIndex=0}else this._currentVertexIndex++};a.prototype._begincallback=function(){this._triangleIndices[0]=-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._currentVertexIndex=0};a.prototype._endcallback=function(){this._currentVertexIndex=0};a.prototype._errorcallback=function(a){k.error("Encountered error during tesselation: "+a)};a.prototype._combinecallback=
function(a){return[a[0],a[1],a[2]]};a.prototype._edgeCallback=function(){};return a}();a.default=f})},"esri/core/libs/libtess/libtess":function(){define([],function(){var f={DEBUG:!1,assert:function(a,e){if(f.DEBUG&&!a)throw Error("Assertion failed"+(e?": "+e:""));},GLU_TESS_MAX_COORD:1E150,TRUE_PROJECT:!1,GLU_TESS_DEFAULT_TOLERANCE:0,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},
primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,
GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901},geom:{}};f.geom.vertEq=function(a,e){return a.s===e.s&&a.t===e.t};f.geom.vertLeq=function(a,e){return a.s<e.s||a.s===e.s&&a.t<=e.t};f.geom.edgeEval=function(a,e,m){f.assert(f.geom.vertLeq(a,e)&&f.geom.vertLeq(e,m));var k=e.s-a.s,l=m.s-
e.s;return 0<k+l?k<l?e.t-a.t+k/(k+l)*(a.t-m.t):e.t-m.t+l/(k+l)*(m.t-a.t):0};f.geom.edgeSign=function(a,e,m){f.assert(f.geom.vertLeq(a,e)&&f.geom.vertLeq(e,m));var k=e.s-a.s,l=m.s-e.s;return 0<k+l?(e.t-m.t)*k+(e.t-a.t)*l:0};f.geom.transLeq=function(a,e){return a.t<e.t||a.t===e.t&&a.s<=e.s};f.geom.transEval=function(a,e,m){f.assert(f.geom.transLeq(a,e)&&f.geom.transLeq(e,m));var k=e.t-a.t,l=m.t-e.t;return 0<k+l?k<l?e.s-a.s+k/(k+l)*(a.s-m.s):e.s-m.s+l/(k+l)*(m.s-a.s):0};f.geom.transSign=function(a,e,
m){f.assert(f.geom.transLeq(a,e)&&f.geom.transLeq(e,m));var k=e.t-a.t,l=m.t-e.t;return 0<k+l?(e.s-m.s)*k+(e.s-a.s)*l:0};f.geom.edgeGoesLeft=function(a){return f.geom.vertLeq(a.dst(),a.org)};f.geom.edgeGoesRight=function(a){return f.geom.vertLeq(a.org,a.dst())};f.geom.vertL1dist=function(a,e){return Math.abs(a.s-e.s)+Math.abs(a.t-e.t)};f.geom.vertCCW=function(a,e,f){return 0<=a.s*(e.t-f.t)+e.s*(f.t-a.t)+f.s*(a.t-e.t)};f.geom.interpolate_=function(a,e,f,k){a=0>a?0:a;f=0>f?0:f;return a<=f?0===f?(e+k)/
2:e+a/(a+f)*(k-e):k+f/(a+f)*(e-k)};f.geom.edgeIntersect=function(a,e,m,k,l){var g,c;f.geom.vertLeq(a,e)||(g=a,a=e,e=g);f.geom.vertLeq(m,k)||(g=m,m=k,k=g);f.geom.vertLeq(a,m)||(g=a,a=m,m=g,g=e,e=k,k=g);f.geom.vertLeq(m,e)?f.geom.vertLeq(e,k)?(g=f.geom.edgeEval(a,m,e),c=f.geom.edgeEval(m,e,k),0>g+c&&(g=-g,c=-c),l.s=f.geom.interpolate_(g,m.s,c,e.s)):(g=f.geom.edgeSign(a,m,e),c=-f.geom.edgeSign(a,k,e),0>g+c&&(g=-g,c=-c),l.s=f.geom.interpolate_(g,m.s,c,k.s)):l.s=(m.s+e.s)/2;f.geom.transLeq(a,e)||(g=a,
a=e,e=g);f.geom.transLeq(m,k)||(g=m,m=k,k=g);f.geom.transLeq(a,m)||(g=a,a=m,m=g,g=e,e=k,k=g);f.geom.transLeq(m,e)?f.geom.transLeq(e,k)?(g=f.geom.transEval(a,m,e),c=f.geom.transEval(m,e,k),0>g+c&&(g=-g,c=-c),l.t=f.geom.interpolate_(g,m.t,c,e.t)):(g=f.geom.transSign(a,m,e),c=-f.geom.transSign(a,k,e),0>g+c&&(g=-g,c=-c),l.t=f.geom.interpolate_(g,m.t,c,k.t)):l.t=(m.t+e.t)/2};f.mesh={};f.mesh.makeEdge=function(a){var e=f.mesh.makeEdgePair_(a.eHead);f.mesh.makeVertex_(e,a.vHead);f.mesh.makeVertex_(e.sym,
a.vHead);f.mesh.makeFace_(e,a.fHead);return e};f.mesh.meshSplice=function(a,e){var m=!1,k=!1;a!==e&&(e.org!==a.org&&(k=!0,f.mesh.killVertex_(e.org,a.org)),e.lFace!==a.lFace&&(m=!0,f.mesh.killFace_(e.lFace,a.lFace)),f.mesh.splice_(e,a),k||(f.mesh.makeVertex_(e,a.org),a.org.anEdge=a),m||(f.mesh.makeFace_(e,a.lFace),a.lFace.anEdge=a))};f.mesh.deleteEdge=function(a){var e=a.sym,m=!1;a.lFace!==a.rFace()&&(m=!0,f.mesh.killFace_(a.lFace,a.rFace()));a.oNext===a?f.mesh.killVertex_(a.org,null):(a.rFace().anEdge=
a.oPrev(),a.org.anEdge=a.oNext,f.mesh.splice_(a,a.oPrev()),m||f.mesh.makeFace_(a,a.lFace));e.oNext===e?(f.mesh.killVertex_(e.org,null),f.mesh.killFace_(e.lFace,null)):(a.lFace.anEdge=e.oPrev(),e.org.anEdge=e.oNext,f.mesh.splice_(e,e.oPrev()));f.mesh.killEdge_(a)};f.mesh.addEdgeVertex=function(a){var e=f.mesh.makeEdgePair_(a),m=e.sym;f.mesh.splice_(e,a.lNext);e.org=a.dst();f.mesh.makeVertex_(m,e.org);e.lFace=m.lFace=a.lFace;return e};f.mesh.splitEdge=function(a){var e=f.mesh.addEdgeVertex(a).sym;f.mesh.splice_(a.sym,
a.sym.oPrev());f.mesh.splice_(a.sym,e);a.sym.org=e.org;e.dst().anEdge=e.sym;e.sym.lFace=a.rFace();e.winding=a.winding;e.sym.winding=a.sym.winding;return e};f.mesh.connect=function(a,e){var m=!1,k=f.mesh.makeEdgePair_(a),l=k.sym;e.lFace!==a.lFace&&(m=!0,f.mesh.killFace_(e.lFace,a.lFace));f.mesh.splice_(k,a.lNext);f.mesh.splice_(l,e);k.org=a.dst();l.org=e.org;k.lFace=l.lFace=a.lFace;a.lFace.anEdge=l;m||f.mesh.makeFace_(k,a.lFace);return k};f.mesh.zapFace=function(a){var e=a.anEdge,m=e.lNext,k;do if(k=
m,m=k.lNext,k.lFace=null,null===k.rFace()){k.oNext===k?f.mesh.killVertex_(k.org,null):(k.org.anEdge=k.oNext,f.mesh.splice_(k,k.oPrev()));var l=k.sym;l.oNext===l?f.mesh.killVertex_(l.org,null):(l.org.anEdge=l.oNext,f.mesh.splice_(l,l.oPrev()));f.mesh.killEdge_(k)}while(k!==e);e=a.prev;a=a.next;a.prev=e;e.next=a};f.mesh.meshUnion=function(a,e){var f=a.fHead,k=a.vHead,l=a.eHead,g=e.fHead,c=e.vHead;e=e.eHead;g.next!==g&&(f.prev.next=g.next,g.next.prev=f.prev,g.prev.next=f,f.prev=g.prev);c.next!==c&&(k.prev.next=
c.next,c.next.prev=k.prev,c.prev.next=k,k.prev=c.prev);e.next!==e&&(l.sym.next.sym.next=e.next,e.next.sym.next=l.sym.next,e.sym.next.sym.next=l,l.sym.next=e.sym.next);return a};f.mesh.deleteMesh=function(a){};f.mesh.makeEdgePair_=function(a){var e=new f.GluHalfEdge,m=new f.GluHalfEdge,k=a.sym.next;m.next=k;k.sym.next=e;e.next=a;a.sym.next=m;e.sym=m;e.oNext=e;e.lNext=m;m.sym=e;m.oNext=m;return m.lNext=e};f.mesh.splice_=function(a,e){var f=a.oNext,k=e.oNext;f.sym.lNext=e;k.sym.lNext=a;a.oNext=k;e.oNext=
f};f.mesh.makeVertex_=function(a,e){var m=e.prev,k=new f.GluVertex(e,m);m.next=k;e.prev=k;e=k.anEdge=a;do e.org=k,e=e.oNext;while(e!==a)};f.mesh.makeFace_=function(a,e){var m=e.prev,k=new f.GluFace(e,m);m.next=k;e.prev=k;k.anEdge=a;k.inside=e.inside;e=a;do e.lFace=k,e=e.lNext;while(e!==a)};f.mesh.killEdge_=function(a){var e=a.next;a=a.sym.next;e.sym.next=a;a.sym.next=e};f.mesh.killVertex_=function(a,e){var f=a.anEdge,k=f;do k.org=e,k=k.oNext;while(k!==f);e=a.prev;a=a.next;a.prev=e;e.next=a};f.mesh.killFace_=
function(a,e){var f=a.anEdge,k=f;do k.lFace=e,k=k.lNext;while(k!==f);e=a.prev;a=a.next;a.prev=e;e.next=a};f.normal={};f.normal.S_UNIT_X_=1;f.normal.S_UNIT_Y_=0;f.normal.projectPolygon=function(a,e,m,k){var l=!1,g=[e,m,k];0===e&&0===m&&0===k&&(f.normal.computeNormal_(a,g),l=!0);m=f.normal.longAxis_(g);e=a.mesh.vHead;if(f.TRUE_PROJECT){f.normal.normalize_(g);k=[0,0,0];var c=[0,0,0];k[m]=0;k[(m+1)%3]=f.normal.S_UNIT_X_;k[(m+2)%3]=f.normal.S_UNIT_Y_;m=f.normal.dot_(k,g);k[0]-=m*g[0];k[1]-=m*g[1];k[2]-=
m*g[2];f.normal.normalize_(k);c[0]=g[1]*k[2]-g[2]*k[1];c[1]=g[2]*k[0]-g[0]*k[2];c[2]=g[0]*k[1]-g[1]*k[0];f.normal.normalize_(c);for(g=e.next;g!==e;g=g.next)g.s=f.normal.dot_(g.coords,k),g.t=f.normal.dot_(g.coords,c)}else for(k=(m+1)%3,c=(m+2)%3,m=0<g[m]?1:-1,g=e.next;g!==e;g=g.next)g.s=g.coords[k],g.t=m*g.coords[c];l&&f.normal.checkOrientation_(a)};f.normal.dot_=function(a,e){return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]};f.normal.normalize_=function(a){var e=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];f.assert(0<e);e=
Math.sqrt(e);a[0]/=e;a[1]/=e;a[2]/=e};f.normal.longAxis_=function(a){var e=0;Math.abs(a[1])>Math.abs(a[0])&&(e=1);Math.abs(a[2])>Math.abs(a[e])&&(e=2);return e};f.normal.computeNormal_=function(a,e){var m=[-2*f.GLU_TESS_MAX_COORD,-2*f.GLU_TESS_MAX_COORD,-2*f.GLU_TESS_MAX_COORD],k=[2*f.GLU_TESS_MAX_COORD,2*f.GLU_TESS_MAX_COORD,2*f.GLU_TESS_MAX_COORD],l=[],g=[],c;a=a.mesh.vHead;for(c=a.next;c!==a;c=c.next)for(var h=0;3>h;++h){var b=c.coords[h];b<k[h]&&(k[h]=b,g[h]=c);b>m[h]&&(m[h]=b,l[h]=c)}c=0;m[1]-
k[1]>m[0]-k[0]&&(c=1);m[2]-k[2]>m[c]-k[c]&&(c=2);if(k[c]>=m[c])e[0]=0,e[1]=0,e[2]=1;else{m=0;k=g[c];l=l[c];g=[0,0,0];k=[k.coords[0]-l.coords[0],k.coords[1]-l.coords[1],k.coords[2]-l.coords[2]];h=[0,0,0];for(c=a.next;c!==a;c=c.next)h[0]=c.coords[0]-l.coords[0],h[1]=c.coords[1]-l.coords[1],h[2]=c.coords[2]-l.coords[2],g[0]=k[1]*h[2]-k[2]*h[1],g[1]=k[2]*h[0]-k[0]*h[2],g[2]=k[0]*h[1]-k[1]*h[0],b=g[0]*g[0]+g[1]*g[1]+g[2]*g[2],b>m&&(m=b,e[0]=g[0],e[1]=g[1],e[2]=g[2]);0>=m&&(e[0]=e[1]=e[2]=0,e[f.normal.longAxis_(k)]=
1)}};f.normal.checkOrientation_=function(a){for(var e=0,f=a.mesh.fHead,k=f.next;k!==f;k=k.next){var l=k.anEdge;if(!(0>=l.winding)){do e+=(l.org.s-l.dst().s)*(l.org.t+l.dst().t),l=l.lNext;while(l!==k.anEdge)}}if(0>e)for(a=a.mesh.vHead,e=a.next;e!==a;e=e.next)e.t=-e.t};f.render={};f.render.renderMesh=function(a,e,m){for(var k=!1,l=-1,g=e.fHead.prev;g!==e.fHead;g=g.prev)if(g.inside){k||(a.callBeginCallback(f.primitiveType.GL_TRIANGLES),k=!0);var c=g.anEdge;f.assert(c.lNext.lNext.lNext===c,"renderMesh called with non-triangulated mesh");
do{if(m){var h=c.rFace().inside?0:1;l!==h&&(l=h,a.callEdgeFlagCallback(!!l))}a.callVertexCallback(c.org.data);c=c.lNext}while(c!==g.anEdge)}k&&a.callEndCallback()};f.render.renderBoundary=function(a,e){for(var m=e.fHead.next;m!==e.fHead;m=m.next)if(m.inside){a.callBeginCallback(f.primitiveType.GL_LINE_LOOP);var k=m.anEdge;do a.callVertexCallback(k.org.data),k=k.lNext;while(k!==m.anEdge);a.callEndCallback()}};f.sweep={};f.sweep.SENTINEL_COORD_=4*f.GLU_TESS_MAX_COORD;f.sweep.TOLERANCE_NONZERO_=!1;f.sweep.computeInterior=
function(a){a.fatalError=!1;f.sweep.removeDegenerateEdges_(a);f.sweep.initPriorityQ_(a);f.sweep.initEdgeDict_(a);for(var e;null!==(e=a.pq.extractMin());){for(;;){var m=a.pq.minimum();if(null===m||!f.geom.vertEq(m,e))break;m=a.pq.extractMin();f.sweep.spliceMergeVertices_(a,e.anEdge,m.anEdge)}f.sweep.sweepEvent_(a,e)}e=a.dict.getMin().getKey();a.event=e.eUp.org;f.sweep.doneEdgeDict_(a);f.sweep.donePriorityQ_(a);f.sweep.removeDegenerateFaces_(a.mesh);a.mesh.checkMesh()};f.sweep.addWinding_=function(a,
e){a.winding+=e.winding;a.sym.winding+=e.sym.winding};f.sweep.edgeLeq_=function(a,e,m){a=a.event;e=e.eUp;m=m.eUp;if(e.dst()===a)return m.dst()===a?f.geom.vertLeq(e.org,m.org)?0>=f.geom.edgeSign(m.dst(),e.org,m.org):0<=f.geom.edgeSign(e.dst(),m.org,e.org):0>=f.geom.edgeSign(m.dst(),a,m.org);if(m.dst()===a)return 0<=f.geom.edgeSign(e.dst(),a,e.org);e=f.geom.edgeEval(e.dst(),a,e.org);a=f.geom.edgeEval(m.dst(),a,m.org);return e>=a};f.sweep.deleteRegion_=function(a,e){e.fixUpperEdge&&f.assert(0===e.eUp.winding);
e.eUp.activeRegion=null;a.dict.deleteNode(e.nodeUp);e.nodeUp=null};f.sweep.fixUpperEdge_=function(a,e){f.assert(a.fixUpperEdge);f.mesh.deleteEdge(a.eUp);a.fixUpperEdge=!1;a.eUp=e;e.activeRegion=a};f.sweep.topLeftRegion_=function(a){var e=a.eUp.org;do a=a.regionAbove();while(a.eUp.org===e);a.fixUpperEdge&&(e=f.mesh.connect(a.regionBelow().eUp.sym,a.eUp.lNext),f.sweep.fixUpperEdge_(a,e),a=a.regionAbove());return a};f.sweep.topRightRegion_=function(a){var e=a.eUp.dst();do a=a.regionAbove();while(a.eUp.dst()===
e);return a};f.sweep.addRegionBelow_=function(a,e,m){var k=new f.ActiveRegion;k.eUp=m;k.nodeUp=a.dict.insertBefore(e.nodeUp,k);return m.activeRegion=k};f.sweep.isWindingInside_=function(a,e){switch(a.windingRule){case f.windingRule.GLU_TESS_WINDING_ODD:return 0!==(e&1);case f.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==e;case f.windingRule.GLU_TESS_WINDING_POSITIVE:return 0<e;case f.windingRule.GLU_TESS_WINDING_NEGATIVE:return 0>e;case f.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return 2<=e||-2>=
e}f.assert(!1);return!1};f.sweep.computeWinding_=function(a,e){e.windingNumber=e.regionAbove().windingNumber+e.eUp.winding;e.inside=f.sweep.isWindingInside_(a,e.windingNumber)};f.sweep.finishRegion_=function(a,e){var m=e.eUp,k=m.lFace;k.inside=e.inside;k.anEdge=m;f.sweep.deleteRegion_(a,e)};f.sweep.finishLeftRegions_=function(a,e,m){var k=e;for(e=e.eUp;k!==m;){k.fixUpperEdge=!1;var l=k.regionBelow(),g=l.eUp;if(g.org!==e.org){if(!l.fixUpperEdge){f.sweep.finishRegion_(a,k);break}g=f.mesh.connect(e.lPrev(),
g.sym);f.sweep.fixUpperEdge_(l,g)}e.oNext!==g&&(f.mesh.meshSplice(g.oPrev(),g),f.mesh.meshSplice(e,g));f.sweep.finishRegion_(a,k);e=l.eUp;k=l}return e};f.sweep.addRightEdges_=function(a,e,m,k,l,g){var c=!0;do f.assert(f.geom.vertLeq(m.org,m.dst())),f.sweep.addRegionBelow_(a,e,m.sym),m=m.oNext;while(m!==k);for(null===l&&(l=e.regionBelow().eUp.rPrev());;){k=e.regionBelow();m=k.eUp.sym;if(m.org!==l.org)break;m.oNext!==l&&(f.mesh.meshSplice(m.oPrev(),m),f.mesh.meshSplice(l.oPrev(),m));k.windingNumber=
e.windingNumber-m.winding;k.inside=f.sweep.isWindingInside_(a,k.windingNumber);e.dirty=!0;!c&&f.sweep.checkForRightSplice_(a,e)&&(f.sweep.addWinding_(m,l),f.sweep.deleteRegion_(a,e),f.mesh.deleteEdge(l));c=!1;e=k;l=m}e.dirty=!0;f.assert(e.windingNumber-m.winding===k.windingNumber);g&&f.sweep.walkDirtyRegions_(a,e)};f.sweep.callCombine_=function(a,e,m,k,l){var g=[e.coords[0],e.coords[1],e.coords[2]];e.data=null;e.data=a.callCombineCallback(g,m,k);null===e.data&&(l?a.fatalError||(a.callErrorCallback(f.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),
a.fatalError=!0):e.data=m[0])};f.sweep.spliceMergeVertices_=function(a,e,m){var k=[null,null,null,null];k[0]=e.org.data;k[1]=m.org.data;f.sweep.callCombine_(a,e.org,k,[.5,.5,0,0],!1);f.mesh.meshSplice(e,m)};f.sweep.vertexWeights_=function(a,e,m,k,l){var g=f.geom.vertL1dist(e,a),c=f.geom.vertL1dist(m,a),h=l+1;k[l]=.5*c/(g+c);k[h]=.5*g/(g+c);a.coords[0]+=k[l]*e.coords[0]+k[h]*m.coords[0];a.coords[1]+=k[l]*e.coords[1]+k[h]*m.coords[1];a.coords[2]+=k[l]*e.coords[2]+k[h]*m.coords[2]};f.sweep.getIntersectData_=
function(a,e,m,k,l,g){var c=[0,0,0,0],h=[m.data,k.data,l.data,g.data];e.coords[0]=e.coords[1]=e.coords[2]=0;f.sweep.vertexWeights_(e,m,k,c,0);f.sweep.vertexWeights_(e,l,g,c,2);f.sweep.callCombine_(a,e,h,c,!0)};f.sweep.checkForRightSplice_=function(a,e){var m=e.regionBelow(),k=e.eUp,l=m.eUp;if(f.geom.vertLeq(k.org,l.org)){if(0<f.geom.edgeSign(l.dst(),k.org,l.org))return!1;f.geom.vertEq(k.org,l.org)?k.org!==l.org&&(a.pq.remove(k.org.pqHandle),f.sweep.spliceMergeVertices_(a,l.oPrev(),k)):(f.mesh.splitEdge(l.sym),
f.mesh.meshSplice(k,l.oPrev()),e.dirty=m.dirty=!0)}else{if(0>f.geom.edgeSign(k.dst(),l.org,k.org))return!1;e.regionAbove().dirty=e.dirty=!0;f.mesh.splitEdge(k.sym);f.mesh.meshSplice(l.oPrev(),k)}return!0};f.sweep.checkForLeftSplice_=function(a,e){var m=e.regionBelow();a=e.eUp;var k=m.eUp;f.assert(!f.geom.vertEq(a.dst(),k.dst()));if(f.geom.vertLeq(a.dst(),k.dst())){if(0>f.geom.edgeSign(a.dst(),k.dst(),a.org))return!1;e.regionAbove().dirty=e.dirty=!0;m=f.mesh.splitEdge(a);f.mesh.meshSplice(k.sym,m);
m.lFace.inside=e.inside}else{if(0<f.geom.edgeSign(k.dst(),a.dst(),k.org))return!1;e.dirty=m.dirty=!0;m=f.mesh.splitEdge(k);f.mesh.meshSplice(a.lNext,k.sym);m.rFace().inside=e.inside}return!0};f.sweep.checkForIntersect_=function(a,e){var m=e.regionBelow(),k=e.eUp,l=m.eUp,g=k.org,c=l.org,h=k.dst(),b=l.dst(),d=new f.GluVertex;f.assert(!f.geom.vertEq(b,h));f.assert(0>=f.geom.edgeSign(h,a.event,g));f.assert(0<=f.geom.edgeSign(b,a.event,c));f.assert(g!==a.event&&c!==a.event);f.assert(!e.fixUpperEdge&&!m.fixUpperEdge);
if(g===c||Math.min(g.t,h.t)>Math.max(c.t,b.t))return!1;if(f.geom.vertLeq(g,c)){if(0<f.geom.edgeSign(b,g,c))return!1}else if(0>f.geom.edgeSign(h,c,g))return!1;f.geom.edgeIntersect(h,g,b,c,d);f.assert(Math.min(g.t,h.t)<=d.t);f.assert(d.t<=Math.max(c.t,b.t));f.assert(Math.min(b.s,h.s)<=d.s);f.assert(d.s<=Math.max(c.s,g.s));f.geom.vertLeq(d,a.event)&&(d.s=a.event.s,d.t=a.event.t);var n=f.geom.vertLeq(g,c)?g:c;f.geom.vertLeq(n,d)&&(d.s=n.s,d.t=n.t);if(f.geom.vertEq(d,g)||f.geom.vertEq(d,c))return f.sweep.checkForRightSplice_(a,
e),!1;if(!f.geom.vertEq(h,a.event)&&0<=f.geom.edgeSign(h,a.event,d)||!f.geom.vertEq(b,a.event)&&0>=f.geom.edgeSign(b,a.event,d)){if(b===a.event)return f.mesh.splitEdge(k.sym),f.mesh.meshSplice(l.sym,k),e=f.sweep.topLeftRegion_(e),k=e.regionBelow().eUp,f.sweep.finishLeftRegions_(a,e.regionBelow(),m),f.sweep.addRightEdges_(a,e,k.oPrev(),k,k,!0),!0;if(h===a.event)return f.mesh.splitEdge(l.sym),f.mesh.meshSplice(k.lNext,l.oPrev()),m=e,e=f.sweep.topRightRegion_(e),g=e.regionBelow().eUp.rPrev(),m.eUp=l.oPrev(),
l=f.sweep.finishLeftRegions_(a,m,null),f.sweep.addRightEdges_(a,e,l.oNext,k.rPrev(),g,!0),!0;0<=f.geom.edgeSign(h,a.event,d)&&(e.regionAbove().dirty=e.dirty=!0,f.mesh.splitEdge(k.sym),k.org.s=a.event.s,k.org.t=a.event.t);0>=f.geom.edgeSign(b,a.event,d)&&(e.dirty=m.dirty=!0,f.mesh.splitEdge(l.sym),l.org.s=a.event.s,l.org.t=a.event.t);return!1}f.mesh.splitEdge(k.sym);f.mesh.splitEdge(l.sym);f.mesh.meshSplice(l.oPrev(),k);k.org.s=d.s;k.org.t=d.t;k.org.pqHandle=a.pq.insert(k.org);f.sweep.getIntersectData_(a,
k.org,g,h,c,b);e.regionAbove().dirty=e.dirty=m.dirty=!0;return!1};f.sweep.walkDirtyRegions_=function(a,e){for(var m=e.regionBelow();;){for(;m.dirty;)e=m,m=m.regionBelow();if(!e.dirty&&(m=e,e=e.regionAbove(),null===e||!e.dirty))break;e.dirty=!1;var k=e.eUp,l=m.eUp;k.dst()!==l.dst()&&f.sweep.checkForLeftSplice_(a,e)&&(m.fixUpperEdge?(f.sweep.deleteRegion_(a,m),f.mesh.deleteEdge(l),m=e.regionBelow(),l=m.eUp):e.fixUpperEdge&&(f.sweep.deleteRegion_(a,e),f.mesh.deleteEdge(k),e=m.regionAbove(),k=e.eUp));
if(k.org!==l.org)if(k.dst()===l.dst()||e.fixUpperEdge||m.fixUpperEdge||k.dst()!==a.event&&l.dst()!==a.event)f.sweep.checkForRightSplice_(a,e);else if(f.sweep.checkForIntersect_(a,e))break;k.org===l.org&&k.dst()===l.dst()&&(f.sweep.addWinding_(l,k),f.sweep.deleteRegion_(a,e),f.mesh.deleteEdge(k),e=m.regionAbove())}};f.sweep.connectRightVertex_=function(a,e,m){var k=m.oNext,l=e.regionBelow(),g=e.eUp,c=l.eUp,h=!1;g.dst()!==c.dst()&&f.sweep.checkForIntersect_(a,e);f.geom.vertEq(g.org,a.event)&&(f.mesh.meshSplice(k.oPrev(),
g),e=f.sweep.topLeftRegion_(e),k=e.regionBelow().eUp,f.sweep.finishLeftRegions_(a,e.regionBelow(),l),h=!0);f.geom.vertEq(c.org,a.event)&&(f.mesh.meshSplice(m,c.oPrev()),m=f.sweep.finishLeftRegions_(a,l,null),h=!0);h?f.sweep.addRightEdges_(a,e,m.oNext,k,k,!0):(k=f.geom.vertLeq(c.org,g.org)?c.oPrev():g,k=f.mesh.connect(m.lPrev(),k),f.sweep.addRightEdges_(a,e,k,k.oNext,k.oNext,!1),k.sym.activeRegion.fixUpperEdge=!0,f.sweep.walkDirtyRegions_(a,e))};f.sweep.connectLeftDegenerate_=function(a,e,m){var k=
e.eUp;if(f.geom.vertEq(k.org,m))f.assert(f.sweep.TOLERANCE_NONZERO_),f.sweep.TOLERANCE_NONZERO_&&f.sweep.spliceMergeVertices_(a,k,m.anEdge);else if(f.geom.vertEq(k.dst(),m)){if(f.assert(f.sweep.TOLERANCE_NONZERO_),f.sweep.TOLERANCE_NONZERO_){e=f.sweep.topRightRegion_(e);var k=e.regionBelow(),l=k.eUp.sym,g=l.oNext,c=g;k.fixUpperEdge&&(f.assert(g!==l),f.sweep.deleteRegion_(a,k),f.mesh.deleteEdge(l),l=g.oPrev());f.mesh.meshSplice(m.anEdge,l);f.geom.edgeGoesLeft(g)||(g=null);f.sweep.addRightEdges_(a,
e,l.oNext,c,g,!0)}}else f.mesh.splitEdge(k.sym),e.fixUpperEdge&&(f.mesh.deleteEdge(k.oNext),e.fixUpperEdge=!1),f.mesh.meshSplice(m.anEdge,k),f.sweep.sweepEvent_(a,m)};f.sweep.connectLeftVertex_=function(a,e){var m=new f.ActiveRegion;m.eUp=e.anEdge.sym;var m=a.dict.search(m).getKey(),k=m.regionBelow(),l=m.eUp,g=k.eUp;0===f.geom.edgeSign(l.dst(),e,l.org)?f.sweep.connectLeftDegenerate_(a,m,e):(k=f.geom.vertLeq(g.dst(),l.dst())?m:k,m.inside||k.fixUpperEdge?(l=k===m?f.mesh.connect(e.anEdge.sym,l.lNext):
f.mesh.connect(g.dNext(),e.anEdge).sym,k.fixUpperEdge?f.sweep.fixUpperEdge_(k,l):f.sweep.computeWinding_(a,f.sweep.addRegionBelow_(a,m,l)),f.sweep.sweepEvent_(a,e)):f.sweep.addRightEdges_(a,m,e.anEdge,e.anEdge,null,!0))};f.sweep.sweepEvent_=function(a,e){a.event=e;for(var m=e.anEdge;null===m.activeRegion;)if(m=m.oNext,m===e.anEdge){f.sweep.connectLeftVertex_(a,e);return}e=f.sweep.topLeftRegion_(m.activeRegion);var k=e.regionBelow(),m=k.eUp,k=f.sweep.finishLeftRegions_(a,k,null);k.oNext===m?f.sweep.connectRightVertex_(a,
e,k):f.sweep.addRightEdges_(a,e,k.oNext,m,m,!0)};f.sweep.addSentinel_=function(a,e){var m=new f.ActiveRegion,k=f.mesh.makeEdge(a.mesh);k.org.s=f.sweep.SENTINEL_COORD_;k.org.t=e;k.dst().s=-f.sweep.SENTINEL_COORD_;k.dst().t=e;a.event=k.dst();m.eUp=k;m.windingNumber=0;m.inside=!1;m.fixUpperEdge=!1;m.sentinel=!0;m.dirty=!1;m.nodeUp=a.dict.insert(m)};f.sweep.initEdgeDict_=function(a){a.dict=new f.Dict(a,f.sweep.edgeLeq_);f.sweep.addSentinel_(a,-f.sweep.SENTINEL_COORD_);f.sweep.addSentinel_(a,f.sweep.SENTINEL_COORD_)};
f.sweep.doneEdgeDict_=function(a){for(var e=0,m;null!==(m=a.dict.getMin().getKey());)m.sentinel||(f.assert(m.fixUpperEdge),f.assert(1===++e)),f.assert(0===m.windingNumber),f.sweep.deleteRegion_(a,m);a.dict=null};f.sweep.removeDegenerateEdges_=function(a){for(var e=a.mesh.eHead,m,k=e.next;k!==e;k=m){m=k.next;var l=k.lNext;f.geom.vertEq(k.org,k.dst())&&k.lNext.lNext!==k&&(f.sweep.spliceMergeVertices_(a,l,k),f.mesh.deleteEdge(k),k=l,l=k.lNext);if(l.lNext===k){if(l!==k){if(l===m||l===m.sym)m=m.next;f.mesh.deleteEdge(l)}if(k===
m||k===m.sym)m=m.next;f.mesh.deleteEdge(k)}}};f.sweep.initPriorityQ_=function(a){var e=new f.PriorityQ;a.pq=e;a=a.mesh.vHead;var m;for(m=a.next;m!==a;m=m.next)m.pqHandle=e.insert(m);e.init()};f.sweep.donePriorityQ_=function(a){a.pq.deleteQ();a.pq=null};f.sweep.removeDegenerateFaces_=function(a){for(var e,m=a.fHead.next;m!==a.fHead;m=e)e=m.next,m=m.anEdge,f.assert(m.lNext!==m),m.lNext.lNext===m&&(f.sweep.addWinding_(m.oNext,m),f.mesh.deleteEdge(m))};f.tessmono={};f.tessmono.tessellateMonoRegion_=function(a){a=
a.anEdge;for(f.assert(a.lNext!==a&&a.lNext.lNext!==a);f.geom.vertLeq(a.dst(),a.org);a=a.lPrev());for(;f.geom.vertLeq(a.org,a.dst());a=a.lNext);for(var e=a.lPrev(),m;a.lNext!==e;)if(f.geom.vertLeq(a.dst(),e.org)){for(;e.lNext!==a&&(f.geom.edgeGoesLeft(e.lNext)||0>=f.geom.edgeSign(e.org,e.dst(),e.lNext.dst()));)m=f.mesh.connect(e.lNext,e),e=m.sym;e=e.lPrev()}else{for(;e.lNext!==a&&(f.geom.edgeGoesRight(a.lPrev())||0<=f.geom.edgeSign(a.dst(),a.org,a.lPrev().org));)m=f.mesh.connect(a,a.lPrev()),a=m.sym;
a=a.lNext}for(f.assert(e.lNext!==a);e.lNext.lNext!==a;)m=f.mesh.connect(e.lNext,e),e=m.sym};f.tessmono.tessellateInterior=function(a){for(var e,m=a.fHead.next;m!==a.fHead;m=e)e=m.next,m.inside&&f.tessmono.tessellateMonoRegion_(m)};f.tessmono.discardExterior=function(a){for(var e,m=a.fHead.next;m!==a.fHead;m=e)e=m.next,m.inside||f.mesh.zapFace(m)};f.tessmono.setWindingNumber=function(a,e,m){for(var k,l=a.eHead.next;l!==a.eHead;l=k)k=l.next,l.rFace().inside!==l.lFace.inside?l.winding=l.lFace.inside?
e:-e:m?f.mesh.deleteEdge(l):l.winding=0};f.Dict=function(a,e){this.head_=new f.DictNode;this.frame_=a;this.leq_=e};f.Dict.prototype.deleteDict_=function(){};f.Dict.prototype.insertBefore=function(a,e){do a=a.prev;while(null!==a.key&&!this.leq_(this.frame_,a.key,e));e=new f.DictNode(e,a.next,a);a.next.prev=e;return a.next=e};f.Dict.prototype.insert=function(a){return this.insertBefore(this.head_,a)};f.Dict.prototype.deleteNode=function(a){a.next.prev=a.prev;a.prev.next=a.next};f.Dict.prototype.search=
function(a){var e=this.head_;do e=e.next;while(null!==e.key&&!this.leq_(this.frame_,a,e.key));return e};f.Dict.prototype.getMin=function(){return this.head_.next};f.Dict.prototype.getMax=function(){return this.head_.prev};f.DictNode=function(a,e,f){this.key=a||null;this.next=e||this;this.prev=f||this};f.DictNode.prototype.getKey=function(){return this.key};f.DictNode.prototype.getSuccessor=function(){return this.next};f.DictNode.prototype.getPredecessor=function(){return this.prev};f.GluTesselator=
function(){this.state_=f.GluTesselator.tessState_.T_DORMANT;this.errorCallback_=this.mesh=this.lastEdge_=null;this.normal_=[0,0,0];this.windingRule=f.windingRule.GLU_TESS_WINDING_ODD;this.fatalError=!1;this.combineCallback_=this.event=this.pq=this.dict=null;this.boundaryOnly_=!1;this.polygonData_=this.meshCallback_=this.endCallback_=this.vertexCallback_=this.edgeFlagCallback_=this.beginCallback_=null};f.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2};f.GluTesselator.prototype.gluDeleteTess=
function(){this.requireState_(f.GluTesselator.tessState_.T_DORMANT)};f.GluTesselator.prototype.gluTessProperty=function(a,e){switch(a){case f.gluEnum.GLU_TESS_TOLERANCE:return;case f.gluEnum.GLU_TESS_WINDING_RULE:switch(e){case f.windingRule.GLU_TESS_WINDING_ODD:case f.windingRule.GLU_TESS_WINDING_NONZERO:case f.windingRule.GLU_TESS_WINDING_POSITIVE:case f.windingRule.GLU_TESS_WINDING_NEGATIVE:case f.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:this.windingRule=e;return}break;case f.gluEnum.GLU_TESS_BOUNDARY_ONLY:this.boundaryOnly_=
!!e;return;default:this.callErrorCallback(f.gluEnum.GLU_INVALID_ENUM);return}this.callErrorCallback(f.gluEnum.GLU_INVALID_VALUE)};f.GluTesselator.prototype.gluGetTessProperty=function(a){switch(a){case f.gluEnum.GLU_TESS_TOLERANCE:return 0;case f.gluEnum.GLU_TESS_WINDING_RULE:return a=this.windingRule,f.assert(a===f.windingRule.GLU_TESS_WINDING_ODD||a===f.windingRule.GLU_TESS_WINDING_NONZERO||a===f.windingRule.GLU_TESS_WINDING_POSITIVE||a===f.windingRule.GLU_TESS_WINDING_NEGATIVE||a===f.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO),
a;case f.gluEnum.GLU_TESS_BOUNDARY_ONLY:return f.assert(!0===this.boundaryOnly_||!1===this.boundaryOnly_),this.boundaryOnly_;default:this.callErrorCallback(f.gluEnum.GLU_INVALID_ENUM)}return!1};f.GluTesselator.prototype.gluTessNormal=function(a,e,f){this.normal_[0]=a;this.normal_[1]=e;this.normal_[2]=f};f.GluTesselator.prototype.gluTessCallback=function(a,e){e=e?e:null;switch(a){case f.gluEnum.GLU_TESS_BEGIN:case f.gluEnum.GLU_TESS_BEGIN_DATA:this.beginCallback_=e;break;case f.gluEnum.GLU_TESS_EDGE_FLAG:case f.gluEnum.GLU_TESS_EDGE_FLAG_DATA:this.edgeFlagCallback_=
e;break;case f.gluEnum.GLU_TESS_VERTEX:case f.gluEnum.GLU_TESS_VERTEX_DATA:this.vertexCallback_=e;break;case f.gluEnum.GLU_TESS_END:case f.gluEnum.GLU_TESS_END_DATA:this.endCallback_=e;break;case f.gluEnum.GLU_TESS_ERROR:case f.gluEnum.GLU_TESS_ERROR_DATA:this.errorCallback_=e;break;case f.gluEnum.GLU_TESS_COMBINE:case f.gluEnum.GLU_TESS_COMBINE_DATA:this.combineCallback_=e;break;case f.gluEnum.GLU_TESS_MESH:this.meshCallback_=e;break;default:this.callErrorCallback(f.gluEnum.GLU_INVALID_ENUM)}};f.GluTesselator.prototype.gluTessVertex=
function(a,e){var m=!1,k=[0,0,0];this.requireState_(f.GluTesselator.tessState_.T_IN_CONTOUR);for(var l=0;3>l;++l){var g=a[l];g<-f.GLU_TESS_MAX_COORD&&(g=-f.GLU_TESS_MAX_COORD,m=!0);g>f.GLU_TESS_MAX_COORD&&(g=f.GLU_TESS_MAX_COORD,m=!0);k[l]=g}m&&this.callErrorCallback(f.errorType.GLU_TESS_COORD_TOO_LARGE);this.addVertex_(k,e)};f.GluTesselator.prototype.gluTessBeginPolygon=function(a){this.requireState_(f.GluTesselator.tessState_.T_DORMANT);this.state_=f.GluTesselator.tessState_.T_IN_POLYGON;this.mesh=
new f.GluMesh;this.polygonData_=a};f.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(f.GluTesselator.tessState_.T_IN_POLYGON);this.state_=f.GluTesselator.tessState_.T_IN_CONTOUR;this.lastEdge_=null};f.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(f.GluTesselator.tessState_.T_IN_CONTOUR);this.state_=f.GluTesselator.tessState_.T_IN_POLYGON};f.GluTesselator.prototype.gluTessEndPolygon=function(){this.requireState_(f.GluTesselator.tessState_.T_IN_POLYGON);
this.state_=f.GluTesselator.tessState_.T_DORMANT;f.normal.projectPolygon(this,this.normal_[0],this.normal_[1],this.normal_[2]);f.sweep.computeInterior(this);if(!this.fatalError){var a=this.mesh;this.boundaryOnly_?f.tessmono.setWindingNumber(a,1,!0):f.tessmono.tessellateInterior(a);this.mesh.checkMesh();if(this.beginCallback_||this.endCallback_||this.vertexCallback_||this.edgeFlagCallback_)this.boundaryOnly_?f.render.renderBoundary(this,this.mesh):f.render.renderMesh(this,this.mesh,!!this.edgeFlagCallback_);
if(this.meshCallback_){f.tessmono.discardExterior(this.mesh);this.meshCallback_(this.mesh);this.polygonData_=this.mesh=null;return}}f.mesh.deleteMesh(this.mesh);this.mesh=this.polygonData_=null};f.GluTesselator.prototype.requireState_=function(a){this.state_!==a&&this.gotoState_(a)};f.GluTesselator.prototype.gotoState_=function(a){for(;this.state_!==a;)if(this.state_<a)switch(this.state_){case f.GluTesselator.tessState_.T_DORMANT:this.callErrorCallback(f.errorType.GLU_TESS_MISSING_BEGIN_POLYGON);
this.gluTessBeginPolygon(null);break;case f.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(f.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state_){case f.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorCallback(f.errorType.GLU_TESS_MISSING_END_CONTOUR);this.gluTessEndContour();break;case f.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(f.errorType.GLU_TESS_MISSING_END_POLYGON),this.gluTessEndPolygon()}};f.GluTesselator.prototype.addVertex_=
function(a,e){var m=this.lastEdge_;null===m?(m=f.mesh.makeEdge(this.mesh),f.mesh.meshSplice(m,m.sym)):(f.mesh.splitEdge(m),m=m.lNext);m.org.data=e;m.org.coords[0]=a[0];m.org.coords[1]=a[1];m.org.coords[2]=a[2];m.winding=1;m.sym.winding=-1;this.lastEdge_=m};f.GluTesselator.prototype.callBeginCallback=function(a){this.beginCallback_&&this.beginCallback_(a,this.polygonData_)};f.GluTesselator.prototype.callVertexCallback=function(a){this.vertexCallback_&&this.vertexCallback_(a,this.polygonData_)};f.GluTesselator.prototype.callEdgeFlagCallback=
function(a){this.edgeFlagCallback_&&this.edgeFlagCallback_(a,this.polygonData_)};f.GluTesselator.prototype.callEndCallback=function(){this.endCallback_&&this.endCallback_(this.polygonData_)};f.GluTesselator.prototype.callCombineCallback=function(a,e,f){return this.combineCallback_?this.combineCallback_(a,e,f,this.polygonData_)||null:null};f.GluTesselator.prototype.callErrorCallback=function(a){this.errorCallback_&&this.errorCallback_(a,this.polygonData_)};f.GluFace=function(a,e){this.next=a||this;
this.prev=e||this;this.anEdge=null;this.inside=!1};f.GluHalfEdge=function(a){this.next=a||this;this.activeRegion=this.lFace=this.org=this.lNext=this.oNext=this.sym=null;this.winding=0};f.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace};f.GluHalfEdge.prototype.dst=function(){return this.sym.org};f.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext};f.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym};f.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym};
f.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext};f.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym};f.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym};f.GluMesh=function(){this.vHead=new f.GluVertex;this.fHead=new f.GluFace;this.eHead=new f.GluHalfEdge;this.eHeadSym=new f.GluHalfEdge;this.eHead.sym=this.eHeadSym;this.eHeadSym.sym=this.eHead};f.GluMesh.prototype.checkMesh=function(){if(f.DEBUG){var a=this.fHead,e=this.vHead,m=this.eHead,k,l;for(k=k=a;(l=
k.next)!==a;k=l){f.assert(l.prev===k);k=l.anEdge;do f.assert(k.sym!==k),f.assert(k.sym.sym===k),f.assert(k.lNext.oNext.sym===k),f.assert(k.oNext.sym.lNext===k),f.assert(k.lFace===l),k=k.lNext;while(k!==l.anEdge)}f.assert(l.prev===k&&null===l.anEdge);for(k=k=e;(a=k.next)!==e;k=a){f.assert(a.prev===k);k=a.anEdge;do f.assert(k.sym!==k),f.assert(k.sym.sym===k),f.assert(k.lNext.oNext.sym===k),f.assert(k.oNext.sym.lNext===k),f.assert(k.org===a),k=k.oNext;while(k!==a.anEdge)}f.assert(a.prev===k&&null===
a.anEdge&&null===a.data);for(e=e=m;(k=e.next)!==m;e=k)f.assert(k.sym.next===e.sym),f.assert(k.sym!==k),f.assert(k.sym.sym===k),f.assert(null!==k.org),f.assert(null!==k.dst()),f.assert(k.lNext.oNext.sym===k),f.assert(k.oNext.sym.lNext===k);f.assert(k.sym.next===e.sym&&k.sym===this.eHeadSym&&k.sym.sym===k&&null===k.org&&null===k.dst()&&null===k.lFace&&null===k.rFace())}};f.GluVertex=function(a,e){this.next=a||this;this.prev=e||this;this.data=this.anEdge=null;this.coords=[0,0,0];this.pqHandle=this.t=
this.s=0};f.PriorityQ=function(){this.verts_=[];this.order_=null;this.size_=0;this.initialized_=!1;this.heap_=new f.PriorityQHeap};f.PriorityQ.prototype.deleteQ=function(){this.verts_=this.order_=this.heap_=null};f.PriorityQ.prototype.init=function(){this.order_=[];for(var a=0;a<this.size_;a++)this.order_[a]=a;a=function(a){return function(e,l){return f.geom.vertLeq(a[e],a[l])?1:-1}}(this.verts_);this.order_.sort(a);this.initialized_=!0;this.heap_.init();if(f.DEBUG)for(var e=0+this.size_-1,a=0;a<
e;++a)f.assert(f.geom.vertLeq(this.verts_[this.order_[a+1]],this.verts_[this.order_[a]]))};f.PriorityQ.prototype.insert=function(a){if(this.initialized_)return this.heap_.insert(a);var e=this.size_++;this.verts_[e]=a;return-(e+1)};f.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();var a=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var e=this.heap_.minimum();if(f.geom.vertLeq(e,a))return this.heap_.extractMin()}do--this.size_;while(0<this.size_&&
null===this.verts_[this.order_[this.size_-1]]);return a};f.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var a=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var e=this.heap_.minimum();if(f.geom.vertLeq(e,a))return e}return a};f.PriorityQ.prototype.remove=function(a){if(0<=a)this.heap_.remove(a);else for(a=-(a+1),f.assert(a<this.verts_.length&&null!==this.verts_[a]),this.verts_[a]=null;0<this.size_&&null===this.verts_[this.order_[this.size_-
1]];)--this.size_};f.PriorityQHeap=function(){this.heap_=f.PriorityQHeap.reallocNumeric_([0],f.PriorityQHeap.INIT_SIZE_+1);this.verts_=[null,null];this.handles_=[0,0];this.size_=0;this.max_=f.PriorityQHeap.INIT_SIZE_;this.freeList_=0;this.initialized_=!1;this.heap_[1]=1};f.PriorityQHeap.INIT_SIZE_=32;f.PriorityQHeap.reallocNumeric_=function(a,e){for(var f=Array(e),k=0;k<a.length;k++)f[k]=a[k];for(;k<e;k++)f[k]=0;return f};f.PriorityQHeap.prototype.init=function(){for(var a=this.size_;1<=a;--a)this.floatDown_(a);
this.initialized_=!0};f.PriorityQHeap.prototype.insert=function(a){var e=++this.size_;2*e>this.max_&&(this.max_*=2,this.handles_=f.PriorityQHeap.reallocNumeric_(this.handles_,this.max_+1));var m;0===this.freeList_?m=e:(m=this.freeList_,this.freeList_=this.handles_[this.freeList_]);this.verts_[m]=a;this.handles_[m]=e;this.heap_[e]=m;this.initialized_&&this.floatUp_(e);return m};f.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_};f.PriorityQHeap.prototype.minimum=function(){return this.verts_[this.heap_[1]]};
f.PriorityQHeap.prototype.extractMin=function(){var a=this.heap_,e=this.verts_,f=this.handles_,k=a[1],l=e[k];0<this.size_&&(a[1]=a[this.size_],f[a[1]]=1,e[k]=null,f[k]=this.freeList_,this.freeList_=k,0<--this.size_&&this.floatDown_(1));return l};f.PriorityQHeap.prototype.remove=function(a){var e=this.heap_,m=this.verts_,k=this.handles_;f.assert(1<=a&&a<=this.max_&&null!==m[a]);var l=k[a];e[l]=e[this.size_];k[e[l]]=l;l<=--this.size_&&(1>=l?this.floatDown_(l):f.geom.vertLeq(m[e[l>>1]],m[e[l]])?this.floatDown_(l):
this.floatUp_(l));m[a]=null;k[a]=this.freeList_;this.freeList_=a};f.PriorityQHeap.prototype.floatDown_=function(a){for(var e=this.heap_,m=this.verts_,k=this.handles_,l=e[a];;){var g=a<<1;g<this.size_&&f.geom.vertLeq(m[e[g+1]],m[e[g]])&&(g+=1);f.assert(g<=this.max_);var c=e[g];if(g>this.size_||f.geom.vertLeq(m[l],m[c])){e[a]=l;k[l]=a;break}e[a]=c;k[c]=a;a=g}};f.PriorityQHeap.prototype.floatUp_=function(a){for(var e=this.heap_,m=this.verts_,k=this.handles_,l=e[a];;){var g=a>>1,c=e[g];if(0===g||f.geom.vertLeq(m[c],
m[l])){e[a]=l;k[l]=a;break}e[a]=c;k[c]=a;a=g}};f.ActiveRegion=function(){this.nodeUp=this.eUp=null;this.windingNumber=0;this.fixUpperEdge=this.dirty=this.sentinel=this.inside=!1};f.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()};f.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()};return f})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define("require exports tslib ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/cim/cimAnalyzer ./WGLMeshTemplate".split(" "),
function(f,a,e,m,k,l,g){Object.defineProperty(a,"__esModule",{value:!0});var c=m.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");f=function(a){function b(b){var c=a.call(this)||this;c._ongoingMaterialRequestMap=new Map;c._materialCache=new Map;c._dynamicPropertyMap=new Map;c._cimLayer=b;return c}e.__extends(b,a);b.prototype.analyze=function(a,b,e,f){var d=this,g=this._materialCache,h=this._cimLayer.materialHash;if(!h)return c.error("A Dynamic mesh template must have a material hash value or function!"),
k.reject(null);var m="function"===typeof h?h(b,e,f):h;if(g.has(m))return a=g.get(m),k.resolve(a);if(this._ongoingMaterialRequestMap.has(m))return this._ongoingMaterialRequestMap.get(m);b=l.analyzeCIMResource(this._cimLayer.cim,this._cimLayer.materialOverrides);b.mosaicHash=m;a=a.getMosaicItem(b,!1).then(function(a){d._ongoingMaterialRequestMap.delete(m);g.set(m,a);return a}).catch(function(a){d._ongoingMaterialRequestMap.delete(m);c.error(".analyze()",a.message);return null});this._ongoingMaterialRequestMap.set(m,
a);return a};return b}(g.default);a.default=f})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("require exports tslib ../../../../../../core/screenUtils ../../color ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),function(f,a,e,m,k,l,g,c,h,b,d){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function b(b,d){var e=a.call(this,d)||this;e._cimLineLayer=d;var f=0;c.isFunction(d.width)||
(f=.5*m.pt2px(d.width));e._dynamicPropertyMap.set("_halfWidth",function(a,b,e){return c.isFunction(d.width)?.5*m.pt2px(d.width(a,b,e)):f});c.isFunction(d.cap)?e._dynamicPropertyMap.set("_capType",d.cap):e._capType=d.cap;c.isFunction(d.join)?e._dynamicPropertyMap.set("_joinType",d.join):e._joinType=d.join;if(c.isFunction(d.color))e._dynamicPropertyMap.set("_fillColor",function(a,b,c){return(a=d.color(a,b,c))&&k.premultiplyAlphaRGBA(a)||0});else{var h=d.color;e._fillColor=h&&k.premultiplyAlphaRGBA(h)||
0}c.isFunction(d.miterLimit)?e._dynamicPropertyMap.set("_miterLimitCosine",function(a,b,e){return c.getLimitCosine(d.miterLimit(a,b,e))}):e._miterLimitCosine=c.getLimitCosine(d.miterLimit);e._scaleFactor=d.scaleFactor||1;e._isDashed=d.isDashed;e.effects=d.effects;e.tessellationProperties._bitset=d.colorLocked?1:0;e._materialKey=g.createMaterialKey(e.geometryType,b,d.isOutline);e._initializeTessellator(!0);return e}e.__extends(b,a);b.fromCIMLine=function(a,c){return new b(a,c)};b.prototype.bindFeature=
function(a,b,c){var e=this;this._dynamicPropertyMap.forEach(function(d,f){e[f]=d(a,b,c)});this._halfWidth*=this._scaleFactor;var f=this._materialCache,h=this._cimLineLayer.materialHash,h=h(a,b,c),h=f.get(h),f=null;h&&d.ok(h.spriteMosaicItem)&&(f=h.spriteMosaicItem);if(f){this._hasPattern=!0;var h=f.rect,k=h.x+1+f.width,m=h.y+1+f.height;this.tessellationProperties._tl=l.i1616to32(h.x+1,h.y+1);this.tessellationProperties._br=l.i1616to32(k,m)}else this._hasPattern=!1,this.tessellationProperties._tl=
0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;h=g.LineMaterialKey.load(this._materialKey);f&&(h.sdf=f.sdf,h.pattern=!0,h.textureBinding=f.textureBinding);this._materialKey=h.data};return b}(h.default(b.default));a.default=f})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("require exports tslib ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../color ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x){Object.defineProperty(a,"__esModule",{value:!0});var u=h.vec2f32.create(),v=c.mat2df32.create(),y=k.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");f=function(a){function c(c,d){var e=a.call(this,d)||this;e._cimMarkerLayer=d;p.isFunction(d.color)?e._dynamicPropertyMap.set("_fillColor",function(a,c,e){return b.premultiplyAlphaRGBA(d.color(a,c,e))}):e._fillColor=b.premultiplyAlphaRGBA(d.color);p.isFunction(d.outlineColor)?e._dynamicPropertyMap.set("_outlineColor",
function(a,c,e){return b.premultiplyAlphaRGBA(d.outlineColor(a,c,e))}):e._outlineColor=b.premultiplyAlphaRGBA(d.outlineColor);p.isFunction(d.size)?e._dynamicPropertyMap.set("_size",function(a,b,c){return g.pt2px(d.size(a,b,c))}):e._size=g.pt2px(d.size);p.isFunction(d.scaleX)?e._dynamicPropertyMap.set("_scaleX",d.scaleX):e._scaleX=d.scaleX;p.isFunction(d.offsetX)?e._dynamicPropertyMap.set("xOffset",function(a,b,c){return g.pt2px(d.offsetX(a,b,c))}):e.xOffset=g.pt2px(d.offsetX);p.isFunction(d.offsetY)?
e._dynamicPropertyMap.set("yOffset",function(a,b,c){return g.pt2px(d.offsetY(a,b,c))}):e.yOffset=g.pt2px(d.offsetY);p.isFunction(d.outlineWidth)?e._dynamicPropertyMap.set("_outlineWidth",function(a,b,c){return g.pt2px(d.outlineWidth(a,b,c))}):e._outlineWidth=g.pt2px(d.outlineWidth);p.isFunction(d.rotation)?e._dynamicPropertyMap.set("_angle",d.rotation):e._angle=d.rotation;e._scaleFactor=l.unwrapOr(d.scaleFactor,1);e._markerPlacement=d.markerPlacement;e.effects=d.effects;e._bitSet=(1===d.alignment?
1:0)|(d.colorLocked?1:0)<<1|(d.scaleSymbolsProportionally?1:0)<<3;e._materialKey=n.createMaterialKey(e.geometryType,c,!1);return e}e.__extends(c,a);c.fromCIMMarker=function(a,b){return new c(a,b)};c.prototype.bindFeature=function(a,b,c){var e=this;this._dynamicPropertyMap.forEach(function(d,f){e[f]=d(a,b,c)});var f=this._cimMarkerLayer.materialHash,f="function"===typeof f?f(a,b,c):f;if((f=this._materialCache.get(f))&&x.ok(f.spriteMosaicItem)&&f.spriteMosaicItem){var f=f.spriteMosaicItem,h=this._cimMarkerLayer.sizeRatio,
k=f.width/f.height*this._scaleX,l=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,p=this._size,q=p*k,r=this.xOffset,z=this.yOffset;this.xOffset*=this._scaleFactor;this.yOffset*=this._scaleFactor;var A=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/g.pt2px(this._cimMarkerLayer.frameHeight):1,B=this._outlineWidth*A,C=g.pt2px(this._cimMarkerLayer.referenceSize),D=A=0,S=this._cimMarkerLayer.anchorPoint;S&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?
this._size&&(A=-S.x/(this._size*k),D=S.y/this._size):(A=S.x,D=S.y));this._sizeOutlineWidth=d.i8888to32(Math.round(Math.min(Math.sqrt(128*q),255)),Math.round(Math.min(Math.sqrt(128*p),255)),Math.round(Math.min(Math.sqrt(128*B),255)),Math.round(Math.min(Math.sqrt(128*C),255)));this.angle=l;this._bitestAndDistRatio=d.i8888to32(0,0,this._bitSet,Math.round(Math.min(64*h,255)));k=f.rect.x;l=f.rect.y;B=k+f.rect.width;C=l+f.rect.height;this._texUpperLeft=d.i1616to32(k,l);this._texUpperRight=d.i1616to32(B,
l);this._texBottomLeft=d.i1616to32(k,C);this._texBottomRight=d.i1616to32(B,C);k=n.MarkerMaterialKey.load(this._materialKey);k.sdf=f.sdf;k.pattern=!0;k.textureBinding=f.textureBinding;this._materialKey=k.data;this._anchorX=.5-((.5+A)*f.width+1)/f.rect.width;this._anchorY=.5-((.5+D)*f.height+1)/f.rect.height;q=q*h*this._scaleFactor;p=p*h*this._scaleFactor;q*=f.rect.width/f.width;p*=f.rect.height/f.height;this._computedWidth=q;this._computedHeight=p;this._applyTransformation(v,u);this.xOffset=r;this.yOffset=
z}else y.error(new m("mapview-cim","Encountered an error when binding feature"))};return c}(r.default(q.default));a.default=f})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("require exports tslib ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../../../layers/features/textUtils".split(" "),function(f,a,e,m,k,l,g,c,h,b,d){Object.defineProperty(a,"__esModule",
{value:!0});f=function(a){function b(b,d){var e=a.call(this,d)||this;e._horizontalAlignment="center";e._verticalAlignment="middle";e._textToGlyphs=new Map;var f=d.scaleFactor||1;e._cimTextLayer=d;c.isFunction(d.color)?e._dynamicPropertyMap.set("_color",function(a,b,c){return l.premultiplyAlphaRGBA(d.color(a,b,c))}):e._color=l.premultiplyAlphaRGBA(d.color);c.isFunction(d.color)?e._dynamicPropertyMap.set("_haloColor",function(a,b,c){return l.premultiplyAlphaRGBA(d.outlineColor(a,b,c))}):e._haloColor=
l.premultiplyAlphaRGBA(d.outlineColor);var h;c.isFunction(d.size)||(h=Math.min(Math.round(m.pt2px(d.size*d.sizeRatio)),127));e._dynamicPropertyMap.set("_size",function(a,b,e){return c.isFunction(d.size)?Math.min(Math.round(m.pt2px(d.size(a,b,e)*d.sizeRatio)),127):h});c.isFunction(d.outlineSize)?e._dynamicPropertyMap.set("_haloSize",function(a,b,c){return Math.min(Math.floor(5*m.pt2px(d.outlineSize(a,b,c)*d.sizeRatio)),127)}):e._haloSize=Math.min(Math.floor(5*m.pt2px(d.outlineSize*d.sizeRatio)),127);
var k;c.isFunction(d.offsetX)||(k=Math.round(m.pt2px(d.offsetX*d.sizeRatio)));e._dynamicPropertyMap.set("_xOffset",function(a,b,e){return c.isFunction(d.offsetX)?Math.round(m.pt2px(d.offsetX(a,b,e)*d.sizeRatio)):k});var n;c.isFunction(d.offsetY)||(n=Math.round(m.pt2px(d.offsetY*d.sizeRatio)));e._dynamicPropertyMap.set("_yOffset",function(a,b,e){return c.isFunction(d.offsetY)?Math.round(m.pt2px(d.offsetY(a,b,e)*d.sizeRatio)):n});c.isFunction(d.angle)?e._dynamicPropertyMap.set("_angle",d.angle):e._angle=
d.angle;c.isFunction(d.horizontalAlignment)?e._dynamicPropertyMap.set("_horizontalAlignment",d.horizontalAlignment):e._horizontalAlignment=d.horizontalAlignment;c.isFunction(d.verticalAlignment)?e._dynamicPropertyMap.set("_verticalAlignment",d.verticalAlignment):e._verticalAlignment=d.verticalAlignment;e._scaleFactor=f;c.isFunction(d.text)?e._dynamicPropertyMap.set("_text",d.text):e._text=d.text;f=Math.min(Math.round(m.pt2px(d.referenceSize*d.sizeRatio)),127);e._referenceSize=Math.round(Math.sqrt(256*
f));e._materialKey=g.createMaterialKey(e.geometryType,b,!1);b=g.TextMaterialKey.load(e._materialKey);b.sdf=!0;e._bitset=(1===d.alignment?1:0)|(d.colorLocked?1:0)<<1;e._materialKey=b.data;e._decoration="none";e._lineHeight=1;e._lineWidth=512;e._textPlacement=d.markerPlacement;e.effects=d.effects;e._isCIM=!0;return e}e.__extends(b,a);b.fromCIMText=function(a,c){return new b(a,c)};b.prototype.analyze=function(a,b,c,f){return e.__awaiter(this,void 0,void 0,function(){var g,h;return e.__generator(this,
function(e){switch(e.label){case 0:return e=this._cimTextLayer,g="string"===typeof e.text?e.text:"function"===typeof e.text?e.text(b,c,f):"",[4,a.getMosaicItem(this._cimTextLayer.cim,!1,d.codepoints(g))];case 1:return h=e.sent(),this._textToGlyphs.set(g,h.glyphMosaicItems),[2,h]}})})};b.prototype.bindFeature=function(a,b,c){var d=this;this._dynamicPropertyMap.forEach(function(e,f){d[f]=e(a,b,c)});if(this._text&&0!==this._text.length){this._size*=this._scaleFactor;this._scale=this._size/24;this._xOffset*=
this._scaleFactor;this._yOffset*=this._scaleFactor;this._xAlignD=k.getXAnchorDirection(this._horizontalAlignment||"center");this._yAlignD=k.getYAnchorDirection(this._verticalAlignment||"baseline");var e=this._textToGlyphs.get(this._text);this.bindTextInfo(e,!1)}else this._shapingInfo=null};return b}(h.default(b.default));a.default=f})},"esri/views/2d/layers/features/textUtils":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});a.codepoints=function(a){for(var e=
Array(a.length),f=0;f<a.length;f++)e[f]=a.charCodeAt(f);return e}})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("require exports tslib ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./WGLBaseFillTemplate ./WGLMeshTemplate".split(" "),function(f,a,e,m,k,l,g,c,h,b,d,n){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function d(c,d,e,f,g,
h,k,l,m,n){var p=a.call(this)||this;p.effects=n;c=b.FillMaterialKey.load(b.createMaterialKey(p.geometryType,c,!1));d&&(c.sdf=d.sdf,c.pattern=!0,c.textureBinding=d.textureBinding);p.fillColor=e;p.tl=f;p.br=g;p.aux1=h;p.aux2=k;p.aux3=l;p.isBFS=m;p._materialKey=c.data;return p}e.__extends(d,a);d.fromCIMFill=function(a,b,e,f){void 0===f&&(f=!1);var g=b.color,g=g&&l.premultiplyAlphaRGBA(g)||0;if(!e)return e=h.i8888to32(0,0,0,b.colorLocked?1:0),new d(a,null,g,0,0,0,0,e,f,b.effects);var n=e.rect,p=e.width,
q=e.height,r=n.x+1,u=n.y+1,v=r+p,x=u+q,n=m.nextHighestPowerOfTwo(k.pt2px(b.height||0));255<n?n=255:0>=n&&(n=m.nextHighestPowerOfTwo(x-u));q=m.nextHighestPowerOfTwo(k.pt2px(b.height/q*p||0));255<q?q=255:0>=q&&(q=m.nextHighestPowerOfTwo(v-r));var I=k.pt2px(b.offsetX||0)+128;255<I&&(I=255);var J=k.pt2px(-b.offsetY||0)+128;255<J&&(J=255);p=b.scaleX||1;r=h.i1616to32(r,u);v=h.i1616to32(v,x);n=h.i8888to32(q,n,I,J);x=h.i1616to32(128*p,128);p=h.i8888to32(0,0,c.degToByte(b.angle),b.colorLocked?1:0);return new d(a,
e,g,r,v,n,x,p,f,b.effects)};d.fromSimpleFill=function(a,b,c,e){void 0===e&&(e=!1);var f=b.color;b=f&&"none"!==b.style&&l.premultiplyAlphaRGBA(f)||0;f=h.i8888to32(0,0,0,e?255:0);if(!c)return new d(a,null,b,0,0,0,0,f,e,null);var g=c.rect,k=g.x+1,n=g.y+1,p=g.x+1+c.width,q=g.y+1+c.height,g=h.i1616to32(k,n),r=h.i1616to32(p,q),k=h.i8888to32(m.nextHighestPowerOfTwo(p-k),m.nextHighestPowerOfTwo(q-n),0,0),n=h.i1616to32(128,128);return new d(a,c,b,g,r,k,n,f,e,null)};d.fromPictureFill=function(a,b,c,e){void 0===
e&&(e=!1);var f=g.PICTURE_FILL_COLOR,l=c.rect,n=l.x+1,p=l.y+1,l=n+c.width,q=p+c.height,n=h.i1616to32(n,p),l=h.i1616to32(l,q),q=m.nextHighestPowerOfTwo(k.pt2px(b.width));255<q&&(q=255);p=m.nextHighestPowerOfTwo(k.pt2px(b.height));255<p&&(p=255);var r=k.pt2px(b.xoffset)+128;255<r&&(r=255);var u=k.pt2px(-b.yoffset)+128;255<u&&(u=255);q=h.i8888to32(q,p,r,u);b=h.i1616to32(128*b.xscale,128*b.yscale);p=h.i8888to32(0,0,0,e?255:0);return new d(a,c,f,n,l,q,b,p,e,null)};return d}(d.default(n.default));a.default=
f})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["require","exports","../../../../../core/promiseUtils"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){this._resolver=null}a.prototype.isHeld=function(){return!!this._resolver};a.prototype.acquire=function(){var a=this;return this._resolver?this._resolver.promise.then(function(){return a.acquire()}):(this._resolver=e.createResolver(),e.resolve())};a.prototype.release=function(){var a=this._resolver;
this._resolver=null;a.resolve()};return a}();a.default=f;a.withLock=function(a,e,f){return a.acquire().then(function(){return e(f)}).then(function(){return a.release()}).catch(function(e){a.release();throw e;})}})},"esri/views/2d/engine/webgl/TileData":function(){define("require exports ./MemoryRequirements ./TileBufferData ./TileDisplayData ./Utils ./Utils ./WGLDisplayObject ./WGLDisplayRecord ./mesh/VertexBuffer ./util/Reader ./util/serializationUtils ./util/Writer".split(" "),function(f,a,e,m,
k,l,g,c,h,b,d,n,p){Object.defineProperty(a,"__esModule",{value:!0});var r=new e.default,q=new e.default;f=function(){function a(){this.tileBufferData=this.tileDisplayData=null}a.prototype.reshuffle=function(){r.reset();for(var b=k.groupRecordsByGeometryType(this.tileDisplayData.displayObjects),c=0;c<b.length;c++)for(var d=b[c],e=0,f=d;e<f.length;e++){var h=f[e];h&&r.needMore(h.geometryType,h.meshData?h.meshData.vertexCount:h.vertexCount,h.meshData?h.meshData.indexData.length:h.indexCount)}e=b.length;
c=new m;for(f=0;f<e;++f){c.geometries[f].indexBuffer=new Uint32Array(Math.round(1.15*r.indicesFor(f)));var h=[],n;for(n in this.tileBufferData.geometries[f].vertexBuffer)h.push(this.tileBufferData.geometries[f].vertexBuffer[n].stride);var h=a._computeVertexAlignment(h),d=Math.round(1.15*r.verticesFor(f)),h=a._align(d,h),p;for(p in this.tileBufferData.geometries[f].vertexBuffer)d=this.tileBufferData.geometries[f].vertexBuffer[p].stride,c.geometries[f].vertexBuffer[p]={stride:d,data:g.allocateTypedArrayBuffer(h,
d)}}q.reset();this.tileDisplayData.displayList.clear();for(f=0;f<e;++f){d=b[f];n=0;for(p=d;n<p.length;n++){h=p[n];if(h.meshData)h.writeMeshDataToBuffers(q.verticesFor(f),c.geometries[f].vertexBuffer,q.indicesFor(f),c.geometries[f].indexBuffer),h.meshData=null;else{var x=this.tileBufferData.geometries[f].vertexBuffer,F=this.tileBufferData.geometries[f].indexBuffer,I=c.geometries[f].vertexBuffer,J=c.geometries[f].indexBuffer,G=q.verticesFor(f),H=q.indicesFor(f);l.copyMeshData(G,H,I,J,h,x,F);h.vertexFrom=
G;h.indexFrom=H}q.needMore(f,h.vertexCount,h.indexCount)}this.tileDisplayData.displayList.unified||this.tileDisplayData.displayList.addToList(d)}if(this.tileDisplayData.displayList.unified)for(b=0,e=this.tileDisplayData.displayObjects;b<e.length;b++)this.tileDisplayData.displayList.addToList(e[b].displayRecords);this.tileBufferData=c};a.prototype.getStrides=function(){for(var a=[],b=0;b<this.tileBufferData.geometries.length;++b){var c=this.tileBufferData.geometries[b];a[b]={};for(var d in c.vertexBuffer)a[b][d]=
c.vertexBuffer[d].stride}return a};a.prototype.clone=function(){var b=new a;b.tileBufferData=this.tileBufferData.clone();b.tileDisplayData=this.tileDisplayData.clone();return b};a.prototype._guessSize=function(){for(var a=this.tileDisplayData.displayObjects,b=Math.min(a.length,4),c=0,d=0;d<b;d++)c=Math.max(c,a[d].displayRecords.length);return 2*(12*a.length+a.length*c*40)};a.prototype.serialize=function(){var a=this.tileBufferData.serialize(),b=this.tileBufferData.getBuffers(),c=this.tileDisplayData.serialize(new p.default(Int32Array,
this._guessSize())).buffer();b.push(c);return{result:{displayData:c,bufferData:a},transferList:b}};a.decode=function(e){var f=n.deserializeList(new d.default(e.displayObjects),c),g={},h;for(h in e.vertexBuffersMap)g[h]=b.VertexBuffers.decode(e.vertexBuffersMap[h]);return a.fromMeshData({displayObjects:f,vertexBuffersMap:g})};a.fromMeshData=function(b){var c=new a,d=new k.default,e=new m;d.displayObjects=b.displayObjects;for(var f in b.vertexBuffersMap){var g=b.vertexBuffersMap[f];e.geometries[f].indexBuffer=
g.indexBuffer;e.geometries[f].vertexBuffer=g.namedBuffers}c.tileDisplayData=d;c.tileBufferData=e;return c};a.bind=function(b,c){var d=new a;d.tileDisplayData=b;d.tileBufferData=c;return d};a.create=function(b,c){var d=new a;d.tileDisplayData=new k.default;d.tileDisplayData.displayObjects=b;for(var e=[0,0,0,0,0],f=[0,0,0,0,0],l=[[],[],[],[],[]],n=0;n<b.length;n++)for(var p=0,q=b[n].displayRecords;p<q.length;p++){var r=q[p];l[r.geometryType].push(r);e[r.geometryType]+=r.meshData.vertexCount;f[r.geometryType]+=
r.meshData.indexData.length}b=new m;c=[c.fill||{},c.line||{},c.icon||{},c.text||{},c.label||{}];for(n=0;5>n;n++){var p=new Uint32Array(f[n]),q=c[n],r=e[n],u={},v=void 0;for(v in q){var x={data:g.allocateTypedArrayBuffer(r,q[v]),stride:q[v]};u[v]=x}q=u;h.writeAllMeshDataToBuffers(l[n],q,p);b.geometries[n]={indexBuffer:p,vertexBuffer:q}}d.tileBufferData=b;return d};a._align=function(a,b){var c=a%b;return 0===c?a:a+(b-c)};a._computeVertexAlignment=function(a){for(var b=!1,c=!1,d=0;d<a.length;d++){var e=
a[d];2===e%4?b=!0:0!==e%4&&(c=!0)}return c?4:b?2:1};return a}();a.TileData=f})},"esri/views/2d/engine/webgl/MemoryRequirements":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){this._byGeometryType=null}Object.defineProperty(a.prototype,"satisfied",{get:function(){return!this._byGeometryType},enumerable:!0,configurable:!0});a.prototype.reset=function(){this._byGeometryType=null};a.prototype.verticesFor=function(a){return this._byGeometryType?
this._byGeometryType[a].vertices:0};a.prototype.indicesFor=function(a){return this._byGeometryType?this._byGeometryType[a].indices:0};a.prototype.needMore=function(a,e,f){if(e||f)this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]),a=this._byGeometryType[a],a.vertices+=e,a.indices+=f};return a}();a.default=f})},"esri/views/2d/engine/webgl/TileBufferData":function(){define(["require","exports",
"./Utils"],function(f,a,e){return function(){function a(){this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}a.prototype.clone=function(){for(var e=new a,f=0;f<this.geometries.length;f++){var g=this.geometries[f],c=e.geometries[f];c.indexBuffer=g.indexBuffer.slice();c.vertexBuffer={};for(var h in g.vertexBuffer){var b=g.vertexBuffer[h],d=b.stride;
c.vertexBuffer[h]={data:b.data.slice(),stride:d}}}return e};a.deserialize=function(f){for(var k=new a,g=0;5>g;++g){k.geometries[g].indexBuffer=new Uint32Array(f.geometries[g].indexBuffer);k.geometries[g].vertexBuffer={};for(var c in f.geometries[g].vertexBuffer)k.geometries[g].vertexBuffer[c]={data:e.allocateTypedArrayBufferwithData(f.geometries[g].vertexBuffer[c].data,f.geometries[g].vertexBuffer[c].stride),stride:f.geometries[g].vertexBuffer[c].stride}}return k};a.prototype.serialize=function(){for(var a=
{geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]},e=0;5>e;++e)for(var f in this.geometries[e].vertexBuffer)a.geometries[e].vertexBuffer[f]={data:this.geometries[e].vertexBuffer[f].data.buffer,stride:this.geometries[e].vertexBuffer[f].stride};
return a};a.prototype.getBuffers=function(){for(var a=[],e=0;5>e;++e){a.push(this.geometries[e].indexBuffer.buffer);for(var f in this.geometries[e].vertexBuffer)a.push(this.geometries[e].vertexBuffer[f].data.buffer)}return a};return a}()})},"esri/views/2d/engine/webgl/TileDisplayData":function(){define(["require","exports","./WGLDisplayList","./WGLDisplayObject","./util/serializationUtils"],function(f,a,e,m,k){function l(a){for(var c=[[],[],[],[],[]],e=0;e<a.length;e++)for(var b=0,d=a[e].displayRecords;b<
d.length;b++){var f=d[b];c[f.geometryType].push(f)}return c}Object.defineProperty(a,"__esModule",{value:!0});a.groupRecordsByGeometryType=l;f=function(){function a(){}Object.defineProperty(a.prototype,"displayObjectRegistry",{get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(var a=0,e=this.displayObjects;a<e.length;a++){var b=e[a];this._displayObjectRegistry.set(b.id,b)}}return this._displayObjectRegistry},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"displayList",{get:function(){return this._displayList},enumerable:!0,configurable:!0});a.prototype.computeDisplayList=function(a){this._displayList=new e(a);if(a){a=0;for(var c=this.displayObjects;a<c.length;a++)for(var b=0,d=c[a].displayRecords;b<d.length;b++)this._displayList.addToList(d[b])}else for(a=l(this.displayObjects),c=a.length,b=0;b<c;++b)this._displayList.addToList(a[b])};a.prototype.clone=function(){var c=new a;this.displayObjects&&(c.displayObjects=this.displayObjects.map(function(a){return a.clone()}));
return c};a.prototype.serialize=function(a){k.serializeList(a,this.displayObjects);return a};a.prototype._deserializeObjects=function(a){for(var c=a.readInt32(),c=Array(c),b=new Map,d=0;d<c.length;++d){var e=m.deserialize(a);c[d]=e;b.set(e.id,e)}this.displayObjects=c;this._displayList=null;this._displayObjectRegistry=b};a.deserialize=function(c){var e=new a;e._deserializeObjects(c);return e};return a}();a.default=f})},"esri/views/2d/engine/webgl/WGLDisplayList":function(){define(["require","exports",
"tslib","../../../../core/Logger","./enums"],function(f,a,e,m,k){function l(a,b,c){for(var d=[],f=3;f<arguments.length;f++)d[f-3]=arguments[f];b<a.length?a.splice.apply(a,e.__spreadArrays([b,c],d)):a.push.apply(a,d)}var g=m.getLogger("esri.views.2d.engine.webgl.WGLDisplayList");f=new Map;f.set(k.WGLDrawPhase.MAP,[k.WGLGeometryType.FILL,k.WGLGeometryType.LINE,k.WGLGeometryType.MARKER,k.WGLGeometryType.TEXT]);f.set(k.WGLDrawPhase.LABEL,[k.WGLGeometryType.LABEL]);f.set(k.WGLDrawPhase.LABEL_ALPHA,[k.WGLGeometryType.LABEL]);
f=function(){function a(a){void 0===a&&(a=!1);this.symbolLevels=[];this.unified=a}a.prototype.replay=function(a,b,c){if(this.unified)for(var d=0,e=this.symbolLevels;d<e.length;d++)for(var f=0,g=e[d].zLevels;f<g.length;f++){var h=g[f].geometryDPInfo,k;for(k in h)if(h[k])for(var l=0,m=h[k];l<m.length;l++){var n=m[l],p=a.painter.getGeometryBrush(n.geometryType),q=b.getGeometry(n.geometryType);p.prepareState(a,b);p.drawGeometry(a,b,n,q,c)}}};Object.defineProperty(a.prototype,"empty",{get:function(){return!this.symbolLevels||
0===this.symbolLevels.length},enumerable:!0,configurable:!0});a.prototype.clear=function(){this.symbolLevels.length=0};a.prototype.addToList=function(a,b){if(Array.isArray(a))for(var c=0;c<a.length;c++)this._addToList(a[c],b);else this._addToList(a,b)};a.prototype.removeFromList=function(a){Array.isArray(a)||(a=[a]);for(var b=null,c=0;c<a.length;c++)b=this._removeFromList(a[c]);return b};a.prototype.byType=function(a,b){for(var c=0,d=this.symbolLevels;c<d.length;c++)for(var e=0,f=d[c].zLevels;e<f.length;e++){var g=
f[e].geometryDPInfo,h=this.getDPInfoType(a);if(g[h])for(var k=0,g=g[h];k<g.length;k++)b(g[k])}};a.prototype.clone=function(){for(var b=new a(this.unified),c=0,d=this.symbolLevels;c<d.length;c++)b.symbolLevels.push(d[c].clone());return b};a.prototype.splitAfter=function(a){for(var b=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType),d=b.length,e=a.indexFrom+a.indexCount,f=0;f<d;++f){var g=b[f];if(g.geometryType===a.geometryType&&e>g.indexFrom&&e<=g.indexFrom+g.indexCount)return e<g.indexFrom+
g.indexCount&&(a=new c,a.geometryType=g.geometryType,a.materialKey=g.materialKey,a.indexFrom=e,a.indexCount=g.indexFrom+g.indexCount-e,b.splice(f+1,0,a),g.indexCount=e-g.indexFrom),f}};a.prototype._addToList=function(a,b){var d=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType);b=null!=b?b:d.length-1;var e=0<=b&&b<d.length?d[b]:null;null===e||e.materialKey!==a.materialKey||e.indexFrom+e.indexCount!==a.indexFrom||this.unified&&e.geometryType!==a.geometryType?(e=new c,e.indexFrom=a.indexFrom,
e.indexCount=a.indexCount,e.materialKey=a.materialKey,e.geometryType=a.geometryType,l(d,b+1,0,e)):e.indexCount+=a.indexCount};a.prototype._removeFromList=function(a){for(var b=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType),d=b.length,e=void 0,f=0;f<d;++f){var g=b[f];if(a.indexFrom+a.indexCount>g.indexFrom&&a.indexFrom<g.indexFrom+g.indexCount&&(!this.unified||g.geometryType===a.geometryType)){e=f;break}}if(void 0!==e){g=b[e];if(a.indexFrom===g.indexFrom)return g.indexCount-=a.indexCount,
g.indexFrom+=a.indexCount,0===g.indexCount&&l(b,e,1),e-1;if(a.indexFrom+a.indexCount===g.indexFrom+g.indexCount)return g.indexCount-=a.indexCount,0===g.indexCount?(l(b,e,1),e-1):e;var d=g.indexFrom,f=a.indexFrom-g.indexFrom,h=a.indexCount;a=g.indexFrom+g.indexCount-(a.indexFrom+a.indexCount);g.indexCount=f;var k=new c;k.geometryType=g.geometryType;k.materialKey=g.materialKey;k.indexFrom=d+f+h;k.indexCount=a;l(b,e+1,0,k);return e}return null};a.prototype._getDisplayList=function(a,c,e){for(var f,g=
this.symbolLevels.length,l=0;l<g;l++)if(this.symbolLevels[l].symbolLevel===a){f=this.symbolLevels[l];break}f||(f=new d,f.symbolLevel=a,this.symbolLevels.push(f));var m;a=f.zLevels.length;for(g=0;g<a;g++)if(f.zLevels[g].zLevel===c){m=f.zLevels[g];break}m||(m=new b,m.geometryDPInfo=new h,m.zLevel=c,f.zLevels.push(m));var n;if(this.unified)m.geometryDPInfo.unified||(m.geometryDPInfo.unified=[]),n=m.geometryDPInfo.unified;else switch(e){case k.WGLGeometryType.FILL:m.geometryDPInfo.fill||(m.geometryDPInfo.fill=
[]);n=m.geometryDPInfo.fill;break;case k.WGLGeometryType.LINE:m.geometryDPInfo.line||(m.geometryDPInfo.line=[]);n=m.geometryDPInfo.line;break;case k.WGLGeometryType.MARKER:m.geometryDPInfo.marker||(m.geometryDPInfo.marker=[]);n=m.geometryDPInfo.marker;break;case k.WGLGeometryType.TEXT:m.geometryDPInfo.text||(m.geometryDPInfo.text=[]);n=m.geometryDPInfo.text;break;case k.WGLGeometryType.LABEL:m.geometryDPInfo.label||(m.geometryDPInfo.label=[]);n=m.geometryDPInfo.label;break;default:console.error("Trying to add a record with geometry type '"+
e+"'.")}return n};a.prototype.getDPInfoType=function(a){if(this.unified)return"unified";switch(a){case k.WGLGeometryType.FILL:return"fill";case k.WGLGeometryType.LINE:return"line";case k.WGLGeometryType.MARKER:return"marker";case k.WGLGeometryType.TEXT:return"text";case k.WGLGeometryType.LABEL:return"label";default:g.error("DisplayList: Tried to convert unknown geometryType: "+a)}};return a}();var c=function(){function a(){this.materialKey=null;this.indexCount=this.indexFrom=0}a.prototype.clone=function(){var b=
new a;b.geometryType=this.geometryType;b.materialKey=this.materialKey;b.indexFrom=this.indexFrom;b.indexCount=this.indexCount;return b};return a}(),h=function(){function a(){this.unified=this.label=this.text=this.marker=this.line=this.fill=null}a.prototype.clone=function(){var b=new a;b.fill=this.fill&&this.fill.map(function(a){return a.clone()});b.line=this.line&&this.line.map(function(a){return a.clone()});b.marker=this.marker&&this.marker.map(function(a){return a.clone()});b.text=this.text&&this.text.map(function(a){return a.clone()});
b.label=this.label&&this.label.map(function(a){return a.clone()});b.unified=this.unified&&this.unified.map(function(a){return a.clone()});return b};return a}(),b=function(){function a(){this.geometryDPInfo=new h}a.prototype.clone=function(){var b=new a;b.zLevel=this.zLevel;b.geometryDPInfo=this.geometryDPInfo.clone();return b};return a}(),d=function(){function a(){this.zLevels=[]}a.prototype.clone=function(){var b=new a;b.symbolLevel=this.symbolLevel;for(var c=0,d=this.zLevels;c<d.length;c++)b.zLevels.push(d[c].clone());
return b};return a}();return f})},"esri/views/2d/engine/webgl/util/Reader":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(a){this._pos=0;this._buffer=a;this._i32View=new Int32Array(this._buffer);this._f32View=new Float32Array(this._buffer)}a.prototype.readInt32=function(){return this._i32View[this._pos++]};a.prototype.readF32=function(){return this._f32View[this._pos++]};return a}();a.default=f})},"esri/views/2d/engine/webgl/WGLRendererInfo":function(){define("require exports ../../../../Color ../../../../core/has ../../../../core/maybe ../../../../core/screenUtils ../../../../core/unitUtils ../../../../core/libs/gl-matrix-2/mat4f32 ../../../../renderers/support/utils ./definitions ./Utils".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d){function n(a,b){var c=b.length;if(a<b[0].value||1===c)return b[0].size;for(var d=1;d<c;d++)if(a<b[d].value)return b[d-1].size+(a-b[d-1].value)/(b[d].value-b[d-1].value)*(b[d].size-b[d-1].size);return b[c-1].size}function p(a,b,c){void 0===c&&(c=0);if(k.isNone(b))a[c+0]=0,a[c+1]=0,a[c+2]=0,a[c+3]=0;else{var d=b.g,e=b.b,f=b.a;a[c+0]=b.r*f/255;a[c+1]=d*f/255;a[c+2]=e*f/255;a[c+3]=f}}Object.defineProperty(a,"__esModule",{value:!0});var r=function(a,b,c){for(var d=c*=16,
e=0;d<Math.min(c+16,a.length);d++,e++)a[d]=b[e]},q=c.mat4f32.create();f=function(){function a(){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this.ddColors=new Float32Array(32);this.ddBackgroundColor=new Float32Array(4);this.ddActiveDots=new Float32Array(8);this.insideEffect=new Float32Array(16*b.MAX_FILTERS);this.insideOpacity=1;
this.outsideEffect=new Float32Array(16*b.MAX_FILTERS);this.outsideOpacity=1;this.effectCount=0;this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1};this._buf0=new Float32Array(2);this._buf1=new Float32Array(2);this.symbolLevels.push(0);for(var a=0;a<b.MAX_FILTERS;a++)r(this.insideEffect,q,a),r(this.outsideEffect,q,a)}Object.defineProperty(a.prototype,"insideOpacities",{get:function(){this._buf0[0]=1;this._buf0[1]=this.insideOpacity;
return this._buf0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"outsideOpacities",{get:function(){this._buf1[0]=0;this._buf1[1]=this.outsideOpacity;return this._buf1},enumerable:!0,configurable:!0});a.prototype.getSizeVVFieldStops=function(a){var b=this._vvSizeFieldStops;switch(b.type){case "static":return b;case "level-dependent":return k.unwrapOr(b.levels[a],function(){var c=Infinity,d=0,e;for(e in b.levels){var f=parseFloat(e),g=Math.abs(a-f);g<c&&(c=g,d=f)}if(Infinity===
c)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};c=Math.pow(2,(a-d)/2);d=k.unwrap(b.levels[d]);e=new Float32Array(d.values);e[2]*=c;e[3]*=c;return{sizes:k.unwrap(d.sizes),values:e}})}};Object.defineProperty(a.prototype,"vvMaterialParameters",{get:function(){return this._vvMaterialParameters},enumerable:!0,configurable:!0});a.prototype.update=function(a){k.isSome(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,a)};a.prototype.setInfo=function(a,
b,c){var d=this;k.isSome(c)?(c.forEach(function(a,b){return d._updateEffects(b,a)}),this.effectCount=c.length):this.effectCount=0;this._vvInfo=b;switch(a.type){case "dot-density":this._updateDotDensityInfo(a)}};a.prototype.getVariation=function(){return{ddDotBlending:this.ddDotBlending,outsideLabelsVisible:this.outsideLabelsVisible,effectCount:this.effectCount,oesTextureFloat:m("esri-webgl-texture-float")}};a.prototype.getVariationHash=function(){return(this.ddDotBlending?1:0)|(this.outsideLabelsVisible?
1:0)<<1|this.effectCount<<2};a.prototype._updateEffects=function(a,b){a+=1;if(k.isSome(b)&&b.filter&&b.filter.enabled){this.outsideLabelsVisible=b.excludedLabelsVisible;var c=b.parsedIncludedEffect;b=b.parsedExcludedEffect;k.isSome(c)?(r(this.insideEffect,c.getColorMatrix(),a),this.insideOpacity=c.getOpacity()):(r(this.insideEffect,q,a),this.insideOpacity=1);k.isSome(b)?(r(this.outsideEffect,b.getColorMatrix(),a),this.outsideOpacity=b.getOpacity()):(r(this.outsideEffect,q,a),this.outsideOpacity=1)}else r(this.insideEffect,
q,a),r(this.outsideEffect,q,a),this.outsideOpacity=this.insideOpacity=1};a.prototype._updateVisualVariables=function(a,b){var c=this._vvMaterialParameters;c.vvOpacityEnabled=!1;c.vvSizeEnabled=!1;c.vvColorEnabled=!1;c.vvRotationEnabled=!1;if(a){var e=a.size;if(e){c.vvSizeEnabled=!0;if(e.minMaxValue){var f=e.minMaxValue,k=void 0,m=void 0;d.isDefined(f.minSize)&&d.isDefined(f.maxSize)&&(d.isNumber(f.minSize)&&d.isNumber(f.maxSize)?(k=l.pt2px(f.minSize),m=l.pt2px(f.maxSize)):(m=b.scale,k=l.pt2px(n(m,
f.minSize.stops)),m=l.pt2px(n(m,f.maxSize.stops))));this.vvSizeMinMaxValue.set([f.minDataValue,f.maxDataValue,k,m])}e.scaleStops&&(this.vvSizeScaleStopsValue=l.pt2px(n(b.scale,e.scaleStops.stops)));e.unitValue&&(this.vvSizeUnitValueToPixelsRatio=g.getMetersPerUnitForSR(b.spatialReference)/h.meterIn[e.unitValue.unit]/b.resolution);e.fieldStops&&(this._vvSizeFieldStops=e.fieldStops)}if(b=a.color)c.vvColorEnabled=!0,this.vvColorValues.set(b.values),this.vvColors.set(b.colors);if(b=a.opacity)c.vvOpacityEnabled=
!0,this.vvOpacityValues.set(b.values),this.vvOpacities.set(b.opacities);if(a=a.rotation)c.vvRotationEnabled=!0,c.vvRotationType=a.type}};a.prototype._updateDotDensityInfo=function(a){var c=a.attributes;this.ddDotValue=a.dotValue;this.ddDotScale=a.referenceScale;this.ddDotSize=a.dotSize;this.ddDotBlending=a.dotBlendingEnabled;this.ddSeed=a.seed;for(var d=0;d<b.DOT_DENSITY_MAX_FIELDS;d++){var f=d>=c.length?new e([0,0,0,0]):c[d].color;p(this.ddColors,f,4*d)}for(d=0;8>d;d++)this.ddActiveDots[d]=d<a.attributes.length?
1:0;p(this.ddBackgroundColor,a.backgroundColor)};return a}();a.WGLRendererInfo=f})},"esri/core/libs/gl-matrix-2/mat4f32":function(){define(["require","exports","./factories/mat4f32"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.mat4f32=e})},"esri/core/libs/gl-matrix-2/factories/mat4f32":function(){define(["require","exports"],function(f,a){function e(){var a=new Float32Array(16);a[0]=1;a[5]=1;a[10]=1;a[15]=1;return a}Object.defineProperty(a,"__esModule",{value:!0});a.create=
e;a.clone=function(a){var e=new Float32Array(16);e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=a[3];e[4]=a[4];e[5]=a[5];e[6]=a[6];e[7]=a[7];e[8]=a[8];e[9]=a[9];e[10]=a[10];e[11]=a[11];e[12]=a[12];e[13]=a[13];e[14]=a[14];e[15]=a[15];return e};a.fromValues=function(a,e,f,g,c,h,b,d,n,p,r,q,x,u,v,y){var k=new Float32Array(16);k[0]=a;k[1]=e;k[2]=f;k[3]=g;k[4]=c;k[5]=h;k[6]=b;k[7]=d;k[8]=n;k[9]=p;k[10]=r;k[11]=q;k[12]=x;k[13]=u;k[14]=v;k[15]=y;return k};a.createView=function(a,e){return new Float32Array(a,e,16)};
a.IDENTITY=e()})},"esri/views/2d/engine/webgl/WGLTile":function(){define("require exports tslib ../../../../core/libs/gl-matrix-2/mat2d ../../../../core/libs/gl-matrix-2/mat2df32 ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ./definitions ./DirtyMap ./DisplayRecordStore ./Fader ./TiledDisplayObject ./WGLBuffers".split(" "),function(f,a,e,m,k,l,g,c,h,b,d,n,p){Object.defineProperty(a,"__esModule",{value:!0});var r=new Set;f=function(a){function f(b,e,f){void 0===f&&
(f=!1);b=a.call(this,b,e,[c.TILE_SIZE,c.TILE_SIZE])||this;b._data=null;b._displayList=null;b._wglBuffers=null;b._dirtyMap=new h.default;b._labelIndex=null;b._dirty=!0;b.fader=new d.default;b._ensureCorrectZOrder=f;b.transforms.labelMat2d=k.mat2df32.create();return b}e.__extends(f,a);f.prototype.destroy=function(){this.clear()};Object.defineProperty(f.prototype,"displayObjects",{get:function(){return this._data.tileDisplayData.displayObjects},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,
"isDirty",{get:function(){return this._dirty},set:function(a){(this._dirty=a)||this.isReady||this.ready();this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"hasData",{get:function(){return!!this._data},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"labelIndex",{get:function(){return this._labelIndex},enumerable:!0,configurable:!0});f.prototype.getGeometry=function(a){return this._wglBuffers&&this._wglBuffers.has(a)?this._wglBuffers.get(a):
null};f.prototype.getDisplayList=function(){return this._data&&this._displayList};Object.defineProperty(f.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0});f.prototype.setTransform=function(b,c){a.prototype.setTransform.call(this,b,c);var d=this.transforms.labelMat2d;c=b.getScreenTransform(d,c);var e=g.vec2f32.create();l.vec2.transformMat2d(e,this.coords,c);m.mat2d.identity(d);m.mat2d.translate(d,d,e);m.mat2d.multiply(d,b.viewMat2d,d)};f.prototype.setData=function(a,
c,d){var e=a.addOrUpdate,f=a.remove;!a.clear&&this.hasData||a.addOrUpdate?!a.clear&&this.hasData||!a.addOrUpdate?this.hasData&&this._doPatchData({addOrUpdate:e,remove:f},c,d):(e.tileDisplayData.computeDisplayList(this._ensureCorrectZOrder),this._dirtyMap=new h.default,this._dispRecStore=b.default.fromTileData(e,this._dirtyMap),this._data=e,this._readyTileIfNoLabels(c,d),this._dirtyMap.markAllDirty(),this._displayList||(this._displayList=e.tileDisplayData.displayList.clone())):(this.clear(),this.ready());
this.emit("change")};f.prototype.commitChanges=function(){this.fader.step()||this.requestRender();this._wglBuffers||(this._wglBuffers=new p.default(this.stage.context));this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap);this._displayList=this._data.tileDisplayData.displayList.clone();this._dirtyMap.markAllClean()};f.prototype.clear=function(){this._dispRecStore=this._displayList=this._data=null;this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null)};f.prototype._readyTileIfNoLabels=
function(a,b){a&&this._rebuildLabelIndex();this.isDirty=a&&b?!0:!1};f.prototype._doPatchData=function(a,c,d){this._patchData(a)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=b.default.fromTileData(this._data,this._dirtyMap));this._readyTileIfNoLabels(c,d);this.requestRender()};f.prototype._rebuildLabelIndex=function(){this._labelIndex=this._initLabelIndex();for(var a=0,b=this.displayObjects;a<b.length;a++)for(var c=0,d=b[a].metrics;c<d.length;c++)this._insertIntoLabelIndex(d[c])};
f.prototype._insertIntoLabelIndex=function(a){0>a.xBucket||0>a.yBucket||3<a.yBucket||3<a.xBucket||this.labelIndex[a.yBucket][a.xBucket].push(a)};f.prototype._initLabelIndex=function(){for(var a=[],b=0;b<c.TILE_SIZE/c.COLLISION_BUCKET_SIZE;b++){a.push([]);for(var d=0;d<c.TILE_SIZE/c.COLLISION_BUCKET_SIZE;d++)a[b].push([])}return a};f.prototype._patchData=function(a){for(var b=!0,c=a.addOrUpdate&&a.addOrUpdate.tileDisplayData&&a.addOrUpdate.tileDisplayData.displayObjects||[],d=(a.remove||[]).slice(),
e=0;e<c.length;e++){var f=c[e];null!=f.insertAfter&&d.push(f.id)}for(f=0;f<d.length;f++){var g=d[f];if(e=this._data.tileDisplayData.displayObjectRegistry.get(g)){this._data.tileDisplayData.displayList.removeFromList(e.displayRecords);for(var h=0,k=e.displayRecords;h<k.length;h++)this._dispRecStore.delete(k[h]);this._data.tileDisplayData.displayObjectRegistry.delete(g);e=this._data.tileDisplayData.displayObjects.indexOf(e);this._data.tileDisplayData.displayObjects.splice(e,1)}}for(d=0;d<c.length;d++){f=
c[d];e=this._data.tileDisplayData.displayObjectRegistry.get(f.id);g=void 0;if(e){h=e.displayRecords;e.set(f);e.displayRecords=h;h=e.displayRecords.length;for(k=0;k<h;++k){var l=e.displayRecords[k],m=f.displayRecords[k];if(k>=f.displayRecords.length||l.geometryType!==m.geometryType||l.symbolLevel!==m.symbolLevel||l.zOrder!==m.zOrder||l.materialKey!==m.materialKey)this._dispRecStore.delete(e.displayRecords[k]),k<f.displayRecords.length&&(e.displayRecords[k]=void 0)}e.displayRecords.length=f.displayRecords.length;
e.metrics=f.metrics}else if(e=f.copy(),e.displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(f.id,e),k=void 0,l=this._data.tileDisplayData.displayObjects,null!=e.insertAfter?(g={},0<=e.insertAfter?(h=this._data.tileDisplayData.displayObjectRegistry.get(e.insertAfter))?(k=l.indexOf(h)+1,k<l.length?l.splice(k,0,e):(l.push(e),k=l.length)):(l.push(e),k=l.length):(l.unshift(e),k=0)):(l.push(e),k=l.length),g){m=void 0;if(this._data.tileDisplayData.displayList.unified)m=0<f.displayRecords.length?
1:0;else{r.clear();for(var m=0,n=f.displayRecords;m<n.length;m++)h=this._data.tileDisplayData.displayList.getDPInfoType(n[m].geometryType),r.add(h);m=r.size}n=0;for(--k;0<=k&&n<m;--k)for(var p=l[k].displayRecords.length-1;0<=p&&n<m;--p){var q=l[k].displayRecords[p],h=this._data.tileDisplayData.displayList.getDPInfoType(q.geometryType);g[h]||(g[h]=q,++n)}}n=f.displayRecords.length;for(k=0;k<n;++k){m=f.displayRecords[k];(l=e.displayRecords[k])?(l.meshData=m.meshData,l.materialKey=m.materialKey):(l=
m.copy(),l.vertexFrom=void 0,l.indexFrom=void 0,e.displayRecords[k]=l);var p=m.geometryType,h=this._data.tileDisplayData.displayList.getDPInfoType(p),q=a.addOrUpdate.tileBufferData.geometries[p],p=q.vertexBuffer,q=q.indexBuffer,u=void 0;g&&(u=g[h]?this._data.tileDisplayData.displayList.splitAfter(g[h]):-1);b=this._dispRecStore.setMeshData(l,m,p,q,u)&&b;g&&null!=l.indexFrom&&null!=l.indexFrom&&(g[h]=l)}}return b};return f}(n.TiledDisplayObject);a.WGLTile=f})},"esri/views/2d/engine/webgl/DirtyMap":function(){define(["require",
"exports","./Utils"],function(f,a,e){function m(a,e,f){if(!a.allDirty)if(null!=a.from&&null!=a.count){var c=Math.min(a.from,e);e=Math.max(a.from+a.count,e+f)-c;a.from=c;a.count=e}else a.from=e,a.count=f}Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){this._dirties=e.createGeometryData(function(){return{indices:{from:null,count:null,allDirty:!1}}},function(){return{vertices:{from:null,count:null,allDirty:!1}}})}a.prototype.hasDirty=function(){for(var a=0,e=this._dirties;a<
e.length;a++){var c=e[a];if(null!==c.data.indices.count||c.data.indices.allDirty)return!0}return!1};a.prototype.markAllClean=function(){for(var a=0,e=this._dirties;a<e.length;a++){var c=e[a];c.data.indices.from=null;c.data.indices.count=null;c.data.indices.allDirty=!1;for(var f in c.buffers)c.buffers[f].data.vertices.from=null,c.buffers[f].data.vertices.count=null,c.buffers[f].data.vertices.allDirty=!1}};a.prototype.markAllDirty=function(){for(var a=0,e=this._dirties;a<e.length;a++){var c=e[a];c.data.indices.allDirty=
!0;for(var f in c.buffers)c.buffers[f].data.vertices.allDirty=!0}};a.prototype.forEach=function(a){for(var e=0;e<this._dirties.length;++e){var c=this._dirties[e],f={},b;for(b in c.buffers){var d=c.buffers[b].data.vertices;if(d.allDirty||null!=d.from&&null!=d.count&&0<d.count)f[b]=d}c=c.data.indices;d=void 0;d=c.allDirty||null!=c.from&&null!=c.count&&0<c.count?{indices:c,vertices:f}:{indices:null,vertices:f};(d.indices||0<Object.keys(d).length)&&a(d,e)}};a.prototype.markDirtyIndices=function(a,e,c){m(this._dirties[a].data.indices,
e,c)};a.prototype.markDirtyVertices=function(a,e,c,f){m(this._dirties[a].buffers[e].data.vertices,c,f)};return a}();a.default=f})},"esri/views/2d/engine/webgl/DisplayRecordStore":function(){define(["require","exports","../../../../core/has","./FreeList","./Utils"],function(f,a,e,m,k){function l(a){a=a.getStrides();for(var c={},b=0;b<a.length;b++)c[g[b]]=a[b];return c}Object.defineProperty(a,"__esModule",{value:!0});var g=["FILL","LINE","MARKER","TEXT","LABEL"];f=function(){function a(a,b,c,e){this._strides=
a;this._displayList=b;this._freeListsAndStorage={};this._dirtyMap=null;this._dirtyMap=c;for(var d in a){this._freeListsAndStorage[d]={vtxFreeList:e?new m.FreeList(e):null,idxFreeList:e?new m.FreeList(e):null,vertexBuffers:{},indexBuffer:e?new Uint32Array(e):null};for(var f in a[d])this._freeListsAndStorage[d].vertexBuffers[f]={data:e?k.allocateTypedArrayBuffer(e,a[d][f]):null,stride:a[d][f]}}}a.fromTileData=function(c,b){var d=l(c),e=[0,0,0,0,0],f=[0,0,0,0,0],h=[];c.tileDisplayData.displayObjectRegistry.forEach(function(a){h.push(a)});
for(var q=0;q<h.length;q++)for(var x=0,u=h[q].displayRecords;x<u.length;x++){var v=u[x];e[v.geometryType]=Math.max(e[v.geometryType],v.vertexFrom+v.vertexCount);f[v.geometryType]=Math.max(f[v.geometryType],v.indexFrom+v.indexCount)}b=new a(d,c.tileDisplayData.displayList,b,null);for(d=0;d<c.tileBufferData.geometries.length;++d){var q=e[d],u=f[d],v=c.tileBufferData.geometries[d],x=b._storageFor(g[d]),y=c.tileBufferData.geometries[d].indexBuffer;x.indexBuffer=y;x.idxFreeList=new m.FreeList(y.length);
x.idxFreeList.allocate(u);var u=void 0,z;for(z in v.vertexBuffer)v=c.tileBufferData.geometries[d].vertexBuffer[z],x.vertexBuffers[z].data=v.data,x.vertexBuffers[z].stride=v.stride,y=k.strideToPackingFactor(v.stride),v=v.data.length*y/v.stride,u||(u=v);x.vtxFreeList=new m.FreeList(u);x.vtxFreeList.allocate(q)}return b};a.prototype.delete=function(a){var b=g[a.geometryType];this._freeVertices(b,a.vertexFrom,a.vertexCount);this._freeIndices(b,a.indexFrom,a.indexCount);this._displayList.removeFromList(a);
a.vertexFrom=void 0;a.indexFrom=void 0};a.prototype.setMeshData=function(a,b,c,e,f){var d=g[a.geometryType];a.meshData=null;var h=void 0,l=void 0;void 0===a.vertexFrom?(l=b.vertexCount,h=this._allocateVertices(d,l)):b.vertexCount>a.vertexCount?(this._freeVertices(d,a.vertexFrom,a.vertexCount),l=b.vertexCount,h=this._allocateVertices(d,l)):b.vertexCount===a.vertexCount?(h=a.vertexFrom,l=a.vertexCount):(this._freeVertices(d,a.vertexFrom+b.vertexCount,a.vertexCount-b.vertexCount),h=a.vertexFrom,l=b.vertexCount);
var m=!0,n=void 0,p=void 0,z=void 0;void 0===a.indexFrom?(n=f,z=b.indexCount,p=this._allocateIndices(d,z)):b.indexCount>a.indexCount?(n=this._displayList.removeFromList(a),this._freeIndices(d,a.indexFrom,a.indexCount),z=b.indexCount,p=this._allocateIndices(d,z)):b.indexCount===a.indexCount?(m=!1,p=a.indexFrom,z=a.indexCount):(n=this._displayList.removeFromList(a),this._freeIndices(d,a.indexFrom+b.indexCount,a.indexCount-b.indexCount),p=a.indexFrom,z=b.indexCount);if(-1!==h&&-1!==p){f=this._storageFor(d);
k.copyMeshData(h,p,f.vertexBuffers,f.indexBuffer,b,c,e);a.vertexFrom=h;a.indexFrom=p;a.vertexCount=b.vertexCount;a.indexCount=b.indexCount;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(a.geometryType,a.indexFrom,a.indexCount);for(var A in c)this._dirtyMap.markDirtyVertices(a.geometryType,A,a.vertexFrom,a.vertexCount)}m&&this._displayList.addToList(a,n);return!0}-1!==h&&this._freeVertices(d,h,l);-1!==p&&this._freeIndices(d,p,z);a.setMeshDataFromBuffers(b,c,e);a.vertexFrom=void 0;a.vertexCount=
0;a.indexFrom=void 0;a.indexCount=0;return!1};a.prototype._allocateVertices=function(a,b){a=this._storageFor(a);b=a.vtxFreeList.allocate(b);return-1===b||.5<a.vtxFreeList.fragmentation?-1:b};a.prototype._freeVertices=function(a,b,c){this._storageFor(a).vtxFreeList.free(b,c)};a.prototype._freeIndices=function(a,b,c){this._storageFor(a).idxFreeList.free(b,c)};a.prototype._allocateIndices=function(a,b){a=this._storageFor(a);b=a.idxFreeList.allocate(b);return-1===b||.5<a.idxFreeList.fragmentation?-1:
b};a.prototype._storageFor=function(a){return this._freeListsAndStorage[a]};a.prototype._stridesFor=function(a,b){return this._strides[a][b]};return a}();a.default=f})},"esri/views/2d/engine/webgl/FreeList":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});var e=function(){function a(a){this._largestRange=null;this._parent=a;this._updateLargestRange()}Object.defineProperty(a.prototype,"largestRange",{get:function(){return this._largestRange},enumerable:!0,
configurable:!0});a.prototype.rangeCreated=function(a){if(!this._largestRange||a.count>this._largestRange.count)this._largestRange=a};a.prototype.rangeResized=function(a,e){if(a===this._largestRange)a.count<e&&this._updateLargestRange();else if(!this._largestRange||a.count>this._largestRange.count)this._largestRange=a};a.prototype.findBestRange=function(a){for(var e=this._parent._freeHead,f=null;null!==e;)e.count>=a&&(!f||e.count-a<f.count-a)&&(f=e),e=e.next;return f};a.prototype.findAdjacentRanges=
function(a,e){for(var f=!0,c=!1,h=null,b=this._parent._freeHead;f&&!c;){var d=null!==b?b.from:this._parent._size;a>=(null!==h?h.from+h.count:0)&&a+e<=d?(f=!1,c=!0):null!==b?(h=b,b=b.next):f=!1}return[h,b]};a.prototype._updateLargestRange=function(){for(var a=null,e=this._parent._freeHead;null!==e;){if(!a||e.count>a.count)a=e;e=e.next}this._largestRange=a};return a}();f=function(){function a(a,f){this._allocated=0;this._size=a;this._freeHead=0<a?{from:0,count:a,prev:null,next:null}:null;this._bookKeeper=
f||new e(this);this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}a.prototype.allocate=function(e){var f=this._bookKeeper.findBestRange(e);if(null===f)return-1;var g=f.from,c=f.count;f.from+=e;f.count-=e;this._bookKeeper.rangeResized(f,g,c);this._allocated+=e;0===f.count&&(e=null!==f.prev?this._freeHead:f.next,a._removeRange(f),this._freeHead=e);return g};a.prototype.free=function(e,f){var g=this._bookKeeper.findAdjacentRanges(e,f),c=g[0],g=g[1];e={from:e,count:f,prev:c,next:g};null!==
c&&(c.next=e);null!==g&&(g.prev=e);this._bookKeeper.rangeCreated(e);this._allocated-=f;if(null!==g&&e.from+e.count===g.from){f=e.from;var h=e.count;a._fuse(e,g);a._removeRange(g);this._bookKeeper.rangeResized(e,f,h);this._bookKeeper.rangeResized(g,void 0,0)}null!==c&&c.from+c.count===e.from&&(f=c.from,h=c.count,a._fuse(c,e),a._removeRange(e),this._bookKeeper.rangeResized(c,f,h),this._bookKeeper.rangeResized(e,void 0,0));this._freeHead=null!==e.prev?this._freeHead:e};Object.defineProperty(a.prototype,
"fragmentation",{get:function(){var a=this._size-this._allocated;return 0===a?0:1-this._bookKeeper.largestRange.count/a},enumerable:!0,configurable:!0});a._removeRange=function(a){null!==a.prev?null!==a.next?(a.prev.next=a.next,a.next.prev=a.prev):a.prev.next=null:null!==a.next&&(a.next.prev=null)};a._fuse=function(a,e){a.count+=e.count;a.next=e.next;e.from+=e.count;e.count=0;null!==e.next&&(e.next.prev=a)};return a}();a.FreeList=f})},"esri/views/2d/engine/webgl/Fader":function(){define(["require",
"exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(a){void 0===a&&(a=400);this.duration=a;this._value=this._elapsed=this._lastTime=0;this._finished=!1}Object.defineProperty(a.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0});a.prototype.reset=function(){this._value=this._elapsed=this._lastTime=0};a.prototype.step=function(){var a=performance.now();if(0===this._lastTime)return this._lastTime=a,this._value=0,!0;if(this._elapsed>=
this.duration)return!0;this._elapsed+=a-this._lastTime;this._lastTime=a;this._value=Math.min(this._elapsed/this.duration,1);return!1};return a}();a.default=f})},"esri/views/2d/engine/webgl/WGLBuffers":function(){define(["require","exports","../../../webgl","./Utils"],function(f,a,e,m){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(a){this.geometryMap=m.createGeometryData(function(){return{indexBuffer:e.BufferObject.createIndex(a,35044),vao:null}},function(f,c){return{vertexBuffer:e.BufferObject.createVertex(a,
m.C_VBO_INFO[c])}})}a.prototype.dispose=function(){for(var a=0;5>a;a++){var e=this.geometryMap[a];if(e){e.data.vao&&e.data.vao.dispose(!1);e.data.indexBuffer&&e.data.indexBuffer.dispose();for(var c in e.buffers)e.buffers[c]&&e.buffers[c].data.vertexBuffer.dispose()}}};a.prototype.get=function(a){var e=this.geometryMap[a];a={};for(var c in e.buffers)a[c]=e.buffers[c].data.vertexBuffer;return{indexBuffer:e.data.indexBuffer,get vao(){return e.data.vao},set vao(a){e.data.vao=a},vertexBufferMap:a}};a.prototype.has=
function(a){return null!=this.geometryMap[a]};a.prototype.upload=function(a,e){var c=this;e.forEach(function(e,b){c._upload(e,b,a)})};a.prototype._upload=function(a,e,c){a.indices&&(a.indices.allDirty?this._uploadIndices(c,e):null!=a.indices.from&&null!=a.indices.count&&this._uploadIndices(c,e,a.indices.from,a.indices.count));if(a.vertices){a=a.vertices;for(var f in a){var b=a[f];b.allDirty?this._uploadVertices(c,e,f):null!=b.from&&null!=b.count&&this._uploadVertices(c,e,f,b.from,b.count)}}};a.prototype._uploadVertices=
function(a,e,c,f,b){var d=this.geometryMap[e];d&&(e=a.geometries[e].vertexBuffer[c])&&(a=e.stride,e=e.data.buffer,d.buffers[c]&&0<e.byteLength&&(null!=f&&null!=b?d.buffers[c].data.vertexBuffer.setSubData(e,f*a,f*a,(f+b)*a):d.buffers[c].data.vertexBuffer.setData(e)))};a.prototype._uploadIndices=function(a,e,c,f){var b=this.geometryMap[e];b&&(a=a.geometries[e].indexBuffer.buffer,b.data.indexBuffer&&0<a.byteLength&&(null!=c&&null!=f?b.data.indexBuffer.setSubData(a,4*c,4*c,4*(c+f)):b.data.indexBuffer.setData(a)))};
return a}();a.default=f})},"esri/views/2d/engine/webgl/shaders/MagnifierPrograms":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(f,a,e,m){Object.defineProperty(a,"__esModule",{value:!0});a.magnifier={name:"magnifier",shaders:{vertexShader:m.resolveIncludes("magnifier/magnifier.vert"),fragmentShader:m.resolveIncludes("magnifier/magnifier.frag")},attributes:{a_pos:0}};a.createMagnifierProgram=function(f){return e.createProgram(f,a.magnifier)}})},"esri/views/2d/engine/BitmapTileContainer":function(){define("require exports tslib ../../../geometry/support/aaBoundingRect ../engine ./BitmapTile ./webgl/enums ./webgl/TileContainer".split(" "),
function(f,a,e,m,k,l,g,c){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e.__extends(b,a);b.prototype.createTile=function(a){var b=this._tileInfoView.getTileBounds(m.create(),a);return new l.BitmapTile(a,b,this._tileInfoView.tileInfo.size)};b.prototype.destroyTile=function(){};b.prototype.prepareRenderPasses=function(b){var c=this,d=b.registerRenderPass({name:"bitmap (tile)",brushes:[k.brushes.Bitmap],target:function(){return c.children.map(function(a){return a.bitmap})},
drawPhase:g.WGLDrawPhase.MAP});return e.__spreadArrays(a.prototype.prepareRenderPasses.call(this,b),[d])};b.prototype.doRender=function(b){this.visible&&b.drawPhase===g.WGLDrawPhase.MAP&&a.prototype.doRender.call(this,b)};return b}(c.default);a.BitmapTileContainer=f})},"esri/views/2d/engine/LevelDependentSizeVariable":function(){define("require exports tslib ../../../core/lang ../../../core/accessorSupport/decorators ../../../renderers/visualVariables/SizeVariable ../../../renderers/visualVariables/support/sizeVariableUtils".split(" "),
function(f,a,e,m,k,l,g){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}e.__extends(c,a);b=c;c.prototype.writeLevels=function(a,b,c){for(var d in a){b.stops=this.levels[d];break}};c.prototype.clone=function(){return new b({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:g.isSizeVariable(this.maxSize)?this.maxSize.clone():
this.maxSize,minDataValue:this.minDataValue,minSize:g.isSizeVariable(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(function(a){return a.clone()}),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:m.clone(this.levels)})};var b;e.__decorate([k.property()],c.prototype,"levels",void 0);
e.__decorate([k.writer("levels")],c.prototype,"writeLevels",null);return c=b=e.__decorate([k.subclass("esri.views.2d.engine.LevelDependentSizeVariable")],c)}(l);a.LevelDependentSizeVariable=f})},"esri/views/2d/layers/features/controllers/BaseController":function(){define("require exports tslib ../../../../../core/Error ../../../../../core/HandleOwner ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/decorators ../../../../../layers/graphics/data/attributeSupport ../../../../../layers/graphics/data/QueryEngine ../../../../../layers/support/FieldsIndex ../../../../../renderers/support/jsonUtils ../../../../../tasks/support/Query ../../../engine ../support/AttributeStore ../support/ClusterStore ../support/pixelBuffering".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u,v,y){function z(a){var b=a&&a.getSymbols();return"backgroundFillSymbol"in a&&null!=a.backgroundFillSymbol&&"outline"in a.backgroundFillSymbol&&null!=a.backgroundFillSymbol.outline||b.some(function(a){return"outline"in a&&null!=a.outline})}function A(a,b,c){function d(a){if(!a)return!1;a=a.type;return"simple-marker"===a||"picture-marker"===a||"text"===a||"web-style"===a||"cim"===a}if("esriGeometryPolygon"===b&&a.labelingInfo)return!0;if("esriGeometryPolygon"!==
b)return!1;switch(c.type){case "simple":return d(c.symbol);case "unique-value":return d(c.defaultSymbol)||c.uniqueValueInfos.some(function(a){return d(a.symbol)});case "class-breaks":return d(c.defaultSymbol)||c.classBreakInfos.some(function(a){return d(a.symbol)});case "dot-density":return!1;default:return!0}}Object.defineProperty(a,"__esModule",{value:!0});var B=g.getLogger("esri.views.2d.layers.features.controllers.BaseController");f=function(a){function f(){var b=null!==a&&a.apply(this,arguments)||
this;b._availableFields=[];b._pixelBuffer=0;b.config=null;b.filters=Array(x.definitions.MAX_FILTERS);b.processor=null;b.remoteClient=null;b.service=null;b.tileStore=null;return b}e.__extends(f,a);f.prototype.initialize=function(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))]);this._initAttributeStore()};f.prototype.startup=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(a){switch(a.label){case 0:return this._initAttributeStore(),
[4,this.attributeStore.setAttributeBindings(this.renderer,this.arcadeInfo)];case 1:return a.sent(),[4,h.all([this.attributeStore.updateFilters(this),this.updatePixelBuffer()])];case 2:return a.sent(),[2]}})})};f.prototype.destroy=function(){this.attributeStore&&this.attributeStore.destroy()};Object.defineProperty(f.prototype,"arcadeInfo",{get:function(){return{geometryType:this.service.geometryType,fields:this.service.fields,spatialReference:this.spatialReference}},enumerable:!0,configurable:!0});
Object.defineProperty(f.prototype,"featureReduction",{get:function(){return this.config.featureReduction},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"fieldsIndex",{get:function(){return new p(this.service.fields)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"geometryInfo",{get:function(){return{geometryType:this.service.geometryType,hasZ:!1,hasM:!1}},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"returnCentroid",{get:function(){return this._get("returnCentroid")||
A(this.config,this.service.geometryType,this.renderer)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"returnOutline",{get:function(){var a;a:{switch(this.service.geometryType){case "esriGeometryPoint":case "esriGeometryPolyline":case "esriGeometryMultipoint":a=!0;break a;case "esriGeometryPolygon":a=z(this.renderer);break a}a=void 0}return a},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"queryInfo",{get:function(){return{returnCentroid:this.returnCentroid,
returnGeometry:!0,outFields:this.availableFields,definitionExpression:this.config.definitionExpression,gdbVersion:this.config.gdbVersion,historicMoment:this.config.historicMoment}},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"renderer",{get:function(){return this.config?r.fromJSON(this.config.renderer):(B.error("mapview-controller","Unable to create renderer for undefined configuration"),null)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"availableFields",
{get:function(){var a=this,b=this.config.availableFields.filter(function(b){return-1===a._availableFields.indexOf(b)});return this._availableFields=e.__spreadArrays(this._availableFields,b)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"spatialReference",{get:function(){return this.tileStore.tileScheme.spatialReference},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"viewParams",{get:function(){return{viewingMode:"",scale:this.viewState&&this.viewState.scale||
1}},enumerable:!0,configurable:!0});f.prototype.getObjectId=function(a){return this.attributeStore.getFeatureId(a)};f.prototype.getAggregate=function(a){return null};f.prototype.getAggregateValueRanges=function(){return{}};f.prototype.getLocalId=function(a){return this.attributeStore.getLocalId(a)};f.prototype.mapValidLocalIds=function(a){var b=this;return a.map(function(a){return b.attributeStore.getLocalId(a)}).filter(function(a){return null!=a})};f.prototype.setViewState=function(a){this._set("viewState",
a)};f.prototype.updatePixelBuffer=function(){return e.__awaiter(this,void 0,void 0,function(){var a;return e.__generator(this,function(b){switch(b.label){case 0:return[4,y.computePxBuffer(this.renderer,this.service.geometryType)];case 1:return a=b.sent(),this._pixelBuffer=Math.max(this._pixelBuffer,a),[2]}})})};f.prototype.setHighlight=function(a){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(b){return[2,this.attributeStore.setHighlight(a)]})})};f.prototype.validateConfig=
function(a){var b=0;for(a=a.filters;b<a.length;b++){var e=a[b];if(c.isSome(e)&&e.where)try{d.validateWhere(this.fieldsIndex,e.where)}catch(J){throw new m("mapview-bad-filter",J.message,{filter:e,missingFields:J.details});}}};f.prototype.onFeatureAdd=function(a){a.localId=this.attributeStore.createLocalId(a.objectId);this.attributeStore.setAttributeData(a.localId,a,this.geometryInfo,this.viewParams)};f.prototype.onFeatureRemove=function(a){this.attributeStore.freeLocalId(a.objectId)};f.prototype.enableEvent=
function(a){};f.prototype._initAttributeStore=function(){var a=this;this.attributeStore?this.attributeStore.invalidateResources():this.attributeStore=new u.default({type:"remote",initialize:function(b,c){return a.remoteClient.invoke("tileRenderer.featuresView.attributeView.initialize",b,{signal:c})},update:function(b,c){return a.remoteClient.invoke("tileRenderer.featuresView.attributeView.requestUpdate",b,{signal:c})},render:function(){return a.remoteClient.invoke("tileRenderer.featuresView.requestRender")}})};
f.prototype._createQueryEngine=function(a){return new n.default({definitionExpression:this.config.definitionExpression,fields:this.service.fields,geometryType:this.service.geometryType,objectIdField:this.service.objectIdField,hasM:!1,hasZ:!1,spatialReference:this.spatialReference.toJSON(),cacheSpatialQueries:!0,featureStore:a,timeInfo:this.service.timeInfo})};f.prototype._createTempQueryEngine=function(a){void 0===a&&(a=this._createFeatureStore());return this._createQueryEngine(a)};f.prototype._createFeatureStore=
function(){return new v.ClusterStore({geometryType:this.service.geometryType,hasM:!1,hasZ:!1},this.spatialReference,this.attributeStore,this.featureReduction)};f.prototype._createDefaultQuery=function(a){var b=new q,c=a.outFields,d=this.config,e=d.gdbVersion,f=d.historicMoment,d=d.definitionExpression,c=.75<=c.length/this.service.fields.length?["*"]:c;b.gdbVersion=e;b.historicMoment=null!=f?new Date(f):null;b.num=a.num;b.outFields=c;b.outSpatialReference=this.spatialReference;b.returnGeometry=a.returnGeometry;
b.returnCentroid=a.returnCentroid;b.start=a.resultOffset;b.where=d||"1\x3d1";return b};f.prototype.hasGeometryFilter=function(){return this.filters.some(function(a){return c.isSome(a)&&!!a.geometry})};e.__decorate([b.property({readOnly:!0,dependsOn:["config","service","spatialReference"]})],f.prototype,"arcadeInfo",null);e.__decorate([b.property()],f.prototype,"config",void 0);e.__decorate([b.property({readOnly:!0,dependsOn:["config"]})],f.prototype,"featureReduction",null);e.__decorate([b.property({readOnly:!0,
dependsOn:["service"]})],f.prototype,"fieldsIndex",null);e.__decorate([b.property()],f.prototype,"filters",void 0);e.__decorate([b.property({readOnly:!0,dependsOn:["service"]})],f.prototype,"geometryInfo",null);e.__decorate([b.property({readOnly:!0,dependsOn:["config"]})],f.prototype,"returnCentroid",null);e.__decorate([b.property({readOnly:!0,dependsOn:["service","config"]})],f.prototype,"returnOutline",null);e.__decorate([b.property({readOnly:!0,dependsOn:["config","availableFields"]})],f.prototype,
"queryInfo",null);e.__decorate([b.property({dependsOn:["config"],readOnly:!0})],f.prototype,"renderer",null);e.__decorate([b.property()],f.prototype,"processor",void 0);e.__decorate([b.property({readOnly:!0,dependsOn:["config"]})],f.prototype,"availableFields",null);e.__decorate([b.property({constructOnly:!0})],f.prototype,"remoteClient",void 0);e.__decorate([b.property({constructOnly:!0})],f.prototype,"service",void 0);e.__decorate([b.property({dependsOn:["tileStore"]})],f.prototype,"spatialReference",
null);e.__decorate([b.property({constructOnly:!0})],f.prototype,"tileInfo",void 0);e.__decorate([b.property({constructOnly:!0})],f.prototype,"tileStore",void 0);e.__decorate([b.property({readOnly:!0})],f.prototype,"viewState",void 0);e.__decorate([b.property({readOnly:!0,dependsOn:["viewState"]})],f.prototype,"viewParams",null);return f=e.__decorate([b.subclass("esri.views.2d.layers.features.controllers.BaseController")],f)}(k.HandleOwner);a.default=f})},"esri/core/HandleOwner":function(){define("require exports tslib ./Accessor ./Handles ./accessorSupport/decorators ../views/support/WatchUpdatingTracking".split(" "),
function(f,a,e,m,k,l,g){Object.defineProperty(a,"__esModule",{value:!0});a.HandleOwnerMixin=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e.__extends(b,a);b.prototype.destroy=function(){this.destroyed||(this.handles.destroy(),this.updatingHandles.destroy())};Object.defineProperty(b.prototype,"handles",{get:function(){return this._get("handles")||new k},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"updatingHandles",{get:function(){return this._get("updatingHandles")||
new g.WatchUpdatingTracking},enumerable:!0,configurable:!0});e.__decorate([l.property({readOnly:!0})],b.prototype,"handles",null);e.__decorate([l.property({readOnly:!0})],b.prototype,"updatingHandles",null);return b=e.__decorate([l.subclass("esri.core.HandleOwner")],b)}(a)};f=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}e.__extends(c,a);return c=e.__decorate([l.subclass("esri.core.HandleOwner")],c)}(a.HandleOwnerMixin(m));a.HandleOwner=f})},"esri/core/Handles":function(){define("require exports tslib ./Accessor ./Collection ./accessorSupport/decorators".split(" "),
function(f,a,e,m,k,l){return function(a){function c(c){c=a.call(this,c)||this;c._groups=new Map;return c}e.__extends(c,a);c.prototype.destroy=function(){this.removeAll()};Object.defineProperty(c.prototype,"size",{get:function(){var a=0;this._groups.forEach(function(b){a+=b.length});return a},enumerable:!0,configurable:!0});c.prototype.add=function(a,b){var c=this;if(!this._isHandle(a)&&!Array.isArray(a)&&!k.isCollection(a))return this;var e=this._getOrCreateGroup(b);Array.isArray(a)||k.isCollection(a)?
a.forEach(function(a){return c._isHandle(a)&&e.push(a)}):e.push(a);this.notifyChange("size");return this};c.prototype.forEach=function(a,b){if("function"===typeof a)this._groups.forEach(function(b){return b.forEach(a)});else{var c=this._getGroup(a);c&&c.forEach(b)}};c.prototype.has=function(a){return this._groups.has(this._ensureGroupKey(a))};c.prototype.remove=function(a){if(Array.isArray(a)||k.isCollection(a))return a.forEach(this.remove,this),this;if(!this.has(a))return this;for(var b=this._getGroup(a),
c=0;c<b.length;c++)b[c].remove();this._deleteGroup(a);this.notifyChange("size");return this};c.prototype.removeAll=function(){this._groups.forEach(function(a){for(var b=0;b<a.length;b++)a[b].remove()});this._groups.clear();this.notifyChange("size");return this};c.prototype._isHandle=function(a){return a&&!!a.remove};c.prototype._getOrCreateGroup=function(a){if(this.has(a))return this._getGroup(a);var b=[];this._groups.set(this._ensureGroupKey(a),b);return b};c.prototype._getGroup=function(a){return this._groups.get(this._ensureGroupKey(a))};
c.prototype._deleteGroup=function(a){return this._groups.delete(this._ensureGroupKey(a))};c.prototype._ensureGroupKey=function(a){return a||"_default_"};e.__decorate([l.property({readOnly:!0})],c.prototype,"size",null);return c=e.__decorate([l.subclass("esri.core.Handles")],c)}(m)})},"esri/views/support/WatchUpdatingTracking":function(){define("require exports tslib ../../core/Accessor ../../core/Handles ../../core/scheduling ../../core/watchUtils ../../core/accessorSupport/decorators ../../core/accessorSupport/wire".split(" "),
function(f,a,e,m,k,l,g,c,h){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b.updating=!1;b.handleId=0;b.handles=new k;b.scheduleHandleId=0;b.pendingPromises=new Set;return b}e.__extends(d,a);d.prototype.destroy=function(){this.removeAll();this.handles.destroy()};d.prototype.add=function(a,b,c,d){var e=this;void 0===d&&(d=0);var f=0!==(d&1),h=++this.handleId;f||this.installSyncUpdatingWatch(a,b,h);a=0!==(d&2)?g.init(a,b,c,f):
a.watch(b,c,f);this.handles.add(a,h);return{remove:function(){e.handles.remove(h)}}};d.prototype.addOnCollectionPropertyChange=function(a,b,c,d){var e=this;void 0===d&&(d=0);d=0!==(d&2);var f=++this.handleId;this.handles.add([g.on(a,b,"after-changes",this.createSyncUpdatingCallback()),g.on(a,b,"change",c,d?function(a){c({added:a.items,removed:[],moved:[],target:a})}:null)],f);return{remove:function(){e.handles.remove(f)}}};d.prototype.addOnCollectionChange=function(a,b,c){var d=this;void 0===c&&(c=
0);c=0!==(c&2);var e=++this.handleId;this.handles.add([a.on("after-changes",this.createSyncUpdatingCallback()),a.on("change",b)],e);c&&b({added:a.items,removed:[],moved:[],target:a});return{remove:function(){d.handles.remove(e)}}};d.prototype.addPromise=function(a){var c=this;if(!a)return a;var d=++this.handleId;this.handles.add({remove:function(){c.pendingPromises.delete(a)&&(0!==c.pendingPromises.size||c.handles.has(b)||c._set("updating",!1))}},d);this.pendingPromises.add(a);this._set("updating",
!0);var e=function(){return c.handles.remove(d)};a.then(e,e);return a};d.prototype.removeAll=function(){this.pendingPromises.clear();this.handles.removeAll();this._set("updating",!1)};d.prototype.installSyncUpdatingWatch=function(a,b,c){a=h.default(a,b,this.createSyncUpdatingCallback());this.handles.add(a,c);return a};d.prototype.createSyncUpdatingCallback=function(){var a=this;return function(){a.handles.remove(b);++a.scheduleHandleId;var c=a.scheduleHandleId;a._get("updating")||a._set("updating",
!0);a.handles.add(l.schedule(function(){c===a.scheduleHandleId&&(a._set("updating",0<a.pendingPromises.size),a.handles.remove(b))}),b)}};e.__decorate([c.property({readOnly:!0})],d.prototype,"updating",void 0);return d=e.__decorate([c.subclass("esri.views.support.WatchUpdatingTracking")],d)}(m);a.WatchUpdatingTracking=f;var b=-42})},"esri/layers/graphics/data/attributeSupport":function(){define(["require","exports","../../../core/Error","../../../core/SetUtils","../../../core/sql/WhereClauseCache"],
function(f,a,e,m,k){function l(a,b){return a?h.get(a,b):null}function g(a,b,f,h){void 0===h&&(h=!0);for(var d=[],k=0;k<b.length;k++){var m=b[k];if("*"!==m&&!a.has(m))if(h){var n=c(m);try{var p=l(n,a);if(!p)throw new e("feature-store:unsupported-query","invalid SQL expression",{where:n});if(!p.isStandardized)throw new e("feature-store:unsupported-query","expression is not standard",{clause:p});g(a,p.fieldNames,"expression contains missing fields")}catch(z){if((n=z&&z.details)&&(n.clause||n.where))throw z;
n&&n.missingFields?d.push.apply(d,n.missingFields):d.push(m)}}else d.push(m)}if(d.length)throw new e("feature-store:unsupported-query",f,{missingFields:d});}function c(a){return a.split(" as ")[0]}Object.defineProperty(a,"__esModule",{value:!0});var h=new k.WhereClauseCache(50,500),b=m.SetFromValues("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));a.validateWhere=function(a,b){if(!b)return!0;var c=
h.get(b,a);if(!c)throw new e("feature-store:unsupported-query","invalid SQL expression",{where:b});if(!c.isStandardized)throw new e("feature-store:unsupported-query","where clause is not standard",{where:b});g(a,c.fieldNames,"where clause contains missing fields");return!0};a.validateHaving=function(a,b,c){if(!b)return!0;var d=h.get(b,a);if(!d)throw new e("feature-store:unsupported-query","invalid SQL expression",{having:b});if(!d.isAggregate)throw new e("feature-store:unsupported-query","having does not contain a valid aggregate function",
{having:b});g(a,d.fieldNames,"having contains missing fields");if(!d.getExpressions().every(function(b){var d=b.aggregateType;b=b.field;var e=a.has(b)&&a.get(b).name;return c.some(function(b){var c=b.onStatisticField;b=b.statisticType;return(a.has(c)&&a.get(c).name)===e&&b.toLowerCase().trim()===d})}))throw new e("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:b});return!0};a.getWhereClause=l;a.validateFields=g;a.getExpressionFromFieldName=c;a.getAliasFromFieldName=
function(a){return a.split(" as ")[1]};a.hasInvalidFieldType=function(a,c){return(a=c.get(a))?!b.has(a.type):!1}})},"esri/core/sql/WhereClauseCache":function(){define(["require","exports","../ItemCache","./WhereClause"],function(f,a,e,m){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(a,f){this._cache=new e(a);this._invalidCache=new e(f)}a.prototype.get=function(a,e){var c=e.uid+":"+a,f=this._cache.get(c);if(f)return f;if(void 0!==this._invalidCache.get(c))return null;try{var b=
m.WhereClause.create(a,e);this._cache.put(c,b);return b}catch(d){return this._invalidCache.put(c,null),null}};return a}();a.WhereClauseCache=f})},"esri/core/ItemCache":function(){define(["require","exports","./MemCache"],function(f,a,e){return function(){function a(a,f){this._storage=new e.MemCacheStorage;this._storage.maxSize=a;f&&this._storage.registerRemoveFunc("",f)}a.prototype.put=function(a,e){this._storage.put(a,e,1,1)};a.prototype.pop=function(a){return this._storage.pop(a)};a.prototype.get=
function(a){return this._storage.get(a)};a.prototype.clear=function(){this._storage.clearAll()};a.prototype.destroy=function(){this._storage.clearAll()};return a}()})},"esri/core/sql/WhereClause":function(){define("require exports ../has ../MapUtils ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),function(f,a,e,m,k,l,g){function c(a,b){a+="";return a.length>=b?a:Array(b-a.length+1).join("0")+a}function h(a,b,d,e,f,g,h,k,l){void 0===d&&(d="0");void 0===e&&(e="0");void 0===f&&
(f="0");void 0===g&&(g="0");void 0===h&&(h="");void 0===k&&(k="0");void 0===l&&(l="0");return"+"===h||"-"===h?(a=c(parseInt(a,10),4)+"-"+c(parseInt(b,10),2)+"-"+c(parseInt(d,10),2),b="",10>parseFloat(g)&&(b="0"),e=c(parseInt(e,10),2)+":"+c(parseInt(f,10),2)+":"+(b+parseFloat(g).toString()),h=""+h+c(parseInt(k,10),2)+":"+c(parseInt(l,10),2),new Date(a+"T"+e+h)):new Date(parseInt(a,10),parseInt(b,10)-1,parseInt(d,10),parseInt(e,10),parseInt(f,10),parseFloat(g))}function b(a){var b=C.exec(a);if(null!==
b){a=b[1];var c=b[2],d=b[3],e=b[4],f=b[5],g=b[6];return h(a,c,d,e,f,g)}b=E.exec(a);if(null!==b){a=b[1];var c=b[2],d=b[3],e=b[4],f=b[5],g=b[6],k=b[7],l=b[8],b=b[9];return h(a,c,d,e,f,g,k,l,b)}b=F.exec(a);if(null!==b)return a=b[1],c=b[2],d=b[3],e=b[4],f=b[5],k=b[6],l=b[7],b=b[8],h(a,c,d,e,f,"0",k,l,b);b=I.exec(a);if(null!==b)return a=b[1],c=b[2],d=b[3],e=b[4],f=b[5],h(a,c,d,e,f);b=D.exec(a);if(null!==b)return a=b[1],c=b[2],d=b[3],h(a,c,d);throw Error("SQL Invalid Timestamp");}function d(a){a=D.exec(a);
if(null===a)throw Error("SQL Invalid Date");var b=a[2],c=a[3];return new Date(parseInt(a[1],10),parseInt(b,10)-1,parseInt(c,10))}function n(a){return Array.isArray(a)?a:[a]}function p(a){return null!==a?!0!==a:null}function r(a,b){return null!=a&&null!=b?!0===a&&!0===b:!1===a||!1===b?!1:null}function q(a,b){return null!=a&&null!=b?!0===a||!0===b:!0===a||!0===b?!0:null}function x(a,b){if(null==a)return null;for(var c=!1,d=0;d<b.length;d++){var e=b[d];if(null==e)c=null;else if(a===e){c=!0;break}}return c}
function u(a,b,c){if(null==a)return null;for(var d="",e=0,f=0;f<b.length;f++){var g=b.charAt(f);switch(e){case 0:g===c?e=1:d=0<="-[]/{}()*+?.\\^$|".indexOf(g)?d+("\\"+g):"%"===g?d+".*":"_"===g?d+".":d+g;break;case 1:d=0<="-[]/{}()*+?.\\^$|".indexOf(g)?d+("\\"+g):d+g,e=0}}return(new RegExp("^"+d+"$")).test(a)}function v(a){return a instanceof Date?a.valueOf():a}function y(a,b,c){if(null==b||null==c)return null;b=v(b);c=v(c);switch(a){case "\x3c\x3e":return b!==c;case "\x3d":return b===c;case "\x3e":return b>
c;case "\x3c":return b<c;case "\x3e\x3d":return b>=c;case "\x3c\x3d":return b<=c}}function z(a){for(var b=[],c={},d=0;d<a.length;d++){var e=a[d],f=e.toLowerCase();void 0===c[f]&&(b.push(e),c[f]=1)}return b}function A(a,b,c){if(b instanceof l.SqlInterval)if(c instanceof Date)switch(a){case "+":return new Date(b.valueInMilliseconds()+c.getTime());case "-":return b.valueInMilliseconds()-c.getTime();case "*":return b.valueInMilliseconds()*c.getTime();case "/":return b.valueInMilliseconds()/c.getTime()}else if(c instanceof
l.SqlInterval)switch(a){case "+":return l.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()+c.valueInMilliseconds());case "-":return l.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()-c.valueInMilliseconds());case "*":return b.valueInMilliseconds()*c.valueInMilliseconds();case "/":return b.valueInMilliseconds()/c.valueInMilliseconds()}else b=b.valueInMilliseconds();else if(c instanceof l.SqlInterval)if(b instanceof Date)switch(a){case "+":return new Date(c.valueInMilliseconds()+
b.getTime());case "-":return new Date(b.getTime()-c.valueInMilliseconds());case "*":return b.getTime()*c.valueInMilliseconds();case "/":return b.getTime()/c.valueInMilliseconds()}else c=c.valueInMilliseconds();else if(b instanceof Date&&"number"===typeof c)switch(c*=864E5,b=b.getTime(),a){case "+":return new Date(b+c);case "-":return new Date(b-c);case "*":return new Date(b*c);case "/":return new Date(b/c)}else if(c instanceof Date&&"number"===typeof b)switch(b*=864E5,c=c.getTime(),a){case "+":return new Date(b+
c);case "-":return new Date(b-c);case "*":return new Date(b*c);case "/":return new Date(b/c)}switch(a){case "+":return b+c;case "-":return b-c;case "*":return b*c;case "/":return b/c}}function B(a,b,c,d){a=d.getAttribute(a,b);return null!=a&&1===c[b]?new Date(a):a}Object.defineProperty(a,"__esModule",{value:!0});var D=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,C=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,E=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,
F=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,I=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,J=function(){function a(){}a.makeBool=function(a){return!0===a};a.featureValue=function(a,b,c,d){return B(a,b,c,d)};a.equalsNull=function(a){return null===a};a.applyLike=function(a,b,c){return u(a,b,c)};a.ensureArray=function(a){return n(a)};a.applyIn=function(a,b){return x(a,b)};a.currentDate=function(){var a=new Date;a.setHours(0,0,0,0);return a};a.makeSqlInterval=
function(a,b,c){return l.SqlInterval.createFromValueAndQualifer(a,b,c)};a.convertInterval=function(a){return a instanceof l.SqlInterval?a.valueInMilliseconds():a};a.currentTimestamp=function(){return new Date};a.compare=function(a,b,c){return y(a,b,c)};a.calculate=function(a,b,c){return A(a,b,c)};a.makeComparable=function(a){return v(a)};a.evaluateFunction=function(a,b){return l.evaluateFunction(a,b)};a.lookup=function(a,b){a=b[a];return void 0===a?null:a};a.between=function(a,b){return null==a||
null==b[0]||null==b[1]?null:a>=b[0]&&a<=b[1]};a.notbetween=function(a,b){return null==a||null==b[0]||null==b[1]?null:a<b[0]||a>b[1]};a.ternaryNot=function(a){return p(a)};a.ternaryAnd=function(a,b){return r(a,b)};a.ternaryOr=function(a,b){return q(a,b)};return a}();f=function(){function c(a,b){this.fieldsIndex=b;this.datefields={};this.parameters={};this.parseTree=g.WhereGrammar.parse(a);a=this.extractExpressionInfo(b);b=a.isStandardized;var c=a.isAggregate;this.referencedFieldNames=a.referencedFieldNames;
this.isStandardized=b;this.isAggregate=c}c.create=function(a,b){return new c(a,b)};Object.defineProperty(c.prototype,"fieldNames",{get:function(){return this.referencedFieldNames},enumerable:!0,configurable:!0});c.prototype.testSet=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);for(var d={},e=function(a){d[a]=b.map(function(b){return c.getAttribute(b,a)})},f=0,g=this.fieldNames;f<g.length;f++)e(g[f]);return!!this.evaluateNode(this.parseTree,{attributes:d},a.defaultAttributeAdapter)};c.prototype.calculateValue=
function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);b=this.evaluateNode(this.parseTree,b,c);return b instanceof l.SqlInterval?b.valueInMilliseconds()/864E5:b};c.prototype.calculateValueCompiled=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(b,this.parameters,c,this.datefields);if(e("csp-restrictions"))return this.calculateValue(b,c);this.compileMe();return this.parseTree._compiledVersion(b,this.parameters,
c,this.datefields)};c.prototype.testFeature=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);return!!this.evaluateNode(this.parseTree,b,c)};c.prototype.testFeatureCompiled=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(b,this.parameters,c,this.datefields);if(e("csp-restrictions"))return this.testFeature(b,c);this.compileMe();return!!this.parseTree._compiledVersion(b,this.parameters,c,this.datefields)};
c.prototype.getFunctions=function(){var a=[];this.visitAll(this.parseTree,function(b){"function"===b.type&&a.push(b.name.toLowerCase())});return z(a)};c.prototype.getExpressions=function(){var a=new Map;this.visitAll(this.parseTree,function(b){if("function"===b.type){var c=b.name.toLowerCase();b=b.args.value[0];if("column_ref"===b.type){b=b.column;var d=c+"-"+b;a.has(d)||a.set(d,{aggregateType:c,field:b})}}});return m.valuesOfMap(a)};c.prototype.getVariables=function(){var a=[];this.visitAll(this.parseTree,
function(b){"param"===b.type&&a.push(b.value.toLowerCase())});return z(a)};c.prototype.compileMe=function(){var a="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",a)).bind(J)};c.prototype.extractExpressionInfo=function(a){var b=this,c=[],d=!0,e=!0;this.visitAll(this.parseTree,function(f){switch(f.type){case "column_ref":var g=a.get(f.column),h=g&&g.name;!g||"date"!==g.type&&
"esriFieldTypeDate"!==g.type||(b.datefields[g.name]=1);void 0!==h?(c.push(h),f.column=h):c.push(f.column);break;case "function":g=f.name,f=f.args.value.length,d&&(d=l.isStandardized(g,f)),e&&(e=k.isAggregate(g,f))}});return{referencedFieldNames:z(c),isStandardized:d,isAggregate:e}};c.prototype.visitAll=function(a,b){if(null!=a)switch(b(a),a.type){case "when_clause":this.visitAll(a.operand,b);this.visitAll(a.value,b);break;case "case_expression":for(var c=0,d=a.clauses;c<d.length;c++){var e=d[c];this.visitAll(e,
b)}"simple"===a.format&&this.visitAll(a.operand,b);null!==a.else&&this.visitAll(a.else,b);break;case "expr_list":c=0;for(a=a.value;c<a.length;c++)e=a[c],this.visitAll(e,b);break;case "unary_expr":this.visitAll(a.expr,b);break;case "binary_expr":this.visitAll(a.left,b);this.visitAll(a.right,b);break;case "function":this.visitAll(a.args,b)}};c.prototype.evaluateNodeToJavaScript=function(a){switch(a.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(a.value)+", "+JSON.stringify(a.qualifier)+
","+JSON.stringify(a.op)+")";case "case_expression":var c="";if("simple"===a.format)for(var e="this.makeComparable("+this.evaluateNodeToJavaScript(a.operand)+")",c="( ",f=0;f<a.clauses.length;f++)c+=" ("+e+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(a.clauses[f].operand)+")) ? ("+this.evaluateNodeToJavaScript(a.clauses[f].value)+") : ";else for(c="( ",f=0;f<a.clauses.length;f++)c+=" this.makeBool("+this.evaluateNodeToJavaScript(a.clauses[f].operand)+")\x3d\x3d\x3dtrue ? ("+
this.evaluateNodeToJavaScript(a.clauses[f].value)+") : ";c=null!==a.else?c+this.evaluateNodeToJavaScript(a.else):c+"null";return c+" )";case "param":return"this.lookup("+JSON.stringify(a.value.toLowerCase())+",lookups)";case "expr_list":c="[";e=0;for(a=a.value;e<a.length;e++)f=a[e],"["!==c&&(c+=","),c+=this.evaluateNodeToJavaScript(f);return c+"]";case "unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(a.expr)+")";case "binary_expr":switch(a.operator){case "AND":return"this.ternaryAnd("+
this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")";case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")))";case "IN":return"this.applyIn("+
this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+
")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+
this.evaluateNodeToJavaScript(a.right)+")";case "*":case "-":case "+":case "/":return"this.calculate("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")"}throw Error("Not Supported Operator "+a.operator);case "null":case "bool":case "string":case "number":return JSON.stringify(a.value);case "date":return"(new Date("+d(a.value).getTime().toString()+"))";case "timestamp":return"(new Date("+b(a.value).getTime().toString()+"))";case "current_time":return"date"===
a.mode?"this.currentDate()":"this.currentTimestamp()";case "column_ref":return"this.featureValue(feature,"+JSON.stringify(a.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(a.name)+","+this.evaluateNodeToJavaScript(a.args)+")"}throw Error("Unsupported sql syntax "+a.type);};c.prototype.evaluateNode=function(a,c,e){switch(a.type){case "interval":return c=this.evaluateNode(a.value,c,e),l.SqlInterval.createFromValueAndQualifer(c,a.qualifier,a.op);
case "case_expression":if("simple"===a.format)for(var f=v(this.evaluateNode(a.operand,c,e)),g=0;g<a.clauses.length;g++){if(f===v(this.evaluateNode(a.clauses[g].operand,c,e)))return this.evaluateNode(a.clauses[g].value,c,e)}else for(g=0;g<a.clauses.length;g++)if(!0===this.evaluateNode(a.clauses[g].operand,c,e))return this.evaluateNode(a.clauses[g].value,c,e);return null!==a.else?this.evaluateNode(a.else,c,e):null;case "param":return this.parameters[a.value.toLowerCase()];case "expr_list":f=[];g=0;
for(a=a.value;g<a.length;g++)f.push(this.evaluateNode(a[g],c,e));return f;case "unary_expr":return p(this.evaluateNode(a.expr,c,e));case "binary_expr":switch(a.operator){case "AND":return r(this.evaluateNode(a.left,c,e),this.evaluateNode(a.right,c,e));case "OR":return q(this.evaluateNode(a.left,c,e),this.evaluateNode(a.right,c,e));case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(a.left,c,e);case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");
return null!==this.evaluateNode(a.left,c,e);case "IN":return f=n(this.evaluateNode(a.right,c,e)),x(this.evaluateNode(a.left,c,e),f);case "NOT IN":return f=n(this.evaluateNode(a.right,c,e)),p(x(this.evaluateNode(a.left,c,e),f));case "BETWEEN":return f=this.evaluateNode(a.left,c,e),a=this.evaluateNode(a.right,c,e),null==f||null==a[0]||null==a[1]?null:f>=v(a[0])&&f<=v(a[1]);case "NOTBETWEEN":return f=this.evaluateNode(a.left,c,e),a=this.evaluateNode(a.right,c,e),null==f||null==a[0]||null==a[1]?null:
f<v(a[0])||f>v(a[1]);case "LIKE":return u(this.evaluateNode(a.left,c,e),this.evaluateNode(a.right,c,e),a.escape);case "NOT LIKE":return p(u(this.evaluateNode(a.left,c,e),this.evaluateNode(a.right,c,e),a.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return y(a.operator,this.evaluateNode(a.left,c,e),this.evaluateNode(a.right,c,e));case "-":case "+":case "*":case "/":return A(a.operator,this.evaluateNode(a.left,c,e),this.evaluateNode(a.right,c,e))}case "null":case "bool":case "string":case "number":return a.value;
case "date":return d(a.value);case "timestamp":return b(a.value);case "current_time":return c=new Date,"date"===a.mode&&c.setHours(0,0,0,0),c;case "column_ref":return B(c,a.column,this.datefields,e);case "function":return c=this.evaluateNode(a.args,c,e),this.isAggregate?k.aggregateFunction(a.name,c):l.evaluateFunction(a.name,c)}throw Error("Unsupported sql syntax "+a.type);};return c}();a.WhereClause=f;a.defaultAttributeAdapter={getAttribute:function(a,b){return(a&&"object"===typeof a.attributes?
a.attributes:a)[b]}}})},"esri/core/sql/AggregateFunctions":function(){define(["require","exports"],function(f,a){function e(a){for(var e=0,c=0;c<a.length;c++)e+=a[c];return e/a.length}function m(a){for(var f=e(a),c=a.length,h=0,b=0;b<a.length;b++)h+=Math.pow(a[b]-f,2);return 1<c?h/(c-1):0}Object.defineProperty(a,"__esModule",{value:!0});a.aggregateFunction=function(a,e){var c=k[a.toLowerCase()];if(null==c)throw Error("Function Not Recognised");if(e.length<c.minParams||e.length>c.maxParams)throw Error("Invalid Parameter count for call to "+
a.toUpperCase());return c.evaluate(e)};a.isAggregate=function(a,e){a=k[a.toLowerCase()];return null!=a&&e>=a.minParams&&e<=a.maxParams};var k={min:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.min.apply(Math,a[0])}},max:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.max.apply(Math,a[0])}},avg:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:e(a[0])}},sum:{minParams:1,maxParams:1,evaluate:function(a){if(null==a[0])a=null;else{a=
a[0];for(var e=0,c=0;c<a.length;c++)e+=a[c];a=e}return a}},stddev:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sqrt(m(a[0]))}},count:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].length}},var:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:m(a[0])}}}})},"esri/core/sql/StandardizedFunctions":function(){define(["require","exports","../string"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){this.op=
"+";this.minute=this.year=this.month=this.hour=this.second=this.day=0}a.fixDefaults=function(a){if(null!==a.precision||null!==a.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};a.createFromMilliseconds=function(e){var f=new a;f.second=e/1E3;return f};a.createFromValueAndQualifer=function(e,f,c){var g=null,b=new a;b.op="-"===c?"-":"+";if("interval-period"===f.type){a.fixDefaults(f);if("year"===f.period||"month"===f.period)throw Error("Year-Month Intervals not supported");
if(/^[0-9]{1,}$/.test(e))b[f.period]=parseFloat(e);else throw Error("Illegal Interval");}else{a.fixDefaults(f.start);a.fixDefaults(f.end);if("year"===f.start.period||"month"===f.start.period)throw Error("Year-Month Intervals not supported");if("year"===f.end.period||"month"===f.end.period)throw Error("Year-Month Intervals not supported");switch(f.start.period){case "day":switch(f.end.period){case "hour":g=/^[0-9]{1,} [0-9]{1,}$/;if(g.test(e))b[f.start.period]=parseFloat(e.split(" ")[0]),b[f.end.period]=
parseFloat(e.split(" ")[1]);else throw Error("Illegal Interval");break;case "minute":g=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$/;if(g.test(e))b[f.start.period]=parseFloat(e.split(" ")[0]),e=e.split(" ")[1].split(":"),b.hour=parseFloat(e[0]),b.minute=parseFloat(e[1]);else throw Error("Illegal Interval");break;case "second":g=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(g.test(e))b[f.start.period]=parseFloat(e.split(" ")[0]),e=e.split(" ")[1].split(":"),b.hour=parseFloat(e[0]),b.minute=
parseFloat(e[1]),b.second=parseFloat(e[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "hour":switch(f.end.period){case "minute":g=/^[0-9]{1,}:[0-9]{1,}$/;if(g.test(e))b.hour=parseFloat(e.split(":")[0]),b.minute=parseFloat(e.split(":")[1]);else throw Error("Illegal Interval");break;case "second":g=/^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(g.test(e))e=e.split(":"),b.hour=parseFloat(e[0]),b.minute=parseFloat(e[1]),b.second=parseFloat(e[2]);
else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "minute":switch(f.end.period){case "second":g=/^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(g.test(e))e=e.split(":"),b.minute=parseFloat(e[0]),b.second=parseFloat(e[1]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;default:throw"Invalid Interval.";}}return b};a.prototype.valueInMilliseconds=function(){return("-"===this.op?-1:1)*(1E3*this.second+6E4*this.minute+36E5*this.hour+
864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return a}();a.SqlInterval=f;a.evaluateFunction=function(a,e){var f=m[a.toLowerCase()];if(null==f)throw Error("Function Not Recognised");if(e.length<f.minParams||e.length>f.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return f.evaluate(e)};a.isStandardized=function(a,e){a=m[a.toLowerCase()];return null!=a&&e>=a.minParams&&e<=a.maxParams};var m={extract:{minParams:2,maxParams:2,evaluate:function(a){var e=a[0];
a=a[1];if(null==a)return null;if(a instanceof Date)switch(e.toUpperCase()){case "SECOND":return a.getSeconds();case "MINUTE":return a.getMinutes();case "HOUR":return a.getHours();case "DAY":return a.getDate();case "MONTH":return a.getMonth()+1;case "YEAR":return a.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:function(a){if(2===a.length){var e=a[0],f=a[1];return null==e||null==f?null:e.toString().substring(f-1)}if(3===a.length)return e=
a[0],f=a[1],a=a[2],null==e||null==f||null==a?null:0>=a?"":e.toString().substring(f-1,f+a-1)}},position:{minParams:2,maxParams:2,evaluate:function(a){var e=a[0];a=a[1];return null==e||null==a?null:a.indexOf(e)+1}},trim:{minParams:2,maxParams:3,evaluate:function(a){var f=3===a.length,g=f?a[1]:" ",f=f?a[2]:a[1];if(null==g||null==f)return null;g="("+e.escapeRegExpString(g)+")";switch(a[0]){case "BOTH":return f.replace(new RegExp("^"+g+"*|"+g+"*$","g"),"");case "LEADING":return f.replace(new RegExp("^"+
g+"*","g"),"");case "TRAILING":return f.replace(new RegExp(g+"*$","g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.abs(a[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.ceil(a[0])}},floor:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.floor(a[0])}},log:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])}},log10:{minParams:1,
maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sin(a[0])}},cos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.cos(a[0])}},tan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.tan(a[0])}},asin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.asin(a[0])}},acos:{minParams:1,maxParams:1,evaluate:function(a){return null==
a[0]?null:Math.acos(a[0])}},atan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.atan(a[0])}},sign:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:0<a[0]?1:0>a[1]?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:Math.pow(a[0],a[1])}},mod:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:a[0]%a[1]}},round:{minParams:1,maxParams:2,evaluate:function(a){var e=a[0];a=2===a.length?
Math.pow(10,a[1]):1;return null==e?null:Math.round(e*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:function(a){return null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(a){return"string"===typeof a[0]||a[0]instanceof String?a[0].length:0}},concat:{minParams:1,maxParams:Infinity,evaluate:function(a){for(var e="",f=0;f<a.length;f++){if(null==a[f])return null;e+=a[f].toString()}return e}},lower:{minParams:1,
maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toUpperCase()}}}})},"esri/core/sql/WhereGrammar":function(){define(["require","exports","./sql92grammar"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){}a.parse=function(a){return e.parse(a)};return a}();a.WhereGrammar=f})},"esri/core/sql/sql92grammar":function(){(function(f,a){"function"===
typeof define&&define.amd?define([],a):"object"===typeof module&&module.exports&&(module.exports=a())})(this,function(){function f(a,e,m,k){this.message=a;this.expected=e;this.found=m;this.location=k;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,f)}(function(a,e){function f(){this.constructor=a}f.prototype=e.prototype;a.prototype=new f})(f,Error);f.buildMessage=function(a,e){function f(a){return a.charCodeAt(0).toString(16).toUpperCase()}function k(a){return a.replace(/\\/g,
"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+f(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+f(a)})}function l(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+f(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,
function(a){return"\\x"+f(a)})}var g={literal:function(a){return'"'+k(a.text)+'"'},"class":function(a){var c="",b;for(b=0;b<a.parts.length;b++)c+=a.parts[b]instanceof Array?l(a.parts[b][0])+"-"+l(a.parts[b][1]):l(a.parts[b]);return"["+(a.inverted?"^":"")+c+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){var c=Array(a.length),b;for(b=0;b<a.length;b++){var d=b,e;e=a[b];e=g[e.type](e);c[d]=e}c.sort();
if(0<c.length){for(a=b=1;b<c.length;b++)c[b-1]!==c[b]&&(c[a]=c[b],a++);c.length=a}switch(c.length){case 1:return c[0];case 2:return c[0]+" or "+c[1];default:return c.slice(0,-1).join(", ")+", or "+c[c.length-1]}}(a)+" but "+(e?'"'+k(e)+'"':"end of input")+" found."};return{SyntaxError:f,parse:function(a,e){function m(a,b){return{type:"literal",text:a,ignoreCase:b}}function k(a,b,c){return{type:"class",parts:a,inverted:b,ignoreCase:c}}function l(b){var c=Na[b],d;if(!c){for(d=b-1;!Na[d];)d--;c=Na[d];
for(c={line:c.line,column:c.column};d<b;)10===a.charCodeAt(d)?(c.line++,c.column=1):c.column++,d++;Na[b]=c}return c}function g(a,b){var c=l(a),d=l(b);return{start:{offset:a,line:c.line,column:c.column},end:{offset:b,line:d.line,column:d.column}}}function c(a){w<Aa||(w>Aa&&(Aa=w,$a=[]),$a.push(a))}function h(){var a,b,c;a=w;b=P();b!==t?(b=d(),b!==t?(c=P(),c!==t?a=b:(w=a,a=t)):(w=a,a=t)):(w=a,a=t);return a}function b(){var a,b,c,e,f,g,h,k;a=w;b=d();if(b!==t){c=[];e=w;f=P();f!==t?(g=ta(),g!==t?(h=P(),
h!==t?(k=d(),k!==t?e=f=[f,g,h,k]:(w=e,e=t)):(w=e,e=t)):(w=e,e=t)):(w=e,e=t);for(;e!==t;)c.push(e),e=w,f=P(),f!==t?(g=ta(),g!==t?(h=P(),h!==t?(k=d(),k!==t?e=f=[f,g,h,k]:(w=e,e=t)):(w=e,e=t)):(w=e,e=t)):(w=e,e=t);if(c!==t){a={type:"expr_list"};b=[b];for(e=0;e<c.length;e++)b.push(c[e][3]);a.value=b}else w=a,a=t}else w=a,a=t;return a}function d(){var a,b,c,d,e,f,g,h;a=w;b=n();if(b!==t){c=[];d=w;e=P();e!==t?(f=ea(),f!==t?(g=P(),g!==t?(h=n(),h!==t?d=e=[e,f,g,h]:(w=d,d=t)):(w=d,d=t)):(w=d,d=t)):(w=d,d=t);
for(;d!==t;)c.push(d),d=w,e=P(),e!==t?(f=ea(),f!==t?(g=P(),g!==t?(h=n(),h!==t?d=e=[e,f,g,h]:(w=d,d=t)):(w=d,d=t)):(w=d,d=t)):(w=d,d=t);c!==t?a=b=Ma(b,c):(w=a,a=t)}else w=a,a=t;return a}function n(){var a,b,c,d,e,f,g,h;a=w;b=p();if(b!==t){c=[];d=w;e=P();e!==t?(f=W(),f!==t?(g=P(),g!==t?(h=p(),h!==t?d=e=[e,f,g,h]:(w=d,d=t)):(w=d,d=t)):(w=d,d=t)):(w=d,d=t);for(;d!==t;)c.push(d),d=w,e=P(),e!==t?(f=W(),f!==t?(g=P(),g!==t?(h=p(),h!==t?d=e=[e,f,g,h]:(w=d,d=t)):(w=d,d=t)):(w=d,d=t)):(w=d,d=t);c!==t?a=b=Ma(b,
c):(w=a,a=t)}else w=a,a=t;return a}function p(){var d,e,f,g,h;d=w;e=da();e===t&&(e=w,33===a.charCodeAt(w)?(f=ad,w++):(f=t,0===M&&c(bd)),f!==t?(g=w,M++,61===a.charCodeAt(w)?(h=nb,w++):(h=t,0===M&&c(ob)),M--,h===t?g=void 0:(w=g,g=t),g!==t?e=f=[f,g]:(w=e,e=t)):(w=e,e=t));e!==t?(f=P(),f!==t?(g=p(),g!==t?d=e={type:"unary_expr",operator:"NOT",expr:g}:(w=d,d=t)):(w=d,d=t)):(w=d,d=t);if(d===t)if(d=w,e=u(),e!==t)if(f=P(),f!==t){var k,l,m;f=[];g=w;h=P();h!==t?(k=r(),k!==t?(l=P(),l!==t?(m=u(),m!==t?g=h=[h,k,
l,m]:(w=g,g=t)):(w=g,g=t)):(w=g,g=t)):(w=g,g=t);if(g!==t)for(;g!==t;)f.push(g),g=w,h=P(),h!==t?(k=r(),k!==t?(l=P(),l!==t?(m=u(),m!==t?g=h=[h,k,l,m]:(w=g,g=t)):(w=g,g=t)):(w=g,g=t)):(w=g,g=t);else f=t;f!==t&&(f={type:"arithmetic",tail:f});f===t&&(f=w,g=x(),g!==t?(h=P(),h!==t?(h=ma(),h!==t?(h=P(),h!==t?(h=b(),h!==t?(k=P(),k!==t?(k=sa(),k!==t?f=g={op:g,right:h}:(w=f,f=t)):(w=f,f=t)):(w=f,f=t)):(w=f,f=t)):(w=f,f=t)):(w=f,f=t)):(w=f,f=t),f===t&&(f=w,g=x(),g!==t?(h=P(),h!==t?(h=ma(),h!==t?(h=P(),h!==t?
(h=sa(),h!==t?f=g={op:g,right:{type:"expr_list",value:[]}}:(w=f,f=t)):(w=f,f=t)):(w=f,f=t)):(w=f,f=t)):(w=f,f=t),f===t&&(f=w,g=x(),g!==t?(h=P(),h!==t?(h=F(),h!==t?f=g={op:g,right:h}:(w=f,f=t)):(w=f,f=t)):(w=f,f=t))),f===t&&(f=w,h=da(),h!==t?(g=P(),g!==t?(g=pa(),g!==t?(k=P(),k!==t?(k=u(),k!==t?(l=P(),l!==t?(l=W(),l!==t?(h=P(),h!==t?(h=u(),h!==t?f=h={op:"NOT"+g,right:{type:"expr_list",value:[k,h]}}:(w=f,f=t)):(w=f,f=t)):(w=f,f=t)):(w=f,f=t)):(w=f,f=t)):(w=f,f=t)):(w=f,f=t)):(w=f,f=t)):(w=f,f=t),f===
t&&(f=w,h=pa(),h!==t?(g=P(),g!==t?(g=u(),g!==t?(k=P(),k!==t?(k=W(),k!==t?(l=P(),l!==t?(l=u(),l!==t?f=h={op:h,right:{type:"expr_list",value:[g,l]}}:(w=f,f=t)):(w=f,f=t)):(w=f,f=t)):(w=f,f=t)):(w=f,f=t)):(w=f,f=t)):(w=f,f=t)),f===t&&(f=w,g=Y(),g!==t?(h=P(),h!==t?(h=da(),h!==t?(h=P(),h!==t?(h=u(),h!==t?f=g={op:g+"NOT",right:h}:(w=f,f=t)):(w=f,f=t)):(w=f,f=t)):(w=f,f=t)):(w=f,f=t),f===t&&(f=w,g=Y(),g!==t?(h=P(),h!==t?(h=u(),h!==t?f=g={op:g,right:h}:(w=f,f=t)):(w=f,f=t)):(w=f,f=t)),f===t&&(f=w,g=q(),g!==
t?(h=P(),h!==t?(h=O(),h!==t?(k=P(),k!==t?(k=w,a.substr(w,6).toLowerCase()===cd?(l=a.substr(w,6),w+=6):(l=t,0===M&&c(dd)),l!==t?(l=w,M++,m=C(),M--,m===t?l=void 0:(w=l,l=t),l!==t?k="ESCAPE":(w=k,k=t)):(w=k,k=t),k!==t?(k=P(),k!==t?(k=L(),k!==t?f=g={op:g,right:h,escape:k.value}:(w=f,f=t)):(w=f,f=t)):(w=f,f=t)):(w=f,f=t)):(w=f,f=t)):(w=f,f=t)):(w=f,f=t),f===t&&(f=w,g=q(),g!==t?(h=P(),h!==t?(h=O(),h!==t?f=g={op:g,right:h,escape:""}:(w=f,f=t)):(w=f,f=t)):(w=f,f=t))))));f===t&&(f=null);f!==t?(d=e,e=f,""==
e||void 0==e||null==e?e=d:(f=null,e=f="arithmetic"==e.type?Ma(d,e.tail):jb(e.op,d,e.right,e.escape)),d=e):(w=d,d=t)}else w=d,d=t;else w=d,d=t;return d}function r(){var b;a.substr(w,2)===mb?(b=mb,w+=2):(b=t,0===M&&c(ed));b===t&&(62===a.charCodeAt(w)?(b=fd,w++):(b=t,0===M&&c(gd)),b===t&&(a.substr(w,2)===pb?(b=pb,w+=2):(b=t,0===M&&c(hd)),b===t&&(a.substr(w,2)===qb?(b=qb,w+=2):(b=t,0===M&&c(id)),b===t&&(60===a.charCodeAt(w)?(b=jd,w++):(b=t,0===M&&c(kd)),b===t&&(61===a.charCodeAt(w)?(b=nb,w++):(b=t,0===
M&&c(ob)),b===t&&(a.substr(w,2)===rb?(b=rb,w+=2):(b=t,0===M&&c(ld))))))));return b}function q(){var a,b,c,d;a=a=w;b=da();b!==t?(c=P(),c!==t?(d=aa(),d!==t?a=b=[b,c,d]:(w=a,a=t)):(w=a,a=t)):(w=a,a=t);a!==t&&(a=a[0]+" "+a[2]);a===t&&(a=aa());return a}function x(){var a,b,c,d;a=a=w;b=da();b!==t?(c=P(),c!==t?(d=ca(),d!==t?a=b=[b,c,d]:(w=a,a=t)):(w=a,a=t)):(w=a,a=t);a!==t&&(a=a[0]+" "+a[2]);a===t&&(a=ca());return a}function u(){var a,b,c,d,e,f,g,h;a=w;b=y();if(b!==t){c=[];d=w;e=P();e!==t?(f=v(),f!==t?(g=
P(),g!==t?(h=y(),h!==t?d=e=[e,f,g,h]:(w=d,d=t)):(w=d,d=t)):(w=d,d=t)):(w=d,d=t);for(;d!==t;)c.push(d),d=w,e=P(),e!==t?(f=v(),f!==t?(g=P(),g!==t?(h=y(),h!==t?d=e=[e,f,g,h]:(w=d,d=t)):(w=d,d=t)):(w=d,d=t)):(w=d,d=t);c!==t?a=b=Ma(b,c):(w=a,a=t)}else w=a,a=t;return a}function v(){var b;43===a.charCodeAt(w)?(b=gc,w++):(b=t,0===M&&c(hc));b===t&&(45===a.charCodeAt(w)?(b=ic,w++):(b=t,0===M&&c(jc)));return b}function y(){var a,b,c,d,e,f,g,h;a=w;b=A();if(b!==t){c=[];d=w;e=P();e!==t?(f=z(),f!==t?(g=P(),g!==
t?(h=A(),h!==t?d=e=[e,f,g,h]:(w=d,d=t)):(w=d,d=t)):(w=d,d=t)):(w=d,d=t);for(;d!==t;)c.push(d),d=w,e=P(),e!==t?(f=z(),f!==t?(g=P(),g!==t?(h=A(),h!==t?d=e=[e,f,g,h]:(w=d,d=t)):(w=d,d=t)):(w=d,d=t)):(w=d,d=t);c!==t?a=b=Ma(b,c):(w=a,a=t)}else w=a,a=t;return a}function z(){var b;42===a.charCodeAt(w)?(b=md,w++):(b=t,0===M&&c(nd));b===t&&(47===a.charCodeAt(w)?(b=od,w++):(b=t,0===M&&c(pd)));return b}function A(){var e,f,g,h,k,l,m;m=L();if(m===t){var n,p,q,r;n=w;var u,v,y,x;u=w;v=Q();v!==t?(y=S(),y!==t?(x=
U(),x!==t?u=v=parseFloat(v+y+x):(w=u,u=t)):(w=u,u=t)):(w=u,u=t);u===t&&(u=w,v=Q(),v!==t?(y=S(),y!==t?u=v=parseFloat(v+y):(w=u,u=t)):(w=u,u=t),u===t&&(u=w,v=Q(),v!==t?(y=U(),y!==t?u=v=parseFloat(v+y):(w=u,u=t)):(w=u,u=t),u===t&&(u=w,v=Q(),v!==t&&(v=parseFloat(v)),u=v)));p=u;p!==t?(q=w,M++,r=D(),M--,r===t?q=void 0:(w=q,q=t),q!==t?n=p={type:"number",value:p}:(w=n,n=t)):(w=n,n=t);m=n;if(m===t){var z,A;z=w;var K,G,H,aa;K=w;a.substr(w,4).toLowerCase()===qd?(G=a.substr(w,4),w+=4):(G=t,0===M&&c(rd));G!==
t?(H=w,M++,aa=C(),M--,aa===t?H=void 0:(w=H,H=t),H!==t?K=G=[G,H]:(w=K,K=t)):(w=K,K=t);A=K;A!==t&&(A={type:"bool",value:!0});z=A;if(z===t){z=w;var W,ea,da,X;W=w;a.substr(w,5).toLowerCase()===sd?(ea=a.substr(w,5),w+=5):(ea=t,0===M&&c(td));ea!==t?(da=w,M++,X=C(),M--,X===t?da=void 0:(w=da,da=t),da!==t?W=ea=[ea,da]:(w=W,W=t)):(w=W,W=t);A=W;A!==t&&(A={type:"bool",value:!1});z=A}m=z;if(m===t){var pa,V,Y,ia,ta;V=w;a.substr(w,4).toLowerCase()===ud?(Y=a.substr(w,4),w+=4):(Y=t,0===M&&c(vd));Y!==t?(ia=w,M++,ta=
C(),M--,ta===t?ia=void 0:(w=ia,ia=t),ia!==t?V=Y=[Y,ia]:(w=V,V=t)):(w=V,V=t);pa=V;pa!==t&&(pa={type:"null",value:null});m=pa;if(m===t){var la,Aa,Ja,Ma;la=w;var Sa,Na,sb,Za;Sa=w;a.substr(w,4).toLowerCase()===wd?(Na=a.substr(w,4),w+=4):(Na=t,0===M&&c(xd));Na!==t?(sb=w,M++,Za=C(),M--,Za===t?sb=void 0:(w=sb,sb=t),sb!==t?Sa=Na="DATE":(w=Sa,Sa=t)):(w=Sa,Sa=t);Aa=Sa;Aa!==t?(Ja=P(),Ja!==t?(Ma=O(),Ma!==t?la=Aa={type:"date",value:Ma.value}:(w=la,la=t)):(w=la,la=t)):(w=la,la=t);m=la;if(m===t){var Oa,Ra,$a,kc;
Oa=w;var Ta,Lb,tb,jb;Ta=w;a.substr(w,9).toLowerCase()===yd?(Lb=a.substr(w,9),w+=9):(Lb=t,0===M&&c(zd));Lb!==t?(tb=w,M++,jb=C(),M--,jb===t?tb=void 0:(w=tb,tb=t),tb!==t?Ta=Lb="TIMESTAMP":(w=Ta,Ta=t)):(w=Ta,Ta=t);Ra=Ta;Ra!==t?($a=P(),$a!==t?(kc=O(),kc!==t?Oa=Ra={type:"timestamp",value:kc.value}:(w=Oa,Oa=t)):(w=Oa,Oa=t)):(w=Oa,Oa=t);m=Oa;if(m===t){var fa,ab,Mb,Ka,Nb,bb,kb,lc;fa=w;ab=ra();ab!==t?(Mb=P(),Mb!==t?(45===a.charCodeAt(w)?(Ka=ic,w++):(Ka=t,0===M&&c(jc)),Ka===t&&(43===a.charCodeAt(w)?(Ka=gc,w++):
(Ka=t,0===M&&c(hc))),Ka!==t?(Nb=P(),Nb!==t?(bb=O(),bb!==t?(kb=P(),kb!==t?(lc=J(),lc!==t?fa=ab={type:"interval",value:bb,qualifier:lc,op:Ka}:(w=fa,fa=t)):(w=fa,fa=t)):(w=fa,fa=t)):(w=fa,fa=t)):(w=fa,fa=t)):(w=fa,fa=t)):(w=fa,fa=t);fa===t&&(fa=w,ab=ra(),ab!==t?(Mb=P(),Mb!==t?(Ka=O(),Ka!==t?(Nb=P(),Nb!==t?(bb=J(),bb!==t?fa=ab={type:"interval",value:Ka,qualifier:bb,op:""}:(w=fa,fa=t)):(w=fa,fa=t)):(w=fa,fa=t)):(w=fa,fa=t)):(w=fa,fa=t));m=fa}}}}}}e=m;if(e===t){var ja,mc,lb,mb,nb,nc,ob,pb,qb,oc,rb,Db;ja=
w;var Ua,Ob,ub,Eb;Ua=w;a.substr(w,7).toLowerCase()===Ad?(Ob=a.substr(w,7),w+=7):(Ob=t,0===M&&c(Bd));Ob!==t?(ub=w,M++,Eb=C(),M--,Eb===t?ub=void 0:(w=ub,ub=t),ub!==t?Ua=Ob="EXTRACT":(w=Ua,Ua=t)):(w=Ua,Ua=t);mc=Ua;if(mc!==t)if(lb=P(),lb!==t)if(mb=ma(),mb!==t)if(nb=P(),nb!==t){var Ea;Ea=va();Ea===t&&(Ea=Ca(),Ea===t&&(Ea=Da(),Ea===t&&(Ea=wa(),Ea===t&&(Ea=Ba(),Ea===t&&(Ea=xa())))));nc=Ea;nc!==t?(ob=P(),ob!==t?(pb=qa(),pb!==t?(qb=P(),qb!==t?(oc=d(),oc!==t?(rb=P(),rb!==t?(Db=sa(),Db!==t?ja=mc={type:"function",
name:"extract",args:{type:"expr_list",value:[{type:"string",value:nc},oc]}}:(w=ja,ja=t)):(w=ja,ja=t)):(w=ja,ja=t)):(w=ja,ja=t)):(w=ja,ja=t)):(w=ja,ja=t)):(w=ja,ja=t)}else w=ja,ja=t;else w=ja,ja=t;else w=ja,ja=t;else w=ja,ja=t;e=ja;if(e===t){var ha,pc,Fb,Gb,Hb,Pb,Ib,Jb,Kb,Qb,zc,ya,cb,qc,rc,sc;ha=w;var Va,Rb,vb,Ac;Va=w;a.substr(w,9).toLowerCase()===Cd?(Rb=a.substr(w,9),w+=9):(Rb=t,0===M&&c(Dd));Rb!==t?(vb=w,M++,Ac=C(),M--,Ac===t?vb=void 0:(w=vb,vb=t),vb!==t?Va=Rb="SUBSTRING":(w=Va,Va=t)):(w=Va,Va=t);
pc=Va;if(pc!==t)if(Fb=P(),Fb!==t)if(Gb=ma(),Gb!==t)if(Hb=P(),Hb!==t)if(Pb=d(),Pb!==t)if(Ib=P(),Ib!==t)if(Jb=qa(),Jb!==t)if(Kb=P(),Kb!==t)if(Qb=d(),Qb!==t)if(zc=P(),zc!==t){ya=w;var Wa,Sb,wb,Bc;Wa=w;a.substr(w,3).toLowerCase()===Ed?(Sb=a.substr(w,3),w+=3):(Sb=t,0===M&&c(Fd));Sb!==t?(wb=w,M++,Bc=C(),M--,Bc===t?wb=void 0:(w=wb,wb=t),wb!==t?Wa=Sb="FOR":(w=Wa,Wa=t)):(w=Wa,Wa=t);cb=Wa;cb!==t?(qc=P(),qc!==t?(rc=d(),rc!==t?(sc=P(),sc!==t?ya=cb=[cb,qc,rc,sc]:(w=ya,ya=t)):(w=ya,ya=t)):(w=ya,ya=t)):(w=ya,ya=
t);ya===t&&(ya=null);ya!==t?(cb=sa(),cb!==t?ha=pc={type:"function",name:"substring",args:{type:"expr_list",value:ya?[Pb,Qb,ya[2]]:[Pb,Qb]}}:(w=ha,ha=t)):(w=ha,ha=t)}else w=ha,ha=t;else w=ha,ha=t;else w=ha,ha=t;else w=ha,ha=t;else w=ha,ha=t;else w=ha,ha=t;else w=ha,ha=t;else w=ha,ha=t;else w=ha,ha=t;else w=ha,ha=t;e=ha;if(e===t){var Z,db,Tb,Ub,Vb,Fa,Wb,eb,Xb,Yb,Cc,tc,Dc,Ec;Z=w;db=oa();db!==t?(Tb=P(),Tb!==t?(Ub=ma(),Ub!==t?(Vb=P(),Vb!==t?(Fa=I(),Fa===t&&(Fa=null),Fa!==t?(Wb=P(),Wb!==t?(eb=d(),eb!==
t?(Xb=P(),Xb!==t?(Yb=qa(),Yb!==t?(Cc=P(),Cc!==t?(tc=d(),tc!==t?(Dc=P(),Dc!==t?(Ec=sa(),Ec!==t?Z=db={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==Fa?"BOTH":Fa},eb,tc]}}:(w=Z,Z=t)):(w=Z,Z=t)):(w=Z,Z=t)):(w=Z,Z=t)):(w=Z,Z=t)):(w=Z,Z=t)):(w=Z,Z=t)):(w=Z,Z=t)):(w=Z,Z=t)):(w=Z,Z=t)):(w=Z,Z=t)):(w=Z,Z=t)):(w=Z,Z=t);Z===t&&(Z=w,db=oa(),db!==t?(Tb=P(),Tb!==t?(Ub=ma(),Ub!==t?(Vb=P(),Vb!==t?(Fa=I(),Fa===t&&(Fa=null),Fa!==t?(Wb=P(),Wb!==t?(eb=d(),eb!==t?(Xb=P(),Xb!==t?
(Yb=sa(),Yb!==t?Z=db={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==Fa?"BOTH":Fa},eb]}}:(w=Z,Z=t)):(w=Z,Z=t)):(w=Z,Z=t)):(w=Z,Z=t)):(w=Z,Z=t)):(w=Z,Z=t)):(w=Z,Z=t)):(w=Z,Z=t)):(w=Z,Z=t));e=Z;if(e===t){var ka,uc,Fc,Gc,Hc,vc,Ic,Jc,Kc,wc,Lc,Mc;ka=w;var Xa,Zb,xb,Nc;Xa=w;a.substr(w,8).toLowerCase()===Gd?(Zb=a.substr(w,8),w+=8):(Zb=t,0===M&&c(Hd));Zb!==t?(xb=w,M++,Nc=C(),M--,Nc===t?xb=void 0:(w=xb,xb=t),xb!==t?Xa=Zb="POSITION":(w=Xa,Xa=t)):(w=Xa,Xa=t);uc=Xa;uc!==t?
(Fc=P(),Fc!==t?(Gc=ma(),Gc!==t?(Hc=P(),Hc!==t?(vc=d(),vc!==t?(Ic=P(),Ic!==t?(Jc=ca(),Jc!==t?(Kc=P(),Kc!==t?(wc=d(),wc!==t?(Lc=P(),Lc!==t?(Mc=sa(),Mc!==t?ka=uc={type:"function",name:"position",args:{type:"expr_list",value:[vc,wc]}}:(w=ka,ka=t)):(w=ka,ka=t)):(w=ka,ka=t)):(w=ka,ka=t)):(w=ka,ka=t)):(w=ka,ka=t)):(w=ka,ka=t)):(w=ka,ka=t)):(w=ka,ka=t)):(w=ka,ka=t)):(w=ka,ka=t);e=ka;if(e===t){var ua,$b,Oc,Pc,Qc,fb,Rc,Sc;ua=w;var Ga,yb,zb,La;Ga=w;Ga=yb=B();if(Ga===t)if(Ga=w,96===a.charCodeAt(w)?(yb=Tc,w++):
(yb=t,0===M&&c(Uc)),yb!==t){zb=[];Vc.test(a.charAt(w))?(La=a.charAt(w),w++):(La=t,0===M&&c(Wc));if(La!==t)for(;La!==t;)zb.push(La),Vc.test(a.charAt(w))?(La=a.charAt(w),w++):(La=t,0===M&&c(Wc));else zb=t;zb!==t?(96===a.charCodeAt(w)?(La=Tc,w++):(La=t,0===M&&c(Uc)),La!==t?Ga=yb=zb.join(""):(w=Ga,Ga=t)):(w=Ga,Ga=t)}else w=Ga,Ga=t;$b=Ga;$b!==t?(Oc=P(),Oc!==t?(Pc=ma(),Pc!==t?(Qc=P(),Qc!==t?(fb=b(),fb===t&&(fb=null),fb!==t?(Rc=P(),Rc!==t?(Sc=sa(),Sc!==t?ua=$b={type:"function",name:$b,args:fb?fb:{type:"expr_list",
value:[]}}:(w=ua,ua=t)):(w=ua,ua=t)):(w=ua,ua=t)):(w=ua,ua=t)):(w=ua,ua=t)):(w=ua,ua=t)):(w=ua,ua=t);e=ua;if(e===t){var ac,ba,gb,bc,hb,cc,Pa,Ha,Ab,Xc,Yc;ba=w;gb=na();if(gb!==t)if(bc=P(),bc!==t)if(hb=d(),hb!==t)if(cc=P(),cc!==t){Pa=[];for(Ha=T();Ha!==t;)Pa.push(Ha),Ha=T();Pa!==t?(Ha=P(),Ha!==t?(Ab=za(),Ab!==t?ba=gb={type:"case_expression",format:"simple",operand:hb,clauses:Pa,else:null}:(w=ba,ba=t)):(w=ba,ba=t)):(w=ba,ba=t)}else w=ba,ba=t;else w=ba,ba=t;else w=ba,ba=t;else w=ba,ba=t;if(ba===t)if(ba=
w,gb=na(),gb!==t)if(bc=P(),bc!==t)if(hb=d(),hb!==t)if(cc=P(),cc!==t){Pa=[];for(Ha=T();Ha!==t;)Pa.push(Ha),Ha=T();Pa!==t?(Ha=P(),Ha!==t?(Ab=R(),Ab!==t?(Xc=P(),Xc!==t?(Yc=za(),Yc!==t?ba=gb={type:"case_expression",format:"simple",operand:hb,clauses:Pa,else:Ab.value}:(w=ba,ba=t)):(w=ba,ba=t)):(w=ba,ba=t)):(w=ba,ba=t)):(w=ba,ba=t)}else w=ba,ba=t;else w=ba,ba=t;else w=ba,ba=t;else w=ba,ba=t;ac=ba;if(ac===t){var ga,ib,dc,Qa,Ia,Bb,Zc,$c;ga=w;ib=na();if(ib!==t)if(dc=P(),dc!==t){Qa=[];for(Ia=N();Ia!==t;)Qa.push(Ia),
Ia=N();Qa!==t?(Ia=P(),Ia!==t?(Bb=za(),Bb!==t?ga=ib={type:"case_expression",format:"searched",clauses:Qa,else:null}:(w=ga,ga=t)):(w=ga,ga=t)):(w=ga,ga=t)}else w=ga,ga=t;else w=ga,ga=t;if(ga===t)if(ga=w,ib=na(),ib!==t)if(dc=P(),dc!==t){Qa=[];for(Ia=N();Ia!==t;)Qa.push(Ia),Ia=N();Qa!==t?(Ia=P(),Ia!==t?(Bb=R(),Bb!==t?(Zc=P(),Zc!==t?($c=za(),$c!==t?ga=ib={type:"case_expression",format:"searched",clauses:Qa,else:Bb.value}:(w=ga,ga=t)):(w=ga,ga=t)):(w=ga,ga=t)):(w=ga,ga=t)):(w=ga,ga=t)}else w=ga,ga=t;else w=
ga,ga=t;ac=ga}e=ac;if(e===t){var Cb,Ya,xc,ec,fc;Ya=w;xc=D();if(xc!==t){ec=[];for(fc=E();fc!==t;)ec.push(fc),fc=E();ec!==t?Ya=xc+=ec.join(""):(w=Ya,Ya=t)}else w=Ya,Ya=t;Cb=Ya;if(Cb!==t){var yc=Cb;Cb=/^CURRENT_DATE$/i.test(yc)?{type:"current_time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(yc)?{type:"current_time",mode:"timestamp"}:{type:"column_ref",table:"",column:yc}}e=Cb;e===t&&(e=F(),e===t&&(e=w,f=ma(),f!==t?(g=P(),g!==t?(h=d(),h!==t?(k=P(),k!==t?(l=sa(),l!==t?(h.paren=!0,e=f=h):(w=e,e=t)):(w=e,
e=t)):(w=e,e=t)):(w=e,e=t)):(w=e,e=t)))}}}}}}}return e}function B(){var a,b,c,d;a=w;b=D();if(b!==t){c=[];for(d=C();d!==t;)c.push(d),d=C();c!==t?a=b+=c.join(""):(w=a,a=t)}else w=a,a=t;return a}function D(){var b;Id.test(a.charAt(w))?(b=a.charAt(w),w++):(b=t,0===M&&c(Jd));return b}function C(){var b;Kd.test(a.charAt(w))?(b=a.charAt(w),w++):(b=t,0===M&&c(Ld));return b}function E(){var b;Md.test(a.charAt(w))?(b=a.charAt(w),w++):(b=t,0===M&&c(Nd));return b}function F(){var b,d,e;b=w;64===a.charCodeAt(w)?
(d=Od,w++):(d=t,0===M&&c(Pd));d!==t?(e=B(),e!==t?b=d=[d,e]:(w=b,b=t)):(w=b,b=t);b!==t&&(b={type:"param",value:b[1]});return b}function I(){var b,d,e;b=w;a.substr(w,7).toLowerCase()===Qd?(d=a.substr(w,7),w+=7):(d=t,0===M&&c(Rd));d!==t?(d=w,M++,e=C(),M--,e===t?d=void 0:(w=d,d=t),d!==t?b="LEADING":(w=b,b=t)):(w=b,b=t);b===t&&(b=w,a.substr(w,8).toLowerCase()===Sd?(d=a.substr(w,8),w+=8):(d=t,0===M&&c(Td)),d!==t?(d=w,M++,e=C(),M--,e===t?d=void 0:(w=d,d=t),d!==t?b="TRAILING":(w=b,b=t)):(w=b,b=t),b===t&&
(b=w,a.substr(w,4).toLowerCase()===Ud?(d=a.substr(w,4),w+=4):(d=t,0===M&&c(Vd)),d!==t?(d=w,M++,e=C(),M--,e===t?d=void 0:(w=d,d=t),d!==t?b="BOTH":(w=b,b=t)):(w=b,b=t)));return b}function J(){var b,d,e;b=w;var f,g;d=w;e=G();e!==t?(f=P(),f!==t?(f=ma(),f!==t?(f=P(),f!==t?(f=K(),f!==t?(g=P(),g!==t?(g=sa(),g!==t?d=e={type:"interval-period",period:e.value,precision:f,secondary:null}:(w=d,d=t)):(w=d,d=t)):(w=d,d=t)):(w=d,d=t)):(w=d,d=t)):(w=d,d=t)):(w=d,d=t);d===t&&(d=w,e=G(),e!==t&&(e=Db(e)),d=e);if(d!==
t)if(e=P(),e!==t)if(e=w,a.substr(w,2).toLowerCase()===Wd?(f=a.substr(w,2),w+=2):(f=t,0===M&&c(Xd)),f!==t?(f=w,M++,g=C(),M--,g===t?f=void 0:(w=f,f=t),f!==t?e="TO":(w=e,e=t)):(w=e,e=t),e!==t)if(e=P(),e!==t){var h;e=w;f=G();f!==t&&(f={type:"interval-period",period:f.value,precision:null,secondary:null});e=f;e===t&&(e=w,f=xa(),f!==t?(f=P(),f!==t?(f=ma(),f!==t?(f=P(),f!==t?(f=K(),f!==t?(g=P(),g!==t?(g=ta(),g!==t?(g=P(),g!==t?(g=H(),g!==t?(h=P(),h!==t?(h=sa(),h!==t?e=f=Eb(f,g):(w=e,e=t)):(w=e,e=t)):(w=
e,e=t)):(w=e,e=t)):(w=e,e=t)):(w=e,e=t)):(w=e,e=t)):(w=e,e=t)):(w=e,e=t)):(w=e,e=t)):(w=e,e=t),e===t&&(e=w,f=xa(),f!==t?(f=P(),f!==t?(f=ma(),f!==t?(f=P(),f!==t?(f=K(),f!==t?(g=P(),g!==t?(g=sa(),g!==t?e=f={type:"interval-period",period:"second",precision:f,secondary:null}:(w=e,e=t)):(w=e,e=t)):(w=e,e=t)):(w=e,e=t)):(w=e,e=t)):(w=e,e=t)):(w=e,e=t),e===t&&(e=w,f=xa(),f!==t&&(f={type:"interval-period",period:"second",precision:null,secondary:null}),e=f)));e!==t?b=d={type:"interval-qualifier",start:d,
end:e}:(w=b,b=t)}else w=b,b=t;else w=b,b=t;else w=b,b=t;else w=b,b=t;b===t&&(b=w,e=G(),e!==t?(d=P(),d!==t?(d=ma(),d!==t?(d=P(),d!==t?(d=H(),d!==t?(f=P(),f!==t?(f=sa(),f!==t?b=e={type:"interval-period",period:e.value,precision:d,secondary:null}:(w=b,b=t)):(w=b,b=t)):(w=b,b=t)):(w=b,b=t)):(w=b,b=t)):(w=b,b=t)):(w=b,b=t),b===t&&(b=w,e=G(),e!==t&&(e=Db(e)),b=e,b===t&&(b=w,e=xa(),e!==t?(d=P(),d!==t?(d=ma(),d!==t?(d=P(),d!==t?(d=K(),d!==t?(f=P(),f!==t?(f=ta(),f!==t?(e=P(),e!==t?(e=H(),e!==t?(f=P(),f!==
t?(f=sa(),f!==t?b=e=Eb(d,e):(w=b,b=t)):(w=b,b=t)):(w=b,b=t)):(w=b,b=t)):(w=b,b=t)):(w=b,b=t)):(w=b,b=t)):(w=b,b=t)):(w=b,b=t)):(w=b,b=t)):(w=b,b=t),b===t&&(b=w,e=xa(),e!==t?(d=P(),d!==t?(d=ma(),d!==t?(d=P(),d!==t?(d=H(),d!==t?(f=P(),f!==t?(f=sa(),f!==t?b=e={type:"interval-period",period:"second",precision:d,secondary:null}:(w=b,b=t)):(w=b,b=t)):(w=b,b=t)):(w=b,b=t)):(w=b,b=t)):(w=b,b=t)):(w=b,b=t),b===t&&(b=w,e=xa(),e!==t&&(e={type:"interval-period",period:"second",precision:null,secondary:null}),
b=e)))));return b}function G(){var a;a=w;a=Da();a!==t&&(a={type:"string",value:"day"});a===t&&(a=w,a=wa(),a!==t&&(a={type:"string",value:"hour"}),a===t&&(a=w,a=Ba(),a!==t&&(a={type:"string",value:"minute"}),a===t&&(a=w,a=Ca(),a!==t&&(a={type:"string",value:"month"}),a===t&&(a=w,a=va(),a!==t&&(a={type:"string",value:"year"})))));return a}function H(){var a;a=X();a!==t&&(a=parseFloat(a));return a}function K(){var a;a=X();a!==t&&(a=parseFloat(a));return a}function O(){var a;a=L();a===t&&(a=F());return a}
function L(){var b,d,e;b=w;39===a.charCodeAt(w)?(d=Fb,w++):(d=t,0===M&&c(Gb));d===t&&(a.substr(w,2)===Hb?(d=Hb,w+=2):(d=t,0===M&&c(Yd)));if(d!==t){d=[];e=w;a.substr(w,2)===Za?(e=Za,w+=2):(e=t,0===M&&c(Ib));e!==t&&(e="'");e===t&&(Jb.test(a.charAt(w))?(e=a.charAt(w),w++):(e=t,0===M&&c(Kb)));for(;e!==t;)d.push(e),e=w,a.substr(w,2)===Za?(e=Za,w+=2):(e=t,0===M&&c(Ib)),e!==t&&(e="'"),e===t&&(Jb.test(a.charAt(w))?(e=a.charAt(w),w++):(e=t,0===M&&c(Kb)));d!==t?(39===a.charCodeAt(w)?(e=Fb,w++):(e=t,0===M&&
c(Gb)),e!==t?b=d={type:"string",value:d.join("")}:(w=b,b=t)):(w=b,b=t)}else w=b,b=t;return b}function N(){var a,b,c;a=w;b=ia();b!==t?(b=P(),b!==t?(b=d(),b!==t?(c=P(),c!==t?(c=la(),c!==t?(c=P(),c!==t?(c=d(),c!==t?a=b={type:"when_clause",operand:b,value:c}:(w=a,a=t)):(w=a,a=t)):(w=a,a=t)):(w=a,a=t)):(w=a,a=t)):(w=a,a=t)):(w=a,a=t);return a}function T(){var a,b,c;a=w;b=ia();b!==t?(b=P(),b!==t?(b=d(),b!==t?(c=P(),c!==t?(c=la(),c!==t?(c=P(),c!==t?(c=d(),c!==t?a=b={type:"when_clause",operand:b,value:c}:
(w=a,a=t)):(w=a,a=t)):(w=a,a=t)):(w=a,a=t)):(w=a,a=t)):(w=a,a=t)):(w=a,a=t);return a}function R(){var b,e;b=w;var f,g;e=w;a.substr(w,4).toLowerCase()===Zd?(f=a.substr(w,4),w+=4):(f=t,0===M&&c($d));f!==t?(f=w,M++,g=C(),M--,g===t?f=void 0:(w=f,f=t),f!==t?e="ELSE":(w=e,e=t)):(w=e,e=t);e!==t?(e=P(),e!==t?(e=d(),e!==t?b={type:"else_clause",value:e}:(w=b,b=t)):(w=b,b=t)):(w=b,b=t);return b}function Q(){var b,d,e;b=X();b===t&&(b=w,45===a.charCodeAt(w)?(d=ic,w++):(d=t,0===M&&c(jc)),d===t&&(43===a.charCodeAt(w)?
(d=gc,w++):(d=t,0===M&&c(hc))),d!==t?(e=X(),e!==t?b=d=d[0]+e:(w=b,b=t)):(w=b,b=t));return b}function S(){var b,d;b=w;46===a.charCodeAt(w)?(d=ae,w++):(d=t,0===M&&c(be));d!==t?(d=X(),d===t&&(d=null),d!==t?b="."+(null!=d?d:""):(w=b,b=t)):(w=b,b=t);return b}function U(){var b,d,e;d=b=w;ce.test(a.charAt(w))?(e=a.charAt(w),w++):(e=t,0===M&&c(de));e!==t?(ee.test(a.charAt(w))?(e=a.charAt(w),w++):(e=t,0===M&&c(fe)),e===t&&(e=null),e!==t?d="e"+(null===e?"":e):(w=d,d=t)):(w=d,d=t);d!==t?(e=X(),e!==t?b=d+e:(w=
b,b=t)):(w=b,b=t);return b}function X(){var a,b;a=[];b=V();if(b!==t)for(;b!==t;)a.push(b),b=V();else a=t;a!==t&&(a=a.join(""));return a}function V(){var b;ge.test(a.charAt(w))?(b=a.charAt(w),w++):(b=t,0===M&&c(he));return b}function ca(){var b,d,e;b=w;a.substr(w,2).toLowerCase()===ie?(d=a.substr(w,2),w+=2):(d=t,0===M&&c(je));d!==t?(d=w,M++,e=C(),M--,e===t?d=void 0:(w=d,d=t),d!==t?b="IN":(w=b,b=t)):(w=b,b=t);return b}function Y(){var b,d,e;b=w;a.substr(w,2).toLowerCase()===ke?(d=a.substr(w,2),w+=2):
(d=t,0===M&&c(le));d!==t?(d=w,M++,e=C(),M--,e===t?d=void 0:(w=d,d=t),d!==t?b="IS":(w=b,b=t)):(w=b,b=t);return b}function aa(){var b,d,e;b=w;a.substr(w,4).toLowerCase()===me?(d=a.substr(w,4),w+=4):(d=t,0===M&&c(ne));d!==t?(d=w,M++,e=C(),M--,e===t?d=void 0:(w=d,d=t),d!==t?b="LIKE":(w=b,b=t)):(w=b,b=t);return b}function da(){var b,d,e;b=w;a.substr(w,3).toLowerCase()===oe?(d=a.substr(w,3),w+=3):(d=t,0===M&&c(pe));d!==t?(d=w,M++,e=C(),M--,e===t?d=void 0:(w=d,d=t),d!==t?b="NOT":(w=b,b=t)):(w=b,b=t);return b}
function W(){var b,d,e;b=w;a.substr(w,3).toLowerCase()===qe?(d=a.substr(w,3),w+=3):(d=t,0===M&&c(re));d!==t?(d=w,M++,e=C(),M--,e===t?d=void 0:(w=d,d=t),d!==t?b="AND":(w=b,b=t)):(w=b,b=t);return b}function ea(){var b,d,e;b=w;a.substr(w,2).toLowerCase()===se?(d=a.substr(w,2),w+=2):(d=t,0===M&&c(te));d!==t?(d=w,M++,e=C(),M--,e===t?d=void 0:(w=d,d=t),d!==t?b="OR":(w=b,b=t)):(w=b,b=t);return b}function pa(){var b,d,e;b=w;a.substr(w,7).toLowerCase()===ue?(d=a.substr(w,7),w+=7):(d=t,0===M&&c(ve));d!==t?
(d=w,M++,e=C(),M--,e===t?d=void 0:(w=d,d=t),d!==t?b="BETWEEN":(w=b,b=t)):(w=b,b=t);return b}function qa(){var b,d,e;b=w;a.substr(w,4).toLowerCase()===we?(d=a.substr(w,4),w+=4):(d=t,0===M&&c(xe));d!==t?(d=w,M++,e=C(),M--,e===t?d=void 0:(w=d,d=t),d!==t?b="FROM":(w=b,b=t)):(w=b,b=t);return b}function oa(){var b,d,e;b=w;a.substr(w,4).toLowerCase()===ye?(d=a.substr(w,4),w+=4):(d=t,0===M&&c(ze));d!==t?(d=w,M++,e=C(),M--,e===t?d=void 0:(w=d,d=t),d!==t?b="TRIM":(w=b,b=t)):(w=b,b=t);return b}function ra(){var b,
d,e;b=w;a.substr(w,8).toLowerCase()===Ae?(d=a.substr(w,8),w+=8):(d=t,0===M&&c(Be));d!==t?(d=w,M++,e=C(),M--,e===t?d=void 0:(w=d,d=t),d!==t?b="INTERVAL":(w=b,b=t)):(w=b,b=t);return b}function va(){var b,d,e;b=w;a.substr(w,4).toLowerCase()===Ce?(d=a.substr(w,4),w+=4):(d=t,0===M&&c(De));d!==t?(d=w,M++,e=C(),M--,e===t?d=void 0:(w=d,d=t),d!==t?b="YEAR":(w=b,b=t)):(w=b,b=t);return b}function Ca(){var b,d,e;b=w;a.substr(w,5).toLowerCase()===Ee?(d=a.substr(w,5),w+=5):(d=t,0===M&&c(Fe));d!==t?(d=w,M++,e=C(),
M--,e===t?d=void 0:(w=d,d=t),d!==t?b="MONTH":(w=b,b=t)):(w=b,b=t);return b}function Da(){var b,d,e;b=w;a.substr(w,3).toLowerCase()===Ge?(d=a.substr(w,3),w+=3):(d=t,0===M&&c(He));d!==t?(d=w,M++,e=C(),M--,e===t?d=void 0:(w=d,d=t),d!==t?b="DAY":(w=b,b=t)):(w=b,b=t);return b}function wa(){var b,d,e;b=w;a.substr(w,4).toLowerCase()===Ie?(d=a.substr(w,4),w+=4):(d=t,0===M&&c(Je));d!==t?(d=w,M++,e=C(),M--,e===t?d=void 0:(w=d,d=t),d!==t?b="HOUR":(w=b,b=t)):(w=b,b=t);return b}function Ba(){var b,d,e;b=w;a.substr(w,
6).toLowerCase()===Ke?(d=a.substr(w,6),w+=6):(d=t,0===M&&c(Le));d!==t?(d=w,M++,e=C(),M--,e===t?d=void 0:(w=d,d=t),d!==t?b="MINUTE":(w=b,b=t)):(w=b,b=t);return b}function xa(){var b,d,e;b=w;a.substr(w,6).toLowerCase()===Me?(d=a.substr(w,6),w+=6):(d=t,0===M&&c(Ne));d!==t?(d=w,M++,e=C(),M--,e===t?d=void 0:(w=d,d=t),d!==t?b="SECOND":(w=b,b=t)):(w=b,b=t);return b}function na(){var b,d,e;b=w;a.substr(w,4).toLowerCase()===Oe?(d=a.substr(w,4),w+=4):(d=t,0===M&&c(Pe));d!==t?(d=w,M++,e=C(),M--,e===t?d=void 0:
(w=d,d=t),d!==t?b="CASE":(w=b,b=t)):(w=b,b=t);return b}function za(){var b,d,e;b=w;a.substr(w,3).toLowerCase()===Qe?(d=a.substr(w,3),w+=3):(d=t,0===M&&c(Re));d!==t?(d=w,M++,e=C(),M--,e===t?d=void 0:(w=d,d=t),d!==t?b="END":(w=b,b=t)):(w=b,b=t);return b}function ia(){var b,d,e;b=w;a.substr(w,4).toLowerCase()===Se?(d=a.substr(w,4),w+=4):(d=t,0===M&&c(Te));d!==t?(d=w,M++,e=C(),M--,e===t?d=void 0:(w=d,d=t),d!==t?b="WHEN":(w=b,b=t)):(w=b,b=t);return b}function la(){var b,d,e;b=w;a.substr(w,4).toLowerCase()===
Ue?(d=a.substr(w,4),w+=4):(d=t,0===M&&c(Ve));d!==t?(d=w,M++,e=C(),M--,e===t?d=void 0:(w=d,d=t),d!==t?b="THEN":(w=b,b=t)):(w=b,b=t);return b}function ta(){var b;44===a.charCodeAt(w)?(b=We,w++):(b=t,0===M&&c(Xe));return b}function ma(){var b;40===a.charCodeAt(w)?(b=Ye,w++):(b=t,0===M&&c(Ze));return b}function sa(){var b;41===a.charCodeAt(w)?(b=$e,w++):(b=t,0===M&&c(af));return b}function P(){var a,b;a=[];for(b=Ja();b!==t;)a.push(b),b=Ja();return a}function Ja(){var b;bf.test(a.charAt(w))?(b=a.charAt(w),
w++):(b=t,0===M&&c(cf));return b}function jb(a,b,c,d){a={type:"binary_expr",operator:a,left:b,right:c};void 0!==d&&(a.escape=d);return a}function Ma(a,b){for(var c=0;c<b.length;c++)a=jb(b[c][1],a,b[c][3]);return a}e=void 0!==e?e:{};var t={},kb={start:h},lb=h,ad="!",bd=m("!",!1),nb="\x3d",ob=m("\x3d",!1),mb="\x3e\x3d",ed=m("\x3e\x3d",!1),fd="\x3e",gd=m("\x3e",!1),pb="\x3c\x3d",hd=m("\x3c\x3d",!1),qb="\x3c\x3e",id=m("\x3c\x3e",!1),jd="\x3c",kd=m("\x3c",!1),rb="!\x3d",ld=m("!\x3d",!1),gc="+",hc=m("+",
!1),ic="-",jc=m("-",!1),md="*",nd=m("*",!1),od="/",pd=m("/",!1),Id=/^[A-Za-z_\x80-\uFFFF]/,Jd=k([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Kd=/^[A-Za-z0-9_]/,Ld=k([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Md=/^[A-Za-z0-9_.\x80-\uFFFF]/,Nd=k([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),Od="@",Pd=m("@",!1),Db=function(a){return{type:"interval-period",period:a.value,precision:null,secondary:null}},Eb=function(a,b){return{type:"interval-period",period:"second",precision:a,
secondary:b}},Fb="'",Gb=m("'",!1),Hb="N'",Yd=m("N'",!1),Za="''",Ib=m("''",!1),Jb=/^[^']/,Kb=k(["'"],!0,!1),ae=".",be=m(".",!1),ge=/^[0-9]/,he=k([["0","9"]],!1,!1),ce=/^[eE]/,de=k(["e","E"],!1,!1),ee=/^[+\-]/,fe=k(["+","-"],!1,!1),ud="null",vd=m("NULL",!0),qd="true",rd=m("TRUE",!0),sd="false",td=m("FALSE",!0),ie="in",je=m("IN",!0),ke="is",le=m("IS",!0),me="like",ne=m("LIKE",!0),cd="escape",dd=m("ESCAPE",!0),oe="not",pe=m("NOT",!0),qe="and",re=m("AND",!0),se="or",te=m("OR",!0),ue="between",ve=m("BETWEEN",
!0),we="from",xe=m("FROM",!0),Ed="for",Fd=m("FOR",!0),Cd="substring",Dd=m("SUBSTRING",!0),Ad="extract",Bd=m("EXTRACT",!0),ye="trim",ze=m("TRIM",!0),Gd="position",Hd=m("POSITION",!0),yd="timestamp",zd=m("TIMESTAMP",!0),wd="date",xd=m("DATE",!0),Qd="leading",Rd=m("LEADING",!0),Sd="trailing",Td=m("TRAILING",!0),Ud="both",Vd=m("BOTH",!0),Wd="to",Xd=m("TO",!0),Ae="interval",Be=m("INTERVAL",!0),Ce="year",De=m("YEAR",!0),Ee="month",Fe=m("MONTH",!0),Ge="day",He=m("DAY",!0),Ie="hour",Je=m("HOUR",!0),Ke="minute",
Le=m("MINUTE",!0),Me="second",Ne=m("SECOND",!0),Oe="case",Pe=m("CASE",!0),Qe="end",Re=m("END",!0),Se="when",Te=m("WHEN",!0),Ue="then",Ve=m("THEN",!0),Zd="else",$d=m("ELSE",!0),We=",",Xe=m(",",!1),Ye="(",Ze=m("(",!1),$e=")",af=m(")",!1),bf=/^[ \t\n\r]/,cf=k([" ","\t","\n","\r"],!1,!1),Tc="`",Uc=m("`",!1),Vc=/^[^`]/,Wc=k(["`"],!0,!1),w=0,Na=[{line:1,column:1}],Aa=0,$a=[],M=0,Ra;if("startRule"in e){if(!(e.startRule in kb))throw Error("Can't start parsing from rule \""+e.startRule+'".');lb=kb[e.startRule]}Ra=
lb();if(Ra!==t&&w===a.length)return Ra;Ra!==t&&w<a.length&&c({type:"end"});throw function(a,b,c){return new f(f.buildMessage(a,b),a,b,c)}($a,Aa<a.length?a.charAt(Aa):null,Aa<a.length?g(Aa,Aa+1):g(Aa,Aa));}}})},"esri/layers/graphics/data/QueryEngine":function(){define("require exports tslib ../../../core/Error ../../../core/lang ../../../core/maybe ../../../core/MemCache ../../../core/promiseUtils ../../../core/SetUtils ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../support/PromiseQueue".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u,v,y,z,A,B,D,C){function E(a){return a.every(function(a){return"exceedslimit"!==a.statisticType})}Object.defineProperty(a,"__esModule",{value:!0});f=function(){return function(a,b,c,d,e){void 0===b&&(b=null);this.attributes=a;this.geometry=c;this.centroid=d;this.filterFlags=e;this.groupId=-1;this.localId=b}}();a.Feature=f;var F=new Set,I=new g.MemCacheStorage(2E6),J=0;f=function(){function a(a){var b=this;this.capabilities={query:v.queryCapabilities};this.geometryType=
a.geometryType;this.hasM=a.hasM;this.hasZ=a.hasZ;this.objectIdField=a.objectIdField;this.spatialReference=a.spatialReference;this.definitionExpression=a.definitionExpression;this.featureStore=a.featureStore;this._changeHandle=this.featureStore.events.on("changed",function(){return b.clearCache()});this.timeInfo=a.timeInfo;a.cacheSpatialQueries&&(this._geometryQueryCache=new g.MemCache(J++ +"$$",I));this.fieldsIndex=new D(a.fields);a.scheduler&&a.task&&(this._frameQueue=new C.default,this._frameTask=
a.scheduler.registerTask(a.task,function(a){return b._update(a)},function(){return 0<b._frameQueue.length}))}a.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null);this.clearCache();this._geometryQueryCache&&this._geometryQueryCache.destroy();this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null);this.fieldsIndex.destroy()};Object.defineProperty(a.prototype,"featureAdapter",{get:function(){return this.featureStore.featureAdapter},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullExtent",{get:function(){var a=this.featureStore.fullBounds;return a?{xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:B.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"timeExtent",{get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:this._timeExtent=A.getTimeExtent(this.timeInfo,this.featureStore):null},enumerable:!0,configurable:!0});
a.prototype.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear();this._timeExtent=this._allItems=null};a.prototype.executeQuery=function(a,b){void 0===a&&(a={});return e.__awaiter(this,void 0,void 0,function(){var b,c,d,f=this;return e.__generator(this,function(e){switch(e.label){case 0:b=k.clone(a),e.label=1;case 1:return e.trys.push([1,8,,9]),[4,this._schedule(function(){return B.normalizeQuery(b,f.definitionExpression,f.spatialReference)})];case 2:return b=e.sent(),
[4,this._reschedule(function(){return f._checkQuerySupport(b)})];case 3:return b=e.sent(),[4,this._reschedule(function(){return f._executeGeometryQuery(b)})];case 4:return c=e.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=e.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=e.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=e.sent(),[3,9];case 8:d=e.sent();if(d!==B.QUERY_ENGINE_EMPTY_RESULT)throw d;
c=new y.default([],null,this);return[3,9];case 9:return[2,c.createQueryResponse(b)]}})})};a.prototype.executeQueryForCount=function(a,b){void 0===a&&(a={});return e.__awaiter(this,void 0,void 0,function(){var b,c,d,f=this;return e.__generator(this,function(e){switch(e.label){case 0:b=k.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,e.label=1;case 1:return e.trys.push([1,8,,9]),[4,this._schedule(function(){return B.normalizeQuery(b,f.definitionExpression,f.spatialReference)})];case 2:return b=
e.sent(),[4,this._reschedule(function(){return f._checkQuerySupport(b)})];case 3:return b=e.sent(),[4,this._reschedule(function(){return f._executeGeometryQuery(b)})];case 4:return c=e.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=e.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=e.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=e.sent(),[2,c.size];case 8:d=e.sent();if(d!==
B.QUERY_ENGINE_EMPTY_RESULT)throw d;return[2,0];case 9:return[2]}})})};a.prototype.executeQueryForExtent=function(a,c){void 0===a&&(a={});return e.__awaiter(this,void 0,void 0,function(){var c,f,g,h,l,m,n,p,q=this;return e.__generator(this,function(e){switch(e.label){case 0:c=k.clone(a),g=c.outSR,e.label=1;case 1:return e.trys.push([1,8,,9]),[4,this._schedule(function(){return B.normalizeQuery(c,q.definitionExpression,q.spatialReference)})];case 2:return c=e.sent(),[4,this._reschedule(function(){return q._checkQuerySupport(c)})];
case 3:return c=e.sent(),c.returnGeometry=!0,c.returnCentroid=!1,c.outSR=null,[4,this._reschedule(function(){return q._executeGeometryQuery(c)})];case 4:return f=e.sent(),[4,this._reschedule(function(){return f.executeObjectIdsQuery(c)})];case 5:return f=e.sent(),[4,this._reschedule(function(){return f.executeTimeQuery(c)})];case 6:return f=e.sent(),[4,this._reschedule(function(){return f.executeAttributesQuery(c)})];case 7:f=e.sent();h=f.size;if(!h)return[2,{count:h,extent:null}];d.set(H,d.NEGATIVE_INFINITY);
this.featureStore.forEachBounds(f.items,function(a){return d.expand(H,a)},G);l={xmin:H[0],ymin:H[1],xmax:H[3],ymax:H[4],spatialReference:B.cleanFromGeometryEngine(this.spatialReference)};this.hasZ&&isFinite(H[2])&&isFinite(H[5])&&(l.zmin=H[2],l.zmax=H[5]);m=u.project(l,f.spatialReference,g);m.spatialReference=B.cleanFromGeometryEngine(g||this.spatialReference);0===m.xmax-m.xmin&&(n=b.getMetersPerUnitForSR(m.spatialReference),m.xmin-=n,m.xmax+=n);0===m.ymax-m.ymin&&(n=b.getMetersPerUnitForSR(m.spatialReference),
m.ymin-=n,m.ymax+=n);this.hasZ&&null!=m.zmin&&null!=m.zmax&&0===m.zmax-m.zmin&&(n=b.getMetersPerUnitForSR(m.spatialReference),m.zmin-=n,m.zmax+=n);return[2,{count:h,extent:m}];case 8:p=e.sent();if(p===B.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw p;case 9:return[2]}})})};a.prototype.executeQueryForIds=function(a,b){void 0===a&&(a={});return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(c){return[2,this.executeQueryForIdSet(a,b).then(function(a){return h.valuesOfSet(a)})]})})};
a.prototype.executeQueryForIdSet=function(a,b){void 0===a&&(a={});return e.__awaiter(this,void 0,void 0,function(){var b,c,d,f,g,h=this;return e.__generator(this,function(e){switch(e.label){case 0:b=k.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,e.label=1;case 1:return e.trys.push([1,9,,10]),[4,this._schedule(function(){return B.normalizeQuery(b,h.definitionExpression,h.spatialReference)})];case 2:return b=e.sent(),[4,this._reschedule(function(){return h._checkQuerySupport(b)})];
case 3:return b=e.sent(),[4,this._reschedule(function(){return h._executeGeometryQuery(b)})];case 4:return c=e.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=e.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=e.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=e.sent(),d=c.items,f=new Set,[4,this._reschedule(function(){for(var a=0,b=d;a<b.length;a++)f.add(c.featureAdapter.getObjectId(b[a]))})];
case 8:return e.sent(),[2,f];case 9:g=e.sent();if(g===B.QUERY_ENGINE_EMPTY_RESULT)return[2,new Set];throw g;case 10:return[2]}})})};a.prototype.executeQueryForLatestObservations=function(a,b){void 0===a&&(a={});return e.__awaiter(this,void 0,void 0,function(){var b,c,d,f=this;return e.__generator(this,function(e){switch(e.label){case 0:if(!this.timeInfo||!this.timeInfo.trackIdField)throw new m("feature-store:unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:a,timeInfo:this.timeInfo});
b=k.clone(a);e.label=1;case 1:return e.trys.push([1,9,,10]),[4,this._schedule(function(){return B.normalizeQuery(b,f.definitionExpression,f.spatialReference)})];case 2:return b=e.sent(),[4,this._reschedule(function(){return f._checkQuerySupport(b)})];case 3:return b=e.sent(),[4,this._reschedule(function(){return f._executeGeometryQuery(b)})];case 4:return c=e.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=e.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];
case 6:return c=e.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=e.sent(),[4,this._reschedule(function(){return c.filterLatest()})];case 8:return c=e.sent(),[3,10];case 9:d=e.sent();if(d!==B.QUERY_ENGINE_EMPTY_RESULT)throw d;c=new y.default([],null,this);return[3,10];case 10:return[2,c.createQueryResponse(b)]}})})};a.prototype._schedule=function(a){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(b){return this._frameQueue?
[2,this._frameQueue.push(a)]:[2,a()]})})};a.prototype._reschedule=function(a){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(b){return this._frameQueue?[2,this._frameQueue.unshift(a)]:[2,a()]})})};a.prototype._update=function(a){for(this._budget=a;!a.done&&this._frameQueue&&this._frameQueue.process();)a.madeProgress();this._budget=null};a.prototype._getAll=function(){if(!this._allItems){var a=[];this.featureStore.forEach(function(b){return a.push(b)});this._allItems=
new y.default(a,null,this)}return this._allItems};a.prototype._executeGeometryQuery=function(a){return e.__awaiter(this,void 0,void 0,function(){var b,c,d,f,g,h,k,m,n,p,r,u,v,x,A,B,E,F,C,D,K=this;return e.__generator(this,function(I){switch(I.label){case 0:b=a.geometry;c=a.outSR;d=a.spatialRel;f=q.isValid(c)&&!q.equals(this.spatialReference,c);if(g=this._geometryQueryCache?f?JSON.stringify({geometry:b,spatialRelationship:d,outSpatialReference:c}):JSON.stringify({geometry:b,spatialRelationship:d}):
null)if(h=this._geometryQueryCache.get(g),!l.isUndefined(h))return[2,h];k=function(b){return e.__awaiter(K,void 0,void 0,function(){var d;return e.__generator(this,function(e){switch(e.label){case 0:return f&&(a.returnGeometry||a.returnCentroid)?[4,b.project(c)]:[3,2];case 1:return d=e.sent(),g&&this._geometryQueryCache.put(g,d,d.size||1),[2,d];case 2:return g&&this._geometryQueryCache.put(g,b,b.size||1),[2,b]}})})};if(!b)return[2,k(this._getAll())];m=this.featureAdapter;if("esriSpatialRelDisjoint"!==
d)return[3,3];n=this._searchFeatures(this._getQueryBBoxes(b));if(!n.length)return[2,k(this._getAll())];u=new Set;v=0;for(x=n;v<x.length;v++)A=x[v],u.add(m.getObjectId(A));return[4,this._reschedule(function(){var a=0;p=Array(u.size);K.featureStore.forEach(function(b){return p[a++]=b});r=u})];case 1:return I.sent(),[4,this._reschedule(function(){return e.__awaiter(K,void 0,void 0,function(){var a,c,f;return e.__generator(this,function(e){switch(e.label){case 0:return[4,z.getSpatialQueryOperator(d,b,
this.geometryType,this.hasZ,this.hasM)];case 1:return a=e.sent(),c=function(b){return!r.has(m.getObjectId(b))||a(m.getGeometry(b))},f=y.default.bind,[4,this._runSpatialFilter(p,c)];case 2:return[2,new (f.apply(y.default,[void 0,e.sent(),b,this]))]}})})})];case 2:return B=I.sent(),[2,k(B)];case 3:return E=this._searchFeatures(this._getQueryBBoxes(b)),E.length?(F=this._canExecuteSoloPass(b,a))?[2,k(new y.default(E,b,this))]:[4,z.getSpatialQueryOperator(d,b,this.geometryType,this.hasZ,this.hasM)]:(B=
new y.default([],b,this),g&&this._geometryQueryCache.put(g,B,B.size||1),[2,B]);case 4:return C=I.sent(),[4,this._runSpatialFilter(E,function(a){return C(m.getGeometry(a))})];case 5:return D=I.sent(),[2,k(new y.default(D,b,this))]}})})};a.prototype._runSpatialFilter=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d,f,g=this;return e.__generator(this,function(h){if(!b)return[2,a];if(!this._budget)return[2,a.filter(function(a){return b(a)})];c=0;d=[];f=function(){return e.__awaiter(g,
void 0,void 0,function(){var g;return e.__generator(this,function(e){switch(e.label){case 0:if(!(c<a.length))return[3,3];g=a[c];b(g)&&d.push(g);return this._budget.done?[4,this._reschedule(function(){return f()})]:[3,2];case 1:e.sent(),e.label=2;case 2:return++c,[3,0];case 3:return[2]}})})};return[2,this._reschedule(function(){return f()}).then(function(){return d})]})})};a.prototype._canExecuteSoloPass=function(a,b){var c=this.geometryType;b=b.spatialRel;return z.canQueryWithRBush(a)&&("esriSpatialRelEnvelopeIntersects"===
b||"esriGeometryPoint"===c&&("esriSpatialRelIntersects"===b||"esriSpatialRelContains"===b||"esriSpatialRelWithin"===b))};a.prototype._getQueryBBoxes=function(a){if(z.canQueryWithRBush(a)){if(r.isExtent(a))return[n.fromValues(a.xmin,a.ymin,a.xmax,a.ymax)];if(r.isPolygon(a))return a.rings.map(function(a){return n.fromValues(Math.min(a[0][0],a[2][0]),Math.min(a[0][1],a[2][1]),Math.max(a[0][0],a[2][0]),Math.max(a[0][1],a[2][1]))})}return[p.getBoundsXY(n.create(),a)]};a.prototype._searchFeatures=function(a){for(var b=
0;b<a.length;b++)this.featureStore.forEachInBounds(a[b],function(a){F.add(a)});var c=Array(F.size),d=0;F.forEach(function(a){return c[d++]=a});F.clear();return c};a.prototype._checkQuerySupport=function(a){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(b){if(0>a.distance||null!=a.geometryPrecision||a.multipatchOption||a.pixelSize||a.relationParam||a.text)throw new m("feature-store:unsupported-query","Unsupported query options",{query:a});return[2,c.all([this._checkAttributesQuerySupport(a),
this._checkStatisticsQuerySupport(a),z.checkSpatialQuerySupport(a,this.geometryType,this.spatialReference),u.checkProjectionSupport(this.spatialReference,a.outSR)]).then(function(){return a})]})})};a.prototype._checkAttributesQuerySupport=function(a){var b=a.outFields,c=a.orderByFields,d=a.returnDistinctValues,e=a.outStatistics,f=e?e.map(function(a){return a.outStatisticFieldName&&a.outStatisticFieldName.toLowerCase()}):[];c&&0<c.length&&(c=c.map(function(a){var b=a.toLowerCase();return-1<b.indexOf(" asc")?
b.split(" asc")[0]:-1<b.indexOf(" desc")?b.split(" desc")[0]:a}).filter(function(a){return-1===f.indexOf(a)}),x.validateFields(this.fieldsIndex,c,"orderByFields contains missing fields"));if(b&&0<b.length)x.validateFields(this.fieldsIndex,b,"outFields contains missing fields");else if(d)throw new m("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:a});x.validateWhere(this.fieldsIndex,a.where)};a.prototype._checkStatisticsQuerySupport=function(a){return e.__awaiter(this,
void 0,void 0,function(){var b,c,d,f,g,h,k,l,n,p,q,r,u;return e.__generator(this,function(e){b=a.outStatistics;c=a.groupByFieldsForStatistics;d=a.having;f=c&&c.length;g=b&&b.length;if(d){if(!f||!g)throw new m("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:a});x.validateHaving(this.fieldsIndex,d,b)}if(g){if(!E(b))return[2];h=b.map(function(a){return a.onStatisticField});x.validateFields(this.fieldsIndex,h,"onStatisticFields contains missing fields");
f&&x.validateFields(this.fieldsIndex,c,"groupByFieldsForStatistics contains missing fields");k=0;for(l=b;k<l.length;k++)if(n=l[k],p=n.onStatisticField,q=n.statisticType,(r="percentile_disc"===q||"percentile_cont"===q)&&"statisticParameters"in n){if(u=n.statisticParameters,!u)throw new m("feature-store:unsupported-query","statisticParamters should be set for percentile type",{definition:n,query:a});}else if("count"!==q&&p&&x.hasInvalidFieldType(p,this.fieldsIndex))throw new m("feature-store:unsupported-query",
"outStatistics contains non-numeric fields",{definition:n,query:a});}return[2]})})};return a}();a.default=f;var G=d.create(),H=d.create()})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});a.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,
supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports tslib ../../../core/MapUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/SetUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./AttributesBuilder ./attributeSupport ./projectionSupport ./timeSupport ./utils".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q){function x(a){return a.substr(24,12)+a.substr(19,4)+a.substr(16,2)+a.substr(14,2)+a.substr(11,2)+a.substr(9,2)+a.substr(6,2)+a.substr(4,2)+a.substr(2,2)+a.substr(0,2)}function u(a,b,c,d){if(c&&"esriFieldTypeDate"===c.type){var e=(new Date(a)).getTime(),f=(new Date(b)).getTime();if(!isNaN(e)&&!isNaN(f))return d?f-e:e-f}return"number"===typeof a&&"number"===typeof b?d?b-a:a-b:"string"===typeof a&&"string"===typeof b?(e=a.toUpperCase(),f=b.toUpperCase(),!c||"esriFieldTypeGUID"!==
c.type&&"esriFieldTypeGlobalID"!==c.type?d=(d?e>f:e<f)?-1:(d?e<f:e>f)?1:0:(a=x(e),f=x(f),d=(d?a>f:a<f)?-1:(d?a<f:a>f)?1:0),d):d?1:-1}Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(a,b,c){this.items=a;this.queryGeometry=b;this.definitionExpression=c.definitionExpression;this.geometryType=c.geometryType;this.hasM=c.hasM;this.hasZ=c.hasZ;this.objectIdField=c.objectIdField;this.spatialReference=c.spatialReference;this.fieldsIndex=c.fieldsIndex;this.timeInfo=c.timeInfo;this.featureAdapter=
c.featureAdapter}Object.defineProperty(a.prototype,"size",{get:function(){return this.items.length},enumerable:!0,configurable:!0});a.prototype.createQueryResponse=function(a){var b;b=a.outStatistics?a.outStatistics.some(function(a){return"exceedslimit"===a.statisticType})?this._createExceedsLimitQueryResponse(a):this._createStatisticsQueryResponse(a):this._createFeatureQueryResponse(a);a.returnQueryGeometry&&(h.isValid(a.outSR)&&!h.equals(this.queryGeometry.spatialReference,a.outSR)?b.queryGeometry=
q.cleanFromGeometryEngine(e.__assign({spatialReference:a.outSR},p.project(this.queryGeometry,this.queryGeometry.spatialReference,a.outSR))):b.queryGeometry=q.cleanFromGeometryEngine(e.__assign({spatialReference:a.outSR},this.queryGeometry)));return b};a.prototype.executeAttributesQuery=function(b){var c=n.getWhereClause(b.where,this.fieldsIndex);if(!c)return l.resolve(this);if(c.isStandardized){for(var d=0,e=[],f=0,g=this.items;f<g.length;f++){var h=g[f];c.testFeature(h,this.featureAdapter)&&(e[d++]=
h)}c=new a(e,this.queryGeometry,this);c.definitionExpression=b.where;return l.resolve(c)}return l.reject(new TypeError("Where clause is not standardized"))};a.prototype.executeObjectIdsQuery=function(b){if(!b.objectIds||!b.objectIds.length)return l.resolve(this);var c=g.SetFromValues(b.objectIds),d=this.featureAdapter.getObjectId;return l.resolve(new a(this.items.filter(function(a){return c.has(d(a))}),this.queryGeometry,this))};a.prototype.executeTimeQuery=function(b){b=r.getTimeOperator(this.timeInfo,
b.timeExtent,this.featureAdapter);if(!k.isSome(b))return l.resolve(this);b=this.items.filter(b);return l.resolve(new a(b,this.queryGeometry,this))};a.prototype.filterLatest=function(){for(var b=this.timeInfo,c=b.trackIdField,d=b.startTimeField,b=b.endTimeField||d,d=new Map,e=this.featureAdapter.getAttribute,f=0,g=this.items;f<g.length;f++){var h=g[f],k=e(h,c),n=e(h,b),p=d.get(k);(!p||n>e(p,b))&&d.set(k,h)}c=m.valuesOfMap(d);return l.resolve(new a(c,this.queryGeometry,this))};a.prototype.project=function(c){return e.__awaiter(this,
void 0,void 0,function(){var d,f,g,k=this;return e.__generator(this,function(e){switch(e.label){case 0:if(!c||h.equals(this.spatialReference,c))return[2,this];d=this.featureAdapter;return[4,p.projectMany(this.items.map(function(a){return q.getGeometry(k.geometryType,k.hasZ,k.hasM,d.getGeometry(a))}),this.spatialReference,c)];case 1:return f=e.sent(),g=f.map(function(a,c){return d.cloneWithGeometry(k.items[c],b.convertFromGeometry(a,k.hasZ,k.hasM))}),[2,new a(g,this.queryGeometry,{definitionExpression:this.definitionExpression,
geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:c,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}})})};a.prototype._sortFeatures=function(a,b,c){if(1<a.length&&b&&b.length){var d=function(b){b=b.split(" ");var d=b[0],f=e.fieldsIndex.get(d),g=b[1]&&"desc"===b[1].toLowerCase();a.sort(function(a,b){a=c(a,d,f);b=c(b,d,f);return u(a,b,f,g)})},e=this,f=0;for(b=b.reverse();f<b.length;f++)d(b[f])}};a.prototype._createFeatureQueryResponse=
function(a){var b=this,d=this.items,f=this.geometryType,g=this.hasM,h=this.hasZ,k=this.objectIdField,l=this.spatialReference,m=a.outFields,n=a.outSR,p=a.quantizationParameters,r=a.resultRecordCount,u=a.resultOffset,v=a.returnZ,x=a.returnM,y=!1;null!=r&&null!=u&&(r=u+r,y=d.length>r,d=d.slice(u,Math.min(d.length,r)));m=m&&(-1<m.indexOf("*")?e.__spreadArrays(this.fieldsIndex.fields):m.map(function(a){return b.fieldsIndex.get(a)}));return{exceededTransferLimit:y,features:this._createFeatures(a,d),fields:m,
geometryType:f,hasM:g&&x,hasZ:h&&v,objectIdFieldName:k,spatialReference:q.cleanFromGeometryEngine(n?n:l),transform:p&&c.toQuantizationTransform(p)||null}};a.prototype._createFeatures=function(a,b){var e=new d.default(a,this.featureAdapter,this.fieldsIndex),f=a.orderByFields,g=a.quantizationParameters,h=a.returnGeometry,k=a.returnCentroid,l=a.maxAllowableOffset,m=a.returnZ;a=a.returnM;var n=this.hasZ&&(void 0===m?!1:m),p=this.hasM&&(void 0===a?!1:a),m=[];a=0;if(h||k)if(g=c.toQuantizationTransform(g),
h&&!k)for(k=0;k<b.length;k++)h=b[k],m[a++]={attributes:e.getAttributes(h),geometry:q.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(h),l,g,n,p)};else if(!h&&k)for(l=0;l<b.length;l++)h=b[l],m[a++]={attributes:e.getAttributes(h),centroid:q.transformCentroid(this,this.featureAdapter.getCentroid(h,this),g)};else for(k=0;k<b.length;k++)h=b[k],m[a++]={attributes:e.getAttributes(h),centroid:q.transformCentroid(this,this.featureAdapter.getCentroid(h,this),g),geometry:q.getGeometry(this.geometryType,
this.hasZ,this.hasM,this.featureAdapter.getGeometry(h),l,g,n,p)};else for(l=0;l<b.length;l++)h=b[l],(n=e.getAttributes(h))&&(m[a++]={attributes:n});this._sortFeatures(m,f,function(a,b,c){return e.getFieldValue(a,b,c)});return m};a.prototype._createExceedsLimitQueryResponse=function(a){var b=!1,c=Number.POSITIVE_INFINITY,d=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,e=0;for(a=a.outStatistics;e<a.length;e++){var f=a[e];if("exceedslimit"===f.statisticType){c=null!=f.maxPointCount?f.maxPointCount:
Number.POSITIVE_INFINITY;d=null!=f.maxRecordCount?f.maxRecordCount:Number.POSITIVE_INFINITY;b=null!=f.maxVertexCount?f.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===this.geometryType)b=this.items.length>c;else if(this.items.length>d)b=!0;else var c=this.hasZ?this.hasM?4:3:this.hasM?3:2,g=this.featureAdapter,b=this.items.reduce(function(a,b){b=g.getGeometry(b);return a+(b&&b.coords.length||0)},0)/c>b;return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",
sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(b)}}]}};a.prototype._createStatisticsQueryResponse=function(a){var b=this,c={attributes:{}},e=[],f=new Map,g=new Map,h=new Map,k=new Map,l=new d.default(a,this.featureAdapter,this.fieldsIndex),n=a.outStatistics,p=a.groupByFieldsForStatistics,q=a.having;a=a.orderByFields;for(var r=p&&p.length,u=!!r,v=u&&p[0],x=u&&!this.fieldsIndex.get(v),y=0;y<n.length;y++){var R=n[y],Q=R.outStatisticFieldName,S=R.statisticType,
U=R,X="exceedslimit"!==S?R.onStatisticField:void 0,V="percentile_disc"===S||"percentile_cont"===S,ca=u&&1===r&&(X===v||x)&&"count"===S;if(u){if(!h.has(X)){for(var R=[],S=0,Y=p;S<Y.length;S++){var aa=this._getAttributeValues(l,Y[S],f);R.push(aa)}h.set(X,this._calculateUniqueValues(R))}var da=h.get(X),R=function(a){var c=da[a];a=c.count;var d=c.data,e=c.items,g=c.itemPositions,c=d.join(",");if(!q||l.validateItems(e,q)){var h=k.get(c)||{attributes:{}},e=null;if(ca)e=a;else{var m=W._getAttributeValues(l,
X,f);a=g.map(function(a){return m[a]});e=V&&"statisticParameters"in U?W._getPercentileValue(U,a):W._getStatisticValue(U,a)}h.attributes[Q]=e;p.forEach(function(a,c){return h.attributes[b.fieldsIndex.get(a)?a:"EXPR_"+(c+1)]=d[c]});k.set(c,h)}},W=this,ea;for(ea in da)R(ea)}else aa=this._getAttributeValues(l,X,f),c.attributes[Q]=V&&"statisticParameters"in U?this._getPercentileValue(U,aa):this._getStatisticValue(U,aa,g);e.push({name:Q,alias:Q,type:"esriFieldTypeDouble"})}c=u?m.valuesOfMap(k):[c];this._sortFeatures(c,
a,function(a,b){return a.attributes[b]});return{fields:e,features:c}};a.prototype._getStatisticValue=function(a,b,c){var d=a.onStatisticField;a=a.statisticType;b=c&&c.has(d)?c.get(d):this._calculateStatistics(b);c&&c.set(d,b);return b["var"===a?"variance":a]};a.prototype._getPercentileValue=function(a,b){var c=a.statisticParameters,d=a.statisticType,f=c.value,g="desc"===c.orderBy,h=this.fieldsIndex.get(a.onStatisticField);a=e.__spreadArrays(b).sort(function(a,b){return u(a,b,h,g)});return this._calculatePercentile(a,
f,"percentile_disc"===d)};a.prototype._getAttributeValues=function(a,b,c){if(c.has(b))return c.get(b);var d=this.fieldsIndex.get(b),e=this.items.map(function(c){return a.getFieldValue(c,b,d)});c.set(b,e);return e};a.prototype._calculateStatistics=function(a){for(var b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d=null,e=null,f=null,g=null,h=[],k=0,l=0;l<a.length;l++){var m=a[l];"string"===typeof m?k++:null==m||isNaN(m)||(d+=m,b=Math.min(b,m),c=Math.max(c,m),h.push(m),k++)}if(k){e=d/k;for(f=
a=0;f<h.length;f++)m=h[f],a+=Math.pow(m-e,2);g=1<k?a/(k-1):0;f=Math.sqrt(g)}else c=b=null;return{avg:e,count:k,max:c,min:b,stddev:f,sum:d,variance:g}};a.prototype._calculateUniqueValues=function(a){for(var b={},c=this.items,d=c.length,e=0;e<d;e++){for(var f=c[e],g=[],h=0,k=a;h<k.length;h++)g.push(k[h][e]);h=g.join(",");null==b[h]?b[h]={count:1,data:g,items:[f],itemPositions:[e]}:(b[h].count++,b[h].items.push(f),b[h].itemPositions.push(e))}return b};a.prototype._calculatePercentile=function(a,b,c){if(0===
a.length)return null;if(0>=b)return a[0];if(1<=b)return a[a.length-1];var d=(a.length-1)*b,e=Math.floor(d);b=e+1;var d=d%1,e=a[e],f=a[b];return b>=a.length||c||"string"===typeof e||"string"===typeof f?e:e*(1-d)+f*d};return a}();a.default=f})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["require","exports","../../../core/maybe","./attributeSupport"],function(f,a,e,m){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(a,e,c){this._fieldDataCache=new Map;this._returnDistinctMap=
new Map;this.returnDistinctValues=a.returnDistinctValues;this.fieldsIndex=c;this.featureAdapter=e;if((a=a.outFields)&&-1===a.indexOf("*")){this.outFields=a;for(var f=e=0;f<a.length;f++){var b=a[f],d=m.getExpressionFromFieldName(b),g=this.fieldsIndex.get(d),d=g?null:m.getWhereClause(d,c),g=g?g.name:m.getAliasFromFieldName(b)||"FIELD_EXP_"+e++;this._fieldDataCache.set(b,{alias:g,clause:d})}}}a.prototype.getAttributes=function(a){a=this._processAttributesForOutFields(a);return this._processAttributesForDistinctValues(a)};
a.prototype.getFieldValue=function(a,e,c){var f=c?c.name:e,b=null;this._fieldDataCache.has(f)?b=this._fieldDataCache.get(f).clause:c||(b=m.getWhereClause(e,this.fieldsIndex),this._fieldDataCache.set(f,{alias:f,clause:b}));return c?this.featureAdapter.getAttribute(a,f):b.calculateValue(a,this.featureAdapter)};a.prototype.validateItem=function(a,e){this._fieldDataCache.has(e)||this._fieldDataCache.set(e,{alias:e,clause:m.getWhereClause(e,this.fieldsIndex)});return this._fieldDataCache.get(e).clause.testFeature(a,
this.featureAdapter)};a.prototype.validateItems=function(a,e){this._fieldDataCache.has(e)||this._fieldDataCache.set(e,{alias:e,clause:m.getWhereClause(e,this.fieldsIndex)});return this._fieldDataCache.get(e).clause.testSet(a,this.featureAdapter)};a.prototype._processAttributesForOutFields=function(a){var e=this.outFields;if(!e||!e.length)return this.featureAdapter.getAttributes(a);for(var c={},f=0;f<e.length;f++){var b=this._fieldDataCache.get(e[f]),d=b.alias,b=b.clause;c[d]=b?b.calculateValue(a,
this.featureAdapter):this.featureAdapter.getAttribute(a,d)}return c};a.prototype._processAttributesForDistinctValues=function(a){if(e.isNone(a)||!this.returnDistinctValues)return a;var f=this.outFields,c=[];if(f)for(var h=0;h<f.length;h++){var b=this._fieldDataCache.get(f[h]).alias;c.push(a[b])}else for(b in a)c.push(a[b]);f=(f||["*"]).join(",")+"\x3d"+c.join(",");c=this._returnDistinctMap.get(f)||0;this._returnDistinctMap.set(f,++c);return 1<c?null:a};return a}();a.default=f})},"esri/layers/graphics/data/timeSupport":function(){define(["require",
"exports"],function(f,a){function e(a,e,c,f,b){if(null!=f&&null!=b&&f===b)return function(b){return f>=a.getAttribute(b,e)&&f<=a.getAttribute(b,c)};if(null!=f&&null!=b)return function(d){var g=a.getAttribute(d,e);d=a.getAttribute(d,c);return!(g>b||d<f)};if(null!=f)return function(b){return!(a.getAttribute(b,c)<f)};if(null!=b)return function(c){return!(a.getAttribute(c,e)>b)}}function m(a,e,c,f){if(null!=c&&null!=f&&c===f)return function(b){return a.getAttribute(b,e)===c};if(null!=c&&null!=f)return function(b){return a.getAttribute(b,
e)>=c&&a.getAttribute(b,e)<=f};if(null!=c)return function(b){return a.getAttribute(b,e)>=c};if(null!=f)return function(b){return a.getAttribute(b,e)<=f}}function k(){return function(){return!1}}Object.defineProperty(a,"__esModule",{value:!0});a.getTimeExtent=function(a,e){if(!a)return null;var c=e.featureAdapter,f=a.startTimeField,b=a.endTimeField,d=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY;if(f&&b)e.forEach(function(a){var e=c.getAttribute(a,f);a=c.getAttribute(a,b);null==e||isNaN(e)||
(d=Math.min(d,e));null==a||isNaN(a)||(g=Math.max(g,a))});else{var k=f||b;e.forEach(function(a){a=c.getAttribute(a,k);null==a||isNaN(a)||(d=Math.min(d,a),g=Math.max(g,a))})}return{start:d,end:g}};a.getTimeOperator=function(a,f,c){if(!f||!a)return null;var g=a.startTimeField;a=a.endTimeField;if(!g&&!a)return null;var b=f.start;f=f.end;return null===b&&null===f?null:void 0===b&&void 0===f?k():g&&a?e(c,g,a,b,f):m(c,g||a,b,f)}})},"esri/layers/graphics/data/utils":function(){define("require exports tslib ../../../core/jsonMap ../../../core/maybe ../../../core/unitUtils ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../centroid ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./spatialQuerySupport".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q){function x(a,b,c,d,e){void 0===d&&(d=a.hasZ);void 0===e&&(e=a.hasM);var f=a.hasZ&&d,g=a.hasM&&e;return c?(a=n.quantizeOptimizedGeometry(B,b,a.hasZ,a.hasM,"esriGeometryPoint",c,d,e),n.convertToPoint(a,f,g)):n.convertToPoint(b,f,g)}function u(b,d,f){return e.__awaiter(this,void 0,void 0,function(){var l,m,n,p,q,u;return e.__generator(this,function(e){switch(e.label){case 0:if(!b)return[2,null];l=b.where;b.where=l=l&&l.trim();if(!l||/^1 *= *1$/.test(l)||d&&d===
l)b.where=null;return b.geometry?[4,v(b)]:[2,b];case 1:return m=e.sent(),b.distance=0,b.units=null,"esriSpatialRelEnvelopeIntersects"===b.spatialRel&&(n=b.geometry.spatialReference,m=g.getGeometryExtent(m),m.spatialReference=n),b.geometry=m,[4,r.checkProjectionSupport(m.spatialReference,f)];case 2:return e.sent(),[4,h.normalizeCentralMeridian(c.fromJSON(m))];case 3:p=e.sent()[0];if(k.isNone(p))throw a.QUERY_ENGINE_EMPTY_RESULT;q=p.toJSON();return[4,r.project(q,q.spatialReference,f)];case 4:u=e.sent();
if(!u)throw a.QUERY_ENGINE_EMPTY_RESULT;u.spatialReference=f;b.geometry=u;return[2,b]}})})}function v(a){return e.__awaiter(this,void 0,void 0,function(){var c,d,f,g,h,k,m,n,p;return e.__generator(this,function(e){switch(e.label){case 0:c=a.geometry;d=a.distance;f=a.units;if(null==d||"vertexAttributes"in c)return[2,c];g=c.spatialReference;h=f?y.fromJSON(f):l.getUnitString(g);k=g&&(b.isGeographic(g)||b.isWebMercator(g));if(!k)return[3,1];n=c;return[3,3];case 1:return[4,r.checkProjectionSupport(g,b.WGS84).then(function(){return r.project(c,
b.WGS84)})];case 2:n=e.sent(),e.label=3;case 3:return m=n,[4,q.getGeodesicBufferOperator()];case 4:return p=e.sent(),[2,p(m.spatialReference,m,d,h)]}})})}Object.defineProperty(a,"__esModule",{value:!0});var y=new m.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});a.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var z=new p.default,A=new p.default,
B=new p.default,D={esriGeometryPoint:n.convertToPoint,esriGeometryPolyline:n.convertToPolyline,esriGeometryPolygon:n.convertToPolygon,esriGeometryMultipoint:n.convertToMultipoint};a.transformCentroid=x;a.getCentroid=function(a,b,c){if("esriGeometryPolygon"!==a.geometryType||!b||!b.centroid&&!b.geometry)return null;b.centroid||(b.centroid=d.getCentroidOptimizedGeometry(new p.default,b.geometry,a.hasZ,a.hasM));return x(a,b.centroid,c)};a.getGeometry=function(a,b,c,d,e,f,g,h){void 0===g&&(g=b);void 0===
h&&(h=c);var k=b&&g,l=c&&h;d=d?"coords"in d?d:d.geometry:null;if(!d)return null;if(e)return b=n.generalizeOptimizedGeometry(A,d,b,c,a,e,g,h),f&&(b=n.quantizeOptimizedGeometry(B,b,k,l,a,f)),D[a](b,k,l);if(f)return b=n.quantizeOptimizedGeometry(B,d,b,c,a,f,g,h),D[a](b,k,l);n.removeZMValues(z,d,b,c,g,h);return D[a](z,k,l)};a.normalizeQuery=function(a,b,c){return e.__awaiter(this,void 0,void 0,function(){var d,f,g,h,k;return e.__generator(this,function(e){d=a.outFields;f=a.orderByFields;g=a.groupByFieldsForStatistics;
h=a.outStatistics;if(d)for(k=0;k<d.length;k++)d[k]=d[k].trim();if(f)for(k=0;k<f.length;k++)f[k]=f[k].trim();if(g)for(k=0;k<g.length;k++)g[k]=g[k].trim();if(h)for(k=0;k<h.length;k++)h[k].onStatisticField&&(h[k].onStatisticField=h[k].onStatisticField.trim());a.geometry&&!a.outSR&&(a.outSR=a.geometry.spatialReference);return[2,u(a,b,c)]})})};a.normalizeFilter=function(a,b,c){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(d){return[2,u(a,b,c)]})})};a.normalizeQueryLike=
u;a.cleanFromGeometryEngine=function(a){return a&&C in a?JSON.parse(JSON.stringify(a,E)):a};var C="_geVersion",E=function(a,b){return a!==C?b:void 0}})},"esri/layers/graphics/centroid":function(){define(["require","exports"],function(f,a){function e(a,e,f,c,h,b){b=h?b?4:3:b?3:2;var d=f,g=f+b,k=0,l=0,m=f=0,x=0,u=0;for(--c;u<c;u++,d+=b,g+=b){var v=e[d],y=e[d+1],z=e[d+2],A=e[g],B=e[g+1],D=e[g+2],C=v*B-A*y,m=m+C,k=k+(v+A)*C,l=l+(y+B)*C;h&&(C=v*D-A*z,f+=(z+D)*C,x+=C);v<a[0]&&(a[0]=v);v>a[1]&&(a[1]=v);
y<a[2]&&(a[2]=y);y>a[3]&&(a[3]=y);h&&(z<a[4]&&(a[4]=z),z>a[5]&&(a[5]=z))}0<m&&(m*=-1);0<x&&(x*=-1);if(!m)return null;a=[k,l,.5*m];h&&(a[3]=f,a[4]=.5*x);return a}function m(a,e,f,c,h){h=c?h?4:3:h?3:2;for(var b=e,d=e+h,g=0,k=0,l=0,m=0,x=0,u=f-1;x<u;x++,b+=h,d+=h){var v=a[b],y=a[b+1],z=a[b+2],A=a[d],B=a[d+1],D=a[d+2],C;if(c){C=A-v;var E=B-y,F=D-z;C=Math.sqrt(C*C+E*E+F*F)}else C=A-v,E=B-y,C=Math.sqrt(C*C+E*E);C&&(g+=C,c?(v=[v+.5*(A-v),y+.5*(B-y),z+.5*(D-z)],k+=C*v[0],l+=C*v[1],m+=C*v[2]):(v=[v+.5*(A-
v),y+.5*(B-y)],k+=C*v[0],l+=C*v[1]))}return 0<g?c?[k/g,l/g,m/g]:[k/g,l/g]:0<f?c?[a[e],a[e+1],a[e+2]]:[a[e],a[e+1]]:null}Object.defineProperty(a,"__esModule",{value:!0});a.getCentroidOptimizedGeometry=function(a,f,g,c){if(!f||!f.lengths.length)return null;a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);for(var h=a.coords,b=[],d=g?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:
[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],k=f.lengths,l=f.coords,r=g?c?4:3:c?3:2,q=0,x=0;x<k.length;x++){var u=k[x],v=e(d,l,q,u,g,c);v&&b.push(v);q+=u*r}b.sort(function(a,b){var c=a[2]-b[2];0===c&&g&&(c=a[4]-b[4]);return c});b.length&&(r=6*b[0][2],h[0]=b[0][0]/r,h[1]=b[0][1]/r,g&&(r=6*b[0][4],h[2]=0!==r?b[0][3]/r:0),h[0]<d[0]||h[0]>d[1]||h[1]<d[2]||h[1]>d[3]||g&&(h[2]<d[4]||h[2]>d[5]))&&(h.length=0);if(!h.length)if(f=f.lengths[0]?m(l,0,k[0],
g,c):null)h[0]=f[0],h[1]=f[1],g&&2<f.length&&(h[2]=f[2]);else return null;return a};a.lineCentroid=m})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports tslib ../../../core/Error ../../../core/promiseUtils ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils @dojo/framework/shim/Promise".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r){function q(){return new Promise(function(a,b){f(["../../../geometry/geometryEngineJSON"],a,b)})}Object.defineProperty(a,"__esModule",{value:!0});var x={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",
esriSpatialRelRelation:null},u={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},v={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},y={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,
esriGeometryPolygon:!0,esriGeometryEnvelope:!1};a.importGeometryEngine=q;a.getGeodesicBufferOperator=function(){return q().then(function(a){return a.geodesicBuffer})};a.getSpatialQueryOperator=function(a,e,f,h,m){if(c.isPolygon(e)&&"esriGeometryPoint"===f&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a)){var p=d.convertFromPolygon(new n.default,e,!1,!1);return k.resolve(function(a){return b.polygonContainsPoint(p,!1,!1,a)})}if(c.isPolygon(e)&&"esriGeometryMultipoint"===f){var u=d.convertFromPolygon(new n.default,
e,!1,!1);if("esriSpatialRelContains"===a)return k.resolve(function(a){return b.polygonContainsMultipoint(u,!1,!1,a,h,m)})}if(c.isExtent(e)&&"esriGeometryPoint"===f&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a))return k.resolve(function(a){return l.extentContainsPoint(e,r.getGeometry(f,h,m,a))});if(c.isExtent(e)&&"esriGeometryMultipoint"===f&&"esriSpatialRelContains"===a)return k.resolve(function(a){return l.extentContainsMultipoint(e,r.getGeometry(f,h,m,a))});if(c.isExtent(e)&&"esriSpatialRelIntersects"===
a){var v=g.getExtentIntersector(f);return k.resolve(function(a){return v(e,r.getGeometry(f,h,m,a))})}return q().then(function(b){var c=b[x[a]].bind(null,e.spatialReference,e);return function(a){return c(r.getGeometry(f,h,m,a))}})};a.checkSpatialQuerySupport=function(a,b,d){return e.__awaiter(this,void 0,void 0,function(){var f,g;return e.__generator(this,function(e){f=a.spatialRel;g=a.geometry;if(!g)return[2];if(!0!==u[f])throw new m("feature-store:unsupported-query","Unsupported query spatial relationship",
{query:a});if(!h.isValid(g.spatialReference)||!h.isValid(d))return[2];if(!0!==v[c.getJsonType(g)])throw new m("feature-store:unsupported-query","Unsupported query geometry type",{query:a});if(!0!==y[b])throw new m("feature-store:unsupported-query","Unsupported layer geometry type",{query:a});return a.outSR?[2,p.checkProjectionSupport(a.geometry&&a.geometry.spatialReference,a.outSR)]:[2]})})};a.canQueryWithRBush=function(a){if(c.isExtent(a))return!0;if(c.isPolygon(a)){var b=0;for(a=a.rings;b<a.length;b++){var d=
a[b];if(5!==d.length||d[0][0]!==d[1][0]||d[0][0]!==d[4][0]||d[2][0]!==d[3][0]||d[0][1]!==d[3][1]||d[0][1]!==d[4][1]||d[1][1]!==d[2][1])return!1}return!0}return!1}})},"esri/layers/graphics/contains":function(){define(["require","exports"],function(f,a){function e(a,e,f,g,c){if(!a)return!1;e=e?f?4:3:f?3:2;f=a.coords;var h=!1,b=0,d=0;for(a=a.lengths;d<a.length;d++){for(var k=a[d],l=b,m=b,q=b+k*e;m<q;m+=e){l=m+e;l===q&&(l=b);var x=f[m],u=f[m+1],v=f[l],l=f[l+1];(u<c&&l>=c||l<c&&u>=c)&&x+(c-u)/(l-u)*(v-
x)<g&&(h=!h)}b+=k*e}return h}Object.defineProperty(a,"__esModule",{value:!0});a.polygonContainsPoint=function(a,f,l,g){return e(a,f,l,g.coords[0],g.coords[1])};a.polygonContainsMultipoint=function(a,f,l,g,c,h){c=c?h?4:3:h?3:2;h=g.coords;g=g.lengths;if(!g)return!1;for(var b=0,d=0;b<g.length;b++,d+=c)if(!e(a,f,l,h[d],h[d+1]))return!1;return!0};a.polygonContainsCoords=e})},"esri/layers/support/PromiseQueue":function(){define(["require","exports","../../core/promiseUtils"],function(f,a,e){Object.defineProperty(a,
"__esModule",{value:!0});f=function(){function a(){this._tasks=[]}Object.defineProperty(a.prototype,"length",{get:function(){return this._tasks.length},enumerable:!0,configurable:!0});a.prototype.push=function(a){var f=this;return e.create(function(c,e){return f._tasks.push(new m(c,e,a))})};a.prototype.unshift=function(a){var f=this;return e.create(function(c,e){return f._tasks.unshift(new m(c,e,a))})};a.prototype.process=function(){if(0===this._tasks.length)return!1;var a=this._tasks.shift();try{var e=
a.callback();e&&"then"in e&&"function"===typeof e.then?e.then(a.resolve,a.reject):a.resolve(e)}catch(c){a.reject(c)}return!0};a.prototype.cancelAll=function(){for(var a=e.createAbortError(),f=0,c=this._tasks;f<c.length;f++)c[f].reject(a);this._tasks.length=0};return a}();a.default=f;var m=function(){return function(a,e,f){this.resolve=a;this.reject=e;this.callback=f}}()})},"esri/tasks/support/Query":function(){define("require exports tslib ../../geometry ../../geometry ../../symbols ../../TimeExtent ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../geometry/support/jsonUtils ../../symbols/support/jsonUtils ./QuantizationParameters ./StatisticDefinition".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x){var u=new c.default({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),v=new c.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",
esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});return function(a){function c(b){b=a.call(this,b)||this;b.cacheHint=void 0;b.datumTransformation=null;b.distance=void 0;b.gdbVersion=null;b.geometry=null;b.geometryPrecision=void 0;b.groupByFieldsForStatistics=null;b.having=null;b.historicMoment=null;b.maxAllowableOffset=void 0;b.maxRecordCountFactor=1;b.multipatchOption=null;b.num=void 0;b.objectIds=null;
b.orderByFields=null;b.outFields=null;b.outSpatialReference=null;b.outStatistics=null;b.parameterValues=null;b.pixelSize=null;b.quantizationParameters=null;b.rangeValues=null;b.relationParameter=null;b.resultType=null;b.returnCentroid=!1;b.returnDistinctValues=!1;b.returnExceededLimitFeatures=!0;b.returnGeometry=!1;b.returnQueryGeometry=!1;b.returnM=void 0;b.returnZ=void 0;b.source=null;b.spatialRelationship="intersects";b.start=void 0;b.sqlFormat=null;b.text=null;b.timeExtent=null;b.units=null;b.where=
null;return b}e.__extends(c,a);f=c;c.from=function(a){return n.ensureClass(f,a)};c.prototype.castDatumTransformation=function(a){return"number"===typeof a||"object"===typeof a?a:null};c.prototype.writeHistoricMoment=function(a,b){b.historicMoment=a&&a.getTime()};c.prototype.writeParameterValues=function(a,b){if(a){var c={},d;for(d in a){var e=a[d];Array.isArray(e)?c[d]=e.map(function(a){return a instanceof Date?a.getTime():a}):c[d]=e instanceof Date?e.getTime():e}b.parameterValues=c}};c.prototype.writeStart=
function(a,b){b.resultOffset=this.start;b.resultRecordCount=this.num||10;b.where="1\x3d1"};c.prototype.writeWhere=function(a,b){b.where=a||"1\x3d1"};c.prototype.clone=function(){return new f(b.clone({cacheHint:this.cacheHint,datumTransformation:this.datumTransformation,distance:this.distance,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:this.historicMoment?new Date(this.historicMoment.getTime()):
null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,
returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,source:this.source,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,units:this.units,where:this.where}))};var f;c.MAX_MAX_RECORD_COUNT_FACTOR=5;e.__decorate([d.property({type:Boolean,
json:{write:{writer:function(a,b){null!=a&&(b.cacheHint=a)}}}})],c.prototype,"cacheHint",void 0);e.__decorate([d.property({json:{write:!0}})],c.prototype,"datumTransformation",void 0);e.__decorate([d.cast("datumTransformation")],c.prototype,"castDatumTransformation",null);e.__decorate([d.property({type:Number,json:{write:{overridePolicy:function(a){return{enabled:0<a}}}}})],c.prototype,"distance",void 0);e.__decorate([d.property({type:String,json:{write:!0}})],c.prototype,"gdbVersion",void 0);e.__decorate([d.property({types:k.geometryTypes,
json:{read:p.fromJSON,write:!0}})],c.prototype,"geometry",void 0);e.__decorate([d.property({type:Number,json:{write:!0}})],c.prototype,"geometryPrecision",void 0);e.__decorate([d.property({type:[String],json:{write:!0}})],c.prototype,"groupByFieldsForStatistics",void 0);e.__decorate([d.property({type:String,json:{write:!0}})],c.prototype,"having",void 0);e.__decorate([d.property({type:Date})],c.prototype,"historicMoment",void 0);e.__decorate([d.writer("historicMoment")],c.prototype,"writeHistoricMoment",
null);e.__decorate([d.property({type:Number,json:{write:!0}})],c.prototype,"maxAllowableOffset",void 0);e.__decorate([d.property({type:Number,cast:function(a){return 1>a?1:a>f.MAX_MAX_RECORD_COUNT_FACTOR?f.MAX_MAX_RECORD_COUNT_FACTOR:a},json:{write:{overridePolicy:function(a){return{enabled:1<a}}}}})],c.prototype,"maxRecordCountFactor",void 0);e.__decorate([d.property({type:String,json:{write:!0}})],c.prototype,"multipatchOption",void 0);e.__decorate([d.property({type:Number,json:{read:{source:"resultRecordCount"}}})],
c.prototype,"num",void 0);e.__decorate([d.property({type:[Number],json:{write:!0}})],c.prototype,"objectIds",void 0);e.__decorate([d.property({type:[String],json:{write:!0}})],c.prototype,"orderByFields",void 0);e.__decorate([d.property({type:[String],json:{write:!0}})],c.prototype,"outFields",void 0);e.__decorate([d.property({type:m.SpatialReference,json:{read:{source:"outSR"},write:{target:"outSR"}}})],c.prototype,"outSpatialReference",void 0);e.__decorate([d.property({type:[x],json:{write:!0}})],
c.prototype,"outStatistics",void 0);e.__decorate([d.property({json:{write:!0}})],c.prototype,"parameterValues",void 0);e.__decorate([d.writer("parameterValues")],c.prototype,"writeParameterValues",null);e.__decorate([d.property({types:l.symbolTypes,json:{read:r.read,write:!0}})],c.prototype,"pixelSize",void 0);e.__decorate([d.property({type:q.default,json:{write:!0}})],c.prototype,"quantizationParameters",void 0);e.__decorate([d.property({type:[Object],json:{write:!0}})],c.prototype,"rangeValues",
void 0);e.__decorate([d.property({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy:function(){return{enabled:"relation"===this.spatialRelationship}}}}})],c.prototype,"relationParameter",void 0);e.__decorate([d.property({type:String,json:{write:!0}})],c.prototype,"resultType",void 0);e.__decorate([d.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],c.prototype,"returnCentroid",void 0);e.__decorate([d.property({type:Boolean,
json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],c.prototype,"returnDistinctValues",void 0);e.__decorate([d.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:!a}}}}})],c.prototype,"returnExceededLimitFeatures",void 0);e.__decorate([d.property({type:Boolean,json:{write:!0}})],c.prototype,"returnGeometry",void 0);e.__decorate([d.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],c.prototype,"returnQueryGeometry",void 0);
e.__decorate([d.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],c.prototype,"returnM",void 0);e.__decorate([d.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],c.prototype,"returnZ",void 0);e.__decorate([d.property({json:{write:!0}})],c.prototype,"source",void 0);e.__decorate([d.property({type:String,json:{read:{source:"spatialRel",reader:u.read},write:{target:"spatialRel",writer:u.write}}})],c.prototype,"spatialRelationship",
void 0);e.__decorate([d.property({type:Number,json:{read:{source:"resultOffset"}}})],c.prototype,"start",void 0);e.__decorate([d.writer("start"),d.writer("num")],c.prototype,"writeStart",null);e.__decorate([d.property({type:String,json:{write:!0}})],c.prototype,"sqlFormat",void 0);e.__decorate([d.property({type:String,json:{write:!0}})],c.prototype,"text",void 0);e.__decorate([d.property({type:g,json:{write:!0}})],c.prototype,"timeExtent",void 0);e.__decorate([d.property({type:String,json:{read:v.read,
write:{writer:v.write,overridePolicy:function(a){return{enabled:a&&0<this.distance}}}}})],c.prototype,"units",void 0);e.__decorate([d.property({type:String,json:{write:{overridePolicy:function(a){return{enabled:null!=a||0<this.start}}}}})],c.prototype,"where",void 0);e.__decorate([d.writer("where")],c.prototype,"writeWhere",null);return c=f=e.__decorate([d.subclass("esri.tasks.support.Query")],c)}(h.JSONSupport)})},"esri/TimeExtent":function(){define("require exports tslib ./core/JSONSupport ./core/accessorSupport/decorators ./layers/support/timeUtils".split(" "),
function(f,a,e,m,k,l){f=function(a){function b(b){b=a.call(this,b)||this;b.end=null;b.start=null;return b}e.__extends(b,a);d=b;Object.defineProperty(b,"allTime",{get:function(){return g},enumerable:!0,configurable:!0});Object.defineProperty(b,"empty",{get:function(){return c},enumerable:!0,configurable:!0});b.prototype.readEnd=function(a,b){return null!=b.end?new Date(b.end):null};b.prototype.writeEnd=function(a,b){b.end=a?a.getTime():null};Object.defineProperty(b.prototype,"isAllTime",{get:function(){return this.equals(d.allTime)},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isEmpty",{get:function(){return this.equals(d.empty)},enumerable:!0,configurable:!0});b.prototype.readStart=function(a,b){return null!=b.start?new Date(b.start):null};b.prototype.writeStart=function(a,b){b.start=a?a.getTime():null};b.prototype.clone=function(){return new d({end:this.end,start:this.start})};b.prototype.intersection=function(a){var b,c,e,f,g,h,k,l;if(!a)return this.clone();if(this.isEmpty||a.isEmpty)return d.empty;if(this.isAllTime)return a.clone();
if(a.isAllTime)return this.clone();var m=null!==(c=null===(b=this.start)||void 0===b?void 0:b.getTime())&&void 0!==c?c:-Infinity;b=null!==(f=null===(e=this.end)||void 0===e?void 0:e.getTime())&&void 0!==f?f:Infinity;e=null!==(h=null===(g=a.start)||void 0===g?void 0:g.getTime())&&void 0!==h?h:-Infinity;a=null!==(l=null===(k=a.end)||void 0===k?void 0:k.getTime())&&void 0!==l?l:Infinity;var n,D;e>=m&&e<=b?n=e:m>=e&&m<=a&&(n=m);b>=e&&b<=a?D=b:a>=m&&a<=b&&(D=a);return isNaN(n)||isNaN(D)?d.empty:(k=new d,
k.start=-Infinity===n?null:new Date(n),k.end=Infinity===D?null:new Date(D),k)};b.prototype.offset=function(a,b){if(this.isEmpty||this.isAllTime)return this.clone();var c=new d,e=this.start,f=this.end;e&&(c.start=l.offsetDate(e,a,b));f&&(c.end=l.offsetDate(f,a,b));return c};b.prototype.equals=function(a){if(!a)return!1;var b=this.start?this.start.getTime():this.start,c=this.end?this.end.getTime():this.end,d=a.start?a.start.getTime():a.start;a=a.end?a.end.getTime():a.end;return b===d&&c===a};var d;
e.__decorate([k.property({type:Date,json:{write:{allowNull:!0}}})],b.prototype,"end",void 0);e.__decorate([k.reader("end")],b.prototype,"readEnd",null);e.__decorate([k.writer("end")],b.prototype,"writeEnd",null);e.__decorate([k.property({dependsOn:["start","end"],readOnly:!0,json:{read:!1}})],b.prototype,"isAllTime",null);e.__decorate([k.property({dependsOn:["start","end"],readOnly:!0,json:{read:!1}})],b.prototype,"isEmpty",null);e.__decorate([k.property({type:Date,json:{write:{allowNull:!0}}})],
b.prototype,"start",void 0);e.__decorate([k.reader("start")],b.prototype,"readStart",null);e.__decorate([k.writer("start")],b.prototype,"writeStart",null);return b=d=e.__decorate([k.subclass("esri.TimeExtent")],b)}(m.JSONSupport);var g=new f,c=new f({start:void 0,end:void 0});return f})},"esri/layers/support/timeUtils":function(){define(["require","exports","../../TimeExtent","../../core/compilerUtils","../../core/jsonMap"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});a.Milliseconds=
function(a){return a};var l={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",multiplier:1},days:{getter:"getDate",setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",
multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",multiplier:100}};a.timeUnitKebabDictionary=k.strict()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:null});
a.offsetDate=function(a,c,e){a=new Date(a.getTime());if(c&&e){e=l[e];var b=e.multiplier;a[e.setter](a[e.getter]()+c*b)}return a};a.combinedViewLayerTimeExtentProperty={type:e,dependsOn:"view.timeExtent layer.timeExtent layer.timeInfo layer.timeOffset layer.timeOffset.value layer.timeOffset.unit layer.useViewTime".split(" "),readOnly:!0,get:function(){var a,c;if(null===(a=this.layer)||void 0===a||!a.timeInfo)return null;a=null===(c=this.view)||void 0===c?void 0:c.timeExtent;c=this.layer.timeExtent;
c=this.layer.useViewTime?a&&c?a.intersection(c):a||c:c;if(!c||c.isEmpty)return c;c=(a=this.layer.timeOffset)?c.offset(-a.value,a.unit):c;a=this._get("timeExtent");return c.equals(a)?a:c}};a.millisecondsPerTimeUnit={milliseconds:1,seconds:1E3,minutes:6E4,hours:36E5,days:864E5,weeks:6048E5,months:26784E5,years:31536E6,decades:31536E7,centuries:31536E8};a.truncateDate=function(a,c){switch(c){case "milliseconds":return new Date(a.getTime());case "seconds":return new Date(a.getFullYear(),a.getMonth(),
a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds());case "minutes":return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes());case "hours":return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours());case "days":return new Date(a.getFullYear(),a.getMonth(),a.getDate());case "weeks":return new Date(a.getFullYear(),a.getMonth(),a.getDate()-a.getDay());case "months":return new Date(a.getFullYear(),a.getMonth(),1);case "years":return new Date(a.getFullYear(),0,
1);case "decades":return new Date(a.getFullYear()-a.getFullYear()%10,0,1);case "centuries":return new Date(a.getFullYear()-a.getFullYear()%100,0,1);default:return m.neverReached(c),null}}})},"esri/tasks/support/StatisticDefinition":function(){define("require exports tslib ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators".split(" "),function(f,a,e,m,k,l,g){var c=new m.default({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",
exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete"});return function(a){function b(b){b=a.call(this,b)||this;b.maxPointCount=void 0;b.maxRecordCount=void 0;b.maxVertexCount=void 0;b.onStatisticField=null;b.outStatisticFieldName=null;b.statisticType=null;b.statisticParameters=null;return b}e.__extends(b,a);d=b;b.prototype.writeStatisticParameters=function(a,b){if("percentile-continuous"===this.statisticType||"percentile-discrete"===this.statisticType)b.statisticParameters=
l.clone(a)};b.prototype.clone=function(){return new d({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:l.clone(this.statisticParameters)})};var d;e.__decorate([g.property({type:Number,json:{write:!0}})],b.prototype,"maxPointCount",void 0);e.__decorate([g.property({type:Number,json:{write:!0}})],b.prototype,
"maxRecordCount",void 0);e.__decorate([g.property({type:Number,json:{write:!0}})],b.prototype,"maxVertexCount",void 0);e.__decorate([g.property({type:String,json:{write:!0}})],b.prototype,"onStatisticField",void 0);e.__decorate([g.property({type:String,json:{write:!0}})],b.prototype,"outStatisticFieldName",void 0);e.__decorate([g.property({type:String,json:{read:{source:"statisticType",reader:c.read},write:{target:"statisticType",writer:c.write}}})],b.prototype,"statisticType",void 0);e.__decorate([g.property({type:Object})],
b.prototype,"statisticParameters",void 0);e.__decorate([g.writer("statisticParameters")],b.prototype,"writeStatisticParameters",null);return b=d=e.__decorate([g.subclass("esri.tasks.support.StatisticDefinition")],b)}(k.JSONSupport)})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require exports tslib ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../layers/support/FieldsIndex ../../../../../support/arcadeOnDemand ../../../engine ../../../arcade/utils ../../../engine/webgl/definitions ../tileRenderers/support/visualVariablesUtils @dojo/framework/shim/Promise".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q){Object.defineProperty(a,"__esModule",{value:!0});var x=l.getLogger("esri.views.layers.2d.features.support.AttributeStore"),u=n.debug.createDebugLogger(n.debug.DEBUG_ATTR_UPDATES,x);a.LOCAL_ID_TYPE_AGGREGATE=1;a.isAggregateId=function(b){return(b&2147483648)>>>31===a.LOCAL_ID_TYPE_AGGREGATE};var v=function(a,b){return function(c,d,e){var f;try{f=b(c,d,e)}catch(H){f=NaN}return(null===f||isNaN(f)||Infinity===f)&&a||f}},y=k("esri-shared-array-buffer"),z=k("esri-webgl-texture-float"),
A=k("esri-webgl-max-texture-size"),B=k("esri-atomics"),D=function(){function a(a,b,c,d){this.texelSize=4;var e=d.pixelType,f=d.layout;this.textureOnly=(d=d.textureOnly)||!1;this.pixelType=e;this._ctype=b;this.layout=f;this._resetRange();this._shared=a;d||(this.data=this._initData(e,c,a,b))}Object.defineProperty(a.prototype,"buffer",{get:function(){return c.andThen(this.data,function(a){return a.buffer})},enumerable:!0,configurable:!0});a.prototype.getData=function(a,b){a&=2147483647;return c.unwrap(this.data)[a*
this.texelSize+b]};a.prototype.setData=function(a,b,c){a&=2147483647;0===(this.layout&1<<b)?x.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):(this.data[a*this.texelSize+b]=c,this.dirtyStart=Math.min(this.dirtyStart,a),this.dirtyEnd=Math.max(this.dirtyEnd,a))};a.prototype.lock=function(){5121===this.pixelType&&this._shared&&B&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};a.prototype.unlock=function(){5121===this.pixelType&&this._shared&&B&&"local"!==
this._ctype&&Atomics.store(this.data,0,0)};a.prototype.expand=function(a){if(!this.textureOnly){a=this._initData(this.pixelType,a,this._shared,this._ctype);var b=c.unwrap(this.data);a.set(b);this.data=a}};a.prototype.toMessage=function(){var a=this.dirtyStart,b=this.dirtyEnd,d=this.texelSize;if(a>b)return null;this._resetRange();var e=!this._shared&&"local"!==this._ctype,f=this.pixelType,g=this.layout,h=c.unwrap(this.data);if(!h.slice){if(!e)return{start:a,end:b,data:null,pixelType:f,layout:g};d=
new (n.Utils.getPixelArrayCtor(this.pixelType))(Array.prototype.slice.call(this.data,a*d,(b+1)*d));return{start:a,end:b,data:d,pixelType:f,layout:g}}d=e&&h.slice(a*d,(b+1)*d)||null;return{start:a,end:b,data:d,pixelType:f,layout:g}};a.prototype._initData=function(a,b,c,d){c=c&&"local"!==d?SharedArrayBuffer:ArrayBuffer;a=n.Utils.getPixelArrayCtor(a);b=new a(new c(b*b*4*a.BYTES_PER_ELEMENT));for(a=0;a<b.length;a+=4)b[a+1]=255;return b};a.prototype._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=
0};return a}();k=function(){function k(a){this._attributeComputeMap=new Map;this._blocks=[];this._idMap=new Map;this._localToObjectId=new Map;this._filters=Array(n.definitions.MAX_FILTERS);this._freeTexelsList=[];this._abortController=h.createAbortController();this._hasScaleExpr=!1;this._size=32;this._idCounter=1;this._idsToHighlight=new Set;var b=z?5126:5121;u("Creating AttributeStore "+(y?"with":"without")+" shared memory");this._client=a;this._blockDescriptors=[{pixelType:5121,layout:1},{pixelType:5121,
layout:15,textureOnly:!0},{pixelType:b,layout:15},{pixelType:b,layout:15}];this._blocks=this._blockDescriptors.map(function(){return null})}k.prototype.destroy=function(){this._abortController.abort()};Object.defineProperty(k.prototype,"hasScaleExpr",{get:function(){return this._hasScaleExpr},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"_signal",{get:function(){return this._abortController.signal},enumerable:!0,configurable:!0});k.prototype.invalidateResources=function(){this._createResourcesPromise=
null;this._abortController.abort();this._abortController=h.createAbortController()};k.prototype.createLocalId=function(a,b){void 0===b&&(b=!1);if(!this._idMap.has(a)){var c=this._getFreeTexel();b=((b?2147483648:0)|c)>>>0;this._idMap.set(a,-1===b?0:b);this._localToObjectId.set(b,a)}return this._idMap.get(a)};k.prototype.addLocalId=function(a){this._getBlock(0).setData(a,0,0);this._freeTexelsList.push(a&2147483647)};k.prototype.removeLocalId=function(a){var b=this._idMap.get(a);this._idMap.delete(a);
this._localToObjectId.delete(b);return b};k.prototype.freeLocalId=function(a){var b=this._idMap.get(a);this._getBlock(0).setData(b,0,0);this._idMap.delete(a);this._localToObjectId.delete(b);this._freeTexelsList.push(b&2147483647)};k.prototype.getFeatureId=function(a){return this._localToObjectId.get(a)};k.prototype.getLocalId=function(a){return this._idMap.has(a)?this._idMap.get(a):null};k.prototype.setHighlight=function(a){return e.__awaiter(this,void 0,void 0,function(){var b,c,d,f,g,h,k=this;return e.__generator(this,
function(e){switch(e.label){case 0:this._getBlock(0).lock();this._idsToHighlight.forEach(function(a){if(a=k.getLocalId(a)){var b=k._getBlock(0).getData(a,0);k._getBlock(0).setData(a,0,b&-2)}});this._idsToHighlight.clear();b=0;for(c=a;b<c.length;b++)d=c[b],this._idsToHighlight.add(d);for(f=0;f<a.length;f++)g=this.getLocalId(a[f]),null!=g&&(h=this._getBlock(0).getData(g,0),this._getBlock(0).setData(g,0,h|1));this._getBlock(0).unlock();return[4,this.sendUpdates()];case 1:return e.sent(),[2]}})})};k.prototype.addHighlight=
function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(a){return[2]})})};k.prototype.removeHighlight=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(a){return[2]})})};k.prototype.updateFilters=function(a){return e.__awaiter(this,void 0,void 0,function(){var b,c,d,f,g,k=this;return e.__generator(this,function(e){switch(e.label){case 0:return b=a.config,c=a.service,d=a.spatialReference,f=b.filters,g=f.map(function(b,
e){return k._updateFilter(a,b,e,c,d)}),[4,h.all(g)];case 1:return e.sent(),[2]}})})};k.prototype.setAttributeBindings=function(a,b){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(c){this._hasScaleExpr=!1;switch(a.type){case "simple":case "class-breaks":case "unique-value":case "dictionary":return[2,this._bindVVEvaluators(a.visualVariables,b)];case "dot-density":return[2,this._bindDDEvaluators(a.attributes,b)];case "heatmap":break;default:x.error(new m("attribute-store",
"Found invalid renderer type: "+a))}return[2]})})};k.prototype.setData=function(a,b,c,d){this._getBlock(b).setData(a,c,d)};k.prototype.getData=function(a,b,c){return this._getBlock(b).getData(a,c)};k.prototype.getHighlightFlag=function(a){return this._idsToHighlight.has(a)?r.HIGHLIGHT_FLAG:0};k.prototype.setAttributeData=function(a,b,c,d){var e=this;this._getBlock(0).setData(a,0,this.getFilterFlags(b));var f=z?1:2;this._attributeComputeMap.forEach(function(h,k){var l=k*f%4;k=e._getBlock(Math.floor(k*
f/4)+r.ATTRIBUTE_DATA_VV);h=h(b,{$view:d},c);if(z)k.setData(a,l,h);else if(h===n.definitions.NAN_MAGIC_NUMBER)k.setData(a,l,255),k.setData(a,l+1,255);else{h=g.clamp(Math.round(h),-32767,32766)+32768;var m=(h&65280)>>8;k.setData(a,l,h&255);k.setData(a,l+1,m)}})};k.prototype.sendUpdates=function(){var a=this;if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=h.createResolver(),this._nextUpdate.promise;var b={blocks:this._blocks.map(function(a){return c.isSome(a)?
a.toMessage():null})};return this._currUpdate=this._createResources().then(function(){var c=function(){a._currUpdate=null;if(a._nextUpdate){var b=a._nextUpdate;a._nextUpdate=null;a.sendUpdates().then(function(){return b.resolve()})}},c=a._client.update(b,a._signal).then(c).catch(c);a._client.render();return c}).catch(function(b){if(h.isAbortError(b))return a._createResourcesPromise=null,a._createResources();x.error(new m("mapview-attribute-store","Encountered an error during client update",b));return h.resolve()})};
k.prototype._createResources=function(){var a=this;if(c.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(r.ATTRIBUTE_DATA_ANIMATION);u("Initializing AttributeStore");var b={shared:y&&"local"!==this._client.type,size:this._size,blocks:c.mapMany(this._blocks,function(a){return{textureOnly:a.textureOnly,buffer:a.buffer,pixelType:a.pixelType}})};this._createResourcesPromise=b=this._client.initialize(b,this._signal).catch(function(b){h.isAbortError(b)?a._createResourcesPromise=
null:x.error(new m("mapview-attribute-store","Encountered an error during client initialization",b))});b.then(function(){return c.isNone(a._createResourcesPromise)?a._createResources():void 0});return b};k.prototype._getBlock=function(a){var b=this._blocks[a];if(c.isSome(b))return b;u("Initializing AttributeBlock at index "+a);b=new D(y,this._client.type,this._size,this._blockDescriptors[a]);this._blocks[a]=b;this._createResourcesPromise=null;return b};k.prototype._expand=function(){if(this._size<
A){var a=this._size<<=1;u("Expanding block size to",a,this._blocks);c.forEachSome(this._blocks,function(b){return b.expand(a)});this._createResourcesPromise=null;this._size=a;return 0}x.error(new m("mapview-limitations","Maximum number of onscreen features exceeded."));return-1};k.prototype._getFreeTexel=function(){return this._freeTexelsList.length?this._freeTexelsList.pop():this._idCounter>=this._size*this._size&&this._expand()?-1:this._idCounter++};k.prototype._updateFilter=function(b,d,f,g,h){return e.__awaiter(this,
void 0,void 0,function(){var k,l,m,n,p,q,r,u,v,x=this;return e.__generator(this,function(e){switch(e.label){case 0:k=this._filters[f];l=c.isSome(k)&&k.hash;if(l===JSON.stringify(d))return[2];m=1<<f+1;return c.isNone(d)?(this._filters[f]=null,this._idMap.forEach(function(a){var b=x._getBlock(0).getData(a,0);x._getBlock(0).setData(a,0,b|m)}),[2]):[4,b.queryObjectIds(d)];case 1:return n=e.sent(),d.hiddenIds&&d.hiddenIds.length&&(n=n.filter(function(a){return-1===d.hiddenIds.indexOf(a)})),p=n.map(function(a){return x._idMap.get(a)}),
[4,this._getFilter(f,g)];case 2:q=e.sent();q.update(d,h);this._getBlock(0).lock();this._idMap.forEach(function(b){if((b&2147483648)>>>31!==a.LOCAL_ID_TYPE_AGGREGATE){var c=x._getBlock(0).getData(b,0);x._getBlock(0).setData(b,0,c&~m)}});for(r=0;r<p.length;r++)u=p[r],null!=u&&(v=this._getBlock(0).getData(u,0),this._getBlock(0).setData(u,0,v|m));this._getBlock(0).unlock();return[2]}})})};k.prototype._getFilter=function(a,d){return e.__awaiter(this,void 0,void 0,function(){var g,h,k;return e.__generator(this,
function(e){switch(e.label){case 0:return g=this._filters[a],c.isSome(g)?[2,g]:[4,new Promise(function(a,b){f(["../../../../../layers/graphics/data/FeatureFilter"],a,b)})];case 1:return h=e.sent().default,k=new h({geometryType:d.geometryType,hasM:!1,hasZ:!1,timeInfo:d.timeInfo,fieldsIndex:new b(d.fields)}),this._filters[a]=k,[2,k]}})})};k.prototype.isVisible=function(a){return!!(this._getBlock(0).getData(a.localId,0)&2)};k.prototype.getFilterFlags=function(b){for(var d=0,e=(b.localId&2147483648)>>>
31===a.LOCAL_ID_TYPE_AGGREGATE?254:255,f=0;f<this._filters.length;f++)var g=this._filters[f],g=!(e&1<<f)||c.isNone(g)||g.check(b),d=d|(g?1:0)<<f;b=this.getFeatureId(b.localId);return d<<1|this.getHighlightFlag(b)};k.prototype._bindVVEvaluators=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var d,f=this;return e.__generator(this,function(g){switch(g.label){case 0:this._attributeComputeMap.clear();if(!c.isSome(a))return[3,2];d=h.all(a.map(function(a){return e.__awaiter(f,void 0,void 0,
function(){var d,f;return e.__generator(this,function(e){switch(e.label){case 0:return d=n.Utils.getVVType(a.type),[4,this._createGetValueFunction(a,b)];case 1:return f=e.sent(),c.isSome(f)&&this._attributeComputeMap.set(d,f),[2]}})})}));return[4,d];case 1:g.sent(),g.label=2;case 2:return[2]}})})};k.prototype._bindDDEvaluators=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d,f,g=this;return e.__generator(this,function(e){switch(e.label){case 0:return this._attributeComputeMap.clear(),
a.length>n.definitions.DOT_DENSITY_MAX_FIELDS&&x.warn("mapview-invalid-value","DotDensityRenderer supports a maximum of "+n.definitions.DOT_DENSITY_MAX_FIELDS+" attribtues, but found "+a.length),[4,h.all(a.map(function(a){return g._createNormalizedFunction(a,b)}))];case 1:c=e.sent().map(function(a){return v(0,a)});for(d=0;d<n.definitions.DOT_DENSITY_MAX_FIELDS;d++)(f=d<a.length&&c[d])?this._attributeComputeMap.set(d,f):this._attributeComputeMap.has(d)&&this._attributeComputeMap.delete(d);return[2]}})})};
k.prototype._createGetValueFunction=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d,f,g,h,k,l;return e.__generator(this,function(e){switch(e.label){case 0:if("size"!==a.type)return[3,2];c=n.getTypeOfSizeVisualVariable(a);if(c===n.enums.WGLVVFlag.SIZE_SCALE_STOPS)return[2,null];f=(d=c===n.enums.WGLVVFlag.SIZE_UNIT_VALUE)&&function(b){return q.getVisualVariableSizeValueRepresentationRatio(b,a.valueRepresentation)};g=v;h=[n.definitions.NAN_MAGIC_NUMBER];return[4,this._createNormalizedFunction(a,
b,f)];case 1:return[2,g.apply(void 0,h.concat([e.sent()]))];case 2:return k=v,l=[n.definitions.NAN_MAGIC_NUMBER],[4,this._createNormalizedFunction(a,b)];case 3:return[2,k.apply(void 0,l.concat([e.sent()]))]}})})};k.prototype._createNormalizedFunction=function(a,b,c){return e.__awaiter(this,void 0,void 0,function(){var f,g,h;return e.__generator(this,function(e){switch(e.label){case 0:if(f=a.field){if("string"===typeof f)return(g=a.normalizationField)?[2,function(a){if(a.attributes[f]&&a.attributes[g])return a=
a.attributes[f]/a.attributes[g],c?c(a):a}]:[2,c?function(a){return c(a.attributes[f])}:function(a){return a.attributes[f]}];x.error(new m("mapview-rendering:invalid-type","The field for a vv must be a string or a number, but got "+typeof f));return[2,function(){}]}if(!a.valueExpression)return[3,2];this._hasScaleExpr=this._hasScaleExpr||-1!==a.valueExpression.indexOf("scale");return[4,d.createVVExpression(a.valueExpression,b.spatialReference,b.fields)];case 1:return h=e.sent(),[2,p.callWithOptimizedFeature.bind(null,
h)];case 2:return x.error("Unable to create a normalized function for visual variable: "+a),[2,function(){}]}})})};return k}();a.default=k})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("require exports tslib ../../../../../../core/screenUtils ../../../../engine ../../../../engine/webgl/definitions ../../../../../3d/layers/support/FastSymbolUpdates".split(" "),function(f,a,e,m,k,l,g){function c(a){return{value:a.value,size:m.toPt(a.size)}}function h(a){return a.map(function(a){return c(a)})}
function b(a){return"string"===typeof a||"number"===typeof a?m.toPt(a):{type:"size",expression:a.expression,stops:h(a.stops)}}function d(a){var b={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if(k.Utils.isString(a.field))if(a.stops){if(8<a.stops.length)return null;var c=a.stops;for(a=0;8>a;++a){var d=c[Math.min(a,c.length-1)];b.values[a]=d.value;b.opacities[a]=d.opacity}}else return null;else if(a.stops&&0<=a.stops.length)for(c=a.stops&&0<=a.stops.length&&a.stops[0].opacity,a=0;8>a;a++)b.values[a]=
Infinity,b.opacities[a]=c;else return null;return b}Object.defineProperty(a,"__esModule",{value:!0});var n=k.enums.WGLVVFlag;a.getVisualVariableSizeValueRepresentationRatio=function(a,b){if(!a||!b)return a;switch(b){case "radius":case "distance":return 2*a;case "area":return Math.sqrt(a)}return a};a.stopToSizeStop=c;a.normalizeSizeStops=h;a.normalizeSizeElement=b;a.getVisualVariablesFields=function(a){var b=a&&0<a.length?{}:null;b&&a.forEach(function(a){var c=a.type;a.field&&(b[c]=a.field)});return b};
var p=function(a){var b=[],c=[];a=h(a);for(var d=a.length,e=0;6>e;e++){var f=a[Math.min(e,d-1)];b.push(f.value);c.push(null==f.size?l.NAN_MAGIC_NUMBER:m.pt2px(f.size))}return{values:new Float32Array(b),sizes:new Float32Array(c)}};a.convertVisualVariables=function(a){var c=a&&0<a.length?{}:null,f=c?{}:null;if(!c)return{vvFields:c,vvRanges:f};for(var l=0;l<a.length;l++){var m=a[l],r=m.type;m.field&&(c[r]=m.field);if("size"===r)switch(f.size||(f.size={}),k.getTypeOfSizeVisualVariable(m)){case n.SIZE_MINMAX_VALUE:f.size.minMaxValue=
{minDataValue:m.minDataValue,maxDataValue:m.maxDataValue,minSize:b(m.minSize),maxSize:b(m.maxSize)};break;case n.SIZE_SCALE_STOPS:f.size.scaleStops={stops:h(m.stops)};break;case n.SIZE_FIELD_STOPS:if(m.levels){var r={},z;for(z in m.levels)r[z]=p(m.levels[z]);f.size.fieldStops={type:"level-dependent",levels:r}}else f.size.fieldStops=e.__assign({type:"static"},p(m.stops));break;case n.SIZE_UNIT_VALUE:f.size.unitValue={unit:m.valueUnit,valueRepresentation:m.valueRepresentation}}else if("color"===r){if(m=
g.convertVisualVariables([m],{modelSize:null,symbolSize:null,unitInMeters:1,transformation:null}))for(f.color=m.color,m=0;32>m;m+=4)k.color.premultiplyAlpha(f.color.colors,m,!0)}else"opacity"===r?f.opacity=d(m):"rotation"===r&&(f.rotation={type:m.rotationType})}return{vvFields:c,vvRanges:f}}})},"esri/views/3d/layers/support/FastSymbolUpdates":function(){define("require exports ../../../../core/compilerUtils ../../../../core/mathUtils ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f64 ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../renderers/support/utils ../../support/debugFlags".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n){function p(a){return null!==a&&void 0!==a}function r(a){return"number"===typeof a}function q(a){return"string"===typeof a}function x(a,b){a&&a.push(b)}function u(a,b,c,e,f){var g=a.minSize,h=a.maxSize;if(a.expression)return x(f,"Could not convert size info: expression not supported"),!1;if(a.useSymbolValue)return a=e.symbolSize[c],b.minSize[c]=a,b.maxSize[c]=a,b.offset[c]=b.minSize[c],b.factor[c]=0,b.type[c]=1,!0;if(p(a.field)){if(p(a.stops)){if(2===a.stops.length&&
r(a.stops[0].size)&&r(a.stops[1].size))return v(a.stops[0].size,a.stops[1].size,a.stops[0].value,a.stops[1].value,b,c),b.type[c]=1,!0;x(f,"Could not convert size info: stops only supported with 2 elements");return!1}if(r(g)&&r(h)&&p(a.minDataValue)&&p(a.maxDataValue))return v(g,h,a.minDataValue,a.maxDataValue,b,c),b.type[c]=1,!0;if(null!=d.meterIn[a.valueUnit])return b.minSize[c]=-Infinity,b.maxSize[c]=Infinity,b.offset[c]=0,b.factor[c]=1/d.meterIn[a.valueUnit],b.type[c]=1,!0;if("unknown"===a.valueUnit)return x(f,
"Could not convert size info: proportional size not supported"),!1;x(f,"Could not convert size info: scale-dependent size not supported");return!1}if(!p(a.field)){if(a.stops&&a.stops[0]&&r(a.stops[0].size))return b.minSize[c]=a.stops[0].size,b.maxSize[c]=a.stops[0].size,b.offset[c]=b.minSize[c],b.factor[c]=0,b.type[c]=1,!0;if(r(g))return b.minSize[c]=g,b.maxSize[c]=g,b.offset[c]=g,b.factor[c]=0,b.type[c]=1,!0}x(f,"Could not convert size info: unsupported variant of sizeInfo");return!1}function v(a,
b,c,d,e,f){d=0<Math.abs(d-c)?(b-a)/(d-c):0;e.minSize[f]=0<d?a:b;e.maxSize[f]=0<d?b:a;e.offset[f]=a-c*d;e.factor[f]=d}function y(a,b,c,d){if(a.normalizationField||a.valueRepresentation)return x(d,"Could not convert size info: unsupported property"),null;var e=a.field;if(null!=e&&!q(e))return x(d,"Could not convert size info: field is not a string"),null;if(!b.size)b.size={field:a.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[0,0,0]};else if(a.field)if(!b.size.field)b.size.field=
a.field;else if(a.field!==b.size.field)return x(d,"Could not convert size info: multiple fields in use"),null;switch(a.axis){case "width":return(e=u(a,b.size,0,c,d))?b:null;case "height":return(e=u(a,b.size,2,c,d))?b:null;case "depth":return(e=u(a,b.size,1,c,d))?b:null;case "width-and-depth":return(e=u(a,b.size,0,c,d))&&u(a,b.size,1,c,d),e?b:null;case null:case void 0:case "all":return(e=(e=(e=u(a,b.size,0,c,d))&&u(a,b.size,1,c,d))&&u(a,b.size,2,c,d))?b:null;default:return x(d,'Could not convert size info: unknown axis "'+
a.axis+'""'),null}}function z(a,b,c){for(var d=0;3>d;++d){var e=b.unitInMeters;1===a.type[d]&&(e*=b.modelSize[d],a.type[d]=2);a.minSize[d]/=e;a.maxSize[d]/=e;a.offset[d]/=e;a.factor[d]/=e}if(0!==a.type[0])b=0;else if(0!==a.type[1])b=1;else if(0!==a.type[2])b=2;else return x(c,"No size axis contains a valid size or scale"),!1;for(d=0;3>d;++d)0===a.type[d]&&(a.minSize[d]=a.minSize[b],a.maxSize[d]=a.maxSize[b],a.offset[d]=a.offset[b],a.factor[d]=a.factor[b],a.type[d]=a.type[b]);return!0}function A(a,
b,c){a[4*b+0]=c.r/255;a[4*b+1]=c.g/255;a[4*b+2]=c.b/255;a[4*b+3]=c.a}function B(a,b,c){if(a.normalizationField)return x(c,"Could not convert color info: unsupported property"),null;if(q(a.field))if(a.stops){if(8<a.stops.length)return x(c,"Could not convert color info: too many color stops"),null;b.color={field:a.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};c=a.stops;for(a=0;8>a;++a){var d=c[Math.min(a,c.length-1)];b.color.values[a]=d.value;
A(b.color.colors,a,d.color)}}else return x(c,"Could not convert color info: missing stops or colors"),null;else if(a.stops&&0<=a.stops.length)for(c=a.stops&&0<=a.stops.length&&a.stops[0].color,b.color={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},a=0;8>a;a++)b.color.values[a]=Infinity,A(b.color.colors,a,c);else return x(c,"Could not convert color info: no field and no colors/stops"),null;return b}function D(a,b,c){if(a.normalizationField)return x(c,
"Could not convert opacity info: unsupported property"),null;if(q(a.field))if(a.stops){if(8<a.stops.length)return x(c,"Could not convert opacity info: too many opacity stops"),null;b.opacity={field:a.field,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};c=a.stops;for(a=0;8>a;++a){var d=c[Math.min(a,c.length-1)];b.opacity.values[a]=d.value;b.opacity.opacityValues[a]=d.opacity}}else return x(c,"Could not convert opacity info: missing stops or opacities"),null;else if(a.stops&&0<=a.stops.length)for(c=
a.stops&&0<=a.stops.length&&a.stops[0].opacity,b.opacity={field:null,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]},a=0;8>a;a++)b.opacity.values[a]=Infinity,b.opacity.opacityValues[a]=c;else return x(c,"Could not convert opacity info: no field and no opacities/stops"),null;return b}function C(a,b,c){a=2===c&&"arithmetic"===a.rotationType;b.offset[c]=a?90:0;b.factor[c]=a?-1:1;b.type[c]=1}function E(a,b,c){if(!q(a.field))return x(c,"Could not convert rotation info: field is not a string"),
null;if(!b.rotation)b.rotation={field:a.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};else if(a.field)if(!b.rotation.field)b.rotation.field=a.field;else if(a.field!==b.rotation.field)return x(c,"Could not convert rotation info: multiple fields in use"),null;switch(a.axis){case "tilt":return C(a,b.rotation,0),b;case "roll":return C(a,b.rotation,1),b;case null:case void 0:case "heading":return C(a,b.rotation,2),b;default:return x(c,'Could not convert rotation info: unknown axis "'+a.axis+'""'),
null}}function F(a,b,c){if(!a)return null;var d=!b.supportedTypes||!!b.supportedTypes.size,f=!b.supportedTypes||!!b.supportedTypes.color,g=!b.supportedTypes||!!b.supportedTypes.rotation,h=!!b.supportedTypes&&!!b.supportedTypes.opacity,k=a.reduce(function(a,k){if(!a)return a;if(k.valueExpression)return x(c,"Could not convert visual variables: arcade expressions not supported"),null;switch(k.type){case "size":return d?y(k,a,b,c):a;case "color":return f?B(k,a,c):a;case "opacity":return h?D(k,a,c):null;
case "rotation":return g?E(k,a,c):a;default:return e.neverReached(k),null}},{size:null,color:null,opacity:null,rotation:null});return 0<a.length&&k&&!k.size&&!k.color&&!k.opacity&&!k.rotation||k&&k.size&&!z(k.size,b,c)?null:k}function I(a,b,c){if(!!a!==!!b||a&&a.field!==b.field)return!1;if(a&&"rotation"===c)for(c=0;3>c;c++)if(a.type[c]!==b.type[c]||a.offset[c]!==b.offset[c]||a.factor[c]!==b.factor[c])return!1;return!0}function J(a,b){var d={vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,vvSizeOffset:null,
vvSizeFactor:null,vvSizeValue:null,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null,vvOpacityEnabled:!1,vvOpacityValues:null,vvOpacityOpacities:null,vvSymbolAnchor:null,vvSymbolRotationMatrix:null},e=a&&null!=a.size;a&&a.size?(d.vvSizeEnabled=!0,d.vvSizeMinSize=a.size.minSize,d.vvSizeMaxSize=a.size.maxSize,d.vvSizeOffset=a.size.offset,d.vvSizeFactor=a.size.factor):a&&e&&(d.vvSizeValue=b.transformation.scale);if(a&&e){d.vvSymbolAnchor=b.transformation.anchor;d.vvSymbolRotationMatrix=l.mat3f64.create();
g.mat4.identity(H);var f=b.transformation.rotation[2],e=b.transformation.rotation[0],h=b.transformation.rotation[1];b=H;void 0===b&&(b=c.mat4f64.create());f=f||0;e=e||0;h=h||0;0!==f&&g.mat4.rotateZ(b,b,-f/180*Math.PI);0!==e&&g.mat4.rotateX(b,b,e/180*Math.PI);0!==h&&g.mat4.rotateY(b,b,h/180*Math.PI);k.mat3.fromMat4(d.vvSymbolRotationMatrix,H)}a&&a.color&&(d.vvColorEnabled=!0,d.vvColorValues=a.color.values,d.vvColorColors=a.color.colors);a&&a.opacity&&(d.vvOpacityEnabled=!0,d.vvOpacityValues=a.opacity.values,
d.vvOpacityOpacities=a.opacity.opacityValues);return d}Object.defineProperty(a,"__esModule",{value:!0});a.convertVisualVariables=F;a.initFastSymbolUpdatesState=function(a,b){return!a||n.DISABLE_FAST_UPDATES?{enabled:!1}:(a=F(a.visualVariables,b))?{enabled:!0,visualVariables:a,materialParameters:J(a,b),requiresShaderTransformation:a&&null!=a.size}:{enabled:!1}};a.updateFastSymbolUpdatesState=function(a,b,c){if(!b||!a.enabled)return!1;var d=a.visualVariables;b=F(b.visualVariables,c);if(!(b&&I(d.size,
b.size,"size")&&I(d.color,b.color,"color")&&I(d.rotation,b.rotation,"rotation")&&I(d.opacity,b.opacity,"opacity")))return!1;a.visualVariables=b;a.materialParameters=J(b,c);a.requiresShaderTransformation=b&&null!=b.size;return!0};a.getMaterialParams=J;var G;(function(a){var d=c.mat4f64.create(),e=b.vec3f64.create();a.evaluateModelTransform=function(a,b,c){if(!a.vvSizeEnabled)return c;g.mat4.copy(d,c);c=a.vvSymbolRotationMatrix;g.mat4.set(H,c[0],c[1],c[2],0,c[3],c[4],c[5],0,c[6],c[7],c[8],0,0,0,0,1);
g.mat4.multiply(d,d,H);for(c=0;3>c;++c)e[c]=m.clamp(a.vvSizeOffset[c]+b[0]*a.vvSizeFactor[c],a.vvSizeMinSize[c],a.vvSizeMaxSize[c]);g.mat4.scale(d,d,e);g.mat4.translate(d,d,a.vvSymbolAnchor);return d};a.evaluateModelTransformScale=function(a,b,c){if(!b.vvSizeEnabled)return h.vec3.set(a,1,1,1);for(var d=0;3>d;++d)a[d]=m.clamp(b.vvSizeOffset[d]+c[0]*b.vvSizeFactor[d],b.vvSizeMinSize[d],b.vvSizeMaxSize[d]);return a}})(G||(G={}));var H=c.mat4f64.create();a.evaluateModelTransform=G.evaluateModelTransform;
a.evaluateModelTransformScale=G.evaluateModelTransformScale})},"esri/core/libs/gl-matrix-2/mat3f64":function(){define(["require","exports","./factories/mat3f64"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.mat3f64=e})},"esri/core/libs/gl-matrix-2/factories/mat3f64":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});a.create=function(){return[1,0,0,0,1,0,0,0,1]};a.clone=function(a){return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],
a[7],a[8]]};a.fromValues=function(a,f,k,l,g,c,h,b,d){return[a,f,k,l,g,c,h,b,d]};a.createView=function(a,f){return new Float64Array(a,f,9)}})},"esri/core/libs/gl-matrix-2/mat4":function(){define(["require","exports","./math/mat4"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.mat4=e})},"esri/core/libs/gl-matrix-2/math/mat4":function(){define(["require","exports","../factories/vec3f64","./common"],function(f,a,e,m){function k(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;
a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function l(a,c,e){var b=c[0],d=c[1],f=c[2],g=c[3],h=c[4],k=c[5],l=c[6],m=c[7],n=c[8],B=c[9],D=c[10],C=c[11],E=c[12],F=c[13],I=c[14];c=c[15];var J=e[0],G=e[1],H=e[2],K=e[3];a[0]=J*b+G*h+H*n+K*E;a[1]=J*d+G*k+H*B+K*F;a[2]=J*f+G*l+H*D+K*I;a[3]=J*g+G*m+H*C+K*c;J=e[4];G=e[5];H=e[6];K=e[7];a[4]=J*b+G*h+H*n+K*E;a[5]=J*d+G*k+H*B+K*F;a[6]=J*f+G*l+H*D+K*I;a[7]=J*g+G*m+H*C+K*c;J=e[8];G=e[9];H=e[10];K=e[11];a[8]=J*b+G*h+H*n+K*E;a[9]=
J*d+G*k+H*B+K*F;a[10]=J*f+G*l+H*D+K*I;a[11]=J*g+G*m+H*C+K*c;J=e[12];G=e[13];H=e[14];K=e[15];a[12]=J*b+G*h+H*n+K*E;a[13]=J*d+G*k+H*B+K*F;a[14]=J*f+G*l+H*D+K*I;a[15]=J*g+G*m+H*C+K*c;return a}function g(a,c,e){var b=c[0],d=c[1],f=c[2],g=c[3],h=b+b,k=d+d,l=f+f;c=b*h;var m=b*k,b=b*l,n=d*k,d=d*l,f=f*l,h=g*h,k=g*k,g=g*l;a[0]=1-(n+f);a[1]=m+g;a[2]=b-k;a[3]=0;a[4]=m-g;a[5]=1-(c+f);a[6]=d+h;a[7]=0;a[8]=b+k;a[9]=d-h;a[10]=1-(c+n);a[11]=0;a[12]=e[0];a[13]=e[1];a[14]=e[2];a[15]=1;return a}function c(a,c,e){a[0]=
c[0]-e[0];a[1]=c[1]-e[1];a[2]=c[2]-e[2];a[3]=c[3]-e[3];a[4]=c[4]-e[4];a[5]=c[5]-e[5];a[6]=c[6]-e[6];a[7]=c[7]-e[7];a[8]=c[8]-e[8];a[9]=c[9]-e[9];a[10]=c[10]-e[10];a[11]=c[11]-e[11];a[12]=c[12]-e[12];a[13]=c[13]-e[13];a[14]=c[14]-e[14];a[15]=c[15]-e[15];return a}Object.defineProperty(a,"__esModule",{value:!0});a.copy=function(a,c){a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];a[4]=c[4];a[5]=c[5];a[6]=c[6];a[7]=c[7];a[8]=c[8];a[9]=c[9];a[10]=c[10];a[11]=c[11];a[12]=c[12];a[13]=c[13];a[14]=c[14];a[15]=c[15];
return a};a.set=function(a,c,e,f,g,h,k,l,m,y,z,A,B,D,C,E,F){a[0]=c;a[1]=e;a[2]=f;a[3]=g;a[4]=h;a[5]=k;a[6]=l;a[7]=m;a[8]=y;a[9]=z;a[10]=A;a[11]=B;a[12]=D;a[13]=C;a[14]=E;a[15]=F;return a};a.identity=k;a.transpose=function(a,c){if(a===c){var b=c[1],d=c[2],e=c[3],f=c[6],g=c[7],h=c[11];a[1]=c[4];a[2]=c[8];a[3]=c[12];a[4]=b;a[6]=c[9];a[7]=c[13];a[8]=d;a[9]=f;a[11]=c[14];a[12]=e;a[13]=g;a[14]=h}else a[0]=c[0],a[1]=c[4],a[2]=c[8],a[3]=c[12],a[4]=c[1],a[5]=c[5],a[6]=c[9],a[7]=c[13],a[8]=c[2],a[9]=c[6],a[10]=
c[10],a[11]=c[14],a[12]=c[3],a[13]=c[7],a[14]=c[11],a[15]=c[15];return a};a.invert=function(a,c){var b=c[0],d=c[1],e=c[2],f=c[3],g=c[4],h=c[5],k=c[6],l=c[7],m=c[8],A=c[9],B=c[10],D=c[11],C=c[12],E=c[13],F=c[14];c=c[15];var I=b*h-d*g,J=b*k-e*g,G=b*l-f*g,H=d*k-e*h,K=d*l-f*h,O=e*l-f*k,L=m*E-A*C,N=m*F-B*C,T=m*c-D*C,R=A*F-B*E,Q=A*c-D*E,S=B*c-D*F,U=I*S-J*Q+G*R+H*T-K*N+O*L;if(!U)return null;U=1/U;a[0]=(h*S-k*Q+l*R)*U;a[1]=(e*Q-d*S-f*R)*U;a[2]=(E*O-F*K+c*H)*U;a[3]=(B*K-A*O-D*H)*U;a[4]=(k*T-g*S-l*N)*U;a[5]=
(b*S-e*T+f*N)*U;a[6]=(F*G-C*O-c*J)*U;a[7]=(m*O-B*G+D*J)*U;a[8]=(g*Q-h*T+l*L)*U;a[9]=(d*T-b*Q-f*L)*U;a[10]=(C*K-E*G+c*I)*U;a[11]=(A*G-m*K-D*I)*U;a[12]=(h*N-g*R-k*L)*U;a[13]=(b*R-d*N+e*L)*U;a[14]=(E*J-C*H-F*I)*U;a[15]=(m*H-A*J+B*I)*U;return a};a.adjoint=function(a,c){var b=c[0],d=c[1],e=c[2],f=c[3],g=c[4],h=c[5],k=c[6],l=c[7],m=c[8],A=c[9],B=c[10],D=c[11],C=c[12],E=c[13],F=c[14];c=c[15];a[0]=h*(B*c-D*F)-A*(k*c-l*F)+E*(k*D-l*B);a[1]=-(d*(B*c-D*F)-A*(e*c-f*F)+E*(e*D-f*B));a[2]=d*(k*c-l*F)-h*(e*c-f*F)+
E*(e*l-f*k);a[3]=-(d*(k*D-l*B)-h*(e*D-f*B)+A*(e*l-f*k));a[4]=-(g*(B*c-D*F)-m*(k*c-l*F)+C*(k*D-l*B));a[5]=b*(B*c-D*F)-m*(e*c-f*F)+C*(e*D-f*B);a[6]=-(b*(k*c-l*F)-g*(e*c-f*F)+C*(e*l-f*k));a[7]=b*(k*D-l*B)-g*(e*D-f*B)+m*(e*l-f*k);a[8]=g*(A*c-D*E)-m*(h*c-l*E)+C*(h*D-l*A);a[9]=-(b*(A*c-D*E)-m*(d*c-f*E)+C*(d*D-f*A));a[10]=b*(h*c-l*E)-g*(d*c-f*E)+C*(d*l-f*h);a[11]=-(b*(h*D-l*A)-g*(d*D-f*A)+m*(d*l-f*h));a[12]=-(g*(A*F-B*E)-m*(h*F-k*E)+C*(h*B-k*A));a[13]=b*(A*F-B*E)-m*(d*F-e*E)+C*(d*B-e*A);a[14]=-(b*(h*F-k*
E)-g*(d*F-e*E)+C*(d*k-e*h));a[15]=b*(h*B-k*A)-g*(d*B-e*A)+m*(d*k-e*h);return a};a.determinant=function(a){var b=a[0],c=a[1],e=a[2],f=a[3],g=a[4],h=a[5],k=a[6],l=a[7],m=a[8],z=a[9],A=a[10],B=a[11],D=a[12],C=a[13],E=a[14];a=a[15];return(b*h-c*g)*(A*a-B*E)-(b*k-e*g)*(z*a-B*C)+(b*l-f*g)*(z*E-A*C)+(c*k-e*h)*(m*a-B*D)-(c*l-f*h)*(m*E-A*D)+(e*l-f*k)*(m*C-z*D)};a.multiply=l;a.translate=function(a,c,e){var b=e[0],d=e[1];e=e[2];var f=void 0,g=void 0,h=void 0,k=void 0,l=void 0,m=void 0,n=void 0,B=void 0,D=void 0,
C=void 0,E=void 0,F=void 0;c===a?(a[12]=c[0]*b+c[4]*d+c[8]*e+c[12],a[13]=c[1]*b+c[5]*d+c[9]*e+c[13],a[14]=c[2]*b+c[6]*d+c[10]*e+c[14],a[15]=c[3]*b+c[7]*d+c[11]*e+c[15]):(f=c[0],g=c[1],h=c[2],k=c[3],l=c[4],m=c[5],n=c[6],B=c[7],D=c[8],C=c[9],E=c[10],F=c[11],a[0]=f,a[1]=g,a[2]=h,a[3]=k,a[4]=l,a[5]=m,a[6]=n,a[7]=B,a[8]=D,a[9]=C,a[10]=E,a[11]=F,a[12]=f*b+l*d+D*e+c[12],a[13]=g*b+m*d+C*e+c[13],a[14]=h*b+n*d+E*e+c[14],a[15]=k*b+B*d+F*e+c[15]);return a};a.scale=function(a,c,e){var b=e[0],d=e[1];e=e[2];a[0]=
c[0]*b;a[1]=c[1]*b;a[2]=c[2]*b;a[3]=c[3]*b;a[4]=c[4]*d;a[5]=c[5]*d;a[6]=c[6]*d;a[7]=c[7]*d;a[8]=c[8]*e;a[9]=c[9]*e;a[10]=c[10]*e;a[11]=c[11]*e;a[12]=c[12];a[13]=c[13];a[14]=c[14];a[15]=c[15];return a};a.rotate=function(a,c,e,f){var b=f[0],d=f[1];f=f[2];var g=Math.sqrt(b*b+d*d+f*f),h=void 0,k=void 0,l=void 0,n=void 0,p=void 0,B=void 0,D=void 0,C=void 0,E=void 0,F=void 0,I=void 0,J=void 0,G=void 0,H=void 0,K=void 0,O=void 0,L=void 0,N=void 0,T=void 0,R=void 0,Q=void 0,S=void 0,k=h=void 0;if(g<m.EPSILON)return null;
g=1/g;b*=g;d*=g;f*=g;h=Math.sin(e);k=Math.cos(e);l=1-k;n=c[0];p=c[1];B=c[2];D=c[3];C=c[4];E=c[5];F=c[6];I=c[7];J=c[8];G=c[9];H=c[10];K=c[11];O=b*b*l+k;L=d*b*l+f*h;N=f*b*l-d*h;T=b*d*l-f*h;R=d*d*l+k;Q=f*d*l+b*h;S=b*f*l+d*h;h=d*f*l-b*h;k=f*f*l+k;a[0]=n*O+C*L+J*N;a[1]=p*O+E*L+G*N;a[2]=B*O+F*L+H*N;a[3]=D*O+I*L+K*N;a[4]=n*T+C*R+J*Q;a[5]=p*T+E*R+G*Q;a[6]=B*T+F*R+H*Q;a[7]=D*T+I*R+K*Q;a[8]=n*S+C*h+J*k;a[9]=p*S+E*h+G*k;a[10]=B*S+F*h+H*k;a[11]=D*S+I*h+K*k;c!==a&&(a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);
return a};a.rotateX=function(a,c,e){var b=Math.sin(e);e=Math.cos(e);var d=c[4],f=c[5],g=c[6],h=c[7],k=c[8],l=c[9],m=c[10],n=c[11];c!==a&&(a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);a[4]=d*e+k*b;a[5]=f*e+l*b;a[6]=g*e+m*b;a[7]=h*e+n*b;a[8]=k*e-d*b;a[9]=l*e-f*b;a[10]=m*e-g*b;a[11]=n*e-h*b;return a};a.rotateY=function(a,c,e){var b=Math.sin(e);e=Math.cos(e);var d=c[0],f=c[1],g=c[2],h=c[3],k=c[8],l=c[9],m=c[10],n=c[11];c!==a&&(a[4]=c[4],a[5]=c[5],a[6]=c[6],
a[7]=c[7],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);a[0]=d*e-k*b;a[1]=f*e-l*b;a[2]=g*e-m*b;a[3]=h*e-n*b;a[8]=d*b+k*e;a[9]=f*b+l*e;a[10]=g*b+m*e;a[11]=h*b+n*e;return a};a.rotateZ=function(a,c,e){var b=Math.sin(e);e=Math.cos(e);var d=c[0],f=c[1],g=c[2],h=c[3],k=c[4],l=c[5],m=c[6],n=c[7];c!==a&&(a[8]=c[8],a[9]=c[9],a[10]=c[10],a[11]=c[11],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);a[0]=d*e+k*b;a[1]=f*e+l*b;a[2]=g*e+m*b;a[3]=h*e+n*b;a[4]=k*e-d*b;a[5]=l*e-f*b;a[6]=m*e-g*b;a[7]=n*e-h*b;return a};
a.fromTranslation=function(a,c){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a};a.fromScaling=function(a,c){a[0]=c[0];a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=c[1];a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=c[2];a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.fromRotation=function(a,c,e){var b=e[0],d=e[1];e=e[2];var f=Math.sqrt(b*b+d*d+e*e),g=void 0,h=void 0,k=void 0;if(f<m.EPSILON)return null;f=1/f;b*=f;d*=f;e*=f;g=Math.sin(c);
h=Math.cos(c);k=1-h;a[0]=b*b*k+h;a[1]=d*b*k+e*g;a[2]=e*b*k-d*g;a[3]=0;a[4]=b*d*k-e*g;a[5]=d*d*k+h;a[6]=e*d*k+b*g;a[7]=0;a[8]=b*e*k+d*g;a[9]=d*e*k-b*g;a[10]=e*e*k+h;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.fromXRotation=function(a,c){var b=Math.sin(c);c=Math.cos(c);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=c;a[6]=b;a[7]=0;a[8]=0;a[9]=-b;a[10]=c;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.fromYRotation=function(a,c){var b=Math.sin(c);c=Math.cos(c);a[0]=c;a[1]=0;a[2]=-b;a[3]=0;a[4]=
0;a[5]=1;a[6]=0;a[7]=0;a[8]=b;a[9]=0;a[10]=c;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.fromZRotation=function(a,c){var b=Math.sin(c);c=Math.cos(c);a[0]=c;a[1]=b;a[2]=0;a[3]=0;a[4]=-b;a[5]=c;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.fromRotationTranslation=g;a.fromQuat2=function(a,c){var b=h,d=-c[0],e=-c[1],f=-c[2],k=c[3],l=c[4],m=c[5],y=c[6],z=c[7],A=d*d+e*e+f*f+k*k;0<A?(b[0]=2*(l*k+z*d+m*f-y*e)/A,b[1]=2*(m*k+z*e+y*d-l*f)/A,b[2]=2*(y*k+z*f+l*
e-m*d)/A):(b[0]=2*(l*k+z*d+m*f-y*e),b[1]=2*(m*k+z*e+y*d-l*f),b[2]=2*(y*k+z*f+l*e-m*d));g(a,c,b);return a};var h=e.create();a.getTranslation=function(a,c){a[0]=c[12];a[1]=c[13];a[2]=c[14];return a};a.getScaling=function(a,c){var b=c[0],d=c[1],e=c[2],f=c[4],g=c[5],h=c[6],k=c[8],l=c[9];c=c[10];a[0]=Math.sqrt(b*b+d*d+e*e);a[1]=Math.sqrt(f*f+g*g+h*h);a[2]=Math.sqrt(k*k+l*l+c*c);return a};a.getRotation=function(a,c){var b=c[0]+c[5]+c[10],d=0;0<b?(d=2*Math.sqrt(b+1),a[3]=.25*d,a[0]=(c[6]-c[9])/d,a[1]=(c[8]-
c[2])/d,a[2]=(c[1]-c[4])/d):c[0]>c[5]&&c[0]>c[10]?(d=2*Math.sqrt(1+c[0]-c[5]-c[10]),a[3]=(c[6]-c[9])/d,a[0]=.25*d,a[1]=(c[1]+c[4])/d,a[2]=(c[8]+c[2])/d):c[5]>c[10]?(d=2*Math.sqrt(1+c[5]-c[0]-c[10]),a[3]=(c[8]-c[2])/d,a[0]=(c[1]+c[4])/d,a[1]=.25*d,a[2]=(c[6]+c[9])/d):(d=2*Math.sqrt(1+c[10]-c[0]-c[5]),a[3]=(c[1]-c[4])/d,a[0]=(c[8]+c[2])/d,a[1]=(c[6]+c[9])/d,a[2]=.25*d);return a};a.fromRotationTranslationScale=function(a,c,e,f){var b=c[0],d=c[1],g=c[2],h=c[3],k=b+b,l=d+d,m=g+g;c=b*k;var n=b*l,b=b*m,
p=d*l,d=d*m,g=g*m,k=h*k,l=h*l,h=h*m,m=f[0],D=f[1];f=f[2];a[0]=(1-(p+g))*m;a[1]=(n+h)*m;a[2]=(b-l)*m;a[3]=0;a[4]=(n-h)*D;a[5]=(1-(c+g))*D;a[6]=(d+k)*D;a[7]=0;a[8]=(b+l)*f;a[9]=(d-k)*f;a[10]=(1-(c+p))*f;a[11]=0;a[12]=e[0];a[13]=e[1];a[14]=e[2];a[15]=1;return a};a.fromRotationTranslationScaleOrigin=function(a,c,e,f,g){var b=c[0],d=c[1],h=c[2],k=c[3],l=b+b,m=d+d,n=h+h;c=b*l;var p=b*m,r=b*n,b=d*m,d=d*n,C=h*n,h=k*l,m=k*m,E=k*n,F=f[0],I=f[1],n=f[2];f=g[0];k=g[1];g=g[2];var l=(1-(b+C))*F,J=(p+E)*F,F=(r-m)*
F,p=(p-E)*I,C=(1-(c+C))*I,I=(d+h)*I,r=(r+m)*n,d=(d-h)*n;c=(1-(c+b))*n;a[0]=l;a[1]=J;a[2]=F;a[3]=0;a[4]=p;a[5]=C;a[6]=I;a[7]=0;a[8]=r;a[9]=d;a[10]=c;a[11]=0;a[12]=e[0]+f-(l*f+p*k+r*g);a[13]=e[1]+k-(J*f+C*k+d*g);a[14]=e[2]+g-(F*f+I*k+c*g);a[15]=1;return a};a.fromQuat=function(a,c){var b=c[0],d=c[1],e=c[2];c=c[3];var f=b+b,g=d+d,h=e+e,b=b*f,k=d*f,d=d*g,l=e*f,m=e*g,e=e*h,f=c*f,g=c*g;c*=h;a[0]=1-d-e;a[1]=k+c;a[2]=l-g;a[3]=0;a[4]=k-c;a[5]=1-b-e;a[6]=m+f;a[7]=0;a[8]=l+g;a[9]=m-f;a[10]=1-b-d;a[11]=0;a[12]=
0;a[13]=0;a[14]=0;a[15]=1;return a};a.frustum=function(a,c,e,f,g,h,k){var b=1/(e-c),d=1/(g-f),l=1/(h-k);a[0]=2*h*b;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*h*d;a[6]=0;a[7]=0;a[8]=(e+c)*b;a[9]=(g+f)*d;a[10]=(k+h)*l;a[11]=-1;a[12]=0;a[13]=0;a[14]=k*h*2*l;a[15]=0;return a};a.perspective=function(a,c,e,f,g){c=1/Math.tan(c/2);var b=void 0;a[0]=c/e;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=c;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[11]=-1;a[12]=0;a[13]=0;a[15]=0;null!=g&&Infinity!==g?(b=1/(f-g),a[10]=(g+f)*b,a[14]=2*g*f*b):(a[10]=
-1,a[14]=-2*f);return a};a.perspectiveFromFieldOfView=function(a,c,e,f){var b=Math.tan(c.upDegrees*Math.PI/180),d=Math.tan(c.downDegrees*Math.PI/180),g=Math.tan(c.leftDegrees*Math.PI/180);c=Math.tan(c.rightDegrees*Math.PI/180);var h=2/(g+c),k=2/(b+d);a[0]=h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=k;a[6]=0;a[7]=0;a[8]=-((g-c)*h*.5);a[9]=(b-d)*k*.5;a[10]=f/(e-f);a[11]=-1;a[12]=0;a[13]=0;a[14]=f*e/(e-f);a[15]=0;return a};a.ortho=function(a,c,e,f,g,h,k){var b=1/(c-e),d=1/(f-g),l=1/(h-k);a[0]=-2*b;a[1]=0;a[2]=
0;a[3]=0;a[4]=0;a[5]=-2*d;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*l;a[11]=0;a[12]=(c+e)*b;a[13]=(g+f)*d;a[14]=(k+h)*l;a[15]=1;return a};a.lookAt=function(a,c,e,f){var b=void 0,d=void 0,g=void 0,h=void 0,l=void 0,n=void 0,p=void 0,A=void 0,B=void 0,D=void 0,C=c[0],E=c[1];c=c[2];g=f[0];h=f[1];f=f[2];p=e[0];A=e[1];e=e[2];if(Math.abs(C-p)<m.EPSILON&&Math.abs(E-A)<m.EPSILON&&Math.abs(c-e)<m.EPSILON)return k(a);p=C-p;A=E-A;B=c-e;D=1/Math.sqrt(p*p+A*A+B*B);p*=D;A*=D;B*=D;b=h*B-f*A;d=f*p-g*B;g=g*A-h*p;(D=Math.sqrt(b*
b+d*d+g*g))?(D=1/D,b*=D,d*=D,g*=D):g=d=b=0;h=A*g-B*d;l=B*b-p*g;n=p*d-A*b;(D=Math.sqrt(h*h+l*l+n*n))?(D=1/D,h*=D,l*=D,n*=D):n=l=h=0;a[0]=b;a[1]=h;a[2]=p;a[3]=0;a[4]=d;a[5]=l;a[6]=A;a[7]=0;a[8]=g;a[9]=n;a[10]=B;a[11]=0;a[12]=-(b*C+d*E+g*c);a[13]=-(h*C+l*E+n*c);a[14]=-(p*C+A*E+B*c);a[15]=1;return a};a.targetTo=function(a,c,e,f){var b=c[0],d=c[1];c=c[2];var g=f[0],h=f[1],k=f[2];f=b-e[0];var l=d-e[1];e=c-e[2];var m=f*f+l*l+e*e;0<m&&(m=1/Math.sqrt(m),f*=m,l*=m,e*=m);var n=h*e-k*l,k=k*f-g*e,g=g*l-h*f,m=
n*n+k*k+g*g;0<m&&(m=1/Math.sqrt(m),n*=m,k*=m,g*=m);a[0]=n;a[1]=k;a[2]=g;a[3]=0;a[4]=l*g-e*k;a[5]=e*n-f*g;a[6]=f*k-l*n;a[7]=0;a[8]=f;a[9]=l;a[10]=e;a[11]=0;a[12]=b;a[13]=d;a[14]=c;a[15]=1;return a};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],
2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};a.add=function(a,c,e){a[0]=c[0]+e[0];a[1]=c[1]+e[1];a[2]=c[2]+e[2];a[3]=c[3]+e[3];a[4]=c[4]+e[4];a[5]=c[5]+e[5];a[6]=c[6]+e[6];a[7]=c[7]+e[7];a[8]=c[8]+e[8];a[9]=c[9]+e[9];a[10]=c[10]+e[10];a[11]=c[11]+e[11];a[12]=c[12]+e[12];a[13]=c[13]+e[13];a[14]=c[14]+e[14];a[15]=c[15]+e[15];return a};a.subtract=c;
a.multiplyScalar=function(a,c,e){a[0]=c[0]*e;a[1]=c[1]*e;a[2]=c[2]*e;a[3]=c[3]*e;a[4]=c[4]*e;a[5]=c[5]*e;a[6]=c[6]*e;a[7]=c[7]*e;a[8]=c[8]*e;a[9]=c[9]*e;a[10]=c[10]*e;a[11]=c[11]*e;a[12]=c[12]*e;a[13]=c[13]*e;a[14]=c[14]*e;a[15]=c[15]*e;return a};a.multiplyScalarAndAdd=function(a,c,e,f){a[0]=c[0]+e[0]*f;a[1]=c[1]+e[1]*f;a[2]=c[2]+e[2]*f;a[3]=c[3]+e[3]*f;a[4]=c[4]+e[4]*f;a[5]=c[5]+e[5]*f;a[6]=c[6]+e[6]*f;a[7]=c[7]+e[7]*f;a[8]=c[8]+e[8]*f;a[9]=c[9]+e[9]*f;a[10]=c[10]+e[10]*f;a[11]=c[11]+e[11]*f;a[12]=
c[12]+e[12]*f;a[13]=c[13]+e[13]*f;a[14]=c[14]+e[14]*f;a[15]=c[15]+e[15]*f;return a};a.exactEquals=function(a,c){return a[0]===c[0]&&a[1]===c[1]&&a[2]===c[2]&&a[3]===c[3]&&a[4]===c[4]&&a[5]===c[5]&&a[6]===c[6]&&a[7]===c[7]&&a[8]===c[8]&&a[9]===c[9]&&a[10]===c[10]&&a[11]===c[11]&&a[12]===c[12]&&a[13]===c[13]&&a[14]===c[14]&&a[15]===c[15]};a.equals=function(a,c){var b=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],k=a[6],l=a[7],z=a[8],A=a[9],B=a[10],D=a[11],C=a[12],E=a[13],F=a[14];a=a[15];var I=c[0],J=c[1],
G=c[2],H=c[3],K=c[4],O=c[5],L=c[6],N=c[7],T=c[8],R=c[9],Q=c[10],S=c[11],U=c[12],X=c[13],V=c[14];c=c[15];return Math.abs(b-I)<=m.EPSILON*Math.max(1,Math.abs(b),Math.abs(I))&&Math.abs(d-J)<=m.EPSILON*Math.max(1,Math.abs(d),Math.abs(J))&&Math.abs(e-G)<=m.EPSILON*Math.max(1,Math.abs(e),Math.abs(G))&&Math.abs(f-H)<=m.EPSILON*Math.max(1,Math.abs(f),Math.abs(H))&&Math.abs(g-K)<=m.EPSILON*Math.max(1,Math.abs(g),Math.abs(K))&&Math.abs(h-O)<=m.EPSILON*Math.max(1,Math.abs(h),Math.abs(O))&&Math.abs(k-L)<=m.EPSILON*
Math.max(1,Math.abs(k),Math.abs(L))&&Math.abs(l-N)<=m.EPSILON*Math.max(1,Math.abs(l),Math.abs(N))&&Math.abs(z-T)<=m.EPSILON*Math.max(1,Math.abs(z),Math.abs(T))&&Math.abs(A-R)<=m.EPSILON*Math.max(1,Math.abs(A),Math.abs(R))&&Math.abs(B-Q)<=m.EPSILON*Math.max(1,Math.abs(B),Math.abs(Q))&&Math.abs(D-S)<=m.EPSILON*Math.max(1,Math.abs(D),Math.abs(S))&&Math.abs(C-U)<=m.EPSILON*Math.max(1,Math.abs(C),Math.abs(U))&&Math.abs(E-X)<=m.EPSILON*Math.max(1,Math.abs(E),Math.abs(X))&&Math.abs(F-V)<=m.EPSILON*Math.max(1,
Math.abs(F),Math.abs(V))&&Math.abs(a-c)<=m.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))};a.mul=l;a.sub=c})},"esri/core/libs/gl-matrix-2/mat4f64":function(){define(["require","exports","./factories/mat4f64"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.mat4f64=e})},"esri/core/libs/gl-matrix-2/factories/mat4f64":function(){define(["require","exports"],function(f,a){function e(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}Object.defineProperty(a,"__esModule",{value:!0});a.create=e;a.clone=
function(a){return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]};a.fromValues=function(a,e,f,g,c,h,b,d,n,p,r,q,x,u,v,y){return[a,e,f,g,c,h,b,d,n,p,r,q,x,u,v,y]};a.createView=function(a,e){return new Float64Array(a,e,16)};a.IDENTITY=e()})},"esri/views/3d/support/debugFlags":function(){define(["require","exports","tslib","../../../core/Accessor","../../../core/accessorSupport/decorators"],function(f,a,e,m,k){return new (function(a){function f(){var c=null!==
a&&a.apply(this,arguments)||this;c.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1;c.SCENEVIEW_LOCKING_LOG=!1;c.HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED=!1;c.HIGHLIGHTS_PROFILE_TO_CONSOLE=!1;c.DECONFLICTOR_SHOW_VISIBLE=!1;c.DECONFLICTOR_SHOW_INVISIBLE=!1;c.DECONFLICTOR_SHOW_GRID=!1;c.LABELS_SHOW_BORDER=!1;c.OVERLAY_DRAW_DEBUG_TEXTURE=!1;c.OVERLAY_SHOW_CENTER=!1;c.TERRAIN_DEBUG_POPUP=!1;c.TESTS_DISABLE_UPDATE_THRESHOLDS=!1;c.DISABLE_DECONFLICTOR_VISIBILITY_OFFSET=!1;c.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES=
!1;c.DRAW_MESH_GEOMETRY_NORMALS=!1;c.FEATURE_TILE_FETCH_SHOW_TILES=!1;c.FEATURE_TILE_TREE_SHOW_TILES=!1;c.I3S_TREE_SHOW_TILES=!1;c.I3S_SHOW_MODIFICATIONS=!1;c.ENABLE_PROFILE_DEPTH_RANGE=!1;c.DISABLE_FAST_UPDATES=!1;c.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1;c.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1;c.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1;return c}e.__extends(f,a);e.__decorate([k.property()],f.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0);e.__decorate([k.property()],f.prototype,"SCENEVIEW_LOCKING_LOG",
void 0);e.__decorate([k.property()],f.prototype,"HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED",void 0);e.__decorate([k.property()],f.prototype,"HIGHLIGHTS_PROFILE_TO_CONSOLE",void 0);e.__decorate([k.property()],f.prototype,"DECONFLICTOR_SHOW_VISIBLE",void 0);e.__decorate([k.property()],f.prototype,"DECONFLICTOR_SHOW_INVISIBLE",void 0);e.__decorate([k.property()],f.prototype,"DECONFLICTOR_SHOW_GRID",void 0);e.__decorate([k.property()],f.prototype,"LABELS_SHOW_BORDER",void 0);e.__decorate([k.property()],f.prototype,
"OVERLAY_DRAW_DEBUG_TEXTURE",void 0);e.__decorate([k.property()],f.prototype,"OVERLAY_SHOW_CENTER",void 0);e.__decorate([k.property()],f.prototype,"TERRAIN_DEBUG_POPUP",void 0);e.__decorate([k.property()],f.prototype,"TESTS_DISABLE_UPDATE_THRESHOLDS",void 0);e.__decorate([k.property()],f.prototype,"DISABLE_DECONFLICTOR_VISIBILITY_OFFSET",void 0);e.__decorate([k.property()],f.prototype,"DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES",void 0);e.__decorate([k.property()],f.prototype,"DRAW_MESH_GEOMETRY_NORMALS",
void 0);e.__decorate([k.property()],f.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0);e.__decorate([k.property()],f.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0);e.__decorate([k.property()],f.prototype,"I3S_TREE_SHOW_TILES",void 0);e.__decorate([k.property()],f.prototype,"I3S_SHOW_MODIFICATIONS",void 0);e.__decorate([k.property()],f.prototype,"ENABLE_PROFILE_DEPTH_RANGE",void 0);e.__decorate([k.property()],f.prototype,"DISABLE_FAST_UPDATES",void 0);e.__decorate([k.property()],f.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",
void 0);e.__decorate([k.property()],f.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0);e.__decorate([k.property()],f.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0);return f=e.__decorate([k.subclass("esri.views.3d.support.DebugFlags")],f)}(m))})},"esri/views/2d/layers/features/support/ClusterStore":function(){define("require exports tslib ../../../../../geometry ../../../../../core/has ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/screenUtils ../../../../../geohash/GeohashTree ../../../../../geohash/geohashUtils ../../../../../geometry/support/spatialReferenceUtils ../../../../../geometry/support/webMercatorUtils ../../../../../layers/graphics/OptimizedFeature ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/data/FeatureStore ../../../../../layers/graphics/data/projectionSupport ../../../../../layers/graphics/data/QueryEngine ../../../../../layers/graphics/data/utils ../../../../../support/arcadeOnDemand ../../../arcade/utils ../../../engine/webgl/definitions".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u,v,y,z,A){function B(a,b,c){return e.__awaiter(this,void 0,void 0,function(){var d,f,h,k;return e.__generator(this,function(e){d=[];f=0;for(h=a;f<h.length;f++)k=h[f],d.push(D(k,b,c));return[2,g.all(d)]})})}function D(a,b,c){return e.__awaiter(this,void 0,void 0,function(){var d,f,g;return e.__generator(this,function(e){switch(e.label){case 0:if(!("onStatisticValueExpression"in a.outStatistic))return[3,2];d=a;f=d.outStatistic.onStatisticValueExpression;g=d;
return[4,y.createRendererExpression(f,b,c)];case 1:return g.expression=e.sent(),[2,d];case 2:return[2,a]}})})}Object.defineProperty(a,"__esModule",{value:!0});var C=function(a){return l.andThen(a,function(a){return"cluster"!==a.type?null:e.__assign(e.__assign({},a),{clusterRadius:c.pt2px(a.clusterRadius/2)})})},E=function(a){function b(b,c,d,e,f){var g=this;c=new r.default([],[c,d]);g=a.call(this,c,e,null,b)||this;g.invalid=!1;g.canDelete=!1;g.geohashBoundsInfo=f;return g}e.__extends(b,a);Object.defineProperty(b.prototype,
"count",{get:function(){return this.attributes.cluster_count},enumerable:!0,configurable:!0});b.create=function(a,c,d,e,f,g,h){c=new b(c,d,e,g,h);c.localId=a.createLocalId(c.objectId,!0);c.tileLevel=f;return c};b.prototype.update=function(a,b,c,d,e){this.geometry.coords[0]=a;this.geometry.coords[1]=b;this.tileLevel=c;this.attributes=d;this.geohashBoundsInfo=e;this.referenceId=null;this.invalid=!1;return this};b.prototype.toJSON=function(){return{objectId:this.objectId,referenceId:this.referenceId,
attributes:e.__assign(e.__assign({},this.attributes),{clusterId:this.objectId}),geometry:{x:this.geometry.coords[0],y:this.geometry.coords[1]}}};return b}(p.default);f=function(a){function c(b,c,d,e){b=a.call(this,b)||this;b._deferredDeletionQueue=[];b._invalidated=!1;b._aggregateFieldsHash=null;b._geohashLevel=0;b._aggregateValueRanges={};b._aggregateValueRangesChanged=!1;b._aggregateFields=[];b._hasAggregateValueExpression=!1;b._hasViewExpression=!1;b._$view={scale:0,viewingMode:"none"};b._clusters=
new Map;b._tiles=new Map;b._spatialReference=c;b._attributeStore=d;b._featureReduction=C(e);b._projectionSupportCheck=x.checkProjectionSupport(c,m.SpatialReference.WGS84);return b}e.__extends(c,a);c.prototype.setScale=function(a){var b=a!==this._$view.scale&&this._hasViewExpression,c=this._featureReduction;this._$view.scale=a;l.isSome(c)&&b&&(this._tree=new h.GeohashTree(this._aggregateFields),this._unindexFeatures(),this._reindexFeatures(!0))};c.prototype.update=function(a,b,c){return e.__awaiter(this,
void 0,void 0,function(){var d,f,g,k,m,n,p,q,r,u,v,x=this;return e.__generator(this,function(e){switch(e.label){case 0:d=this._featureReduction;f=l.andThen(b.featureReduction,C);g=b.aggregateFields.reduce(function(a,b){return a+JSON.stringify(b)},"");k=null===d&&b.featureReduction;m=g!==this._aggregateFieldsHash;n=k||m;if(!m)return[3,2];p=this;return[4,B(b.aggregateFields,this._spatialReference,c)];case 1:p._aggregateFields=e.sent();this._hasViewExpression=!1;q=0;for(r=this._aggregateFields;q<r.length;q++)u=
r[q],"onStatisticValueExpression"in u.outStatistic&&(v=u,this._hasAggregateValueExpression=!0,this._hasViewExpression=this._hasViewExpression||v.expression.referencesScale());e.label=2;case 2:return[4,this._projectionSupportCheck];case 3:e.sent();this._featureReduction=f;this._aggregateFieldsHash=g;this._aggregateValueRanges={};this._invalidated=!0;if(l.isNone(f))return this._tree=null,[2];l.isSome(d)&&d.clusterRadius!==f.clusterRadius&&this._clusters.forEach(function(a){return a.canDelete=!0});n&&
(this._tree=new h.GeohashTree(b.aggregateFields),this._unindexFeatures());(n||a)&&this._reindexFeatures(m);this._handleClusterUpdates();this._tiles.forEach(function(a){return x._getClustersForTile(a,0,f.clusterRadius,null,!1)});return[2]}})})};c.prototype._ensureAggregateFields=function(a){if(this._hasAggregateValueExpression)for(var b=this._$view,c=0,d=this._aggregateFields;c<d.length;c++){var e=d[c];"onStatisticValueExpression"in e.outStatistic&&(a.attributes[e.outStatistic.onStatisticField]=z.callWithOptimizedFeature(e.expression,
a,{$view:b},this.geometryInfo))}};c.prototype._unindexFeatures=function(){this._featuresById.forEach(function(a){a.geohashIndexed=!1})};c.prototype._reindexFeatures=function(a){var b=this;this._featuresById.forEach(function(c){c.geohashX||c.geohashY||b._setGeohash(c);a&&b._ensureAggregateFields(c);b._attributeStore.isVisible(c)?b._insertIntoIndex(c):b._removeFromIndex(c)})};c.prototype.onTileUpdate=function(a){var b=this,c=a.added;a=a.removed;if(c.length){var d=Math.max.apply(Math,c.map(function(a){return a.level}));
this._setGeohashLevel(d);c.forEach(function(a){return b._tiles.set(a.key.id,a)})}if(!l.isNone(this._featureReduction)){var e=this._featureReduction.clusterRadius;a.forEach(function(a){b._tiles.delete(a.key.id);b._markTileClustersForDeletion(a,e)})}};c.prototype.sweepClusters=function(){var a=this;this._clusters.forEach(function(b,c){b.canDelete&&(a._attributeStore.freeLocalId(b.objectId),a._clusters.delete(c))});for(var b=0,c=this._deferredDeletionQueue;b<c.length;b++)this._attributeStore.addLocalId(c[b]);
this._deferredDeletionQueue=[]};c.prototype.executeTileQuery=function(b,c,d){return e.__awaiter(this,void 0,void 0,function(){var f,g,h;return e.__generator(this,function(e){switch(e.label){case 0:return l.isNone(this._featureReduction)?[2,a.prototype.executeTileQuery.call(this,b,c,d)]:[4,this._projectionSupportCheck];case 1:return e.sent(),this._handleClusterUpdates(),f=this._featureReduction.clusterRadius,g=this._getTransforms(b,c),h=this._getClustersForTile(b,d.pixelBuffer,f,g),this._aggregateValueRangesChanged&&
(this.events.emit("valueRangesChanged",{valueRanges:this._aggregateValueRanges}),this._aggregateValueRangesChanged=!1),[2,h]}})})};c.prototype.getAggregate=function(a){var b=null;this._clusters.forEach(function(c){c.localId===a&&(b=c.toJSON())});return b};c.prototype.getAggregateValueRanges=function(){return this._aggregateValueRanges};c.prototype._getClustersForTile=function(a,b,c,d,f){var g=this;void 0===f&&(f=!0);b=Math.max(b,50);var h=2*c,k=new Set,p=this._getGeohashLevel(a.key.level),q=Math.pow(2,
a.key.level)*Math.ceil(A.TILE_SIZE/h),r=Math.ceil(b/h)+2;c=Math.ceil(A.TILE_SIZE/h)+2*r;var y=a.key;b=Math.floor(y.col*A.TILE_SIZE/h)-r;h=Math.floor(y.row*A.TILE_SIZE/h)-r;r=b+c;c=h+c;for(var z=[],B=a.tileInfoView.getLODInfoAt(a.key.level),C=b;C<=r;C++){b=function(b){var c,h,r=C;B.wrap&&(r=0>C?C+q:C%q);var y=B.wrap&&0>C,A=B.wrap&&C%q!==C;b=D._lookupCluster(B,a.key.level,r,b,p);if(l.isSome(b)){r=l.andThen(d,function(a){return y?a.left:A?a.right:a.tile});if(f&&l.isNone(r)||!b.count)return"continue";
if(f&&1===b.count){var E=b.geohashBoundsInfo,F=E.xLL;h=E.yLL;c=E.xTR;var J=E.yTR,E=E.level,F=l.unwrap(D._tree).findSingleOccupancyNode(F,h,c,J,E),F=l.unwrap(F).getLngLatBounds(),E={x:F[0],y:F[1]};h={x:F[2],y:F[3]};var G=J=c=F=0;if(D._spatialReference.isWebMercator)c=n.lngLatToXY(E.x,E.y),F=c[0],c=c[1],h=n.lngLatToXY(h.x,h.y),J=h[0],G=h[1];else{c=x.project(E,m.SpatialReference.WGS84,D._spatialReference);h=x.project(h,m.SpatialReference.WGS84,D._spatialReference);if(!c||!h)return"continue";F=c.x;c=
c.y;J=h.x;G=h.y}var I=null;D.forEachInBounds([F,c,J,G],function(a){g._attributeStore.isVisible(a)&&(I=a)});if(!I)return"continue";r=v.getGeometry(D.geometryInfo.geometryType,D.geometryInfo.hasZ,D.geometryInfo.hasM,I.geometry,0,l.unwrap(r));F=e.__assign(e.__assign({},I.attributes),b.attributes);b.referenceId=I.localId;k.add(b.objectId);z.push(new u.Feature(F,b.localId,r))}else f&&(k.add(b.objectId),r=v.getGeometry(D.geometryInfo.geometryType,D.geometryInfo.hasZ,D.geometryInfo.hasM,b.geometry,0,l.unwrap(r)),
z.push(new u.Feature(b.attributes,b.localId,r)))}};for(var D=this,y=h;y<=c;y++)b(y)}return{features:z,objectIds:k}};c.prototype._getGeohashLevel=function(a){return Math.min(Math.ceil(a/2+2),12)};c.prototype._setGeohashLevel=function(a){var b=this,c=this._geohashLevel;a=this._getGeohashLevel(a);a=2*(Math.floor(a/2)+1)-1;var d=this._tree;this._geohashLevel=a;l.isNone(d)||(a>c?(d.dropLevels(0),this._featuresById.forEach(function(a){a.geohashIndexed&&(b._setGeohash(a),d.insert(a,b._geohashLevel),a.geohashIndexed=
!0)})):a<c&&d.dropLevels(this._geohashLevel))};c.prototype._insertIntoIndex=function(a){a.geohashIndexed||(this._invalidated=!0,a.geohashIndexed=!0,l.unwrap(this._tree).insert(a,this._geohashLevel))};c.prototype._removeFromIndex=function(a){a.geohashIndexed&&(this._invalidated=!0,l.unwrap(this._tree).remove(a,this._geohashLevel),a.geohashIndexed=!1)};c.prototype._handleClusterUpdates=function(){var a=this;this._invalidated&&this._clusters.size&&this._clusters.forEach(function(b){l.isSome(b)&&(b.invalid=
b.invalid||a._invalidated)});this._invalidated=!1};c.prototype._getTransforms=function(a,b){var c={originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[a.bounds[0],a.bounds[3]]};b=d.getInfo(b);if(!b)return{tile:c,left:null,right:null};var f=b.valid;b=f[0];var g=f[1],f=e.__assign(e.__assign({},c),{translate:[g,a.bounds[3]]});a=e.__assign(e.__assign({},c),{translate:[b-g+a.bounds[0],a.bounds[3]]});return{tile:c,left:f,right:a}};c.prototype._getClusterId=function(a,b,c){return(a&15)<<
28|(b&16383)<<14|c&16383};c.prototype._markForDeletion=function(a,b,c){a=this._getClusterId(a,b,c);this._clusters.has(a)&&(b=this._clusters.get(a),l.isSome(b)?b.canDelete=!0:this._clusters.delete(a))};c.prototype._getClusterBounds=function(a,b,c){if(l.isNone(this._featureReduction))return null;var d=this._featureReduction.clusterRadius,e=2*d;b=c%2?b*e:b*e+d;var f=c*e,d=f/A.TILE_SIZE;c=(b+e)/A.TILE_SIZE;e=(f-e)/A.TILE_SIZE;b=a.getXForColumn(b/A.TILE_SIZE);d=a.getYForRow(d);c=a.getXForColumn(c);a=a.getYForRow(e);
return[b,d,c,a]};c.prototype._lookupCluster=function(a,c,d,f,g){var h,k;if(l.isNone(this._featureReduction)||l.isNone(this._tree))return null;var p=this._getClusterId(c,d,f),q=this._clusters.get(p);if(q&&l.isSome(q)&&!q.invalid&&!q.canDelete)return q;var r=this._getClusterBounds(a,d,f);a=r[0];d=r[1];f=r[2];var r=r[3],u={x:a,y:d};k={x:f,y:r};var v=0,y=h=0,z=0;if(this._spatialReference.isWebMercator)h=n.xyToLngLat(u.x,u.y),v=h[0],h=h[1],k=n.xyToLngLat(k.x,k.y),y=k[0],z=k[1];else{h=x.project(u,this._spatialReference,
m.SpatialReference.WGS84);k=x.project(k,this._spatialReference,m.SpatialReference.WGS84);if(!h||!k)return null;v=h.x;h=h.y;y=k.x;z=k.y}v>y&&(y=180);u={geohashX:0,geohashY:0};k={geohashX:0,geohashY:0};b.setGeohashXY(u,h,v,g);b.setGeohashXY(k,z,y,g);h=u.geohashX;y=u.geohashY;z=k.geohashX;k=k.geohashY;v={xLL:h,yLL:y,xTR:z,yTR:k,level:g};y=this._tree.getRegionStatistics(h,y,z,k,g);g=y.count;h=y.xTotal;k=y.yTotal;h=g?h/g:0;k=g?k/g:0;l.isSome(q)&&q.canDelete&&(z=this._attributeStore.removeLocalId(q.objectId),
this._deferredDeletionQueue.push(z));z=l.isSome(q)&&!q.canDelete&&q.invalid;y=e.__assign({cluster_count:g},y.attributes);u=this._attributeStore;c=z?q.update(h,k,c,y,v):E.create(u,p,h,k,c,y,v);0===g&&(c.geometry.coords[0]=(a+f)/2,c.geometry.coords[1]=(d+r)/2);this._attributeStore.setAttributeData(c.localId,c,this.geometryInfo,null);this._clusters.set(p,c);this._updateAggregateValueRangeForCluster(c,c.tileLevel);return c};c.prototype._updateAggregateValueRangeForCluster=function(a,b){var c=this._aggregateValueRanges[b]||
{minValue:Infinity,maxValue:0},d=c.minValue,e=c.maxValue;c.minValue=Math.min(d,a.count);c.maxValue=Math.max(e,a.count);this._aggregateValueRanges[b]=c;if(d!==c.minValue||e!==c.maxValue)this._aggregateValueRangesChanged=!0};c.prototype._markTileClustersForDeletion=function(a,b){var c=2*b;b=Math.ceil(A.TILE_SIZE/c);for(var d=a.key,e=Math.floor(d.col*A.TILE_SIZE/c),c=Math.floor(d.row*A.TILE_SIZE/c),d=e;d<e+b;d++)for(var f=c;f<c+b;f++)this._markForDeletion(a.key.level,d,f)};c.prototype._setGeohash=function(a){var c=
a.geometry;c&&c.coords.length&&(c=x.project({x:c.coords[0],y:c.coords[1]},this._spatialReference,m.SpatialReference.WGS84))&&b.setGeohashXY(a,c.y,c.x,12)};c.prototype._add=function(b){var c=this._featuresById.get(b.objectId);a.prototype._add.call(this,b);this._ensureAggregateFields(b);l.isSome(this._featureReduction)&&l.isSome(this._tree)&&(c?(b.geohashIndexed=c.geohashIndexed,b.geohashX=c.geohashX,b.geohashY=c.geohashY):this._setGeohash(b),!b.geohashIndexed&&this._attributeStore.isVisible(b)&&this._insertIntoIndex(b))};
c.prototype._remove=function(b){l.isSome(this._featureReduction)&&l.isSome(this._tree)&&this._removeFromIndex(b);return a.prototype._remove.call(this,b)};return c}(q.default);a.ClusterStore=f})},"esri/geohash/GeohashTree":function(){define(["require","exports","../core/CircularArray","../core/maybe","./geohashUtils"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(a){this._pool=new e.default(8024);this._nodes=0;this._root=new l(0,0,0);this._fields=a}a.prototype._acquire=
function(a,e,b){var c=this._pool.dequeue();this._nodes++;return m.isSome(c)?c.realloc(a,e,b):new l(a,e,b)};a.prototype._release=function(a){this._nodes--;this._pool.enqueue(a)};Object.defineProperty(a.prototype,"count",{get:function(){return this._root.count},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._nodes},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"poolSize",{get:function(){return this._pool.size},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"depth",{get:function(){var a=0;this._forEachNode(function(c){return a=Math.max(a,c.depth)});return a},enumerable:!0,configurable:!0});a.prototype.dropLevels=function(a){var c=this;this._forEachNode(function(b){if(b.depth>=a)for(var d=0;d<b.children.length;d++){var e=b.children[d];b.children[d]=null;e&&c._release(e)}})};a.prototype.insert=function(a,e,b){void 0===b&&(b=0);for(var c=this._root,f=0,g=0,h=0;null!==c;){c.depth>=b&&(c.count+=1,c.xTotal+=a.geometry.coords[0],
c.yTotal+=a.geometry.coords[1],c.xGeohashTotal+=a.geohashX,c.yGeohashTotal+=a.geohashY,this._updateStatistics(a,c,1));if(f>=e)break;var k=Math.ceil((f+1)/2),l=Math.floor((f+1)/2),m=1-f%2,v=30-(3*k+2*l),k=30-(2*k+3*l),v=(a.geohashX&7*m+3*(1-m)<<v)>>v,k=(a.geohashY&3*m+7*(1-m)<<k)>>k,l=v+k*(8*m+4*(1-m)),y=2*m+3*(1-m),g=g<<3*m+2*(1-m)|v,h=h<<y|k;null==c.children[l]&&(c.children[l]=this._acquire(g,h,f+1));f+=1;c=c.children[l]}};a.prototype.remove=function(a,e){for(var b=this._root,c=0;null!==b;){--b.count;
b.xTotal-=a.geometry.coords[0];b.yTotal-=a.geometry.coords[1];b.xGeohashTotal-=a.geohashX;b.yGeohashTotal-=a.geohashY;this._updateStatistics(a,b,-1);if(c>=e)break;var f=Math.ceil((c+1)/2),g=Math.floor((c+1)/2),h=1-c%2,k=30-(3*f+2*g),f=30-(2*f+3*g),h=((a.geohashX&7*h+3*(1-h)<<k)>>k)+((a.geohashY&3*h+7*(1-h)<<f)>>f)*(8*h+4*(1-h)),k=b.children[h];1===k.count&&(this._release(k),b.children[h]=null);c+=1;b=k}};a.prototype.find=function(a,e,b){return this._root.find(a,e,b,0,0,0)};a.prototype.findSingleOccupancyNode=
function(a,e,b,d,f){for(var c=this._root;null!==c;){var g=c.depth,h=c.xNode,k=c.yNode,l=1-g%2,m=c.xGeohashTotal/c.count,n=c.yGeohashTotal/c.count;if(1===c.count&&a<m&&m<=b&&e<n&&n<=d)return c;if(g>=f)c=c.next;else{for(var m=Math.ceil((g+1)/2),g=Math.floor((g+1)/2),z=30-(3*m+2*g),m=30-(2*m+3*g),A=~((1<<z)-1),n=~((1<<m)-1),h=h<<3*l+2*(1-l),k=k<<2*l+3*(1-l),g=Math.max(h,(a&A)>>z),z=Math.min(h+8*l+4*(1-l),(b&A)>>z),A=Math.min(k+4*l+8*(1-l),(d&n)>>m),B=null,D=null,m=Math.max(k,(e&n)>>m);m<=A;m++)for(n=
g;n<=z;n++){var C=c.children[n-h+(m-k)*(8*l+4*(1-l))];C&&(B||(B=C,B.next=c.next),D&&(D.next=C),D=C,C.next=c.next)}c=B||c.next}}return null};a.prototype.getRegionStatistics=function(a,e,b,d,f){for(var c=this._root,g=0,h=0,k=0,l={};null!==c;){var m=c.depth,n=c.xNode,z=c.yNode;if(m>=f){var A=c.xGeohashTotal/c.count,B=c.yGeohashTotal/c.count;a<A&&A<=b&&e<B&&B<=d&&(g+=c.count,h+=c.xTotal,k+=c.yTotal,this._aggregateStatistics(l,c.statistics));c=c.next}else{for(var D=Math.ceil((m+1)/2),C=Math.floor((m+1)/
2),m=1-m%2,E=30-(3*D+2*C),A=30-(2*D+3*C),F=~((1<<E)-1),B=~((1<<A)-1),n=n<<3*m+2*(1-m),z=z<<2*m+3*(1-m),D=Math.max(n,(a&F)>>E),C=Math.max(z,(e&B)>>A),E=Math.min(n+8*m+4*(1-m),(b&F)>>E),F=Math.min(z+4*m+8*(1-m),(d&B)>>A),I=null,J=null,G=C;G<=F;G++)for(var H=D;H<=E;H++){var K=c.children[H-n+(G-z)*(8*m+4*(1-m))];K&&(G!==C&&G!==F&&H!==D&&H!==E?(A=K.xGeohashTotal/K.count,B=K.yGeohashTotal/K.count,a<A&&A<=b&&e<B&&B<=d&&(g+=K.count,h+=K.xTotal,k+=K.yTotal,this._aggregateStatistics(l,K.statistics))):(I||(I=
K,I.next=c.next),J&&(J.next=K),J=K,K.next=c.next))}c=I||c.next}}a=this._normalizeStatistics(l,g);return{count:g,attributes:a,xTotal:h,yTotal:k}};a.prototype._forEachNode=function(a){for(var c=this._root;null!==c;){var b=this._linkChildren(c)||c.next;a(c);c=b}};a.prototype._linkChildren=function(a){for(var c=null,b=null,d=0;d<=a.children.length;d++){var e=a.children[d];e&&(c||(c=e,c.next=a.next),b&&(b.next=e),b=e,e.next=a.next)}return c};a.prototype._updateStatistics=function(a,e,b){for(var c=0,f=
this._fields;c<f.length;c++){var g=f[c],h=g.name,k=a.attributes[g.outStatistic.onStatisticField];switch(g.outStatistic.statisticType){case "norm":e.statistics[h]||(e.statistics[h]={});var g=a.attributes[g.outStatistic.onStatisticNormalizationField],l=e.statistics[h].onStatisticField||0,m=e.statistics[h].onStatisticNormalizationField||0;null==k||isNaN(k)||null==g||0===g||isNaN(g)||(e.statistics[h].onStatisticField=l+b*k,e.statistics[h].onStatisticNormalizationField=m+b*g);break;case "sum":case "avg":e.statistics[h]||
(e.statistics[h]={value:0,nanCount:0});l=e.statistics[h].value;g=e.statistics[h].nanCount;null==k||isNaN(k)?e.statistics[h].nanCount=g+b:e.statistics[h].value=l+b*k;break;case "avg_angle":e.statistics[h]||(e.statistics[h]={x:0,y:0,nanCount:0});var l=e.statistics[h].x,m=e.statistics[h].y,g=e.statistics[h].nanCount,v=Math.PI/180;null==k||isNaN(k)?e.statistics[h].nanCount=g+b:(e.statistics[h].x=l+b*Math.cos(k*v),e.statistics[h].y=m+b*Math.sin(k*v));break;case "mode":e.statistics[h]||(e.statistics[h]=
{}),l=e.statistics[h][k]||0,e.statistics[h][k]=l+b}}};a.prototype._aggregateStatistics=function(a,e){for(var b=0,c=this._fields;b<c.length;b++){var f=c[b],g=f.name;switch(f.outStatistic.statisticType){case "sum":case "avg":case "avg_angle":case "mode":case "norm":a[g]||(a[g]={});for(var h in e[g])a[g][h]=(a[g][h]||0)+e[g][h]}}};a.prototype._normalizeStatistics=function(a,e){for(var b={},c=0,f=this._fields;c<f.length;c++){var g=f[c],h=g.name;switch(g.outStatistic.statisticType){case "norm":g=a[h];
if(e&&null==g.onStatisticNormalizationField)break;if(e&&g.onStatisticNormalizationField){b[h]=g.onStatisticField/g.onStatisticNormalizationField;break}b[h]=0;break;case "sum":if(!e)break;var k=a[h],g=k.value,k=k.nanCount;if(!(e-k))break;b[h]=g;break;case "avg":if(!e)break;k=a[h];g=k.value;k=k.nanCount;if(!(e-k))break;b[h]=g/(e-k);break;case "avg_angle":if(!e)break;var k=a[h],g=k.x,l=k.y,k=k.nanCount;if(!(e-k))break;b[h]=180/Math.PI*Math.atan2(l/(e-k),g/(e-k));break;case "mode":var g=a[h],k=0,l=null,
m;for(m in g){var v=g[m];v>k&&(k=v,l=m)}b[h]="null"===l?null:l}}return b};return a}();a.GeohashTree=f;var l=function(){function a(a,e,b){this.yTotal=this.xTotal=this.count=0;this.statistics={};this.next=null;this.yGeohashTotal=this.xGeohashTotal=this.yNode=this.xNode=this.depth=0;this.children=Array(32);for(var c=0;c<this.children.length;c++)this.children[c]=null;this.xNode=a;this.yNode=e;this.depth=b}a.prototype.realloc=function(a,e,b){for(var c=0;c<this.children.length;c++)this.children[c]=null;
this.xNode=a;this.yNode=e;this.depth=b;this.next=null;this.count=this.yTotal=this.xTotal=this.yGeohashTotal=this.xGeohashTotal=0;this.statistics={};return this};a.prototype.getLngLatBounds=function(){var a=this.depth,e=Math.ceil(a/2),a=Math.floor(a/2);return k.decodeGeohashXY({geohashX:this.xNode<<30-(3*e+2*a),geohashY:this.yNode<<30-(2*e+3*a)},this.depth)};a.prototype.find=function(a,e,b,d,f,g){if(d>=b)return this;var c=1-d%2,h=3*c+2*(1-c),k=2*c+3*(1-c),l=30-f-h,m=30-g-k,c=this.children[((a&7*c+
3*(1-c)<<l)>>l)+((e&3*c+7*(1-c)<<m)>>m)*(8*c+4*(1-c))];return null==c?null:c.find(a,e,b,d+1,f+h,g+k)};return a}()})},"esri/geohash/geohashUtils":function(){define(["require","exports"],function(f,a){function e(a){return 57>=a?a-48:104>=a?a-88:107>=a?a-89:110>=a?a-90:a-91}function m(a,b,c){a[0]=b;a[1]=c;return a}function k(a,b){var c=(a[0]+a[1])/2,d=!b;a[0]=d*a[0]+b*c;a[1]=d*c+b*a[1]}function l(a,b){b=b>(a[0]+a[1])/2;k(a,b);return b}function g(a,b){for(var c=m(r,-90,90),d=m(q,-180,180),f=0;f<b.length;f++){var g=
b.charCodeAt(f),g=e(g);0===f%2?(k(d,!!(16&g)),k(d,!!(4&g)),k(d,!!(1&g)),k(c,!!(8&g)),k(c,!!(2&g))):(k(c,!!(16&g)),k(c,!!(4&g)),k(c,!!(1&g)),k(d,!!(8&g)),k(d,!!(2&g)))}a[0]=(c[0]+c[1])/2;a[1]=(d[0]+d[1])/2;return a}function c(a,b,c){for(var d="",e=m(r,-90,90),f=m(q,-180,180),g=0;g<c;g++){var h=0;g%2?(h|=l(e,a)<<4,h|=l(f,b)<<3,h|=l(e,a)<<2,h|=l(f,b)<<1,h|=l(e,a)<<0):(h|=l(f,b)<<4,h|=l(e,a)<<3,h|=l(f,b)<<2,h|=l(e,a)<<1,h|=l(f,b)<<0);d+="0123456789bcdefghjkmnpqrstuvwxyz"[h]}return d}function h(a){return 180/
Math.pow(2,Math.floor(5*a/2))}function b(a){return 360/Math.pow(2,Math.ceil(5*a/2))}function d(a,b){return b?1&a|(4&a)>>1|(16&a)>>2:(2&a)>>1|(8&a)>>2}function n(a,b){return b?(2&a)>>1|(8&a)>>2:1&a|(4&a)>>1|(16&a)>>2}function p(a,b,c){var d=!((a.length-1)%2),f=a.substring(0,a.length-1),g=e(a.charCodeAt(a.length-1)),h=0,k=0,l=0,m=0;d?(h=8,k=4,l=1&g|(4&g)>>1|(16&g)>>2,m=(2&g)>>1|(8&g)>>2):(h=4,k=8,m=1&g|(4&g)>>1|(16&g)>>2,l=(2&g)>>1|(8&g)>>2);b=l+b;g=m+c;c=Math.floor(b/h);m=Math.floor(g/k);h=b-c*h;k=
g-m*k;d="0123456789bcdefghjkmnpqrstuvwxyz"[d?h&1|(k&1)<<1|(h&2)<<1|(k&2)<<2|(h&4)<<2:k&1|(h&1)<<1|(k&2)<<1|(h&2)<<2|(k&4)<<2];return 1<a.length&&(c||m)?p(f,c,m)+d:f+d}Object.defineProperty(a,"__esModule",{value:!0});var r=new Float64Array(2),q=new Float64Array(2);a.decodeBase32Char=e;a.encodeBase32Char=function(a){return"0123456789bcdefghjkmnpqrstuvwxyz"[a]};a.decodeGeohash=g;a.convertGeohash32ToXY=function(a,b){for(var c=a=0,f=30,g=30,h=0;h<b.length;h++){var k=b.charCodeAt(h),l=e(k),k=0===h%2,m=
d(l,k),l=n(l,k),f=f-(k?3:2),g=g-(k?2:3);a|=m<<f;c|=l<<g}return{geohashX:a,geohashY:c}};a.decodeGeohashXY=function(a,b){for(var c=-90,d=90,e=-180,f=180,g=0;g<b;g++){for(var h=Math.ceil((g+1)/2),k=Math.floor((g+1)/2),l=1-g%2,m=30-(3*h+2*k),n=30-(2*h+3*k),h=2*l+3*(1-l),k=(7*l+3*(1-l)<<m&a.geohashX)>>m,m=(3*l+7*(1-l)<<n&a.geohashY)>>n,l=3*l+2*(1-l)-1;0<=l;l--)var n=(e+f)/2,p=k&1<<l?1:0,e=(1-p)*e+p*n,f=(1-p)*n+p*f;for(l=h-1;0<=l;l--)h=(c+d)/2,k=m&1<<l?1:0,c=(1-k)*c+k*h,d=(1-k)*h+k*d}return[e,c,f,d]};a.setGeohashXY=
function(a,b,c,d){d%2&&(d+=1);for(var e=0,f=0,g=-90,h=90,k=-180,l=180,m=0;m<d/2;m++){for(var n=0;5>n;n++)var p=(k+l)/2,q=c>p?1:0,e=e|q<<29-(n+5*m),k=(1-q)*k+q*p,l=(1-q)*p+q*l;for(n=0;5>n;n++)p=(g+h)/2,q=b>p?1:0,f|=q<<29-(n+5*m),g=(1-q)*g+q*p,h=(1-q)*p+q*h}a.geohashX=e;a.geohashY=f};a.encodeGeohash=c;a.latDistPerGeohash=h;a.lonDistPerGeohash=b;a.unpackXBits=d;a.unpackYBits=n;a.getRelativeGeohash=p;a.getIntersectingGeohashes=function(a,d,e,f,g){e=Math.abs(e-a);f=Math.abs(f-d);var k=h(g),l=b(g);f=Math.ceil(f/
l);e=Math.ceil(e/k);a=c(a,d,g);d=[];for(g=0;g<f;g++)for(k=0;k<e;k++)d.push(p(a,g,k));return d};a.forEachIntersectingGeohash=function(a,d,e,f,k,l){var m=Math.abs(e-a),n=Math.abs(f-d),q=h(k),r=b(k),n=Math.ceil(n/r),m=Math.ceil(m/q);k=c(a,d,k);for(var u=0;u<n;u++)for(var v=0;v<m;v++){var y=p(k,u,v),x=g([0,0],y),z=x[0],x=x[1];l(y,Math.abs((Math.min(e,z+q/2)-Math.max(a,z-q/2))*(Math.min(f,x+r/2)-Math.max(d,x-r/2)))/(q*r))}}})},"esri/layers/graphics/data/FeatureStore":function(){define("require exports tslib ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../core/maybe ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./BoundsStore ./executeTileQuery ./optimizedFeatureQueryEngineAdapter".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r){Object.defineProperty(a,"__esModule",{value:!0});var q=l.getLogger("esri.layers.graphics.data.FeatureStore");f=function(){function a(a){this.geometryInfo=a;this._boundsStore=new n.BoundsStore;this._featuresById=new Map;this._markedIds=new Set;this.events=new k;this.featureAdapter=r.optimizedFeatureQueryEngineAdapter}Object.defineProperty(a.prototype,"geometryType",{get:function(){return this.geometryInfo.geometryType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"hasM",{get:function(){return this.geometryInfo.hasM},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasZ",{get:function(){return this.geometryInfo.hasZ},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullBounds",{get:function(){var a=this;if(!this.numFeatures)return null;var b=h.create(h.NEGATIVE_INFINITY);this._featuresById.forEach(function(c){if(c=
a._boundsStore.get(c.objectId))b[0]=Math.min(c[0],b[0]),b[1]=Math.min(c[1],b[1]),b[2]=Math.max(c[2],b[2]),b[3]=Math.max(c[3],b[3])});return b},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"storeStatistics",{get:function(){var a=0;this._featuresById.forEach(function(b){b.geometry&&b.geometry.coords&&(a+=b.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:a/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}},enumerable:!0,configurable:!0});a.prototype.add=
function(a){this._add(a);this._emitChanged()};a.prototype.addMany=function(a){for(var b=0;b<a.length;b++)this._add(a[b]);this._emitChanged()};a.prototype.clear=function(){this._featuresById.clear();this._boundsStore.clear();this._emitChanged()};a.prototype.removeById=function(a){a=this._featuresById.get(a);if(!a)return null;this._remove(a);this._emitChanged();return a};a.prototype.removeManyById=function(a){this._boundsStore.invalidateIndex();for(var b=0;b<a.length;b++){var c=this._featuresById.get(a[b]);
c&&this._remove(c)}this._emitChanged()};a.prototype.forEachBounds=function(a,b,d){for(var e=0;e<a.length;e++){var f=this._boundsStore.get(a[e].objectId);f&&b(c.fromRect(d,f))}};a.prototype.getFeature=function(a){return this._featuresById.get(a)};a.prototype.has=function(a){return this._featuresById.has(a)};a.prototype.forEach=function(a){this._featuresById.forEach(function(b){return a(b)})};a.prototype.forEachInBounds=function(a,b){var c=this;this._boundsStore.forEachInBounds(a,function(a){b(c._featuresById.get(a))})};
a.prototype.startMarkingUsedFeatures=function(){this._boundsStore.invalidateIndex();this._markedIds.clear()};a.prototype.sweep=function(){var a=this,b=!1;this._featuresById.forEach(function(c,d){a._markedIds.has(d)||(b=!0,a._remove(c))});this._markedIds.clear();b&&this._emitChanged()};a.prototype.executeTileQuery=function(a,c,d){return e.__awaiter(this,void 0,void 0,function(){var f,g,k,l,m,n,q,r,u,v,y,x,O,L;return e.__generator(this,function(e){f=d.returnGeometry;g=d.returnCentroid;k=d.returnOutline;
l=d.pixelBuffer;m=new Set;n=[];q=l*a.resolution;r=h.pad(a.bounds,q,h.create());p.createTileFeatures(n,m,this.geometryInfo,this,r,f,g,k,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[a.bounds[0],a.bounds[3]]});if("esriGeometryPoint"===this.geometryType||g)if(u=b.getInfo(c))v=u.valid,y=v[0],x=v[1],r[0]<y&&(O=h.fromValues(x-q,r[1],x,r[3]),p.createTileFeatures(n,m,this.geometryInfo,this,O,f,g,k,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[x,a.bounds[3]]})),
r[2]>x&&(L=h.fromValues(y,r[1],y+q,r[3]),p.createTileFeatures(n,m,this.geometryInfo,this,L,f,g,k,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[y-x+a.bounds[0],a.bounds[3]]}));n.sort(function(a,b){return a.localId-b.localId});return[2,{features:n,objectIds:m}]})})};a.prototype._emitChanged=function(){this.events.emit("changed",void 0)};a.prototype._add=function(a){if(a){var b=a.objectId;if(null==b)q.error(new m("featurestore:invalid-feature","feature id is missing",{feature:a}));
else{var c=this._featuresById.get(b),e;this._markedIds.add(b);if(c)a.localId=c.localId,e=this._boundsStore.get(b),this._boundsStore.delete(b);else if(g.isSome(this.onFeatureAdd))this.onFeatureAdd(a);a.geometry&&a.geometry.coords&&a.geometry.coords.length?(e=d.getBoundsOptimizedGeometry(e||h.create(),a.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),this._boundsStore.set(b,e)):this._boundsStore.set(b,null);this._featuresById.set(b,a)}}};a.prototype._remove=function(a){if(g.isSome(this.onFeatureRemove))this.onFeatureRemove(a);
this._markedIds.delete(a.objectId);this._boundsStore.delete(a.objectId);this._featuresById.delete(a.objectId);return a};return a}();a.default=f})},"esri/layers/graphics/data/BoundsStore":function(){define(["require","exports","../../../core/has","../../../core/libs/rbush/rbush","@dojo/framework/shim/Promise"],function(f,a,e,m){Object.defineProperty(a,"__esModule",{value:!0});var k={minX:0,minY:0,maxX:0,maxY:0};f=function(){function a(){var a=this;this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=
new Map;this._idByBounds=new Map;this._index=m(9,e("csp-restrictions")?function(a){return{minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}}:["[0]","[1]","[2]","[3]"]);this._loadIndex=function(){if(a._indexInvalid){var c=Array(a._idByBounds.size),e=0;a._idByBounds.forEach(function(a,d){c[e++]=d});a._indexInvalid=!1;a._index.clear();a._index.load(c)}else a._boundsToLoad.length&&(a._index.load(a._boundsToLoad.filter(function(b){return a._idByBounds.has(b)})),a._boundsToLoad.length=0)}}a.prototype.clear=function(){this._indexInvalid=
!1;this._boundsToLoad.length=0;this._boundsById.clear();this._idByBounds.clear();this._index.clear()};a.prototype.delete=function(a){var c=this._boundsById.get(a);this._boundsById.delete(a);c&&(this._idByBounds.delete(c),this._indexInvalid||this._index.remove(c))};a.prototype.forEachInBounds=function(a,c){this._loadIndex();var e=0,b=this._index;k.minX=a[0];k.minY=a[1];k.maxX=a[2];k.maxY=a[3];for(a=b.search(k);e<a.length;e++)c(this._idByBounds.get(a[e]))};a.prototype.get=function(a){return this._boundsById.get(a)};
a.prototype.has=function(a){return this._boundsById.has(a)};a.prototype.invalidateIndex=function(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)};a.prototype.set=function(a,c){if(!this._indexInvalid){var e=this._boundsById.get(a);e&&(this._index.remove(e),this._idByBounds.delete(e))}this._boundsById.set(a,c);c&&(this._idByBounds.set(c,a),this._indexInvalid||(this._boundsToLoad.push(c),5E4<this._boundsToLoad.length&&this._loadIndex()))};return a}();a.BoundsStore=f})},"esri/layers/graphics/data/executeTileQuery":function(){define("require exports ../../../geometry/support/aaBoundingRect ../featureConversionUtils ../OptimizedGeometry ./QueryEngine ./utils".split(" "),
function(f,a,e,m,k,l,g){function c(a,b,c,d,e,f){a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!b||!b.coords.length)return null;var g=b.coords;b=b.lengths;if(!b.length)return a.coords[0]=m.quantizeX(f,g[0]),a.coords[1]=m.quantizeY(f,g[1]),a.coords.length=c,a;for(var h,k,l,n,p=0,q,r=0,u=0;u<b.length;u++){var x=b[u];if(!(x<d))if(q=r,l=h=m.quantizeX(f,g[p]),n=k=m.quantizeY(f,g[p+1]),a.coords[q]=l,a.coords[q+1]=n,p+=c,1===x)a.lengths.push(1),r=q+2;else{l=m.quantizeX(f,
g[p]);n=m.quantizeY(f,g[p+1]);var J=l-h,G=n-k,H=G/J;q+=2;a.coords[q]=J;a.coords[q+1]=G;h=l;k=n;for(var p=p+c,K=2;K<x;K++){l=m.quantizeX(f,g[p]);n=m.quantizeY(f,g[p+1]);if(l!==h||n!==k){h=l-h;k=n-k;var O=k/h,H=H===O||!isFinite(H)&&!isFinite(O),L=(0<=G&&0<=k||0>=G&&0>=k)&&(0<=J&&0<=h||0>=J&&0>=h);H&&(e||L)?(J+=h,G+=k):(J=h,G=k,q+=2);a.coords[q]=J;a.coords[q+1]=G;H=O;h=l;k=n}p+=c}l=(q+2-r)/2;l>=d&&(a.lengths.push(l),r=q+2)}}a.coords.length>r&&(a.coords.length=r);return a.coords.length?a:null}Object.defineProperty(a,
"__esModule",{value:!0});var h=new k.default,b={esriGeometryPoint:m.convertToPoint,esriGeometryPolyline:m.convertToPolyline,esriGeometryPolygon:m.convertToPolygon,esriGeometryMultipoint:m.convertToMultipoint};a.executeTileQueryForIds=function(a,b,c){b=e.pad(b.bounds,c.pixelBuffer*b.resolution,e.create());var d=[];a.featureStore.forEachInBounds(b,function(b){return d.push(a.featureAdapter.getObjectId(b))});return d};a.createTileFeatures=function(a,e,f,k,m,u,v,y,z){var n=b[f.geometryType],p=d[f.geometryType],
q="esriGeometryPolygon"===f.geometryType&&!y,r=f.hasZ?f.hasM?4:3:f.hasM?3:2;v&&!u?k.forEachInBounds(m,function(b){if(!e.has(b.objectId)){var c=g.getCentroid(f,b,z),d=b.attributes;c&&(e.add(b.objectId),a.push(new l.Feature(d,b.localId,null,c)))}}):u&&!v?k.forEachInBounds(m,function(b){if(!e.has(b.objectId)){var d=b.attributes,f=n(c(h,b.geometry,r,p,q,z),!1,!1);f&&(e.add(b.objectId),a.push(new l.Feature(d,b.localId,f,null)))}}):k.forEachInBounds(m,function(b){if(!e.has(b.objectId)){var d=g.getCentroid(f,
b,z),k=b.attributes,m=n(c(h,b.geometry,r,p,q,z),!1,!1);m&&d&&(e.add(b.objectId),a.push(new l.Feature(k,b.localId,m,d)))}})};var d={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0};a.quantizeOptimizedGeometryForDisplay=c})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["require","exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});a.optimizedFeatureQueryEngineAdapter=
{getObjectId:function(a){return a.objectId},getAttributes:function(a){return a.attributes},getAttribute:function(a,e){return a.attributes[e]},cloneWithGeometry:function(a,e){return new m.default(e,a.attributes,null,a.objectId)},getGeometry:function(a){return a.geometry},getCentroid:function(a,f){a.centroid||(a.centroid=e.getCentroidOptimizedGeometry(new k.default,a.geometry,f.hasZ,f.hasM));return a.centroid}};a.default=a.optimizedFeatureQueryEngineAdapter})},"esri/views/2d/layers/features/support/pixelBuffering":function(){define("require exports tslib ../../../../../core/promiseUtils ../../../../../core/screenUtils ../../../../../symbols/cim/Rect ../../../engine ../../../engine/webgl/definitions ../../graphics/graphicsUtils".split(" "),
function(f,a,e,m,k,l,g,c,h){function b(a){if(!("visualVariables"in a&&a.hasVisualVariables("size")))return 0;a=a.getVisualVariablesForType("size");if(!a[0])return 0;a=a[0];if("stops"===a.transformationType)return a.stops.map(function(a){return a.size}).reduce(q,0);if("clamped-linear"===a.transformationType)return"number"===typeof a.maxSize?a.maxSize:a.maxSize.stops.map(function(a){return a.size}).reduce(q,0);if("real-world-size"===a.transformationType)return 30}function d(a,b){return null==a?b:a}
function n(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,f,k,l,m,p,q,x,y,z,K,O,L,N;return e.__generator(this,function(A){switch(A.label){case 0:if("simple-marker"===a.type)return c=Math.max(d(a.size,12),b),[2,r(a)+.707*c];if("picture-marker"===a.type)return f=Math.max(d(a.height,12),b),k=d(a.width,12)*(f/d(a.height,12)),l=k/2,m=f/2,[2,r(a)+Math.sqrt(l*l+m*m)];if("text"===a.type){if(A=a.text&&a.text.length){for(var B=[],C=0;C<A;C++)B.push(e.__assign(e.__assign({},v),{code:a.text.charCodeAt(C)}));
p={glyphMosaicItems:B}}else p={glyphMosaicItems:[v]};h.getTextSymbolSize(u,a,p);q=Math.abs(u[0]);x=Math.abs(u[1]);y=u[2];z=u[3];return[2,Math.max(q,x)+Math.max(y,z)]}if("simple-line"===a.type)return K=a,O=Math.max(d(K.width,.75),b)/2,K.marker?[2,Math.max(6*K.width,2*b)]:[2,O];if("simple-fill"===a.type||"picture-fill"===a.type)return[2,Math.max(null==a.outline?0:d(a.outline.width,0),b)/2];if("cim"===a.type)return(L=g.CIMSymbolHelper.getEnvelope(a.data))?[2,Math.sqrt(L.width*L.width+L.height*L.height)]:
[2,0];if("web-style"!==a.type)return[3,2];N=n;return[4,a.fetchCIMSymbol()];case 1:return[2,N.apply(void 0,[A.sent(),b])];case 2:return[2,0]}})})}function p(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d;return e.__generator(this,function(e){switch(e.label){case 0:if(!(a.type in x))return[2,0];d=(c=Math).min;return[4,n(a,b)];case 1:return[2,d.apply(c,[e.sent(),75])]}})})}function r(a){var b=d(a.xoffset,0);a=d(a.yoffset,0);return Math.sqrt(b*b+a*a)}function q(a,b){return Math.max(a,b)}
Object.defineProperty(a,"__esModule",{value:!0});var x={"simple-marker":1,"picture-marker":1,text:1,"simple-line":1,"simple-fill":1,"picture-fill":1,cim:1,"web-style":1};a.computePxBuffer=function(a,c){return e.__awaiter(this,void 0,void 0,function(){var d,f,g,h,l,n,r;return e.__generator(this,function(e){switch(e.label){case 0:if("heatmap"===a.type)return[2,Math.round(3*a.blurRadius)];if("dot-density"===a.type)return[2,0];if("dictionary"===a.type)return"esriGeometryPoint"===c||"esriGeometryMultipoint"===
c?[2,100]:[2,50];d=a.getSymbols();f=b(a);g=[];h=0;for(l=d;h<l.length;h++)n=l[h],g.push(p(n,f));return[4,m.all(g)];case 1:return r=e.sent(),[2,k.pt2px(r.reduce(q,0))]}})})};var u=[0,0,0,0],v={sdf:!0,code:99,metrics:c.AVERAGE_GLYPH_MOSAIC_ITEM.metrics,rect:new l.default(0,0,24,24),page:0,textureBinding:2}})},"esri/views/2d/layers/graphics/graphicsUtils":function(){define("require exports ../../../../core/maybe ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/mat2d ../../../../core/libs/gl-matrix-2/mat2df32 ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ../../../../geometry/SpatialReference ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/boundsUtils ../../../../geometry/support/intersects ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtils ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/support/spatialReferenceUtils ../../engine ../../engine".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u,v){function y(a,b,c,d,e,f){var h,l,n=m.pt2px(c.xoffset),p=m.pt2px(c.yoffset),q=K*c.angle;f*=K;switch(c.type){case "simple-marker":h=l=m.pt2px(c.size);break;case "picture-marker":h=m.pt2px(c.width),l=m.pt2px(c.height)}.04>e&&(d=.04*d/e);c=k.mat2d.identity(O);k.mat2d.translate(c,c,g.vec2.set(L,a,b));k.mat2d.rotate(c,c,f-q);k.mat2d.scale(c,c,g.vec2.set(L,d,-d));k.mat2d.translate(c,c,g.vec2.set(L,n,-p));a=[0,0];g.vec2.transformMat2d(a,g.vec2.set(L,-.5*h,-.5*
l),c);b=[0,0];g.vec2.transformMat2d(b,g.vec2.set(L,-.5*h,.5*l),c);d=[0,0];g.vec2.transformMat2d(d,g.vec2.set(L,.5*h,-.5*l),c);n=[0,0];g.vec2.transformMat2d(n,g.vec2.set(L,.5*h,.5*l),c);return{rings:[[a,d,n,b,a]]}}function z(a,b,c,d,e,f){var h=u.CIMSymbolHelper.getEnvelope(c.data);if(!h)return null;.04>e&&(d=.04*d/e);e=m.pt2px(h.width);var l=m.pt2px(h.height);c=m.pt2px(h.x);var h=m.pt2px(h.y),n=0*K,p=K*f;f=k.mat2d.identity(O);k.mat2d.translate(f,f,g.vec2.set(L,a,b));k.mat2d.rotate(f,f,p-n);k.mat2d.scale(f,
f,g.vec2.set(L,d,d));a=[0,0];g.vec2.transformMat2d(a,g.vec2.set(L,c,h+l),f);b=[0,0];g.vec2.transformMat2d(b,g.vec2.set(L,c,h),f);d=[0,0];g.vec2.transformMat2d(d,g.vec2.set(L,c+e,h+l),f);l=[0,0];g.vec2.transformMat2d(l,g.vec2.set(L,c+e,h),f);return{rings:[[a,d,l,b,a]]}}function A(a,b,c,d,e,f){var h=m.pt2px(c.xoffset),l=m.pt2px(c.yoffset);c=K*c.angle;var n=K*f;f=k.mat2d.identity(O);k.mat2d.translate(f,f,g.vec2.set(L,a,b));k.mat2d.rotate(f,f,n);k.mat2d.scale(f,f,g.vec2.set(L,e,-e));a=d[0]+d[2]/2;b=d[1]+
d[3]/2;k.mat2d.translate(f,f,g.vec2.set(L,h,-l));k.mat2d.translate(f,f,g.vec2.set(L,a,b));k.mat2d.rotate(f,f,c);k.mat2d.translate(f,f,g.vec2.set(L,-a,-b));h=[0,0];g.vec2.transformMat2d(h,g.vec2.set(L,d[0],d[1]),f);l=[0,0];g.vec2.transformMat2d(l,g.vec2.set(L,d[0],d[1]+d[3]),f);c=[0,0];g.vec2.transformMat2d(c,g.vec2.set(L,d[0]+d[2],d[1]),f);a=[0,0];g.vec2.transformMat2d(a,g.vec2.set(L,d[0]+d[2],d[1]+d[3]),f);return{rings:[[h,c,a,l,h]]}}function B(a,b,c){if(!c||0===c.glyphMosaicItems.length)return a;
var d=u.bidiText(b.text)[1];b=v.shapeGlyphs(c.glyphMosaicItems,d,{scale:m.pt2px(b.font.size)/24,angle:b.angle,xOffset:b.xoffset,yOffset:b.yoffset,hAlign:v.alignmentUtils.getXAnchorDirection(b.horizontalAlignment||"center"),vAlign:v.alignmentUtils.getYAnchorDirection(b.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,Math.min(b.lineWidth||512,512)),lineHeight:30*Math.max(.25,Math.min(b.lineHeight||1,4)),decoration:b.font.decoration||"none",isCIM:!1}).bounds;a[0]=b.x-b.halfWidth;a[1]=b.y-b.halfHeight;
a[2]=b.width;a[3]=b.height;return a}function D(a,b){return Math.ceil((a-b)/(2*b))}function C(a,b){var c;c=p.isPolygon(a)?a.rings:a.paths;for(var d=0;d<c.length;d++)for(var e=0,f=c[d];e<f.length;e++)f[e][0]+=b;return a}function E(a,b){if(!b)return a;var c=F(a,b).map(function(a){return a.extent});return 2>c.length?c[0]||a:2<c.length?(a.xmin=b.valid[0],a.xmax=b.valid[1],a):{rings:c.map(function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]})}}function F(a,
b){var c=[],d=a.ymin,e=a.ymax,f=a.xmax-a.xmin,g=a.xmin,h=a.xmax,k,l=b.valid,m=l[0],n=l[1];k=I(a.xmin,b);var p=k.x,l=k.frameId;k=I(a.xmax,b);b=k.x;a=k.frameId;k=p===b&&0<f;if(f>2*n){f={xmin:g<h?p:b,ymin:d,xmax:n,ymax:e};g={xmin:m,ymin:d,xmax:g<h?b:p,ymax:e};h={xmin:0,ymin:d,xmax:n,ymax:e};d={xmin:m,ymin:d,xmax:0,ymax:e};e=[];m=[];J(f,h)&&e.push(l);J(f,d)&&m.push(l);J(g,h)&&e.push(a);J(g,d)&&m.push(a);for(n=l+1;n<a;n++)e.push(n),m.push(n);c.push({extent:f,frameIds:[l]},{extent:g,frameIds:[a]},{extent:h,
frameIds:e},{extent:d,frameIds:m})}else p>b||k?c.push({extent:{xmin:p,ymin:d,xmax:n,ymax:e},frameIds:[l]},{extent:{xmin:m,ymin:d,xmax:b,ymax:e},frameIds:[a]}):c.push({extent:{xmin:p,ymin:d,xmax:b,ymax:e},frameIds:[l]});return c}function I(a,b){var c=b.valid;b=c[0];var d=c[1],c=2*d,e=0;a>d?(b=Math.ceil(Math.abs(a-d)/c),a-=b*c,e=b):a<b&&(b=Math.ceil(Math.abs(a-b)/c),a+=b*c,e=-b);return{x:a,frameId:e}}function J(a,b){var c=b.xmin,d=b.ymin,e=b.xmax;b=b.ymax;return G(a,c,d)&&G(a,c,b)&&G(a,e,b)&&G(a,e,
d)}function G(a,b,c){return b>=a.xmin&&b<=a.xmax&&c>=a.ymin&&c<=a.ymax?!0:!1}function H(a,b,c){if(Array.isArray(a)){var d=a[0];if(d>b){var e=D(d,b);a[0]=d+-2*e*b}else d<c&&(e=D(d,c),a[0]=d+-2*e*c)}else d=a.x,d>b?(e=D(d,b),a.x+=-2*e*b):d<c&&(e=D(d,c),a.x+=-2*e*c);return a}Object.defineProperty(a,"__esModule",{value:!0});var K=Math.PI/180,O=l.mat2df32.create(),L=c.vec2f32.create(),N=b.create();a.getBounds=function(a,b,c,e,f,g,h){if(!e||!c.symbol)return a[0]=a[1]=a[2]=a[3]=0,b[0]=b[1]=b[2]=b[3]=0,a;
if(p.isPoint(e)){var k=e.x;e=e.y;"text"===c.symbol.type&&0===b[2]&&0===b[3]&&B(b,c.symbol,c.mosaicItem);c=c.symbol;var l;switch(c.type){case "simple-marker":case "picture-marker":l=y(k,e,c,f,g,0);break;case "text":l=A(k,e,c,b,f,0);break;case "cim":case "expanded-cim":l=z(k,e,c,f,g,0)}for(f=b=0;f<l.rings[0].length-1;f++)c=l.rings[0][f],c=(k-c[0])*(k-c[0])+(e-c[1])*(e-c[1]),b=Math.max(b,c);b=Math.sqrt(b);f=r.normalizeMapX(k-b,h);k=r.normalizeMapX(k+b,h);f>k&&(h=x.getInfo(h))&&(f=h.valid,h=f[1],f=f[0],
k=h);a[0]=f;a[1]=e-b;a[2]=k;a[3]=e+b}else{d.getBoundsXY(a,e);e=b[0];if(0===e){a:switch(e=0,c.symbol.type){case "simple-fill":case "picture-fill":e=c.symbol.outline;if(!e){e=0;break a}e=e.width;break;case "simple-line":e=c.symbol.width;break;case "simple-marker":e=c.symbol.size;break;case "picture-marker":e=Math.max(c.symbol.width,c.symbol.height);break;case "text":e=[0,0,0,0];B(e,c.symbol,c.mosaicItem);e=Math.max(e[2],e[3])+Math.max(Math.abs(e[0]),Math.abs(e[1]));break;case "cim":case "expanded-cim":e=
u.CIMSymbolHelper.getEnvelope(c.symbol.data),e=Math.sqrt(e.width*e.width+e.height*e.height)}b[0]=e}e=f*e/2;a[0]-=e;a[1]-=e;a[2]+=e;a[3]+=e}return a};a.isMarkerSymbol=function(a){return"simple-marker"===a||"picture-marker"===a||"text"===a};a.graphicGeometryToNumber=function(a){switch(e.unwrap(a.geometry).type){case "polyline":return 1;case "polygon":case "extent":return 2}return 0};var T=c.vec2f32.create(),R=c.vec2f32.create(),Q=c.vec2f32.create(),S=c.vec2f32.create(),U=c.vec2f32.create(),X=c.vec2f32.create(),
V=c.vec2f32.create();a.isPointOnPolyline=function(a,b,c,d){g.vec2.set(Q,b,c);a=a.paths;for(var e,f,h,k,l,m,n,p,q=Infinity,r=0;r<a.length;r++){var u=a[r];if(!(2>u.length))for(var v=1;v<u.length;v++)e=u[v-1][0],h=u[v-1][1],f=u[v][0],k=u[v][1],l=Math.min(e,f)-d,m=Math.min(h,k)-d,n=Math.max(e,f)+d,p=Math.max(h,k)+d,b<l||b>n||c<m||c>p||(g.vec2.set(T,e,h),g.vec2.set(R,f,k),g.vec2.subtract(S,R,T),g.vec2.subtract(U,T,Q),g.vec2.scale(X,S,g.vec2.dot(S,U)/g.vec2.dot(S,S)),g.vec2.subtract(V,U,X),e=g.vec2.dot(V,
V),q>e&&(q=e))}return Math.sqrt(q)<=d};a.getMarkerSymbolBounds=y;a.getCIMMarkerBounds=z;a.getTextSymbolBounds=A;a.normalizeCentralMeridian=function(a){var b,c,e,f,g,h=null;if(!a)return null;if("mesh"===a.type)return a.toJSON();b=a.spatialReference;c=q.getInfo(b);if(!c)return a.toJSON();g=b.isWebMercator?102100:4326;e=ca[g].maxX;f=ca[g].minX;b=ca[g].plus180Line;g=ca[g].minus180Line;var k,l=a.toJSON();p.isPoint(l)?k=H(l,e,f):p.isMultipoint(l)?(l.points=l.points.map(function(a){return H(a,e,f)}),k=l):
p.isExtent(l)?k=E(l,c):p.isPolygon(l)||p.isPolyline(l)?(d.getBoundsXY(N,l),a={xmin:N[0],ymin:N[1],xmax:N[2],ymax:N[3]},c=2*D(a.xmin,f)*e,l=0===c?l:C(l,c),a.xmin+=c,a.xmax+=c,n.extentIntersectsPolyline(a,b)&&a.xmax!==e?h=l:n.extentIntersectsPolyline(a,g)&&a.xmin!==f?h=l:k=l):k=a.clone();return null!==h?(new Y).cut(h,e):k};a.getTextSymbolSize=B;var ca={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:{paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,
2.0037508342788905E7]]],spatialReference:h.WebMercator},minus180Line:{paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:h.WebMercator}},4326:{maxX:180,minX:-180,plus180Line:{paths:[[[180,-180],[180,180]]],spatialReference:h.WGS84},minus180Line:{paths:[[[-180,-180],[-180,180]]],spatialReference:h.WGS84}}},Y=function(){function a(){}a.prototype.cut=function(a,b){var c;if(a.rings)this.closed=!0,c=a.rings,this.minPts=4;else if(a.paths)this.closed=
!1,c=a.paths,this.minPts=2;else return null;var d=c.length;b*=-2;for(var e=0;e<d;e++){var f=c[e];if(f&&f.length>=this.minPts){for(var g=[],h=0;h<f.length;h++){var k=f[h];g.push([k[0]+b,k[1]])}c.push(g)}}this.closed?a.rings=c:a.paths=c;return a};return a}()})},"esri/views/2d/layers/features/controllers/EditsQueue":function(){define("require exports tslib ../../../../../core/Accessor ../../../../../core/promiseUtils ../../../../../core/accessorSupport/decorators @dojo/framework/shim/Promise".split(" "),
function(f,a,e,m,k,l){Object.defineProperty(a,"__esModule",{value:!0});f=function(a){function c(c){c=a.call(this,c)||this;c._queue=[];c._onGoingRequest=null;c._abortController=k.createAbortController();return c}e.__extends(c,a);c.prototype.destroy=function(){this.clear()};Object.defineProperty(c.prototype,"updating",{get:function(){return!this.destroyed&&(0<this._queue.length||null!=this._onGoingRequest)},enumerable:!0,configurable:!0});c.prototype.clear=function(){if(this.destroyed)throw Error("instance is already destroyed");
for(var a=this._queue.pop();a;)a.resolver.reject(k.createAbortError()),a=this._queue.pop();this._queue.length=0;this._abortController.abort();this._abortController=k.createAbortController()};c.prototype.push=function(a){return e.__awaiter(this,void 0,void 0,function(){var b,c=this;return e.__generator(this,function(d){if(this.destroyed)throw Error("instance is already destroyed");b=k.createResolver();this._queue.push({event:a,resolver:b});this.notifyChange("updating");Promise.resolve().then(function(){c._processNext()});
return[2,b.promise]})})};c.prototype._processNext=function(){return e.__awaiter(this,void 0,void 0,function(){var a,b,c,f,g,k,l,m,u,v,y,z,A,B,D,C,E,F,I,J,G,H,K,O=this;return e.__generator(this,function(d){switch(d.label){case 0:if(this._onGoingRequest)return[2];a=[];b=new Set;c=new Set;f=new Set;for(g=this._queue.shift();g;){k=g.event;l=k.addedFeatures;m=k.deletedFeatures;u=k.updatedFeatures;v=g.resolver;a.push(v);y=0;for(z=l;y<z.length;y++)A=z[y],B=A.objectId,D=A.error,D||(b.add(B),c.add(B),f.delete(B));
C=0;for(E=u;C<E.length;C++)F=E[C],B=F.objectId,D=F.error,D||(c.add(B),f.delete(B));I=0;for(J=m;I<J.length;I++)G=J[I],B=G.objectId,D=G.error,D||(b.has(B)?b.delete(B):f.add(B),c.delete(B));g=this._queue.shift()}if(!c.size&&!f.size)return this.notifyChange("updating"),a.forEach(function(a){return a()}),[2];H=[];K=[];c.size&&c.forEach(function(a){H.push(a)});f.size&&f.forEach(function(a){K.push(a)});this._onGoingRequest=Promise.resolve().then(function(){return O.processEdits(H,K,{signal:O._abortController.signal})}).catch(function(){});
this.notifyChange("updating");return[4,this._onGoingRequest];case 1:return d.sent(),this._onGoingRequest=null,this.notifyChange("updating"),a.forEach(function(a){return a()}),0<this._queue.length&&this._processNext(),[2]}})})};e.__decorate([l.property({constructOnly:!0})],c.prototype,"processEdits",void 0);e.__decorate([l.property({readOnly:!0})],c.prototype,"updating",null);return c=e.__decorate([l.subclass("esri.views.2d.layers.features.controllers.EditsQueue")],c)}(m);a.EditsQueue=f})},"esri/views/2d/layers/features/support/DataTile":function(){define(["require",
"exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){this.tile=this.displayTile=null;this.done=!1;this.queryInfoHash=null;this.returnExceeded=!1}Object.defineProperty(a.prototype,"key",{get:function(){return this.tile.key},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"id",{get:function(){return this.tile.id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"bounds",{get:function(){return this.tile.bounds},enumerable:!0,
configurable:!0});return a}();a.default=f})},"esri/views/2d/layers/features/support/DataTileFeaturesIndex":function(){define(["require","exports","../../../../../core/SetPool","../../../../../layers/graphics/data/FeatureStore","./Tile"],function(f,a,e,m,k){Object.defineProperty(a,"__esModule",{value:!0});var l=[],g=new Set;f=function(){function a(){this._tileById=new Map;this._tilesToFeatures=new Map;this._featureToTiles=new Map}a.prototype.destroy=function(){this.clear()};a.prototype.add=function(a){var b=
this;this.has(a.id)||(this._tileById.set(a.id,a),this._tilesToFeatures.set(a,e.default.acquire()),this._tilesToFeatures.forEach(function(c,e){a!==e&&(k.isParentOf(a,e)?c.forEach(function(c){b._link(a,c)}):k.isChildOf(a,e)&&b.featureStore.forEachInBounds(a.bounds,function(d){c.has(d.objectId)&&b._link(a,d.objectId)}))}))};a.prototype.clear=function(){this._tilesToFeatures.forEach(function(a){return e.default.release(a)});this._tilesToFeatures.clear();this._featureToTiles.forEach(function(a){return e.default.release(a)});
this._featureToTiles.clear();this._tileById.clear()};a.prototype.delete=function(a){var b=this,c=this.get(a.id);l.length=0;this._tilesToFeatures.get(c).forEach(function(a){var d=b._featureToTiles.get(a);d.has(c)&&1===d.size?l.push(a):b._unlink(c,a)});for(a=0;a<l.length;a++)this._unlink(c,l[a]);this.featureStore.removeManyById(l);this._tilesToFeatures.delete(c);this._tileById.delete(c.id);l.length=0};a.prototype.forEach=function(a,b){return this._tileById.forEach(a,b)};a.prototype.get=function(a){return this._tileById.get(a)};
a.prototype.has=function(a){return this._tileById.has(a)};a.prototype.setTileFeatures=function(a,b){var c=this,f=this.get(a.id);this._tilesToFeatures.has(f)||(this._tileById.set(f.id,f),this._tilesToFeatures.set(f,e.default.acquire()));for(a=0;a<b.length;a++)g.add(b[a].objectId);l.length=0;this._tilesToFeatures.get(f).forEach(function(a){if(!g.has(a)){var b=c._featureToTiles.get(a);b.has(f)&&1===b.size?l.push(a):c._unlink(f,a)}});for(a=0;a<l.length;a++)this._unlink(f,l[a]);this.featureStore.removeManyById(l);
this.featureStore.addMany(b);g.forEach(function(a){c._link(f,a)});g.clear();l.length=0};a.prototype.addOrUpdateFeatures=function(a){for(var b=this,c=new Set,e=new m.default({geometryType:this.featureStore.geometryType,hasM:this.featureStore.hasM,hasZ:this.featureStore.hasZ}),f=0,g=this.deleteFeaturesById(a.map(function(a){return a.objectId}));f<g.length;f++)c.add(g[f]);e.addMany(a);this._tileById.forEach(function(a){e.forEachInBounds(a.bounds,function(d){b._link(a,d.objectId);c.add(a)})});this.featureStore.addMany(a);
var h=[];c.forEach(function(a){return h.push(a)});return h};a.prototype.deleteFeaturesById=function(a){for(var b=this,c=new Set,f=function(a){var d=g._featureToTiles.get(a);d&&(d.forEach(function(d){c.add(d);b._tilesToFeatures.get(d).delete(a)}),e.default.release(d),g._featureToTiles.delete(a))},g=this,h=0;h<a.length;h++)f(a[h]);this.featureStore.removeManyById(a);var k=[];c.forEach(function(a){return k.push(a)});return k};a.prototype._link=function(a,b){this._featureToTiles.get(b)||this._featureToTiles.set(b,
e.default.acquire());this._featureToTiles.get(b).add(a);this._tilesToFeatures.get(a).add(b)};a.prototype._unlink=function(a,b){this._featureToTiles.get(b).delete(a);this._tilesToFeatures.get(a).delete(b);0===this._featureToTiles.get(b).size&&(e.default.release(this._featureToTiles.get(b)),this._featureToTiles.delete(b))};return a}();a.default=f})},"esri/core/SetPool":function(){define(["require","exports"],function(f,a){Object.defineProperty(a,"__esModule",{value:!0});f=function(){function a(){this._pool=
[];this._set=new Set}a.prototype.acquire=function(){if(0===this._pool.length)return new Set;var a=this._pool.pop();this._set.delete(a);return a};a.prototype.release=function(a){a&&!this._set.has(a)&&(a.clear(),5E4>this._pool.length&&(this._pool.push(a),this._set.add(a)))};a.acquire=function(){return e.acquire()};a.release=function(a){return e.release(a)};return a}();a.default=f;var e=new f})},"esri/views/2d/layers/features/support/TileUpdateQueue":function(){define("require exports tslib ../../../../../core/Accessor ../../../../../core/promiseUtils ../../../../../core/scheduling ../../../../../core/accessorSupport/decorators ../../../../../core/libs/gl-matrix-2/vec2 ../../../tiling".split(" "),
function(f,a,e,m,k,l,g,c,h){Object.defineProperty(a,"__esModule",{value:!0});var b=[0,0];f=function(a){function d(b){b=a.call(this,b)||this;b._queue=new Map;b._isPaused=!1;b._scheduledNextHandle=null;b._timestamp=Date.now();b.tileInfoView=null;b._next=b._next.bind(b);b._finalize=b._finalize.bind(b);return b}e.__extends(d,a);Object.defineProperty(d.prototype,"length",{get:function(){return this._queue.size},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"updating",{get:function(){return 0<
this._queue.size||null!=this._onGoingTile},enumerable:!0,configurable:!0});d.prototype.abort=function(a){this._onGoingTile&&this._onGoingTile.tileId===a&&(this._onGoingTile.abortController.abort(),this._onGoingTile=null);this._queue.delete(a);this._scheduleNext();this.notifyChange("updating")};d.prototype.clear=function(){this._queue.clear();this._onGoingTile&&(this._onGoingTile.abortController.abort(),this._onGoingTile=null);this._cancelNext();this.notifyChange("updating")};d.prototype.has=function(a){return this._queue.has(a)};
d.prototype.isOngoing=function(a){return this._onGoingTile&&this._onGoingTile.tileId===a};d.prototype.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())};d.prototype.push=function(a,b){if(!this._queue.has(a)){var c=k.createAbortController();this._queue.set(a,{tileId:a,key:h.TileKey.pool.acquire(a),timestamp:b||this._timestamp,abortController:c});this._scheduleNext();this.notifyChange("updating")}};d.prototype.refresh=function(){this._timestamp=Date.now();this.reset()};d.prototype.reset=
function(){var a=this._onGoingTile;a&&this.push(a.tileId,this._timestamp);this.notifyChange("updating")};d.prototype.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext());this.notifyChange("updating")};d.prototype._finalize=function(){this._onGoingTile=null;this.notifyChange("updating");this._scheduleNext()};d.prototype._cancelNext=function(){this._scheduledNextHandle&&(this._scheduledNextHandle.remove(),this._scheduledNextHandle=null)};d.prototype._scheduleNext=function(){this._isPaused||
this._scheduledNextHandle||0===this._queue.size||null!=this._onGoingTile||(this._scheduledNextHandle=l.schedule(this._next))};d.prototype._next=function(){return e.__awaiter(this,void 0,void 0,function(){var a,b,c,d,f;return e.__generator(this,function(e){switch(e.label){case 0:if(null==this._scheduledNextHandle||0===this._queue.size||this._onGoingTile)return this._scheduledNextHandle=null,[2];this._scheduledNextHandle=null;a=this._peek();b=a.abortController.signal;c=a.tileId;d=a.key;h.TileKey.pool.release(d);
this._queue.delete(c);this._onGoingTile=a;f=this.process(c,this._timestamp,{signal:b});this.notifyChange("updating");if(!f||"function"!==typeof f.then)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,f];case 2:return e.sent(),[3,4];case 3:return e.sent(),[3,4];case 4:return this._finalize(),[2]}})})};d.prototype._peek=function(){var a=this;if(!this.state)throw Error("state not set");var d=this.tileInfoView,e=this.state.center,f=Number.NEGATIVE_INFINITY,g=Number.POSITIVE_INFINITY,h=null;
this._queue.forEach(function(k){d.getTileCoords(b,k.key);var l=a._timestamp-k.timestamp;isNaN(l)?(l=c.vec2.distance(b,e),l<g&&(g=l,h=k)):l===f?(l=c.vec2.distance(b,e),l<g&&(g=l,h=k)):l>f&&(f=l,g=Number.POSITIVE_INFINITY,h=k)});return h};e.__decorate([g.property({readOnly:!0})],d.prototype,"length",null);e.__decorate([g.property({constructOnly:!0})],d.prototype,"process",void 0);e.__decorate([g.property()],d.prototype,"state",void 0);e.__decorate([g.property({constructOnly:!0})],d.prototype,"tileInfoView",
void 0);e.__decorate([g.property({readOnly:!0})],d.prototype,"updating",null);return d=e.__decorate([g.subclass("esri.views.2d.layers.features.support.TileUpdateQueue")],d)}(m);a.default=f})},"esri/views/2d/layers/features/processors/SymbolProcessor":function(){define("require exports tslib ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/decorators ../../../../../geometry/SpatialReference ../../../../../layers/support/LabelClass ../../../../../layers/support/labelFormatUtils ../../../../../renderers/support/jsonUtils ../../../engine ../../../arcade/utils ../../../engine/webgl/util/vvFlagUtils ../batchUtils ../textUtils ./BaseProcessor ../support/AttributeStore".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q,x,u,v,y,z){function A(a,b){a=Array(a);for(var c=0;c<a.length;c++)a[c]=b;return a}Object.defineProperty(a,"__esModule",{value:!0});var B=l.getLogger("esri.views.2d.layers.features.processors.SymbolProcessor");f=function(a){function f(){var b=null!==a&&a.apply(this,arguments)||this;b._symbolToMosaicItemMap=new Map;b._visualSetPromises=new Map;b.type="symbol";return b}e.__extends(f,a);f.prototype.initialize=function(){this._factory=this._createFactory()};f.prototype.destroy=
function(){this._visualSetPromises.clear();this._symbolToMosaicItemMap.clear();this.notifyChange("updating")};Object.defineProperty(f.prototype,"supportsTileUpdates",{get:function(){return!0},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"labelingInfo",{get:function(){return!this.config||g.isNone(this.config.labelingInfo)?null:this.config.labelingInfo.map(function(a){return d.fromJSON(a)})},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"labelingInfoFeatureReduction",
{get:function(){var a,b;if(!this.config||g.isNone(this.config.featureReduction))return null;var c=this.config.featureReduction;return"cluster"===c.type&&g.isSome(null===(a=c.drawingInfo)||void 0===a?void 0:a.labelingInfo)?null===(b=c.drawingInfo)||void 0===b?void 0:b.labelingInfo.map(function(a){return d.fromJSON(a)}):null},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"hasLabels",{get:function(){return!(!this.labelingInfo&&!this.labelingInfoFeatureReduction)},enumerable:!0,configurable:!0});
f.prototype._updateLabelClassInfos=function(){return e.__awaiter(this,void 0,void 0,function(){var a,b,d,f,h,k=this;return e.__generator(this,function(l){switch(l.label){case 0:if(g.isNone(this.labelingInfo)&&g.isNone(this.labelingInfoFeatureReduction))return[2,c.resolve()];a=function(a){return e.__awaiter(k,void 0,void 0,function(){var b,c,d;return e.__generator(this,function(e){switch(e.label){case 0:b=null,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,n.createLabelFunction(a,this.service.fields,
this.spatialReference)];case 2:return b=e.sent(),[3,4];case 3:return c=e.sent(),d=a.where?"where":"arcade",B.error(new m("mapview-labeling","Failed to evaluate "+d+" expression",{labelClass:a,error:c})),[3,4];case 4:return[2,b]}})})};b=[];g.isSome(this.labelingInfo)&&b.push.apply(b,this.labelingInfo.map(function(b,c){return e.__awaiter(k,void 0,void 0,function(){var d;return e.__generator(this,function(e){switch(e.label){case 0:return d=g.andThen,[4,a(b)];case 1:return[2,d.apply(void 0,[e.sent(),
function(a){return{type:"feature",labelClass:b,index:c,minScale:b.minScale,maxScale:b.maxScale,builder:a,symbol:b.symbol,symbolJSON:b.symbol.toJSON()}}])]}})})}));g.isSome(this.labelingInfoFeatureReduction)&&(d=b.length,b.push.apply(b,this.labelingInfoFeatureReduction.map(function(b,c){return e.__awaiter(k,void 0,void 0,function(){var f;return e.__generator(this,function(e){switch(e.label){case 0:return f=g.andThen,[4,a(b)];case 1:return[2,f.apply(void 0,[e.sent(),function(a){return{type:"aggregate",
labelClass:b,index:d+c,minScale:b.minScale,maxScale:b.maxScale,builder:a,symbol:b.symbol,symbolJSON:b.symbol.toJSON()}}])]}})})})));return[4,c.all(b)];case 1:return f=l.sent(),this._labelClassInfos=h=f.filter(function(a){return a}),[2]}})})};Object.defineProperty(f.prototype,"hydrate",{get:function(){return q.createHydrateFactory(this.service.geometryType)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"renderer",{get:function(){return this.config?p.fromJSON(this.config.renderer):
null},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"updating",{get:function(){return 0<this._visualSetPromises.size},enumerable:!0,configurable:!0});f.prototype.update=function(a){return e.__awaiter(this,void 0,void 0,function(){var b,c;return e.__generator(this,function(d){switch(d.label){case 0:return b=this._getMeshHash(),this._set("config",a),[4,this._updateLabelClassInfos()];case 1:return d.sent(),b!==this._getMeshHash()&&(this._factory=this._createFactory()),c=this._labelClassInfos,
this._factory.update(c,this.renderer,this.tileStore.tileScheme.tileInfo),[2]}})})};f.prototype.onTileData=function(a,b,d){var e=this;b=this._onTileData(a,b,d);this._visualSetPromises.set(a,b);c.always(b,function(){return e._cleanPromise(a)});this.notifyChange("updating");return b};f.prototype.onTileError=function(a,b,d){var e=this;b=this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:a.id,error:b},{signal:d.signal});this._visualSetPromises.set(a,b);c.always(b,function(){return e._cleanPromise(a)});
this.notifyChange("updating");return b};f.prototype._getMeshHash=function(){var a=x.getVVFlags("visualVariables"in this.renderer&&this.renderer.visualVariables||[]);return this.renderer.getMeshHash()+"."+a};f.prototype._createFactory=function(){var a=this,c=this.service,d=c.geometryType,e=c.objectIdField,c=c.fields,f=b.fromJSON(this.spatialReference),c={geometryType:d,fields:c,spatialReference:f};this._store=f=new r.WGLTemplateStore(function(b,c){return a.remoteClient.invoke("tileRenderer.getMaterialItems",
b,c)},!1);this._matcher=r.createMatcher(f,c,this.renderer);return new r.WGLMeshFactory(d,e,this.renderer,f)};f.prototype._cleanPromise=function(a){this._visualSetPromises.delete(a);this.notifyChange("updating")};f.prototype._onTileData=function(a,b,c){return e.__awaiter(this,void 0,void 0,function(){var d,f,h,k,l,m,n,p,q,r,u;return e.__generator(this,function(e){switch(e.label){case 0:d=b.addOrUpdate,f=b.remove,h=b.clear,k=this._processFeatures(a,d,b.transformParams,c),l=c.signal,e.label=1;case 1:return e.trys.push([1,
3,,4]),[4,k];case 2:return m=e.sent(),n=g.andThen(m,function(a){return a.message}),p=g.andThen(m,function(a){return a.transferList})||[],q={addOrUpdate:n,remove:f,clear:h},r={transferList:g.unwrap(p)||[],signal:l},[2,this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:a.id,data:q},r)];case 3:return u=e.sent(),this._handleError(a,u,c),[3,4];case 4:return[2]}})})};f.prototype._processFeatures=function(a,b,d,f){return e.__awaiter(this,void 0,void 0,function(){var g,h,k,l,m,n;return e.__generator(this,
function(e){switch(e.label){case 0:g=b&&b.length;if(!g)return[2,null];h=this._factory;k={viewingMode:"",scale:a.scale};return[4,this._matcher];case 1:return l=e.sent(),[4,this._getLabelInfos(a,b,d)];case 2:return m=e.sent(),[4,h.analyze(b,l,d,k)];case 3:return n=e.sent(),c.throwIfAborted(f),[2,this._writeFeatures(a,n,d,m,h,f)]}})})};f.prototype._writeFeatures=function(a,b,c,d,f,h){return e.__awaiter(this,void 0,void 0,function(){var k,l,m;return e.__generator(this,function(n){switch(n.label){case 0:return k=
f.createMeshData(b.length),l={viewingMode:"",scale:a.scale},m=e.__assign(e.__assign({},h),{batchSize:200}),[4,u.executeForEachAsync(b,function(b){try{var e=g.isSome(d)?d.get(b.localId):null;f.write(k,b,c,l,a.level,e)}catch(Q){}},m)];case 1:return n.sent(),[2,this._encodeDisplayData(k)]}})})};f.prototype._encodeDisplayData=function(a){var b={},c=[];a.encode(b,c);return{message:b,transferList:c}};f.prototype._handleError=function(a,b,d){if(!c.isAbortError(b))return this.remoteClient.invoke("tileRenderer.onTileError",
{tileKey:a.id,error:b.message},{signal:d.signal})};f.prototype._getLabelClassInfosForScale=function(a){return e.__awaiter(this,void 0,void 0,function(){var b;return e.__generator(this,function(c){b=this._labelClassInfos;return[2,b.filter(function(b){var c=b.minScale;b=b.maxScale;return(!c||c>=a||0===c)&&(!b||b<=a||0===b)})]})})};f.prototype._shouldDiscard=function(a,b){switch(this.service.geometryType){case "esriGeometryPoint":var c=b.geometry;b=c.x;c=c.y;return a.checkOverlap(b,c);case "esriGeometryPolygon":return c=
b.centroid,b=c.x,c=c.y,a.checkOverlap(b,c);default:return!1}};f.prototype._markUsed=function(a,b){switch(this.service.geometryType){case "esriGeometryPoint":var c=b.geometry;b=c.x;c=c.y;return a.markUsed(b,c);case "esriGeometryPolygon":return c=b.centroid,b=c.x,c=c.y,a.markUsed(b,c)}};f.prototype._getLabelInfos=function(a,c,d){return e.__awaiter(this,void 0,void 0,function(){var f,h,k,l,m,n,p,q,u;return e.__generator(this,function(x){switch(x.label){case 0:return this.hasLabels&&c&&0!==c.length?[4,
this._getLabelClassInfosForScale(a.scale)]:[2,null];case 1:f=x.sent();if(0===f.length)return[2,null];h=new Map;k=new r.CollisionGrid(r.definitions.COLLISION_EARLY_REJECT_BUCKET_SIZE);l=function(a){var c=a.localId;if(m._shouldDiscard(k,a))return h.has(c)||h.set(c,null),"continue";for(var l=A(f.length,null),n=!1,p=function(h){h=f[h];var k=h.type,p=h.index,q=h.builder;h=h.symbolJSON;if((z.isAggregateId(c)&&1<a.attributes.cluster_count?"aggregate":"feature")!==k)return"continue";if(!d)return B.error("mapview-labeling",
"Tried to evaluate geometry expression but no transformation found"),{value:void 0};var k=m.hydrate(a.geometry,d.transform,d.hasZ,d.hasM),u=e.__assign(e.__assign({},a),{geometry:k});k.spatialReference=b.fromJSON(m.spatialReference);q=q.evaluate(u);if(g.isNone(q)||""===q)return"continue";var q=r.bidiText(q),k=q[0],x=q[1];n=!0;m._store.getMosaicItem(h,!1,v.codepoints(k)).then(function(a){l[p]={glyphs:a.glyphMosaicItems,rtl:x,classIndex:p}})},q=0;q<f.length;q++){var u=p(q);if("object"===typeof u)return u}h.set(c,
l);n&&m._markUsed(k,a)};m=this;n=0;for(p=c;n<p.length;n++)if(q=p[n],u=l(q),"object"===typeof u)return[2,u.value];return[2,h]}})})};e.__decorate([h.property({readOnly:!0})],f.prototype,"supportsTileUpdates",null);e.__decorate([h.property()],f.prototype,"config",void 0);e.__decorate([h.property({dependsOn:["config"]})],f.prototype,"labelingInfo",null);e.__decorate([h.property({dependsOn:["config"]})],f.prototype,"labelingInfoFeatureReduction",null);e.__decorate([h.property({dependsOn:["labelingInfo",
"labelingInfoFeatureReduction"]})],f.prototype,"hasLabels",null);e.__decorate([h.property({dependsOn:["service"]})],f.prototype,"hydrate",null);e.__decorate([h.property({dependsOn:["config"],readOnly:!0})],f.prototype,"renderer",null);e.__decorate([h.property({readOnly:!0})],f.prototype,"updating",null);return f=e.__decorate([h.subclass("esri.views.2d.layers.features.processors.SymbolProcessor")],f)}(y.default);a.default=f})},"esri/layers/support/LabelClass":function(){define("require exports tslib ../../symbols ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ./LabelExpressionInfo ./labelUtils ../../symbols/support/defaults ../../symbols/support/jsonUtils".split(" "),
function(f,a,e,m,k,l,g,c,h,b,d,n){function p(a){return a?"service"===a.origin?!1:!a.layer||"map-image"!==a.layer.type:!0}var r=new k.default({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",
esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",
esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});return function(a){function f(b){b=a.call(this,b)||this;b.name=null;b.deconflictionStrategy="static";b.labelExpression=null;b.labelExpressionInfo=
null;b.labelPlacement=null;b.maxScale=0;b.minScale=0;b.symbol=d.defaultTextSymbol2D;b.useCodedValues=void 0;b.where=null;return b}e.__extends(f,a);k=f;f.evaluateWhere=function(a,b){var c=function(a,b,c){switch(b){case "\x3d":return a==c?!0:!1;case "\x3c\x3e":return a!=c?!0:!1;case "\x3e":return a>c?!0:!1;case "\x3e\x3d":return a>=c?!0:!1;case "\x3c":return a<c?!0:!1;case "\x3c\x3d":return a<=c?!0:!1}return!1};try{if(null==a)return!0;var d=a.split(" ");if(3===d.length)return c(b[d[0]],d[1],d[2]);if(7===
d.length){var e=c(b[d[0]],d[1],d[2]),f=d[3],g=c(b[d[4]],d[5],d[6]);switch(f){case "AND":return e&&g;case "OR":return e||g}}return!1}catch(E){console.log("Error.: can't parse \x3d "+a)}};f.prototype.writeDeconflictionStrategy=function(a,b,c,d){"static"!==a&&(b[c]=a)};f.prototype.readLabelExpression=function(a,b){b=b.labelExpressionInfo;if(!b||!b.value&&!b.expression)return a};f.prototype.writeLabelExpression=function(a,c,d,e){this.labelExpressionInfo&&(p(e)||e&&"service"===e.origin)&&(null!=this.labelExpressionInfo.value?
a=this.labelExpressionInfo.value.replace(/\{/g,"[").replace(/\}/g,"]"):null!=this.labelExpressionInfo.expression&&(e=b.getSingleFieldArcadeExpression(this.labelExpressionInfo.expression))&&(a="["+e+"]"));null!=a&&(c[d]=a)};f.prototype.writeLabelExpressionInfo=function(a,b,c,d){if(null==a&&null!=this.labelExpression&&p(d))a=new h({expression:this.getLabelExpressionArcade()});else if(!a)return;a=a.toJSON(d);a.expression&&(b[c]=a)};f.prototype.writeMaxScale=function(a,b){if(a||this.minScale)b.maxScale=
a};f.prototype.writeMinScale=function(a,b){if(a||this.maxScale)b.minScale=a};f.prototype.getLabelExpression=function(){var a={expression:"",type:"none"};this.labelExpressionInfo?this.labelExpressionInfo.value?(a.expression=this.labelExpressionInfo.value,a.type="conventional"):this.labelExpressionInfo.expression&&(a.expression=this.labelExpressionInfo.expression,a.type="arcade"):null!=this.labelExpression&&(a.expression=this.labelExpression.replace(/\[/g,"{").replace(/\]/g,"}"),a.type="conventional");
return a};f.prototype.getLabelExpressionArcade=function(){var a=this.getLabelExpression();if(!a)return null;switch(a.type){case "conventional":return b.convertTemplatedStringToArcade(a.expression);case "arcade":return a.expression}return null};f.prototype.getLabelExpressionSingleField=function(){var a=this.getLabelExpression();if(!a)return null;switch(a.type){case "conventional":return b.getSingleFieldTemplatedString(a.expression);case "arcade":return b.getSingleFieldArcadeExpression(a.expression)}return null};
f.prototype.clone=function(){return new k({deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:g.clone(this.labelExpressionInfo),labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,symbol:g.clone(this.symbol),where:this.where,useCodedValues:this.useCodedValues})};var k;e.__decorate([c.property({type:String,json:{write:!0}})],f.prototype,"name",void 0);e.__decorate([c.property({type:String})],f.prototype,
"deconflictionStrategy",void 0);e.__decorate([c.writer("deconflictionStrategy")],f.prototype,"writeDeconflictionStrategy",null);e.__decorate([c.property({type:String,json:{write:{allowNull:!0}}})],f.prototype,"labelExpression",void 0);e.__decorate([c.reader("labelExpression")],f.prototype,"readLabelExpression",null);e.__decorate([c.writer("labelExpression")],f.prototype,"writeLabelExpression",null);e.__decorate([c.property({type:h,json:{write:{overridePolicy:function(a,b,c){return p(c)?{allowNull:!0}:
{enabled:!1}}}}})],f.prototype,"labelExpressionInfo",void 0);e.__decorate([c.writer("labelExpressionInfo")],f.prototype,"writeLabelExpressionInfo",null);e.__decorate([c.property({type:r.apiValues,json:{type:r.jsonValues,read:r.read,write:r.write}})],f.prototype,"labelPlacement",void 0);e.__decorate([c.property({type:Number})],f.prototype,"maxScale",void 0);e.__decorate([c.writer("maxScale")],f.prototype,"writeMaxScale",null);e.__decorate([c.property({type:Number})],f.prototype,"minScale",void 0);
e.__decorate([c.writer("minScale")],f.prototype,"writeMinScale",null);e.__decorate([c.property({types:m.symbolTypesLabel,json:{origins:{"web-scene":{types:m.symbolTypesLabel3D,read:n.read,write:n.writeTarget,default:null}},read:n.read,write:n.writeTarget,default:null}})],f.prototype,"symbol",void 0);e.__decorate([c.property({type:Boolean,json:{write:!0}})],f.prototype,"useCodedValues",void 0);e.__decorate([c.property({type:String,json:{write:!0}})],f.prototype,"where",void 0);return f=k=e.__decorate([c.subclass("esri.layers.support.LabelClass")],
f)}(l.JSONSupport)})},"esri/layers/support/LabelExpressionInfo":function(){define("require exports tslib ../../core/JSONSupport ../../core/accessorSupport/decorators ./labelUtils".split(" "),function(f,a,e,m,k,l){return function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b.value=null;b.expression=null;return b}e.__extends(c,a);f=c;c.prototype.readExpression=function(a,c){return c.value?l.convertTemplatedStringToArcade(c.value):a};c.prototype.writeExpression=function(a,c,e){null!=
this.value&&(a=l.convertTemplatedStringToArcade(this.value));c[e]=a};c.prototype.clone=function(){return new f({value:this.value,expression:this.expression})};var f;e.__decorate([k.property({json:{read:!1,write:!1}})],c.prototype,"value",void 0);e.__decorate([k.property({type:String,json:{write:{allowNull:!0}}})],c.prototype,"expression",void 0);e.__decorate([k.reader("expression",["expression","value"])],c.prototype,"readExpression",null);e.__decorate([k.writer("expression")],c.prototype,"writeExpression",
null);return c=f=e.__decorate([k.subclass("esri.layers.support.LabelExpressionInfo")],c)}(m.JSONSupport)})},"esri/layers/support/labelUtils":function(){define(["require","exports","../../core/string"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});var m=/__begin__/ig,k=/__end__/ig,l=/^__begin__/i,g=/__end__$/i;a.convertTemplatedStringToArcade=function(a){a?(a=e.replace(a,function(a){return'__begin__$feature["'+a+'"]__end__'}),a=l.test(a)?a.replace(l,""):'"'+a,a=g.test(a)?a.replace(g,
""):a+'"',a=a.replace(m,'" + ').replace(k,' + "')):a='""';return a};var c=/^\s*\{([^}]+)\}\s*$/i;a.getSingleFieldTemplatedString=function(a){return(a=a.match(c))&&a[1].trim()||null};var h=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,b=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,d=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;a.getSingleFieldArcadeExpression=
function(a){if(!a)return null;var c=h.exec(a)||b.exec(a);return c?c[1]||c[3]:(c=d.exec(a))?c[2]:null}})},"esri/layers/support/labelFormatUtils":function(){define("require exports tslib ../../core/Error ../../core/Logger ../../intl/date ../../intl/number ./FieldsIndex ./fieldUtils ./labelUtils ../../support/arcadeOnDemand @dojo/framework/shim/Promise".split(" "),function(f,a,e,m,k,l,g,c,h,b,d){function n(a,b,c,d){a=h.getField(d,a);if(!a)return b;if(null==c[a.name])return"";if(b=a.domain)if("codedValue"===
b.type||"coded-value"===b.type){d=c[a.name];var e=0;for(b=b.codedValues;e<b.length;e++){var f=b[e];if(f.code===d)return f.name}}else if("range"===b.type&&(d=+c[a.name],e="range"in b?b.range[1]:b.maxValue,("range"in b?b.range[0]:b.minValue)<=d&&d<=e))return b.name;c=c[a.name];"date"===a.type||"esriFieldTypeDate"===a.type?c=l.formatDate(c,l.convertDateFormatToIntlOptions("short-date")):h.isNumericField(a)&&(c=g.formatNumber(+c));return c?c:""}Object.defineProperty(a,"__esModule",{value:!0});var p=k.getLogger("esri.layers.support.labelFormatUtils"),
r={type:"simple",evaluate:function(){return null}};a.createLabelFunction=function(a,g,h){return e.__awaiter(this,void 0,void 0,function(){var k,l,q,u,x,D,C,E;return e.__generator(this,function(e){switch(e.label){case 0:if(!a||!a.symbol)return[2,r];k=a.where;l=a.getLabelExpression();return k?[4,new Promise(function(a,b){f(["../../core/sql/WhereClause"],a,b)})]:[3,2];case 1:return u=e.sent(),[3,3];case 2:u=null,e.label=3;case 3:return q=u,"arcade"!==l.type?[3,5]:[4,d.createLabelExpression(l.expression,
h,g)];case 4:return D=e.sent(),x={type:"arcade",evaluate:function(a){try{var b=D.evaluate({$feature:D.repurposeFeature(a)});if(null!=b)return b.toString()}catch(G){p.error(new m("bad-arcade-expression","Encountered an error when evaluating label expression for feature",{feature:a,expression:l}))}return null},needsHydrationToEvaluate:function(){return null==b.getSingleFieldArcadeExpression(l.expression)}},[3,6];case 5:x={type:"simple",evaluate:function(a){var b=a&&a.attributes;return b?l.expression.replace(/{[^}]*}/g,
function(a){return n(a.slice(1,-1),a,b,g)}):null}},e.label=6;case 6:if(k){try{C=q.WhereClause.create(k,new c(g))}catch(I){return[2,r]}E=x.evaluate;x.evaluate=function(a){return C.testFeature(a)?E(a):null}}return[2,x]}})})};a.formatField=n})},"esri/views/2d/layers/features/batchUtils":function(){define(["require","exports","../../../../core/promiseUtils"],function(f,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.executeForEachAsync=function(a,f,l){var g,c=null!==(g=null===l||void 0===l?void 0:
l.batchSize)&&void 0!==g?g:100,h=e.createResolver(),b=0,d=function(){for(var g=Date.now(),k=!1,m=0;!k&&500>m;){try{for(l&&e.throwIfAborted(l);b<Math.min(b+c,a.length);b++)f(a[b])}catch(q){h.reject(q)}m=Date.now()-g;k=b>=a.length}k?h.resolve():setTimeout(d,0)};d();return h.promise}})},"esri/views/2d/layers/features/processors/BaseProcessor":function(){define(["require","exports","tslib","../../../../../core/HandleOwner","../../../../../core/accessorSupport/decorators"],function(f,a,e,m,k){Object.defineProperty(a,
"__esModule",{value:!0});f=function(a){function f(){return null!==a&&a.apply(this,arguments)||this}e.__extends(f,a);f.prototype.initialize=function(){};f.prototype.destroy=function(){};Object.defineProperty(f.prototype,"supportsTileUpdates",{get:function(){return!1},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"spatialReference",{get:function(){var a=this.get("tileStore.tileScheme.spatialReference");return a&&a.toJSON()||null},enumerable:!0,configurable:!0});e.__decorate([k.property({readOnly:!0})],
f.prototype,"supportsTileUpdates",null);e.__decorate([k.property({constructOnly:!0})],f.prototype,"remoteClient",void 0);e.__decorate([k.property({constructOnly:!0})],f.prototype,"service",void 0);e.__decorate([k.property({dependsOn:["tileStore.tileScheme.spatialReference"]})],f.prototype,"spatialReference",null);e.__decorate([k.property({constructOnly:!0})],f.prototype,"tileInfo",void 0);e.__decorate([k.property({constructOnly:!0})],f.prototype,"tileStore",void 0);return f=e.__decorate([k.subclass("esri.views.2d.layers.features.processors.BaseProcessor")],
f)}(m.HandleOwner);a.default=f})},"*noref":1}});
define("require exports tslib ../../../../core/Accessor ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators ../../../../layers/support/TileInfo ../../ViewState ./controllers ./processors ./support/TileStore ../../tiling/TileInfoView".split(" "),function(f,a,e,m,k,l,g,c,h,b,d,n,p,r,q){Object.defineProperty(a,"__esModule",{value:!0});var x=g.getLogger("esri.views.2d.layers.features.Pipeline"),u=new Set;a.getInstances=
function(){return u};f=function(a){function f(){var b=null!==a&&a.apply(this,arguments)||this;b.controller=null;b.processor=null;b.remoteClient=null;b.tileStore=null;b.service=null;b.viewState=null;return b}e.__extends(f,a);f.prototype.initialize=function(){var a=this;this.watch("updating",function(b){a.remoteClient.invoke("setUpdating",b)});l("esri-performance-tests")&&!l("esri-workers")&&u.add(this)};f.prototype.destroy=function(){l("esri-performance-tests")&&!l("esri-workers")&&u.delete(this);
this.controller&&this.controller.destroy();this.processor&&this.processor.destroy()};Object.defineProperty(f.prototype,"updating",{get:function(){var a=this.controller,b=this.processor;return!a||!b||a.updating||b.updating||!1},enumerable:!0,configurable:!0});f.prototype.startup=function(a){var c=a.service,d=a.config,f=a.tileInfo,g=a.options;return e.__awaiter(this,void 0,void 0,function(){var a;return e.__generator(this,function(e){switch(e.label){case 0:return this.service=c,this.tileStore||(a=new q(b.fromJSON(f)),
this.tileStore=new r.default(a)),[4,this._configure(d,g)];case 1:return e.sent(),this.viewState&&(this.tileStore.clear(),this.tileStore.setViewState(this.viewState)),[2]}})})};f.prototype.update=function(a){var b=a.config,c=a.options;return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(a){switch(a.label){case 0:return this.processor&&this.controller?c.layerFilterChanged||c.invalidateFeatureData||c.invalidateMesh?[4,this.controller.update(b,c.layerFilterChanged)]:[3,
2]:(x.error(new k("mapview-pipeline","Tried to update an unconfigured pipeline.")),[2]);case 1:a.sent(),a.label=2;case 2:return c.invalidateMesh?[4,this.processor.update(b)]:[3,4];case 3:a.sent(),this.controller.invalidate(),a.label=4;case 4:return[4,this.remoteClient.invoke("setUpdating",this.updating)];case 5:return a.sent(),[2]}})})};f.prototype.setViewState=function(a){a=d.fromJSON(a);this._set("viewState",a);this.tileStore&&this.tileStore.setViewState(a);this.controller&&this.controller.setViewState(a)};
f.prototype._configure=function(a,b){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(d){switch(d.label){case 0:return[4,c.all([this._handleControllerConfig(a),this._handleProcessorConfig(a)])];case 1:return d.sent(),this.controller.processor=this.processor,this.viewState&&this.controller.setViewState(this.viewState),[4,this.update({config:a,options:b})];case 2:return d.sent(),[2]}})})};f.prototype._handleControllerConfig=function(a){return e.__awaiter(this,void 0,
void 0,function(){var b;return e.__generator(this,function(c){switch(c.label){case 0:return[4,this._createController(this.service,a)];case 1:return b=c.sent(),[4,b.startup()];case 2:return c.sent(),[2,b]}})})};f.prototype._handleProcessorConfig=function(a){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(b){return[2,this._createProcessor(this.service,a)]})})};f.prototype._createController=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d,f,g,
h;return e.__generator(this,function(e){switch(e.label){case 0:return this.controller&&this.controller.destroy(),[4,n.loadControllerModule(a.type)];case 1:return c=e.sent().default,d=this,f=d.tileStore,g=d.remoteClient,this.controller=h=new c({service:a,config:b,tileStore:f,remoteClient:g}),[2,h]}})})};f.prototype._createProcessor=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d,f,g,h;return e.__generator(this,function(e){switch(e.label){case 0:return[4,p.loadProcessorModule(b.renderer.type)];
case 1:return c=e.sent().default,d=this,f=d.remoteClient,g=d.tileStore,h=new c({service:a,config:b,tileStore:g,remoteClient:f}),this.processor&&this.processor.destroy(),this.processor=h,[2,h]}})})};e.__decorate([h.property()],f.prototype,"controller",void 0);e.__decorate([h.property()],f.prototype,"processor",void 0);e.__decorate([h.property({dependsOn:["controller.updating","processor.updating"]})],f.prototype,"updating",null);e.__decorate([h.property()],f.prototype,"viewState",void 0);return f=
e.__decorate([h.subclass("esri.views.2d.layers.features.Pipeline")],f)}(m);a.default=f});