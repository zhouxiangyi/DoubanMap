// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define(["require","exports","../../../../core/libs/gl-matrix-2/vec3","../../../../core/libs/gl-matrix-2/vec3f64","../../support/geometryUtils/triangle"],function(C,u,b,w,z){Object.defineProperty(u,"__esModule",{value:!0});var v=1,x=null,A=new Uint32Array([0]);u.generateDefaultIndexArray=function(a){if(1===a)return A;if(a>v||null==x){for(;a>v;)v*=2;x=new Uint32Array(v);for(var b=0;b<v;b++)x[b]=b}return new Uint32Array(x.buffer,0,a)};u.computeAttachmentOriginTriangles=function(a,g,d){if(!a)return!1;
var l=a.strideIdx,t=a.offsetIdx;a=a.data;b.vec3.set(d,0,0,0);b.vec3.set(f,0,0,0);for(var m=0,h=0,k=0;k<g.length-2;k+=3){var e=g[k+0]*l+t,n=g[k+1]*l+t,p=g[k+2]*l+t;b.vec3.set(c,a[e+0],a[e+1],a[e+2]);b.vec3.set(r,a[n+0],a[n+1],a[n+2]);b.vec3.set(y,a[p+0],a[p+1],a[p+2]);(e=z.areaPoints3d(c,r,y))?(b.vec3.add(c,c,r),b.vec3.add(c,c,y),b.vec3.scale(c,c,1/3*e),b.vec3.add(d,d,c),m+=e):(b.vec3.add(f,f,c),b.vec3.add(f,f,r),b.vec3.add(f,f,y),h+=3)}return 0===h&&0===m?!1:0!==m?(b.vec3.scale(d,d,1/m),!0):0!==h?
(b.vec3.scale(d,f,1/h),!0):!1};u.computeAttachmentOriginPoints=function(a,c,d){if(!a||!c)return!1;var f=a.strideIdx,g=a.offsetIdx;a=a.data;b.vec3.set(d,0,0,0);for(var m=-1,h=0,k=0;k<c.length;k++){var e=c[k]*f+g;m!==e&&(d[0]+=a[e+0],d[1]+=a[e+1],d[2]+=a[e+2],h++);m=e}1<h&&b.vec3.scale(d,d,1/h);return 0<h};u.computeAttachmentOriginLines=function(a,g,d,l){if(!a)return!1;var t=a.strideIdx,m=a.offsetIdx;a=a.data;b.vec3.set(l,0,0,0);b.vec3.set(f,0,0,0);var h=0,k=0,e=g?g.length-1:a.length/t-1;d=e+(d?2:0);
for(var n=0;n<d;n+=2){var p=n<e?n:e,q=n<e?n+1:0,p=(g?g[p]:p)*t+m,q=(g?g[q]:q)*t+m;c[0]=a[p+0];c[1]=a[p+1];c[2]=a[p+2];r[0]=a[q+0];r[1]=a[q+1];r[2]=a[q+2];b.vec3.scale(c,b.vec3.add(c,c,r),.5);q=b.vec3.dist(c,r);0<q?(b.vec3.add(l,l,b.vec3.scale(c,c,q)),h+=q):(b.vec3.add(f,f,c),k++)}return 0!==h?(b.vec3.scale(l,l,1/h),!0):0!==k?(b.vec3.scale(l,f,1/k),!0):!1};var B=0;u.getNewId=function(){return B++};var c=w.vec3f64.create(),r=w.vec3f64.create(),y=w.vec3f64.create(),f=w.vec3f64.create()});