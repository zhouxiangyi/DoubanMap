// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports tslib @dojo/framework/shim/AbortController ./clock ./Error ./events ./Logger ./maybe @dojo/framework/shim/Promise".split(" "),function(J,b,E,F,G,y,z,H,h){function A(a){return Promise.all(a)}function k(a){return new Promise(function(c,d){try{a(c,d)}catch(e){Promise.resolve().then(function(){return d(e)})}})}function q(a){void 0===a&&(a="Aborted");return new y("AbortError",a)}function r(){return new F.default}function B(a){if(C(a))throw q();}function t(a){return h.isSome(a)?
"aborted"in a?a:a.signal:a}function C(a){a=t(a);return h.isSome(a)&&a.aborted}function u(a,c){a=t(a);if(!h.isNone(a))if(a.aborted)c();else return z.once(a,"abort",function(){return c()})}function p(a){return a&&"AbortError"===a.name}function v(){var a=null,c=k(function(c,e){a={resolve:c,reject:e}});a.promise=c;return a}function w(a){if(a){if("function"!==typeof a.forEach){var c=Object.keys(a),d=c.map(function(c){return a[c]});return w(d).then(function(a){var d={};c.forEach(function(c,e){return d[c]=
a[e]});return d})}var e=n;return k(function(c){var d=[],b=a.length;0===b&&c(d);a.forEach(function(a){var g={promise:a||e(a)};d.push(g);g.promise.then(function(a){g.value=a}).catch(function(a){g.error=a}).then(function(){--b;0===b&&c(d)})})})}}function n(a){void 0===a&&(a=void 0);return Promise.resolve(a)}function D(a,c,d){void 0===c&&(c=void 0);var b=r();u(d,function(){return b.abort()});return k(function(d,e){var g=setTimeout(function(){g=0;d(c)},a);u(b,function(){g&&(clearTimeout(g),e(q()))})})}
function x(a){return a&&"object"===typeof a&&"then"in a&&"function"===typeof a.then?a:n(a)}Object.defineProperty(b,"__esModule",{value:!0});var I=H.getLogger("esri");b.all=A;b.filter=function(a,c){var d=a.slice();return A(a.map(function(a,d){return c(a,d)})).then(function(a){return d.filter(function(c,d){return a[d]})})};b.create=k;b.createAbortError=q;b.createAbortController=r;b.throwIfAborted=B;b.isAborted=C;b.throwIfAbortError=function(a){if(p(a))throw a;};b.throwIfNotAbortError=function(a){if(!p(a))throw a;
};b.onAbort=u;b.onAbortOrThrow=function(a,c){a=t(a);if(!h.isNone(a))return B(a),z.once(a,"abort",function(){return c(q())})};b.isAbortError=p;b.ignoreAbortErrors=function(a){return a.catch(function(a){if(!p(a))throw a;})};b.logOnError=function(a,c){return a.catch(function(a){p(a)||(c=h.isSome(c)?c:I,c.error(a))})};b.createDeferred=v;b.eachAlways=w;b.isThenable=function(a){return a&&"function"===typeof a.then};b.eachAlwaysValues=function(a){return w(a).then(function(a){return a.filter(function(a){return!!a.value}).map(function(a){return a.value})})};
b.first=function(a){return a&&a.length?k(function(c,d){for(var b=0;b<a.length;b++)a[b].then(c,d)}):n()};b.reject=function(a){return Promise.reject(a)};b.resolve=n;b.after=D;b.timeout=function(a,c,b,e){var d=b&&"abort"in b?b:null;null!=e||d||(e=b);var f=setTimeout(function(){f=0;d&&d.abort()},c),m=function(){throw e||new y("promiseUtils:timeout","The wrapped promise did not resolve within "+c+" ms");};return a.then(function(a){if(0===f)throw m();clearTimeout(f);return a},function(a){clearTimeout(f);
throw 0===f?m():a;})};b.isPromiseLike=function(a){return a&&"function"===typeof a.then};b.when=x;b.debounce=function(a,c){void 0===c&&(c=-1);var b,e,g,f,m=null,k=function(){for(var d=[],l=0;l<arguments.length;l++)d[l]=arguments[l];if(b)return e=d,f&&f.reject(q()),f=v(),d=f.promise,m&&(l=m,m=null,l.abort()),d;g=f||v();f=null;if(0<c){var h=r(),p=b=x(a.apply(void 0,E.__spreadArrays(d,[h.signal])));D(c).then(function(){b===p&&(f?h.abort():m=h)})}else b=1,b=x(a.apply(void 0,d));var d=function(){var a=
e;e=g=b=m=null;null!=a&&k.apply(void 0,a)},l=b,n=g;l.then(d,d);l.then(n.resolve,n.reject);return n.promise};return k};b.createResolver=function(){var a,b,d=k(function(c,d){a=c;b=d}),e=function(b){a(b)};e.resolve=function(b){return a(b)};e.reject=function(a){return b(a)};e.timeout=function(a,b){return G.default.setTimeout(function(){return e.reject(b)},a)};e.promise=d;return e};b.always=function(a,b){return a.then(b,b)}});