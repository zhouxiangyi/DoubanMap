// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
require({cache:{"@dojo/framework/shim/Map":function(){(function(u){"object"===typeof module&&"object"===typeof module.exports?(u=u(require,exports),void 0!==u&&(module.exports=u)):"function"===typeof define&&define.amd&&define("require exports tslib ./iterator ./global ./object ../has/has ./Symbol".split(" "),u)})(function(u,f){Object.defineProperty(f,"__esModule",{value:!0});var e=u("tslib"),r=u("./iterator"),m=u("./global"),d=u("./object"),g=u("../has/has");u("./Symbol");f.Map=m.default.Map;g.default("es6-map")||
(f.Map=(k=function(){function g(c){this._keys=[];this._values=[];this[Symbol.toStringTag]="Map";if(c)if(r.isArrayLike(c))for(var a=0;a<c.length;a++){var b=c[a];this.set(b[0],b[1])}else try{for(var a=e.__values(c),q=a.next();!q.done;q=a.next())b=q.value,this.set(b[0],b[1])}catch(x){g={error:x}}finally{try{q&&!q.done&&(t=a.return)&&t.call(a)}finally{if(g)throw g.error;}}var g,t}g.prototype._indexOfKey=function(c,a){for(var b=0,q=c.length;b<q;b++)if(d.is(c[b],a))return b;return-1};Object.defineProperty(g.prototype,
"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0});g.prototype.clear=function(){this._keys.length=this._values.length=0};g.prototype.delete=function(c){c=this._indexOfKey(this._keys,c);if(0>c)return!1;this._keys.splice(c,1);this._values.splice(c,1);return!0};g.prototype.entries=function(){var c=this,a=this._keys.map(function(a,q){return[a,c._values[q]]});return new r.ShimIterator(a)};g.prototype.forEach=function(c,a){for(var b=this._keys,q=this._values,g=0,t=b.length;g<
t;g++)c.call(a,q[g],b[g],this)};g.prototype.get=function(c){c=this._indexOfKey(this._keys,c);return 0>c?void 0:this._values[c]};g.prototype.has=function(c){return-1<this._indexOfKey(this._keys,c)};g.prototype.keys=function(){return new r.ShimIterator(this._keys)};g.prototype.set=function(c,a){var b=this._indexOfKey(this._keys,c),b=0>b?this._keys.length:b;this._keys[b]=c;this._values[b]=a;return this};g.prototype.values=function(){return new r.ShimIterator(this._values)};g.prototype[Symbol.iterator]=
function(){return this.entries()};return g}(),k[Symbol.species]=k,k));f.default=f.Map;var k})},"@dojo/framework/shim/object":function(){(function(u){"object"===typeof module&&"object"===typeof module.exports?(u=u(require,exports),void 0!==u&&(module.exports=u)):"function"===typeof define&&define.amd&&define(["require","exports","./global","../has/has","./Symbol"],u)})(function(u,f){Object.defineProperty(f,"__esModule",{value:!0});var e=u("./global"),r=u("../has/has"),m=u("./Symbol");r.default("es6-object")?
(u=e.default.Object,f.assign=u.assign,f.getOwnPropertyDescriptor=u.getOwnPropertyDescriptor,f.getOwnPropertyNames=u.getOwnPropertyNames,f.getOwnPropertySymbols=u.getOwnPropertySymbols,f.is=u.is,f.keys=u.keys):(f.keys=function(d){return Object.keys(d).filter(function(g){return!g.match(/^@@.+/)})},f.assign=function(d){for(var g=[],k=1;k<arguments.length;k++)g[k-1]=arguments[k];if(null==d)throw new TypeError("Cannot convert undefined or null to object");var e=Object(d);g.forEach(function(c){c&&f.keys(c).forEach(function(a){e[a]=
c[a]})});return e},f.getOwnPropertyDescriptor=function(d,g){m.isSymbol(g);return Object.getOwnPropertyDescriptor(d,g)},f.getOwnPropertyNames=function(d){return Object.getOwnPropertyNames(d).filter(function(g){return!g.match(/^@@.+/)})},f.getOwnPropertySymbols=function(d){return Object.getOwnPropertyNames(d).filter(function(g){return!!g.match(/^@@.+/)}).map(function(g){return Symbol.for(g.substring(2))})},f.is=function(d,g){return d===g?0!==d||1/d===1/g:d!==d&&g!==g});r.default("es2017-object")?(u=
e.default.Object,f.getOwnPropertyDescriptors=u.getOwnPropertyDescriptors,f.entries=u.entries,f.values=u.values):(f.getOwnPropertyDescriptors=function(d){return f.getOwnPropertyNames(d).reduce(function(g,k){g[k]=f.getOwnPropertyDescriptor(d,k);return g},{})},f.entries=function(d){return f.keys(d).map(function(g){return[g,d[g]]})},f.values=function(d){return f.keys(d).map(function(g){return d[g]})})})},"esri/widgets/Attachments":function(){define("require exports tslib ../core/Error ../core/unitFormatUtils ../core/watchUtils ../core/accessorSupport/decorators ./Widget ./Attachments/AttachmentsViewModel ./Attachments/support/attachmentUtils ./support/widget".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a){var b={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},q=window.CSS;return function(k){function t(a,c){a=k.call(this,a,c)||this;a.abilities=null;a.displayType="list";a.graphic=null;a.label=void 0;a.messages=null;a.messagesUnits=null;a.selectedFile=null;a.submitting=!1;a.viewModel=new l;a.visibleElements=e.__assign({},b);a._supportsImageOrientation=q&&q.supports&&q.supports("image-orientation",
"from-image");a._addAttachmentForm=null;a._updateAttachmentForm=null;return a}e.__extends(t,k);t.prototype.initialize=function(){var a=this;this.own(d.on(this,"viewModel.attachmentInfos","change",function(){return a.scheduleRender()}),d.init(this,"viewModel.mode",function(){return a._modeChanged()}))};t.prototype.castVisibleElements=function(a){return e.__assign(e.__assign({},b),a)};t.prototype.addAttachment=function(){var a=this,b=this._addAttachmentForm,c=this.viewModel;this._set("submitting",!0);
this._set("error",null);return c.addAttachment(b).then(function(b){a._set("submitting",!1);a._set("error",null);c.mode="view";return b}).catch(function(b){a._set("submitting",!1);a._set("error",new r("attachments:add-attachment",a.messages.addErrorMessage,b));throw b;})};t.prototype.deleteAttachment=function(a){var b=this,c=this.viewModel;this._set("submitting",!0);this._set("error",null);return c.deleteAttachment(a).then(function(a){b._set("submitting",!1);b._set("error",null);c.mode="view";return a}).catch(function(a){b._set("submitting",
!1);b._set("error",new r("attachments:delete-attachment",b.messages.deleteErrorMessage,a));throw a;})};t.prototype.updateAttachment=function(){var a=this,b=this.viewModel,c=this._updateAttachmentForm;this._set("submitting",!0);this._set("error",null);return b.updateAttachment(c).then(function(c){a._set("submitting",!1);a._set("error",null);b.mode="view";return c}).catch(function(b){a._set("submitting",!1);a._set("error",new r("attachments:update-attachment",a.messages.updateErrorMessage,b));throw b;
})};t.prototype.render=function(){var b=this.submitting,c=this.viewModel.state;return a.tsx("div",{class:this.classes("esri-attachments","esri-widget")},b?this.renderProgressBar():null,"loading"===c?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())};t.prototype.renderErrorMessage=function(){var b=this.error,c=this.visibleElements;return b&&c.errorMessage?a.tsx("div",{key:"error-message",class:"esri-attachments__error-message"},b.message):null};t.prototype.renderAttachments=
function(){var a=this.viewModel,b=a.mode,a=a.activeAttachmentInfo;return"add"===b?this.renderAddForm():"edit"===b?this.renderDetailsForm(a):this.renderAttachmentContainer()};t.prototype.renderLoading=function(){return a.tsx("div",{class:"esri-attachments__loader-container",key:"loader"},a.tsx("div",{class:"esri-attachments__loader"}))};t.prototype.renderProgressBar=function(){return this.visibleElements.progressBar?a.tsx("div",{class:"esri-attachments__progress-bar",key:"progress-bar"}):null};t.prototype.renderAddForm=
function(){var b,c=this.submitting,t=this.selectedFile,g=c||!t,c=this.visibleElements.cancelAddButton?a.tsx("button",{type:"button",bind:this,disabled:c,onclick:this._cancelForm,class:this.classes("esri-button","esri-button--tertiary","esri-button--small","esri-button--half",c&&"esri-button--disabled")},this.messages.cancel):null,g=this.visibleElements.addSubmitButton?a.tsx("button",{type:"submit",disabled:g,class:this.classes("esri-button","esri-button--secondary","esri-button--small","esri-button--half",
(b={},b["esri-button--disabled"]=g,b))},this.messages.add):null;b=t?a.tsx("span",{key:"file-name",class:"esri-attachments__file-name"},t.name):null;t=a.tsx("form",{bind:this,afterCreate:a.storeNode,afterRemoved:a.discardNode,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},a.tsx("fieldset",{class:"esri-attachments__file-fieldset"},b,a.tsx("label",{class:this.classes("esri-attachments__file-label","esri-button","esri-button--secondary")},t?this.messages.changeFile:this.messages.selectFile,
a.tsx("input",{class:"esri-attachments__file-input",type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),g,c);return a.tsx("div",{key:"add-form-container",class:"esri-attachments__form-node"},t)};t.prototype.renderDetailsForm=function(b){var c,t,x,g=this,q=this.visibleElements,k=this.selectedFile,d=this.submitting,v=b.contentType,e=b.size,l=b.url,f=this.viewModel.abilities,r=d||!k,L=f.editing&&f.operations.delete&&q.deleteButton?a.tsx("button",{key:"delete-button",type:"button",
disabled:d,bind:this,onclick:function(a){return g._submitDeleteAttachment(a,b)},class:this.classes("esri-button","esri-button--small","esri-button--tertiary","esri-attachments__delete-button",(c={},c["esri-button--disabled"]=d,c))},this.messages.delete):null;c=f.editing&&f.operations.update&&q.updateButton?a.tsx("button",{disabled:r,key:"update-button",type:"submit",class:this.classes("esri-button","esri-button--small","esri-button--third",(t={},t["esri-button--disabled"]=r,t))},this.messages.update):
null;t=this.visibleElements.cancelUpdateButton?a.tsx("button",{disabled:d,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes("esri-button","esri-button--small","esri-button--tertiary","esri-button--third",(x={},x["esri-button--disabled"]=d,x))},this.messages.cancel):null;x=k?a.tsx("span",{key:"file-name",class:"esri-attachments__file-name"},k.name):null;f=f.editing&&f.operations.update?a.tsx("fieldset",{key:"file",class:"esri-attachments__file-fieldset"},x,a.tsx("label",
{class:this.classes("esri-attachments__file-label","esri-button","esri-button--secondary")},this.messages.changeFile,a.tsx("input",{class:"esri-attachments__file-input",type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):null;e=a.tsx("fieldset",{key:"size",class:"esri-attachments__metadata-fieldset"},a.tsx("label",null,m.formatFileSize(this.messagesUnits,e)));v=a.tsx("fieldset",{key:"content-type",class:"esri-attachments__metadata-fieldset"},a.tsx("label",null,v));L=a.tsx("form",
{bind:this,afterCreate:a.storeNode,afterRemoved:a.discardNode,"data-node-ref":"_updateAttachmentForm",onsubmit:this._submitUpdateAttachment},a.tsx("div",{class:"esri-attachments__metadata"},e,v),f,a.tsx("div",{class:"esri-attachments__actions"},L,t,c));return a.tsx("div",{key:"edit-form-container",class:"esri-attachments__form-node"},a.tsx("a",{class:"esri-attachments__item-link",href:l,rel:"noreferrer",target:"_blank",alt:name},this.renderImageMask({attachmentInfo:b,size:400}),a.tsx("div",{class:"esri-attachments__item-link-overlay"},
a.tsx("span",{class:"esri-attachments__item-link-overlay-icon"},a.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},a.tsx("path",{d:"M28 13h1v16H3V3h16v1H4v24h24zm-5-9h4.293L15.646 15.638l.707.707L28 4.707V9h1V3h-6z"}),a.tsx("path",{fill:"none",d:"M0 0h32v32H0z"}))))),L)};t.prototype.renderImageMask=function(b){var t,x,g=b.attachmentInfo,q=b.size;b=this.viewModel.supportsResizeAttachments;var k=g.contentType,d=g.url,v=b&&c.isSupportedImage(k),g=(g=this._getCSSTransform(g,
v))?{transform:g,"image-orientation":"none"}:{},e=-1===d.indexOf("?")?"?":"\x26",q=v?""+d+e+"w\x3d"+q:c.getIconPath(k),v=(t={},t["esri-attachments__item-mask--icon"]=!v,t);t=(x={},x["esri-attachments__image--resizable"]=b,x);return a.tsx("div",{class:this.classes(v,"esri-attachments__item-mask")},a.tsx("img",{styles:g,alt:"",src:q,class:this.classes(t,"esri-attachments__image")}))};t.prototype.renderAttachmentInfo=function(b){var c=this,t=b.attachmentInfo,x=this.viewModel.abilities,g=t.name,q=t.url;
b=this.renderImageMask({attachmentInfo:t,size:"list"===b.displayType?48:400});var k=x.editing?a.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",a.isRTL()?"esri-icon-left":"esri-icon-right")}):null,g=a.tsx("label",{class:"esri-attachments__label"},a.tsx("span",{class:"esri-attachments__filename"},g||this.messages.noTitle),k),g=[b,g],x=x.editing?a.tsx("button",{key:"details-button",bind:this,class:"esri-attachments__item-button",title:this.messages.attachmentDetails,
"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":t.id,onclick:function(){return c._startEditAttachment(t)}},g):a.tsx("a",{key:"details-link",class:"esri-attachments__item-button",href:q,target:"_blank"},g);return a.tsx("li",{class:"esri-attachments__item",key:t},x)};t.prototype.renderAttachmentContainer=function(){var b,c=this,t=this.displayType,g=this.viewModel,q=this.visibleElements,k=g.attachmentInfos,d=g.abilities,v=k&&k.length,g=(b={},b["esri-attachments__container--list"]=
"preview"!==t,b["esri-attachments__container--preview"]="preview"===t,b);b=d.editing&&d.operations.add&&q.addButton?a.tsx("button",{bind:this,onclick:function(){return c._startAddAttachment()},class:this.classes("esri-button","esri-button--tertiary","esri-attachments__add-attachment-button")},a.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-add-icon","esri-icon-plus")}),this.messages.add):null;k=v?a.tsx("ul",{class:"esri-attachments__items"},k.toArray().map(function(a){return c.renderAttachmentInfo({attachmentInfo:a,
displayType:t})})):a.tsx("div",{class:"esri-widget__content--empty"},this.messages.noAttachments);return a.tsx("div",{key:"attachments-container",class:this.classes("esri-attachments__container",g)},k,b)};t.prototype._modeChanged=function(){this._set("error",null);this._set("selectedFile",null)};t.prototype._handleFileInputChange=function(a){a=(a=a.target)&&a.files&&a.files.item(0);this._set("selectedFile",a)};t.prototype._submitDeleteAttachment=function(a,b){a.preventDefault();this.deleteAttachment(b)};
t.prototype._submitAddAttachment=function(a){a.preventDefault();this.addAttachment()};t.prototype._submitUpdateAttachment=function(a){a.preventDefault();this.updateAttachment()};t.prototype._startEditAttachment=function(a){var b=this.viewModel;b.activeAttachmentInfo=a;b.mode="edit"};t.prototype._startAddAttachment=function(){this.viewModel.mode="add"};t.prototype._cancelForm=function(a){a.preventDefault();this.viewModel.mode="view"};t.prototype._getCSSTransform=function(a,b){a=a.orientationInfo;return!this._supportsImageOrientation&&
b&&a?[a.rotation?"rotate("+a.rotation+"deg)":"",a.mirrored?"scaleX(-1)":""].join(" "):""};e.__decorate([g.aliasOf("viewModel.abilities")],t.prototype,"abilities",void 0);e.__decorate([g.property(),a.renderable()],t.prototype,"displayType",void 0);e.__decorate([g.aliasOf("viewModel.graphic")],t.prototype,"graphic",void 0);e.__decorate([g.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],t.prototype,"label",void 0);e.__decorate([g.property(),a.renderable(),a.messageBundle("esri/widgets/Attachments/t9n/Attachments")],
t.prototype,"messages",void 0);e.__decorate([g.property(),a.renderable(),a.messageBundle("esri/core/t9n/Units")],t.prototype,"messagesUnits",void 0);e.__decorate([g.property({readOnly:!0})],t.prototype,"selectedFile",void 0);e.__decorate([a.renderable(),g.property({readOnly:!0})],t.prototype,"submitting",void 0);e.__decorate([a.renderable(),g.property({readOnly:!0})],t.prototype,"error",void 0);e.__decorate([g.property({type:l}),a.renderable("viewModel.activeAttachmentInfo viewModel.mode viewModel.state viewModel.supportsResizeAttachments viewModel.attachmentInfos viewModel.graphic viewModel.abilities viewModel.abilities.editing viewModel.abilities.operations".split(" "))],
t.prototype,"viewModel",void 0);e.__decorate([g.property(),a.renderable()],t.prototype,"visibleElements",void 0);e.__decorate([g.cast("visibleElements")],t.prototype,"castVisibleElements",null);return t=e.__decorate([g.subclass("esri.widgets.Attachments")],t)}(k)})},"esri/core/unitFormatUtils":function(){define("require exports ./mathUtils ./string ./unitUtils ../intl/number".split(" "),function(u,f,e,r,m,d){function g(c,a,b){return c.units[a][b]}function k(c,a,b,q,k){void 0===q&&(q=2);void 0===k&&
(k="abbr");return d.formatNumber(a,{minimumFractionDigits:q,maximumFractionDigits:q})+" "+g(c,b,k)}Object.defineProperty(f,"__esModule",{value:!0});f.unitName=g;f.formatDecimal=k;f.formatMetricLength=function(c,a,b,g,d){void 0===g&&(g=2);void 0===d&&(d="abbr");var t=m.preferredMetricLengthUnit(a,b);return k(c,m.convertUnit(a,b,t),t,g,d)};f.formatMetricVerticalLength=function(c,a,b,g,d){void 0===g&&(g=2);void 0===d&&(d="abbr");var t=m.preferredMetricVerticalLengthUnit(a,b);return k(c,m.convertUnit(a,
b,t),t,g,d)};f.formatImperialLength=function(c,a,b,g,d){void 0===g&&(g=2);void 0===d&&(d="abbr");var t=m.preferredImperialLengthUnit(a,b);return k(c,m.convertUnit(a,b,t),t,g,d)};f.formatImperialVerticalLength=function(c,a,b,g,d){void 0===g&&(g=2);void 0===d&&(d="abbr");var t=m.preferredImperialVerticalLengthUnit(a,b);return k(c,m.convertUnit(a,b,t),t,g,d)};f.formatMetricArea=function(c,a,b,g,d){void 0===g&&(g=2);void 0===d&&(d="abbr");var t=m.preferredMetricAreaUnit(a,b);return k(c,m.convertUnit(a,
b,t),t,g,d)};f.formatImperialArea=function(c,a,b,g,d){void 0===g&&(g=2);void 0===d&&(d="abbr");var t=m.preferredImperialAreaUnit(a,b);return k(c,m.convertUnit(a,b,t),t,g,d)};f.formatDMS=function(c,a,b){void 0===b&&(b=2);c=m.convertUnit(c,a,"degrees");a=c-Math.floor(c);c-=a;a*=60;var g=a-Math.floor(a);a-=g;g*=60;return c.toFixed()+"\u00b0 "+a.toFixed()+"' "+g.toFixed(b)+'"'};var l=["B","kB","MB","GB","TB"];f.formatFileSize=function(c,a){var b=0===a?0:Math.floor(Math.log(a)/Math.log(1024)),b=e.clamp(b,
0,l.length-1);a=d.formatNumber(a/Math.pow(1024,b),{maximumFractionDigits:2});return r.replace(c.units.bytes[l[b]],{fileSize:a})}})},"esri/widgets/Attachments/AttachmentsViewModel":function(){define("require exports tslib ../../Graphic ../../core/Collection ../../core/Error ../../core/HandleOwner ../../core/watchUtils ../../core/accessorSupport/decorators ../../layers/support/AttachmentInfo ../../tasks/support/AttachmentQuery ../Feature/support/featureUtils".split(" "),function(u,f,e,r,m,d,g,k,l,c,
a,b){var q={editing:!1,operations:{add:!0,update:!0,delete:!0}},v=m.ofType(c);return function(c){function t(a){var b=c.call(this,a)||this;b._getAttachmentsPromise=null;b._attachmentLayer=null;b.abilities=e.__assign({},q);b.activeAttachmentInfo=null;b.attachmentInfos=new v;b.graphic=null;b.mode="view";b.handles.add([k.init(b,"graphic",function(){return b._graphicChanged()})]);return b}e.__extends(t,c);t.prototype.destroy=function(){this.graphic=this._attachmentLayer=null};t.prototype.castAbilities=
function(a){return e.__assign(e.__assign({},q),a)};Object.defineProperty(t.prototype,"state",{get:function(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"supportsResizeAttachments",{get:function(){return this.get("graphic.layer.capabilities.operations.supportsResizeAttachments")||!1},enumerable:!0,configurable:!0});t.prototype.getAttachments=function(){return e.__awaiter(this,void 0,void 0,function(){var b,
c,t,g,k,x,q,v;return e.__generator(this,function(e){switch(e.label){case 0:b=this;c=b._attachmentLayer;t=b.attachmentInfos;if(!c||"function"!==typeof c.queryAttachments)throw new d("invalid-layer","getAttachments(): A valid layer is required.");g=this._getFeatureId();k=new a({objectIds:[g],returnMetadata:!0});x=[];this._getAttachmentsPromise=q=c.queryAttachments(k).then(function(a){return a[g]||x}).catch(function(){return x});this.notifyChange("state");return[4,q];case 1:return v=e.sent(),t.removeAll(),
v.length&&t.addMany(v),this._getAttachmentsPromise=null,this.notifyChange("state"),[2,v]}})})};t.prototype.addAttachment=function(a){return e.__awaiter(this,void 0,void 0,function(){var b,c,t,g,k,x,q,v=this;return e.__generator(this,function(e){switch(e.label){case 0:b=this;c=b._attachmentLayer;t=b.attachmentInfos;g=b.graphic;k=b.abilities;if(!a)throw new d("invalid-attachment","addAttachment(): An attachment is required.",{attachment:a});if(!k.operations.add)throw new d("invalid-abilities","addAttachment(): add abilities are required.");
if(!c||"function"!==typeof c.addAttachment)throw new d("invalid-layer","addAttachment(): A valid layer is required.");x=c.addAttachment(g,a).then(function(a){return v._queryAttachment(a.objectId)});return[4,x];case 1:return q=e.sent(),t.add(q),[2,q]}})})};t.prototype.deleteAttachment=function(a){return e.__awaiter(this,void 0,void 0,function(){var b,c,t,g,k,x,q;return e.__generator(this,function(e){switch(e.label){case 0:b=this;c=b._attachmentLayer;t=b.attachmentInfos;g=b.graphic;k=b.abilities;if(!a)throw new d("invalid-attachment-info",
"deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:a});if(!k.operations.delete)throw new d("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!c||"function"!==typeof c.deleteAttachments)throw new d("invalid-layer","deleteAttachment(): A valid layer is required.");x=c.deleteAttachments(g,[a.id]).then(function(){return a});return[4,x];case 1:return q=e.sent(),t.remove(q),[2,q]}})})};t.prototype.updateAttachment=function(a,b){void 0===b&&(b=this.activeAttachmentInfo);
return e.__awaiter(this,void 0,void 0,function(){var c,t,g,k,x,q,v,l,z=this;return e.__generator(this,function(e){switch(e.label){case 0:c=this;t=c._attachmentLayer;g=c.attachmentInfos;k=c.graphic;x=c.abilities;if(!a)throw new d("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:a});if(!b)throw new d("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:b});if(!x.operations.update)throw new d("invalid-abilities","updateAttachment(): Update abilities are required.");
q=g.findIndex(function(a){return a===b});if(!t||"function"!==typeof t.updateAttachment)throw new d("invalid-layer","updateAttachment(): A valid layer is required.");v=t.updateAttachment(k,b.id,a).then(function(a){return z._queryAttachment(a.objectId)});return[4,v];case 1:return l=e.sent(),g.splice(q,1,l),[2,l]}})})};t.prototype._queryAttachment=function(b){return e.__awaiter(this,void 0,void 0,function(){var c,t,g;return e.__generator(this,function(k){if(!b)throw new d("invalid-attachment-id","Could not query attachment.");
c=this._attachmentLayer;t=this._getFeatureId();g=new a({objectIds:[t],attachmentsWhere:"AttachmentId\x3d"+b,returnMetadata:!0});return[2,c.queryAttachments(g).then(function(a){return a[t][0]})]})})};t.prototype._getFeatureId=function(){var a=this._attachmentLayer,b=this.graphic;if(!a||!b)return null;a=a.objectIdField;return(b=b.attributes)&&b[a]};t.prototype._graphicChanged=function(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(function(){}))};t.prototype._setAttachmentLayer=
function(){var a=b.getSourceLayer(this.graphic);this._attachmentLayer=a?"scene"===a.type&&a.associatedLayer?a.associatedLayer:a:null};e.__decorate([l.property()],t.prototype,"abilities",void 0);e.__decorate([l.cast("abilities")],t.prototype,"castAbilities",null);e.__decorate([l.property()],t.prototype,"activeAttachmentInfo",void 0);e.__decorate([l.property({readOnly:!0,type:v})],t.prototype,"attachmentInfos",void 0);e.__decorate([l.property({type:r})],t.prototype,"graphic",void 0);e.__decorate([l.property()],
t.prototype,"mode",void 0);e.__decorate([l.property({dependsOn:["graphic"],readOnly:!0})],t.prototype,"state",null);e.__decorate([l.property({readOnly:!0,dependsOn:["graphic","graphic.layer","graphic.layer.loaded","graphic.layer.capabilities.operations.supportsResizeAttachments"]})],t.prototype,"supportsResizeAttachments",null);return t=e.__decorate([l.subclass("esri.widgets.Attachments.AttachmentsViewModel")],t)}(g.HandleOwner)})},"esri/widgets/Feature/support/featureUtils":function(){define(["require",
"exports","tslib"],function(u,f,e){function r(g){return d.test(g)}function m(g,k){if(!r(k)||!g)return null;var e=k.replace(d,"").toLowerCase(),c;g.some(function(a){return a.name.toLowerCase()===e?(c=a,!0):!1});return c}Object.defineProperty(f,"__esModule",{value:!0});f.getSourceLayer=function(g){if(g)return g.get("sourceLayer")||g.get("layer")};f.graphicCallback=function(g,k){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(d){return[2,"function"===typeof g?g.call(null,
k):g]})})};f.shouldOpenInNewTab=function(g){void 0===g&&(g="");if(g)return!/^(?:mailto:|tel:)/.test(g.trim().toLowerCase())};var d=/^\s*expression\//i;f.isExpressionField=r;f.getFieldInfoLabel=function(g,k){return(k=m(k,null===g||void 0===g?void 0:g.fieldName))?k.title||null:g?g.label||g.fieldName:null}})},"esri/widgets/Attachments/support/attachmentUtils":function(){define(["require","exports","../../../assets"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});var r=e.getAssetUrl("esri/themes/base/images/files/");
f.isSupportedImage=function(e){e=e.toLowerCase();return"image/bmp"===e||"image/emf"===e||"image/exif"===e||"image/gif"===e||"image/x-icon"===e||"image/jpeg"===e||"image/png"===e||"image/tiff"===e||"image/x-wmf"===e};f.getIconPath=function(e){return e?"text/plain"===e?r+"text-32.svg":"application/pdf"===e?r+"pdf-32.svg":"text/csv"===e?r+"csv-32.svg":"application/gpx+xml"===e?r+"gpx-32.svg":"application/x-dwf"===e?r+"cad-32.svg":"application/postscript"===e||"application/json"===e||"text/xml"===e||
"model/vrml"===e?r+"code-32.svg":"application/x-zip-compressed"===e||"application/x-7z-compressed"===e||"application/x-gzip"===e||"application/x-tar"===e||"application/x-gtar"===e||"application/x-bzip2"===e||"application/gzip"===e||"application/x-compress"===e||"application/x-apple-diskimage"===e||"application/x-rar-compressed"===e||"application/zip"===e?r+"zip-32.svg":-1!==e.indexOf("image/")?r+"image-32.svg":-1!==e.indexOf("audio/")?r+"sound-32.svg":-1!==e.indexOf("video/")?r+"video-32.svg":-1!==
e.indexOf("msexcel")||-1!==e.indexOf("ms-excel")||-1!==e.indexOf("spreadsheetml")?r+"excel-32.svg":-1!==e.indexOf("msword")||-1!==e.indexOf("ms-word")||-1!==e.indexOf("wordprocessingml")?r+"word-32.svg":-1!==e.indexOf("powerpoint")||-1!==e.indexOf("presentationml")?r+"report-32.svg":r+"generic-32.svg":r+"generic-32.svg"}})},"esri/widgets/FeatureForm":function(){define("require exports tslib ../intl ../core/domUtils ../core/accessorSupport/decorators ../intl/moment ../layers/support/domains ../layers/support/fieldUtils ./Widget ./FeatureForm/FeatureFormViewModel ./support/widget".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b){return function(c){function q(b,g){b=c.call(this,b,g)||this;b._fieldFocusNeeded=!1;b._activeDateEdit=null;b._activeInputName=null;b._moment=null;b.description=null;b.feature=null;b.fieldConfig=null;b.formTemplate=null;b.groupDisplay="all";b.label=void 0;b.layer=null;b.messages=null;b.strict=null;b.title=null;b.viewModel=new a;b._handleFormKeyDown=b._handleFormKeyDown.bind(b);b._handleInputBlur=b._handleInputBlur.bind(b);b._handleInputFocus=b._handleInputFocus.bind(b);
b._handleNumberInputMouseDown=b._handleNumberInputMouseDown.bind(b);b._handleInputKeyDown=b._handleInputKeyDown.bind(b);b._handleOptionChange=b._handleOptionChange.bind(b);b._handleGroupClick=b._handleGroupClick.bind(b);b._handleSubmit=b._handleSubmit.bind(b);b._afterScrollerCreateOrUpdate=b._afterScrollerCreateOrUpdate.bind(b);return b}e.__extends(q,c);q.prototype.loadLocale=function(){return e.__awaiter(this,void 0,void 0,function(){var a;return e.__generator(this,function(b){switch(b.label){case 0:return a=
this,[4,g.loadMoment()];case 1:return a._moment=b.sent(),[2]}})})};q.prototype.initialize=function(){var a=this;this.own(this.watch("feature",function(){var b=a._getFocusableInput("forward");a._activeInputName=b&&b.name;a._fieldFocusNeeded=!0}),this.on("submit",function(b){0<b.invalid.length&&(a._activeInputName=b.invalid[0],a._fieldFocusNeeded=!0,a.scheduleRender())}))};q.prototype.getValues=function(){return null};q.prototype.submit=function(){return null};q.prototype.render=function(){var a=this.viewModel.state;
return b.tsx("div",{class:this.classes("esri-feature-form","esri-widget","esri-widget--panel")},"ready"===a?this.renderForm():null)};q.prototype.renderForm=function(){var a=this.title?b.tsx("h1",{class:"esri-widget__heading",key:"title"},this.title):null,c=this.description?b.tsx("h2",{class:"esri-widget__heading",key:"description"},this.description):null;return b.tsx("form",{class:"esri-feature-form__form",novalidate:!0,onsubmit:this._handleSubmit,onkeydown:this._handleFormKeyDown},a,c,this.renderFields())};
q.prototype.renderFields=function(){var a=this;return this.viewModel.inputFields.map(function(b,c){return b&&b.inputFields?a.renderGroup(b,c):a.renderLabeledField(b)})};q.prototype.renderGroup=function(a,c){var t=this,g=a.description,q=a.label,k=a.inputFields,d=a.state,x=this.viewModel.findField(this._activeInputName),x=!(!x||x.group!==a),e=this.id+"_group_"+c,l=this.id+"_group-label_"+c,v=this.id+"_group-description_"+c,f=g?b.tsx("p",{class:this.classes("esri-feature-form__group-description","esri-feature-form__description-text"),
id:v},g):null,m="sequential"===this.groupDisplay,d=m?x:"expanded"===d;return b.tsx("fieldset",{"aria-expanded":d.toString(),"aria-labelledby":l,"aria-describedby":g?v:"",class:this.classes("esri-feature-form__group",m?"esri-feature-form__group--sequential":null,d?null:"esri-feature-form__group--collapsed",x?"esri-feature-form__group--active":null),"data-group":a,id:e,key:c,onclick:this._handleGroupClick},b.tsx("div",{class:"esri-feature-form__group-header"},b.tsx("div",{class:"esri-feature-form__group-label",
id:l},q),f),k.map(function(a){return t.renderLabeledField(a)}))};q.prototype._getFocusableInput=function(a,b){var c=this.viewModel._allInputFields,c="forward"===a?c:c.slice().reverse();if(b)if(b&&b.inputFields)a=c.indexOf(b.inputFields[0]);else{var t=void 0;this._isFieldInClosedCollapsibleGroup(b)?(b=b.group.inputFields,t="forward"===a?b[b.length-1]:b[0]):t=b;a=c.indexOf(t)+1}else a=0;for(;a<c.length;a++)if(b=c[a],b.visible&&b.editable)return b;return null};q.prototype.renderLabeledField=function(a){return b.tsx("label",
{key:a.layer.id+"-"+a.name,class:"esri-feature-form__label"},[a.label,"unsupported"!==a.type?this.renderInputField(a):this.renderUnsupportedField(a),this.renderAuxiliaryText(a)])};q.prototype.renderInputField=function(a){var c=a.domain,t=a.editable,g=a.type,q=this.viewModel.getValue(a.name),t=!t,k=this.getCommonInputProps(a);return c&&"coded-value"===c.type&&!t?this.renderSelectInputField(q,c.codedValues.map(function(a){return{value:a.code,name:a.name}}),k):"text"===g&&"text-area"===a.editorType||
"rich-text"===a.editorType?b.tsx("textarea",e.__assign({},k)):"date"===g?this.renderDateInputField(q,k):b.tsx("input",e.__assign({type:"text"===g?"text":"number"},k))};q.prototype.renderDateInputField=function(a,c){var t=this._formatDate(0),g=t.date,t=t.time,q=this.id+"-"+c.key,k=q+"-date",q=q+"-time",d=c["data-field"],x=this._formatDate(a);a=x.date;x=x.time;return b.tsx("div",{key:c.key+"-date",class:"esri-feature-form__date-input-container"},b.tsx("div",{class:"esri-feature-form__date-input-part"},
b.tsx("input",e.__assign({"aria-label":d.label,"aria-describedby":k,type:"text"},c,{"data-date-part":"date",class:this.classes(c.class,"esri-feature-form__input--date"),value:a})),b.tsx("div",{class:"esri-feature-form__date-format-hint",id:k},g)),b.tsx("div",{class:"esri-feature-form__date-input-part"},b.tsx("input",e.__assign({"aria-describedby":q,"aria-label":d.label,type:"text"},c,{"data-date-part":"time",class:this.classes(c.class,"esri-feature-form__input--time"),value:x})),b.tsx("div",{class:"esri-feature-form__date-format-hint",
id:q},t)))};q.prototype.renderUnsupportedField=function(a){a=this.viewModel.getValue(a.name);return b.tsx("input",{class:this.classes("esri-input","esri-feature-form__input","esri-feature-form__input--disabled"),disabled:!0,type:"text",value:""+a})};q.prototype.renderSelectInputField=function(a,c,g){var t=!1;c=c.map(function(c){c.value===a&&(t=!0);return b.tsx("option",{value:""+c.value,key:c.name},c.name)});null==a||""===a||t||c.unshift(b.tsx("option",{value:""+a,key:"outlier-option"},a));var q=
g["data-field"];q.required||null!=q.value||c.unshift(b.tsx("option",{value:"",key:"empty-option"}));return b.tsx("select",e.__assign({},g,{class:this.classes(g.class,"esri-select"),onchange:this._handleOptionChange}),c)};q.prototype.renderAuxiliaryText=function(a){if(!a.valid)return b.tsx("div",{key:"error-message"},b.tsx("span",{class:this.classes("esri-feature-form__input-icon--invalid","esri-icon-notice-triangle")}),b.tsx("div",{class:"esri-feature-form__field-error-message"},a.errorMessage));
if(a.valid&&a.description)return b.tsx("div",{key:"description",class:"esri-feature-form__description-text"},a.description)};q.prototype.getCommonInputProps=function(a){var b=a.editable,c=a.name,g=a.required,t=a.maxLength,q=a.minLength,k=a.hint,d=a.type,l=a.valid,v=this.viewModel.getValue(c),b=!b;return e.__assign(e.__assign({afterCreate:this._afterScrollerCreateOrUpdate,afterUpdate:this._afterScrollerCreateOrUpdate,"aria-invalid":l?"false":"true","class":this.classes("esri-input","esri-feature-form__input",
b?"esri-feature-form__input--disabled":null,l?null:"esri-feature-form__input--invalid"),key:c,minlength:-1<q?""+q:"",maxlength:-1<t?""+t:""},this._getNumberFieldConstraints(a)),{disabled:b,value:null==v?"":""+v,"data-field":a,onfocus:this._handleInputFocus,onblur:this._handleInputBlur,onkeydown:this._handleInputKeyDown,onmousedown:"number"===d?this._handleNumberInputMouseDown:null,required:g,title:k})};q.prototype._isFieldInClosedCollapsibleGroup=function(a){var b;return"all"===this.groupDisplay&&
!(a&&a.inputFields)&&"collapsed"===(null===(b=null===a||void 0===a?void 0:a.group)||void 0===b?void 0:b.state)};q.prototype._handleNumberInputMouseDown=function(a){a=a.target;a.disabled||a.focus();this.scheduleRender()};q.prototype._getNumberFieldConstraints=function(a){return(a=k.getDomainRange(a.domain)||l.getFieldRange(a.field))&&a.max!==Number.MAX_VALUE&&a.min!==Number.MIN_VALUE?a:{min:null,max:null}};q.prototype._afterScrollerCreateOrUpdate=function(a){var b=a["data-field"],c=this.viewModel.findField(this._activeInputName);
b.editable&&this._fieldFocusNeeded&&c===b&&(this._fieldFocusNeeded=!1,a.focus())};q.prototype._handleInputFocus=function(a){this._activeInputName=a.target["data-field"].name};q.prototype._handleInputBlur=function(a){var b=a.target,c=b["data-field"],g=(a=a.relatedTarget)&&a["data-field"];this._syncDateEditsBeforeValueCommit(b);g&&"date"===c.type&&"date"===g.type&&c.field===g.field?""!==b.value&&""===a.value&&(b=a.getAttribute("data-date-part"),a.value=this._formatDate(Date.now())[b]):(this._commitValue(b),
this.scheduleRender())};q.prototype._commitValue=function(a){var b=a["data-field"];if(this._activeDateEdit){var c=this._activeDateEdit,g=c.date,c=c.time,q=this._getDateEditValue(b,"date"),b=this._getDateEditValue(b,"time"),t=""===q||""===b;g&&(g.input.value=t?"":q);c&&(c.input.value=t?"":b);this._activeDateEdit=null;if(g&&c){this._updateDateFieldValue(g.input,c.input);return}}this._updateFieldValue(a)};q.prototype._getDateEditValue=function(a,b){var c=this._activeDateEdit[b];if(c)return""===c.value?
"":(c=this._parseDate(c.value,b))?this._formatDate(c.getTime())[b]:this._formatDate(a.value)[b]};q.prototype._handleInputKeyDown=function(a){var b=a.key,c=a.altKey,g=a.ctrlKey,q=a.metaKey,t=a.shiftKey,k=a.target,d=k["data-field"];"Tab"===b?(b=t?"backward":"forward",c=k.getAttribute("data-date-part"),this._syncDateEditsBeforeValueCommit(k),"backward"===b&&"time"===c||"forward"===b&&"date"===c||(this._commitValue(k),c=this.viewModel.findField(d.name),this._activeInputName=(b=this._getFocusableInput(b,
c))&&b.name,b?(a.preventDefault(),this._fieldFocusNeeded=!0):this.renderNow())):"Enter"!==b?(d=d.field.type,k="single"===d||"double"===d,"integer"!==d&&"small-integer"!==d&&!k||c||g||q||1!==b.length||(c=Number(b),g=["-","+"],q=["e","."],g=k?e.__spreadArrays(g,q):g,isNaN(c)&&-1===g.indexOf(b)&&a.preventDefault())):this._isFieldInClosedCollapsibleGroup(d)?d.group.state="expanded":(this._updateFieldValue(a.target),this.scheduleRender())};q.prototype._syncDateEditsBeforeValueCommit=function(a){var b;
if("date"===a["data-field"].type){var c=a.getAttribute("data-date-part");this._activeDateEdit=e.__assign(e.__assign({},this._activeDateEdit),(b={},b[c]={value:a.value,input:a},b))}};q.prototype._updateFieldValue=function(a){this.viewModel.setValue(a["data-field"].name,this._parseValue(a))};q.prototype._updateDateFieldValue=function(a,b){this.viewModel.setValue(a["data-field"].name,this._parseDateTimeValue(a,b))};q.prototype._parseValue=function(a){var b=a["data-field"],c=a.value,g=b.type;if("number"===
g)return parseFloat(c);if("date"===g){if(!c)return null;g=Number(c);if(!isNaN(g))return g;a=a.getAttribute("data-date-part");g=this._parseDate(c,a);if(!g)return null;var c=this._moment,g=c(g),q=b.domain,t=c(),k=t;q&&"range"===q.type&&(q=c(q.maxValue),t.isAfter(q)||(k=q));b=this.viewModel.getValue(b.name);b=c(null!=b?b:k);"date"===a?(g.hour(b.hour()),g.minutes(b.minutes()),g.seconds(b.seconds())):(g.date(b.date()),g.month(b.month()),g.year(b.year()));return g.valueOf()}return c};q.prototype._parseDateTimeValue=
function(a,b){a=a.value;b=b.value;if(!a||!b)return null;a=this._parseDate(a,"date");b=this._parseDate(b,"time");if(!a||!b)return null;a=this._moment(a);b=this._moment(b);a.hour(b.hour());a.minutes(b.minutes());a.seconds(b.seconds());return a.valueOf()};q.prototype._handleOptionChange=function(a){this._updateFieldValue(a.target);this.scheduleRender()};q.prototype._handleGroupClick=function(a){var b,c=a.currentTarget["data-group"],g="expanded"===c.state,q="sequential"===this.groupDisplay;if(!g||m.closest(a.target,
".esri-feature-form__group-header")){this._activeInputName=null===(b=this._getFocusableInput("forward",c))||void 0===b?void 0:b.name;if(q){if(g)return;this.viewModel.inputFields.forEach(function(a){a&&a.inputFields&&a!==c&&(a.state="collapsed")})}c.state=g?"collapsed":"expanded";this._fieldFocusNeeded=!0;this.scheduleRender()}};q.prototype._handleSubmit=function(a){a.preventDefault()};q.prototype._handleFormKeyDown=function(a){"Enter"===a.key&&this.viewModel.submit()};q.prototype._formatDate=function(a){if(null==
a)return{date:"",time:""};a=this._moment(a);return{date:a.format("L"),time:a.format("LTS")}};q.prototype._parseDate=function(a,b){if(null==a||""===a)return null;a=this._moment(a,"date"===b?"L":"LTS",r.getLocale(),!1);return a.isValid()?a.toDate():null};e.__decorate([d.aliasOf("viewModel.description"),b.renderable()],q.prototype,"description",void 0);e.__decorate([d.aliasOf("viewModel.feature")],q.prototype,"feature",void 0);e.__decorate([d.aliasOf("viewModel.fieldConfig")],q.prototype,"fieldConfig",
void 0);e.__decorate([d.aliasOf("viewModel.formTemplate")],q.prototype,"formTemplate",void 0);e.__decorate([d.property(),b.renderable()],q.prototype,"groupDisplay",void 0);e.__decorate([d.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],q.prototype,"label",void 0);e.__decorate([d.aliasOf("viewModel.layer")],q.prototype,"layer",void 0);e.__decorate([d.property(),b.renderable(),b.messageBundle("esri/widgets/FeatureForm/t9n/FeatureForm")],q.prototype,"messages",void 0);e.__decorate([d.aliasOf("viewModel.strict")],
q.prototype,"strict",void 0);e.__decorate([d.aliasOf("viewModel.title"),b.renderable()],q.prototype,"title",void 0);e.__decorate([d.property(),b.renderable(["viewModel.inputFields","viewModel.state"]),b.vmEvent(["value-change","submit"])],q.prototype,"viewModel",void 0);e.__decorate([d.aliasOf("viewModel.getValues")],q.prototype,"getValues",null);e.__decorate([d.aliasOf("viewModel.submit")],q.prototype,"submit",null);return q=e.__decorate([d.subclass("esri.widgets.FeatureForm")],q)}(c)})},"esri/intl/moment":function(){define("require exports tslib ../core/MapUtils ./locale @dojo/framework/shim/Promise".split(" "),
function(u,f,e,r,m){Object.defineProperty(f,"__esModule",{value:!0});var d=r.MapFromValues([["ar",function(){return new Promise(function(g,k){u(["moment/locale/ar"],g,k)})}],["ar-dz",function(){return new Promise(function(g,k){u(["moment/locale/ar-dz"],g,k)})}],["ar-kw",function(){return new Promise(function(g,k){u(["moment/locale/ar-kw"],g,k)})}],["ar-ly",function(){return new Promise(function(g,k){u(["moment/locale/ar-ly"],g,k)})}],["ar-ma",function(){return new Promise(function(g,k){u(["moment/locale/ar-ma"],
g,k)})}],["ar-sa",function(){return new Promise(function(g,k){u(["moment/locale/ar-sa"],g,k)})}],["ar-tn",function(){return new Promise(function(g,k){u(["moment/locale/ar-tn"],g,k)})}],["bs",function(){return new Promise(function(g,k){u(["moment/locale/bs"],g,k)})}],["ca",function(){return new Promise(function(g,k){u(["moment/locale/ca"],g,k)})}],["cs",function(){return new Promise(function(g,k){u(["moment/locale/cs"],g,k)})}],["da",function(){return new Promise(function(g,k){u(["moment/locale/da"],
g,k)})}],["de",function(){return new Promise(function(g,k){u(["moment/locale/de"],g,k)})}],["de-at",function(){return new Promise(function(g,k){u(["moment/locale/de-at"],g,k)})}],["de-ch",function(){return new Promise(function(g,k){u(["moment/locale/de-ch"],g,k)})}],["el",function(){return new Promise(function(g,k){u(["moment/locale/el"],g,k)})}],["en-au",function(){return new Promise(function(g,k){u(["moment/locale/en-au"],g,k)})}],["en-ca",function(){return new Promise(function(g,k){u(["moment/locale/en-ca"],
g,k)})}],["en-gb",function(){return new Promise(function(g,k){u(["moment/locale/en-gb"],g,k)})}],["en-ie",function(){return new Promise(function(g,k){u(["moment/locale/en-ie"],g,k)})}],["en-il",function(){return new Promise(function(g,k){u(["moment/locale/en-il"],g,k)})}],["en-nz",function(){return new Promise(function(g,k){u(["moment/locale/en-nz"],g,k)})}],["es",function(){return new Promise(function(g,k){u(["moment/locale/es"],g,k)})}],["es-do",function(){return new Promise(function(g,k){u(["moment/locale/es-do"],
g,k)})}],["es-us",function(){return new Promise(function(g,k){u(["moment/locale/es-us"],g,k)})}],["et",function(){return new Promise(function(g,k){u(["moment/locale/et"],g,k)})}],["fi",function(){return new Promise(function(g,k){u(["moment/locale/fi"],g,k)})}],["fr",function(){return new Promise(function(g,k){u(["moment/locale/fr"],g,k)})}],["fr-ca",function(){return new Promise(function(g,k){u(["moment/locale/fr-ca"],g,k)})}],["fr-ch",function(){return new Promise(function(g,k){u(["moment/locale/fr-ch"],
g,k)})}],["he",function(){return new Promise(function(g,k){u(["moment/locale/he"],g,k)})}],["hr",function(){return new Promise(function(g,k){u(["moment/locale/hr"],g,k)})}],["hu",function(){return new Promise(function(g,k){u(["moment/locale/hu"],g,k)})}],["id",function(){return new Promise(function(g,k){u(["moment/locale/id"],g,k)})}],["it",function(){return new Promise(function(g,k){u(["moment/locale/it"],g,k)})}],["it-ch",function(){return new Promise(function(g,k){u(["moment/locale/it-ch"],g,k)})}],
["ja",function(){return new Promise(function(g,k){u(["moment/locale/ja"],g,k)})}],["ko",function(){return new Promise(function(g,k){u(["moment/locale/ko"],g,k)})}],["lt",function(){return new Promise(function(g,k){u(["moment/locale/lt"],g,k)})}],["lv",function(){return new Promise(function(g,k){u(["moment/locale/lv"],g,k)})}],["nb",function(){return new Promise(function(g,k){u(["moment/locale/nb"],g,k)})}],["nl",function(){return new Promise(function(g,k){u(["moment/locale/nl"],g,k)})}],["nl-be",
function(){return new Promise(function(g,k){u(["moment/locale/nl-be"],g,k)})}],["pl",function(){return new Promise(function(g,k){u(["moment/locale/pl"],g,k)})}],["pt",function(){return new Promise(function(g,k){u(["moment/locale/pt"],g,k)})}],["pt-br",function(){return new Promise(function(g,k){u(["moment/locale/pt-br"],g,k)})}],["ro",function(){return new Promise(function(g,k){u(["moment/locale/ro"],g,k)})}],["ru",function(){return new Promise(function(g,k){u(["moment/locale/ru"],g,k)})}],["sl",
function(){return new Promise(function(g,k){u(["moment/locale/sl"],g,k)})}],["sr",function(){return new Promise(function(g,k){u(["moment/locale/sr"],g,k)})}],["sr-cyrl",function(){return new Promise(function(g,k){u(["moment/locale/sr-cyrl"],g,k)})}],["sv",function(){return new Promise(function(g,k){u(["moment/locale/sv"],g,k)})}],["th",function(){return new Promise(function(g,k){u(["moment/locale/th"],g,k)})}],["tr",function(){return new Promise(function(g,k){u(["moment/locale/tr"],g,k)})}],["uk",
function(){return new Promise(function(g,k){u(["moment/locale/uk"],g,k)})}],["vi",function(){return new Promise(function(g,k){u(["moment/locale/vi"],g,k)})}],["zh-cn",function(){return new Promise(function(g,k){u(["moment/locale/zh-cn"],g,k)})}],["zh-hk",function(){return new Promise(function(g,k){u(["moment/locale/zh-hk"],g,k)})}],["zh-tw",function(){return new Promise(function(g,k){u(["moment/locale/zh-tw"],g,k)})}]]);f.loadMoment=function(g){void 0===g&&(g=m.getLocale());return e.__awaiter(this,
void 0,void 0,function(){var k,l,c;return e.__generator(this,function(a){switch(a.label){case 0:return[4,new Promise(function(a,c){u(["moment/moment"],a,c)})];case 1:return k=a.sent(),l=d.has(g),l||(c=g.split("-"),1<c.length&&d.has(c[0])&&(g=c[0],l=!0)),l?[4,d.get(g)()]:[3,3];case 2:return a.sent(),[3,4];case 3:g="en",a.label=4;case 4:return g!==k.locale()&&k.locale(g),[2,k]}})})}})},"esri/widgets/FeatureForm/FeatureFormViewModel":function(){define("require exports tslib ../../intl ../../core/arrayUtils ../../core/Evented ../../core/HandleOwner ../../core/lang ../../core/Logger ../../core/ReentrantObjectPool ../../core/watchUtils ../../core/accessorSupport/decorators ../../core/accessorSupport/decorators/cast ../../form/FormTemplate ../../support/arcadeOnDemand ./FieldConfig ./FieldGroupConfig ./InputField ./InputFieldGroup ./support/formTemplateUtils".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A,E,H){function J(a){return!!a.fieldConfig}var B=l.getLogger("esri.widgets.FeatureForm.FeatureFormViewModel");return function(g){function d(a){a=g.call(this,a)||this;a._arcade=null;a._fieldPool=new c.ReentrantObjectPool(A);a._fieldGroupPool=new c.ReentrantObjectPool(E);a._featureClone=null;a._needsArcade=!1;a.messages=null;a.strict=!1;return a}e.__extends(d,g);d.prototype.initialize=function(){var b=this,c=function(){return e.__awaiter(b,void 0,void 0,function(){var a;
return e.__generator(this,function(b){switch(b.label){case 0:return a=this,[4,r.loadMessageBundle("esri/widgets/FeatureForm/t9n/FeatureForm")];case 1:return[2,a.messages=b.sent()]}})})};c();this.handles.add(r.onLocaleChange(c));var g=a.init(this,"fieldConfig",function(a){return e.__awaiter(b,void 0,void 0,function(){var b,c,q,d,k,x;return e.__generator(this,function(e){switch(e.label){case 0:return b=[],a&&a.forEach(function(a){b.push(a.visibilityExpression);a.fieldConfig?a.fieldConfig.forEach(function(a){b.push(a.visibilityExpression)}):
b.push(a.requiredExpression)}),c=b.filter(function(a){return!!a}),(q=0<c.length)?[4,t.loadArcade()]:[3,4];case 1:return d=e.sent(),k=d.arcadeUtils,(x=c.some(function(a){return k.hasGeometryOperations(a)}))?[4,k.enableGeometryOperations()]:[3,3];case 2:e.sent(),g.remove(),e.label=3;case 3:this._arcade=d,this.notifyChange("inputFields"),e.label=4;case 4:return this._needsArcade=q,[2]}})})});this.handles.add(g)};d.prototype.destroy=function(){this.layer=this.feature=this.fieldConfig=null;this._fieldPool.destroy();
this._fieldGroupPool.destroy()};Object.defineProperty(d.prototype,"_allInputFields",{get:function(){return this.inputFields.reduce(function(a,b){return b.inputFields?e.__spreadArrays(a,b.inputFields):e.__spreadArrays(a,[b])},[])},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"_inputFieldCache",{get:function(){var a=this,b=this._get("_inputFieldCache")||new Map;b.forEach(function(b){return a._disposeInputOrGroup(b)});b.clear();(this.get("layer.fields")||[]).forEach(function(c){return b.set(c,
a._fieldPool.acquire())});return b},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"_inputFieldGroupCache",{get:function(){var a=this,b=this._get("_inputFieldGroupCache")||new Map;b.forEach(function(b){return a._disposeInputOrGroup(b)});b.clear();(this.fieldConfig||[]).filter(J).forEach(function(c){return b.set(c,a._fieldGroupPool.acquire())});return b},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"description",{get:function(){var a;return null===(a=this.formTemplate)||
void 0===a?void 0:a.description},set:function(a){void 0===a?this._clearOverride("description"):this._override("description",a)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"feature",{get:function(){return this._get("feature")},set:function(a){this._featureClone=a?a.clone():null;this._set("feature",a)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"fieldConfig",{get:function(){var a=this.formTemplate;if(!a)return null;var b=H.fieldConfigsFromFormTemplate(a),
a=b.config,b=b.encounteredUnsupportedTypes;0<b.length&&B.warn("form-info::unsupported-type","encountered unsupported elements/types when parsing form info",b);return a},set:function(a){a?this._override("fieldConfig",a):this._clearOverride("fieldConfig")},enumerable:!0,configurable:!0});d.prototype.castFieldConfig=function(a){return a?a.map(function(a){return a instanceof x||a instanceof z?a:a.fieldConfig?new z(a):new x(a)}):null};Object.defineProperty(d.prototype,"formTemplate",{get:function(){var a;
return null===(a=this.layer)||void 0===a?void 0:a.formTemplate},set:function(a){void 0===a?this._clearOverride("formTemplate"):this._override("formTemplate",a)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"inputFields",{get:function(){var a=this,b=this._arcade,c=this._inputFieldCache,g=this._inputFieldGroupCache,q=this._featureClone,d=this.messages,k=this._needsArcade,t=this.layer,x=this.state,e=q&&q.clone();if("ready"!==x||k&&!b)return[];var l=this.get("layer.fields")||[],q=
this.fieldConfig||[];return(0!==q.length?q.map(function(q){if(q.fieldConfig){var k=g.get(q),x=q.fieldConfig.map(function(g){var q=m.find(l,function(a){return a.name===g.name}),x=c.get(q);x.set({arcade:b,field:q,config:g,feature:e,group:k,layer:t,messages:d,value:a.getValue(q.name)});return x}).filter(function(a){return a.visible});k.set({arcade:b,config:q,feature:e,inputFields:x});return k}var x=m.find(l,function(a){return a.name===q.name}),v=c.get(x);v.set({arcade:b,field:x,config:q,feature:e,group:null,
layer:t,messages:d,value:a.getValue(x.name)});return v}):l.map(function(g){var q=c.get(g);q.set({arcade:b,config:null,field:g,feature:e,group:null,layer:t,messages:d,value:a.getValue(g.name)});return q})).filter(function(a){return a.visible})},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"layer",{get:function(){return this.get("feature.layer")},set:function(a){a?this._override("layer",a):this._clearOverride("layer")},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"state",{get:function(){return this.messages&&this.get("layer.loaded")&&this.feature?"ready":"disabled"},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"title",{get:function(){var a;return null===(a=this.formTemplate)||void 0===a?void 0:a.title},set:function(a){void 0===a?this._clearOverride("title"):this._override("title",a)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"valid",{get:function(){var a=this._allInputFields;return 0<a.length&&a.every(function(a){return a.valid})},
enumerable:!0,configurable:!0});d.prototype.findField=function(a){return m.find(this._allInputFields,function(b){return b.name===a})};d.prototype.getValue=function(a){var b=this._featureClone;return b&&b.get("attributes."+a)};d.prototype.setValue=function(a,b){var c=this,g=this._featureClone,q=this.strict;if(g&&g.attributes){var d=this.findField(a);b=""===b?null:b;if(d&&g.attributes[a]!==b){d.value=b;if(this.get("layer.typeIdField")===d.name){var k=new Set;this.layer.types.forEach(function(a){return Object.keys(a.domains).forEach(function(a){return k.add(a)})});
k.forEach(function(a){(a=c.findField(a))&&a.notifyChange("domain")})}if(!q||d.valid)g.attributes[a]=b,this.notifyChange("inputFields"),this._emitChangeEvent(d)}}};d.prototype.getValues=function(){var a=this._featureClone;return a&&k.clone(a.attributes)||null};d.prototype.submit=function(){var a=this._allInputFields,b=a.filter(function(a){return a.valid}).map(function(a){return a.name}),a=a.filter(function(a){return!a.valid}).map(function(a){return a.name}),c=this.getValues();this.emit("submit",{valid:b,
invalid:a,values:c})};d.prototype._disposeInputOrGroup=function(a){a.inputFields?this._disposeGroup(a):this._disposeInput(a)};d.prototype._disposeGroup=function(a){var b=this;a.inputFields.forEach(function(a){return b._disposeInput(a)});this._fieldGroupPool.release(a)};d.prototype._disposeInput=function(a){this._fieldPool.release(a)};d.prototype._emitChangeEvent=function(a){this.emit("value-change",{layer:this.layer,feature:this.feature,fieldName:a.name,value:a.value,valid:a.valid})};e.__decorate([b.property({readOnly:!0,
dependsOn:["inputFields"]})],d.prototype,"_allInputFields",null);e.__decorate([b.property({dependsOn:["layer.fields"],readOnly:!0})],d.prototype,"_inputFieldCache",null);e.__decorate([b.property({dependsOn:["fieldConfig"],readOnly:!0})],d.prototype,"_inputFieldGroupCache",null);e.__decorate([b.property({dependsOn:["formTemplate"]})],d.prototype,"description",null);e.__decorate([b.property()],d.prototype,"feature",null);e.__decorate([b.property({dependsOn:["formTemplate"]})],d.prototype,"fieldConfig",
null);e.__decorate([q.cast("fieldConfig")],d.prototype,"castFieldConfig",null);e.__decorate([b.property({dependsOn:["layer?.formTemplate"],type:v})],d.prototype,"formTemplate",null);e.__decorate([b.property({readOnly:!0,dependsOn:["messages","feature","fieldConfig","layer.fields","layer.loaded"]})],d.prototype,"inputFields",null);e.__decorate([b.property({dependsOn:["feature.layer"]})],d.prototype,"layer",null);e.__decorate([b.property()],d.prototype,"messages",void 0);e.__decorate([b.property({dependsOn:["messages",
"layer.loaded","feature"]})],d.prototype,"state",null);e.__decorate([b.property()],d.prototype,"strict",void 0);e.__decorate([b.property({dependsOn:["formTemplate"]})],d.prototype,"title",null);e.__decorate([b.property({dependsOn:["_allInputFields"]})],d.prototype,"valid",null);e.__decorate([b.property()],d.prototype,"getValues",null);e.__decorate([b.property()],d.prototype,"submit",null);return d=e.__decorate([b.subclass("esri.widgets.FeatureForm.FeatureFormViewModel")],d)}(g.HandleOwnerMixin(d.EventedAccessor))})},
"esri/widgets/FeatureForm/FieldConfig":function(){define("require exports tslib ../../core/Accessor ../../core/accessorSupport/decorators ./Format".split(" "),function(u,f,e,r,m,d){return function(g){function k(d){d=g.call(this,d)||this;d.description=null;d.domain=null;d.editable=!0;d.editorType=null;d.format=null;d.hint=null;d.label=null;d.maxLength=-1;d.minLength=-1;d.name=null;d.required=!1;d.requiredExpression=null;d.visibilityExpression=null;return d}e.__extends(k,g);e.__decorate([m.property()],
k.prototype,"description",void 0);e.__decorate([m.property()],k.prototype,"domain",void 0);e.__decorate([m.property()],k.prototype,"editable",void 0);e.__decorate([m.property()],k.prototype,"editorType",void 0);e.__decorate([m.property({type:d})],k.prototype,"format",void 0);e.__decorate([m.property()],k.prototype,"hint",void 0);e.__decorate([m.property()],k.prototype,"label",void 0);e.__decorate([m.property()],k.prototype,"maxLength",void 0);e.__decorate([m.property()],k.prototype,"minLength",void 0);
e.__decorate([m.property()],k.prototype,"name",void 0);e.__decorate([m.property()],k.prototype,"required",void 0);e.__decorate([m.property()],k.prototype,"requiredExpression",void 0);e.__decorate([m.property()],k.prototype,"visibilityExpression",void 0);return k=e.__decorate([m.subclass("esri.widgets.FeatureForm.FieldConfig")],k)}(r)})},"esri/widgets/FeatureForm/Format":function(){define("require exports tslib ../../core/date ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),
function(u,f,e,r,m,d){return function(g){function k(d){d=g.call(this,d)||this;d.digitSeparator=!1;d.format=null;d.places=null;return d}e.__extends(k,g);e.__decorate([d.property()],k.prototype,"digitSeparator",void 0);e.__decorate([d.property({json:{read:{source:"dateFormat",reader:r.fromJSON}}})],k.prototype,"format",void 0);e.__decorate([d.property()],k.prototype,"places",void 0);return k=e.__decorate([d.subclass("esri.widgets.FeatureForm.Format")],k)}(m.JSONSupport)})},"esri/widgets/FeatureForm/FieldGroupConfig":function(){define("require exports tslib ../../core/Accessor ../../core/accessorSupport/decorators ../../core/accessorSupport/decorators/cast ./FieldConfig".split(" "),
function(u,f,e,r,m,d,g){return function(k){function l(c){c=k.call(this,c)||this;c.description=null;c.fieldConfig=null;c.label=null;c.state="expanded";c.visibilityExpression=null;return c}e.__extends(l,k);l.prototype.castFieldConfig=function(c){return c?c.map(function(a){return a.declaredClass?a:new g(a)}):null};e.__decorate([m.property()],l.prototype,"description",void 0);e.__decorate([m.property()],l.prototype,"fieldConfig",void 0);e.__decorate([d.cast("fieldConfig")],l.prototype,"castFieldConfig",
null);e.__decorate([m.property()],l.prototype,"label",void 0);e.__decorate([m.property()],l.prototype,"state",void 0);e.__decorate([m.property()],l.prototype,"visibilityExpression",void 0);return l=e.__decorate([m.subclass("esri.widgets.FeatureForm.FieldGroupConfig")],l)}(r)})},"esri/widgets/FeatureForm/InputField":function(){define("require exports tslib ../../intl ../../core/Accessor ../../core/accessorSupport/decorators ../../layers/support/CodedValueDomain ../../layers/support/domains ../../layers/support/fieldUtils".split(" "),
function(u,f,e,r,m,d,g,k,l){var c={type:"number"},a={type:"number",intlOptions:{notation:"scientific"}},b={type:"date",intlOptions:{day:"2-digit",month:"2-digit",year:"2-digit",hour:"numeric",minute:"numeric",second:"numeric"}};return function(q){function v(a){a=q.call(this,a)||this;a.arcade=null;a.config=null;a.feature=null;a.field=null;a.layer=null;a.description=null;a.editorType=null;a.error=null;a.format=null;a.group=null;a.hint=null;a.messages=null;a.name=null;return a}e.__extends(v,q);Object.defineProperty(v.prototype,
"compiledFunc",{get:function(){var a,b=this.arcade;return b&&b.arcadeUtils.createFunction(null===(a=this.config)||void 0===a?void 0:a.visibilityExpression)},enumerable:!0,configurable:!0});Object.defineProperty(v.prototype,"compiledRequiredFunc",{get:function(){var a,b=this.arcade;return b&&b.arcadeUtils.createFunction(null===(a=this.config)||void 0===a?void 0:a.requiredExpression)},enumerable:!0,configurable:!0});Object.defineProperty(v.prototype,"evaluatedRequirement",{get:function(){var a=this.compiledRequiredFunc;
if(!a)return null;var b=this.arcade;return b.arcadeUtils.executeFunction(a,b.arcadeUtils.createExecContext(this.feature))},enumerable:!0,configurable:!0});Object.defineProperty(v.prototype,"evaluatedVisibility",{get:function(){var a=this.compiledFunc;if(!a)return null;var b=this.arcade;return b.arcadeUtils.executeFunction(a,b.arcadeUtils.createExecContext(this.feature))},enumerable:!0,configurable:!0});Object.defineProperty(v.prototype,"domain",{get:function(){var a,b,c=this.layer.typeIdField,q=c===
this.name,d=null===(a=this.field)||void 0===a?void 0:a.domain;if(q&&!d)return new g({name:"__internal-type-based-coded-value-domain__",codedValues:this.layer.types.map(function(a){return{code:a.id,name:a.name}})});a=this.feature;c=c&&this.layer.getFieldDomain(this.name,{feature:a})||d;d=null===(b=this.config)||void 0===b?void 0:b.domain;return this._isDomainCompatible(d)?d:c},enumerable:!0,configurable:!0});Object.defineProperty(v.prototype,"editable",{get:function(){var a;return this.layer.capabilities.operations.supportsEditing&&
this.field.editable&&!1!==(null===(a=this.config)||void 0===a?void 0:a.editable)},enumerable:!0,configurable:!0});Object.defineProperty(v.prototype,"errorMessage",{get:function(){return this._toErrorMessage()},enumerable:!0,configurable:!0});Object.defineProperty(v.prototype,"label",{get:function(){var a;return(null===(a=this.config)||void 0===a?void 0:a.label)||this.field.alias||this.field.name},enumerable:!0,configurable:!0});Object.defineProperty(v.prototype,"maxLength",{get:function(){var a,b;
if("date"===this.type)return-1;var c=null===(a=this.field)||void 0===a?void 0:a.length;a=null===(b=this.config)||void 0===b?void 0:b.maxLength;return!isNaN(a)&&-1<=a&&(-1===c||a<=c)?a:c},enumerable:!0,configurable:!0});Object.defineProperty(v.prototype,"minLength",{get:function(){var a,b;if("date"===this.type)return-1;var c=null===(a=this.field)||void 0===a?void 0:a.length;a=null===(b=this.config)||void 0===b?void 0:b.minLength;return!isNaN(a)&&-1<=a&&(-1===c||a<=c)?a:-1},enumerable:!0,configurable:!0});
Object.defineProperty(v.prototype,"required",{get:function(){var a,b;return this.editable?null!==(a=this.field)&&void 0!==a&&a.nullable?"boolean"===typeof this.evaluatedRequirement?this.evaluatedRequirement:!0===(null===(b=this.config)||void 0===b?void 0:b.required):!0:!1},enumerable:!0,configurable:!0});Object.defineProperty(v.prototype,"type",{get:function(){var a=this.field;return l.isNumericField(a)?"number":l.isStringField(a)?"text":l.isDateField(a)?"date":"unsupported"},enumerable:!0,configurable:!0});
Object.defineProperty(v.prototype,"valid",{get:function(){var a=this.editable?this._validate():null;this._set("error",a);return null===a},enumerable:!0,configurable:!0});Object.defineProperty(v.prototype,"value",{get:function(){return this._get("value")},set:function(a){this.notifyChange("evaluatedVisibility");this._set("value",a)},enumerable:!0,configurable:!0});Object.defineProperty(v.prototype,"visible",{get:function(){return this._isEditorField()?!1:"boolean"===typeof this.evaluatedVisibility?
this.evaluatedVisibility:!!this.config||this._shownByDefault()},enumerable:!0,configurable:!0});v.prototype._isDomainCompatible=function(a){var b=this.field;if(a&&"coded-value"===a.type){var c=typeof a.codedValues[0].code;if("string"===c&&l.isStringField(b)||"number"===c&&l.isNumericField(b))return!0}return a&&"range"===a.type&&l.isNumericField(b)?!0:!1};v.prototype._validate=function(){var a=this.domain,b=this.field,c=this.minLength,g=this.required,q=this.value;return"text"===this.type&&-1<c&&"string"===
typeof q&&q.length<c?"length-validation-error::too-short":a?null!==q||g?k.validateDomainValue(a,q):null:l.validateFieldValue(b,q)};v.prototype._shownByDefault=function(){var a,b=null===(a=this.field)||void 0===a?void 0:a.type;return"oid"!==b&&"global-id"!==b&&!this._isGeometryField()};v.prototype._isEditorField=function(){return-1<l.getFeatureEditFields(this.layer).indexOf(this.name)};v.prototype._isGeometryField=function(){return-1<l.getFeatureGeometryFields(this.layer).indexOf(this.name)};v.prototype._toErrorMessage=
function(){var g=this.domain,q=this.field,d=this.messages,e=this.minLength,v=this.value,f=this.type,m=this.error;return this.required&&null===v?d.validationErrors.cannotBeNull:m===k.DomainValidationError.VALUE_OUT_OF_RANGE||m===l.NumericRangeValidationError.OUT_OF_RANGE?(g=k.getDomainRange(g)||l.getFieldRange(q),r.substitute(d.validationErrors.outsideRange,g,{format:{max:"date"===f?b:g.isInteger?c:a,min:"date"===f?b:g.isInteger?c:a}})):m===k.DomainValidationError.INVALID_CODED_VALUE?d.validationErrors.invalidCodedValue:
m===l.TypeValidationError.INVALID_TYPE?d.validationErrors.invalidType:"length-validation-error::too-short"===m?r.substitute(d.validationErrors.tooShort,{min:e}):null};e.__decorate([d.property()],v.prototype,"arcade",void 0);e.__decorate([d.property({dependsOn:["arcade","config.visibilityExpression"]})],v.prototype,"compiledFunc",null);e.__decorate([d.property({dependsOn:["arcade","config.requiredExpression"]})],v.prototype,"compiledRequiredFunc",null);e.__decorate([d.property()],v.prototype,"config",
void 0);e.__decorate([d.property({dependsOn:["compiledRequiredFunc","feature"]})],v.prototype,"evaluatedRequirement",null);e.__decorate([d.property({dependsOn:["compiledFunc","feature"]})],v.prototype,"evaluatedVisibility",null);e.__decorate([d.property()],v.prototype,"feature",void 0);e.__decorate([d.property()],v.prototype,"field",void 0);e.__decorate([d.property()],v.prototype,"layer",void 0);e.__decorate([d.property({aliasOf:"config.description"})],v.prototype,"description",void 0);e.__decorate([d.property({dependsOn:["config",
"feature","field","layer"]})],v.prototype,"domain",null);e.__decorate([d.property({dependsOn:["config","field","layer"]})],v.prototype,"editable",null);e.__decorate([d.property({aliasOf:"config.editorType"})],v.prototype,"editorType",void 0);e.__decorate([d.property({readOnly:!0})],v.prototype,"error",void 0);e.__decorate([d.property({dependsOn:["error","messages","value"]})],v.prototype,"errorMessage",null);e.__decorate([d.property({aliasOf:"config.format"})],v.prototype,"format",void 0);e.__decorate([d.property()],
v.prototype,"group",void 0);e.__decorate([d.property({aliasOf:"config.hint"})],v.prototype,"hint",void 0);e.__decorate([d.property({dependsOn:["field","config"]})],v.prototype,"label",null);e.__decorate([d.property({dependsOn:["field.length","config"]})],v.prototype,"maxLength",null);e.__decorate([d.property({dependsOn:["field.length","config"]})],v.prototype,"minLength",null);e.__decorate([d.property()],v.prototype,"messages",void 0);e.__decorate([d.property({aliasOf:"field.name"})],v.prototype,
"name",void 0);e.__decorate([d.property({dependsOn:["config","evaluatedRequirement","field"]})],v.prototype,"required",null);e.__decorate([d.property({dependsOn:["field"]})],v.prototype,"type",null);e.__decorate([d.property({dependsOn:["config","domain","field","layer","value"]})],v.prototype,"valid",null);e.__decorate([d.property({value:null})],v.prototype,"value",null);e.__decorate([d.property({dependsOn:["config","evaluatedVisibility","field","layer"]})],v.prototype,"visible",null);return v=e.__decorate([d.subclass("esri.widgets.FeatureForm.InputField")],
v)}(m)})},"esri/widgets/FeatureForm/InputFieldGroup":function(){define("require exports tslib ../../core/Accessor ../../core/HandleOwner ../../core/accessorSupport/decorators".split(" "),function(u,f,e,r,m,d){return function(g){function k(d){d=g.call(this,d)||this;d.arcade=null;d.config=null;d.description=null;d.feature=null;d.label=null;d.state="expanded";d.visibilityExpression=null;return d}e.__extends(k,g);Object.defineProperty(k.prototype,"compiledFunc",{get:function(){var g=this.arcade;return g&&
g.arcadeUtils.createFunction(this.visibilityExpression)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"evaluatedVisibility",{get:function(){var g=this.compiledFunc;if(g){var c=this.arcade;return c.arcadeUtils.executeFunction(g,c.arcadeUtils.createExecContext(this.feature))}},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"inputFields",{get:function(){return this._get("inputFields")},set:function(g){var c=this;this.handles.removeAll();g&&this.handles.add(g.map(function(a){return a.watch("visible",
c._dirtyEvaluatedVisibility)}));this._set("inputFields",g)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"visible",{get:function(){return!1!==this.evaluatedVisibility&&this.inputFields&&this.inputFields.some(function(g){return g.visible})},enumerable:!0,configurable:!0});k.prototype._dirtyEvaluatedVisibility=function(){this.visibilityExpression&&this.notifyChange("evaluatedVisibility")};e.__decorate([d.property()],k.prototype,"arcade",void 0);e.__decorate([d.property({dependsOn:["arcade",
"visibilityExpression"]})],k.prototype,"compiledFunc",null);e.__decorate([d.property()],k.prototype,"config",void 0);e.__decorate([d.property({dependsOn:["compiledFunc","feature"]})],k.prototype,"evaluatedVisibility",null);e.__decorate([d.property({aliasOf:"config.description"})],k.prototype,"description",void 0);e.__decorate([d.property()],k.prototype,"feature",void 0);e.__decorate([d.property()],k.prototype,"inputFields",null);e.__decorate([d.property({aliasOf:"config.label"})],k.prototype,"label",
void 0);e.__decorate([d.property()],k.prototype,"state",void 0);e.__decorate([d.property({aliasOf:"config.visibilityExpression"})],k.prototype,"visibilityExpression",void 0);e.__decorate([d.property({dependsOn:["evaluatedVisibility","inputFields"]})],k.prototype,"visible",null);return k=e.__decorate([d.subclass("esri.widgets.FeatureForm.InputFieldGroup")],k)}(m.HandleOwnerMixin(r))})},"esri/widgets/FeatureForm/support/formTemplateUtils":function(){define(["require","exports","../FieldConfig","../FieldGroupConfig"],
function(u,f,e,r){function m(d,g,k,l){void 0===l&&(l=!0);return d.map(function(c){if("field"===c.type){var a=c.input;c=new e({description:c.description,domain:c.domain,editable:c.editable,hint:c.hint,label:c.label,name:c.fieldName,requiredExpression:g[c.requiredExpression]||null,visibilityExpression:g[c.visibilityExpression]||null});a&&("text-area"===a.type||"text-box"===a.type?(c.editorType=a.type,c.minLength=a.minLength,c.maxLength=a.maxLength):k.push({type:"unsupported-input-type",details:a}));
return c}if("group"===c.type){if(!l)return k.push({type:"nested-group",details:c}),null;a=g[c.visibilityExpression]||null;return new r({description:c.description,state:c.initialState,fieldConfig:m(c.elements,g,k,!1),label:c.label,visibilityExpression:a})}k.push({type:"unsupported-element-type",details:c});return null}).filter(function(c){return!!c})}Object.defineProperty(f,"__esModule",{value:!0});f.fieldConfigsFromFormTemplate=function(d){var g,k={},e=[];null===(g=d.expressionInfos)||void 0===g?
void 0:g.map(function(c){return k[c.name]=c.expression});return{config:m(d.elements,k,e),encounteredUnsupportedTypes:e}}})},"esri/widgets/FeatureTemplates":function(){define("require exports tslib @dojo/framework/shim/IntersectionObserver ../core/deprecate ../core/HandleOwner ../core/Logger ../core/watchUtils ../core/accessorSupport/decorators ./Widget ./FeatureTemplates/FeatureTemplatesViewModel ./FeatureTemplates/ItemList ./support/widget".split(" "),function(u,f,e,r,m,d,g,k,l,c,a,b,q){function v(a){return a.items?
a.uid:a.layer.id}var t=g.getLogger("esri.widgets.FeatureTemplates"),x={filter:!0};return function(c){function g(b,g){b=c.call(this,b,g)||this;b._iconIntersectionObserver=new r.default(function(a,b){a.forEach(function(a){if(a.isIntersecting){var c=a.target;if(!c["data-has-icon"]){c["data-has-icon"]=!0;var g=c["data-item"];g.fetchThumbnail().then(function(){g.thumbnail&&c.appendChild(g.thumbnail)})}b.unobserve(c)}})});b.filterFunction=null;b.filterText="";b.groupBy=null;b.label=void 0;b.layers=null;
b.messages=null;b.viewModel=new a;b.visibleElements=e.__assign({},x);b.renderItemIcon=b.renderItemIcon.bind(b);b._afterItemCreateOrUpdate=b._afterItemCreateOrUpdate.bind(b);b._afterItemRemoved=b._afterItemRemoved.bind(b);return b}e.__extends(g,c);g.prototype.initialize=function(){var a=this,b=function(b){b=b.label;return!a.filterText||-1<b.toLowerCase().indexOf(a.filterText.toLowerCase())};this.own(k.init(this,"viewModel",function(c,g){c&&!c.filterFunction&&(a.filterFunction=b);g&&g!==c&&g.filterFunction===
b&&(g.filterFunction=null)}))};g.prototype.destroy=function(){this._iconIntersectionObserver&&(this._iconIntersectionObserver.disconnect(),this._iconIntersectionObserver=null)};Object.defineProperty(g.prototype,"filterEnabled",{set:function(a){m.deprecatedProperty(t,"filterEnabled",{replacement:"visibleElements.filter",version:"4.15"});this.visibleElements=e.__assign(e.__assign({},this.visibleElements),{filter:a})},enumerable:!0,configurable:!0});g.prototype.castVisibleElements=function(a){return e.__assign(e.__assign({},
x),a)};g.prototype.render=function(){var a=this,c=this.filterText,g=this.messages,d=this.viewModel,k=d.items,d=d.state,t=this.visibleElements.filter;return q.tsx("div",{class:this.classes("esri-feature-templates","esri-widget"),"aria-label":g.widgetLabel},"loading"===d?this.renderLoader():"ready"===d?b.ItemList({id:this.id,identify:v,filterText:c,items:k,messages:{filterPlaceholder:g.filterPlaceholder,noItems:g.noItems,noMatches:g.noMatches},filterEnabled:t,onItemSelect:function(b){a.viewModel.select(b)},
onFilterChange:function(b){a.filterText=b;a.viewModel.refresh()},renderIcon:this.renderItemIcon}):null)};g.prototype.renderItemIcon=function(a){return q.tsx("span",{key:"icon",class:"esri-feature-templates__list-item-icon",afterCreate:this._afterItemCreateOrUpdate,afterUpdate:this._afterItemCreateOrUpdate,afterRemoved:this._afterItemRemoved,"data-item":a.item,"data-has-icon":!1})};g.prototype.renderLoader=function(){return q.tsx("div",{class:"esri-feature-templates__loader",key:"loader"})};g.prototype._afterItemCreateOrUpdate=
function(a){this._iconIntersectionObserver.observe(a)};g.prototype._afterItemRemoved=function(a){this._iconIntersectionObserver.unobserve(a)};e.__decorate([l.property(),q.renderable()],g.prototype,"filterEnabled",null);e.__decorate([l.aliasOf("viewModel.filterFunction")],g.prototype,"filterFunction",void 0);e.__decorate([l.property(),q.renderable()],g.prototype,"filterText",void 0);e.__decorate([l.aliasOf("viewModel.groupBy")],g.prototype,"groupBy",void 0);e.__decorate([l.property({aliasOf:{source:"messages.widgetLabel",
overridable:!0}})],g.prototype,"label",void 0);e.__decorate([l.aliasOf("viewModel.layers")],g.prototype,"layers",void 0);e.__decorate([l.property(),q.renderable(),q.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],g.prototype,"messages",void 0);e.__decorate([l.property(),q.renderable(["viewModel.items","viewModel.state"]),q.vmEvent("select")],g.prototype,"viewModel",void 0);e.__decorate([l.property(),q.renderable()],g.prototype,"visibleElements",void 0);e.__decorate([l.cast("visibleElements")],
g.prototype,"castVisibleElements",null);return g=e.__decorate([l.subclass("esri.widgets.FeatureTemplates")],g)}(d.HandleOwnerMixin(c))})},"@dojo/framework/shim/IntersectionObserver":function(){(function(u){"object"===typeof module&&"object"===typeof module.exports?(u=u(require,exports),void 0!==u&&(module.exports=u)):"function"===typeof define&&define.amd&&define(["require","exports","./global","intersection-observer"],u)})(function(u,f){Object.defineProperty(f,"__esModule",{value:!0});var e=u("./global");
"!has('build-elide')";u("intersection-observer");f.default=e.default.IntersectionObserver})},"intersection-observer/intersection-observer":function(){define(["dojo","dijit","dojox"],function(u,f,e){(function(e,f){function d(a){this.time=a.time;this.target=a.target;this.rootBounds=a.rootBounds;this.boundingClientRect=a.boundingClientRect;this.intersectionRect=a.intersectionRect||b();this.isIntersecting=!!a.intersectionRect;a=this.boundingClientRect;a=a.width*a.height;var c=this.intersectionRect,c=
c.width*c.height;this.intersectionRatio=a?Number((c/a).toFixed(4)):this.isIntersecting?1:0}function g(a,b){b=b||{};if("function"!=typeof a)throw Error("callback must be a function");if(b.root&&1!=b.root.nodeType)throw Error("root must be an Element");this._checkForIntersections=k(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT);this._callback=a;this._observationTargets=[];this._queuedEntries=[];this._rootMarginValues=this._parseRootMargin(b.rootMargin);this.thresholds=this._initThresholds(b.threshold);
this.root=b.root||null;this.rootMargin=this._rootMarginValues.map(function(a){return a.value+a.unit}).join(" ")}function k(a,b){var c=null;return function(){c||(c=setTimeout(function(){a();c=null},b))}}function l(a,b,c,g){"function"==typeof a.addEventListener?a.addEventListener(b,c,g||!1):"function"==typeof a.attachEvent&&a.attachEvent("on"+b,c)}function c(a,b,c,g){"function"==typeof a.removeEventListener?a.removeEventListener(b,c,g||!1):"function"==typeof a.detatchEvent&&a.detatchEvent("on"+b,c)}
function a(a){var c;try{c=a.getBoundingClientRect()}catch(A){}if(!c)return b();c.width&&c.height||(c={top:c.top,right:c.right,bottom:c.bottom,left:c.left,width:c.right-c.left,height:c.bottom-c.top});return c}function b(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function q(a,b){for(;b;){if(b==a)return!0;b=v(b)}return!1}function v(a){return(a=a.parentNode)&&11==a.nodeType&&a.host?a.host:a}if("IntersectionObserver"in e&&"IntersectionObserverEntry"in e&&"intersectionRatio"in e.IntersectionObserverEntry.prototype)"isIntersecting"in
e.IntersectionObserverEntry.prototype||Object.defineProperty(e.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return 0<this.intersectionRatio}});else{var t=[];g.prototype.THROTTLE_TIMEOUT=100;g.prototype.POLL_INTERVAL=null;g.prototype.USE_MUTATION_OBSERVER=!0;g.prototype.observe=function(a){if(!this._observationTargets.some(function(b){return b.element==a})){if(!a||1!=a.nodeType)throw Error("target must be an Element");this._registerInstance();this._observationTargets.push({element:a,
entry:null});this._monitorIntersections();this._checkForIntersections()}};g.prototype.unobserve=function(a){this._observationTargets=this._observationTargets.filter(function(b){return b.element!=a});this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())};g.prototype.disconnect=function(){this._observationTargets=[];this._unmonitorIntersections();this._unregisterInstance()};g.prototype.takeRecords=function(){var a=this._queuedEntries.slice();this._queuedEntries=
[];return a};g.prototype._initThresholds=function(a){a=a||[0];Array.isArray(a)||(a=[a]);return a.sort().filter(function(a,b,c){if("number"!=typeof a||isNaN(a)||0>a||1<a)throw Error("threshold must be a number between 0 and 1 inclusively");return a!==c[b-1]})};g.prototype._parseRootMargin=function(a){a=(a||"0px").split(/\s+/).map(function(a){a=/^(-?\d*\.?\d+)(px|%)$/.exec(a);if(!a)throw Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(a[1]),unit:a[2]}});a[1]=a[1]||
a[0];a[2]=a[2]||a[0];a[3]=a[3]||a[1];return a};g.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(l(e,"resize",this._checkForIntersections,!0),l(f,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in e&&(this._domObserver=new MutationObserver(this._checkForIntersections),this._domObserver.observe(f,
{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))};g.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,c(e,"resize",this._checkForIntersections,!0),c(f,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))};g.prototype._checkForIntersections=function(){var c=this._rootIsInDom(),g=c?this._getRootRect():
b();this._observationTargets.forEach(function(b){var q=b.element,k=a(q),t=this._rootContainsTarget(q),x=b.entry,v=c&&t&&this._computeTargetAndRootIntersection(q,g);b=b.entry=new d({time:e.performance&&performance.now&&performance.now(),target:q,boundingClientRect:k,rootBounds:g,intersectionRect:v});x?c&&t?this._hasCrossedThreshold(x,b)&&this._queuedEntries.push(b):x&&x.isIntersecting&&this._queuedEntries.push(b):this._queuedEntries.push(b)},this);this._queuedEntries.length&&this._callback(this.takeRecords(),
this)};g.prototype._computeTargetAndRootIntersection=function(b,c){if("none"!=e.getComputedStyle(b).display){var g=a(b);b=v(b);for(var d=!1;!d;){var q=null,k=1==b.nodeType?e.getComputedStyle(b):{};if("none"==k.display)return;b==this.root||b==f?(d=!0,q=c):b!=f.body&&b!=f.documentElement&&"visible"!=k.overflow&&(q=a(b));if(q){var k=Math.max(q.top,g.top),t=Math.min(q.bottom,g.bottom),x=Math.max(q.left,g.left),g=Math.min(q.right,g.right),q=g-x,l=t-k,g=0<=q&&0<=l&&{top:k,bottom:t,left:x,right:g,width:q,
height:l};if(!g)break}b=v(b)}return g}};g.prototype._getRootRect=function(){var b;if(this.root)b=a(this.root);else{b=f.documentElement;var c=f.body;b={top:0,left:0,right:b.clientWidth||c.clientWidth,width:b.clientWidth||c.clientWidth,bottom:b.clientHeight||c.clientHeight,height:b.clientHeight||c.clientHeight}}return this._expandRectByRootMargin(b)};g.prototype._expandRectByRootMargin=function(a){var b=this._rootMarginValues.map(function(b,c){return"px"==b.unit?b.value:b.value*(c%2?a.width:a.height)/
100}),b={top:a.top-b[0],right:a.right+b[1],bottom:a.bottom+b[2],left:a.left-b[3]};b.width=b.right-b.left;b.height=b.bottom-b.top;return b};g.prototype._hasCrossedThreshold=function(a,b){a=a&&a.isIntersecting?a.intersectionRatio||0:-1;b=b.isIntersecting?b.intersectionRatio||0:-1;if(a!==b)for(var c=0;c<this.thresholds.length;c++){var g=this.thresholds[c];if(g==a||g==b||g<a!==g<b)return!0}};g.prototype._rootIsInDom=function(){return!this.root||q(f,this.root)};g.prototype._rootContainsTarget=function(a){return q(this.root||
f,a)};g.prototype._registerInstance=function(){0>t.indexOf(this)&&t.push(this)};g.prototype._unregisterInstance=function(){var a=t.indexOf(this);-1!=a&&t.splice(a,1)};e.IntersectionObserver=g;e.IntersectionObserverEntry=d}})(window,document)})},"dojo/main":function(){define("./_base/kernel ./has require ./sniff ./_base/lang ./_base/array ./_base/config ./ready ./_base/declare ./_base/connect ./_base/Deferred ./_base/json ./_base/Color require ./has!host-browser?./_base/browser require".split(" "),
function(u,f,e,r,m,d,g,k){g.isDebug&&e(["./_firebug/firebug"]);return u})},"dojo/_base/kernel":function(){define(["../global","../has","./config","require","module"],function(u,f,e,r,m){var d,g={},k={},l={config:e,global:u,dijit:g,dojox:k},g={dojo:["dojo",l],dijit:["dijit",g],dojox:["dojox",k]};m=r.map&&r.map[m.id.match(/[^\/]+/)[0]];for(d in m)g[d]?g[d][0]=m[d]:g[d]=[m[d],{}];for(d in g)m=g[d],m[1]._scopeName=m[0],e.noGlobals||(u[m[0]]=m[1]);l.scopeMap=g;l.baseUrl=l.config.baseUrl=r.baseUrl;l.isAsync=
r.async;l.locale=e.locale;u="$Rev: d6e8ff38 $".match(/[0-9a-f]{7,}/);l.version={major:1,minor:14,patch:2,flag:"",revision:u?u[0]:NaN,toString:function(){var a=l.version;return a.major+"."+a.minor+"."+a.patch+a.flag+" ("+a.revision+")"}};f("csp-restrictions")||Function("d","d.eval \x3d function(){return d.global.eval ? d.global.eval(arguments[0]) : eval(arguments[0]);}")(l);l.exit=function(){};f("host-webworker");"undefined"!=typeof console||(console={});u="assert count debug dir dirxml error group groupEnd info profile profileEnd time timeEnd trace warn log".split(" ");
var c;for(f=0;c=u[f++];)console[c]?console[c]=Function.prototype.bind.call(console[c],console):function(){var a=c+"";console[a]="log"in console?function(){var b=Array.prototype.slice.call(arguments);b.unshift(a+":");console.log(b.join(" "))}:function(){};console[a]._fake=!0}();l.deprecated=l.experimental=function(){};l._hasResource={};return l})},"dojo/global":function(){define(function(){return"undefined"!==typeof global&&"function"!==typeof global?global:"undefined"!==typeof window?window:"undefined"!==
typeof self?self:this})},"dojo/has":function(){define(["./global","require","module"],function(u,f,e){var r=f.has||function(){};if(!r("dojo-has-api")){var m=(f="undefined"!=typeof window&&"undefined"!=typeof location&&"undefined"!=typeof document&&window.location==location&&window.document==document)&&document,d=m&&m.createElement("DiV"),g=e.config&&e.config()||{},r=function(k){return"function"==typeof g[k]?g[k]=g[k](u,m,d):g[k]};r.cache=g;r.add=function(d,e,c,a){("undefined"==typeof g[d]||a)&&(g[d]=
e);return c&&r(d)};r.add("host-browser",f);r.add("dom",f)}r("host-browser")&&(r.add("touch","ontouchstart"in document||"onpointerdown"in document&&0<navigator.maxTouchPoints||window.navigator.msMaxTouchPoints),r.add("touch-events","ontouchstart"in document),r.add("pointer-events","pointerEnabled"in window.navigator?window.navigator.pointerEnabled:"PointerEvent"in window),r.add("device-width",screen.availWidth||innerWidth),e=document.createElement("form"),r.add("dom-attributes-specified-flag",0<e.attributes.length&&
40>e.attributes.length));r.clearElement=function(g){g.innerHTML="";return g};r.normalize=function(g,d){var c=g.match(/[\?:]|[^:\?]*/g),a=0,b=function(g){var d=c[a++];if(":"==d)return 0;if("?"==c[a++]){if(!g&&r(d))return b();b(!0);return b(g)}return d||0};return(g=b())&&d(g)};r.load=function(g,d,c){g?d([g],c):c()};return r})},"dojo/_base/config":function(){define(["../global","../has","require"],function(u,f,e){u={};e=e.rawConfig;for(var r in e)u[r]=e[r];!u.locale&&"undefined"!=typeof navigator&&(r=
navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language||navigator.userLanguage)&&(u.locale=r.toLowerCase());return u})},"dojo/sniff":function(){define(["./has"],function(u){if(u("host-browser")){var f=navigator,e=f.userAgent,f=f.appVersion,r=parseFloat(f);u.add("edge",parseFloat(e.split("Edge/")[1])||void 0);u.add("webkit",!u("edge")&&parseFloat(e.split("WebKit/")[1])||void 0);u.add("chrome",!u("edge")&&!0&&parseFloat(e.split("Chrome/")[1])||void 0);u.add("safari",
0<=f.indexOf("Safari")&&!u("chrome")&&!u("edge")?parseFloat(f.split("Version/")[1]):void 0);u.add("mac",0<=f.indexOf("Macintosh"));if(e.match(/(iPhone|iPod|iPad)/)){var m=RegExp.$1.replace(/P/,"p"),d=e.match(/OS ([\d_]+)/)?RegExp.$1:"1",d=parseFloat(d.replace(/_/,".").replace(/_/g,""));u.add(m,d);u.add("ios",d)}u.add("trident",parseFloat(f.split("Trident/")[1])||void 0);u("webkit")||(0<=e.indexOf("Opera")&&u.add("opera",9.8<=r?parseFloat(e.split("Version/")[1])||r:r),0<=e.indexOf("Gecko")&&!u("trident")&&
!u("edge")&&u.add("mozilla",r),u("mozilla")&&u.add("ff",parseFloat(e.split("Firefox/")[1]||e.split("Minefield/")[1])||void 0),document.all&&!u("opera")&&(e=parseFloat(f.split("MSIE ")[1])||void 0,(f=document.documentMode)&&5!=f&&Math.floor(e)!=f&&(e=f),u.add("ie",e)))}return u})},"dojo/_base/lang":function(){define(["./kernel","../has","../sniff"],function(u,f){var e=function(g,d,c){c||(c=g[0]&&u.scopeMap[g[0]]?u.scopeMap[g.shift()][1]:u.global);try{for(var a=0;a<g.length;a++){var b=g[a];if(!(b in
c))if(d)c[b]={};else return;c=c[b]}return c}catch(q){}},r=Object.prototype.toString,m=function(g,d,c){return(c||[]).concat(Array.prototype.slice.call(g,d||0))},d=/\{([^\}]+)\}/g,g={_extraNames:[],_mixin:function(g,d,c){var a,b,q={};for(a in d)b=d[a],a in g&&(g[a]===b||a in q&&q[a]===b)||(g[a]=c?c(b):b);return g},mixin:function(d,e){d||(d={});for(var c=1,a=arguments.length;c<a;c++)g._mixin(d,arguments[c]);return d},setObject:function(g,d,c){var a=g.split(".");g=a.pop();return(c=e(a,!0,c))&&g?c[g]=
d:void 0},getObject:function(g,d,c){return g?e(g.split("."),d,c):c},exists:function(d,e){return void 0!==g.getObject(d,!1,e)},isString:function(g){return"string"==typeof g||g instanceof String},isArray:Array.isArray||function(g){return"[object Array]"==r.call(g)},isFunction:function(g){return"[object Function]"===r.call(g)},isObject:function(d){return void 0!==d&&(null===d||"object"==typeof d||g.isArray(d)||g.isFunction(d))},isArrayLike:function(d){return!!d&&!g.isString(d)&&!g.isFunction(d)&&!(d.tagName&&
"form"==d.tagName.toLowerCase())&&(g.isArray(d)||isFinite(d.length))},isAlien:function(d){return d&&!g.isFunction(d)&&/\{\s*\[native code\]\s*\}/.test(String(d))},extend:function(d,e){for(var c=1,a=arguments.length;c<a;c++)g._mixin(d.prototype,arguments[c]);return d},_hitchArgs:function(d,e){var c=g._toArray(arguments,2),a=g.isString(e);return function(){var b=g._toArray(arguments),q=a?(d||u.global)[e]:e;return q&&q.apply(d||this,c.concat(b))}},hitch:function(d,e){if(2<arguments.length)return g._hitchArgs.apply(u,
arguments);e||(e=d,d=null);if(g.isString(e)){d=d||u.global;if(!d[e])throw['lang.hitch: scope["',e,'"] is null (scope\x3d"',d,'")'].join("");return function(){return d[e].apply(d,arguments||[])}}return d?function(){return e.apply(d,arguments||[])}:e},delegate:function(){function d(){}return function(k,c){d.prototype=k;k=new d;d.prototype=null;c&&g._mixin(k,c);return k}}(),_toArray:f("ie")?function(){function g(g,c,a){a=a||[];for(c=c||0;c<g.length;c++)a.push(g[c]);return a}return function(d){return(d.item?
g:m).apply(this,arguments)}}():m,partial:function(d){return g.hitch.apply(u,[null].concat(g._toArray(arguments)))},clone:function(d){if(!d||"object"!=typeof d||g.isFunction(d))return d;if(d.nodeType&&"cloneNode"in d)return d.cloneNode(!0);if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp)return new RegExp(d);var k,c,a;if(g.isArray(d))for(k=[],c=0,a=d.length;c<a;++c)c in d&&(k[c]=g.clone(d[c]));else k=d.constructor?new d.constructor:{};return g._mixin(k,d,g.clone)},trim:String.prototype.trim?
function(g){return g.trim()}:function(g){return g.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},replace:function(k,e,c){return k.replace(c||d,g.isFunction(e)?e:function(a,b){return g.getObject(b,!1,e)})}};g.mixin(u,g);return g})},"dojo/_base/array":function(){define(["./kernel","../has","./lang"],function(u,f,e){function r(c){return g[c]=new Function("item","index","array",c)}function m(c){var a=!c;return function(b,d,k){var q=0,e=b&&b.length||0,v;e&&"string"==typeof b&&(b=b.split(""));"string"==typeof d&&
(d=g[d]||r(d));if(k)for(;q<e;++q){if(v=!d.call(k,b[q],q,b),c^v)return!v}else for(;q<e;++q)if(v=!d(b[q],q,b),c^v)return!v;return a}}function d(c){var a=1,b=0,g=0;c||(a=b=g=-1);return function(d,q,e,z){if(z&&0<a)return l.lastIndexOf(d,q,e);z=d&&d.length||0;var t=c?z+g:b;e===k?e=c?b:z+g:0>e?(e=z+e,0>e&&(e=b)):e=e>=z?z+g:e;for(z&&"string"==typeof d&&(d=d.split(""));e!=t;e+=a)if(d[e]==q)return e;return-1}}var g={},k,l={every:m(!1),some:m(!0),indexOf:d(!0),lastIndexOf:d(!1),forEach:function(c,a,b){var d=
0,k=c&&c.length||0;k&&"string"==typeof c&&(c=c.split(""));"string"==typeof a&&(a=g[a]||r(a));if(b)for(;d<k;++d)a.call(b,c[d],d,c);else for(;d<k;++d)a(c[d],d,c)},map:function(c,a,b,d){var q=0,k=c&&c.length||0;d=new (d||Array)(k);k&&"string"==typeof c&&(c=c.split(""));"string"==typeof a&&(a=g[a]||r(a));if(b)for(;q<k;++q)d[q]=a.call(b,c[q],q,c);else for(;q<k;++q)d[q]=a(c[q],q,c);return d},filter:function(c,a,b){var d=0,k=c&&c.length||0,t=[],e;k&&"string"==typeof c&&(c=c.split(""));"string"==typeof a&&
(a=g[a]||r(a));if(b)for(;d<k;++d)e=c[d],a.call(b,e,d,c)&&t.push(e);else for(;d<k;++d)e=c[d],a(e,d,c)&&t.push(e);return t},clearCache:function(){g={}}};e.mixin(u,l);return l})},"dojo/ready":function(){define(["./_base/kernel","./has","require","./has!host-browser?./domReady","./_base/lang"],function(u,f,e,r,m){var d=0,g=[],k=0;f=function(){d=1;u._postLoad=u.config.afterOnLoad=!0;l()};var l=function(){if(!k){for(k=1;d&&(!r||0==r._Q.length)&&(e.idle?e.idle():1)&&g.length;){var a=g.shift();try{a()}catch(q){if(q.info=
q.message,e.signal)e.signal("error",q);else throw q;}}k=0}};e.on&&e.on("idle",l);r&&(r._onQEmpty=l);var c=u.ready=u.addOnLoad=function(a,c,d){var b=m._toArray(arguments);"number"!=typeof a?(d=c,c=a,a=1E3):b.shift();d=d?m.hitch.apply(u,b):function(){c()};d.priority=a;for(b=0;b<g.length&&a>=g[b].priority;b++);g.splice(b,0,d);l()},a=u.config.addOnLoad;if(a)c[m.isArray(a)?"apply":"call"](u,a);r?r(f):f();return c})},"dojo/_base/declare":function(){define(["./kernel","../has","./lang"],function(u,f,e){function r(a,
b){throw Error("declare"+(b?" "+b:"")+": "+a);}function m(a,b){for(var c=[],g=[{cls:0,refs:[]}],d={},q=1,k=a.length,e=0,t,x,v,l,z;e<k;++e){(t=a[e])?"[object Function]"!=B.call(t)&&r("mixin #"+e+" is not a callable constructor.",b):r("mixin #"+e+" is unknown. Did you use dojo.require to pull it in?",b);x=t._meta?t._meta.bases:[t];v=0;for(t=x.length-1;0<=t;--t)l=x[t].prototype,l.hasOwnProperty("declaredClass")||(l.declaredClass="uniqName_"+F++),l=l.declaredClass,d.hasOwnProperty(l)||(d[l]={count:0,
refs:[],cls:x[t]},++q),l=d[l],v&&v!==l&&(l.refs.push(v),++v.count),v=l;++v.count;g[0].refs.push(v)}for(;g.length;){v=g.pop();c.push(v.cls);for(--q;z=v.refs,1==z.length;){v=z[0];if(!v||--v.count){v=0;break}c.push(v.cls);--q}if(v)for(e=0,k=z.length;e<k;++e)v=z[e],--v.count||g.push(v)}q&&r("can't build consistent linearization",b);t=a[0];c[0]=t?t._meta&&t===c[c.length-t._meta.bases.length]?t._meta.bases.length:1:0;return c}function d(a,b,c,g){var d,q,k,e,t,x,v=this._inherited=this._inherited||{};"string"===
typeof a&&(d=a,a=b,b=c,c=g);if("function"===typeof a)k=a,a=b,b=c;else try{k=a.callee}catch(X){if(X instanceof TypeError)r("strict mode inherited() requires the caller function to be passed before arguments",this.declaredClass);else throw X;}(d=d||k.nom)||r("can't deduce a name to call inherited()",this.declaredClass);c=g=0;e=this.constructor._meta;g=e.bases;x=v.p;if("constructor"!=d){if(v.c!==k&&(x=0,t=g[0],e=t._meta,e.hidden[d]!==k)){(q=e.chains)&&"string"==typeof q[d]&&r("calling chained method with inherited: "+
d,this.declaredClass);do if(e=t._meta,q=t.prototype,e&&(q[d]===k&&q.hasOwnProperty(d)||e.hidden[d]===k))break;while(t=g[++x]);x=t?x:-1}if(t=g[++x])if(q=t.prototype,t._meta&&q.hasOwnProperty(d))c=q[d];else{k=J[d];do if(q=t.prototype,(c=q[d])&&(t._meta?q.hasOwnProperty(d):c!==k))break;while(t=g[++x])}c=t&&c||J[d]}else{if(v.c!==k&&(x=0,(e=g[0]._meta)&&e.ctor!==k)){for((q=e.chains)&&"manual"===q.constructor||r("calling chained constructor with inherited",this.declaredClass);(t=g[++x])&&(!(e=t._meta)||
e.ctor!==k););x=t?x:-1}for(;(t=g[++x])&&!(c=(e=t._meta)?e.ctor:t););c=t&&c}v.c=c;v.p=x;if(c)return!0===b?c:c.apply(this,b||a)}function g(a,b,c){return"string"===typeof a?"function"===typeof b?this.__inherited(a,b,c,!0):this.__inherited(a,b,!0):"function"===typeof a?this.__inherited(a,b,!0):this.__inherited(a,!0)}function k(a,b,c,g){var d=this.getInherited(a,b,c);if(d)return d.apply(this,g||c||b||a)}function l(a){for(var b=this.constructor._meta.bases,c=0,g=b.length;c<g;++c)if(b[c]===a)return!0;return this instanceof
a}function c(a,b){for(var c in b)"constructor"!=c&&b.hasOwnProperty(c)&&(a[c]=b[c])}function a(a){E.safeMixin(this.prototype,a);return this}function b(a,b){a instanceof Array||"function"===typeof a||(b=a,a=void 0);b=b||{};a=a||[];return E([this].concat(a),b)}function q(a,b){return function(){var c=arguments,g=c,d=c[0],q,k;k=a.length;var t;if(!(this instanceof c.callee))return A(c);if(b&&(d&&d.preamble||this.preamble))for(t=Array(a.length),t[0]=c,q=0;;){(d=c[0])&&(d=d.preamble)&&(c=d.apply(this,c)||
c);d=a[q].prototype;(d=d.hasOwnProperty("preamble")&&d.preamble)&&(c=d.apply(this,c)||c);if(++q==k)break;t[q]=c}for(q=k-1;0<=q;--q)d=a[q],(d=(k=d._meta)?k.ctor:d)&&d.apply(this,t?t[q]:c);(d=this.postscript)&&d.apply(this,g)}}function v(a,b){return function(){var c=arguments,d=c,g=c[0];if(!(this instanceof c.callee))return A(c);b&&(g&&(g=g.preamble)&&(d=g.apply(this,d)||d),(g=this.preamble)&&g.apply(this,d));a&&a.apply(this,c);(g=this.postscript)&&g.apply(this,c)}}function t(a){return function(){var b=
arguments,c=0,g,d;if(!(this instanceof b.callee))return A(b);for(;g=a[c];++c)if(g=(d=g._meta)?d.ctor:g){g.apply(this,b);break}(g=this.postscript)&&g.apply(this,b)}}function x(a,b,c){return function(){var g,d,q=0,k=1;c&&(q=b.length-1,k=-1);for(;g=b[q];q+=k)d=g._meta,(g=(d?d.hidden:g.prototype)[a])&&g.apply(this,arguments)}}function z(a){G.prototype=a.prototype;a=new G;G.prototype=null;return a}function A(a){var b=a.callee,c=z(b);b.apply(c,a);return c}function E(k,A,G){"string"!=typeof k&&(G=A,A=k,
k="");G=G||{};var F,R,S,O,ba,V,T,u=1,X=A;"[object Array]"==B.call(A)?(V=m(A,k),S=V[0],u=V.length-S,A=V[u]):(V=[0],A?"[object Function]"==B.call(A)?(S=A._meta,V=V.concat(S?S.bases:A)):r("base class is not a callable constructor.",k):null!==A&&r("unknown base class. Did you use dojo.require to pull it in?",k));if(A)for(R=u-1;;--R){F=z(A);if(!R)break;S=V[R];(S._meta?c:H)(F,S.prototype);O=f("csp-restrictions")?function(){}:new Function;O.superclass=A;O.prototype=F;A=F.constructor=O}else F={};E.safeMixin(F,
G);S=G.constructor;S!==J.constructor&&(S.nom="constructor",F.constructor=S);for(R=u-1;R;--R)(S=V[R]._meta)&&S.chains&&(T=H(T||{},S.chains));F["-chains-"]&&(T=H(T||{},F["-chains-"]));A&&A.prototype&&A.prototype["-chains-"]&&(T=H(T||{},A.prototype["-chains-"]));S=!T||!T.hasOwnProperty("constructor");V[0]=O=T&&"manual"===T.constructor?t(V):1==V.length?v(G.constructor,S):q(V,S);O._meta={bases:V,hidden:G,chains:T,parents:X,ctor:G.constructor};O.superclass=A&&A.prototype;O.extend=a;O.createSubclass=b;O.prototype=
F;F.constructor=O;F.getInherited=g;F.isInstanceOf=l;F.inherited=M;F.__inherited=d;k&&(F.declaredClass=k,e.setObject(k,O));if(T)for(ba in T)F[ba]&&"string"==typeof T[ba]&&"constructor"!=ba&&(S=F[ba]=x(ba,V,"after"===T[ba]),S.nom=ba);return O}var H=e.mixin,J=Object.prototype,B=J.toString,G,F=0;G=f("csp-restrictions")?function(){}:new Function;var M=u.config.isDebug?k:d;u.safeMixin=E.safeMixin=function(a,b){var c,g;for(c in b)g=b[c],g===J[c]&&c in J||"constructor"==c||("[object Function]"==B.call(g)&&
(g.nom=c),a[c]=g);return a};return u.declare=E})},"dojo/_base/connect":function(){define("./kernel ../on ../topic ../aspect ./event ../mouse ./sniff ./lang ../keys".split(" "),function(u,f,e,r,m,d,g,k){function l(a,b,c,g,q){g=k.hitch(c,g);if(!a||!a.addEventListener&&!a.attachEvent)return r.after(a||u.global,b,g,!0);"string"==typeof b&&"on"==b.substring(0,2)&&(b=b.substring(2));a||(a=u.global);if(!q)switch(b){case "keypress":b=v;break;case "mouseenter":b=d.enter;break;case "mouseleave":b=d.leave}return f(a,
b,g,q)}function c(a){a.keyChar=a.charCode?String.fromCharCode(a.charCode):"";a.charOrCode=a.keyChar||a.keyCode}g.add("events-keypress-typed",function(){var a={charCode:0};try{a=document.createEvent("KeyboardEvent"),(a.initKeyboardEvent||a.initKeyEvent).call(a,"keypress",!0,!0,null,!1,!1,!1,!1,9,3)}catch(z){}return 0==a.charCode&&!g("opera")});var a={106:42,111:47,186:59,187:43,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39,229:113},b=g("mac")?"metaKey":"ctrlKey",q=function(a,b){b=
k.mixin({},a,b);c(b);b.preventDefault=function(){a.preventDefault()};b.stopPropagation=function(){a.stopPropagation()};return b},v;v=g("events-keypress-typed")?function(b,c){var d=f(b,"keydown",function(b){var d=b.keyCode,k=13!=d&&32!=d&&(27!=d||!g("ie"))&&(48>d||90<d)&&(96>d||111<d)&&(186>d||192<d)&&(219>d||222<d)&&229!=d;if(k||b.ctrlKey){k=k?0:d;if(b.ctrlKey){if(3==d||13==d)return c.call(b.currentTarget,b);k=95<k&&106>k?k-48:!b.shiftKey&&65<=k&&90>=k?k+32:a[k]||k}d=q(b,{type:"keypress",faux:!0,
charCode:k});c.call(b.currentTarget,d);if(g("ie"))try{b.keyCode=d.keyCode}catch(G){}}}),k=f(b,"keypress",function(a){var b=a.charCode;a=q(a,{charCode:32<=b?b:0,faux:!0});return c.call(this,a)});return{remove:function(){d.remove();k.remove()}}}:g("opera")?function(a,b){return f(a,"keypress",function(a){var c=a.which;3==c&&(c=99);c=32>c&&!a.shiftKey?0:c;a.ctrlKey&&!a.shiftKey&&65<=c&&90>=c&&(c+=32);return b.call(this,q(a,{charCode:c}))})}:function(a,b){return f(a,"keypress",function(a){c(a);return b.call(this,
a)})};var t={_keypress:v,connect:function(a,b,c,g,d){var q=arguments,k=[],t=0;k.push("string"==typeof q[0]?null:q[t++],q[t++]);var e=q[t+1];k.push("string"==typeof e||"function"==typeof e?q[t++]:null,q[t++]);for(e=q.length;t<e;t++)k.push(q[t]);return l.apply(this,k)},disconnect:function(a){a&&a.remove()},subscribe:function(a,b,c){return e.subscribe(a,k.hitch(b,c))},publish:function(a,b){return e.publish.apply(e,[a].concat(b))},connectPublisher:function(a,b,c){var g=function(){t.publish(a,arguments)};
return c?t.connect(b,c,g):t.connect(b,g)},isCopyKey:function(a){return a[b]}};t.unsubscribe=t.disconnect;k.mixin(u,t);return t})},"dojo/on":function(){define(["require","./_base/kernel","./sniff"],function(u,f,e){function r(b,c,d,l,f){if(l=c.match(/(.*):(.*)/))return c=l[2],l=l[1],g.selector(l,c).call(f,b,d);e("touch")&&k.test(c)&&(d=q(d));if(b.addEventListener){var t=c in a,v=t?a[c]:c;b.addEventListener(v,d,t);return{remove:function(){b.removeEventListener(v,d,t)}}}throw Error("Target must be an event emitter");
}function m(){this.cancelable=!1;this.defaultPrevented=!0}function d(){this.bubbles=!1}e("dom")&&e("touch");var g=function(a,b,c,d){return"function"!=typeof a.on||"function"==typeof b||a.nodeType?g.parse(a,b,c,r,d,this):a.on(b,c)};g.pausable=function(a,b,c,d){var q;a=g(a,b,function(){if(!q)return c.apply(this,arguments)},d);a.pause=function(){q=!0};a.resume=function(){q=!1};return a};g.once=function(a,b,c,d){var q=g(a,b,function(){q.remove();return c.apply(this,arguments)});return q};g.parse=function(a,
b,c,d,q,k){var e;if(b.call)return b.call(k,a,c);b instanceof Array?e=b:-1<b.indexOf(",")&&(e=b.split(/\s*,\s*/));if(e){var t=[];b=0;for(var v;v=e[b++];)t.push(g.parse(a,v,c,d,q,k));t.remove=function(){for(var a=0;a<t.length;a++)t[a].remove()};return t}return d(a,b,c,q,k)};var k=/^touch/;g.matches=function(a,b,c,d,g){g=g&&"function"==typeof g.matches?g:f.query;d=!1!==d;1!=a.nodeType&&(a=a.parentNode);for(;!g.matches(a,b,c);)if(a==c||!1===d||!(a=a.parentNode)||1!=a.nodeType)return!1;return a};g.selector=
function(a,b,c){return function(d,q){function k(b){return g.matches(b,a,d,c,e)}var e="function"==typeof a?{matches:a}:this,t=b.bubble;return t?g(d,t(k),q):g(d,b,function(a){var b=k(a.target);if(b)return a.selectorTarget=b,q.call(b,a)})}};var l=[].slice,c=g.emit=function(a,b,c){var g=l.call(arguments,2),q="on"+b;if("parentNode"in a){var k=g[0]={},e;for(e in c)k[e]=c[e];k.preventDefault=m;k.stopPropagation=d;k.target=a;k.type=b;c=k}do a[q]&&a[q].apply(a,g);while(c&&c.bubbles&&(a=a.parentNode));return c&&
c.cancelable&&c},a={};g.emit=function(a,b,d){if(a.dispatchEvent&&document.createEvent){var q=(a.ownerDocument||document).createEvent("HTMLEvents");q.initEvent(b,!!d.bubbles,!!d.cancelable);for(var k in d)k in q||(q[k]=d[k]);return a.dispatchEvent(q)&&q}return c.apply(g,arguments)};if(e("touch"))var b=window.orientation,q=function(a){return function(c){var d=c.corrected;if(!d){var g=c.type;try{delete c.type}catch(H){}if(c.type){var d={},q;for(q in c)d[q]=c[q];d.preventDefault=function(){c.preventDefault()};
d.stopPropagation=function(){c.stopPropagation()}}else d=c,d.type=g;c.corrected=d;if("resize"==g){if(b==window.orientation)return null;b=window.orientation;d.type="orientationchange";return a.call(this,d)}"rotation"in d||(d.rotation=0,d.scale=1);if(window.TouchEvent&&c instanceof TouchEvent){var g=d.changedTouches[0],k;for(k in g)delete d[k],d[k]=g[k]}}return a.call(this,d)}};return g})},"dojo/topic":function(){define(["./Evented"],function(u){var f=new u;return{publish:function(e,r){return f.emit.apply(f,
arguments)},subscribe:function(e,r){return f.on.apply(f,arguments)}}})},"dojo/Evented":function(){define(["./aspect","./on"],function(u,f){function e(){}var r=u.after;e.prototype={on:function(e,d){return f.parse(this,e,d,function(g,k){return r(g,"on"+k,d,!0)})},emit:function(e,d){var g=[this];g.push.apply(g,arguments);return f.emit.apply(f,g)}};return e})},"dojo/aspect":function(){define([],function(){function u(d,k,e,c){var a=d[k],b="around"==k,g;if(b){var v=e(function(){return a.advice(this,arguments)});
g={remove:function(){v&&(v=d=e=null)},advice:function(b,c){return v?v.apply(b,c):a.advice(b,c)}}}else g={remove:function(){if(g.advice){var a=g.previous,b=g.next;b||a?(a?a.next=b:d[k]=b,b&&(b.previous=a)):delete d[k];d=e=g.advice=null}},id:d.nextId++,advice:e,receiveArguments:c};if(a&&!b)if("after"==k){for(;a.next&&(a=a.next););a.next=g;g.previous=a}else"before"==k&&(d[k]=g,g.next=a,a.previous=g);else d[k]=g;return g}function f(d){return function(g,l,c,a){var b=g[l],q;b&&b.target==g||(g[l]=q=function(){for(var a=
q.nextId,b=arguments,c=q.before;c;)c.advice&&(b=c.advice.apply(this,b)||b),c=c.next;if(q.around)var d=q.around.advice(this,b);for(c=q.after;c&&c.id<a;){if(c.advice)if(c.receiveArguments)var g=c.advice.apply(this,b),d=g===e?d:g;else d=c.advice.call(this,d,b);c=c.next}return d},b&&(q.around={advice:function(a,c){return b.apply(a,c)}}),q.target=g,q.nextId=q.nextId||0);g=u(q||b,d,c,a);c=null;return g}}var e,r=f("after"),m=f("before"),d=f("around");return{before:m,around:d,after:r}})},"dojo/_base/event":function(){define(["./kernel",
"../on","../has","../dom-geometry"],function(u,f,e,r){if(f._fixEvent){var m=f._fixEvent;f._fixEvent=function(d,g){(d=m(d,g))&&r.normalizeEvent(d);return d}}e={fix:function(d,g){return f._fixEvent?f._fixEvent(d,g):d},stop:function(d){d.preventDefault();d.stopPropagation()}};u.fixEvent=e.fix;u.stopEvent=e.stop;return e})},"dojo/dom-geometry":function(){define(["./sniff","./_base/window","./dom","./dom-style"],function(u,f,e,r){function m(c,a,b,d,g,k){k=k||"px";c=c.style;isNaN(a)||(c.left=a+k);isNaN(b)||
(c.top=b+k);0<=d&&(c.width=d+k);0<=g&&(c.height=g+k)}function d(c){return"button"==c.tagName.toLowerCase()||"input"==c.tagName.toLowerCase()&&"button"==(c.getAttribute("type")||"").toLowerCase()}function g(c){return"border-box"==k.boxModel||"table"==c.tagName.toLowerCase()||d(c)}var k={boxModel:"content-box"};u("ie")&&(k.boxModel="BackCompat"==document.compatMode?"border-box":"content-box");k.getPadExtents=function(c,a){c=e.byId(c);var b=a||r.getComputedStyle(c),d=r.toPixelValue;a=d(c,b.paddingLeft);
var g=d(c,b.paddingTop),k=d(c,b.paddingRight);c=d(c,b.paddingBottom);return{l:a,t:g,r:k,b:c,w:a+k,h:g+c}};k.getBorderExtents=function(c,a){c=e.byId(c);var b=r.toPixelValue,d=a||r.getComputedStyle(c);a="none"!=d.borderLeftStyle?b(c,d.borderLeftWidth):0;var g="none"!=d.borderTopStyle?b(c,d.borderTopWidth):0,k="none"!=d.borderRightStyle?b(c,d.borderRightWidth):0;c="none"!=d.borderBottomStyle?b(c,d.borderBottomWidth):0;return{l:a,t:g,r:k,b:c,w:a+k,h:g+c}};k.getPadBorderExtents=function(c,a){c=e.byId(c);
var b=a||r.getComputedStyle(c);a=k.getPadExtents(c,b);c=k.getBorderExtents(c,b);return{l:a.l+c.l,t:a.t+c.t,r:a.r+c.r,b:a.b+c.b,w:a.w+c.w,h:a.h+c.h}};k.getMarginExtents=function(c,a){c=e.byId(c);var b=a||r.getComputedStyle(c),d=r.toPixelValue;a=d(c,b.marginLeft);var g=d(c,b.marginTop),k=d(c,b.marginRight);c=d(c,b.marginBottom);return{l:a,t:g,r:k,b:c,w:a+k,h:g+c}};k.getMarginBox=function(c,a){c=e.byId(c);a=a||r.getComputedStyle(c);a=k.getMarginExtents(c,a);var b=c.offsetLeft-a.l,d=c.offsetTop-a.t,g=
c.parentNode,t=r.toPixelValue;8==u("ie")&&g&&(g=r.getComputedStyle(g),b-="none"!=g.borderLeftStyle?t(c,g.borderLeftWidth):0,d-="none"!=g.borderTopStyle?t(c,g.borderTopWidth):0);return{l:b,t:d,w:c.offsetWidth+a.w,h:c.offsetHeight+a.h}};k.getContentBox=function(c,a){c=e.byId(c);var b=a||r.getComputedStyle(c);a=c.clientWidth;var d,g=k.getPadExtents(c,b);d=k.getBorderExtents(c,b);var b=c.offsetLeft+g.l+d.l,t=c.offsetTop+g.t+d.t;a?d=c.clientHeight:(a=c.offsetWidth-d.w,d=c.offsetHeight-d.h);if(8==u("ie")){var l=
c.parentNode,f=r.toPixelValue;l&&(l=r.getComputedStyle(l),b-="none"!=l.borderLeftStyle?f(c,l.borderLeftWidth):0,t-="none"!=l.borderTopStyle?f(c,l.borderTopWidth):0)}return{l:b,t:t,w:a-g.w,h:d-g.h}};k.setContentSize=function(c,a,b){c=e.byId(c);var d=a.w;a=a.h;g(c)&&(b=k.getPadBorderExtents(c,b),0<=d&&(d+=b.w),0<=a&&(a+=b.h));m(c,NaN,NaN,d,a)};var l={l:0,t:0,w:0,h:0};k.setMarginBox=function(c,a,b){c=e.byId(c);var q=b||r.getComputedStyle(c);b=a.w;var v=a.h,t=g(c)?l:k.getPadBorderExtents(c,q),q=k.getMarginExtents(c,
q);if(u("webkit")&&d(c)){var x=c.style;0<=b&&!x.width&&(x.width="4px");0<=v&&!x.height&&(x.height="4px")}0<=b&&(b=Math.max(b-t.w-q.w,0));0<=v&&(v=Math.max(v-t.h-q.h,0));m(c,a.l,a.t,b,v)};k.isBodyLtr=function(c){c=c||f.doc;return"ltr"==(f.body(c).dir||c.documentElement.dir||"ltr").toLowerCase()};k.docScroll=function(c){c=c||f.doc;var a=f.doc.parentWindow||f.doc.defaultView;return"pageXOffset"in a?{x:a.pageXOffset,y:a.pageYOffset}:(a=c.documentElement)&&{x:k.fixIeBiDiScrollLeft(a.scrollLeft||0,c),y:a.scrollTop||
0}};k.getIeDocumentElementOffset=function(c){return{x:0,y:0}};k.fixIeBiDiScrollLeft=function(c,a){a=a||f.doc;var b=u("ie");if(b&&!k.isBodyLtr(a)){a=a.documentElement;var d=f.global;6==b&&d.frameElement&&a.scrollHeight>a.clientHeight&&(c+=a.clientLeft);return 8>b?c+a.clientWidth-a.scrollWidth:-c}return c};k.position=function(c,a){c=e.byId(c);f.body(c.ownerDocument);var b=c.getBoundingClientRect(),b={x:b.left,y:b.top,w:b.right-b.left,h:b.bottom-b.top};9>u("ie")&&(b.x-=0,b.y-=0);a&&(c=k.docScroll(c.ownerDocument),
b.x+=c.x,b.y+=c.y);return b};k.getMarginSize=function(c,a){c=e.byId(c);a=k.getMarginExtents(c,a||r.getComputedStyle(c));c=c.getBoundingClientRect();return{w:c.right-c.left+a.w,h:c.bottom-c.top+a.h}};k.normalizeEvent=function(c){"layerX"in c||(c.layerX=c.offsetX,c.layerY=c.offsetY);if(!("pageX"in c)){var a=c.target,a=a&&a.ownerDocument||document,b=a.documentElement;c.pageX=c.clientX+k.fixIeBiDiScrollLeft(b.scrollLeft||0,a);c.pageY=c.clientY+(b.scrollTop||0)}};return k})},"dojo/_base/window":function(){define(["./kernel",
"./lang","../sniff"],function(u,f,e){var r={global:u.global,doc:u.global.document||null,body:function(e){e=e||u.doc;return e.body||e.getElementsByTagName("body")[0]},setContext:function(e,d){u.global=r.global=e;u.doc=r.doc=d},withGlobal:function(e,d,g,k){var l=u.global;try{return u.global=r.global=e,r.withDoc.call(null,e.document,d,g,k)}finally{u.global=r.global=l}},withDoc:function(f,d,g,k){var l=r.doc,c=e("ie"),a,b,q;try{return u.doc=r.doc=f,u.isQuirks=0,e("ie")&&(q=f.parentWindow)&&q.navigator&&
(a=parseFloat(q.navigator.appVersion.split("MSIE ")[1])||void 0,(b=f.documentMode)&&5!=b&&Math.floor(a)!=b&&(a=b),u.isIE=e.add("ie",a,!0,!0)),g&&"string"==typeof d&&(d=g[d]),d.apply(g,k||[])}finally{u.doc=r.doc=l,u.isQuirks=0,u.isIE=e.add("ie",c,!0,!0)}}};f.mixin(u,r);return r})},"dojo/dom":function(){define(["./sniff","./_base/window","./_base/kernel"],function(u,f,e){if(7>=u("ie"))try{document.execCommand("BackgroundImageCache",!1,!0)}catch(d){}var r={};u("ie")?r.byId=function(d,g){if("string"!=
typeof d)return d;var k=g||f.doc;g=d&&k.getElementById(d);if(!g||g.attributes.id.value!=d&&g.id!=d){k=k.all[d];if(!k||k.nodeName)k=[k];for(var e=0;g=k[e++];)if(g.attributes&&g.attributes.id&&g.attributes.id.value==d||g.id==d)return g}else return g}:r.byId=function(d,g){return("string"==typeof d?(g||f.doc).getElementById(d):d)||null};e=e.global.document||null;u.add("dom-contains",!(!e||!e.contains));r.isDescendant=u("dom-contains")?function(d,g){return!(!(g=r.byId(g))||!g.contains(r.byId(d)))}:function(d,
g){try{for(d=r.byId(d),g=r.byId(g);d;){if(d==g)return!0;d=d.parentNode}}catch(k){}return!1};u.add("css-user-select",function(d,g,k){if(!k)return!1;d=k.style;g=["Khtml","O","Moz","Webkit"];k=g.length;var e="userSelect";do if("undefined"!==typeof d[e])return e;while(k--&&(e=g[k]+"UserSelect"));return!1});var m=u("css-user-select");r.setSelectable=m?function(d,g){r.byId(d).style[m]=g?"":"none"}:function(d,g){d=r.byId(d);var k=d.getElementsByTagName("*"),e=k.length;if(g)for(d.removeAttribute("unselectable");e--;)k[e].removeAttribute("unselectable");
else for(d.setAttribute("unselectable","on");e--;)k[e].setAttribute("unselectable","on")};return r})},"dojo/dom-style":function(){define(["./sniff","./dom","./_base/window"],function(u,f,e){function r(c,d,q){d=d.toLowerCase();if("auto"==q){if("height"==d)return c.offsetHeight;if("width"==d)return c.offsetWidth}if("fontweight"==d)switch(q){case 700:return"bold";default:return"normal"}d in a||(a[d]=b.test(d));return a[d]?g(c,q):q}var m,d={};m=u("webkit")?function(a){var b;if(1==a.nodeType){var c=a.ownerDocument.defaultView;
b=c.getComputedStyle(a,null);!b&&a.style&&(a.style.display="",b=c.getComputedStyle(a,null))}return b||{}}:u("ie")&&9>u("ie")?function(a){return 1==a.nodeType&&a.currentStyle?a.currentStyle:{}}:function(a){if(1===a.nodeType){var b=a.ownerDocument.defaultView;return(b.opener?b:e.global.window).getComputedStyle(a,null)}return{}};d.getComputedStyle=m;var g;g=u("ie")?function(a,b){if(!b)return 0;if("medium"==b)return 4;if(b.slice&&"px"==b.slice(-2))return parseFloat(b);var c=a.style,d=a.runtimeStyle,g=
c.left,q=d.left;d.left=a.currentStyle.left;try{c.left=b,b=c.pixelLeft}catch(H){b=0}c.left=g;d.left=q;return b}:function(a,b){return parseFloat(b)||0};d.toPixelValue=g;var k=function(a,b){try{return a.filters.item("DXImageTransform.Microsoft.Alpha")}catch(x){return b?{}:null}},l=9>u("ie")||(u("ie"),0)?function(a){try{return k(a).Opacity/100}catch(t){return 1}}:function(a){return m(a).opacity},c=9>u("ie")||(u("ie"),0)?function(a,b){""===b&&(b=1);var d=100*b;1===b?(a.style.zoom="",k(a)&&(a.style.filter=
a.style.filter.replace(/\s*progid:DXImageTransform.Microsoft.Alpha\([^\)]+?\)/i,""))):(a.style.zoom=1,k(a)?k(a,1).Opacity=d:a.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(Opacity\x3d"+d+")",k(a,1).Enabled=!0);if("tr"==a.tagName.toLowerCase())for(a=a.firstChild;a;a=a.nextSibling)"td"==a.tagName.toLowerCase()&&c(a,b);return b}:function(a,b){return a.style.opacity=b},a={left:!0,top:!0},b=/margin|padding|width|height|max|min|offset/,q={cssFloat:1,styleFloat:1,"float":1};d.get=function(a,b){var c=
f.byId(a),g=arguments.length;if(2==g&&"opacity"==b)return l(c);b=q[b]?"cssFloat"in c.style?"cssFloat":"styleFloat":b;var k=d.getComputedStyle(c);return 1==g?k:r(c,b,k[b]||c.style[b])};d.set=function(a,b,g){var k=f.byId(a),e=arguments.length,t="opacity"==b;b=q[b]?"cssFloat"in k.style?"cssFloat":"styleFloat":b;if(3==e)return t?c(k,g):k.style[b]=g;for(var l in b)d.set(a,l,b[l]);return d.getComputedStyle(k)};return d})},"dojo/mouse":function(){define(["./_base/kernel","./on","./has","./dom","./_base/window"],
function(u,f,e,r,m){function d(g,k){var e=function(c,a){return f(c,g,function(b){if(k)return k(b,a);if(!r.isDescendant(b.relatedTarget,c))return a.call(this,b)})};e.bubble=function(c){return d(g,function(a,b){var d=c(a.target),g=a.relatedTarget;if(d&&d!=(g&&1==g.nodeType&&c(g)))return b.call(d,a)})};return e}e={LEFT:0,MIDDLE:1,RIGHT:2,isButton:function(d,k){return d.button==k},isLeft:function(d){return 0==d.button},isMiddle:function(d){return 1==d.button},isRight:function(d){return 2==d.button}};
u.mouseButtons=e;return{_eventHandler:d,enter:d("mouseover"),leave:d("mouseout"),wheel:"mousewheel",isLeft:e.isLeft,isMiddle:e.isMiddle,isRight:e.isRight}})},"dojo/_base/sniff":function(){define(["./kernel","./lang","../sniff"],function(u,f,e){if(!e("host-browser"))return e;u._name="browser";f.mixin(u,{isBrowser:!0,isFF:e("ff"),isIE:e("ie"),isKhtml:0,isWebKit:e("webkit"),isMozilla:e("mozilla"),isMoz:e("mozilla"),isOpera:e("opera"),isSafari:e("safari"),isChrome:e("chrome"),isMac:e("mac"),isIos:e("ios"),
isAndroid:0,isWii:0,isQuirks:0,isAir:0});return e})},"dojo/keys":function(){define(["./_base/kernel","./sniff"],function(u,f){return u.keys={BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,META:f("webkit")?91:224,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,HELP:47,LEFT_WINDOW:91,RIGHT_WINDOW:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,
NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_PLUS:107,NUMPAD_ENTER:108,NUMPAD_MINUS:109,NUMPAD_PERIOD:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,NUM_LOCK:144,SCROLL_LOCK:145,UP_DPAD:175,DOWN_DPAD:176,LEFT_DPAD:177,RIGHT_DPAD:178,copyKey:f("mac")?f("safari")?91:224:17}})},"dojo/_base/Deferred":function(){define("./kernel ../Deferred ../promise/Promise ../errors/CancelError ../has ./lang ../when".split(" "),
function(u,f,e,r,m,d,g){var k=function(){},l=Object.freeze||function(){},c=u.Deferred=function(a){function b(a){if(t)throw Error("This deferred has already been resolved");v=a;t=!0;g()}function g(){for(var a;!a&&H;){var b=H;H=H.next;if(a=b.progress==k)t=!1;var c=A?b.error:b.resolved;m("config-useDeferredInstrumentation")&&A&&f.instrumentRejected&&f.instrumentRejected(v,!!c);if(c)try{var g=c(v);g&&"function"===typeof g.then?g.then(d.hitch(b.deferred,"resolve"),d.hitch(b.deferred,"reject"),d.hitch(b.deferred,
"progress")):(c=a&&void 0===g,a&&!c&&(A=g instanceof Error),b.deferred[c&&A?"reject":"resolve"](c?v:g))}catch(T){b.deferred.reject(T)}else A?b.deferred.reject(v):b.deferred.resolve(v)}}var v,t,x,z,A,E,H,J=this.promise=new e;this.isResolved=J.isResolved=function(){return 0==z};this.isRejected=J.isRejected=function(){return 1==z};this.isFulfilled=J.isFulfilled=function(){return 0<=z};this.isCanceled=J.isCanceled=function(){return x};this.resolve=this.callback=function(a){this.fired=z=0;this.results=
[a,null];b(a)};this.reject=this.errback=function(a){A=!0;this.fired=z=1;m("config-useDeferredInstrumentation")&&f.instrumentRejected&&f.instrumentRejected(a,!!H);b(a);this.results=[null,a]};this.progress=function(a){for(var b=H;b;){var c=b.progress;c&&c(a);b=b.next}};this.addCallbacks=function(a,b){this.then(a,b,k);return this};J.then=this.then=function(a,b,d){var q=d==k?this:new c(J.cancel);a={resolved:a,error:b,progress:d,deferred:q};H?E=E.next=a:H=E=a;t&&g();return q.promise};var B=this;J.cancel=
this.cancel=function(){if(!t){var b=a&&a(B);t||(b instanceof Error||(b=new r(b)),b.log=!1,B.reject(b))}x=!0};l(J)};d.extend(c,{addCallback:function(a){return this.addCallbacks(d.hitch.apply(u,arguments))},addErrback:function(a){return this.addCallbacks(null,d.hitch.apply(u,arguments))},addBoth:function(a){var b=d.hitch.apply(u,arguments);return this.addCallbacks(b,b)},fired:-1});c.when=u.when=g;return c})},"dojo/Deferred":function(){define(["./has","./_base/lang","./errors/CancelError","./promise/Promise",
"./has!config-deferredInstrumentation?./promise/instrumentation"],function(u,f,e,r,m){var d=Object.freeze||function(){},g=function(b,c,d,g,e){u("config-deferredInstrumentation")&&2===c&&a.instrumentRejected&&0===b.length&&a.instrumentRejected(d,!1,g,e);for(e=0;e<b.length;e++)k(b[e],c,d,g)},k=function(b,d,g,k){var q=b[d],e=b.deferred;if(q)try{var t=q(g);if(0===d)"undefined"!==typeof t&&c(e,d,t);else{if(t&&"function"===typeof t.then){b.cancel=t.cancel;t.then(l(e,1),l(e,2),l(e,0));return}c(e,1,t)}}catch(E){c(e,
2,E)}else c(e,d,g);u("config-deferredInstrumentation")&&2===d&&a.instrumentRejected&&a.instrumentRejected(g,!!q,k,e.promise)},l=function(a,d){return function(b){c(a,d,b)}},c=function(a,c,d){if(!a.isCanceled())switch(c){case 0:a.progress(d);break;case 1:a.resolve(d);break;case 2:a.reject(d)}},a=function(b){var c=this.promise=new r,l=this,t,x,f,m=!1,E=[];u("config-deferredInstrumentation")&&Error.captureStackTrace&&(Error.captureStackTrace(l,a),Error.captureStackTrace(c,a));this.isResolved=c.isResolved=
function(){return 1===t};this.isRejected=c.isRejected=function(){return 2===t};this.isFulfilled=c.isFulfilled=function(){return!!t};this.isCanceled=c.isCanceled=function(){return m};this.progress=function(a,b){if(t){if(!0===b)throw Error("This deferred has already been fulfilled.");return c}g(E,0,a,null,l);return c};this.resolve=function(a,b){if(t){if(!0===b)throw Error("This deferred has already been fulfilled.");return c}g(E,t=1,x=a,null,l);E=null;return c};var H=this.reject=function(a,b){if(t){if(!0===
b)throw Error("This deferred has already been fulfilled.");return c}u("config-deferredInstrumentation")&&Error.captureStackTrace&&Error.captureStackTrace(f={},H);g(E,t=2,x=a,f,l);E=null;return c};this.then=c.then=function(b,d,g){var q=[g,b,d];q.cancel=c.cancel;q.deferred=new a(function(a){return q.cancel&&q.cancel(a)});t&&!E?k(q,t,x,f):E.push(q);return q.deferred.promise};this.cancel=c.cancel=function(a,c){if(!t){b&&(c=b(a),a="undefined"===typeof c?a:c);m=!0;if(!t)return"undefined"===typeof a&&(a=
new e),H(a),a;if(2===t&&x===a)return a}else if(!0===c)throw Error("This deferred has already been fulfilled.");};d(c)};a.prototype.toString=function(){return"[object Deferred]"};m&&m(a);return a})},"dojo/errors/CancelError":function(){define(["./create"],function(u){return u("CancelError",null,null,{dojoType:"cancel",log:!1})})},"dojo/errors/create":function(){define(["../_base/lang"],function(u){return function(f,e,r,m){r=r||Error;var d=function(g){if(r===Error){Error.captureStackTrace&&Error.captureStackTrace(this,
d);var k=Error.call(this,g),l;for(l in k)k.hasOwnProperty(l)&&(this[l]=k[l]);this.message=g;this.stack=k.stack}else r.apply(this,arguments);e&&e.apply(this,arguments)};d.prototype=u.delegate(r.prototype,m);d.prototype.name=f;return d.prototype.constructor=d}})},"dojo/promise/Promise":function(){define(["../_base/lang"],function(u){function f(){throw new TypeError("abstract");}return u.extend(function(){},{then:function(e,r,m){f()},cancel:function(e,r){f()},isResolved:function(){f()},isRejected:function(){f()},
isFulfilled:function(){f()},isCanceled:function(){f()},"finally":function(e){return this.then(function(f){var m=e();return m&&"function"===typeof m.then?m.then(function(){return f}):f},function(f){var m=e();if(m&&"function"===typeof m.then)return m.then(function(){throw f;});throw f;})},always:function(e){return this.then(e,e)},"catch":function(e){return this.then(null,e)},otherwise:function(e){return this.then(null,e)},trace:function(){return this},traceRejected:function(){return this},toString:function(){return"[object Promise]"}})})},
"dojo/when":function(){define(["./Deferred","./promise/Promise"],function(u,f){return function(e,r,m,d){var g=e&&"function"===typeof e.then,k=g&&e instanceof f;if(!g)return 1<arguments.length?r?r(e):e:(new u).resolve(e);k||(g=new u(e.cancel),e.then(g.resolve,g.reject,g.progress),e=g.promise);return r||m||d?e.then(r,m,d):e}})},"dojo/_base/json":function(){define(["./kernel","../json"],function(u,f){u.fromJson=function(e){return eval("("+e+")")};u._escapeString=f.stringify;u.toJsonIndentStr="\t";u.toJson=
function(e,r){return f.stringify(e,function(e,d){return d&&(e=d.__json__||d.json,"function"==typeof e)?e.call(d):d},r&&u.toJsonIndentStr)};return u})},"dojo/json":function(){define(["./has"],function(u){return JSON})},"dojo/_base/Color":function(){define(["./kernel","./lang","./array","./config"],function(u,f,e,r){var m=u.Color=function(d){d&&this.setColor(d)};m.named={black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,
0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255],transparent:r.transparentColor||[0,0,0,0]};f.extend(m,{r:255,g:255,b:255,a:1,_set:function(d,g,k,e){this.r=d;this.g=g;this.b=k;this.a=e},setColor:function(d){f.isString(d)?m.fromString(d,this):f.isArray(d)?m.fromArray(d,this):(this._set(d.r,d.g,d.b,d.a),d instanceof m||this.sanitize());return this},sanitize:function(){return this},toRgb:function(){return[this.r,
this.g,this.b]},toRgba:function(){return[this.r,this.g,this.b,this.a]},toHex:function(){return"#"+e.map(["r","g","b"],function(d){d=this[d].toString(16);return 2>d.length?"0"+d:d},this).join("")},toCss:function(d){var g=this.r+", "+this.g+", "+this.b;return(d?"rgba("+g+", "+this.a:"rgb("+g)+")"},toString:function(){return this.toCss(!0)}});m.blendColors=u.blendColors=function(d,g,k,e){e=e||new m;e.r=Math.round(d.r+(g.r-d.r)*k);e.g=Math.round(d.g+(g.g-d.g)*k);e.b=Math.round(d.b+(g.b-d.b)*k);e.a=d.a+
(g.a-d.a)*k;return e.sanitize()};m.fromRgb=u.colorFromRgb=function(d,g){return(d=d.toLowerCase().match(/^rgba?\(([\s\.,0-9]+)\)/))&&m.fromArray(d[1].split(/\s*,\s*/),g)};m.fromHex=u.colorFromHex=function(d,g){var k=g||new m,l=4==d.length?4:8,c=(1<<l)-1;d=Number("0x"+d.substr(1));if(isNaN(d))return null;e.forEach(["b","g","r"],function(a){var b=d&c;d>>=l;k[a]=4==l?17*b:b});k.a=1;return k};m.fromArray=u.colorFromArray=function(d,g){g=g||new m;g._set(Number(d[0]),Number(d[1]),Number(d[2]),Number(d[3]));
isNaN(g.a)&&(g.a=1);return g.sanitize()};m.fromString=u.colorFromString=function(d,g){var k=m.named[d];return k&&m.fromArray(k,g)||m.fromRgb(d,g)||m.fromHex(d,g)};return m})},"dijit/main":function(){define(["dojo/_base/kernel"],function(u){return u.dijit})},"dojox/main":function(){define(["dojo/_base/kernel"],function(u){return u.dojox})},"esri/widgets/FeatureTemplates/FeatureTemplatesViewModel":function(){define("require exports tslib ../../core/Evented ../../core/HandleOwner ../../core/ObjectPool ../../core/watchUtils ../../core/accessorSupport/decorators ./TemplateItem ./TemplateItemGroup".split(" "),
function(u,f,e,r,m,d,g,k,l,c){var a=function(a){a=a.layer;return{key:a,label:a.title}},b=function(a){return a.layer.geometryType};return function(q){function v(a){a=q.call(this,a)||this;a._templateToLayer=new Map;a._itemPool=new d(l);a._groupPool=new d(c);a.filterFunction=null;a.groupBy="layer";return a}e.__extends(v,q);v.prototype.destroy=function(){this._templateToLayer.clear();this._templateToLayer=null};Object.defineProperty(v.prototype,"layers",{get:function(){return this._get("layers")},set:function(a){var b=
this;this.handles.removeAll();if(a){var c=function(){return b.notifyChange("state")};this.handles.add(a.map(function(a){return g.when(a,"loadStatus",c)}))}this._set("layers",a)},enumerable:!0,configurable:!0});Object.defineProperty(v.prototype,"state",{get:function(){var a=this.layers;return a&&0!==a.length?a.some(function(a){return"loading"===a.loadStatus||"not-loaded"===a.loadStatus})?"loading":"ready":"disabled"},enumerable:!0,configurable:!0});Object.defineProperty(v.prototype,"items",{get:function(){var c=
this,d=this.layers;this._destroyItems(this._get("items"));if(!d||0===d.length)return[];this._templateToLayer.clear();var d=d.filter(function(a){var b=a.capabilities;return a.loaded&&b.operations.supportsEditing&&b.operations.supportsAdd}).map(function(a){var b=c._getTemplatesForLayer(a);if(0<b.length)return b.forEach(function(b){return c._templateToLayer.set(b,a)}),b}).filter(function(a){return null!=a}),g=this.groupBy;if("none"===g)return d.map(function(a){return a.filter(function(a){a=a.name;return!c.filterFunction||
c.filterFunction({label:a})})}).map(function(a){return a.map(function(a){return c._createItem(a)})}).reduce(function(a,b){return e.__spreadArrays(a,b)},[]);d=d.reduce(function(d,q){q.forEach(function(q){var k=("layer"===g?a:"geometry"===g?b:g)({template:q,layer:c._templateToLayer.get(q)});if(k){var e="string"===typeof k?k:k.key,k="string"===typeof k?k:k.label;d.has(e)||d.set(e,{label:k,templates:[]});d.get(e).templates.push(q)}});return d},new Map);if(0===d.size)return[];var q=[],k=this.filterFunction;
d.forEach(function(a){var b=a.label,d=a.templates;!k||c.filterFunction(a)?q.push(c._createGroup(b,d.map(function(a){return c._createItem(a)}))):(a=d.filter(function(a){return c.filterFunction({label:a.name})}).map(function(a){return c._createItem(a)}),0<a.length&&q.push(c._createGroup(b,a)))});return q},enumerable:!0,configurable:!0});v.prototype.refresh=function(){this.notifyChange("items")};v.prototype.select=function(a){a=a.clone();this.emit("select",{item:a,template:a.template})};v.prototype._getTemplatesForLayer=
function(a){var b=a.templates||[];a=(a.types||[]).map(function(a){return a.templates}).reduce(function(a,b){return e.__spreadArrays(a,b)},[]);return e.__spreadArrays(b,a)};v.prototype._createItem=function(a){var b=this._itemPool.acquire();b.set({template:a,layer:this._templateToLayer.get(a)});return b};v.prototype._createGroup=function(a,b){var c=this._groupPool.acquire();c.set("label",a);c.items=b;return c};v.prototype._destroyItems=function(a){var b=this;a&&(a[0]instanceof l?a.forEach(function(a){return b._destroyItem(a)}):
a.forEach(function(a){return b._destroyGroup(a)}))};v.prototype._destroyGroup=function(a){var b=this;a.items.forEach(function(a){return b._itemPool.release(a)});a.items.length=0;this._groupPool.release(a)};v.prototype._destroyItem=function(a){this._itemPool.release(a)};e.__decorate([k.property()],v.prototype,"filterFunction",void 0);e.__decorate([k.property()],v.prototype,"groupBy",void 0);e.__decorate([k.property()],v.prototype,"layers",null);e.__decorate([k.property({dependsOn:["layers"]})],v.prototype,
"state",null);e.__decorate([k.property({dependsOn:["filterFunction","groupBy","layers","state"],readOnly:!0})],v.prototype,"items",null);return v=e.__decorate([k.subclass("esri.widgets.FeatureTemplates.FeatureTemplatesViewModel")],v)}(m.HandleOwnerMixin(r.EventedAccessor))})},"esri/widgets/FeatureTemplates/TemplateItem":function(){define("require exports tslib ../../Graphic ../../core/Accessor ../../core/HandleOwner ../../core/promiseUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../../symbols/support/symbolUtils @dojo/framework/shim/Promise".split(" "),
function(u,f,e,r,m,d,g,k,l,c){return function(a){function b(b){b=a.call(this,b)||this;b.description=null;b.label=null;b.layer=null;b.template=null;b.thumbnail=null;return b}e.__extends(b,a);d=b;b.prototype.initialize=function(){var a=this;this.handles.add(k.init(this,["layer.renderer","template"],function(){return a._set("thumbnail",null)}))};b.prototype.clone=function(){var a=this.thumbnail?this.thumbnail.cloneNode(!0):null,b=new d({layer:this.layer,template:this.template});b._set("thumbnail",a);
return b};b.prototype.fetchThumbnail=function(){return e.__awaiter(this,void 0,void 0,function(){var a,b;return e.__generator(this,function(d){switch(d.label){case 0:return this._get("thumbnail")?[2,g.resolve()]:[4,this._getPreviewSymbol()];case 1:return a=d.sent(),[4,c.renderPreviewHTML(a,{maxSize:36})];case 2:return b=d.sent(),this._set("thumbnail",b),[2]}})})};b.prototype._getPreviewSymbol=function(){return e.__awaiter(this,void 0,void 0,function(){var a,b,c,d,g,q;return e.__generator(this,function(k){switch(k.label){case 0:a=
this;b=a.layer;c=a.template;d=a.layer.renderer;if(!d)return[3,2];g=new r({attributes:c.prototype.attributes});return[4,d.getSymbolAsync(g)];case 1:if(q=k.sent())return[2,q];k.label=2;case 2:return[2,this._getFallbackSymbolFromGeometry(b)]}})})};b.prototype._getFallbackSymbolFromGeometry=function(a){a=a.geometryType;if("point"===a||"multipoint"===a)return(new Promise(function(a,b){u(["../../symbols/SimpleMarkerSymbol"],a,b)})).then(function(a){return new a});if("polyline"===a)return(new Promise(function(a,
b){u(["../../symbols/SimpleLineSymbol"],a,b)})).then(function(a){return new a});if("polygon"===a||"mesh"===a||"multipatch"===a)return(new Promise(function(a,b){u(["../../symbols/SimpleFillSymbol"],a,b)})).then(function(a){return new a})};var d;e.__decorate([l.property({aliasOf:"template.description"})],b.prototype,"description",void 0);e.__decorate([l.property({aliasOf:"template.name"})],b.prototype,"label",void 0);e.__decorate([l.property()],b.prototype,"layer",void 0);e.__decorate([l.property()],
b.prototype,"template",void 0);e.__decorate([l.property({readOnly:!0})],b.prototype,"thumbnail",void 0);return b=d=e.__decorate([l.subclass("esri.widgets.FeatureTemplates.TemplateItem")],b)}(d.HandleOwnerMixin(m))})},"esri/symbols/support/symbolUtils":function(){define("require exports tslib ../../core/compilerUtils ../../core/maybe ../../support/arcadeOnDemand ./previewCIMSymbol ./previewSymbol2D ./previewSymbol3D ./previewWebStyleSymbol ./utils @dojo/framework/shim/Promise".split(" "),function(u,
f,e,r,m,d,g,k,l,c,a){function b(a,d){switch(a.type){case "web-style":return c.previewWebStyleSymbol(a,b,d);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return l.previewSymbol3D(a,d);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return k.previewSymbol2D(a,d);case "cim":return g.previewCIMSymbol(a,d);default:r.neverReached(a)}}function q(a){return a&&"opacity"in a?a.opacity*q(a.parent):1}Object.defineProperty(f,
"__esModule",{value:!0});var v=null;f.renderDotDensityPreviewHTML=function(a,b,c){var d=a.backgroundColor,g=a.outline;a=a.dotSize;var q=c&&c.swatchSize||22,k=Math.round(q*q/Math.pow(a,2)*.8),e=window.devicePixelRatio;c=document.createElement("canvas");var t=q*e;c.width=t;c.height=t;c.style.width=c.width/e+"px";c.style.height=c.height/e+"px";var l=c.getContext("2d");d&&(l.fillStyle=d.toCss(!0),l.fillRect(0,0,t,t),l.fill());l.fillStyle=b.toCss(!0);if(v&&v.length/2===k)for(b=0;b<2*k;b+=2){var d=v[b],
x=v[b+1];l.fillRect(d,x,a*e,a*e);l.fill()}else for(v=[],b=0;b<2*k;b+=2)d=Math.floor(Math.random()*(t-0+1)+0),x=Math.floor(Math.random()*(t-0+1)+0),v.push(d,x),l.fillRect(d,x,a*e,a*e),l.fill();g&&(g.color&&(l.strokeStyle=g.color.toCss(!0)),l.lineWidth=g.width,l.strokeRect(0,0,t,t));g=new Image(q,q);g.src=c.toDataURL();return g};f.renderColorRampPreviewHTML=function(a,b){void 0===b&&(b={});var c="horizontal"===b.align,d=b.width,d=void 0===d?c?75:24:d,g=b.height,g=void 0===g?c?24:75:g;b=b.gradient;var q=
void 0===b?!0:b;b=window.devicePixelRatio;var k=d*b,e=g*b;b=document.createElement("canvas");b.width=k;b.height=e;b.style.width=d+"px";b.style.height=g+"px";var t=b.getContext("2d"),l=c?k:0,v=c?0:e;if(q){var x=t.createLinearGradient(0,0,l,v),f=1/(a.length-1);a.forEach(function(a,b){return x.addColorStop(b*f,a.toString())});t.fillStyle=x;t.fillRect(0,0,k,e)}else for(q=c?k/a.length:k,k=c?e:e/a.length,v=l=e=0;v<a.length;v++)t.fillStyle=a[v].toString(),t.fillRect(e,l,q,k),e=c?e+q:0,l=c?0:l+k;a=document.createElement("div");
a.style.width=d+"px";a.style.height=g+"px";a.appendChild(b);return a};f.renderPreviewHTML=b;f.getDisplayedSymbol=function(b,c){return e.__awaiter(this,void 0,void 0,function(){var g,k,t,l,v,x,f,r,M,R,T,O,L,Q,S,aa,ba,V,Z,ha,X,ea,ga;return e.__generator(this,function(z){switch(z.label){case 0:if(!b)return[2,void 0];g=q(b.layer||b.sourceLayer);return!m.isSome(b.symbol)||m.isSome(c)&&!0===c.ignoreGraphicSymbol?[3,4]:"web-style"!==b.symbol.type?[3,2]:[4,b.symbol.fetchSymbol(m.isSome(c)?c.abortOptions:
null)];case 1:return t=z.sent(),[3,3];case 2:t=b.symbol.clone(),z.label=3;case 3:return k=t,a.applyColorToSymbol(k,null,g),[2,k];case 4:return l=m.isSome(c)&&c.renderer||b.get("layer.renderer")||b.get("sourceLayer.renderer"),[4,l.getSymbolAsync(b)];case 5:return(v=z.sent())?"web-style"!==v.type?[3,7]:[4,v.fetchSymbol(m.isSome(c)?c.abortOptions:null)]:[2,void 0];case 6:return v=z.sent(),[3,8];case 7:v=v.clone(),z.label=8;case 8:if(!("visualVariables"in l)||"visualVariables"in l&&!l.visualVariables||
"visualVariables"in l&&l.visualVariables&&!l.visualVariables.length)return[2,v];if(!l.arcadeRequiredForVisualVariables||!m.isNone(c)&&!m.isNone(c.arcade))return[3,10];f=x=e.__assign({},m.unwrap(c));return[4,d.loadArcade()];case 9:f.arcade=z.sent(),c=x,z.label=10;case 10:return[4,new Promise(function(a,b){u(["../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 11:r=z.sent();M=[];R=[];T=[];O=[];L=0;for(Q=l.visualVariables;L<Q.length;L++)switch(S=Q[L],S.type){case "color":M.push(S);
break;case "opacity":R.push(S);break;case "rotation":O.push(S);break;case "size":S.target||T.push(S)}ba=(aa=!!M.length&&M[M.length-1])?r.getColor(aa,b,c):null;Z=(V=!!R.length&&R[R.length-1])?r.getOpacity(V,b,c):null;null!=g&&(Z=null!=Z?Z*g:g);a.applyColorToSymbol(v,ba,Z);if(!T.length)return[3,13];ha=r.getAllSizes(T,b,c);return[4,a.applySizesToSymbol(v,ha)];case 12:z.sent(),z.label=13;case 13:X=0;for(ea=O;X<ea.length;X++)ga=ea[X],a.applyRotationToSymbol(v,r.getRotationAngle(ga,b,c),ga.axis);return[2,
v]}})})}})},"esri/symbols/support/previewCIMSymbol":function(){define(["require","exports","tslib","../cim/CIMSymbolRasterizer"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});var m=new r.CIMSymbolRasterizer(null,!0);f.previewCIMSymbol=function(d,g){void 0===g&&(g={});return e.__awaiter(this,void 0,void 0,function(){var k,l,c,a,b,q,v,t,x,f,r,E;return e.__generator(this,function(e){switch(e.label){case 0:return k=g.size,l=g.maxSize,c=g.feature,a=g.fieldMap,b=g.geometryType,q=g.style,
v=Math.min(k||22,l||120),t=3,d&&d.data&&d.data.symbol&&"CIMPointSymbol"!==d.data.symbol.type&&(t=1),[4,m.rasterizeCIMSymbolAsync(d,c,a,b,{targetSize:v*t,style:q})];case 1:return x=e.sent(),f=document.createElement("canvas"),f.width=x.imageData.width,f.height=x.imageData.height,r=f.getContext("2d"),r.putImageData(x.imageData,0,0),E=new Image(f.width/t,f.height/t),E.src=f.toDataURL(),[2,E]}})})}})},"esri/symbols/cim/CIMSymbolRasterizer":function(){define("require exports tslib ../../request ../../core/promiseUtils ../../core/screenUtils ../../core/string ../../geometry/support/jsonUtils ./cimAnalyzer ./cimSymbolUtils ./Rasterizer ./TextRasterizer ./utils ../support/Symbol3DAnchorPosition2D".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v){function t(a){return(a?Object.keys(a):[]).map(function(b){return{name:b,alias:b,type:"string"===typeof a[b]?"esriFieldTypeString":"esriFieldTypeDouble"}})}function x(a){if(!(a&&a.data&&a.data.symbol))return null;switch(a.data.symbol.type){case "CIMPointSymbol":case "CIMTextSymbol":return"esriGeometryPoint";case "CIMLineSymbol":return"esriGeometryPolyline";case "CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function z(a,b,c,d){if("function"===
typeof a.materialHash){var g=a.materialHash;b=g(b,c,d);a=l.analyzeCIMResource(a.cim,a.materialOverrides)}else b=a.materialHash,a=a.cim;return{analyzedCIM:a,hash:b}}Object.defineProperty(f,"__esModule",{value:!0});var A;(function(a){a.Legend="legend";a.Preview="preview"})(A=f.GeometryStyle||(f.GeometryStyle={}));var E=function(a,b,c){if(a&&a.targetSize){var g=void 0;return g=c?a.targetSize/d.pt2px(Math.max(c.frame.xmax-c.frame.xmin,c.frame.ymax-c.frame.ymin)):a.targetSize/b.referenceSize}return a?
a.scaleFactor:1},H={fill:{legend:{frame:{xmax:15,xmin:0,ymax:15,ymin:0},geometry:{rings:[[[0,15],[15,7.5],[15,0],[0,0],[0,15]]]},canvasPaths:{rings:[[[0,15],[0,0],[15,7.5],[15,15],[0,15]]]}},preview:{frame:{xmax:100,xmin:0,ymax:100,ymin:0},geometry:{rings:[[[0,100],[100,100],[100,0],[0,0],[0,100]]]},canvasPaths:{rings:[[[0,100],[0,0],[100,0],[100,100],[0,100]]]}}},stroke:{legend:{frame:{xmax:24,xmin:0,ymax:-2,ymin:2},geometry:{paths:[[[0,0],[12,0],[24,0]]]},canvasPaths:{paths:[[[0,2],[12,2],[24,2]]]}},
preview:{frame:{xmax:100,xmin:0,ymax:-2,ymin:2},geometry:{paths:[[[0,0],[50,0],[100,0]]]},canvasPaths:{paths:[[[0,2],[50,2],[100,2]]]}}}};u=function(){function f(c,d){this._spatialReference=c;this._avoidSDF=d;this._resourceCache=new Map;this._rasterizer=new a.default;this._textRasterizer=new b.default;this._pictureMarkerCache=new Map}f.prototype.rasterizeCIMSymbolAsync=function(a,b,c,d,g,q,l,v){return e.__awaiter(this,void 0,void 0,function(){var f;return e.__generator(this,function(e){switch(e.label){case 0:return d=
d||(b?null!=b.centroid?"esriGeometryPolygon":k.getJsonType(b.geometry):null)||x(a),[4,this.analyzeCIMSymbol(a,b?t(b.attributes):null,c,d,v)];case 1:return f=e.sent(),[2,this.rasterizeCIMSymbol(f,b,d,g,q,l)]}})})};f.prototype.analyzeCIMSymbol=function(a,b,d,g,k){return e.__awaiter(this,void 0,void 0,function(){var t,v,x,f,z,r,A;return e.__generator(this,function(e){switch(e.label){case 0:return[4,c.fetchSymbol(a,k)];case 1:return t=e.sent(),v=[],b?x={geometryType:g,spatialReference:this._spatialReference,
fields:b}:(t=t.clone(),"CIMSymbolReference"===t.data.type&&(t.data.primitiveOverrides=[],x=null)),[4,l.analyzeCIMSymbol(t.data,x,v,this._avoidSDF)];case 2:e.sent();m.throwIfAborted(k);z=0;for(r=v;z<r.length;z++){A=r[z];if("CIMPictureMarker"===A.cim.type||"CIMPictureFill"===A.cim.type||"CIMPictureStroke"===A.cim.type)f||(f=[]),f.push(this.fetchPictureMarkerResource(A,k));d&&"text"===A.type&&"string"===typeof A.text&&-1<A.text.indexOf("[")&&(A.text=q.createLabelOverrideFunction(d,A.text,A.cim.textCase))}return f?
[4,m.all(f)]:[3,4];case 3:e.sent(),e.label=4;case 4:return[2,v]}})})};f.prototype.fetchPictureMarkerResource=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d,g;return e.__generator(this,function(q){switch(q.label){case 0:return c=a.materialHash,this._pictureMarkerCache.get(c)?[3,2]:[4,r(a.cim.url,{responseType:"image",signal:b&&b.signal})];case 1:d=q.sent(),g=d.data,this._pictureMarkerCache.set(c,g),q.label=2;case 2:return[2]}})})};f.prototype.rasterizeCIMSymbol=function(a,b,
c,d,g,k){for(var e=[],t=0;t<a.length;t++){var l=a[t];d&&"function"===typeof d.scaleFactor&&(d.scaleFactor=d.scaleFactor(b,g,k));var v=this._getRasterizedResource(l,b,c,d,g,k);if(v){var x=0,f=v.anchorX||0,z=v.anchorY||0,m=!1,r=0,A=0;if("esriGeometryPoint"===c)if(A=E(d,l,null),r=q.evaluateValueOrFunction(l.offsetX,b,g,k)*A||0,A=q.evaluateValueOrFunction(l.offsetY,b,g,k)*A||0,"marker"===l.type)x=q.evaluateValueOrFunction(l.rotation,b,g,k)||0,m=l.rotateClockwise?l.rotateClockwise:!1;else if("text"===
l.type){x=q.evaluateValueOrFunction(l.angle,b,g,k)||0;if(void 0!==l.horizontalAlignment)switch(l.horizontalAlignment){case "left":f=-.5;break;case "right":f=.5;break;default:f=0}if(void 0!==l.verticalAlignment)switch(l.verticalAlignment){case "top":z=.5;break;case "bottom":z=-.5;break;case "baseline":z=-.25;break;default:z=0}}null!=v&&e.push({angle:x,rotateClockWise:m,anchorX:f,anchorY:z,offsetX:r,offsetY:A,rasterizedResource:v})}}return this.getSymbolImage(e)};f.prototype.getSymbolImage=function(a){for(var b=
document.createElement("canvas"),c=b.getContext("2d"),g=0,q=0,k=0,e=0,t=[],l=0;l<a.length;l++){var x=a[l],f=x.rasterizedResource;if(f){var z=f.size,m=x.offsetX,r=x.offsetY,A=x.anchorX,H=x.anchorY,E=x.rotateClockWise||!1,x=x.angle,B=d.pt2px(m)-z[0]*(.5+A),J=d.pt2px(r)-z[1]*(.5+H),u=B+z[0],da=J+z[1];if(x){E&&(x=-x);var ma=Math.sin(x*Math.PI/180),fa=Math.cos(x*Math.PI/180),z=B*fa-J*ma,la=B*ma+J*fa,ia=B*fa-da*ma,ca=B*ma+da*fa,C=u*fa-da*ma,da=u*ma+da*fa,na=u*fa-J*ma,ma=u*ma+J*fa,B=Math.min(z,ia,C,na),
J=Math.min(la,ca,da,ma),u=Math.max(z,ia,C,na),da=Math.max(la,ca,da,ma)}g=B<g?B:g;q=J<q?J:q;k=u>k?u:k;e=da>e?da:e;B=c.createImageData(f.size[0],f.size[1]);B.data.set(new Uint8ClampedArray(f.image.buffer));f={offsetX:m,offsetY:r,rotateClockwise:E,angle:x,rasterizedImage:B,anchorX:A,anchorY:H};t.push(f)}}b.width=k-g;b.height=e-q;a=-g;for(l=0;l<t.length;l++)f=t[l],g=this._imageDataToCanvas(f.rasterizedImage),q=a-f.rasterizedImage.width*(.5+f.anchorX),k=e-f.rasterizedImage.height*(.5-f.anchorY),f.angle?
(m=(360-f.angle)*Math.PI/180,c.save(),c.translate(d.pt2px(f.offsetX),-d.pt2px(f.offsetY)),c.translate(a,e),c.rotate(m),c.translate(-a,-e),c.drawImage(g,q,k),c.restore()):c.drawImage(g,q+d.pt2px(f.offsetX),k-d.pt2px(f.offsetY));t=new v.default({x:a/b.width-.5,y:e/b.height-.5});return{imageData:0!==b.width&&0!==b.height?c.getImageData(0,0,b.width,b.height):c.createImageData(1,1),anchorPosition:t}};f.prototype._imageDataToCanvas=function(a){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));
var b=this._imageDataCanvas,c=b.getContext("2d");b.width=a.width;b.height=a.height;c.putImageData(a,0,0);return b};f.prototype._imageTo32Array=function(a,b,c){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));var d=this._imageDataCanvas,g=d.getContext("2d");d.width=b;d.height=c;g.drawImage(a,0,0,b,c);return new Uint32Array(g.getImageData(0,0,b,c).data.buffer)};f.prototype._getRasterizedResource=function(a,b,c,d,k,e){var t,l,v;if("esriGeometryPolyline"===c||"esriGeometryPolygon"===
c)if(t=d&&d.style?d.style:A.Legend,t="esriGeometryPolyline"===c?H.stroke[t]:H.fill[t],"line"===a.type)if("CIMSolidStroke"===a.cim.type)a=z(a,b,k,e),l=a.analyzedCIM,v=a.hash,l=this._embedCIMLayerInVectorMarker(l,t);else return"CIMPictureStroke"===a.cim.type?(l=q.evaluateValueOrFunction(a.width,b,k,e),v=d=c=void 0,b=this._getPictureResource(a,l),c=b.image,d=b.width,v=b.height,this._rasterizePictureResource(a,c,d,v,t,l)):null;else if("marker"===a.type)if("CIMPictureMarker"!==a.cim.type&&"CIMVectorMarker"===
a.cim.type)a.cim.offsetX=q.evaluateValueOrFunction(a.offsetX,b,k,e),a.cim.offsetY=q.evaluateValueOrFunction(a.offsetY,b,k,e),a.cim.rotation=q.evaluateValueOrFunction(a.rotation,b,k,e),a.cim.markerPlacement=a.markerPlacement,l=z(a,b,k,e).analyzedCIM,v=g.numericHash(JSON.stringify(l)).toString(),l=this._embedCIMLayerInVectorMarker(l,t);else return null;else{if("text"===a.type)return null;if("fill"===a.type){if("CIMHatchFill"===a.cim.type||"CIMVectorMarker"===a.cim.type||"CIMPictureMarker"===a.cim.type||
"CIMPictureFill"===a.cim.type)return l=a.cim.size||a.cim.height,v=d=c=void 0,"CIMPictureMarker"===a.cim.type||"CIMPictureFill"===a.cim.type?(b=this._getPictureResource(a,l),c=b.image,d=b.width,v=b.height):(b=z(a,b,k,e),l=b.analyzedCIM,v=b.hash,b=this._rasterizer.rasterizeJSONResource(l,this._avoidSDF),c=b.image,d=b.size[0],v=b.size[1]),this._rasterizePictureResource(a,c,d,v,t,null);if("CIMSolidFill"===a.cim.type)a=z(a,b,k,e),l=a.analyzedCIM,v=a.hash,l=this._embedCIMLayerInVectorMarker(l,t);else return null}}else{if("text"===
a.type)return t=this._rasterizeTextResource(a,b,d,k,e);t=z(a,b,k,e);l=t.analyzedCIM;v=t.hash;t=E(d,a,null);if("CIMPictureMarker"===a.cim.type)return l=q.evaluateValueOrFunction(a.size,b,k,e)*t,t=this._getPictureResource(a,l),c=t.image,d=t.width,v=t.height,t={image:c,size:[d,v],sdf:!1,simplePattern:!1,anchorX:a.anchorPoint?a.anchorPoint.x:0,anchorY:a.anchorPoint?a.anchorPoint.y:0};l.size*=t}v+=c;d&&(v+=JSON.stringify(d));a=this._resourceCache;if(a.has(v))return a.get(v);t=this._rasterizer.rasterizeJSONResource(l,
this._avoidSDF);a.set(v,t);return t};f.prototype._rasterizeTextResource=function(a,b,c,d,g){var k=E(c,a,null);c=q.evaluateValueOrFunction(a.text,b,d,g);if(!c||0===c.length)return null;var e=q.evaluateValueOrFunction(a.fontName,b,d,g),t=q.evaluateValueOrFunction(a.style,b,d,g),l=q.evaluateValueOrFunction(a.weight,b,d,g),v=q.evaluateValueOrFunction(a.decoration,b,d,g),k=q.evaluateValueOrFunction(a.size,b,d,g)*k,f=q.evaluateValueOrFunction(a.horizontalAlignment,b,d,g),x=q.evaluateValueOrFunction(a.verticalAlignment,
b,d,g),z=q.colorToArray(q.evaluateValueOrFunction(a.color,b,d,g)),m=q.colorToArray(q.evaluateValueOrFunction(a.outlineColor,b,d,g));a=q.evaluateValueOrFunction(a.outlineSize,b,d,g);return this._textRasterizer.rasterizeText(c,{color:z,size:k,horizontalAlignment:f,verticalAlignment:x,font:{family:e,style:t,weight:l,decoration:v},halo:{size:a||0,color:m,style:t},pixelRatio:1,premultiplyColors:!this._avoidSDF})};f.prototype._rasterizePictureResource=function(a,b,c,g,q,e){var t=document.createElement("canvas"),
l=t.getContext("2d");t.height=d.pt2px(Math.max(Math.abs(q.frame.ymax-q.frame.ymin),e));t.width=d.pt2px(Math.abs(q.frame.xmax-q.frame.xmin));c=l.createImageData(c,g);c.data.set(new Uint8ClampedArray(b.buffer));b=this._imageDataToCanvas(c);b=l.createPattern(b,"repeat");c=Math.cos((-a.cim.rotation||0)*Math.PI/180);g=Math.sin((-a.cim.rotation||0)*Math.PI/180);b.setTransform({m11:c,m12:g,m21:-g,m22:c,m41:d.pt2px(a.cim.offsetX)||0,m42:d.pt2px(a.cim.offsetY)||0});a=q.canvasPaths;var v,f,x;k.isPolygon(a)?
(v=a.rings,l.fillStyle=b,f=l.fill,x=["evenodd"]):k.isPolyline(a)&&(v=a.paths,l.strokeStyle=b,l.lineWidth=e,f=l.stroke,v[0][0][1]=t.height/2,v[0][1][1]=t.height/2);l.beginPath();for(e=0;e<v.length;e++)if(q=(a=v[e])?a.length:0,1<q){b=a[0];l.moveTo(d.pt2px(b[0]),d.pt2px(b[1]));for(c=1;c<q;++c)b=a[c],l.lineTo(d.pt2px(b[0]),d.pt2px(b[1]));l.closePath()}f.apply(l,x);l=l.getImageData(0,0,t.width,t.height);l=new Uint8Array(l.data);return{size:[t.width,t.height],image:new Uint32Array(l.buffer),sdf:!1,simplePattern:!1,
anchorX:0,anchorY:0}};f.prototype._getPictureResource=function(a,b){a=this._pictureMarkerCache.get(a.materialHash);if(!a)return null;var c=a.height/a.width,g=b?1<c?d.pt2px(b):d.pt2px(b)/c:a.width;b=b?1<c?d.pt2px(b)*c:d.pt2px(b):a.height;return{image:this._imageTo32Array(a,g,b),width:g,height:b}};f.prototype._embedCIMLayerInVectorMarker=function(a,b){var c=k.isPolygon(b.geometry)?"CIMPolygonSymbol":"CIMLineSymbol";return{type:"CIMVectorMarker",frame:b.frame,markerGraphics:[{type:"CIMMarkerGraphic",
geometry:b.geometry,symbol:{type:c,symbolLayers:[a]}}]}};return f}();f.CIMSymbolRasterizer=u})},"esri/symbols/cim/Rasterizer":function(){define("require exports ./CIMSymbolHelper ./Rect ./SDFHelper ./utils".split(" "),function(u,f,e,r,m,d){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function g(){}g.prototype.dispose=function(){this._rasterizationCanvas=null};g.prototype.rasterizeJSONResource=function(d,g){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));
if("simple-fill"===d.type||"esriSFS"===d.type)return g=e.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,d.style),{size:[g[1],g[2]],image:new Uint32Array(g[0].buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0};if("simple-line"===d.type||"esriSLS"===d.type)return g=e.SymbolHelper.rasterizeSimpleLine(d.style,d.cap),{size:[g[1],g[2]],image:new Uint32Array(g[0].buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0};var c,a;"simple-marker"===d.type||"esriSMS"===d.type||"line-marker"===d.type?
(d=e.CIMSymbolHelper.fromSimpleMarker(d),a=m.getSDFInfo(d)):"CIMHatchFill"===d.type?(d=e.CIMSymbolHelper.fromCIMHatchFill(d),c=new r.default(d.frame.xmin,-d.frame.ymax,d.frame.xmax-d.frame.xmin,d.frame.ymax-d.frame.ymin)):d.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===d.markerPlacement.type?(d=e.CIMSymbolHelper.fromCIMInsidePolygon(d),c=new r.default(d.frame.xmin,-d.frame.ymax,d.frame.xmax-d.frame.xmin,d.frame.ymax-d.frame.ymin)):a=m.getSDFInfo(d);if(a&&!g)return g=m.buildSDF(a),(c=g[0])?
{size:[g[1],g[2]],image:new Uint32Array(c.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null;g=e.CIMSymbolHelper.rasterize(this._rasterizationCanvas,d,c,!g);c=g[0];a=g[3];d=g[4];return c?{size:[g[1],g[2]],image:new Uint32Array(c.buffer),sdf:!1,simplePattern:!1,anchorX:a,anchorY:d}:null};g.prototype.rasterizeImageResource=function(g,e){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=g.width;this._rasterizationCanvas.height=
g.height;var c=this._rasterizationCanvas.getContext("2d");g instanceof ImageData?c.putImageData(g,0,0):(g.setAttribute("width",g.width.toString()),g.setAttribute("height",g.height.toString()),c.drawImage(g,0,0,g.width,g.height));c=c.getImageData(0,0,g.width,g.height);c=new Uint8Array(c.data);if(e)for(var a=0;a<e.length;a++){var b=e[a];if(b&&b.oldColor&&4===b.oldColor.length&&b.newColor&&4===b.newColor.length){var q=b.oldColor,k=q[0],t=q[1],l=q[2],q=q[3],f=b.newColor,b=f[0],m=f[1],r=f[2],H=f[3];if(k!==
b||t!==m||l!==r||q!==H)for(f=0;f<c.length;f+=4)k===c[f]&&t===c[f+1]&&l===c[f+2]&&q===c[f+3]&&(c[f]=b,c[f+1]=m,c[f+2]=r,c[f+3]=H)}}for(f=0;f<c.length;f+=4)e=c[f+3]/255,c[f]*=e,c[f+1]*=e,c[f+2]*=e;e=g.width;a=g.height;k=c;if(512<=e||512<=a)k=g.width/g.height,1<k?(e=512,a=Math.round(512/k)):(a=512,e=Math.round(512*k)),k=new Uint8Array(4*e*a),d.resampleHermite(c,g.width,g.height,new Uint8ClampedArray(k.buffer),e,a,!1);return{size:[e,a],image:new Uint32Array(k.buffer),sdf:!1,simplePattern:!1,anchorX:0,
anchorY:0}};return g}();f.default=u})},"esri/symbols/cim/TextRasterizer":function(){define(["require","exports","../../core/screenUtils"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function d(){}d.prototype.rasterizeText=function(d,e){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));var g=this._textRasterizationCanvas,c=g.getContext("2d");this.setFontProperties(c,e);this.parameters=e;this.textLines=d.split(/\r?\n/);
this.lineHeight=this.computeLineHeight();d=this.computeTextWidth(c,e);var a=this.lineHeight*this.textLines.length;g.width=d;g.height=a;this.renderedLineHeight=Math.round(this.lineHeight*e.pixelRatio);this.renderedHaloSize=e.halo.size*e.pixelRatio;this.renderedWidth=d*e.pixelRatio;this.renderedHeight=a*e.pixelRatio;g=e.color;this.fillStyle="rgba("+g.slice(0,3).toString()+","+g[3]+")";this.haloStyle="rgb("+e.halo.color.slice(0,3).toString()+")";var g=this.renderedLineHeight,b=this.renderedHaloSize;
this.setFontProperties(c,e);d=c.textAlign;var a=this.renderedWidth,q=("center"===d?.5*a:"right"===d?a:0)+b,a=d=0;0<b&&this.renderHalo(c,q,b,d,a,e);a+=b;d+=q;b=0;for(q=this.textLines;b<q.length;b++){var k=q[b];c.globalCompositeOperation="destination-out";c.fillStyle="rgb(0, 0, 0)";c.fillText(k,d,a);c.globalCompositeOperation="source-over";c.fillStyle=this.fillStyle;c.fillText(k,d,a);a+=g}c=c.getImageData(0,0,this.renderedWidth,this.renderedHeight);c=new Uint8Array(c.data);if(e.premultiplyColors)for(e=
void 0,g=0;g<c.length;g+=4)e=c[g+3]/255,c[g]*=e,c[g+1]*=e,c[g+2]*=e;return{size:[this.renderedWidth,this.renderedHeight],image:new Uint32Array(c.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};d.prototype.renderHalo=function(d,e,l,c,a,b){var g=this.renderedWidth,k=this.renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas"));this._haloRasterizationCanvas.width=g;this._haloRasterizationCanvas.height=k;var t=this._haloRasterizationCanvas,f=
t.getContext("2d");f.clearRect(0,0,g,k);this.setFontProperties(f,b);f.fillStyle=this.haloStyle;f.strokeStyle=this.haloStyle;b=3>this.renderedHaloSize;f.lineJoin=b?"miter":"round";b?this.renderHaloEmulated(f,e,l):this.renderHaloNative(f,e,l);d.globalAlpha=this.parameters.halo.color[3];d.drawImage(t,0,0,g,k,c,a,g,k);d.globalAlpha=1};d.prototype.renderHaloEmulated=function(d,e,l){for(var c=this.renderedLineHeight,a=this.renderedHaloSize,b=0,g=this.textLines;b<g.length;b++){for(var k=g[b],t=0,f=r;t<f.length;t++){var z=
f[t];d.fillText(k,e+a*z[0],l+a*z[1])}l+=c}};d.prototype.renderHaloNative=function(d,e,l){for(var c=this.renderedLineHeight,a=this.renderedHaloSize,b=0,g=this.textLines;b<g.length;b++){for(var k=g[b],t=2*a,f=0;5>f;f++)d.lineWidth=(.6+.1*f)*t,d.strokeText(k,e,l);l+=c}};d.prototype.setFontProperties=function(d,k){var g=k.font;k=g.style+" "+g.weight+" "+e.pt2px(k.size*k.pixelRatio)+"px "+g.family+", sans-serif";d.font=k;d.textAlign="left";d.textBaseline="top"};d.prototype.computeTextWidth=function(d,
e){for(var g=0,c=0,a=this.textLines;c<a.length;c++)g=Math.max(g,d.measureText(a[c]).width);e=e.font;if("italic"===e.style||"oblique"===e.style||"string"===typeof e.weight&&("bold"===e.weight||"bolder"===e.weight)||"number"===typeof e.weight&&600<e.weight)g+=.3*d.measureText("A").width;g+=2*this.parameters.halo.size;return Math.round(g)};d.prototype.computeLineHeight=function(){return Math.round(1.275*this.parameters.size+2*this.parameters.halo.size)};return d}();f.TextRasterizer=u;for(var r=[],m=
0;360>m;m+=22.5)r.push([Math.cos(Math.PI*m/180),Math.sin(Math.PI*m/180)]);f.default=u})},"esri/symbols/support/previewSymbol2D":function(){define("require exports ../../core/Error ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./previewUtils ./renderUtils".split(" "),function(u,f,e,r,m,d,g,k){function l(b,c){var d=a.getContext("2d"),g=[];c&&(c.weight&&g.push(c.weight),c.size&&g.push(c.size+"px"),c.family&&g.push(c.family));d.font=g.join(" ");return d.measureText(b).width}function c(a){if(0===
a.length)return 0;if(2<a.length){var c=m.px2pt(1),d=parseFloat(a);switch(a.slice(-2)){case "px":return d;case "pt":return d*c;case "in":return 72*d*c;case "pc":return 12*d*c;case "mm":return d*b*c;case "cm":return d*q*c}}return parseFloat(a)}Object.defineProperty(f,"__esModule",{value:!0});var a=document.createElement("canvas"),b=7.2/2.54,q=72/2.54;f.previewSymbol2D=function(a,b){var q=b&&b.size?m.pt2px(b.size):null,t=b&&b.maxSize?m.pt2px(b.maxSize):null,f=b&&null!=b.opacity?b.opacity:null,v=b&&null!=
b.rotation?b.rotation:null,H=d.getStroke(a),J={shape:null,fill:null,stroke:H};H&&H.width&&(H.width=Math.min(H.width,80));var B=0,G=0;switch(a.type){case "simple-marker":var H=a.style,F=m.pt2px(a.size),B=Math.min(q||F||22,t||120),G=Math.min(q||F||22,t||120);switch(H){case "circle":J.shape={type:"circle",cx:.5*F,cy:.5*F,r:.5*F};break;case "cross":J.shape={type:"path",path:[{command:"M",values:[0,.5*G]},{command:"L",values:[B,.5*G]},{command:"M",values:[.5*B,0]},{command:"L",values:[.5*B,G]}]};break;
case "diamond":J.shape={type:"path",path:[{command:"M",values:[0,.5*G]},{command:"L",values:[.5*B,0]},{command:"L",values:[B,.5*G]},{command:"L",values:[.5*B,G]},{command:"Z",values:[]}]};break;case "square":J.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[B,0]},{command:"L",values:[B,G]},{command:"L",values:[0,G]},{command:"Z",values:[]}]};break;case "triangle":J.shape={type:"path",path:[{command:"M",values:[.5*B,0]},{command:"L",values:[B,G]},{command:"L",values:[0,G]},
{command:"Z",values:[]}]};break;case "x":J.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[B,G]},{command:"M",values:[B,0]},{command:"L",values:[0,G]}]};break;case "path":J.shape={type:"path",path:a.path||""}}break;case "simple-line":q=Math.min(q||H&&H.width||22,t||80);H.width=q;B=22<q?2*q:40;G=q;J.shape={type:"path",path:[{command:"M",values:[0,G]},{command:"L",values:[B,G]}]};break;case "picture-fill":case "simple-fill":B=Math.min(q||22,t||120);G=Math.min(q||22,t||120);
J.shape=g.shapes.fill[0];break;case "picture-marker":var H=m.pt2px(a.width),M=m.pt2px(a.height),F=Math.max(H,M),M=H/M,H=1>=M?Math.ceil(F*M):F,M=1>=M?F:Math.ceil(F/M),B=Math.min(q||H||22,t||120),G=Math.min(q||M||22,t||120);J.shape={type:"image",x:-Math.round(B/2),y:-Math.round(G/2),width:B,height:G,src:a.url||""};break;case "text":H=a.text||"Aa",F=a.font,q=Math.min(q||m.pt2px(F.size),t||120),M=l(H,{weight:F.weight,size:q,family:F.family}),B=(t=/[\uE600-\uE6FF]/.test(H))?q:M,G=q,M=.25*c((F?q:0).toString()),
t&&(M+=5),J.shape={type:"text",text:H,x:0,y:M,align:"middle",decoration:F&&F.decoration,rotated:a.rotated,kerning:a.kerning},J.font=F&&{size:q,style:F.style,decoration:F.decoration,weight:F.weight,family:F.family}}if(!J.shape)return r.reject(new e("symbolPreview: renderPreviewHTML2D","symbol not supported."));var R=d.getFill(a),q=a.color,t=null;R&&"pattern"===R.type&&q&&"picture-fill"!==a.type?t=d.getPatternUrlWithColor(R.src,q.toCss(!0)).then(function(a){R.src=a;J.fill=R;return J}):(J.fill=R,t=r.resolve(J));
return t.then(function(a){return k.renderSymbol([[a]],[B,G],{node:b&&b.node,scale:!0,opacity:f,rotation:v})})}})},"esri/symbols/support/gfxUtils":function(){define("require exports ../../assets ../../Color ../../request ../../core/ItemCache ../../core/promiseUtils ../../core/screenUtils ./cimSymbolUtils".split(" "),function(u,f,e,r,m,d,g,k,l){function c(a){if(!a)return null;var b;switch(a.type){case "simple-fill":case "picture-fill":case "simple-marker":b=c(a.outline);break;case "simple-line":var d=
k.pt2px(a.width);"none"!==a.style&&0!==d&&(b={color:a.color,style:t(a.style),width:d,cap:a.cap,join:"miter"===a.join?k.pt2px(a.miterLimit):a.join});break;default:b=null}return b}Object.defineProperty(f,"__esModule",{value:!0});var a=e.getAssetUrl("../../symbols/patterns/"),b={left:"start",center:"middle",right:"end",justify:"start"},q={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},v=new d(1E3);f.getSVGAlign=function(a){return a=(a=a.horizontalAlignment)&&
b[a.toLowerCase()]||"middle"};f.getSVGBaseline=function(a){return(a=a.verticalAlignment)&&q[a.toLowerCase()]||"alphabetic"};f.getSVGBaselineShift=function(a){return"bottom"===a.verticalAlignment?"super":null};f.getFill=function(b){var c=b.style,d=null;if(b)switch(b.type){case "simple-marker":"cross"!==c&&"x"!==c&&(d=b.color);break;case "simple-fill":"solid"===c?d=b.color:"none"!==c&&(d={type:"pattern",x:0,y:0,src:a+c+".png",width:8,height:8});break;case "picture-fill":d={type:"pattern",src:b.url,
width:k.pt2px(b.width)*b.xscale,height:k.pt2px(b.height)*b.yscale,x:k.pt2px(b.xoffset),y:k.pt2px(b.yoffset)};break;case "text":d=b.color;break;case "cim":d=l.getCIMSymbolColor(b)}return d};f.getPatternUrlWithColor=function(a,b){var c=a+"-"+b;return void 0!==v.get(c)?g.resolve(v.get(c)):m(a,{responseType:"image"}).then(function(a){a=a.data;var d=a.naturalWidth,g=a.naturalHeight,q=document.createElement("canvas");q.width=d;q.height=g;var e=q.getContext("2d");e.fillStyle=b;e.fillRect(0,0,d,g);e.globalCompositeOperation=
"destination-in";e.drawImage(a,0,0);a=q.toDataURL();v.put(c,a);return a})};f.getStroke=c;var t=function(){var a={};return function(b){if(a[b])return a[b];var c=b.replace(/-/g,"");return a[b]=c}}();f.defaultThematicColor=new r([128,128,128])})},"esri/core/ItemCache":function(){define(["require","exports","./MemCache"],function(u,f,e){return function(){function f(f,d){this._storage=new e.MemCacheStorage;this._storage.maxSize=f;d&&this._storage.registerRemoveFunc("",d)}f.prototype.put=function(e,d){this._storage.put(e,
d,1,1)};f.prototype.pop=function(e){return this._storage.pop(e)};f.prototype.get=function(e){return this._storage.get(e)};f.prototype.clear=function(){this._storage.clearAll()};f.prototype.destroy=function(){this._storage.clearAll()};return f}()})},"esri/symbols/support/cimSymbolUtils":function(){define(["require","exports","../../Color","../cim/utils"],function(u,f,e,r){function m(a){var b=r.toCIMSymbolJSON(a);if("CIMTextSymbol"===b.type)return b.height;a=0;if(b.symbolLayers)for(var c=0,b=b.symbolLayers;c<
b.length;c++){var d=b[c];r.isCIMMarker(d)&&d.size>a?a=d.size:r.isCIMStroke(d)&&d.width>a?a=d.width:r.isCIMFill(d)}return a}function d(a,c,e){if("CIMTextSymbol"===a.type)a.height*=c;else{if(e&&a.effects){e=0;for(var b=a.effects;e<b.length;e++)k(b[e],c)}if(a.symbolLayers)for(e=0,a=a.symbolLayers;e<a.length;e++)switch(b=a[e],b.type){case "CIMPictureMarker":case "CIMVectorMarker":b.markerPlacement&&g(b.markerPlacement,c);b.offsetX*=c;b.offsetY*=c;b.anchorPoint&&"Absolute"===b.anchorPointUnits&&(b.anchorPoint=
{x:b.anchorPoint.x*c,y:b.anchorPoint.y*c});b.size*=c;if("CIMVectorMarker"===b.type&&b.markerGraphics)for(var q=0,l=b.markerGraphics;q<l.length;q++){var f=l[q];b.scaleSymbolsProportionally||d(f.symbol,c,!0)}break;case "CIMPictureStroke":case "CIMSolidStroke":b.width*=c;break;case "CIMPictureFill":b.height*=c;b.offsetX*=c;b.offsetY*=c;break;case "CIMHatchFill":d(b.lineSymbol,c,!0),b.offsetX*=c,b.offsetY*=c,b.separation*=c}}}function g(a,c){r.isCIMMarkerStrokePlacement(a)&&(a.offset*=c);switch(a.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":a.customEndingOffset*=
c;a.offsetAlongLine*=c;if(a.placementTemplate&&a.placementTemplate.length){var b=a.placementTemplate.map(function(a){return a*c});a.placementTemplate=b}break;case "CIMMarkerPlacementAlongLineVariableSize":a.maxRandomOffset*=c;a.placementTemplate&&a.placementTemplate.length&&(b=a.placementTemplate.map(function(a){return a*c}),a.placementTemplate=b);break;case "CIMMarkerPlacementOnLine":a.startPointOffset*=c;break;case "CIMMarkerPlacementAtExtremities":a.offsetAlongLine*=c;break;case "CIMMarkerPlacementAtRatioPositions":a.beginPosition*=
c;a.endPosition*=c;break;case "CIMMarkerPlacementPolygonCenter":a.offsetX*=c;a.offsetY*=c;break;case "CIMMarkerPlacementInsidePolygon":a.offsetX*=c,a.offsetY*=c,a.stepX*=c,a.stepY*=c}}function k(a,c){switch(a.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":a.width*=c;break;case "CIMGeometricEffectBuffer":a.size*=c;break;case "CIMGeometricEffectCut":a.beginCut*=c;a.endCut*=c;a.middleCut*=c;break;case "CIMGeometricEffectDashes":a.customEndingOffset*=c;a.offsetAlongLine*=c;if(a.dashTemplate&&
a.dashTemplate.length){var b=a.dashTemplate.map(function(a){return a*c});a.dashTemplate=b}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":a.length*=c;break;case "CIMGeometricEffectMove":a.offsetX*=c;a.offsetY*=c;break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":a.offset*=c;break;case "CIMGeometricEffectRegularPolygon":a.radius*=c;break;case "CIMGeometricEffectTaperedPolygon":a.fromWidth*=c;a.length*=c;a.toWidth*=c;break;
case "CIMGeometricEffectWave":a.amplitude*=c,a.period*=c}}function l(a,d){var b;b="CIMTextSymbol"===a.type?a.symbol:a;a="CIMPolygonSymbol"===a.type;if(b.symbolLayers){var g=0;for(b=b.symbolLayers;g<b.length;g++){var e=b[g];if(!(e.colorLocked||a&&(r.isCIMStroke(e)||r.isCIMMarker(e)&&e.markerPlacement&&r.isCIMMarkerStrokePlacement(e.markerPlacement))))switch(e.type){case "CIMVectorMarker":e.markerGraphics.forEach(function(a){l(a.symbol,d)});break;case "CIMSolidStroke":case "CIMSolidFill":c(d,e.color);
break;case "CIMHatchFill":l(e.lineSymbol,d)}}}}function c(a,c){for(var b=0;b<a.length;b++)if(a[b].join(".")===c.join("."))return;a.push(c)}function a(b,c){var d;d="CIMTextSymbol"===b.type?b.symbol:b;b="CIMPolygonSymbol"===b.type?!0:!1;if(d.symbolLayers){var g=0;for(d=d.symbolLayers;g<d.length;g++){var e=d[g];if(!(e.colorLocked||b&&(r.isCIMStroke(e)||r.isCIMMarker(e)&&e.markerPlacement&&r.isCIMMarkerStrokePlacement(e.markerPlacement)))){var q=c.toArray(0);switch(e.type){case "CIMVectorMarker":e.markerGraphics.forEach(function(b){a(b.symbol,
c)});break;case "CIMSolidStroke":case "CIMSolidFill":e.color=q;break;case "CIMHatchFill":a(e.lineSymbol,c)}}}}}Object.defineProperty(f,"__esModule",{value:!0});f.getCIMSymbolSize=m;f.scaleCIMSymbolTo=function(a,c){var b=r.toCIMSymbolJSON(a);a=m(a);if(0===a)if("CIMTextSymbol"===b.type)b.height=c;else{if(b.symbolLayers)for(a=0,b=b.symbolLayers;a<b.length;a++){var g=b[a];switch(g.type){case "CIMPictureMarker":case "CIMVectorMarker":g.size=c;break;case "CIMPictureStroke":case "CIMSolidStroke":g.width=
c}}}else d(b,c/a,!1)};f.getCIMSymbolColor=function(a){a=r.toCIMSymbolJSON(a);var b=[];l(a,b);return b.length?new e(r.fromCIMColor(b[0])):null};f.applyCIMSymbolColor=function(b,c){c instanceof e||(c=new e(c));b=r.toCIMSymbolJSON(b);a(b,c)};f.getCIMSymbolRotation=function(a){a=r.toCIMSymbolJSON(a);return"CIMTextSymbol"===a.type||"CIMPointSymbol"===a.type?a.angle||0:0};f.applyCIMSymbolRotation=function(a,c){a=r.toCIMSymbolJSON(a);if("CIMTextSymbol"===a.type)a.angle=c;else if("CIMPointSymbol"===a.type&&
a.symbolLayers)for(var b=c-(a.angle||0),d=0,g=a.symbolLayers;d<g.length;d++){var e=g[d];if(r.isCIMMarker(e)){var q=e.rotation||0,q=e.rotateClockwise?q-b:q+b;e.rotation=q}a.angle=c}}})},"esri/symbols/support/previewUtils":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});f.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},
{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],
cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},
{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},
{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};f.getPathSymbolShapes=function(e){var f=22,m=22;1>e?f*=.75:1<e&&(m*=1.25);return[{type:"path",path:[{command:"M",values:[22,0]},{command:"L",values:[19.25,0]},{command:"L",values:[0,m-11]},{command:"L",values:[f-11,m-11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[22,0]},{command:"L",values:[22,2.75]},{command:"L",values:[f-11,22]},{command:"L",values:[f-11,m-11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[f-
11,m-11]},{command:"L",values:[0,m-11]},{command:"L",values:[0,22]},{command:"L",values:[f-11,22]},{command:"Z",values:[]}]}]};f.getExtrudeSymbolShapes=function(e){e*=.5;return[{type:"path",path:[{command:"M",values:[0,.7*11]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+e]},{command:"L",values:[0,22*.7+e-.7*11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+e]},{command:"L",values:[22,e]},{command:"L",values:[22,0]},
{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,0]},{command:"L",values:[22,0]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[0,.7*11]},{command:"Z",values:[]}]}]};f.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},
{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
f.getCubeShapes=function(e,f){var m=f?20:e,d=f?4:6,d=m=22>=m?m-.5*d:m-d;f=f?.35*m:.5*m;return[{type:"path",path:[{command:"M",values:[.5*d,0]},{command:"L",values:[d,.5*f]},{command:"L",values:[.5*d,f]},{command:"L",values:[0,.5*f]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*f]},{command:"L",values:[.5*d,f]},{command:"L",values:[.5*d,e]},{command:"L",values:[0,e-.5*f]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*d,f]},{command:"L",values:[.5*d,
e]},{command:"L",values:[d,e-.5*f]},{command:"L",values:[d,.5*f]},{command:"Z",values:[]}]}]};f.getCylinderShapes=function(e,f){var m=f?20:e;f=f?4:6;m=22>=m?m-.5*f:m-f;f=.5*m;var d=.15*m;e-=d;return[{type:"ellipse",cx:.5*m,cy:e,rx:f,ry:d},{type:"path",path:[{command:"M",values:[0,d]},{command:"L",values:[0,e]},{command:"L",values:[m,e]},{command:"L",values:[m,d]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*m,cy:d,rx:f,ry:d}]};f.getConeShapes=function(e,f){var m=f?20:e;f=f?4:6;m=22>=m?m-.5*f:m-
f;f=.15*m;var d=m;e-=f;return[{type:"ellipse",cx:.5*m,cy:e,rx:.5*m,ry:f},{type:"path",path:[{command:"M",values:[.5*d,0]},{command:"L",values:[d,e]},{command:"L",values:[0,e]},{command:"Z",values:[]}]}]};f.getInvertedConeShapes=function(e){var f=e,f=22>f?f-3:f-6,m=.15*f,d=f;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[d,0]},{command:"L",values:[.5*d,e-m]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*f,cy:0,rx:.5*f,ry:m}]};f.getDiamondShapes=function(e){var f=e,f=22>
f?f-2:f-4,m=Math.floor(e/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*f,0]},{command:"L",values:[f,.5*e-m]},{command:"L",values:[.45*f-m,.5*e+m]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*f,0]},{command:"L",values:[.45*f-m,.5*e+m]},{command:"L",values:[0,.5*e-m]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*e-m]},{command:"L",values:[.45*f-m,.5*e+m]},{command:"L",values:[.45*f,e]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[.45*f,e]},{command:"L",values:[f,.5*e-m]},{command:"L",values:[.45*f-m,.5*e+m]},{command:"Z",values:[]}]}]};f.getTetrahedronShapes=function(e){var f=e,f=22>f?f-1:f-2;return[{type:"path",path:[{command:"M",values:[.45*e,0]},{command:"L",values:[e,f]},{command:"L",values:[.45*e,.6*f]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*e,0]},{command:"L",values:[.45*e,.6*f]},{command:"L",values:[0,f]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,f]},
{command:"L",values:[.45*e,.6*f]},{command:"L",values:[e,f]},{command:"Z",values:[]}]}]}})},"esri/symbols/support/renderUtils":function(){define("require exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../core/promiseUtils ../../libs/maquette/index ./svgUtils".split(" "),function(u,f,e,r,m,d,g,k,l,c){function a(a,b,c){return a?r(a,{responseType:"image"}).then(function(a){a=a.data;var d=a.width,g=a.height,e=d/g,q=b;c&&(q=Math.min(q,Math.max(d,g)));return{image:a,
width:1>=e?Math.ceil(q*e):q,height:1>=e?q:Math.ceil(q/e)}}):k.reject(new d("renderUtils: imageDataSize","href not provided."))}Object.defineProperty(f,"__esModule",{value:!0});var b=l.createProjector();f.renderSymbol=function(a,d,g){var e=Math.ceil(d[0]);d=Math.ceil(d[1]);if(!a.some(function(a){return!!a.length}))return null;var q=g&&g.node||document.createElement("div");null!=g.opacity&&(q.style.opacity=g.opacity.toString());b.append(q,c.renderSVG.bind(null,a,e,d,g));return q};f.tintImageWithColor=
function(b,c,d,k,l){return a(b,c,l).then(function(a){var q=a.width?a.width:c,l=a.height?a.height:c,t;if(t=a.image)t=d&&"ignore"!==k?"multiply"===k&&255===d.r&&255===d.g&&255===d.b&&1===d.a?!1:!0:!1;if(t){var f=a.image.width,v=a.image.height;(g("edge")||g("ie"))&&/\.svg$/i.test(b)&&(--f,--v);var x,z;x=Math.ceil(q);z=Math.ceil(l);t=document.createElement("canvas");t.width=x;t.height=z;t.style.width=x+"px";t.style.height=z+"px";t=t.getContext("2d");t.clearRect(0,0,x,z);t.drawImage(a.image,0,0,f,v,0,
0,q,l);a=t.getImageData(0,0,q,l);f=[d.r/255,d.g/255,d.b/255,d.a];v=m.toHSV(d);for(x=0;x<a.data.length;x+=4){z=a.data;var r=x,A=f,O=v;switch(k){case "multiply":z[r+0]*=A[0];z[r+1]*=A[1];z[r+2]*=A[2];z[r+3]*=A[3];break;default:var L=m.toHSV({r:z[r+0],g:z[r+1],b:z[r+2]});L.h=O.h;L.s=O.s;L.v=L.v/100*O.v;O=m.toRGB(L);z[r+0]=O.r;z[r+1]=O.g;z[r+2]=O.b;z[r+3]*=A[3]}}t.putImageData(a,0,0);b=t.canvas.toDataURL("image/png")}else(t=e.id&&e.id.findCredential(b))&&t.token&&(a=-1===b.indexOf("?")?"?":"\x26",b=""+
b+a+"token\x3d"+t.token);return{url:b,width:q,height:l}}).catch(function(){return{url:b,width:c,height:c}})}})},"esri/core/colorUtils":function(){define(["require","exports"],function(u,f){function e(a,b){var c=[],d,g;if(a[0].length!==b.length)throw"dimensions do not match";var e=a.length,k=a[0].length,l=0;for(d=0;d<e;d++){for(g=l=0;g<k;g++)l+=a[d][g]*b[g];c.push(l)}return c}function r(a){a=[a.r/255,a.g/255,a.b/255].map(function(a){return.04045>=a?a/12.92:Math.pow((a+.055)/1.055,2.4)});a=e(l,a);return{x:100*
a[0],y:100*a[1],z:100*a[2]}}function m(a){a=e(c,[a.x/100,a.y/100,a.z/100]).map(function(a){return Math.min(1,Math.max(.0031308>=a?12.92*a:1.055*Math.pow(a,1/2.4)-.055,0))});return{r:Math.round(255*a[0]),g:Math.round(255*a[1]),b:Math.round(255*a[2])}}function d(a){a=[a.x/95.047,a.y/100,a.z/108.883].map(function(a){return a>Math.pow(6/29,3)?Math.pow(a,1/3):1/3*Math.pow(29/6,2)*a+4/29});return{l:116*a[1]-16,a:500*(a[0]-a[1]),b:200*(a[1]-a[2])}}function g(a){var b=a.l;a=[(b+16)/116+a.a/500,(b+16)/116,
(b+16)/116-a.b/200].map(function(a){return a>6/29?Math.pow(a,3):3*Math.pow(6/29,2)*(a-4/29)});return{x:95.047*a[0],y:100*a[1],z:108.883*a[2]}}function k(a){if("r"in a&&"g"in a&&"b"in a)return a;if("l"in a&&"c"in a&&"h"in a){var b=a.c,c=a.h;return m(g({l:a.l,a:b*Math.cos(c),b:b*Math.sin(c)}))}if("l"in a&&"a"in a&&"b"in a)return m(g(a));if("x"in a&&"y"in a&&"z"in a)return m(a);if("h"in a&&"s"in a&&"v"in a){c=(a.h+360)%360/60;b=a.v/100*255;a=a.s/100*b;var d=a*(1-Math.abs(c%2-1));switch(Math.floor(c)){case 0:c=
{r:a,g:d,b:0};break;case 1:c={r:d,g:a,b:0};break;case 2:c={r:0,g:a,b:d};break;case 3:c={r:0,g:d,b:a};break;case 4:c={r:d,g:0,b:a};break;case 5:case 6:c={r:a,g:0,b:d};break;default:c={r:0,g:0,b:0}}c.r=Math.round(c.r+b-a);c.g=Math.round(c.g+b-a);c.b=Math.round(c.b+b-a);return c}}Object.defineProperty(f,"__esModule",{value:!0});var l=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],c=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];f.toRGB=k;f.toHSV=function(a){if("h"in
a&&"s"in a&&"v"in a)return a;var b=k(a);a=b.r;var c=b.g,b=b.b,d=Math.max(a,c,b),g=d-Math.min(a,c,b),e;0===g?e=0:d===a?e=(c-b)/g%6:d===c?e=(b-a)/g+2:d===b&&(e=(a-c)/g+4);0>e&&(e+=6);return{h:60*e,s:100*(0===g?0:g/d),v:100/255*d}};f.toLAB=function(a){return"l"in a&&"a"in a&&"b"in a?a:d(r(k(a)))};f.toLCH=function(a){if(!("l"in a&&"c"in a&&"h"in a)){var b=d(r(k(a)));a=b.l;var c=b.a,g=b.b,b=Math.sqrt(c*c+g*g),c=Math.atan2(g,c),c=0<c?c:c+2*Math.PI;a={l:a,c:b,h:c}}return a};f.toXYZ=function(a){return"x"in
a&&"y"in a&&"z"in a?a:r(k(a))};f.darken=function(a,b){a=d(r(a));a.l*=1-b;return m(g(a))}})},"esri/symbols/support/svgUtils":function(){define("require exports ../../Color ../../core/has ../../core/libs/gl-matrix-2/mat2df32 ../../core/libs/gl-matrix-2/math/mat2d ../../widgets/support/widget".split(" "),function(u,f,e,r,m,d,g){function k(a){return a.map(function(a){return a.command+" "+a.values.join(" ")}).join(" ").trim()}function l(a,b,c,d){if(a){if("circle"===a.type)return g.tsx("circle",{fill:b,
"fill-rule":"evenodd",stroke:c.color,"stroke-width":c.width,"stroke-linecap":c.cap,"stroke-linejoin":c.join,"stroke-dasharray":c.dashArray,"stroke-miterlimit":"4",cx:a.cx,cy:a.cy,r:a.r});if("ellipse"===a.type)return g.tsx("ellipse",{fill:b,"fill-rule":"evenodd",stroke:c.color,"stroke-width":c.width,"stroke-linecap":c.cap,"stroke-linejoin":c.join,"stroke-dasharray":c.dashArray,"stroke-miterlimit":"4",cx:a.cx,cy:a.cy,rx:a.rx,ry:a.ry});if("rect"===a.type)return g.tsx("rect",{fill:b,"fill-rule":"evenodd",
stroke:c.color,"stroke-width":c.width,"stroke-linecap":c.cap,"stroke-linejoin":c.join,"stroke-dasharray":c.dashArray,"stroke-miterlimit":"4",x:a.x,y:a.y,width:a.width,height:a.height});if("image"===a.type)return g.tsx("image",{href:a.src,x:a.x,y:a.y,width:a.width,height:a.height,preserveAspectRatio:"none"});if("path"===a.type)return a="string"!==typeof a.path?k(a.path):a.path,g.tsx("path",{fill:b,"fill-rule":"evenodd",stroke:c.color,"stroke-width":c.width,"stroke-linecap":c.cap,"stroke-linejoin":c.join,
"stroke-dasharray":c.dashArray,"stroke-miterlimit":"4",d:a});if("text"===a.type)return g.tsx("text",{fill:b,"fill-rule":"evenodd",stroke:c.color,"stroke-width":c.width,"stroke-linecap":c.cap,"stroke-linejoin":c.join,"stroke-dasharray":c.dashArray,"stroke-miterlimit":"4","text-anchor":d.align,"text-decoration":d.decoration,kerning:d.kerning,rotate:d.rotate,"text-rendering":M,"font-style":d.font.style,"font-variant":d.font.variant,"font-weight":d.font.weight,"font-size":d.font.size,"font-family":d.font.family,
x:a.x,y:a.y},a.text)}return null}function c(a){var b={fill:"none",pattern:null,linearGradient:null};if(a)if("type"in a&&"pattern"===a.type){var c="patternId-"+ ++G;b.fill="url(#"+c+")";b.pattern={id:c,x:a.x,y:a.y,width:a.width,height:a.height,image:{x:0,y:0,width:a.width,height:a.height,href:a.src}}}else"type"in a&&"linear"===a.type?(c="linearGradientId-"+ ++F,b.fill="url(#"+c+")",b.linearGradient={id:c,x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2,stops:a.colors.map(function(a){return{offset:a.offset,color:a.color&&
(new e(a.color)).toString()}})}):a&&(a=new e(a),b.fill=a.toString());return b}function a(a){var b={color:"none",width:1,cap:"butt",join:"4",dashArray:"none"};if(a&&(null!=a.width&&(b.width=a.width),a.cap&&(b.cap=a.cap),a.join&&(b.join=a.join.toString()),a.color&&(b.color=(new e(a.color)).toString()),a.style)){var c=null;a.style in Q&&(c=Q[a.style]);if(Array.isArray(c)){for(var c=c.slice(0),d=0;d<c.length;++d)c[d]*=a.width;if("butt"!==a.cap){for(d=0;d<c.length;d+=2)c[d]-=a.width,1>c[d]&&(c[d]=1);for(d=
1;d<c.length;d+=2)c[d]+=a.width}c=c.join(",")}b.dashArray=c}return b}function b(a,b){var c={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};a&&(c.align=a.align,c.decoration=a.decoration,c.kerning=a.kerning?"auto":"0",c.rotate=a.rotated?"90":"0",c.font.style=b.style||"normal",c.font.variant=b.variant||"normal",c.font.weight=b.weight||"normal",c.font.size=b.size&&b.size.toString()||"10pt",c.font.family=b.family||"serif");return c}
function q(a){var b=a.pattern;a=a.linearGradient;return b?g.tsx("pattern",{id:b.id,patternUnits:"userSpaceOnUse",x:b.x,y:b.y,width:b.width,height:b.height},g.tsx("image",{x:b.image.x,y:b.image.y,width:b.image.width,height:b.image.height,href:b.image.href})):a?(b=a.stops.map(function(a,b){return g.tsx("stop",{key:b+"-stop",offset:a.offset,"stop-color":a.color})}),g.tsx("linearGradient",{id:a.id,gradientUnits:"userSpaceOnUse",x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2},b)):null}function v(a,b,c){return d.translate(a,
d.identity(a),[b,c])}function t(a,b,c,g,e){d.scale(a,d.identity(a),[b,c]);a[4]=a[4]*b-g*b+g;a[5]=a[5]*c-e*c+e;return a}function x(a,b,c,g){var e=b%360*Math.PI/180;d.rotate(a,d.identity(a),e);b=Math.cos(e);var e=Math.sin(e),k=a[4],q=a[5];a[4]=k*b-q*e+g*e-c*b+c;a[5]=q*b+k*e-c*e-g*b+g;return a}function z(a,b){O&&"left"in O?(O.left>a&&(O.left=a),O.right<a&&(O.right=a),O.top>b&&(O.top=b),O.bottom<b&&(O.bottom=b)):O={left:a,bottom:b,right:a,top:b}}function A(a){var b=a.args,c=b.length;switch(a.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(a=
0;a<c;a+=2)z(b[a],b[a+1]);L.x=b[c-2];L.y=b[c-1];break;case "H":for(a=0;a<c;++a)z(b[a],L.y);L.x=b[c-1];break;case "V":for(a=0;a<c;++a)z(L.x,b[a]);L.y=b[c-1];break;case "m":a=0;"x"in L||(z(L.x=b[0],L.y=b[1]),a=2);for(;a<c;a+=2)z(L.x+=b[a],L.y+=b[a+1]);break;case "l":case "t":for(a=0;a<c;a+=2)z(L.x+=b[a],L.y+=b[a+1]);break;case "h":for(a=0;a<c;++a)z(L.x+=b[a],L.y);break;case "v":for(a=0;a<c;++a)z(L.x,L.y+=b[a]);break;case "c":for(a=0;a<c;a+=6)z(L.x+b[a],L.y+b[a+1]),z(L.x+b[a+2],L.y+b[a+3]),z(L.x+=b[a+
4],L.y+=b[a+5]);break;case "s":case "q":for(a=0;a<c;a+=4)z(L.x+b[a],L.y+b[a+1]),z(L.x+=b[a+2],L.y+=b[a+3]);break;case "A":for(a=0;a<c;a+=7)z(b[a+5],b[a+6]);L.x=b[c-2];L.y=b[c-1];break;case "a":for(a=0;a<c;a+=7)z(L.x+=b[a+5],L.y+=b[a+6])}}function E(a,b,c){var d=R[a.toLowerCase()];"number"===typeof d&&(d?b.length>=d&&(a={action:a,args:b.slice(0,b.length-b.length%d)},c.push(a),A(a)):(a={action:a,args:[]},c.push(a),A(a)))}function H(a){var b={x:0,y:0,width:0,height:0};if("circle"===a.type)b.x=a.cx-a.r,
b.y=a.cy-a.r,b.width=2*a.r,b.height=2*a.r;else if("ellipse"===a.type)b.x=a.cx-a.rx,b.y=a.cy-a.ry,b.width=2*a.rx,b.height=2*a.ry;else if("image"===a.type||"rect"===a.type)b.x=a.x,b.y=a.y,b.width=a.width,b.height=a.height;else if("path"===a.type){a=("string"!==typeof a.path?k(a.path):a.path).match(T);var c=[];O={};L={};if(a){for(var d="",g=[],e=a.length,q=0;q<e;++q){var l=a[q],t=parseFloat(l);isNaN(t)?(d&&E(d,g,c),g=[],d=l):g.push(t)}E(d,g,c);a={x:0,y:0,width:0,height:0};O&&"left"in O&&(a.x=O.left,
a.y=O.top,a.width=O.right-O.left,a.height=O.bottom-O.top)}else a=null;b.x=a.x;b.y=a.y;b.width=a.width;b.height=a.height}return b}function J(a){for(var b={x:0,y:0,width:0,height:0},c=null,d=Number.NEGATIVE_INFINITY,g=Number.NEGATIVE_INFINITY,e=0;e<a.length;e++){var k=a[e];c?(c.x=Math.min(c.x,k.x),c.y=Math.min(c.y,k.y),d=Math.max(d,k.x+k.width),g=Math.max(g,k.y+k.height)):(c=b,c.x=k.x,c.y=k.y,d=k.x+k.width,g=k.y+k.height)}c&&(c.width=d-c.x,c.height=g-c.y);return c}function B(a,b,c,g,e,k){var q=b/2,
l=c/2,f=a.width+g,z=a.height+g,r=m.mat2df32.create(),A=m.mat2df32.create(),H=!1;if(e&&0!==f&&0!==z){e=f/z;var H=b>c?b:c,E=1,B=1;isNaN(H)||(1<e?(E=H/f,B=H/e/z):(B=H/z,E=H*e/f));d.multiply(A,A,t(r,E,B,q,l));H=!0}e=a.x+(f-g)/2;a=a.y+(z-g)/2;d.multiply(A,A,v(r,q-e,l-a));!H&&(f>b||z>c)&&(q=f/b>z/c,b=(q?b:c)/(q?f:z),d.multiply(A,A,t(r,b,b,e,a)));k&&d.multiply(A,A,x(r,k,e,a));return"matrix("+A[0]+","+A[1]+","+A[2]+","+A[3]+","+A[4]+","+A[5]+")"}Object.defineProperty(f,"__esModule",{value:!0});var G=0,F=
0,M=r("chrome")?"auto":"optimizeLegibility",R={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},T=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,O={},L={},Q={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};f.renderShape=l;f.generateFillAttributes=c;f.generateStrokeAttributes=a;f.generateTextAttributes=b;f.renderDef=q;f.getBoundingBox=H;f.computeBBox=
J;f.getTransformMatrix=B;f.renderSVG=function(d,e,k,t){for(var f=[],v=[],x=0;x<d.length;x++){for(var m=[],z=[],r=0,A=0,E=d[x];A<E.length;A++){var F=E[A],G=F.shape,M=F.fill,R=F.stroke,F=F.font,r=r+(R&&R.width||0),M=c(M),R=a(R),F="text"===G.type?b(G,F):null;f.push(q(M));m.push(l(G,M.fill,R,F));z.push(H(G))}z=B(J(z),e,k,r,t&&t.scale,t&&t.rotation);v.push(g.tsx("g",{transform:z},m))}return g.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:k},g.tsx("defs",null,f),v)}})},"esri/core/libs/gl-matrix-2/mat2df32":function(){define(["require",
"exports","./factories/mat2df32"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.mat2df32=e})},"esri/core/libs/gl-matrix-2/factories/mat2df32":function(){define(["require","exports"],function(u,f){function e(e,f,d,g){var k=f[g];f=f[g+1];e[g]=d[0]*k+d[2]*f+d[4];e[g+1]=d[1]*k+d[3]*f+d[5]}Object.defineProperty(f,"__esModule",{value:!0});f.create=function(){var e=new Float32Array(6);e[0]=1;e[3]=1;return e};f.clone=function(e){var f=new Float32Array(6);f[0]=e[0];f[1]=e[1];f[2]=e[2];
f[3]=e[3];f[4]=e[4];f[5]=e[5];return f};f.fromValues=function(e,f,d,g,k,l){var c=new Float32Array(6);c[0]=e;c[1]=f;c[2]=d;c[3]=g;c[4]=k;c[5]=l;return c};f.createView=function(e,f){return new Float32Array(e,f,6)};f.transform=e;f.transformMany=function(f,m,d,g,k,l){void 0===g&&(g=0);void 0===k&&(k=0);void 0===l&&(l=2);for(k=k||m.length/l;g<k;g++)e(f,m,d,g*l)}})},"esri/core/libs/gl-matrix-2/math/mat2d":function(){define(["require","exports","./common"],function(u,f,e){function r(d,g,e){var k=g[0],c=
g[1],a=g[2],b=g[3],q=g[4];g=g[5];var f=e[0],t=e[1],x=e[2],m=e[3],A=e[4];e=e[5];d[0]=k*f+a*t;d[1]=c*f+b*t;d[2]=k*x+a*m;d[3]=c*x+b*m;d[4]=k*A+a*e+q;d[5]=c*A+b*e+g;return d}function m(d,g,e){d[0]=g[0]-e[0];d[1]=g[1]-e[1];d[2]=g[2]-e[2];d[3]=g[3]-e[3];d[4]=g[4]-e[4];d[5]=g[5]-e[5];return d}Object.defineProperty(f,"__esModule",{value:!0});f.copy=function(d,g){d[0]=g[0];d[1]=g[1];d[2]=g[2];d[3]=g[3];d[4]=g[4];d[5]=g[5];return d};f.identity=function(d){d[0]=1;d[1]=0;d[2]=0;d[3]=1;d[4]=0;d[5]=0;return d};
f.set=function(d,g,e,l,c,a,b){d[0]=g;d[1]=e;d[2]=l;d[3]=c;d[4]=a;d[5]=b;return d};f.invert=function(d,g){var e=g[0],l=g[1],c=g[2],a=g[3],b=g[4];g=g[5];var q=e*a-l*c;if(!q)return null;q=1/q;d[0]=a*q;d[1]=-l*q;d[2]=-c*q;d[3]=e*q;d[4]=(c*g-a*b)*q;d[5]=(l*b-e*g)*q;return d};f.determinant=function(d){return d[0]*d[3]-d[1]*d[2]};f.multiply=r;f.rotate=function(d,g,e){var k=g[0],c=g[1],a=g[2],b=g[3],q=g[4];g=g[5];var f=Math.sin(e);e=Math.cos(e);d[0]=k*e+a*f;d[1]=c*e+b*f;d[2]=k*-f+a*e;d[3]=c*-f+b*e;d[4]=q;
d[5]=g;return d};f.scale=function(d,g,e){var k=g[1],c=g[2],a=g[3],b=g[4],q=g[5],f=e[0];e=e[1];d[0]=g[0]*f;d[1]=k*f;d[2]=c*e;d[3]=a*e;d[4]=b;d[5]=q;return d};f.translate=function(d,g,e){var k=g[0],c=g[1],a=g[2],b=g[3],q=g[4];g=g[5];var f=e[0];e=e[1];d[0]=k;d[1]=c;d[2]=a;d[3]=b;d[4]=k*f+a*e+q;d[5]=c*f+b*e+g;return d};f.fromRotation=function(d,g){var e=Math.sin(g);g=Math.cos(g);d[0]=g;d[1]=e;d[2]=-e;d[3]=g;d[4]=0;d[5]=0;return d};f.fromScaling=function(d,g){d[0]=g[0];d[1]=0;d[2]=0;d[3]=g[1];d[4]=0;d[5]=
0;return d};f.fromTranslation=function(d,g){d[0]=1;d[1]=0;d[2]=0;d[3]=1;d[4]=g[0];d[5]=g[1];return d};f.str=function(d){return"mat2d("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+")"};f.frob=function(d){return Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)+Math.pow(d[2],2)+Math.pow(d[3],2)+Math.pow(d[4],2)+Math.pow(d[5],2)+1)};f.add=function(d,g,e){d[0]=g[0]+e[0];d[1]=g[1]+e[1];d[2]=g[2]+e[2];d[3]=g[3]+e[3];d[4]=g[4]+e[4];d[5]=g[5]+e[5];return d};f.subtract=m;f.multiplyScalar=function(d,g,
e){d[0]=g[0]*e;d[1]=g[1]*e;d[2]=g[2]*e;d[3]=g[3]*e;d[4]=g[4]*e;d[5]=g[5]*e;return d};f.multiplyScalarAndAdd=function(d,g,e,f){d[0]=g[0]+e[0]*f;d[1]=g[1]+e[1]*f;d[2]=g[2]+e[2]*f;d[3]=g[3]+e[3]*f;d[4]=g[4]+e[4]*f;d[5]=g[5]+e[5]*f;return d};f.exactEquals=function(d,g){return d[0]===g[0]&&d[1]===g[1]&&d[2]===g[2]&&d[3]===g[3]&&d[4]===g[4]&&d[5]===g[5]};f.equals=function(d,g){var k=d[0],f=d[1],c=d[2],a=d[3],b=d[4];d=d[5];var q=g[0],v=g[1],t=g[2],x=g[3],m=g[4];g=g[5];return Math.abs(k-q)<=e.EPSILON*Math.max(1,
Math.abs(k),Math.abs(q))&&Math.abs(f-v)<=e.EPSILON*Math.max(1,Math.abs(f),Math.abs(v))&&Math.abs(c-t)<=e.EPSILON*Math.max(1,Math.abs(c),Math.abs(t))&&Math.abs(a-x)<=e.EPSILON*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(b-m)<=e.EPSILON*Math.max(1,Math.abs(b),Math.abs(m))&&Math.abs(d-g)<=e.EPSILON*Math.max(1,Math.abs(d),Math.abs(g))};f.mul=r;f.sub=m})},"esri/symbols/support/previewSymbol3D":function(){define("require exports tslib ../../assets ../../core/colorUtils ../../core/compilerUtils ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./styleUtils ./utils".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A){function E(b){var c=b.outline,d=l.isSome(b.material)?b.material.color:null,d=l.isSome(d)?d.toRgba().toString():null;if(l.isNone(c))return"fill"===b.type&&"255,255,255,1"===d?{color:"#bdc3c7",width:.75}:null;b=a.pt2px(c.size)||0;return{color:"rgba("+(l.isSome(c.color)?c.color.toRgba():"255,255,255,1")+")",width:Math.min(b,80)}}function H(a,b){var d=b&&b.resource,d=d&&d.href;return a.thumbnail&&a.thumbnail.url?c.resolve(a.thumbnail.url):d&&"object"!==b.type?
c.resolve(A.getIconHref(a,b)):a.styleOrigin&&(a.styleOrigin.styleName||a.styleOrigin.styleUrl)?z.resolveWebStyleSymbol(a.styleOrigin,{portal:a.styleOrigin.portal},"webRef").catch(function(a){return a}).then(function(a){return a&&a.thumbnail&&a.thumbnail.url||ba}):c.resolve(ba)}function J(a,b){void 0===b&&(b=1);var c=a.a;a=m.toHSV(a);b=m.toRGB({h:a.h,s:a.s/b,v:100-(100-a.v)/b});return[b.r,b.g,b.b,c]}function B(a,b){return Math.round(Math.min(Math.max(a+191.25*b,0),255))}function G(a){return"water"===
a.type?l.isNone(a.color)?null:a.color:l.isNone(a.material)||l.isNone(a.material.color)?null:a.material.color}function F(a,c){void 0===c&&(c=0);a=G(a);if(!a)return c=B(b.defaultThematicColor.r,c),[c,c,c,100];a=a.toRgba();for(var d=0;3>d;d++)a[d]=B(a[d],c);return a}function M(a){return a.outline?E(a):{color:"rgba(0, 0, 0, 1)",width:1.5}}function R(a,b){a=G(a);if(!a)return null;var c;c="rgba("+(B(a.r,b)+",");c+=B(a.g,b)+",";c+=B(a.b,b)+",";return c+a.a+");"}function T(b,c){c=R(b,c);if(!c)return{};b=
Math.min(b.size?a.pt2px(b.size):.75,80);return{color:c,width:b}}function O(a,b,c){c*=.75;return{type:"linear",x1:c?.25*c:0,y1:c?.5*c:0,x2:c||4,y2:c?.5*c:4,colors:[{color:a,offset:0},{color:b,offset:1}]}}function L(a){var b=a.depth,c=a.height;return(a=a.width)&&b&&c&&a===b&&a<c}function Q(a,b,c){var g=[];if(!a)return g;switch(a.type){case "icon":var e=a.resource&&a.resource.primitive||q.defaultPrimitive;switch(e){case "circle":g.push({shape:{type:"circle",cx:0,cy:0,r:.5*b},fill:F(a,0),stroke:E(a)});
break;case "square":g.push({shape:{type:"path",path:[{command:"M",values:[0,b]},{command:"L",values:[0,0]},{command:"L",values:[b,0]},{command:"L",values:[b,b]},{command:"Z",values:[]}]},fill:F(a,0),stroke:E(a)});break;case "triangle":g.push({shape:{type:"path",path:[{command:"M",values:[0,b]},{command:"L",values:[.5*b,0]},{command:"L",values:[b,b]},{command:"Z",values:[]}]},fill:F(a,0),stroke:E(a)});break;case "cross":g.push({shape:{type:"path",path:[{command:"M",values:[.5*b,0]},{command:"L",values:[.5*
b,b]},{command:"M",values:[0,.5*b]},{command:"L",values:[b,.5*b]}]},stroke:M(a)});break;case "x":g.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[b,b]},{command:"M",values:[b,0]},{command:"L",values:[0,b]}]},stroke:M(a)});break;case "kite":g.push({shape:{type:"path",path:[{command:"M",values:[0,.5*b]},{command:"L",values:[.5*b,0]},{command:"L",values:[b,.5*b]},{command:"L",values:[.5*b,b]},{command:"Z",values:[]}]},fill:F(a,0),stroke:E(a)});break;default:d.neverReached(e)}break;
case "object":switch(e=a.resource&&a.resource.primitive||v.defaultPrimitive,e){case "cone":e=F(a,0);a=F(a,-.6);a=O(e,a,c?20:b);b=t.getConeShapes(b,c);g.push({shape:b[0],fill:a});g.push({shape:b[1],fill:a});break;case "inverted-cone":c=F(a,0);a=F(a,-.6);a=O(c,a,b);b=t.getInvertedConeShapes(b);g.push({shape:b[0],fill:a});g.push({shape:b[1],fill:c});break;case "cube":b=t.getCubeShapes(b,c);g.push({shape:b[0],fill:F(a,0)});g.push({shape:b[1],fill:F(a,-.3)});g.push({shape:b[2],fill:F(a,-.5)});break;case "cylinder":var e=
F(a,0),k=F(a,-.6),e=O(e,k,c?20:b);b=t.getCylinderShapes(b,c);g.push({shape:b[0],fill:e});g.push({shape:b[1],fill:e});g.push({shape:b[2],fill:F(a,0)});break;case "diamond":b=t.getDiamondShapes(b);g.push({shape:b[0],fill:F(a,-.3)});g.push({shape:b[1],fill:F(a,0)});g.push({shape:b[2],fill:F(a,-.3)});g.push({shape:b[3],fill:F(a,-.7)});break;case "sphere":c=F(a,0);a=F(a,-.6);a=O(c,a);a.x1=0;a.y1=0;a.x2=.25*b;a.y2=.25*b;g.push({shape:{type:"circle",cx:0,cy:0,r:.5*b},fill:a});break;case "tetrahedron":b=
t.getTetrahedronShapes(b);g.push({shape:b[0],fill:F(a,-.3)});g.push({shape:b[1],fill:F(a,0)});g.push({shape:b[2],fill:F(a,-.6)});break;default:d.neverReached(e)}}return g}function S(b,d){var g=d&&d.size?a.pt2px(d.size):null,e=d&&d.maxSize?a.pt2px(d.maxSize):null,q=d&&d.disableUpsampling,k=b.symbolLayers,f=[],t=0,l=0,v=k.getItemAt(k.length-1),m;v&&"icon"===v.type&&(m=v.size&&a.pt2px(v.size));k.forEach(function(k){if("icon"===k.type||"object"===k.type){var v="icon"===k.type?k.size&&a.pt2px(k.size):
0,z=g||v?Math.ceil(Math.min(g||v,e||120)):22;if(k&&k.resource&&k.resource.href){var A=H(b,k).then(function(a){var b=k.get("material.color"),c;c="icon"===k.type?"multiply":"tint";return x.tintImageWithColor(a,z,b,c,q)}).then(function(a){var b=a.width,c=a.height;t=Math.max(t,b);l=Math.max(l,c);return[{shape:{type:"image",x:0,y:0,width:b,height:c,src:a.url},fill:null,stroke:null}]});f.push(A)}else A=z,"icon"===k.type&&m&&g&&(A=v/m*z),v=d&&"tall"===d.symbolConfig||("object"===k.type?L(k):!1),t=Math.max(t,
v?20:A),l=Math.max(l,A),f.push(c.resolve(Q(k,A,v)))}});return c.eachAlways(f).then(function(a){var b=[];a.forEach(function(a){a.value?b.push(a.value):a.error&&V.warn("error while building swatchInfo!",a.error)});return x.renderSymbol(b,[t,l],{node:d&&d.node,scale:!1,opacity:d&&d.opacity})})}function aa(b,d){var g=b.symbolLayers,q=[];b=A.isVolumetricSymbol(b);var k=d&&d.size?a.pt2px(d.size):null,f=(d&&d.maxSize?a.pt2px(d.maxSize):null)||80,l=0,v=0,m;g.forEach(function(a,b){if(a&&("line"===a.type||
"path"===a.type)){var c=[];switch(a.type){case "line":var d=T(a,0),g=d&&d.width||0;0===b&&(m=g);var x=Math.min(k||g,f);b=0===b?x:k?g/m*x:x;v=Math.max(v,b);l=Math.max(l,20<b?2*b:40);d.width=b;c.push({shape:{type:"path",path:[{command:"M",values:[0,.5*v]},{command:"L",values:[l,.5*v]}]},stroke:d});break;case "path":b=Math.min(k||22,f);g=F(a,0);x=F(a,-.2);d=(d=R(a,-.4))?{color:d,width:1}:{};if("quad"===a.profile){var z=a.width||a.size;a=a.height||a.size;a=t.getPathSymbolShapes(z&&a?z/a:1);d=e.__assign(e.__assign({},
d),{join:"bevel"});c.push({shape:a[0],fill:x,stroke:d});c.push({shape:a[1],fill:x,stroke:d});c.push({shape:a[2],fill:g,stroke:d})}else c.push({shape:t.shapes.pathSymbol3DLayer[0],fill:x,stroke:d}),c.push({shape:t.shapes.pathSymbol3DLayer[1],fill:g,stroke:d});l=v=Math.max(v,b)}q.push(c)}});return c.resolve(x.renderSymbol(q,[l,v],{node:d&&d.node,scale:b,opacity:d&&d.opacity}))}Object.defineProperty(f,"__esModule",{value:!0});var ba=r.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png"),V=k.getLogger("esri.symbols.support.previewSymbol3D");
f.getSymbolLayerFill=F;f.previewSymbol3D=function(b,d){if(0===b.symbolLayers.length)return c.reject(new g("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));var q=null;switch(b.type){case "point-3d":q=S(b,d);break;case "line-3d":q=aa(b,d);break;case "polygon-3d":case "mesh-3d":q="mesh-3d"===b.type;b=b.symbolLayers;for(var k=d&&d.size?a.pt2px(d.size):null,f=d&&d.maxSize?a.pt2px(d.maxSize):null,k=k||22,l=[],v=0,m=0,z=!1,A=0;A<b.length;A++){var r=b.getItemAt(A),H=[];if(!q||"fill"===
r.type){var B=t.shapes.fill[0];switch(r.type){case "fill":var M=E(r),R=Math.min(k,f||120),v=Math.max(v,R),m=Math.max(m,R),z=!0;H.push({shape:B,fill:F(r,0),stroke:M});break;case "line":B={stroke:T(r,0),shape:B};v=Math.max(v,22);m=Math.max(m,22);H.push(B);break;case "extrude":var M=e.__assign({join:"round"},T(r,-.4)),B=F(r,0),r=F(r,-.2),R=Math.min(k,f||120),L=t.getExtrudeSymbolShapes(R);M.width=1;H.push({shape:L[0],fill:r,stroke:M});H.push({shape:L[1],fill:r,stroke:M});H.push({shape:L[2],fill:B,stroke:M});
B=22*.7+.5*R;v=Math.max(v,22);m=Math.max(m,B);break;case "water":z=G(r),B=J(z),r=J(z,2),M=J(z,3),R=t.getWaterSymbolShapes(),z=!0,H.push({shape:R[0],fill:B}),H.push({shape:R[1],fill:r}),H.push({shape:R[2],fill:M}),R=Math.min(k,f||120),v=Math.max(v,R),m=Math.max(m,R)}l.push(H)}}q=c.resolve(x.renderSymbol(l,[v,m],{node:d&&d.node,scale:z,opacity:d&&d.opacity}))}return q?q:c.reject(new g("symbolPreview: swatchInfo3D","symbol not supported."))}})},"esri/symbols/support/utils":function(){define("require exports tslib ../../Color ../../symbols ../../core/asyncUtils ../../core/compilerUtils ../../core/has ../../core/maybe ../../core/screenUtils ../../core/libs/gl-matrix-2/vec3f64 ./gfxUtils ./Symbol3DMaterial @dojo/framework/shim/Promise".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q){function v(a,b){if(null==b)return a;a=a.toRgba();a[3]*=b;return new r(a)}function t(a,b,c){if(a=a.symbolLayers){var d=function(a){a=l.isSome(a)?a:null;b=b||a||null!=c&&F;return v(b,c)};a.forEach(function(a){if("object"!==a.type||null==a.resource.href||b)if("water"===a.type)a.color=d(a.color);else{var g=l.isSome(a.material)?a.material.color:null,g=d(g);l.isNone(a.material)?a.material=new q.default({color:g}):a.material.color=g;null!=c&&"outline"in a&&l.isSome(a.outline)&&
l.isSome(a.outline.color)&&(a.outline.color=v(a.outline.color,c))}})}}function x(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,g=this;return e.__generator(this,function(q){switch(q.label){case 0:return(c=a.symbolLayers)?[4,d.forEach(c,function(a){return e.__awaiter(g,void 0,void 0,function(){return e.__generator(this,function(c){return[2,z(a,b)]})})})]:[2];case 1:return q.sent(),[2]}})})}function z(b,c){return e.__awaiter(this,void 0,void 0,function(){var d;return e.__generator(this,
function(e){switch(e.label){case 0:d=b.type;switch(d){case "extrude":return[3,1];case "icon":return[3,2];case "line":return[3,2];case "text":return[3,2];case "path":return[3,3];case "object":return[3,4];case "fill":return[3,6];case "water":return[3,6]}return[3,7];case 1:return b.size="number"===typeof c[2]?c[2]:0,[3,8];case 2:return e=A(c),l.isSome(e)&&(b.size=e),[3,8];case 3:return e=H(c,a.vec3f64.ONES,[b.width,void 0,b.height]),b.width=B(c[0],b.width,1,e),b.height=B(c[2],b.height,1,e),[3,8];case 4:return[4,
E(b,c)];case 5:return e.sent(),[3,8];case 6:return[3,8];case 7:g.neverReached(b),e.label=8;case 8:return[2]}})})}function A(a){for(var b=0;b<a.length;b++){var c=a[b];if("number"===typeof c)return c}return null}function E(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d,g,q;return e.__generator(this,function(e){switch(e.label){case 0:return[4,J(a)];case 1:return c=e.sent(),d=c.resourceSize,g=c.symbolSize,q=H(b,d,g),a.width=B(b[0],g[0],d[0],q),a.depth=B(b[1],g[1],d[1],q),a.height=B(b[2],
g[2],d[2],q),[2]}})})}function H(a,b,c){for(var d=0;3>d;d++){var g=a[d];switch(g){case "symbol-value":return null!=c[d]?c[d]/b[d]:1;case "proportional":break;default:if(g&&b[d])return g/b[d]}}return 1}function J(a){return e.__awaiter(this,void 0,void 0,function(){var b,c,d,g,q,k,f,l;return e.__generator(this,function(e){switch(e.label){case 0:return[4,new Promise(function(a,b){u(["./symbolLayerUtils"],a,b)})];case 1:return b=e.sent(),[4,b.computeObjectLayerResourceSize(a,10)];case 2:c=e.sent();d=
a.width;g=a.height;q=a.depth;k=[d,q,g];f=1;for(l=0;3>l;l++)if(null!=k[l]){f=k[l]/c[l];break}for(l=0;3>l;l++)null==k[l]&&(k[l]=c[l]*f);return[2,{resourceSize:c,symbolSize:k}]}})})}function B(a,b,c,d){switch(a){case "proportional":return c*d;case "symbol-value":return null!=b?b:c;default:return a}}Object.defineProperty(f,"__esModule",{value:!0});var G=/\/resource\/(.*?)\.svg$/,F=new r("white");f.getSymbolOutlineSize=function(a){if(!a)return 0;if(m.isSymbol3D(a)){var d=a.symbolLayers&&a.symbolLayers.length;
d?(a=a.symbolLayers.getItemAt(d-1),a="outline"in a?l.get(a,"outline","size"):void 0):a=void 0;return l.isSome(a)?a:0}return(a=b.getStroke(a))&&c.px2pt(a.width)||0};f.isVolumetricSymbol=function(a){if(!a||!a.symbolLayers)return!1;switch(a.type){case "point-3d":return a.symbolLayers.some(function(a){return"object"===a.type});case "line-3d":return a.symbolLayers.some(function(a){return"path"===a.type});case "polygon-3d":return a.symbolLayers.some(function(a){return"object"===a.type||"extrude"===a.type});
default:return!1}};f.getIconHref=function(a,b){b=b.resource.href;return!k("esri-canvas-svg-support")&&a.styleOrigin&&G.test(b)?b.replace(G,"/resource/png/$1.png"):b};f.applyOpacityToColor=v;f.applyColorToSymbol=function(a,b,c){if(a&&(b||null!=c))if(b&&(b=new r(b)),m.isSymbol3D(a))t(a,b,c);else if(m.isSymbol2D(a)){if(b=b||a.color)a.color=v(b,c);null!=c&&"outline"in a&&a.outline&&a.outline.color&&(a.outline.color=v(a.outline.color,c))}};f.applySizesToSymbol=function(a,b){return e.__awaiter(this,void 0,
void 0,function(){return e.__generator(this,function(c){if(!a||!b)return[2];if(m.isSymbol3D(a))return[2,x(a,b)];if(m.isSymbol2D(a)&&(c=A(b),!l.isNone(c)))switch(a.type){case "simple-marker":a.size=c;break;case "picture-marker":var d=a.width/a.height;1<d?(a.width=c,a.height=c*d):(a.width=c*d,a.height=c);break;case "simple-line":a.width=c;break;case "text":a.font.size=c;break;case "simple-fill":case "picture-fill":break;case "cim":break;default:g.neverReached(a)}return[2]})})};f.applyRotationToSymbol=
function(a,b,c){a&&null!=b&&(m.isSymbol3D(a)?(a=a.symbolLayers)&&a.forEach(function(a){if(a&&"object"===a.type)switch(c){case "tilt":a.tilt=b;break;case "roll":a.roll=b;break;default:a.heading=b}}):!m.isSymbol2D(a)||"simple-marker"!==a.type&&"picture-marker"!==a.type&&"text"!==a.type||(a.angle=b))}})},"esri/symbols/support/previewWebStyleSymbol":function(){define(["require","exports","../../request","../../core/screenUtils"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.previewWebStyleSymbol=
function(f,d,g){var k=f.thumbnail&&f.thumbnail.url;return k?e(k,{responseType:"image"}).then(function(d){d=d.data;var c=!/\\.svg$/i.test(d.src)&&g&&g.disableUpsampling,a=Math.max(d.width,d.height),b=g&&null!=g.maxSize?r.pt2px(g.maxSize):120;c&&(b=Math.min(a,b));c=Math.min(b,g&&null!=g.size?r.pt2px(g.size):a);c!==a&&(a=0!==d.width&&0!==d.height?d.width/d.height:1,1<=a?(d.width=c,d.height=c/a):(d.width=c*a,d.height=c));return g&&g.node?(g.node.appendChild(d),g.node):d}):f.fetchSymbol().then(function(e){return d(e,
g)})}})},"esri/widgets/FeatureTemplates/TemplateItemGroup":function(){define("require exports tslib ../../core/Accessor ../../core/Identifiable ../../core/accessorSupport/decorators".split(" "),function(u,f,e,r,m,d){return function(g){function k(d){d=g.call(this,d)||this;d.items=null;d.label=null;return d}e.__extends(k,g);e.__decorate([d.property()],k.prototype,"items",void 0);e.__decorate([d.property()],k.prototype,"label",void 0);return k=e.__decorate([d.subclass("esri.widgets.FeatureTemplates.TemplateItemGroup")],
k)}(m.IdentifiableMixin(r))})},"esri/widgets/FeatureTemplates/ItemList":function(){define(["require","exports","../support/jsxFactory","../support/widgetUtils"],function(u,f,e,r){function m(a){var b=a.identify,d=a.items,f=a.renderIcon,t=a.filterText,l=a.onItemMouseLeave,m=a.onItemMouseEnter,A=a.onItemSelect;return 0===d.length?e.tsx("div",{class:c.noMatchesMessage,key:"no-matches"},a.messages.noMatches):d[0].items?e.tsx("div",{class:c.scroller,key:"item-container"},d.map(function(a){return k({group:a,
filterText:t,identify:b,renderIcon:f,onItemMouseLeave:l,onItemMouseEnter:m,onItemSelect:A})})):e.tsx("ul",{class:r.classes(c.list,c.scroller),key:"item-container"},d.map(function(a){return g({item:a,identify:b,grouped:!0,onItemMouseLeave:l,onItemMouseEnter:m,onItemSelect:A,renderIcon:f,filterText:t})}))}function d(a){var b=a.id+"-placeholder";return e.tsx("div",{class:c.filterContainer,key:"filter"},e.tsx("input",{"aria-labelledby":b,class:r.classes(c.input,c.filterInput),oninput:function(b){b=b.currentTarget;
a.onFilterChange&&a.onFilterChange(b.value)},value:a.filterText,type:"search"}),a.filterText?null:e.tsx("div",{class:c.filterPlaceholder,id:b,key:"placeholder"},e.tsx("span",{class:c.searchIcon,"aria-hidden":"true"}),e.tsx("div",{class:c.filterPlaceholderText},a.messages.filterPlaceholder)))}function g(a){var b=a.identify,d=a.item,g=a.grouped,k=a.filterText,f=a.onItemSelect,m=a.onItemMouseEnter,A=a.onItemMouseLeave;a=a.renderIcon;b=(b&&b(d)||d.id)+"__"+d.label;return e.tsx("li",{"aria-level":g?"2":
"",class:c.item,"data-item":d,key:b,onclick:function(a){a=a.currentTarget["data-item"];f&&f(a)},onmouseenter:function(a){a=a.currentTarget["data-item"];m&&m(a)},onkeydown:function(a){if("Enter"===a.key||"Space"===a.key)a=a.currentTarget["data-item"],f&&f(a)},onmouseleave:function(a){a=a.currentTarget["data-item"];A&&A(a)},tabIndex:0},e.tsx("div",{class:c.itemContainer},a&&a({item:d}),l({text:d.label,match:k})))}function k(a){var b=a.group,d=a.identify,k=a.onItemMouseLeave,f=a.onItemMouseEnter,x=a.onItemSelect,
m=a.filterText,A=a.renderIcon;a=(d&&d(b)||b.id)+"-heading";return e.tsx("section",{"aria-labelledby":a,class:c.group,key:b.label},e.tsx("h4",{"aria-level":"1",id:a,class:r.classes(c.groupHeader)},l({text:b.label,match:m})),e.tsx("ul",{class:c.list},b.items.map(function(a){return g({item:a,identify:d,grouped:!0,onItemMouseLeave:k,onItemMouseEnter:f,onItemSelect:x,renderIcon:A,filterText:m})})))}function l(a){var b=a.match;a=a.text;var d=null;if(b){var d=a.toLowerCase(),g=b.toLowerCase(),k=d.indexOf(g);
-1===k?d=a:(d=a.substring(0,k),g=a.substr(k,b.length),b=a.substring(k+b.length),d=e.tsx("span",null,d,e.tsx("strong",null,g),b))}else d=a;return e.tsx("span",{class:c.itemLabel},d)}Object.defineProperty(f,"__esModule",{value:!0});var c={base:"esri-item-list",list:"esri-item-list__list",group:"esri-item-list__group",scroller:"esri-item-list__scroller",groupHeader:"esri-item-list__group-header",item:"esri-item-list__list-item",itemSelected:"esri-item-list__list-item--selected",itemContainer:"esri-item-list__list-item-container",
itemLabel:"esri-item-list__list-item-label",noMatchesMessage:"esri-item-list__no-matches-message",noItemsMessage:"esri-item-list__no-items-message",filterContainer:"esri-item-list__filter-container",filterPlaceholder:"esri-item-list__filter-placeholder",filterInput:"esri-item-list__filter-input",filterPlaceholderText:"esri-item-list__filter-placeholder-text",searchIcon:"esri-icon-search",widget:"esri-widget",heading:"esri-widget__heading",input:"esri-input"};f.ItemList=function(a){var b=a.id,g=a.identify,
k=a.filterEnabled,k=void 0===k?!0:k,f=a.items,l=a.messages,z=a.filterText,z=void 0===z?"":z,A=a.onFilterChange,E=a.renderIcon,H=a.onItemMouseLeave,J=a.onItemMouseEnter;a=a.onItemSelect;return e.tsx("div",{class:r.classes(c.base,c.widget)},k?d({filterText:z,messages:l,onFilterChange:A,id:b}):null,m({identify:g,items:f,messages:l,filterText:z,renderIcon:E,onItemMouseLeave:H,onItemMouseEnter:J,onItemSelect:a}))};f.renderItem=g;f.renderGroup=k;f.renderLabel=l})},"esri/widgets/Editor/EditorViewModel":function(){define("require exports tslib ../../core/arrayUtils ../../core/Collection ../../core/Error ../../core/Evented ../../core/HandleOwner ../../core/Logger ../../core/watchUtils ../../core/accessorSupport/decorators ../../layers/GraphicsLayer ../../layers/graphics/editingSupport ../Attachments/AttachmentsViewModel ./CreateWorkflow ./UpdateWorkflow ../FeatureForm/FeatureFormViewModel ../FeatureTemplates/FeatureTemplatesViewModel ../Sketch/SketchViewModel ../Spinner/SpinnerViewModel".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A,E,H){function J(a,b,c){F.error(new d(a,b,c))}function B(a){return a&&q.isEditableLayer(a.layer)}function G(a,b){return a&&r.find(a,function(a){return a.layer===b})}var F=l.getLogger("esri.widgets.Editor.EditorViewModel"),M=["create","update"];return function(d){function g(a){a=d.call(this,a)||this;a._sketchGraphicsLayer=new b({listMode:"hide"});a.activeWorkflow=null;a.activityQueue=[];a.failures=[];a.attachmentsViewModel=new v({abilities:{editing:!0}});
a.featureFormViewModel=new z;a.featureTemplatesViewModel=new A;a.layerInfos=null;a.sketchViewModel=new E({layer:a._sketchGraphicsLayer});a.spinnerViewModel=new H;return a}e.__extends(g,d);g.prototype.initialize=function(){var a=this;this.handles.add([c.on(this,"activeWorkflow","cancel",function(){return a.emit("workflow-cancel")}),c.on(this,"activeWorkflow","commit",function(){return a.emit("workflow-commit")}),c.on(this,"view.allLayerViews","change",function(){return a.notifyChange("editableItems")}),
c.watch(this,"editableItems",function(){var b=a.activeWorkflow;if(b){var c=b.stepId;"create"===b.type?(a.refreshCreationTemplates(),"awaiting-feature-creation-info"!==c||a.canCreate||a._cancelWorkflow()):"update"===b.type&&("awaiting-feature-to-update"===c&&!a.canUpdate||"awaiting-update-feature-candidate"===c&&!b.data.candidates.some(function(b){var c=a.editableItems.find(function(a){return a.layer===b.layer});return c&&-1<c.supports.indexOf("update")}))&&a._cancelWorkflow()}})])};g.prototype.destroy=
function(){var a=this;this._cancelWorkflow().then(function(){return a.view=null})};Object.defineProperty(g.prototype,"allowedWorkflows",{get:function(){return this._get("allowedWorkflows")},set:function(a){a&&0!==a.length||(a=e.__spreadArrays(M));this._set("allowedWorkflows",a)},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"canCreate",{get:function(){return this.editableItems.some(function(a){return-1<a.supports.indexOf("create")})},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,
"canUpdate",{get:function(){return this.editableItems.some(function(a){return-1<a.supports.indexOf("update")})},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"editableItems",{get:function(){var a=this,b=this.get("view.allLayerViews");if(!b)return new m;this.handles.remove("layer-view-property-watchers");var d=function(){return a.notifyChange("editableItems")};return b.filter(B).map(function(b){a.handles.add(c.watch(b,["suspended","suspendInfo"],d),"layer-view-property-watchers");
var g=b.layer,e=b.suspendInfo;b=[];var k=a.allowedWorkflows,q=g.capabilities,f=q.data,q=q.operations,l=G(a.layerInfos,g),f=f.supportsAttachment&&(!l||!1!==l.allowAttachments),k=k.filter(function(a){return l?!1!==l.enabled&&("create"===a&&!1!==l.addEnabled||"update"===a&&!1!==l.updateEnabled):!0}),e=e.layerInvisible||e.layerNotLoaded||e.outsideScaleRange||e.viewNotReady;!e&&r.find(k,function(a){return"create"===a})&&q.supportsAdd&&b.push("create");!e&&r.find(k,function(a){return"update"===a})&&q.supportsUpdate&&
b.push("update");!e&&!1!==(l&&l.deleteEnabled)&&q.supportsDelete&&b.push("delete");return{hasAttachments:f,layer:g,supports:b}}).reverse()},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"state",{get:function(){if(!this.get("view.ready")||0===this.editableItems.length)return"disabled";var a=this.attachmentsViewModel.mode;return"add"===a?"adding-attachment":"edit"===a?"editing-attachment":(a=this.activeWorkflow)?a.stepId:"ready"},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,
"syncing",{get:function(){return 0<this.activityQueue.length},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"view",{set:function(a){this.sketchViewModel.view=a;this.spinnerViewModel.view=a;this._set("view",a)},enumerable:!0,configurable:!0});g.prototype.startCreateWorkflowAtFeatureTypeSelection=function(){return e.__awaiter(this,void 0,void 0,function(){var a;return e.__generator(this,function(b){switch(b.label){case 0:return this.canCreate?[4,this._cancelWorkflow()]:(J("editing:unsupported-workflow",
"Create workflow is unsupported or disabled."),[2]);case 1:return b.sent(),a=this._createCreateWorkflow(),[4,a.start()];case 2:return b.sent(),this._set("activeWorkflow",a),[2]}})})};g.prototype.startCreateWorkflowAtFeatureCreation=function(a){return e.__awaiter(this,void 0,void 0,function(){var b;return e.__generator(this,function(c){switch(c.label){case 0:return this.canCreate?[4,this._cancelWorkflow()]:(J("editing:unsupported-workflow","Update workflow is unsupported or disabled."),[2]);case 1:return c.sent(),
b=this._createCreateWorkflow("awaiting-feature-to-create"),b.data.creationInfo=a,[4,b.start()];case 2:return c.sent(),this._set("activeWorkflow",b),[2]}})})};g.prototype.startCreateWorkflowAtFeatureEdit=function(a){return e.__awaiter(this,void 0,void 0,function(){var b;return e.__generator(this,function(c){switch(c.label){case 0:return this.canCreate?[4,this._cancelWorkflow()]:(J("editing:unsupported-workflow","Update workflow is unsupported or disabled."),[2]);case 1:return c.sent(),b=this._createCreateWorkflow("editing-new-feature"),
b.data.edits.feature=a,[4,b.start()];case 2:return c.sent(),this._set("activeWorkflow",b),[2]}})})};g.prototype.startUpdateWorkflowAtFeatureSelection=function(){return e.__awaiter(this,void 0,void 0,function(){var a;return e.__generator(this,function(b){switch(b.label){case 0:return this.canUpdate?[4,this._cancelWorkflow()]:(J("editing:unsupported-workflow","Update workflow is unsupported or disabled."),[2]);case 1:return b.sent(),a=this._createUpdateWorkflow(),[4,a.start()];case 2:return b.sent(),
this._set("activeWorkflow",a),[2]}})})};g.prototype.startUpdateWorkflowAtMultipleFeatureSelection=function(a){return e.__awaiter(this,void 0,void 0,function(){var b;return e.__generator(this,function(c){switch(c.label){case 0:return this.canUpdate?[4,this._cancelWorkflow()]:(J("editing:unsupported-workflow","Update workflow is unsupported or disabled."),[2]);case 1:return c.sent(),b=this._createUpdateWorkflow("awaiting-update-feature-candidate"),b.data.candidates=a,[4,b.start()];case 2:return c.sent(),
this._set("activeWorkflow",b),[2]}})})};g.prototype.startUpdateWorkflowAtFeatureEdit=function(a){return e.__awaiter(this,void 0,void 0,function(){var b;return e.__generator(this,function(c){switch(c.label){case 0:return this.canUpdate?[4,this._cancelWorkflow()]:(J("editing:unsupported-workflow","Update workflow is unsupported or disabled."),[2]);case 1:return c.sent(),b=this._createUpdateWorkflow("editing-existing-feature"),b.data.edits.feature=a,[4,b.start()];case 2:return c.sent(),this._set("activeWorkflow",
b),[2]}})})};g.prototype.deleteFeatureFromWorkflow=function(){return e.__awaiter(this,void 0,void 0,function(){var a;return e.__generator(this,function(b){switch(b.label){case 0:return a=this.activeWorkflow,a&&"create"!==a.type?[4,this._delete(a.data.edits.feature)]:(J("editing:unsupported-workflow","Deleting requires an active update workflow."),[2]);case 1:return b.sent(),[4,a.reset()];case 2:return b.sent(),[2]}})})};g.prototype.cancelWorkflow=function(a){return e.__awaiter(this,void 0,void 0,
function(){return e.__generator(this,function(b){return[2,this._cancelWorkflow(e.__assign({warn:!0},a))]})})};g.prototype.refreshCreationTemplates=function(){this.featureTemplatesViewModel.layers=this.editableItems.filter(function(a){return-1<a.supports.indexOf("create")}).map(function(a){return a.layer}).toArray()};g.prototype._cancelWorkflow=function(a){return e.__awaiter(this,void 0,void 0,function(){var b,c;return e.__generator(this,function(d){switch(d.label){case 0:b=this.activeWorkflow;if(!b)return a&&
a.warn&&J("editing:no-active-workflow","There is no active workflow to cancel."),[2];c=!a||!1!==a.force;if(!c)return[3,2];this.emit("workflow-cancel");this._set("activeWorkflow",null);return[4,b.cancel(a)];case 1:return d.sent(),[2];case 2:return[4,b.cancel(a)];case 3:return d.sent(),this._set("activeWorkflow",null),[2]}})})};g.prototype._createCreateWorkflow=function(a){var b=this;return t.create(this,a,function(a){return b._create(a)})};g.prototype._createUpdateWorkflow=function(a){var b=this;return x.create(this,
a,function(a){return b._update(a)})};g.prototype._create=function(a){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(b){switch(b.label){case 0:return[4,this._applyEdits(a.layer,{addFeatures:[a]})];case 1:return b.sent(),[2]}})})};g.prototype._delete=function(a){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(b){switch(b.label){case 0:return[4,this._applyEdits(a.layer,{deleteFeatures:[a]})];case 1:return b.sent(),[2]}})})};g.prototype._update=
function(a){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(b){switch(b.label){case 0:return[4,this._applyEdits(a.layer,{updateFeatures:[a]})];case 1:return b.sent(),[2]}})})};g.prototype._applyEdits=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var d;return e.__generator(this,function(g){switch(g.label){case 0:return[4,this._queueOperation(function(){return a.applyEdits(b)})];case 1:return g.sent(),[4,this.view.whenLayerView(a)];case 2:return d=
g.sent(),[4,c.whenFalseOnce(d,"updating")];case 3:return g.sent(),[2]}})})};g.prototype._queueOperation=function(a){var b=this;this.activityQueue.push(a);this.notifyChange("syncing");var c=function(a,b){a=b.indexOf(a);-1<a&&b.splice(a,1)};return a().then(function(a){var b=a.deleteFeatureResults,c=a.updateFeatureResults;if(a=r.find(a.addFeatureResults,function(a){return!!a.error})||r.find(c,function(a){return!!a.error})||r.find(b,function(a){return!!a.error}))throw a.error;}).catch(function(d){J("editing:operation-error",
"An error occurred.",{error:d});var g={error:d,retry:function(){c(g,b.failures);return b._queueOperation(a)},cancel:function(){c(g,b.failures)}};b._set("failures",e.__spreadArrays(b.failures,[g]))}).then(function(){c(a,b.activityQueue);b.notifyChange("syncing")})};e.__decorate([a.property({readOnly:!0})],g.prototype,"activeWorkflow",void 0);e.__decorate([a.property({readOnly:!0})],g.prototype,"activityQueue",void 0);e.__decorate([a.property({value:e.__spreadArrays(M)})],g.prototype,"allowedWorkflows",
null);e.__decorate([a.property({readOnly:!0,dependsOn:["editableItems"]})],g.prototype,"canCreate",null);e.__decorate([a.property({readOnly:!0,dependsOn:["editableItems"]})],g.prototype,"canUpdate",null);e.__decorate([a.property({dependsOn:["allowedWorkflows","layerInfos","view.allLayerViews","view.ready"],readOnly:!0})],g.prototype,"editableItems",null);e.__decorate([a.property({readOnly:!0})],g.prototype,"failures",void 0);e.__decorate([a.property()],g.prototype,"attachmentsViewModel",void 0);e.__decorate([a.property()],
g.prototype,"featureFormViewModel",void 0);e.__decorate([a.property()],g.prototype,"featureTemplatesViewModel",void 0);e.__decorate([a.property()],g.prototype,"layerInfos",void 0);e.__decorate([a.property()],g.prototype,"sketchViewModel",void 0);e.__decorate([a.property()],g.prototype,"spinnerViewModel",void 0);e.__decorate([a.property({dependsOn:["attachmentsViewModel.mode","editableItems","activeWorkflow.stepId","view.ready"]})],g.prototype,"state",null);e.__decorate([a.property({readOnly:!0})],
g.prototype,"syncing",null);e.__decorate([a.property()],g.prototype,"view",null);return g=e.__decorate([a.subclass("esri.widgets.Editor.EditorViewModel")],g)}(k.HandleOwnerMixin(g.EventedAccessor))})},"esri/layers/GraphicsLayer":function(){define("require exports tslib ../core/accessorSupport/decorators ./Layer ./mixins/ScaleRangeLayer ../support/GraphicsCollection ../symbols/support/ElevationInfo".split(" "),function(u,f,e,r,m,d,g,k){return function(d){function c(a){a=d.call(this,a)||this;a.elevationInfo=
null;a.graphics=new g.default;a.screenSizePerspectiveEnabled=!0;a.type="graphics";return a}e.__extends(c,d);c.prototype.destroy=function(){this.removeAll()};c.prototype.add=function(a){this.graphics.add(a);return this};c.prototype.addMany=function(a){this.graphics.addMany(a);return this};c.prototype.removeAll=function(){this.graphics.removeAll();return this};c.prototype.remove=function(a){this.graphics.remove(a)};c.prototype.removeMany=function(a){this.graphics.removeMany(a)};c.prototype.on=function(a,
b){return d.prototype.on.call(this,a,b)};c.prototype.graphicChanged=function(a){this.emit("graphic-update",a)};e.__decorate([r.property({type:k})],c.prototype,"elevationInfo",void 0);e.__decorate([r.property(g.graphicsCollectionProperty)],c.prototype,"graphics",void 0);e.__decorate([r.property({type:["show","hide"]})],c.prototype,"listMode",void 0);e.__decorate([r.property()],c.prototype,"screenSizePerspectiveEnabled",void 0);e.__decorate([r.property({readOnly:!0})],c.prototype,"type",void 0);return c=
e.__decorate([r.subclass("esri.layers.GraphicsLayer")],c)}(d.ScaleRangeLayer(m))})},"esri/layers/graphics/editingSupport":function(){define("require exports tslib ../../Graphic ../../core/Collection ../../core/Error ../../core/lang ../../core/promiseUtils ../../core/urlUtils ../../geometry/support/normalizeUtils".split(" "),function(u,f,e,r,m,d,g,k,l,c){function a(a,c,g){return e.__awaiter(this,void 0,void 0,function(){var q,f;return e.__generator(this,function(e){switch(e.label){case 0:return[4,
a.load()];case 1:e.sent();q=a.source;if(!q||null==q.applyEdits)return[2,k.reject(new d(a.type+"-layer:no-editing-support","Layer source does not support applyEdits capability",{layer:a}))];if(!a.editingEnabled)throw new d(a.type+"-layer:editing-disabled","Editing is disabled for layer",{layer:a});return[4,b(a,c,g)];case 2:return f=e.sent(),f.addFeatures.length||f.updateFeatures.length||f.deleteFeatures.length||f.addAttachments.length||f.updateAttachments.length||f.deleteAttachments.length?[2,q.applyEdits(f,
g)]:[2,{addFeatureResults:[],updateFeatureResults:[],deleteFeatureResults:[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}]}})})}function b(a,b,c){return e.__awaiter(this,void 0,void 0,function(){var g,k,f,l;return e.__generator(this,function(z){g=b&&(b.addFeatures||b.updateFeatures||b.deleteFeatures);k=b&&(b.addAttachments||b.updateAttachments||b.deleteAttachments);if(!b||!g&&!k)throw new d(a.type+"-layer:missing-parameters","'addFeatures', 'updateFeatures', 'deleteFeatures', 'addAttachments', 'updateAttachments' or 'deleteAttachments' parameter is required");
if(!a.capabilities.data.isVersioned&&c&&c.gdbVersion)throw new d(a.type+"-layer:invalid-parameter","'gdbVersion' is applicable only if the layer supports versioned data. See: 'capabilities.data.isVersioned'");if(!a.capabilities.editing.supportsRollbackOnFailure&&c&&c.rollbackOnFailureEnabled)throw new d(a.type+"-layer:invalid-parameter","This layer does not support 'rollbackOnFailureEnabled' parameter. See: 'capabilities.editing.supportsRollbackOnFailure'");if(!a.capabilities.editing.supportsGlobalId&&
c&&c.globalIdUsed)throw new d(a.type+"-layer:invalid-parameter","This layer does not support 'globalIdUsed' parameter. See: 'capabilities.editing.supportsGlobalId'");if(!a.capabilities.editing.supportsGlobalId&&k)throw new d(a.type+"-layer:invalid-parameter","'addAttachments', 'updateAttachments' and 'deleteAttachments' are applicable only if the layer supports global ids. See: 'capabilities.editing.supportsGlobalId'");if((!c||!c.globalIdUsed)&&k)throw new d(a.type+"-layer:invalid-parameter","When 'addAttachments', 'updateAttachments' or 'deleteAttachments' is specified, globalIdUsed should be set to true");
f=e.__assign({},b);f.addFeatures=b&&m.isCollection(b.addFeatures)?b.addFeatures.toArray():f.addFeatures||[];f.updateFeatures=b&&m.isCollection(b.updateFeatures)?b.updateFeatures.toArray():f.updateFeatures||[];f.deleteFeatures=b&&m.isCollection(b.deleteFeatures)?b.deleteFeatures.toArray():f.deleteFeatures||[];f.addAttachments=f.addAttachments||[];f.updateAttachments=f.updateAttachments||[];f.deleteAttachments=f.deleteAttachments||[];f.addFeatures=f.addFeatures.map(x);f.updateFeatures=f.updateFeatures.map(x);
l=c&&c.globalIdUsed;f.addFeatures.forEach(function(b){return q(b,a,l)});f.updateFeatures.forEach(function(b){return q(b,a,l)});f.deleteFeatures.forEach(function(b){return q(b,a,l)});f.addAttachments.forEach(function(b){return v(b,a)});f.updateAttachments.forEach(function(b){return v(b,a)});return[2,t(f)]})})}function q(a,b,c){if(c){if("attributes"in a&&!a.attributes[b.globalIdField])throw new d(b.type+"-layer:invalid-parameter","Feature should have 'globalId' when 'globalIdUsed' is true");if(!("attributes"in
a||a.globalId))throw new d(b.type+"-layer:invalid-parameter","'globalId' of the feature should be passed when 'globalIdUsed' is true");}}function v(a,b){var c=a.feature;a=a.attachment;if(!c||"attributes"in c&&!c.attributes[b.globalIdField])throw new d(b.type+"-layer:invalid-parameter","Attachment should have reference to a feature with 'globalId'");if(!("attributes"in c||c.globalId))throw new d(b.type+"-layer:invalid-parameter","Attachment should have reference to 'globalId' of the parent feature");
if(!a.globalId)throw new d(b.type+"-layer:invalid-parameter","Attachment should have 'globalId'");if(!a.data&&!a.uploadId)throw new d(b.type+"-layer:invalid-parameter","Attachment should have 'data' or 'uploadId'");if(!(a.data instanceof File&&a.data.name||a.name))throw new d(b.type+"-layer:invalid-parameter","'name' is required when attachment is specified as Base64 encoded string using 'data'");if(!b.capabilities.editing.supportsUploadWithItemId&&a.uploadId)throw new d(b.type+"-layer:invalid-parameter",
"This layer does not support 'uploadId' parameter. See: 'capabilities.editing.supportsUploadWithItemId'");if("string"===typeof a.data&&(c=l.dataComponents(a.data))&&!c.isBase64)throw new d(b.type+"-layer:invalid-parameter","Attachment 'data' should be a Blob, File or Base64 encoded string");}function t(a){return e.__awaiter(this,void 0,void 0,function(){var b,d,g,k,q,f;return e.__generator(this,function(e){switch(e.label){case 0:return b=a.addFeatures,d=a.updateFeatures,g=b.concat(d).map(function(a){return a.geometry}),
[4,c.normalizeCentralMeridian(g)];case 1:return k=e.sent(),q=b.length,f=d.length,k.slice(0,q).forEach(function(b,c){a.addFeatures[c].geometry=b}),k.slice(q,q+f).forEach(function(b,c){a.updateFeatures[c].geometry=b}),[2,a]}})})}function x(a){var b=new r;a.attributes||(a.attributes={});b.geometry=a.geometry;b.attributes=a.attributes;return b}Object.defineProperty(f,"__esModule",{value:!0});f.isEditableLayer=function(a){return!0===a.get("capabilities.operations.supportsEditing")};f.applyEdits=function(b,
c,d){return e.__awaiter(this,void 0,void 0,function(){var q,f,l,t,v,x,m;return e.__generator(this,function(e){switch(e.label){case 0:l={edits:c,result:k.create(function(a,b){q=a;f=b})},b.emit("apply-edits",l),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,a(b,c,d)];case 2:return t=e.sent(),v=function(a){return a.filter(function(a){return!a.error}).map(g.clone)},x={addedFeatures:v(t.addFeatureResults),updatedFeatures:v(t.updateFeatureResults),deletedFeatures:v(t.deleteFeatureResults),addedAttachments:v(t.addAttachmentResults),
updatedAttachments:v(t.updateAttachmentResults),deletedAttachments:v(t.deleteAttachmentResults)},(x.addedFeatures.length||x.updatedFeatures.length||x.deletedFeatures.length||x.addedAttachments.length||x.updatedAttachments.length||x.deletedAttachments.length)&&b.emit("edits",x),q(x),[2,t];case 3:throw m=e.sent(),f(m),m;case 4:return[2]}})})}})},"esri/widgets/Editor/CreateWorkflow":function(){define("require exports tslib ../../core/maybe ../../core/accessorSupport/decorators ./CreateWorkflowData ./Edits ./Workflow ./workflowUtils".split(" "),
function(u,f,e,r,m,d,g,k,l){function c(a){if(1!==a.length)return null;a=a[0];if("items"in a){if(1===a.items.length)return a.items[0]}else return a;return null}return function(a){function b(b){b=a.call(this,b)||this;b.type="create";return b}e.__extends(b,a);k=b;b.create=function(a,b,c){a=new d({edits:new g,viewModel:a});c=new k({data:a,afterCommit:c});c._set("steps",this._createWorkflowSteps(c,b));return c};b._createWorkflowSteps=function(a,b){void 0===b&&(b="awaiting-feature-creation-info");var d=
a.data,g=a.handles,k={"awaiting-feature-creation-info":function(){return{id:"awaiting-feature-creation-info",setUp:function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(a){d.creationInfo=null;g.add(d.viewModel.featureTemplatesViewModel.on("select",function(a){a=a.item;d.creationInfo={layer:a.layer,template:a.template};d.viewModel.activeWorkflow.next()}),this.id);return[2]})})},tearDown:function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,
function(a){g.remove(this.id);return[2]})})}}},"awaiting-feature-to-create":function(){return{id:"awaiting-feature-to-create",setUp:function(){return e.__awaiter(this,void 0,void 0,function(){var a,b;return e.__generator(this,function(c){switch(c.label){case 0:return b=(a=g).add,[4,l.setUpFeatureAdd(d.viewModel.sketchViewModel,d.creationInfo,d.viewModel.view,function(a){d.edits.feature=a;d.viewModel.activeWorkflow.next()})];case 1:return b.apply(a,[c.sent(),this.id]),[2]}})})},tearDown:function(){return e.__awaiter(this,
void 0,void 0,function(){return e.__generator(this,function(a){g.remove(this.id);return[2]})})}}},"editing-new-feature":function(){return{id:"editing-new-feature",setUp:function(){return e.__awaiter(this,void 0,void 0,function(){var a,b,c,k,q,f,t,v;return e.__generator(this,function(e){switch(e.label){case 0:return a=d.edits.feature,b=d.viewModel,k=(c=l.findLayerInfo(b.layerInfos,a.layer))&&c.fieldConfig,b.featureFormViewModel.set({feature:a,fieldConfig:k}),q=l.getVisualVariableAttributes(a),[4,l.setUpGeometryUpdate(a,
q,b.sketchViewModel,b.view,function(a){var c=a.geometry;a=a.attributes;if(r.isSome(q.rotation)){var g=q.rotation.field;b.featureFormViewModel.setValue(g,a[g])}r.isSome(q.size)&&(g=q.size.field,b.featureFormViewModel.setValue(g,a[g]));d.edits.updateAttributes(a);d.edits.updateGeometry(c)})];case 1:return f=e.sent(),t=f.interactive,v=f.visual,g.add([d.viewModel.featureFormViewModel.on("value-change",function(){d.edits.updateAttributes(d.viewModel.featureFormViewModel.getValues());a.attributes=d.edits.feature.attributes}),
t,v],this.id),[2]}})})},tearDown:function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(a){d.edits.feature=null;d.viewModel.featureFormViewModel.set({feature:null,fieldConfig:null});g.remove(this.id);return[2]})})}}}},q=!1;a=["awaiting-feature-creation-info","awaiting-feature-to-create","editing-new-feature"].filter(function(a){return q?!0:q=a===b}).map(function(a){return k[a]()});d.viewModel.refreshCreationTemplates();var f=c(d.viewModel.featureTemplatesViewModel.items);
"awaiting-feature-creation-info"===a[0].id&&f&&(d.creationInfo={layer:f.layer,template:f.template},a.shift());return a};var k;return b=k=e.__decorate([m.subclass("esri.widgets.Editor.CreateWorkflow")],b)}(k)})},"esri/widgets/Editor/CreateWorkflowData":function(){define(["require","exports","tslib","../../core/Accessor","../../core/accessorSupport/decorators"],function(u,f,e,r,m){return function(d){function g(){var g=null!==d&&d.apply(this,arguments)||this;g.creationInfo=null;g.edits=null;g.viewModel=
null;return g}e.__extends(g,d);e.__decorate([m.property()],g.prototype,"creationInfo",void 0);e.__decorate([m.property()],g.prototype,"edits",void 0);e.__decorate([m.property()],g.prototype,"viewModel",void 0);return g=e.__decorate([m.subclass("esri.widgets.Editor.CreateWorkflowData")],g)}(r)})},"esri/widgets/Editor/Edits":function(){define("require exports tslib ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/accessorSupport/decorators".split(" "),function(u,f,e,r,m,d,g){function k(g){return d.isNone(g)?
null:JSON.stringify(g)}return function(d){function c(a){a=d.call(this,a)||this;a._baselineAttributesJSON=null;a._baselineGeometryJSON=null;a.feature=null;return a}e.__extends(c,d);Object.defineProperty(c.prototype,"attributesModified",{get:function(){var a=this._baselineAttributesJSON,b=this.feature;return!(!b||a===k(b.attributes))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"geometryModified",{get:function(){var a=this._baselineGeometryJSON,b=this.feature;return!(!b||a===k(b.geometry))},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"modified",{get:function(){return this.attributesModified||this.geometryModified},enumerable:!0,configurable:!0});c.prototype.trackChanges=function(){this.feature&&(this._baselineAttributesJSON=k(this.feature.attributes),this._baselineGeometryJSON=k(this.feature.geometry),this.notifyChange("attributesModified"),this.notifyChange("geometryModified"))};c.prototype.updateAttributes=function(a){this.feature.attributes=a;this.notifyChange("attributesModified")};
c.prototype.updateGeometry=function(a){this.feature.geometry=a;this.notifyChange("geometryModified")};e.__decorate([g.property()],c.prototype,"attributesModified",null);e.__decorate([g.property()],c.prototype,"feature",void 0);e.__decorate([g.property()],c.prototype,"geometryModified",null);e.__decorate([g.property({dependsOn:["attributesModified","geometryModified"]})],c.prototype,"modified",null);return c=e.__decorate([g.subclass("esri.widgets.Editor.Edits")],c)}(m.HandleOwnerMixin(r))})},"esri/widgets/Editor/Workflow":function(){define("require exports tslib ../../core/arrayUtils ../../core/Error ../../core/Evented ../../core/HandleOwner ../../core/promiseUtils ../../core/accessorSupport/decorators".split(" "),
function(u,f,e,r,m,d,g,k,l){return function(c){function a(a){a=c.call(this,a)||this;a._indexHistory=[];a._lastStepIndex=-1;a._stepIndex=-1;a._handleKeys={afterCommit:"after-commit",beforeCommit:"before-commit"};a.data=null;a.started=!1;a.steps=null;a.type=null;return a}e.__extends(a,c);Object.defineProperty(a.prototype,"hasNextStep",{get:function(){var a=this.steps;return!!(a&&this._stepIndex<a.filter(function(a){return!a.parent}).length-1)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"hasPreviousStep",{get:function(){return 0<this._stepIndex},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"stepId",{get:function(){var a=this.steps;return(a=a&&a[this._stepIndex])&&a.id},enumerable:!0,configurable:!0});a.prototype.cancel=function(a){void 0===a&&(a={force:!0});return e.__awaiter(this,void 0,void 0,function(){var b=this;return e.__generator(this,function(c){return!1!==a.force?[2,this._cancel()]:[2,k.create(function(a,c){b.emit("cancel-request",{controller:{allow:function(){b._cancel().then(a)},
deny:function(){return c(new m("workflow:cancel-denied","Request to cancel workflow was denied."))}}})})]})})};a.prototype.commit=function(){return e.__awaiter(this,void 0,void 0,function(){var a,c,d,g,k;return e.__generator(this,function(b){switch(b.label){case 0:return a=this.data,this.handles.remove(this._handleKeys.beforeCommit),c=a.edits.feature,d=c.clone(),a.edits.attributesModified||(g=c.layer.objectIdField,d.attributes=(k={},k[g]=c.getAttribute(g),k)),a.edits.geometryModified||(d.geometry=
null),[4,this.afterCommit(d)];case 1:return b.sent(),this.handles.remove(this._handleKeys.afterCommit),[4,this.reset()];case 2:return b.sent(),this.emit("commit"),[2]}})})};a.prototype.go=function(a){return e.__awaiter(this,void 0,void 0,function(){var b,c;return e.__generator(this,function(d){switch(d.label){case 0:return b=this.steps,c=r.findIndex(b,function(b){return b.id===a}),this._indexHistory.push(this._stepIndex),[4,this._go(c)];case 1:return d.sent(),[2]}})})};a.prototype.next=function(){return e.__awaiter(this,
void 0,void 0,function(){return e.__generator(this,function(a){switch(a.label){case 0:return this._indexHistory.push(this._stepIndex),[4,this._go(this._stepIndex+1)];case 1:return a.sent(),[2]}})})};a.prototype.previous=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(a){switch(a.label){case 0:return[4,this._go(this._indexHistory.pop())];case 1:return a.sent(),[2]}})})};a.prototype.reset=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,
function(a){switch(a.label){case 0:return[4,this._cancel(!1)];case 1:return a.sent(),[4,this.start()];case 2:return a.sent(),[2]}})})};a.prototype.start=function(){return e.__awaiter(this,void 0,void 0,function(){var a;return e.__generator(this,function(b){switch(b.label){case 0:return this._set("started",!0),a=-1===this._stepIndex?0:this._stepIndex,[4,this._go(a)];case 1:return b.sent(),[2]}})})};a.prototype._cancel=function(a){void 0===a&&(a=!0);return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,
function(b){switch(b.label){case 0:if(!this.started)return[3,2];this._set("started",!1);return[4,this.steps[this._stepIndex].tearDown()];case 1:b.sent(),b.label=2;case 2:return this.handles.remove([this._handleKeys.afterCommit,this._handleKeys.beforeCommit]),this._resetIndexing(a),a&&this.emit("cancel"),[2]}})})};a.prototype._go=function(a){void 0===a&&(a=-1);return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(b){switch(b.label){case 0:return-1>=a||a>=this.steps.length?
[2]:this.started?-1<this._lastStepIndex?[4,this.steps[this._lastStepIndex].tearDown()]:[3,2]:(this._stepIndex=a,this._notifyStepProps(),[2]);case 1:b.sent(),b.label=2;case 2:return[4,this.steps[a].setUp()];case 3:return b.sent(),this._stepIndex=this._lastStepIndex=a,this._notifyStepProps(),[2]}})})};a.prototype._resetIndexing=function(a){void 0===a&&(a=!0);this._lastStepIndex=this._stepIndex=-1;this._indexHistory.length=0;a&&this._notifyStepProps()};a.prototype._notifyStepProps=function(){this.notifyChange("stepId");
this.notifyChange("hasPreviousStep");this.notifyChange("hasNextStep")};e.__decorate([l.property()],a.prototype,"afterCommit",void 0);e.__decorate([l.property()],a.prototype,"data",void 0);e.__decorate([l.property()],a.prototype,"hasNextStep",null);e.__decorate([l.property()],a.prototype,"hasPreviousStep",null);e.__decorate([l.property()],a.prototype,"started",void 0);e.__decorate([l.property({readOnly:!0,dependsOn:["steps"]})],a.prototype,"stepId",null);e.__decorate([l.property()],a.prototype,"steps",
void 0);e.__decorate([l.property()],a.prototype,"type",void 0);e.__decorate([l.property()],a.prototype,"commit",null);return a=e.__decorate([l.subclass("esri.widgets.Editor.Workflow")],a)}(g.HandleOwnerMixin(d.EventedAccessor))})},"esri/widgets/Editor/workflowUtils":function(){define("require exports tslib ../../Graphic ../../core/arrayUtils ../../core/compilerUtils ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ../../core/accessorSupport/diffUtils ../../layers/support/fieldUtils ../../renderers/support/clickToleranceUtils ../../renderers/support/utils ../../renderers/visualVariables/support/sizeVariableUtils ../../renderers/visualVariables/support/visualVariableUtils ../../symbols/support/symbolConversion ../../symbols/support/symbolLayerUtils ../../symbols/support/symbolUtils ../../views/support/drapedUtils".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A,E){function H(a){var b=a.layer,c;a:switch(b.renderer.type){case "class-breaks":case "simple":case "unique-value":case "dot-density":case "dictionary":c=!0;break a;default:c=!1}var d=(a=c&&t.getVisualVariableValues(b.renderer,a))?a.map(function(a){return a.variable}):[];c=d.filter(function(a){return"rotation"===a.type&&(!a.axis||"heading"===a.axis)});a=c[0];c=1===c.length&&a.field&&!a.valueExpression;var g=d.filter(function(a){return"size"===a.type}),d=
g[0],g=1===g.length&&"real-world-size"===v.getTransformationType(d)&&d.field&&!d.useSymbolValue&&!d.valueExpression;return{rotation:c?J(a,b):null,size:g?F(d,b):null}}function J(a,b){var c="heading"===(a.axis||"heading")&&"arithmetic"===a.rotationType?-1:1,d=a.field,g=(a=b.fields&&b.fields.filter(function(a){return a.name===d}))&&1===a.length?a[0].type:"double",e=0,q=0;return{field:d,getDefault:function(){return k.resolve(0)},getValue:function(a){q=e-c*a;return M((q+360)%360,g)},initValue:function(a){e=
null!=a?a:q;q=0},isUpdatingInteractively:!1}}function B(a,b){switch(b){case "width":return a[0];case "depth":return a[1];case "height":return a[2];default:return a[2]||a[1]||a[0]}}function G(a,b,c){return e.__awaiter(this,void 0,void 0,function(){var k,q,l,t,v,m,r,A;return e.__generator(this,function(e){switch(e.label){case 0:if(g.isNone(b))return[2,0];k=x.to3D(b).symbol;if(g.isNone(k)||"web-style"===k.type)return[2,0];q=k.symbolLayers.getItemAt(0);if(!q)return[2,0];l=q.type;switch(l){case "icon":return[3,
1];case "text":return[3,4];case "line":return[3,5];case "object":return[3,6];case "path":return[3,8];case "extrude":return[3,8];case "fill":return[3,9];case "water":return[3,9]}return[3,10];case 1:if(t=q.size)return[3,3];m=(v=Math).min;r=[f.sizeDefaults.icon];return[4,z.computeIconLayerResourceSize(q,f.sizeDefaults.icon)];case 2:t=m.apply(v,r.concat([e.sent()[0]])),e.label=3;case 3:return[2,t||f.sizeDefaults.icon];case 4:return[2,q.size||f.sizeDefaults.text];case 5:return[2,q.size||f.sizeDefaults.line];
case 6:return[4,z.computeObjectLayerResourceSize(q,a.scale/f.sizeDefaults.viewScaleSizeFactor)];case 7:return A=e.sent(),[2,B(A,c)];case 8:return[2,q.size||a.scale/f.sizeDefaults.viewScaleSizeFactor];case 9:return[2,0];case 10:return d.neverReached(q),[2,0]}})})}function F(a,b){var c=this,d=a.field,g=a.axis,k=(b=b.fields&&b.fields.filter(function(a){return a.name===d}))&&1===b.length?b[0].type:"double",f=0,l=0,t=q.meterIn[a.valueUnit],v;v="area"===a.valueRepresentation?function(a){return Math.pow(a*
t/2,2)*Math.PI}:"radius"===a.valueRepresentation||"distance"===a.valueRepresentation?function(a){return a*t/2}:function(a){return a*t};return{field:d,getDefault:function(a,b){return e.__awaiter(c,void 0,void 0,function(){var c,d;return e.__generator(this,function(e){switch(e.label){case 0:return c=M,d=v,[4,G(b,a,g)];case 1:return[2,c.apply(void 0,[d.apply(void 0,[e.sent()]),k])]}})})},getValue:function(a,b){f||(f=b.pixelSizeAt(b.center));l=f*a;return M(l,k)},initValue:function(a){f=null!=a?a:l;l=
0},isUpdatingInteractively:!1}}function M(a,b){switch(b){case "small-integer":case "integer":case "long":return Math.round(a);case "double":case "single":return a;default:return 0}}function R(a){return e.__awaiter(this,void 0,void 0,function(){var b,d;return e.__generator(this,function(e){switch(e.label){case 0:return[4,A.getDisplayedSymbol(a,{ignoreGraphicSymbol:!0})];case 1:return b=e.sent(),d=c.diff(a.symbol,b),g.isSome(d)&&(a.symbol=b),[2]}})})}function T(a,b,c){return e.__awaiter(this,void 0,
void 0,function(){var d,k,q,f,l,t,v,x,m,z,E,B,J,F;return e.__generator(this,function(G){switch(G.label){case 0:if("3d"!==c.type)return[2];d=b.layer;k=e.__assign({},b.template.prototype.attributes);q=new r({layer:d,sourceLayer:d,attributes:k});f=H(q);l=f.rotation;t=f.size;return[4,A.getDisplayedSymbol(q)];case 1:v=G.sent(),x=!1,m=0,z=[t,l],G.label=2;case 2:if(!(m<z.length))return[3,5];E=z[m];if(g.isNone(E))return[3,4];B=k[E.field];if(null!=B)return[3,4];J=k;F=E.field;return[4,E.getDefault(v,c)];case 3:J[F]=
G.sent(),x=!0,G.label=4;case 4:return m++,[3,2];case 5:return x?[4,A.getDisplayedSymbol(q)]:[3,7];case 6:v=G.sent(),G.label=7;case 7:switch(null===v||void 0===v?void 0:v.type){case "simple-fill":case "polygon-3d":a.polygonSymbol=v;break;case "simple-line":case "line-3d":a.polylineSymbol=v;break;case "simple-marker":case "point-3d":a.pointSymbol=v}return[2]}})})}function O(b,c,d){return e.__awaiter(this,void 0,void 0,function(){var g,q;return e.__generator(this,function(e){switch(e.label){case 0:return 0===
b.length?[2,[]]:[4,c.hitTest(d)];case 1:g=e.sent();if(0===g.results.length)return[2,[]];q=new Map;g.results.forEach(function(a){a=a.graphic;var b=a.layer;q.has(b)||q.set(b,[]);q.get(b).push(a)});return[2,k.eachAlways(b.items.filter(function(a){var b=a.layer;return-1<a.supports.indexOf("update")&&q.has(b)}).map(function(b){b=b.layer;var c=b.displayField,d=[b.objectIdField];a.hasField(b.fields,c)&&d.push(c);c=q.get(b);if(c.some(function(a){return d.some(function(b){return!(b in a.attributes)})})){var g=
b.createQuery();g.outFields=d;g.returnGeometry=!1;g.objectIds=c.map(function(a){return a.getObjectId()});return b.queryFeatures(g).then(function(a){return a.features})}return k.resolve(c)}))]}})})}function L(c,d,g){return e.__awaiter(this,void 0,void 0,function(){var q,f;return e.__generator(this,function(e){switch(e.label){case 0:return 0===c.length?[2,[]]:[4,d.hitTest(g)];case 1:q=e.sent();if(0===q.results.length)return[2,[]];f=new Set;q.results.forEach(function(a){return f.add(a.graphic.layer)});
return[2,k.eachAlways(c.items.filter(function(a){var b=a.layer;return-1<a.supports.indexOf("update")&&f.has(b)}).map(function(c){c=c.layer;var e=c.displayField,k=[c.objectIdField];a.hasField(c.fields,e)&&k.push(e);e=c.createQuery();e.outFields=k;e.returnGeometry=!1;k=b.calculateTolerance({renderer:c.renderer,event:g});e.geometry=E.createQueryGeometry(g.mapPoint,k,d);return c.queryFeatures(e).then(function(a){return a.features})}))]}})})}Object.defineProperty(f,"__esModule",{value:!0});f.getVisualVariableAttributes=
H;f.setUpFeatureAdd=function(a,b,c,d){return e.__awaiter(this,void 0,void 0,function(){var g,k,q,f=this;return e.__generator(this,function(l){switch(l.label){case 0:return g=b.layer,[4,T(a,b,c)];case 1:return l.sent(),a.layer.elevationInfo=g.elevationInfo,k=function(){return a.create(g.geometryType,{hasZ:g.capabilities.data.supportsZ})},[4,k()];case 2:return l.sent(),q=a.on("create",function(c){return e.__awaiter(f,void 0,void 0,function(){var q,f,l;return e.__generator(this,function(t){switch(t.label){case 0:q=
c.state;f=c.graphic;if("cancel"===q)return k(),[2];if("complete"!==q)return[3,2];l=f.clone();l.attributes=e.__assign({},b.template.prototype.attributes);l.layer=g;a.layer.remove(f);return[4,R(l)];case 1:t.sent(),d(l),t.label=2;case 2:return[2]}})})}),c.map.add(a.layer),[2,{remove:function(){q.remove();c.map.remove(a.layer);a.cancel()}}]}})})};f.findLayerInfo=function(a,b){return a&&m.find(a,function(a){return a.layer===b})};f.fetchCandidates=function(a,b,c){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,
function(g){switch(b.type){case "3d":return[2,O(a,b,c)];case "2d":return[2,L(a,b,c)];default:return d.neverReached(b),[2,null]}})})};f.fetchFullFeature=function(a,b,c){var d=a.layer,g=d.createQuery();g.objectIds=[a.getAttribute(d.objectIdField)];g.outFields=["*"];g.outSpatialReference=b.spatialReference;g.returnM=d.capabilities.data.supportsM;g.returnZ=d.capabilities.data.supportsZ;return d.queryFeatures(g,c).then(function(a){return a.features[0]})};f.setUpGeometryUpdate=function(a,b,c,d,k){return e.__awaiter(this,
void 0,void 0,function(){var q,f,l,t,v,x,m,z,r,A,H=this;return e.__generator(this,function(E){switch(E.label){case 0:return q=a.clone(),[4,R(q)];case 1:return E.sent(),c.layer.add(q),q.sourceLayer=a.layer,f=function(){var b=a.layer;if("graphics"===b.type)return{remove:function(){}};var c=a.attributes[b.objectIdField],g=d.whenLayerView(b);g.then(function(a){return a.setVisibility(c,!1)});return{remove:function(){g.then(function(a){return a.setVisibility(c,!0)})}}},l=f(),t=a.layer,v=b.size,x=b.rotation,
m={multipleSelectionEnabled:!1},"point"===t.geometryType&&(m.enableRotation=!!x,m.enableScaling=!!v),c.layer.elevationInfo=t.elevationInfo,c.update(q,m),z=(g.isSome(v)||g.isSome(x))&&a.watch("attributes",function(a){return e.__awaiter(H,void 0,void 0,function(){var b,c,k;return e.__generator(this,function(e){switch(e.label){case 0:b=!1;for(c in a)k=a[c],k!==q.attributes[c]&&(q.setAttribute(c,k),b=!0,g.isSome(v)&&!v.isUpdatingInteractively&&v.field===c&&v.initValue(k),g.isSome(x)&&!x.isUpdatingInteractively&&
x.field===c&&x.initValue(k));return b&&"3d"===d.type?[4,R(q)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})}),[x,v].forEach(function(b){return e.__awaiter(H,void 0,void 0,function(){var c,k;return e.__generator(this,function(e){switch(e.label){case 0:if(g.isNone(b))return[2];c=a.attributes[b.field];if(null==c)return[3,1];b.initValue(c);return[3,4];case 1:return[4,b.getDefault(q.symbol,d)];case 2:return k=e.sent(),b.initValue(k),q.setAttribute(b.field,k),"3d"!==d.type?[3,4]:[4,R(q)];case 3:e.sent(),
e.label=4;case 4:return[2]}})})}),r=c.on("update",function(a){return e.__awaiter(H,void 0,void 0,function(){var b,f,l,t,z,r,A,H;return e.__generator(this,function(e){switch(e.label){case 0:b=a.graphics[0];f=a.state;l=a.toolEventInfo;if("complete"===f)return c.update(b,m),[2];t=l;g.isSome(x)&&t&&(z=x.field,r=x.getValue,A=x.initValue,"rotate-stop"===t.type?(x.isUpdatingInteractively=!1,A()):null!=t.angle&&(x.isUpdatingInteractively=!0,q.attributes[z]=r(t.angle/Math.PI*180,d)));H=l;g.isSome(v)&&H&&(z=
v.field,r=v.getValue,A=v.initValue,"scale-stop"===H.type?(v.isUpdatingInteractively=!1,A()):null!=H.xScale&&(v.isUpdatingInteractively=!0,q.attributes[z]=r(H.xScale,d)));return"3d"!==d.type?[3,2]:[4,R(q)];case 1:e.sent(),e.label=2;case 2:return k(b.clone()),[2]}})})}),d.map.add(c.layer),A=function(){},[2,{interactive:{remove:function(){r.remove();c.cancel();z&&z.remove();this.remove=A}},visual:{remove:function(){l.remove();d.map.remove(c.layer);c.layer.removeAll();this.remove=A}}}]}})})};f.sizeDefaults=
{icon:l.px2pt(24),text:l.px2pt(12),line:l.px2pt(1),viewScaleSizeFactor:100}})},"esri/renderers/support/clickToleranceUtils":function(){define(["require","exports"],function(u,f){function e(d,g){return g?"xoffset"in g&&g.xoffset?Math.max(d,Math.abs(g.xoffset)):"yoffset"in g&&g.yoffset?Math.max(d,Math.abs(g.yoffset||0)):d:d}function r(d,g){if("number"===typeof d)return d;if(d&&d.stops&&d.stops.length){d=d.stops;for(var e=g=0,f=0;f<d.length;f++){var c=d[f].size;"number"===typeof c&&(g+=c,e++)}return g/
e}return g}function m(d,g){if(!g)return d;g=g.filter(function(a){return"size"===a.type}).map(function(a){var b=a.minSize;return(r(a.maxSize,d)+r(b,d))/2});var e=0,f=g.length;if(0===f)return d;for(var c=0;c<f;c++)e+=g[c];return Math.max(Math.floor(e/f),d)}Object.defineProperty(f,"__esModule",{value:!0});f.calculateTolerance=function(d){var g=d&&d.renderer;d="touch"===(d&&d.event&&d.event.pointerType)?9:6;if(!g)return d;d="visualVariables"in g?m(d,g.visualVariables):d;if("simple"===g.type)return e(d,
g.symbol);if("unique-value"===g.type){var k=d;g.uniqueValueInfos.forEach(function(c){k=e(k,c.symbol)});return k}if("class-breaks"===g.type){var f=d;g.classBreakInfos.forEach(function(c){f=e(f,c.symbol)});return f}return d}})},"esri/symbols/support/symbolLayerUtils":function(){define("require exports tslib ../../request ../../core/Error ../../core/ItemCache ../../core/maybe ../../core/promiseUtils ../../geometry/support/aaBoundingBox ../../views/3d/layers/graphics/Graphics3DIconSymbolLayer ../../views/3d/layers/graphics/graphicUtils ../../views/3d/layers/graphics/objectResourceUtils ../../views/3d/layers/graphics/primitiveObjectSymbolUtils".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q){function v(a,b){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(d){if(a.resource.href)return[2,x(a.resource.href).then(function(a){return[a.width,a.height]})];if(a.resource.primitive)return g.isSome(b)?[2,[b,b]]:[2,c.default.PRIMITIVE_SIZE];throw new m("symbol3d:invalid-symbol-layer","symbol layers of type Icon must have either an href or a primitive resource");})})}function t(a,b){return v(a,b).then(function(b){if(null==a.size)return b;
b=b[0]/b[1];return 1<b?[a.size,a.size/b]:[a.size*b,a.size]})}function x(a){return r(a,{responseType:"image"}).then(function(a){return a.data})}function z(a,b){return E(a,b).then(function(a){return l.size(a)})}function A(b,c){return z(b,c).then(function(c){return a.computeSizeWithResourceSize(c,b)})}function E(a,c){if(!a.isPrimitive){var d=a.resource.href;c=H.get(d);return void 0!==c?k.resolve(c):b.fetch(d,{disableTextures:!0}).then(function(a){H.put(d,a.referenceBoundingBox);return a.referenceBoundingBox})}var e=
null;if(a.resource&&a.resource.primitive&&(e=l.create(q.primitiveBoundingBox(a.resource.primitive)),g.isSome(c)))for(a=0;a<e.length;a++)e[a]*=c;return e?k.resolve(e):k.reject(new m("symbol:invalid-resource","The symbol does not have a valid resource"))}Object.defineProperty(f,"__esModule",{value:!0});var H=new d(50);f.clearBoundingBoxCache=function(){H=new d(50)};f.computeLayerResourceSize=function(a,b){if("icon"===a.type)return v(a,b);if("object"===a.type)return z(a,b);throw new m("symbol3d:unsupported-symbol-layer",
"computeLayerSize only works with symbol layers of type Icon and Object");};f.computeLayerSize=function(a,b){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(c){if("icon"===a.type)return[2,t(a,b)];if("object"===a.type)return[2,A(a,b)];throw new m("symbol3d:unsupported-symbol-layer","computeLayerSize only works with symbol layers of type Icon and Object");})})};f.computeIconLayerResourceSize=v;f.computeObjectLayerResourceSize=z})},"esri/views/3d/layers/graphics/Graphics3DIconSymbolLayer":function(){define("require exports tslib ../../../../Color ../../../../symbols ../../../../core/asyncUtils ../../../../core/compilerUtils ../../../../core/Error ../../../../core/has ../../../../core/lang ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../core/urlUtils ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/vec4f64 ../../../../geometry/support/aaBoundingBox ../../../../support/arcadeOnDemand ../../../../symbols/cim/CIMSymbolRasterizer ../../../../symbols/support/IconSymbol3DLayerResource ../../../../symbols/support/utils ../../../2d/arcade/utils ./constants ./ElevationAligners ./elevationAlignmentUtils ./ElevationContext ./Graphics3DDrapedGraphicLayer ./Graphics3DObject3DGraphicLayer ./Graphics3DSymbolLayer ./graphicUtils ./pointUtils ./sdfPrimitives ../support/FastSymbolUpdates ../../support/projectionUtils ../../terrain/OverlayRenderer ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/lib/Texture ../../webgl-engine/materials/HUDMaterial".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A,E,H,J,B,G,F,M,R,T,O,L,Q,S,aa,ba,V,Z,ha,X,ea,ga,oa,ja,da){function ma(b){return a.isSome(b)?"cross"===b||"x"===b:!1}Object.defineProperty(f,"__esModule",{value:!0});var fa=t.mat4f64.create(),la=z.vec3f64.fromValues(0,0,1),ia=[.25,.25,.75,.75],ca=[64,64];u=function(f){function t(a,b,c,d){a=f.call(this,a,b,c,d)||this;a._cimLayers=null;a._cimSymbolMaterials=new Map;a._cimSymbolTextures=new Map;a._cimMaterialParametersInfo=null;a._cimRequiredFields=null;a._cimScaleFactorOrFunction=
null;a._size=null;a._symbolTextureRatio=1;a._outlineSize=0;a._texture=null;a._releaseTexture=null;a._elevationOptions={supportsOffsetAdjustment:!0,supportsOnTheGround:!0};return a}e.__extends(t,f);t.prototype.getCachedSize=function(){return{size:this._getIconSize()}};t.prototype.doLoad=function(b){return e.__awaiter(this,void 0,void 0,function(){var c,d,g,k;return e.__generator(this,function(e){switch(e.label){case 0:this._validateOrThrow();c=this._prepareMaterialParameters();d=this._getPrimitive();
if(!a.isSome(d))return[3,1];this._prepareResourcesPrimitive(c,d);return[3,5];case 1:return g=G.getIconHref(this.symbol,this.symbolLayer),(k=v.dataComponents(g))&&"application/json"===k.mediaType?[4,this._prepareResourcesCIM(c,JSON.parse(k.data),b)]:[3,3];case 2:return e.sent(),[3,5];case 3:return[4,this._prepareResourcesHref(c,g,b)];case 4:e.sent(),e.label=5;case 5:return[2]}})})};t.prototype._validateOrThrow=function(){if(!this._drivenProperties.size){var a=aa.validateSymbolLayerSize(this._getIconSize());
if(a)throw new k("graphics3diconsymbollayer:invalid-size",a);}};t.prototype._getIconSize=function(){var a=this.symbolLayer,a=Math.round(null!=a.size?q.pt2px(a.size):16);return this._drivenProperties.size?Math.max(a,64):a};t.prototype._generateTextureCIM=function(a){var b=this._getGraphicHash(a),c=""===b?null:this._cimSymbolTextures.get(b);c||(a=this._context.sharedResources.cimSymbolRasterizer.rasterizeCIMSymbol(this._cimLayers,a,"esriGeometryPoint",{scaleFactor:this._cimScaleFactorOrFunction},null,
null),this._cimMaterialParametersInfo.anchorPos=this._getAnchorPos("relative",a.anchorPosition),c=new ja(a.imageData,"symbol",{width:a.imageData.width,height:a.imageData.height,powerOfTwoResizeMode:2}),this._cimSymbolTextures.set(b,c),this._context.stage.add(4,c));return c};t.prototype._computeSize=function(a,b){a=a.width/a.height;return 1<a?[b,Math.round(b/a)]:[Math.round(b*a),b]};t.prototype._prepareMaterialParameters=function(){var a={anchorPos:this._getAnchorPos(this.symbolLayer.anchor,this.symbolLayer.anchorPosition)},
b=this.symbol;if(b&&"point-3d"===b.type&&b.hasVisibleVerticalOffset()){var b=b.verticalOffset,c=b.minWorldLength,d=b.maxWorldLength;a.verticalOffset={screenLength:q.pt2px(b.screenLength),minWorldLength:c||0,maxWorldLength:null!=d?d:Infinity}}this._context.screenSizePerspectiveEnabled&&(a.screenSizePerspective=this._context.sharedResources.screenSizePerspectiveSettings);a.occlusionTest=!0;a.slicePlaneEnabled=this._context.slicePlaneEnabled;return a};t.prototype._prepareResourcesPrimitive=function(a,
b){var c=this,d=this._getOutlineSize();if(ma(b)&&0===d)throw Error("Nothing to render");this._outlineSize=d;a.color=this._getFillColor();a.outlineColor=this._getOutlineColor();a.outlineSize=this._outlineSize;var e=this._context.sharedResources.textures.fromData(b,function(){var a;switch(b){case "circle":a=V.createCircle(128,64);break;case "square":a=V.createSquare(128,64);break;case "kite":a=V.createKite(128,64);break;case "cross":a=V.createCross(128,64);break;case "x":a=V.createX(128,64);break;case "triangle":a=
V.createTriangle(128,64);break;default:g.neverReached(b)}return new ja(a,"sdf_"+b,{mipmap:!1,wrap:{s:33071,t:33071},width:128,height:128,components:4,noUnpackFlip:!0})});this._texture=e.texture;this._releaseTexture=function(){return c._context.sharedResources.textures.release(e.uid)};a.textureIsSignedDistanceField=!0;a.distanceFieldBoundingBox=ia;a.textureId=this._texture.id;d=this._getIconSize();this._size=[d,d];this._symbolTextureRatio=2;this._createMaterialAndAddToStage(a,this._context.stage)};
t.prototype._prepareResourcesHref=function(a,c,g){return e.__awaiter(this,void 0,void 0,function(){var q,f,t,w,x,I,n,h,p=this;return e.__generator(this,function(y){switch(y.label){case 0:if(!l("esri-canvas-svg-support")&&v.isSVG(c))throw q="IconSymbol3DLayer failed to load (SVG symbols are not supported in IE11)",new k("graphics3diconsymbollayer:unsupported-image-format",q);this._outlineSize=this._getOutlineSize();a.color=this._getFillColor();a.outlineColor=this._getOutlineColor();a.outlineSize=this._outlineSize;
a.textureIsSignedDistanceField=!1;f=this._getIconSize();t=f*this._context.layerView.view.pixelRatio;return[4,d.result(this._context.sharedResources.textures.fromUrl(c,t,{signal:g}))];case 1:w=y.sent();if(!1===w.ok)throw b.throwIfAbortError(w.error),q="Failed to load (Request for icon resource failed: "+c+")",new k("graphics3diconsymbollayer:request-failed",q);x=w.value;I=x.uid;n=x.texture;this._releaseTexture=function(){return p._context.sharedResources.textures.release(I)};h=n.params;this._size=
this._computeSize(h,f);a.textureId=n.id;this._createMaterialAndAddToStage(a,this._context.stage);return[2]}})})};t.prototype._prepareResourcesCIM=function(a,c,d){return e.__awaiter(this,void 0,void 0,function(){var g,k,q,w,f,I,n,h,p,y,D;return e.__generator(this,function(K){switch(K.label){case 0:return g=new m.CIMSymbol({data:c}),this._context.sharedResources.cimSymbolRasterizer||(this._context.sharedResources.cimSymbolRasterizer=new J.CIMSymbolRasterizer(this._context.renderCoordsHelper.spatialReference,
!0)),k=this._context.layer.fields?this._context.layer.fields.map(function(h){return h.toJSON()}):null,q=this,[4,this._context.sharedResources.cimSymbolRasterizer.analyzeCIMSymbol(g,k,this._context.renderer&&"dictionary"===this._context.renderer.type?this._context.renderer.fieldMap:null,"esriGeometryPoint",{signal:d})];case 1:q._cimLayers=K.sent();if(!this._context.renderer||"dictionary"!==this._context.renderer.type||!this._context.renderer.scaleExpression)return[3,4];I=this._context.renderer;if(!isNaN(I.scaleExpression))return[3,
3];n=I.scaleExpression;return[4,H.createRendererExpression(n,this._context.layer.spatialReference,k)];case 2:return h=K.sent(),f=function(p,y,n){p=F.callWithFeature(h,p,{$view:n},"esriGeometryPoint",y);return null!==p?p:1},[3,4];case 3:w=Number(I.scaleExpression),K.label=4;case 4:this._cimScaleFactorOrFunction=w||f||1;if(this._context.renderer)return[3,5];y=[];return[3,7];case 5:return[4,this._context.renderer.getRequiredFields(this._context.layer.fields)];case 6:y=K.sent(),K.label=7;case 7:return p=
y,b.throwIfAborted(d),D=this._context.layer.fieldsIndex,this._cimRequiredFields=p.map(function(h){return D.get(h).name}),this._cimMaterialParametersInfo=a,this._cimMaterialParametersInfo.color=this._getFillColor(),this._cimMaterialParametersInfo.outlineColor=[0,0,0,0],this._cimMaterialParametersInfo.outlineSize=0,this._cimMaterialParametersInfo.textureIsSignedDistanceField=!1,[2]}})})};t.prototype._getPrimitive=function(){return this.symbolLayer.resource&&this.symbolLayer.resource.href?null:this.symbolLayer.resource&&
this.symbolLayer.resource.primitive||B.defaultPrimitive};t.prototype._getOutlineSize=function(){var b=0,b=this.symbolLayer;if(a.isSome(b.outline)&&null!=b.outline.size)return Math.max(q.pt2px(b.outline.size),0);b=this._getPrimitive();b=ma(b)?1.5:0;return Math.max(b,0)};t.prototype._getOutlineColor=function(){var b=this._getLayerOpacity(),c=a.get(this.symbolLayer,"outline","color");if(a.isSome(c)){var d=r.toUnitRGB(c);return[d[0],d[1],d[2],c.a*b]}return[0,0,0,0]};t.prototype._getFillColor=function(){if(ma(this._getPrimitive()))return M.TRANSPARENT_UNIT;
var b=a.isNone(this._getPrimitive()),c=a.get(this.symbolLayer,"material","color");return this._getCombinedOpacityAndColor(c,{hasIntrinsicColor:b})};t.prototype._getAnchorPos=function(a,b){return"relative"===a?x.vec2f64.fromValues((b.x||0)+.5,-(b.y||0)+.5):a in aa.namedAnchorToHUDMaterialAnchorPos?aa.namedAnchorToHUDMaterialAnchorPos[a]:aa.namedAnchorToHUDMaterialAnchorPos.center};t.prototype._createMaterialAndAddToStage=function(a,b){this._fastUpdates=this._cimLayers?{enabled:!1}:Z.initFastSymbolUpdatesState(this._context.renderer,
this._fastVisualVariableConvertOptions());this._fastUpdates.enabled&&c.mixin(a,this._fastUpdates.materialParameters);if(this._cimLayers){var d=this._cimSymbolMaterials.get(a.textureId);d||(d=new da.default(a,this._getIdHint("_icon")),this._cimSymbolMaterials.set(a.textureId,d),b.add(3,d));return d}this._material=new da.default(a,this._getIdHint("_icon"));b.add(3,this._material);return this._material};t.prototype._setDrapingDependentMaterialParameters=function(){this.draped&&(this._forEachMaterial(function(a){a.setParameterValues({verticalOffset:null,
screenSizePerspective:null,occlusionTest:!1,slicePlaneEnabled:!1,shaderPolygonOffset:0})}),this.layerOpacityChanged())};t.prototype.destroy=function(){var b=this;f.prototype.destroy.call(this);this._forEachMaterial(function(a){b._context.stage.remove(3,a.id)});a.isSome(this._material)&&(this._material=null);this._cimSymbolMaterials.clear();this._cimSymbolTextures.forEach(function(a){b._context.stage.remove(4,a.id)});this._cimSymbolTextures.clear();this._releaseTexture&&(this._releaseTexture(),this._releaseTexture=
null)};t.prototype._getScaleFactor=function(a,b){if(this._drivenProperties.size&&a.size){for(var c=0;3>c;c++){var d=a.size[c];d&&"symbol-value"!==d&&"proportional"!==d&&(a.size[c]=q.pt2px(d))}if("symbol-value"===a.size[0])return 1;if(isFinite(+a.size[0]))return+a.size[0]/b;if(isFinite(+a.size[2]))return+a.size[2]/b}return 1};t.prototype.createGraphics3DGraphic=function(b){var c=b.renderingInfo,d=b.graphic,g,k;if(this._cimLayers){if(!this._cimLayers.length)return null;var q=this._generateTextureCIM(d);
k=e.__assign({textureId:q.id},this._cimMaterialParametersInfo);k=this._createMaterialAndAddToStage(k,this._context.stage);g=[q.params.width,q.params.height]}else g=this._size,k=a.unwrap(this._material);if(!this._validateGeometry(d.geometry))return null;q=ba.placePointOnGeometry(d.geometry);if(a.isNone(q))return this.logger.warn("unsupported geometry type for icon symbol: "+d.geometry.type),null;var w="graphic"+d.uid,f=this._getVertexOpacityAndColor(c),I=1;this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size||
(I=this._getScaleFactor(c,g[0]>g[1]?g[0]:g[1]));I*=this._symbolTextureRatio;c=[g[0]*I,g[1]*I];g=this.setGraphicElevationContext(d,new O.ElevationContext);this.ensureDrapedStatus("on-the-ground"===g.mode)&&this._setDrapingDependentMaterialParameters();return this.draped?this._createAsOverlay(d,q,k,f,c,b.layer.uid):this._createAs3DShape(d,q,k,f,c,g,w,d.uid)};t.prototype.layerOpacityChanged=function(){var a=this._getFillColor(),b=this._getOutlineColor();this._forEachMaterial(function(c){c.setParameterValues({color:a});
c.setParameterValues({outlineColor:b})});return!0};t.prototype.layerElevationInfoChanged=function(a,b,c){var d=this._elevationContext.mode;c=T.elevationModeChangeUpdateType(t.elevationModeChangeTypes,c,d);if(c!==T.SymbolUpdateType.UPDATE)return c;var g=T.needsElevationUpdates2D(d)||"absolute-height"===d;return this.updateGraphics3DGraphicElevationInfo(a,b,function(){return g})};t.prototype.slicePlaneEnabledChanged=function(){var a=this;this.draped||this._forEachMaterial(function(b){b.setParameterValues({slicePlaneEnabled:a._context.slicePlaneEnabled})});
return!0};t.prototype.physicalBasedRenderingChanged=function(){return!0};t.prototype.pixelRatioChanged=function(){return this._getPrimitive()?!0:!1};t.prototype.applyRendererDiff=function(b,c){for(var d in b.diff)switch(d){case "visualVariables":if(Z.updateFastSymbolUpdatesState(this._fastUpdates,c,this._fastVisualVariableConvertOptions()))a.isSome(this._material)&&this._material.setParameterValues(this._fastUpdates.materialParameters);else return!1;break;default:return!1}return!0};t.prototype._defaultElevationInfoNoZ=
function(){return C};t.prototype._createAs3DShape=function(a,b,c,d,g,e,w,k){var q=this,n=this.getFastUpdateAttrValues(a);a=n?function(h){return Z.evaluateModelTransform(q._fastUpdates.materialParameters,n,h)}:null;d=ga.createPointGeometry(la,null,d,g,na,null,n);d=[new ea(d,w)];w=ba.createStageObjectForHUD(this._context,b,d,[c],null,null,e,w,this._context.layer.uid,k,a);if(null===w)return null;var h=new Q(this,w.object,d,null,null,R.perObjectElevationAligner,e);h.alignedSampledElevation=w.sampledElevation;
h.needsElevationUpdates=T.needsElevationUpdates2D(e.mode)||"absolute-height"===e.mode;h.getScreenSize=this._createScreenSizeGetter(g,a);h.calculateRelativeScreenBounds=function(p){return c.calculateRelativeScreenBounds(h.getScreenSize(),1,p)};ba.extendPointGraphicElevationContext(h,b,this._context.elevationProvider);return h};t.prototype._createAsOverlay=function(b,c,d,g,e,k){var w=this;d.renderPriority=this._renderPriority;var q=z.vec3f64.create();ha.pointToVector(c,q,this._context.overlaySR);q[2]=
X.DRAPED_Z;c=this._context.clippingExtent;if(a.isSome(c)&&!E.containsPoint(c,q))return null;var I=this.getFastUpdateAttrValues(b);c=I?function(h){return Z.evaluateModelTransform(w._fastUpdates.materialParameters,I,h)}:null;g=ga.createPointGeometry(la,q,g,e,null,null,I);g=new oa(g);g.material=d;g.center=q;g.bsRadius=0;g.data.layerUid=k;g.data.graphicUid=b.uid;g.calculateShaderTransformation=c;var n=new L(this,[g],null);n.getScreenSize=this._createScreenSizeGetter(e,c);n.calculateRelativeScreenBounds=
function(h){return d.calculateRelativeScreenBounds(n.getScreenSize(),1,h)};return n};t.prototype._createScreenSizeGetter=function(a,b){var c=this._outlineSize+2;if(this._fastUpdates.enabled){var d=a[0]/this._symbolTextureRatio,g=a[1]/this._symbolTextureRatio;return function(a){void 0===a&&(a=x.vec2f64.create());var w=b(fa);a[0]=w[0]*d+c;a[1]=w[5]*g+c;return a}}var e=a[0]/this._symbolTextureRatio+c,w=a[1]/this._symbolTextureRatio+c;return function(a){void 0===a&&(a=x.vec2f64.create());a[0]=e;a[1]=
w;return a}};t.prototype._fastVisualVariableConvertOptions=function(){var a=this._size[0]>this._size[1]?this._size[0]:this._size[1],b=z.vec3f64.fromValues(a,a,a),c=q.px2pt(1),a=a*c,a=z.vec3f64.fromValues(a,a,a);return{modelSize:b,symbolSize:a,unitInMeters:c,transformation:{anchor:z.vec3f64.ZEROS,scale:z.vec3f64.ONES,rotation:z.vec3f64.ZEROS}}};t.prototype._getGraphicHash=function(a){for(var b="",c=0,d=this._cimRequiredFields;c<d.length;c++)var g=d[c],b=b+(g+a.attributes[g]);return b};t.prototype._forEachMaterial=
function(b){a.isSome(this._material)&&b(this._material);this._cimSymbolMaterials.forEach(b)};t.PRIMITIVE_SIZE=ca;t.elevationModeChangeTypes={definedChanged:T.SymbolUpdateType.UPDATE,staysOnTheGround:T.SymbolUpdateType.NONE,onTheGroundChanged:T.SymbolUpdateType.RECREATE};return t}(S.default);f.Graphics3DIconSymbolLayer=u;var C={mode:"relative-to-ground",offset:0},na=A.vec4f64.fromValues(0,0,0,1);f.default=u})},"esri/core/libs/gl-matrix-2/mat4f64":function(){define(["require","exports","./factories/mat4f64"],
function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.mat4f64=e})},"esri/core/libs/gl-matrix-2/factories/mat4f64":function(){define(["require","exports"],function(u,f){function e(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}Object.defineProperty(f,"__esModule",{value:!0});f.create=e;f.clone=function(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]};f.fromValues=function(e,f,d,g,k,l,c,a,b,q,v,t,x,z,A,E){return[e,f,d,g,k,l,c,a,b,q,v,t,x,z,A,
E]};f.createView=function(e,f){return new Float64Array(e,f,16)};f.IDENTITY=e()})},"esri/core/libs/gl-matrix-2/vec2f64":function(){define(["require","exports","./factories/vec2f64"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.vec2f64=e})},"esri/core/libs/gl-matrix-2/factories/vec2f64":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});f.create=function(){return[0,0]};f.clone=function(e){return[e[0],e[1]]};f.fromValues=function(e,
f){return[e,f]};f.fromArray=function(e){for(var f=[0,0],m=Math.min(2,e.length),d=0;d<m;++d)f[d]=e[d];return f};f.createView=function(e,f){return new Float64Array(e,f,2)};f.zeros=function(){return[0,0]};f.ones=function(){return[1,1]};f.unitX=function(){return[1,0]};f.unitY=function(){return[0,1]};f.ZEROS=[0,0];f.ONES=[1,1];f.UNIT_X=[1,0];f.UNIT_Y=[0,1]})},"esri/core/libs/gl-matrix-2/vec4f64":function(){define(["require","exports","./factories/vec4f64"],function(u,f,e){Object.defineProperty(f,"__esModule",
{value:!0});f.vec4f64=e})},"esri/core/libs/gl-matrix-2/factories/vec4f64":function(){define(["require","exports"],function(u,f){function e(){return[0,0,0,0]}function r(){return[1,1,1,1]}function m(){return[1,0,0,0]}function d(){return[0,1,0,0]}function g(){return[0,0,1,0]}function k(){return[0,0,0,1]}Object.defineProperty(f,"__esModule",{value:!0});f.create=e;f.clone=function(d){return[d[0],d[1],d[2],d[3]]};f.fromValues=function(d,c,a,b){return[d,c,a,b]};f.fromArray=function(d){for(var c=e(),a=Math.min(4,
d.length),b=0;b<a;++b)c[b]=d[b];return c};f.createView=function(d,c){return new Float64Array(d,c,4)};f.zeros=function(){return e()};f.ones=r;f.unitX=m;f.unitY=d;f.unitZ=g;f.unitW=k;f.ZEROS=e();f.ONES=r();f.UNIT_X=m();f.UNIT_Y=d();f.UNIT_Z=g();f.UNIT_W=k()})},"esri/views/3d/layers/graphics/constants":function(){define(["require","exports","../../../../core/libs/gl-matrix-2/vec4f64"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.defaultIconElevationOffset=1;f.SUSPEND_RESUME_EXTENT_OPTIMISM=
1.2;f.TRANSPARENT_UNIT=e.vec4f64.ZEROS;f.WHITE_UNIT=e.vec4f64.ONES})},"esri/views/3d/layers/graphics/ElevationAligners":function(){define("require exports ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../geometry/Point ./elevationAlignmentUtils ./graphicUtils ../../support/debugFlags ../../support/projectionUtils ../../webgl-engine/lib/Util".split(" "),function(u,f,e,r,m,d,
g,k,l,c,a,b){Object.defineProperty(f,"__esModule",{value:!0});var q=b.VertexAttrConstants;f.perVertexElevationAligner=function(a,b,d,g){a=a.stageObject;t.spatialReference=d.spatialReference;for(var e=a.geometryRecords,l=e.length,v="absolute-height"!==b.mode,m=0,r=0;r<l;r++){var H=e[r].geometry,E=e[r].getShaderTransformation();z[0]=E[12];z[1]=E[13];z[2]=E[14];H.invalidateBoundingInfo();for(var E=H.data.getVertexAttr(),B=E[q.POSITION],H=B.data,E=E.mapPos.data,B=B.size,F=H.length/B,G=0,M=0,u=!1,ea=0,
ga=0;ga<F;ga++){t.x=E[M++];t.y=E[M++];t.z=E[M++];A[0]=H[G];A[1]=H[G+1];A[2]=H[G+2];var oa=k.evaluateElevationAlignmentAtPoint(t,d,b,g,v?J:null);v&&(ea+=J.sampledElevation);x[0]=H[G]+z[0];x[1]=H[G+1]+z[1];x[2]=H[G+2]+z[2];g.setAltitude(oa,x);H[G]=x[0]-z[0];H[G+1]=x[1]-z[1];H[G+2]=x[2]-z[2];if(c.TESTS_DISABLE_UPDATE_THRESHOLDS)u=!0;else if(oa=f.updateThresholdInMeters/g.unitInMeters,Math.abs(A[0]-H[G])>=oa||Math.abs(A[1]-H[G+1])>=oa||Math.abs(A[2]-H[G+2])>=oa)u=!0;G+=B}m+=ea/F;u&&a.geometryVertexAttrsUpdated(r)}return m/
l};f.perObjectElevationAligner=function(b,d,g,q){b=b.stageObject;var t=d.centerPointInElevationSR,z=0,r=0;if(b.metadata.usesVerticalDistanceToGround)z=k.evaluateElevationAlignmentAtPoint(t,g,d,q,J),l.updateVertexAttributeAuxpos1w(b,J.verticalDistanceToGround),r=J.sampledElevation;else{var A="absolute-height"!==d.mode,z=k.evaluateElevationAlignmentAtPoint(t,g,d,q,A?J:null);A&&(r=J.sampledElevation)}d=e.mat4.copy(v,b.objectTransformation);g=m.vec3.set(H,d[12],d[13],d[14]);c.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES?
(x[0]=t.x,x[1]=t.y,x[2]=z,a.computeLinearTransformation(t.spatialReference,x,d,q.spatialReference)&&(b.objectTransformation=d)):q.setAltitudeOfTransformation(z,d);q=f.updateThresholdInMeters/q.unitInMeters;if(Math.abs(d[12]-g[0])>=q||Math.abs(d[13]-g[1])>=q||Math.abs(d[14]-g[2])>=q)b.objectTransformation=d;return r};var v=r.mat4f64.create();f.perLodInstanceElevationAligner=function(b,d,g,e){var q=d.centerPointInElevationSR,t=0,l=0,v="absolute-height"!==d.mode,t=k.evaluateElevationAlignmentAtPoint(q,
g,d,e,v?J:null);v&&(l=J.sampledElevation);d=b.graphics3DSymbolLayer.lodRenderer.instanceData;b=b.instanceIndex;g=E;d.getGlobalTransform(b,g);v=m.vec3.set(H,g[12],g[13],g[14]);c.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES?(x[0]=q.x,x[1]=q.y,x[2]=t,a.computeLinearTransformation(q.spatialReference,x,g,e.spatialReference)&&d.setGlobalTransform(b,g)):e.setAltitudeOfTransformation(t,g);e=f.updateThresholdInMeters/e.unitInMeters;(Math.abs(g[12]-v[0])>=e||Math.abs(g[13]-v[1])>=e||Math.abs(g[14]-v[2])>=e)&&
d.setGlobalTransform(b,g);return l};f.updateThresholdInMeters=.01;f.iterativeUpdatesEnabled=!0;var t=new g,x=d.vec3f64.create(),z=d.vec3f64.create(),A=d.vec3f64.create(),E=r.mat4f64.create(),H=d.vec3f64.create(),J={verticalDistanceToGround:0,sampledElevation:0}})},"esri/core/libs/gl-matrix-2/mat4":function(){define(["require","exports","./math/mat4"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.mat4=e})},"esri/core/libs/gl-matrix-2/math/mat4":function(){define(["require","exports",
"../factories/vec3f64","./common"],function(u,f,e,r){function m(c){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c}function d(c,a,b){var d=a[0],g=a[1],e=a[2],k=a[3],f=a[4],l=a[5],m=a[6],r=a[7],J=a[8],B=a[9],G=a[10],F=a[11],M=a[12],R=a[13],u=a[14];a=a[15];var O=b[0],L=b[1],Q=b[2],S=b[3];c[0]=O*d+L*f+Q*J+S*M;c[1]=O*g+L*l+Q*B+S*R;c[2]=O*e+L*m+Q*G+S*u;c[3]=O*k+L*r+Q*F+S*a;O=b[4];L=b[5];Q=b[6];S=b[7];c[4]=O*d+L*f+Q*J+S*M;c[5]=
O*g+L*l+Q*B+S*R;c[6]=O*e+L*m+Q*G+S*u;c[7]=O*k+L*r+Q*F+S*a;O=b[8];L=b[9];Q=b[10];S=b[11];c[8]=O*d+L*f+Q*J+S*M;c[9]=O*g+L*l+Q*B+S*R;c[10]=O*e+L*m+Q*G+S*u;c[11]=O*k+L*r+Q*F+S*a;O=b[12];L=b[13];Q=b[14];S=b[15];c[12]=O*d+L*f+Q*J+S*M;c[13]=O*g+L*l+Q*B+S*R;c[14]=O*e+L*m+Q*G+S*u;c[15]=O*k+L*r+Q*F+S*a;return c}function g(c,a,b){var d=a[0],g=a[1],e=a[2],k=a[3],f=d+d,l=g+g,m=e+e;a=d*f;var r=d*l,d=d*m,J=g*l,g=g*m,e=e*m,f=k*f,l=k*l,k=k*m;c[0]=1-(J+e);c[1]=r+k;c[2]=d-l;c[3]=0;c[4]=r-k;c[5]=1-(a+e);c[6]=g+f;c[7]=
0;c[8]=d+l;c[9]=g-f;c[10]=1-(a+J);c[11]=0;c[12]=b[0];c[13]=b[1];c[14]=b[2];c[15]=1;return c}function k(c,a,b){c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];c[3]=a[3]-b[3];c[4]=a[4]-b[4];c[5]=a[5]-b[5];c[6]=a[6]-b[6];c[7]=a[7]-b[7];c[8]=a[8]-b[8];c[9]=a[9]-b[9];c[10]=a[10]-b[10];c[11]=a[11]-b[11];c[12]=a[12]-b[12];c[13]=a[13]-b[13];c[14]=a[14]-b[14];c[15]=a[15]-b[15];return c}Object.defineProperty(f,"__esModule",{value:!0});f.copy=function(c,a){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=
a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};f.set=function(c,a,b,d,g,e,k,f,l,m,r,J,B,G,F,M,R){c[0]=a;c[1]=b;c[2]=d;c[3]=g;c[4]=e;c[5]=k;c[6]=f;c[7]=l;c[8]=m;c[9]=r;c[10]=J;c[11]=B;c[12]=G;c[13]=F;c[14]=M;c[15]=R;return c};f.identity=m;f.transpose=function(c,a){if(c===a){var b=a[1],d=a[2],g=a[3],e=a[6],k=a[7],f=a[11];c[1]=a[4];c[2]=a[8];c[3]=a[12];c[4]=b;c[6]=a[9];c[7]=a[13];c[8]=d;c[9]=e;c[11]=a[14];c[12]=g;c[13]=k;
c[14]=f}else c[0]=a[0],c[1]=a[4],c[2]=a[8],c[3]=a[12],c[4]=a[1],c[5]=a[5],c[6]=a[9],c[7]=a[13],c[8]=a[2],c[9]=a[6],c[10]=a[10],c[11]=a[14],c[12]=a[3],c[13]=a[7],c[14]=a[11],c[15]=a[15];return c};f.invert=function(c,a){var b=a[0],d=a[1],g=a[2],e=a[3],k=a[4],f=a[5],l=a[6],m=a[7],r=a[8],J=a[9],B=a[10],G=a[11],F=a[12],M=a[13],R=a[14];a=a[15];var u=b*f-d*k,O=b*l-g*k,L=b*m-e*k,Q=d*l-g*f,S=d*m-e*f,aa=g*m-e*l,ba=r*M-J*F,V=r*R-B*F,Z=r*a-G*F,ha=J*R-B*M,X=J*a-G*M,ea=B*a-G*R,ga=u*ea-O*X+L*ha+Q*Z-S*V+aa*ba;if(!ga)return null;
ga=1/ga;c[0]=(f*ea-l*X+m*ha)*ga;c[1]=(g*X-d*ea-e*ha)*ga;c[2]=(M*aa-R*S+a*Q)*ga;c[3]=(B*S-J*aa-G*Q)*ga;c[4]=(l*Z-k*ea-m*V)*ga;c[5]=(b*ea-g*Z+e*V)*ga;c[6]=(R*L-F*aa-a*O)*ga;c[7]=(r*aa-B*L+G*O)*ga;c[8]=(k*X-f*Z+m*ba)*ga;c[9]=(d*Z-b*X-e*ba)*ga;c[10]=(F*S-M*L+a*u)*ga;c[11]=(J*L-r*S-G*u)*ga;c[12]=(f*V-k*ha-l*ba)*ga;c[13]=(b*ha-d*V+g*ba)*ga;c[14]=(M*O-F*Q-R*u)*ga;c[15]=(r*Q-J*O+B*u)*ga;return c};f.adjoint=function(c,a){var b=a[0],d=a[1],g=a[2],e=a[3],k=a[4],f=a[5],l=a[6],m=a[7],r=a[8],J=a[9],B=a[10],G=a[11],
F=a[12],M=a[13],R=a[14];a=a[15];c[0]=f*(B*a-G*R)-J*(l*a-m*R)+M*(l*G-m*B);c[1]=-(d*(B*a-G*R)-J*(g*a-e*R)+M*(g*G-e*B));c[2]=d*(l*a-m*R)-f*(g*a-e*R)+M*(g*m-e*l);c[3]=-(d*(l*G-m*B)-f*(g*G-e*B)+J*(g*m-e*l));c[4]=-(k*(B*a-G*R)-r*(l*a-m*R)+F*(l*G-m*B));c[5]=b*(B*a-G*R)-r*(g*a-e*R)+F*(g*G-e*B);c[6]=-(b*(l*a-m*R)-k*(g*a-e*R)+F*(g*m-e*l));c[7]=b*(l*G-m*B)-k*(g*G-e*B)+r*(g*m-e*l);c[8]=k*(J*a-G*M)-r*(f*a-m*M)+F*(f*G-m*J);c[9]=-(b*(J*a-G*M)-r*(d*a-e*M)+F*(d*G-e*J));c[10]=b*(f*a-m*M)-k*(d*a-e*M)+F*(d*m-e*f);c[11]=
-(b*(f*G-m*J)-k*(d*G-e*J)+r*(d*m-e*f));c[12]=-(k*(J*R-B*M)-r*(f*R-l*M)+F*(f*B-l*J));c[13]=b*(J*R-B*M)-r*(d*R-g*M)+F*(d*B-g*J);c[14]=-(b*(f*R-l*M)-k*(d*R-g*M)+F*(d*l-g*f));c[15]=b*(f*B-l*J)-k*(d*B-g*J)+r*(d*l-g*f);return c};f.determinant=function(c){var a=c[0],b=c[1],d=c[2],g=c[3],e=c[4],k=c[5],f=c[6],l=c[7],m=c[8],r=c[9],J=c[10],B=c[11],G=c[12],F=c[13],M=c[14];c=c[15];return(a*k-b*e)*(J*c-B*M)-(a*f-d*e)*(r*c-B*F)+(a*l-g*e)*(r*M-J*F)+(b*f-d*k)*(m*c-B*G)-(b*l-g*k)*(m*M-J*G)+(d*l-g*f)*(m*F-r*G)};f.multiply=
d;f.translate=function(c,a,b){var d=b[0],g=b[1];b=b[2];var e=void 0,k=void 0,f=void 0,l=void 0,m=void 0,r=void 0,J=void 0,B=void 0,G=void 0,F=void 0,M=void 0,R=void 0;a===c?(c[12]=a[0]*d+a[4]*g+a[8]*b+a[12],c[13]=a[1]*d+a[5]*g+a[9]*b+a[13],c[14]=a[2]*d+a[6]*g+a[10]*b+a[14],c[15]=a[3]*d+a[7]*g+a[11]*b+a[15]):(e=a[0],k=a[1],f=a[2],l=a[3],m=a[4],r=a[5],J=a[6],B=a[7],G=a[8],F=a[9],M=a[10],R=a[11],c[0]=e,c[1]=k,c[2]=f,c[3]=l,c[4]=m,c[5]=r,c[6]=J,c[7]=B,c[8]=G,c[9]=F,c[10]=M,c[11]=R,c[12]=e*d+m*g+G*b+a[12],
c[13]=k*d+r*g+F*b+a[13],c[14]=f*d+J*g+M*b+a[14],c[15]=l*d+B*g+R*b+a[15]);return c};f.scale=function(c,a,b){var d=b[0],g=b[1];b=b[2];c[0]=a[0]*d;c[1]=a[1]*d;c[2]=a[2]*d;c[3]=a[3]*d;c[4]=a[4]*g;c[5]=a[5]*g;c[6]=a[6]*g;c[7]=a[7]*g;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};f.rotate=function(c,a,b,d){var g=d[0],e=d[1];d=d[2];var k=Math.sqrt(g*g+e*e+d*d),q=void 0,f=void 0,l=void 0,m=void 0,J=void 0,B=void 0,G=void 0,F=void 0,M=void 0,R=
void 0,u=void 0,O=void 0,L=void 0,Q=void 0,S=void 0,aa=void 0,ba=void 0,V=void 0,Z=void 0,ha=void 0,X=void 0,ea=void 0,f=q=void 0;if(k<r.EPSILON)return null;k=1/k;g*=k;e*=k;d*=k;q=Math.sin(b);f=Math.cos(b);l=1-f;m=a[0];J=a[1];B=a[2];G=a[3];F=a[4];M=a[5];R=a[6];u=a[7];O=a[8];L=a[9];Q=a[10];S=a[11];aa=g*g*l+f;ba=e*g*l+d*q;V=d*g*l-e*q;Z=g*e*l-d*q;ha=e*e*l+f;X=d*e*l+g*q;ea=g*d*l+e*q;q=e*d*l-g*q;f=d*d*l+f;c[0]=m*aa+F*ba+O*V;c[1]=J*aa+M*ba+L*V;c[2]=B*aa+R*ba+Q*V;c[3]=G*aa+u*ba+S*V;c[4]=m*Z+F*ha+O*X;c[5]=
J*Z+M*ha+L*X;c[6]=B*Z+R*ha+Q*X;c[7]=G*Z+u*ha+S*X;c[8]=m*ea+F*q+O*f;c[9]=J*ea+M*q+L*f;c[10]=B*ea+R*q+Q*f;c[11]=G*ea+u*q+S*f;a!==c&&(c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);return c};f.rotateX=function(c,a,b){var d=Math.sin(b);b=Math.cos(b);var g=a[4],e=a[5],k=a[6],f=a[7],l=a[8],m=a[9],r=a[10],J=a[11];a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);c[4]=g*b+l*d;c[5]=e*b+m*d;c[6]=k*b+r*d;c[7]=f*b+J*d;c[8]=l*b-g*d;c[9]=m*b-e*d;c[10]=r*b-k*d;c[11]=
J*b-f*d;return c};f.rotateY=function(c,a,b){var d=Math.sin(b);b=Math.cos(b);var g=a[0],e=a[1],k=a[2],f=a[3],l=a[8],m=a[9],r=a[10],J=a[11];a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);c[0]=g*b-l*d;c[1]=e*b-m*d;c[2]=k*b-r*d;c[3]=f*b-J*d;c[8]=g*d+l*b;c[9]=e*d+m*b;c[10]=k*d+r*b;c[11]=f*d+J*b;return c};f.rotateZ=function(c,a,b){var d=Math.sin(b);b=Math.cos(b);var g=a[0],e=a[1],k=a[2],f=a[3],l=a[4],m=a[5],r=a[6],J=a[7];a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=
a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);c[0]=g*b+l*d;c[1]=e*b+m*d;c[2]=k*b+r*d;c[3]=f*b+J*d;c[4]=l*b-g*d;c[5]=m*b-e*d;c[6]=r*b-k*d;c[7]=J*b-f*d;return c};f.fromTranslation=function(c,a){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=a[0];c[13]=a[1];c[14]=a[2];c[15]=1;return c};f.fromScaling=function(c,a){c[0]=a[0];c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=a[1];c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=a[2];c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=
1;return c};f.fromRotation=function(c,a,b){var d=b[0],g=b[1];b=b[2];var e=Math.sqrt(d*d+g*g+b*b),k=void 0,f=void 0,l=void 0;if(e<r.EPSILON)return null;e=1/e;d*=e;g*=e;b*=e;k=Math.sin(a);f=Math.cos(a);l=1-f;c[0]=d*d*l+f;c[1]=g*d*l+b*k;c[2]=b*d*l-g*k;c[3]=0;c[4]=d*g*l-b*k;c[5]=g*g*l+f;c[6]=b*g*l+d*k;c[7]=0;c[8]=d*b*l+g*k;c[9]=g*b*l-d*k;c[10]=b*b*l+f;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};f.fromXRotation=function(c,a){var b=Math.sin(a);a=Math.cos(a);c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=
a;c[6]=b;c[7]=0;c[8]=0;c[9]=-b;c[10]=a;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};f.fromYRotation=function(c,a){var b=Math.sin(a);a=Math.cos(a);c[0]=a;c[1]=0;c[2]=-b;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=b;c[9]=0;c[10]=a;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};f.fromZRotation=function(c,a){var b=Math.sin(a);a=Math.cos(a);c[0]=a;c[1]=b;c[2]=0;c[3]=0;c[4]=-b;c[5]=a;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};f.fromRotationTranslation=g;f.fromQuat2=
function(c,a){var b=l,d=-a[0],e=-a[1],k=-a[2],f=a[3],m=a[4],r=a[5],E=a[6],H=a[7],J=d*d+e*e+k*k+f*f;0<J?(b[0]=2*(m*f+H*d+r*k-E*e)/J,b[1]=2*(r*f+H*e+E*d-m*k)/J,b[2]=2*(E*f+H*k+m*e-r*d)/J):(b[0]=2*(m*f+H*d+r*k-E*e),b[1]=2*(r*f+H*e+E*d-m*k),b[2]=2*(E*f+H*k+m*e-r*d));g(c,a,b);return c};var l=e.create();f.getTranslation=function(c,a){c[0]=a[12];c[1]=a[13];c[2]=a[14];return c};f.getScaling=function(c,a){var b=a[0],d=a[1],g=a[2],e=a[4],k=a[5],f=a[6],l=a[8],m=a[9];a=a[10];c[0]=Math.sqrt(b*b+d*d+g*g);c[1]=
Math.sqrt(e*e+k*k+f*f);c[2]=Math.sqrt(l*l+m*m+a*a);return c};f.getRotation=function(c,a){var b=a[0]+a[5]+a[10],d=0;0<b?(d=2*Math.sqrt(b+1),c[3]=.25*d,c[0]=(a[6]-a[9])/d,c[1]=(a[8]-a[2])/d,c[2]=(a[1]-a[4])/d):a[0]>a[5]&&a[0]>a[10]?(d=2*Math.sqrt(1+a[0]-a[5]-a[10]),c[3]=(a[6]-a[9])/d,c[0]=.25*d,c[1]=(a[1]+a[4])/d,c[2]=(a[8]+a[2])/d):a[5]>a[10]?(d=2*Math.sqrt(1+a[5]-a[0]-a[10]),c[3]=(a[8]-a[2])/d,c[0]=(a[1]+a[4])/d,c[1]=.25*d,c[2]=(a[6]+a[9])/d):(d=2*Math.sqrt(1+a[10]-a[0]-a[5]),c[3]=(a[1]-a[4])/d,c[0]=
(a[8]+a[2])/d,c[1]=(a[6]+a[9])/d,c[2]=.25*d);return c};f.fromRotationTranslationScale=function(c,a,b,d){var g=a[0],e=a[1],k=a[2],q=a[3],f=g+g,l=e+e,m=k+k;a=g*f;var r=g*l,g=g*m,B=e*l,e=e*m,k=k*m,f=q*f,l=q*l,q=q*m,m=d[0],G=d[1];d=d[2];c[0]=(1-(B+k))*m;c[1]=(r+q)*m;c[2]=(g-l)*m;c[3]=0;c[4]=(r-q)*G;c[5]=(1-(a+k))*G;c[6]=(e+f)*G;c[7]=0;c[8]=(g+l)*d;c[9]=(e-f)*d;c[10]=(1-(a+B))*d;c[11]=0;c[12]=b[0];c[13]=b[1];c[14]=b[2];c[15]=1;return c};f.fromRotationTranslationScaleOrigin=function(c,a,b,d,g){var e=a[0],
k=a[1],q=a[2],f=a[3],l=e+e,m=k+k,v=q+q;a=e*l;var r=e*m,G=e*v,e=k*m,k=k*v,F=q*v,q=f*l,m=f*m,M=f*v,R=d[0],u=d[1],v=d[2];d=g[0];f=g[1];g=g[2];var l=(1-(e+F))*R,O=(r+M)*R,R=(G-m)*R,r=(r-M)*u,F=(1-(a+F))*u,u=(k+q)*u,G=(G+m)*v,k=(k-q)*v;a=(1-(a+e))*v;c[0]=l;c[1]=O;c[2]=R;c[3]=0;c[4]=r;c[5]=F;c[6]=u;c[7]=0;c[8]=G;c[9]=k;c[10]=a;c[11]=0;c[12]=b[0]+d-(l*d+r*f+G*g);c[13]=b[1]+f-(O*d+F*f+k*g);c[14]=b[2]+g-(R*d+u*f+a*g);c[15]=1;return c};f.fromQuat=function(c,a){var b=a[0],d=a[1],g=a[2];a=a[3];var e=b+b,k=d+
d,f=g+g,b=b*e,l=d*e,d=d*k,m=g*e,r=g*k,g=g*f,e=a*e,k=a*k;a*=f;c[0]=1-d-g;c[1]=l+a;c[2]=m-k;c[3]=0;c[4]=l-a;c[5]=1-b-g;c[6]=r+e;c[7]=0;c[8]=m+k;c[9]=r-e;c[10]=1-b-d;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};f.frustum=function(c,a,b,d,g,e,k){var q=1/(b-a),f=1/(g-d),l=1/(e-k);c[0]=2*e*q;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=2*e*f;c[6]=0;c[7]=0;c[8]=(b+a)*q;c[9]=(g+d)*f;c[10]=(k+e)*l;c[11]=-1;c[12]=0;c[13]=0;c[14]=k*e*2*l;c[15]=0;return c};f.perspective=function(c,a,b,d,g){a=1/Math.tan(a/2);var e=void 0;
c[0]=a/b;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=a;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[11]=-1;c[12]=0;c[13]=0;c[15]=0;null!=g&&Infinity!==g?(e=1/(d-g),c[10]=(g+d)*e,c[14]=2*g*d*e):(c[10]=-1,c[14]=-2*d);return c};f.perspectiveFromFieldOfView=function(c,a,b,d){var g=Math.tan(a.upDegrees*Math.PI/180),e=Math.tan(a.downDegrees*Math.PI/180),k=Math.tan(a.leftDegrees*Math.PI/180);a=Math.tan(a.rightDegrees*Math.PI/180);var q=2/(k+a),f=2/(g+e);c[0]=q;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=f;c[6]=0;c[7]=0;c[8]=-((k-a)*q*.5);c[9]=
(g-e)*f*.5;c[10]=d/(b-d);c[11]=-1;c[12]=0;c[13]=0;c[14]=d*b/(b-d);c[15]=0;return c};f.ortho=function(c,a,b,d,g,e,k){var q=1/(a-b),f=1/(d-g),l=1/(e-k);c[0]=-2*q;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=-2*f;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=2*l;c[11]=0;c[12]=(a+b)*q;c[13]=(g+d)*f;c[14]=(k+e)*l;c[15]=1;return c};f.lookAt=function(c,a,b,d){var g=void 0,e=void 0,k=void 0,q=void 0,f=void 0,l=void 0,H=void 0,J=void 0,B=void 0,G=void 0,F=a[0],M=a[1];a=a[2];k=d[0];q=d[1];d=d[2];H=b[0];J=b[1];b=b[2];if(Math.abs(F-
H)<r.EPSILON&&Math.abs(M-J)<r.EPSILON&&Math.abs(a-b)<r.EPSILON)return m(c);H=F-H;J=M-J;B=a-b;G=1/Math.sqrt(H*H+J*J+B*B);H*=G;J*=G;B*=G;g=q*B-d*J;e=d*H-k*B;k=k*J-q*H;(G=Math.sqrt(g*g+e*e+k*k))?(G=1/G,g*=G,e*=G,k*=G):k=e=g=0;q=J*k-B*e;f=B*g-H*k;l=H*e-J*g;(G=Math.sqrt(q*q+f*f+l*l))?(G=1/G,q*=G,f*=G,l*=G):l=f=q=0;c[0]=g;c[1]=q;c[2]=H;c[3]=0;c[4]=e;c[5]=f;c[6]=J;c[7]=0;c[8]=k;c[9]=l;c[10]=B;c[11]=0;c[12]=-(g*F+e*M+k*a);c[13]=-(q*F+f*M+l*a);c[14]=-(H*F+J*M+B*a);c[15]=1;return c};f.targetTo=function(c,a,
b,d){var g=a[0],e=a[1];a=a[2];var k=d[0],q=d[1],f=d[2];d=g-b[0];var l=e-b[1];b=a-b[2];var m=d*d+l*l+b*b;0<m&&(m=1/Math.sqrt(m),d*=m,l*=m,b*=m);var r=q*b-f*l,f=f*d-k*b,k=k*l-q*d,m=r*r+f*f+k*k;0<m&&(m=1/Math.sqrt(m),r*=m,f*=m,k*=m);c[0]=r;c[1]=f;c[2]=k;c[3]=0;c[4]=l*k-b*f;c[5]=b*r-d*k;c[6]=d*f-l*r;c[7]=0;c[8]=d;c[9]=l;c[10]=b;c[11]=0;c[12]=g;c[13]=e;c[14]=a;c[15]=1;return c};f.str=function(c){return"mat4("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+", "+c[6]+", "+c[7]+", "+c[8]+", "+c[9]+
", "+c[10]+", "+c[11]+", "+c[12]+", "+c[13]+", "+c[14]+", "+c[15]+")"};f.frob=function(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2)+Math.pow(c[2],2)+Math.pow(c[3],2)+Math.pow(c[4],2)+Math.pow(c[5],2)+Math.pow(c[6],2)+Math.pow(c[7],2)+Math.pow(c[8],2)+Math.pow(c[9],2)+Math.pow(c[10],2)+Math.pow(c[11],2)+Math.pow(c[12],2)+Math.pow(c[13],2)+Math.pow(c[14],2)+Math.pow(c[15],2))};f.add=function(c,a,b){c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];c[3]=a[3]+b[3];c[4]=a[4]+b[4];c[5]=a[5]+b[5];c[6]=
a[6]+b[6];c[7]=a[7]+b[7];c[8]=a[8]+b[8];c[9]=a[9]+b[9];c[10]=a[10]+b[10];c[11]=a[11]+b[11];c[12]=a[12]+b[12];c[13]=a[13]+b[13];c[14]=a[14]+b[14];c[15]=a[15]+b[15];return c};f.subtract=k;f.multiplyScalar=function(c,a,b){c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;c[3]=a[3]*b;c[4]=a[4]*b;c[5]=a[5]*b;c[6]=a[6]*b;c[7]=a[7]*b;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12]*b;c[13]=a[13]*b;c[14]=a[14]*b;c[15]=a[15]*b;return c};f.multiplyScalarAndAdd=function(c,a,b,d){c[0]=a[0]+b[0]*d;c[1]=a[1]+
b[1]*d;c[2]=a[2]+b[2]*d;c[3]=a[3]+b[3]*d;c[4]=a[4]+b[4]*d;c[5]=a[5]+b[5]*d;c[6]=a[6]+b[6]*d;c[7]=a[7]+b[7]*d;c[8]=a[8]+b[8]*d;c[9]=a[9]+b[9]*d;c[10]=a[10]+b[10]*d;c[11]=a[11]+b[11]*d;c[12]=a[12]+b[12]*d;c[13]=a[13]+b[13]*d;c[14]=a[14]+b[14]*d;c[15]=a[15]+b[15]*d;return c};f.exactEquals=function(c,a){return c[0]===a[0]&&c[1]===a[1]&&c[2]===a[2]&&c[3]===a[3]&&c[4]===a[4]&&c[5]===a[5]&&c[6]===a[6]&&c[7]===a[7]&&c[8]===a[8]&&c[9]===a[9]&&c[10]===a[10]&&c[11]===a[11]&&c[12]===a[12]&&c[13]===a[13]&&c[14]===
a[14]&&c[15]===a[15]};f.equals=function(c,a){var b=c[0],d=c[1],g=c[2],e=c[3],k=c[4],f=c[5],l=c[6],m=c[7],H=c[8],J=c[9],B=c[10],G=c[11],F=c[12],M=c[13],R=c[14];c=c[15];var u=a[0],O=a[1],L=a[2],Q=a[3],S=a[4],aa=a[5],ba=a[6],V=a[7],Z=a[8],ha=a[9],X=a[10],ea=a[11],ga=a[12],oa=a[13],ja=a[14];a=a[15];return Math.abs(b-u)<=r.EPSILON*Math.max(1,Math.abs(b),Math.abs(u))&&Math.abs(d-O)<=r.EPSILON*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(g-L)<=r.EPSILON*Math.max(1,Math.abs(g),Math.abs(L))&&Math.abs(e-Q)<=
r.EPSILON*Math.max(1,Math.abs(e),Math.abs(Q))&&Math.abs(k-S)<=r.EPSILON*Math.max(1,Math.abs(k),Math.abs(S))&&Math.abs(f-aa)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(aa))&&Math.abs(l-ba)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(ba))&&Math.abs(m-V)<=r.EPSILON*Math.max(1,Math.abs(m),Math.abs(V))&&Math.abs(H-Z)<=r.EPSILON*Math.max(1,Math.abs(H),Math.abs(Z))&&Math.abs(J-ha)<=r.EPSILON*Math.max(1,Math.abs(J),Math.abs(ha))&&Math.abs(B-X)<=r.EPSILON*Math.max(1,Math.abs(B),Math.abs(X))&&Math.abs(G-ea)<=
r.EPSILON*Math.max(1,Math.abs(G),Math.abs(ea))&&Math.abs(F-ga)<=r.EPSILON*Math.max(1,Math.abs(F),Math.abs(ga))&&Math.abs(M-oa)<=r.EPSILON*Math.max(1,Math.abs(M),Math.abs(oa))&&Math.abs(R-ja)<=r.EPSILON*Math.max(1,Math.abs(R),Math.abs(ja))&&Math.abs(c-a)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(a))};f.mul=d;f.sub=k})},"esri/views/3d/layers/graphics/elevationAlignmentUtils":function(){define("require exports ../../../../core/compilerUtils ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3f64 ./graphicUtils ../../support/ElevationProvider ../../support/projectionUtils".split(" "),
function(u,f,e,r,m,d,g,k,l){function c(a,b,c,d,g){var f=a.z||0;switch(c.mode){case "on-the-ground":return a=k.getElevationAtPoint(b,a,"ground")||0,g&&(g.verticalDistanceToGround=0,g.sampledElevation=a),a;case "relative-to-ground":return a=k.getElevationAtPoint(b,a,"ground")||0,c=c.geometryZWithOffset(f,d),g&&(g.verticalDistanceToGround=c,g.sampledElevation=a),c+a;case "relative-to-scene":return a=k.getElevationAtPoint(b,a,"scene")||0,c=c.geometryZWithOffset(f,d),g&&(g.verticalDistanceToGround=c,g.sampledElevation=
a),c+a;case "absolute-height":return c=c.geometryZWithOffset(f,d),g&&(a=k.getElevationAtPoint(b,a,"ground")||0,g.verticalDistanceToGround=c-a,g.sampledElevation=a),c;default:return e.neverReached(c.mode),0}}Object.defineProperty(f,"__esModule",{value:!0});f.applyPerVertexElevationAlignment=function(a,c,d,g,e,k,f,q,t,m,v){var x=b[v.mode],r=0;if(l.bufferToBuffer(a,c,d,g,t.spatialReference,e,q)&&(x.requiresAlignment(v)?(r=x.applyElevationAlignmentBuffer(g,e,k,f,q,t,m,v),a=k,e=f):a=g,l.bufferToBuffer(a,
t.spatialReference,e,k,m.spatialReference,f,q)))return r};f.evaluateElevationAlignmentAtPoint=c;f.elevationModeChangeUpdateType=function(b,c,d){return null==c||null==d?b.definedChanged:"on-the-ground"===c&&"on-the-ground"===d?b.staysOnTheGround:c===d||"on-the-ground"!==c&&"on-the-ground"!==d?a.UPDATE:b.onTheGroundChanged};f.needsElevationUpdates2D=function(a){return"relative-to-ground"===a||"relative-to-scene"===a};f.needsElevationUpdates3D=function(a){return"absolute-height"!==a};f.applyElevationAlignmentForHUD=
function(a,b,d,e,k){d=c(b,d,k,e,v);g.updateVertexAttributeAuxpos1w(a,v.verticalDistanceToGround);k=v.sampledElevation;var f=r.mat4.copy(q,a.objectTransformation);t[0]=b.x;t[1]=b.y;t[2]=d;l.computeLinearTransformation(b.spatialReference,t,f,e.spatialReference)?a.objectTransformation=f:console.warn("Could not locate symbol object properly, it might be misplaced");return k};var a;(function(a){a[a.NONE=0]="NONE";a[a.UPDATE=1]="UPDATE";a[a.RECREATE=2]="RECREATE"})(a=f.SymbolUpdateType||(f.SymbolUpdateType=
{}));var b={"absolute-height":{applyElevationAlignmentBuffer:function(a,b,c,d,g,e,k,f){e=f.calculateOffsetRenderUnits(k);f=f.featureExpressionInfoContext;b*=3;d*=3;for(k=0;k<g;++k){var q=a[b+1],l=a[b+2];c[d+0]=a[b+0];c[d+1]=q;c[d+2]=null==f?l+e:e;b+=3;d+=3}return 0},requiresAlignment:function(a){var b=a.featureExpressionInfoContext;return 0!==a.meterUnitOffset||null!=b}},"on-the-ground":{applyElevationAlignmentBuffer:function(a,b,c,d,g,e){var k=0,f=e.spatialReference;b*=3;d*=3;for(var q=0;q<g;++q){var l=
a[b+0],t=a[b+1],m=e.getElevation(l,t,a[b+2],f,"ground")||0,k=k+m;c[d+0]=l;c[d+1]=t;c[d+2]=m;b+=3;d+=3}return k/g},requiresAlignment:function(){return!0}},"relative-to-ground":{applyElevationAlignmentBuffer:function(a,b,c,d,g,e,k,f){var q=0;k=f.calculateOffsetRenderUnits(k);f=f.featureExpressionInfoContext;var l=e.spatialReference;b*=3;d*=3;for(var t=0;t<g;++t){var m=a[b+0],v=a[b+1],x=a[b+2],r=e.getElevation(m,v,x,l,"ground")||0,q=q+r;c[d+0]=m;c[d+1]=v;c[d+2]=null==f?x+r+k:r+k;b+=3;d+=3}return q/g},
requiresAlignment:function(){return!0}},"relative-to-scene":{applyElevationAlignmentBuffer:function(a,b,c,d,g,e,k,f){var q=0;k=f.calculateOffsetRenderUnits(k);f=f.featureExpressionInfoContext;var l=e.spatialReference;b*=3;d*=3;for(var t=0;t<g;++t){var m=a[b+0],v=a[b+1],x=a[b+2],r=e.getElevation(m,v,x,l,"scene")||0,q=q+r;c[d+0]=m;c[d+1]=v;c[d+2]=null==f?x+r+k:r+k;b+=3;d+=3}return q/g},requiresAlignment:function(){return!0}}},q=m.mat4f64.create(),v={verticalDistanceToGround:0,sampledElevation:0},t=
d.vec3f64.create()})},"esri/views/3d/layers/graphics/graphicUtils":function(){define("require exports ../../../../core/mathUtils ../../../../core/maybe ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/vec4 ../../../../core/libs/gl-matrix-2/vec4f64 ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/centroid ../../../../geometry/support/coordsUtils ../../../../layers/graphics/dehydratedFeatures ../../support/projectionUtils".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x){function z(a){var b=a.paths[0];if(!b||0===b.length)return null;b=v.getPointOnPath(b,v.getPathLength(b)/2);return t.makeDehydratedPoint(b[0],b[1],b[2],a.spatialReference)}function A(a,b,c){c=c?a:t.clonePoint(a);return b&&a?x.pointToPoint(a,c,b)?c:null:c}function E(a){if(Array.isArray(a)){for(var b=0;b<a.length;b++)if(!E(a[b]))return!1;return!0}return null==a||0<=a}Object.defineProperty(f,"__esModule",{value:!0});f.computeCentroid=function(a,b){if("point"===
a.type)return A(a,b,!1);if(t.isHydratedGeometry(a))switch(a.type){case "extent":return A(a.center,b,!1);case "polygon":return A(a.centroid,b,!1);case "polyline":return A(z(a),b,!0);case "mesh":return A(a.extent.center,b,!1)}else switch(a.type){case "extent":var c=e.isFinite(a.zmin);a=t.makeDehydratedPoint(.5*(a.xmax+a.xmin),.5*(a.ymax+a.ymin),c?.5*(a.zmax+a.zmin):void 0,a.spatialReference);return A(a,b,!0);case "polygon":return(c=a.rings[0])&&0!==c.length?(c=q.ringsCentroid(a.rings,a.hasZ),a=t.makeDehydratedPoint(c[0],
c[1],c[2],a.spatialReference)):a=null,A(a,b,!0);case "polyline":return A(z(a),b,!0)}};f.enlargeExtent=function(a,c,d){if(a){c||(c=b.create());var g=.5*a.width*(d-1);d=.5*a.height*(d-1);a.width<1E-7*a.height?g+=d/20:a.height<1E-7*a.width&&(d+=g/20);l.vec4.set(c,a.xmin-g,a.ymin-d,a.xmax+g,a.ymax+d);return c}return null};f.updateVertexAttributeAuxpos1w=function(a,b){for(var c=0;c<a.geometries.length;++c){var d=a.geometries[c].data.vertexAttributes.auxpos1;d&&d.data[3]!==b&&(d.data[3]=b,a.geometryVertexAttrsUpdated(c))}};
f.mixinColorAndOpacity=function(a,b){var d=c.vec4f64.clone(c.vec4f64.ONES);r.isSome(a)&&(d[0]=a[0],d[1]=a[1],d[2]=a[2]);r.isSome(b)?d[3]=b:r.isSome(a)&&3<a.length&&(d[3]=a[3]);return d};f.overrideColor=function(a,b,c,d,g,e){void 0===e&&(e=[0,0,0,0]);for(var k=0;3>k;++k)r.isSome(a)&&null!=a[k]?e[k]=a[k]:r.isSome(c)&&null!=c[k]?e[k]=c[k]:e[k]=g[k];r.isSome(b)?e[3]=b:r.isSome(d)?e[3]=d:e[3]=g[3];return e};f.computeObjectScale=function(a,b,c,d){void 0===a&&(a=k.vec3f64.ONES);void 0===d&&(d=1);var g=Array(3);
if(null==b||null==c)g[0]=1,g[1]=1,g[2]=1;else{for(var e=void 0,f=0,q=2;0<=q;q--){var l=a[q],t=void 0,m=null!=l,v=0===q&&!e&&!m,x=c[q];"symbol-value"===l||v?t=0!==x?b[q]/x:1:m&&"proportional"!==l&&isFinite(l)&&(t=0!==x?l/x:1);null!=t&&(e=g[q]=t,f=Math.max(f,Math.abs(t)))}for(q=2;0<=q;q--)null==g[q]?g[q]=e:0===g[q]&&(g[q]=.001*f)}for(q=2;0<=q;q--)g[q]/=d;return k.vec3f64.fromArray(g)};f.computeSizeWithResourceSize=function(a,b){var c=b.width,d=b.depth,g=b.height;b=b.isPrimitive?10:1;if(null==c&&null==
g&&null==d)return[b*a[0],b*a[1],b*a[2]];for(var c=k.vec3f64.fromValues(c,d,g),e,d=0;3>d;d++)if(g=c[d],null!=g){e=g/a[d];break}for(d=0;3>d;d++)null==c[d]&&(c[d]=a[d]*e);return c};f.validateSymbolLayerSize=function(a){null!=a.isPrimitive&&(a=[a.width,a.depth,a.height]);return E(a)?null:"Symbol sizes may not be negative values"};f.isValidSize=E;f.computeObjectRotation=function(a,b,c,g){void 0===g&&(g=d.mat4f64.create());a=a||0;b=b||0;c=c||0;0!==a&&m.mat4.rotateZ(g,g,-a/180*Math.PI);0!==b&&m.mat4.rotateX(g,
g,b/180*Math.PI);0!==c&&m.mat4.rotateY(g,g,c/180*Math.PI);return g};f.demResolutionForBoundingBox=function(b,c){return null!=c.minDemResolution?c.minDemResolution:a.isPoint(b)?c.minDemResolutionForPoints:.01*a.maximumDimension(b)};f.namedAnchorToHUDMaterialAnchorPos={"bottom-left":g.vec2f64.fromValues(0,0),bottom:g.vec2f64.fromValues(.5,0),"bottom-right":g.vec2f64.fromValues(1,0),left:g.vec2f64.fromValues(0,.5),center:g.vec2f64.fromValues(.5,.5),right:g.vec2f64.fromValues(1,.5),"top-left":g.vec2f64.fromValues(0,
1),top:g.vec2f64.fromValues(.5,1),"top-right":g.vec2f64.fromValues(1,1)}})},"esri/core/libs/gl-matrix-2/vec4":function(){define(["require","exports","./math/vec4"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.vec4=e})},"esri/core/libs/gl-matrix-2/math/vec4":function(){define(["require","exports","./common"],function(u,f,e){function r(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];return a}function m(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];a[2]=b[2]*c[2];a[3]=
b[3]*c[3];return a}function d(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];a[2]=b[2]/c[2];a[3]=b[3]/c[3];return a}function g(a,b){var c=b[0]-a[0],d=b[1]-a[1],g=b[2]-a[2];a=b[3]-a[3];return Math.sqrt(c*c+d*d+g*g+a*a)}function k(a,b){var c=b[0]-a[0],d=b[1]-a[1],g=b[2]-a[2];a=b[3]-a[3];return c*c+d*d+g*g+a*a}function l(a){var b=a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)}function c(a){var b=a[0],c=a[1],d=a[2];a=a[3];return b*b+c*c+d*d+a*a}Object.defineProperty(f,"__esModule",{value:!0});f.copy=
function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a};f.set=function(a,b,c,d,g){a[0]=b;a[1]=c;a[2]=d;a[3]=g;return a};f.add=function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];return a};f.subtract=r;f.multiply=m;f.divide=d;f.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);a[2]=Math.ceil(b[2]);a[3]=Math.ceil(b[3]);return a};f.floor=function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);a[2]=Math.floor(b[2]);a[3]=Math.floor(b[3]);return a};f.min=function(a,
b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);a[2]=Math.min(b[2],c[2]);a[3]=Math.min(b[3],c[3]);return a};f.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);a[2]=Math.max(b[2],c[2]);a[3]=Math.max(b[3],c[3]);return a};f.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);a[2]=Math.round(b[2]);a[3]=Math.round(b[3]);return a};f.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;return a};f.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=
b[1]+c[1]*d;a[2]=b[2]+c[2]*d;a[3]=b[3]+c[3]*d;return a};f.distance=g;f.squaredDistance=k;f.length=l;f.squaredLength=c;f.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=-b[3];return a};f.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];a[2]=1/b[2];a[3]=1/b[3];return a};f.normalize=function(a,b){var c=b[0],d=b[1],g=b[2];b=b[3];var e=c*c+d*d+g*g+b*b;0<e&&(e=1/Math.sqrt(e),a[0]=c*e,a[1]=d*e,a[2]=g*e,a[3]=b*e);return a};f.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};f.lerp=
function(a,b,c,d){var g=b[0],e=b[1],k=b[2];b=b[3];a[0]=g+d*(c[0]-g);a[1]=e+d*(c[1]-e);a[2]=k+d*(c[2]-k);a[3]=b+d*(c[3]-b);return a};f.random=function(a,b){b=b||1;var c,d,g,k,f,l;do c=2*e.RANDOM()-1,d=2*e.RANDOM()-1,f=c*c+d*d;while(1<=f);do g=2*e.RANDOM()-1,k=2*e.RANDOM()-1,l=g*g+k*k;while(1<=l);f=Math.sqrt((1-f)/l);a[0]=b*c;a[1]=b*d;a[2]=b*g*f;a[3]=b*k*f;return a};f.transformMat4=function(a,b,c){var d=b[0],g=b[1],e=b[2];b=b[3];a[0]=c[0]*d+c[4]*g+c[8]*e+c[12]*b;a[1]=c[1]*d+c[5]*g+c[9]*e+c[13]*b;a[2]=
c[2]*d+c[6]*g+c[10]*e+c[14]*b;a[3]=c[3]*d+c[7]*g+c[11]*e+c[15]*b;return a};f.transformQuat=function(a,b,c){var d=b[0],g=b[1],e=b[2],k=c[0],f=c[1],q=c[2];c=c[3];var l=c*d+f*e-q*g,m=c*g+q*d-k*e,r=c*e+k*g-f*d,d=-k*d-f*g-q*e;a[0]=l*c+d*-k+m*-q-r*-f;a[1]=m*c+d*-f+r*-k-l*-q;a[2]=r*c+d*-q+l*-f-m*-k;a[3]=b[3];return a};f.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};f.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]};f.equals=function(a,b){var c=
a[0],d=a[1],g=a[2];a=a[3];var k=b[0],f=b[1],l=b[2];b=b[3];return Math.abs(c-k)<=e.EPSILON*Math.max(1,Math.abs(c),Math.abs(k))&&Math.abs(d-f)<=e.EPSILON*Math.max(1,Math.abs(d),Math.abs(f))&&Math.abs(g-l)<=e.EPSILON*Math.max(1,Math.abs(g),Math.abs(l))&&Math.abs(a-b)<=e.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};f.sub=r;f.mul=m;f.div=d;f.dist=g;f.sqrDist=k;f.len=l;f.sqrLen=c})},"esri/views/3d/support/projectionUtils":function(){define("require exports ../../../core/mathUtils ../../../core/maybe ../../../core/unitUtils ../../../core/libs/gl-matrix-2/mat4 ../../../core/libs/gl-matrix-2/vec3 ../../../core/libs/gl-matrix-2/vec3f64 ../../../geometry/Point ../../../geometry/SpatialReference ../../../geometry/support/aaBoundingRect ../../../layers/graphics/dehydratedFeatures ./earthUtils ../webgl-engine/lib/BufferVectorMath".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v){function t(a,b,c,n){if(2>a.length)return!1;2===a.length&&(W[0]=a[0],W[1]=a[1],W[2]=0,a=W);return z(a,b,0,c,n,0,1)}function x(a,b,c,n,h,p,y){void 0===y&&(y=0);for(var D=[],K=0;K<a.length;K++)for(var w=a[K],d=0,g=w;d<g.length;d++)w=g[d],D.push(w[0],w[1],b?w[2]:y);if(!z(D,n,0,D,p,0,D.length/3))return!1;n=0;for(p=h.length=0;p<a.length;p++){w=a[p];y=[];K=0;for(d=w;K<d.length;K++)w=d[K],b&&c?y.push([D[n++],D[n++],D[n++],w[3]]):b?y.push([D[n++],D[n++],D[n++]]):(c?y.push([D[n++],
D[n++],w[2]]):y.push([D[n++],D[n++]]),n++);h.push(y)}return!0}function z(a,b,c,n,h,p,y){void 0===y&&(y=1);b=V(b,h,C);if(r.isNone(b))return!1;if(b===E){if(a===n&&c===p)return!0;for(b=c+3*y;c<b;c++,p++)n[p]=a[c];return!0}for(y=c+3*y;c<y;c+=3,p+=3)b(a,c,n,p);return!0}function A(a,b){if(b.spatialReference===a)return b.spatialReferenceId;b.spatialReference=a;"metersPerUnit"in b&&(b.metersPerUnit=m.getMetersPerUnitForSR(a,1));return a.wkt===f.SphericalECEFSpatialReference.wkt?b.spatialReferenceId=1:a.isWGS84?
b.spatialReferenceId=2:a.isWebMercator?b.spatialReferenceId=3:a.wkt===f.WGS84ECEFSpatialReference.wkt?b.spatialReferenceId=4:4490===a.wkid?b.spatialReferenceId=5:b.spatialReferenceId=0}function E(a,b,c,n){a!==c&&(c[n++]=a[b++],c[n++]=a[b++],c[n]=a[b])}function H(a,b,c,n){c[n++]=sa*(a[b++]/q.earthRadius);c[n++]=sa*(Math.PI/2-2*Math.atan(Math.exp(-1*a[b++]/q.earthRadius)));c[n]=a[b]}function J(a,b,c,n){H(a,b,c,n);R(c,n,c,n)}function B(a,b,c,n){H(a,b,c,n);Q(c,n,c,n)}function G(a,b,c,n){var h=.4999999*
Math.PI,h=e.clamp(pa*a[b+1],-h,h),h=Math.sin(h);c[n++]=pa*a[b]*q.earthRadius;c[n++]=q.halfEarthRadius*Math.log((1+h)/(1-h));c[n]=a[b+2]}function F(a,b,c){b=A(b,ia);b=la[b][6];if(r.isNone(b))return!1;b(a,0,W,0);c!==W&&(c[0]=W[0],c[1]=W[1],2<c.length&&(c[2]=W[2]));return!0}function M(a,b){W[0]=a.x;W[1]=a.y;W[2]=a.hasZ?a.z:0;return F(W,a.spatialReference,b)}function R(a,b,c,n){var h=q.earthRadius+a[b+2],p=pa*a[b+1];a=pa*a[b];b=Math.cos(p);c[n++]=Math.cos(a)*b*h;c[n++]=Math.sin(a)*b*h;c[n]=Math.sin(p)*
h}function T(a,b,c,n){var h=v.Vec3Compact.length(a,b),p=e.asinClamped(a[b+2]/(0===h?1:h));a=Math.atan2(a[b+1],a[b]);c[n++]=sa*a;c[n++]=sa*p;c[n]=h-q.earthRadius}function O(a,b,c,n){T(a,b,c,n);G(c,n,c,n)}function L(a,b,c,n){T(a,b,c,n);Q(c,n,c,n)}function Q(a,b,c,n){var h=ta,p=pa*a[b],y=pa*a[b+1];a=a[b+2];b=Math.sin(y);var y=Math.cos(y),D=h.a/Math.sqrt(1-h.e2*b*b);c[n++]=(D+a)*y*Math.cos(p);c[n++]=(D+a)*y*Math.sin(p);c[n++]=(D*(1-h.e2)+a)*b}function S(a,b,c,n){var h=ta,p=a[b],y=a[b+1];a=a[b+2];var D,
K,w,d,g,e;b=Math.abs(a);D=p*p+y*y;K=Math.sqrt(D);w=D+a*a;d=Math.sqrt(w);p=Math.atan2(y,p);g=a*a/w;w=D/w;y=h.a2/d;D=h.a3-h.a4/d;.3<w?(g=b/d*(1+w*(h.a1+y+g*D)/d),d=Math.asin(g),y=g*g,w=Math.sqrt(1-y)):(w=K/d*(1-g*(h.a5-y-w*D)/d),d=Math.acos(w),y=1-w*w,g=Math.sqrt(y));e=1-h.e2*y;y=h.a/Math.sqrt(e);h=h.a6*y;y=K-y*w;D=b-h*g;b=w*y+g*D;K=w*D-g*y;h=K/(h/e+b);d+=h;0>a&&(d=-d);c[n++]=sa*p;c[n++]=sa*d;c[n]=b+K*h/2}function aa(a,b,c,n){S(a,b,c,n);R(c,n,c,n)}function ba(a,b,c,n){S(a,b,c,n);G(c,n,c,n)}function V(a,
b,c){void 0===c&&(c=ha());return Z(a,b,c).projector}function Z(a,b,c){if(c.source.spatialReference===a&&c.dest.spatialReference===b)return c;var n=A(a,c.source),h=A(b,c.dest);0===n&&0===h?a.equals(b)?c.projector=E:c.projector=null:c.projector=la[n][h];return c}function ha(){return{source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:E}}var X,ea,ga,oa,ja,da,ma,fa;Object.defineProperty(f,"__esModule",{value:!0});
f.SphericalECEFSpatialReference=new c({wkt:'GEOCCS["Spherical geocentric",\n  DATUM["Not specified",\n    SPHEROID["Sphere",\' + earthUtils.earthRadius + \',0]],\n  PRIMEM["Greenwich",0.0,\n    AUTHORITY["EPSG","8901"]],\n  UNIT["m",1.0],\n  AXIS["Geocentric X",OTHER],\n  AXIS["Geocentric Y",EAST],\n  AXIS["Geocentric Z",NORTH]\n]'});f.WGS84ECEFSpatialReference=new c({wkt:'GEOCCS["WGS 84",\n  DATUM["WGS_1984",\n    SPHEROID["WGS 84",6378137,298.257223563,\n      AUTHORITY["EPSG","7030"]],\n    AUTHORITY["EPSG","6326"]],\n  PRIMEM["Greenwich",0,\n    AUTHORITY["EPSG","8901"]],\n  UNIT["m",1.0,\n    AUTHORITY["EPSG","9001"]],\n  AXIS["Geocentric X",OTHER],\n  AXIS["Geocentric Y",OTHER],\n  AXIS["Geocentric Z",NORTH],\n  AUTHORITY["EPSG","4978"]\n]'});
f.canProject=function(a,b){return!!V(a,b,C)};f.getProjectorName=function(a,b){a=V(a,b,C);return a===E?"copy3":a===R?"wgs84ToSphericalECEF":a===G?"wgs84ToWebMercator":a===Q?"wgs84ToWGS84ECEF":a===H?"webMercatorToWGS84":a===J?"webMercatorToSphericalECEF":a===B?"webMercatorToWGS84ECEF":a===S?"wgs84ECEFToWGS84":a===aa?"wgs84ECEFToSphericalECEF":a===ba?"wgs84ECEFToWebMercator":a===T?"sphericalECEFToWGS84":a===O?"sphericalECEFToWebMercator":a===L?"sphericalECEFToWGS84ECEF":null};f.vectorToVector=t;f.polygonToPolygon=
function(a,b,c,n){void 0===c&&(c=b.spatialReference);void 0===n&&(n=0);var h=[];if(!x(a.rings,a.hasZ,a.hasM,a.spatialReference,h,c,n))return!1;b.rings=h;b.spatialReference=c;b.hasZ=a.hasZ;b.hasM=a.hasM;return!0};f.polylineToPolyline=function(a,b,c,n){void 0===c&&(c=b.spatialReference);void 0===n&&(n=0);var h=[];if(!x(a.paths,a.hasZ,a.hasM,a.spatialReference,h,c,n))return!1;b.paths=h;b.spatialReference=c;b.hasZ=a.hasZ;b.hasM=a.hasM;return!0};f.multipointToMultipoint=function(a,b,c,n){void 0===c&&(c=
b.spatialReference);void 0===n&&(n=0);var h=[];if(!x([a.points],a.hasZ,a.hasM,a.spatialReference,h,c,n))return!1;b.points=h[0];b.spatialReference=c;b.hasZ=a.hasZ;b.hasM=a.hasM;return!0};f.pointToPoint=function(a,b,c,n){void 0===c&&(c=b.spatialReference);void 0===n&&(n=0);W[0]=a.x;W[1]=a.y;var h=a.z;W[2]=void 0!==h?h:n;if(!z(W,a.spatialReference,0,W,c,0,1))return!1;b.x=W[0];b.y=W[1];b.spatialReference=c;void 0!==h?(b.z=W[2],b.hasZ=!0):(b.z=void 0,b.hasZ=!1);return!0};f.pointToVector=function(a,b,c,
n){void 0===n&&(n=0);W[0]=a.x;W[1]=a.y;var h=a.z;W[2]=void 0!==h?h:n;return z(W,a.spatialReference,0,b,c,0,1)};f.vectorToPoint=function(a,c,d,n){d instanceof l?n=n||d.spatialReference:b.isPoint(d)?(d.hasZ=!0,n=n||d.spatialReference):(n=d,d=new l({spatialReference:n}));return z(a,c,0,W,n,0,1)?(d.x=W[0],d.y=W[1],d.z=W[2],d.spatialReference=n,d):null};f.xyzToVector=function(a,b,c,n,h,p){W[0]=a;W[1]=b;W[2]=c;return z(W,n,0,h,p,0,1)};f.bufferToBuffer=z;f.localLinearScaleFactors=function(a,b,c,n){var h=
A(b,ia),p=A(n,ca);if(h===p&&0!==h||b.equals(n))return c[0]=1,c[1]=1,c[2]=1,!0;if(1===h){b=g.vec3.length(a);a=b/Math.sqrt(a[0]*a[0]+a[1]*a[1]);b/=q.earthRadius;if(3===p)return c[0]=a*b,c[1]=a*b,c[2]=1,!0;if(2===p||5===p)return p=180/(q.earthRadius*Math.PI),c[0]=p*a*b,c[1]=p*b,c[2]=1,!0}return!1};f.computeLinearTransformation=function(a,b,c,n){var h=A(a,ia),p=A(n,ca);if(h===p&&1!==p&&(0!==h||a.equals(n)))return d.mat4.identity(c),d.mat4.translate(c,c,b),!0;if(1===p){a=la[h][6];p=la[6][p];if(r.isNone(a)||
r.isNone(p))return!1;a(b,0,qa,0);p(qa,0,ra,0);a=pa*qa[0];p=pa*qa[1];b=Math.sin(a);a=Math.cos(a);n=Math.sin(p);p=Math.cos(p);c[0]=-b;c[4]=-n*a;c[8]=p*a;c[12]=ra[0];c[1]=a;c[5]=-n*b;c[9]=p*b;c[13]=ra[1];c[2]=0;c[6]=p;c[10]=n;c[14]=ra[2];c[3]=0;c[7]=0;c[11]=0;c[15]=1;return!0}if(3===p&&(2===h||1===h)){a=la[h][6];if(r.isNone(a))return!1;a(b,0,qa,0);b=pa*qa[1];G(qa,0,ra,0);d.mat4.identity(c);d.mat4.translate(c,c,ra);b=1/Math.cos(b);d.mat4.scale(c,c,[b,b,1]);return!0}return!1};f.transformDirection=function(a,
b,c,n,h){g.vec3.copy(va,a);g.vec3.add(Y,a,b);t(va,c,va,h);t(Y,c,Y,h);g.vec3.subtract(n,Y,va);g.vec3.normalize(n,n)};f.mbsToMbs=function(a,b,c,n){b=Z(b,n,na);if(b.projector===E)return c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],!0;if(r.isNone(b.projector))return!1;n=b.source;var h=b.dest;if(3===h.spatialReferenceId){b=la[n.spatialReferenceId][2];if(r.isNone(b))return!1;b(a,0,qa,0);b=Math.abs(pa*qa[1])+Math.asin(a[3]/(q.earthRadius+a[2]));G(qa,0,c,0);c[3]=b>.9999*Math.PI?Number.MAX_VALUE:1/Math.cos(b)*
a[3];return!0}b.projector(a,0,c,0);c[3]=a[3]*n.metersPerUnit/h.metersPerUnit;return!0};f.extentToBoundingBox=function(a,b,c){if(null==a)return!1;var n;W[0]=null!=a.xmin?a.xmin:0;W[1]=null!=a.ymin?a.ymin:0;W[2]=null!=a.zmin?a.zmin:0;n=z(W,a.spatialReference,0,b,c,0,1);W[0]=null!=a.xmax?a.xmax:0;W[1]=null!=a.ymax?a.ymax:0;W[2]=null!=a.zmax?a.zmax:0;n=n&&z(W,a.spatialReference,0,b,c,3,1);null==a.xmin&&(b[0]=-Infinity);null==a.ymin&&(b[1]=-Infinity);null==a.zmin&&(b[2]=-Infinity);null==a.xmax&&(b[3]=
Infinity);null==a.ymax&&(b[4]=Infinity);null==a.zmax&&(b[5]=Infinity);return n};f.extentToBoundingRect=function(a,b,c){if(null==a)return!1;var n;W[0]=null!=a.xmin?a.xmin:0;W[1]=null!=a.ymin?a.ymin:0;W[2]=null!=a.zmin?a.zmin:0;n=z(W,a.spatialReference,0,W,c,0,1);b[0]=W[0];b[1]=W[1];W[0]=null!=a.xmax?a.xmax:0;W[1]=null!=a.ymax?a.ymax:0;W[2]=null!=a.zmax?a.zmax:0;n=n&&z(W,a.spatialReference,0,W,c,0,1);b[2]=W[0];b[3]=W[1];null==a.xmin&&(b[0]=-Infinity);null==a.ymin&&(b[1]=-Infinity);null==a.xmax&&(b[2]=
Infinity);null==a.ymax&&(b[3]=Infinity);return n};f.boundingRectToBoundingRect=function(w,b,c,n){if(null==w)return!1;if(b.equals(n))return a.set(c,w),!0;W[0]=w[0];W[1]=w[1];W[2]=0;if(!z(W,b,0,W,n,0,1))return!1;c[0]=W[0];c[1]=W[1];W[0]=w[2];W[1]=w[3];W[2]=0;if(!z(W,b,0,W,n,0,1))return!1;c[2]=W[0];c[3]=W[1];return!0};(function(a){a.x2lon=function(a){return a/q.earthRadius};a.y2lat=function(a){return Math.PI/2-2*Math.atan(Math.exp(-1*a/q.earthRadius))};a.lon2x=function(a){return a*q.earthRadius};a.lat2y=
function(a){a=Math.sin(a);return q.earthRadius/2*Math.log((1+a)/(1-a))}})(f.webMercator||(f.webMercator={}));f.canProjectToWGS84ComparableLonLat=function(a){a=A(a,ia);return!!la[a][6]};f.vectorToWGS84ComparableLonLat=F;f.pointToWGS84ComparableLonLat=M;f.pointToWGS84ComparableLonLatPoint=function(a,b){var w=A(b.spatialReference,ca);return r.isNone(la[6][w])?!1:M(a,W)?(b.x=W[0],b.y=W[1],b.z=W[2],!0):!1};f.wgs84ComparableLonLatToECEF=function(a,b,c,n){void 0===n&&(n=0);n=q.earthRadius+n;var h=Math.cos(c);
a[0]=Math.cos(b)*h*n;a[1]=Math.sin(b)*h*n;a[2]=Math.sin(c)*n};var la=(X={},X[2]=(ea={},ea[5]=null,ea[6]=E,ea[1]=R,ea[0]=null,ea[3]=G,ea[2]=E,ea[4]=Q,ea),X[5]=(ga={},ga[5]=E,ga[6]=E,ga[1]=R,ga[0]=null,ga[3]=null,ga[2]=null,ga[4]=Q,ga),X[3]=(oa={},oa[5]=null,oa[6]=H,oa[1]=J,oa[0]=null,oa[3]=E,oa[2]=H,oa[4]=B,oa),X[4]=(ja={},ja[5]=S,ja[6]=S,ja[1]=aa,ja[0]=null,ja[3]=ba,ja[2]=S,ja[4]=E,ja),X[1]=(da={},da[5]=T,da[6]=T,da[1]=E,da[0]=null,da[3]=O,da[2]=T,da[4]=L,da),X[0]=(ma={},ma[5]=null,ma[6]=null,ma[1]=
null,ma[0]=E,ma[3]=null,ma[2]=null,ma[4]=null,ma),X[6]=(fa={},fa[5]=null,fa[6]=E,fa[1]=R,fa[0]=null,fa[3]=null,fa[2]=E,fa[4]=Q,fa),X);f.getProjector=V;var ia={spatialReference:null,spatialReferenceId:0},ca={spatialReference:null,spatialReferenceId:0},C=ha(),na=ha(),pa=e.deg2rad(1),sa=e.rad2deg(1),ta={a:6378137,e2:.006694379990137799,a1:42697.67270715754,a2:1.8230912546075456E9,a3:142.91722289812412,a4:4.557728136518864E9,a5:42840.589930055656,a6:.9933056200098622},W=k.vec3f64.create(),qa=k.vec3f64.create(),
ra=k.vec3f64.create(),va=k.vec3f64.create(),Y=k.vec3f64.create()})},"esri/views/3d/support/earthUtils":function(){define("require exports ../../../core/mathUtils ../../../core/wgs84Constants ../../../core/libs/gl-matrix-2/vec3 ../../../core/libs/gl-matrix-2/vec3f64 ../../../geometry/Point ./projectionUtils".split(" "),function(u,f,e,r,m,d,g,k){function l(a,b,c,d){var k,q;a instanceof g&&b instanceof g&&(c=b.longitude,d=b.latitude,q=a.latitude,k=a.longitude);a=e.deg2rad(q);d=e.deg2rad(d);k=e.deg2rad(k);
b=e.deg2rad(c);c=Math.sin((a-d)/2);k=Math.sin((k-b)/2);c=2*e.asinClamped(Math.sqrt(c*c+Math.cos(a)*Math.cos(d)*k*k))*f.earthRadius;return Math.round(1E4*c)/1E4}function c(a,b){a/=15;b||(a=Math.round(a));return a}Object.defineProperty(f,"__esModule",{value:!0});f.earthRadius=r.wgs84Radius;f.halfEarthRadius=f.earthRadius/2;f.halfEarthCircumference=Math.PI*f.earthRadius;f.earthCircumference=2*f.halfEarthCircumference;f.metersPerDegree=f.halfEarthCircumference/180;f.getGreatCircleDistance=l;f.getGreatCircleSpanAt=
function(a,b,c){var d=b.spatialReference,e=new g(b.x,a.y,d),k=new g(c.x,a.y,d);b=new g(a.x,b.y,d);a=new g(a.x,c.y,d);return{lon:l(e,k),lat:l(b,a)}};f.getLonDeltaForDistance=function(a,b){b/=f.earthRadius;a=e.deg2rad(a);b=Math.sin(b/2);a=Math.cos(a);a=2*e.asinClamped(Math.sqrt(b*b/(a*a)));return e.rad2deg(a)};f.getLatDeltaForDistance=function(a){return e.rad2deg(a/f.earthRadius)};f.getMaxCameraAltitude=function(a){a=e.deg2rad(a/2);return(1-Math.sin(a))*f.earthRadius/Math.sin(a)};f.getViewExtentDistance=
function(a,b){b=e.deg2rad(b/2);return 2*e.acosClamped((Math.pow(a+f.earthRadius,2)+Math.pow(f.earthRadius,2)-Math.pow((a+f.earthRadius)*Math.cos(b)-Math.sqrt(Math.pow(Math.cos(b)*(a+f.earthRadius),2)-a*a-2*a*f.earthRadius),2))/(2*(a+f.earthRadius)*f.earthRadius))*f.earthRadius};f.computeCartesianDistance=function(c,d){c=k.wgs84ComparableLonLatToECEF(a,c.longitude,c.latitude,c.z||0);d=k.wgs84ComparableLonLatToECEF(b,d.longitude,d.latitude,d.z||0);d=[d[0]-c[0],d[1]-c[1],d[2]-c[2]];return Math.sqrt(d[0]*
d[0]+d[1]*d[1]+d[2]*d[2])};f.longitudeToTimezone=c;f.positionToTimezone=function(a,b){b||(b={hours:0,minutes:0,seconds:0});b.hours=c(a[0],!0);a=b.hours%1;b.hours-=a;b.minutes=60*a;a=b.minutes%1;b.minutes-=a;b.seconds=Math.round(60*a);return b};f.distanceToIdealHorizon=function(a,b){b=b||f.earthRadius;a=m.vec3.dot(a,a);return Math.sqrt(Math.abs(a-b*b))};var a=d.vec3f64.create(),b=d.vec3f64.create()})},"esri/views/3d/webgl-engine/lib/BufferVectorMath":function(){define(["require","exports"],function(u,
f){Object.defineProperty(f,"__esModule",{value:!0});(function(e){e.length=function(e,f){var d=e[f],g=e[f+1];e=e[f+2];return Math.sqrt(d*d+g*g+e*e)};e.normalize=function(e,f){var d=e[f],g=e[f+1],k=e[f+2],d=1/Math.sqrt(d*d+g*g+k*k);e[f]*=d;e[f+1]*=d;e[f+2]*=d};e.scale=function(e,f,d){e[f]*=d;e[f+1]*=d;e[f+2]*=d};e.add=function(e,f,d,g,k,l){void 0===l&&(l=f);k=k||e;k[l]=e[f]+d[g];k[l+1]=e[f+1]+d[g+1];k[l+2]=e[f+2]+d[g+2]};e.subtract=function(e,f,d,g,k,l){void 0===l&&(l=f);k=k||e;k[l]=e[f]-d[g];k[l+1]=
e[f+1]-d[g+1];k[l+2]=e[f+2]-d[g+2]}})(f.Vec3Compact||(f.Vec3Compact={}))})},"esri/views/3d/support/ElevationProvider":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});f.getElevationAtPoint=function(e,f,m){return e.getElevation(f.x,f.y,f.z||0,f.spatialReference,m)}})},"esri/views/3d/support/debugFlags":function(){define(["require","exports","tslib","../../../core/Accessor","../../../core/accessorSupport/decorators"],function(u,f,e,r,m){return new (function(d){function g(){var g=
null!==d&&d.apply(this,arguments)||this;g.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1;g.SCENEVIEW_LOCKING_LOG=!1;g.HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED=!1;g.HIGHLIGHTS_PROFILE_TO_CONSOLE=!1;g.DECONFLICTOR_SHOW_VISIBLE=!1;g.DECONFLICTOR_SHOW_INVISIBLE=!1;g.DECONFLICTOR_SHOW_GRID=!1;g.LABELS_SHOW_BORDER=!1;g.OVERLAY_DRAW_DEBUG_TEXTURE=!1;g.OVERLAY_SHOW_CENTER=!1;g.TERRAIN_DEBUG_POPUP=!1;g.TESTS_DISABLE_UPDATE_THRESHOLDS=!1;g.DISABLE_DECONFLICTOR_VISIBILITY_OFFSET=!1;g.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES=
!1;g.DRAW_MESH_GEOMETRY_NORMALS=!1;g.FEATURE_TILE_FETCH_SHOW_TILES=!1;g.FEATURE_TILE_TREE_SHOW_TILES=!1;g.I3S_TREE_SHOW_TILES=!1;g.I3S_SHOW_MODIFICATIONS=!1;g.ENABLE_PROFILE_DEPTH_RANGE=!1;g.DISABLE_FAST_UPDATES=!1;g.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1;g.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1;g.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1;return g}e.__extends(g,d);e.__decorate([m.property()],g.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0);e.__decorate([m.property()],g.prototype,"SCENEVIEW_LOCKING_LOG",
void 0);e.__decorate([m.property()],g.prototype,"HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED",void 0);e.__decorate([m.property()],g.prototype,"HIGHLIGHTS_PROFILE_TO_CONSOLE",void 0);e.__decorate([m.property()],g.prototype,"DECONFLICTOR_SHOW_VISIBLE",void 0);e.__decorate([m.property()],g.prototype,"DECONFLICTOR_SHOW_INVISIBLE",void 0);e.__decorate([m.property()],g.prototype,"DECONFLICTOR_SHOW_GRID",void 0);e.__decorate([m.property()],g.prototype,"LABELS_SHOW_BORDER",void 0);e.__decorate([m.property()],g.prototype,
"OVERLAY_DRAW_DEBUG_TEXTURE",void 0);e.__decorate([m.property()],g.prototype,"OVERLAY_SHOW_CENTER",void 0);e.__decorate([m.property()],g.prototype,"TERRAIN_DEBUG_POPUP",void 0);e.__decorate([m.property()],g.prototype,"TESTS_DISABLE_UPDATE_THRESHOLDS",void 0);e.__decorate([m.property()],g.prototype,"DISABLE_DECONFLICTOR_VISIBILITY_OFFSET",void 0);e.__decorate([m.property()],g.prototype,"DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES",void 0);e.__decorate([m.property()],g.prototype,"DRAW_MESH_GEOMETRY_NORMALS",
void 0);e.__decorate([m.property()],g.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0);e.__decorate([m.property()],g.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0);e.__decorate([m.property()],g.prototype,"I3S_TREE_SHOW_TILES",void 0);e.__decorate([m.property()],g.prototype,"I3S_SHOW_MODIFICATIONS",void 0);e.__decorate([m.property()],g.prototype,"ENABLE_PROFILE_DEPTH_RANGE",void 0);e.__decorate([m.property()],g.prototype,"DISABLE_FAST_UPDATES",void 0);e.__decorate([m.property()],g.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",
void 0);e.__decorate([m.property()],g.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0);e.__decorate([m.property()],g.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0);return g=e.__decorate([m.subclass("esri.views.3d.support.DebugFlags")],g)}(r))})},"esri/views/3d/webgl-engine/lib/Util":function(){define("require exports ../../../../core/mathUtils ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/vec4 ../../../../core/libs/gl-matrix-2/vec4f64".split(" "),
function(u,f,e,r,m,d,g,k,l){function c(a,b){if(!a)throw b=b||"assert",a=Error(b),a.stack&&console.log(a.stack),new x(b);}function a(a){for(var b in a)return b}function b(a,b){a[12]=b[0];a[13]=b[1];a[14]=b[2]}function q(a,b){void 0===b&&(b=0);for(var c=0,d=0;4>d;d++)c+=a[b+d]*A[d];return c}function v(a){return a-Math.floor(a)}Object.defineProperty(f,"__esModule",{value:!0});var t=l.vec4f64.create(),x=function(){function a(a){this.message=a}a.prototype.toString=function(){return"AssertException: "+
this.message};return a}();f.AssertException=x;f.VertexAttrConstants={POSITION:"position",NORMAL:"normal",UV0:"uv0",AUXPOS1:"auxpos1",AUXPOS2:"auxpos2",COLOR:"color",SYMBOLCOLOR:"symbolColor",SIZE:"size",TANGENT:"tangent"};f.assert=c;f.verify=function(a,b){a||console.warn("Verify failed: "+(b||"")+"\n"+Error("verify").stack)};f.encodeInt16=function(a){return e.clamp(Math.round(32767*a),-32767,32767)};f.encodeNormal=function(a,b){var c=Math.abs(a[0]),d=Math.abs(a[1]),g=1/(c+d+Math.abs(a[2])),e=Math.min(a[2]*
g,0);b[0]=(0>a[0]?-1:1)*(c*g-e);b[1]=(0>a[1]?-1:1)*(d*g-e)};f.fallbackIfUndefined=function(a,b){return void 0===a?b:a};f.hex2rgb=function(a){a=Math.floor(a);return[(a>>16&255)/255,(a>>8&255)/255,(a&255)/255]};f.rgb2hex=function(a){var b=e.clamp(Math.round(255*a[0]),0,255),c=e.clamp(Math.round(255*a[1]),0,255);a=e.clamp(Math.round(255*a[2]),0,255);return"0x"+((b<<16)+(c<<8)+a).toString(16)};f.dec2hex=function(a){a=a.toString(16);return"00000000".substr(0,8-a.length)+a};f.rayTriangle3D=function(a,b,
c,d,e,k,f,l,q){void 0===q&&(q=g.vec3f64.create());var t=d[f]-c[k],m=d[f+1]-c[k+1],v=d[f+2]-c[k+2];d=e[l]-c[k];f=e[l+1]-c[k+1];e=e[l+2]-c[k+2];var x=b[1]*e-f*b[2],r=b[2]*d-e*b[0],z=b[0]*f-d*b[1];l=t*x+m*r+v*z;if(-1E-5<l&&1E-5>l)return!1;l=1/l;var A=a[0]-c[k],E=a[1]-c[k+1];a=a[2]-c[k+2];q[1]=l*(A*x+E*r+a*z);if(0>q[1]||1<q[1])return!1;c=E*v-m*a;a=a*t-v*A;t=A*m-t*E;q[2]=l*(b[0]*c+b[1]*a+b[2]*t);if(0>q[2]||1<q[1]+q[2])return!1;q[0]=l*(d*c+f*a+e*t);return!0};f.rayBoxTest=function(a,b,c,d){var g,e=(c[0]-
a[0])/b[0],k=(d[0]-a[0])/b[0];e>k&&(g=e,e=k,k=g);var f=(c[1]-a[1])/b[1],l=(d[1]-a[1])/b[1];f>l&&(g=f,f=l,l=g);if(e>l||f>k)return!1;f>e&&(e=f);l<k&&(k=l);c=(c[2]-a[2])/b[2];a=(d[2]-a[2])/b[2];c>a&&(g=c,c=a,a=g);if(e>a||c>k)return!1;a<k&&(k=a);return 0>k?!1:!0};f.rayRay2D=function(a,b,c,g,e,k){void 0===k&&(k=d.vec2f64.create());var f=(g[e]-c[e])*(b[0]-a[0])-(g[0]-c[0])*(b[e]-a[e]);if(0===f)return!1;c=((g[0]-c[0])*(a[e]-c[e])-(g[e]-c[e])*(a[0]-c[0]))/f;k[0]=a[0]+c*(b[0]-a[0]);k[1]=a[e]+c*(b[e]-a[e]);
return!0};f.project=function(a,b,d,g,e){e||(e=a);t[0]=a[0];t[1]=a[1];t[2]=a[2];t[3]=1;k.vec4.transformMat4(t,t,b);2<e.length&&(e[2]=-t[2]);k.vec4.transformMat4(t,t,d);c(0!==t[3]);e[0]=t[0]/t[3];e[1]=t[1]/t[3];e[2]=t[2]/t[3];e[0]=(.5*e[0]+.5)*g[2]+g[0];e[1]=(.5*e[1]+.5)*g[3]+g[1]};f.getFirstObjectKey=a;f.getFirstObjectValue=function(b){return b[a(b)]};f.objectEmpty=function(a){for(var b in a)return!1;return!0};f.logWithBase=function(a,b){return Math.log(a)/Math.log(b)};f.setMatrixTranslation=b;f.setMatrixTranslation3=
function(a,b,c,d){a[12]=b;a[13]=c;a[14]=d};f.getMatrixTranslation=function(a,b){void 0===b&&(b=g.vec3f64.create());b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};f.createTranslationMatrix=function(a,c){a=r.mat4.identity(a);b(a,c);return a};f.isTranslationMatrix=function(a){return 1===a[0]&&0===a[1]&&0===a[2]&&0===a[3]&&0===a[4]&&1===a[5]&&0===a[6]&&0===a[7]&&0===a[8]&&0===a[9]&&1===a[10]&&0===a[11]&&1===a[15]};f.fovx2fovy=function(a,b,c){return 2*Math.atan(c*Math.tan(.5*a)/b)};f.fovy2fovx=function(a,
b,c){return 2*Math.atan(b*Math.tan(.5*a)/c)};f.fovx2fovd=function(a,b,c){return 2*Math.atan(Math.sqrt(b*b+c*c)*Math.tan(.5*a)/b)};f.fovy2fovd=function(a,b,c){return 2*Math.atan(Math.sqrt(b*b+c*c)*Math.tan(.5*a)/c)};f.fovd2fovx=function(a,b,c){return 2*Math.atan(b*Math.tan(.5*a)/Math.sqrt(b*b+c*c))};f.fovd2fovy=function(a,b,c){return 2*Math.atan(c*Math.tan(.5*a)/Math.sqrt(b*b+c*c))};f.packFloatRGBA=function(a,b,c){void 0===c&&(c=0);a=e.clamp(a,0,E);for(var d=0;4>d;d++)b[c+d]=Math.floor(256*v(a*z[d]))};
f.unpackFloatRGBA=q;var z=[1,256,65536,16777216],A=[1/256,1/65536,1/16777216,1/4294967296],E=q(new Uint8ClampedArray([255,255,255,255]));f.inverseProjectionInfo=function(a,b,c,d,g){0===a[11]?(d[0]=2/(b*a[0]),d[1]=2/(c*a[5]),d[2]=(1+a[12])/a[0],d[3]=(1+a[13])/a[5],m.vec2.set(g,0,1)):(d[0]=-2/(b*a[0]),d[1]=-2/(c*a[5]),d[2]=(1-a[8])/a[0],d[3]=(1-a[9])/a[5],m.vec2.set(g,1,0))}})},"esri/core/libs/gl-matrix-2/vec2":function(){define(["require","exports","./math/vec2"],function(u,f,e){Object.defineProperty(f,
"__esModule",{value:!0});f.vec2=e})},"esri/core/libs/gl-matrix-2/math/vec2":function(){define(["require","exports","./common"],function(u,f,e){function r(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];return a}function m(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];return a}function d(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];return a}function g(a,b){var c=b[0]-a[0];a=b[1]-a[1];return Math.sqrt(c*c+a*a)}function k(a,b){var c=b[0]-a[0];a=b[1]-a[1];return c*c+a*a}function l(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)}
function c(a){var b=a[0];a=a[1];return b*b+a*a}Object.defineProperty(f,"__esModule",{value:!0});f.copy=function(a,b){a[0]=b[0];a[1]=b[1];return a};f.set=function(a,b,c){a[0]=b;a[1]=c;return a};f.add=function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];return a};f.subtract=r;f.multiply=m;f.divide=d;f.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);return a};f.floor=function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);return a};f.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],
c[1]);return a};f.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);return a};f.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);return a};f.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;return a};f.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;return a};f.distance=g;f.squaredDistance=k;f.length=l;f.squaredLength=c;f.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];return a};f.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];return a};f.normalize=function(a,
b){var c=b[0],d=b[1],c=c*c+d*d;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c);return a};f.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};f.cross=function(a,b,c){b=b[0]*c[1]-b[1]*c[0];a[0]=a[1]=0;a[2]=b;return a};f.lerp=function(a,b,c,d){var g=b[0];b=b[1];a[0]=g+d*(c[0]-g);a[1]=b+d*(c[1]-b);return a};f.random=function(a,b){b=b||1;var c=2*e.RANDOM()*Math.PI;a[0]=Math.cos(c)*b;a[1]=Math.sin(c)*b;return a};f.transformMat2=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b;a[1]=c[1]*d+c[3]*b;return a};
f.transformMat2d=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b+c[4];a[1]=c[1]*d+c[3]*b+c[5];return a};f.transformMat3=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[3]*b+c[6];a[1]=c[1]*d+c[4]*b+c[7];return a};f.transformMat4=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[4]*b+c[12];a[1]=c[1]*d+c[5]*b+c[13];return a};f.rotate=function(a,b,c,d){var g=b[0]-c[0];b=b[1]-c[1];var e=Math.sin(d);d=Math.cos(d);a[0]=g*d-b*e+c[0];a[1]=g*e+b*d+c[1];return a};f.angle=function(a,b){var c=a[0];a=a[1];var d=
b[0];b=b[1];var g=c*c+a*a;0<g&&(g=1/Math.sqrt(g));var e=d*d+b*b;0<e&&(e=1/Math.sqrt(e));c=(c*d+a*b)*g*e;return 1<c?0:-1>c?Math.PI:Math.acos(c)};f.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};f.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]};f.equals=function(a,b){var c=a[0];a=a[1];var d=b[0];b=b[1];return Math.abs(c-d)<=e.EPSILON*Math.max(1,Math.abs(c),Math.abs(d))&&Math.abs(a-b)<=e.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};f.len=l;f.sub=r;f.mul=m;f.div=d;f.dist=g;f.sqrDist=k;f.sqrLen=
c})},"esri/views/3d/layers/graphics/ElevationContext":function(){define(["require","exports","../../../../core/maybe","../../../../symbols/support/unitConversionUtils","./featureExpressionInfoUtils"],function(u,f,e,r,m){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function d(){this._renderUnitOffset=this._meterUnitOffset=0;this._unit="meters";this._metersPerElevationInfoUnit=1;this.mode=this.centerPointInElevationSR=this._featureExpressionInfoContext=null}Object.defineProperty(d.prototype,
"featureExpressionInfoContext",{get:function(){return this._featureExpressionInfoContext},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"meterUnitOffset",{get:function(){return this._meterUnitOffset},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"unit",{get:function(){return this._unit},set:function(d){this._unit=d;this._metersPerElevationInfoUnit=r.getMetersPerUnit(d)},enumerable:!0,configurable:!0});d.prototype.reset=function(){this.mode=null;this._renderUnitOffset=
this._meterUnitOffset=0;this._featureExpressionInfoContext=null;this.unit="meters"};Object.defineProperty(d.prototype,"offsetMeters",{set:function(d){this._meterUnitOffset=d;this._renderUnitOffset=0},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"offsetElevationInfoUnits",{set:function(d){this._meterUnitOffset=d*this._metersPerElevationInfoUnit;this._renderUnitOffset=0},enumerable:!0,configurable:!0});d.prototype.addOffsetRenderUnits=function(d){this._renderUnitOffset+=d};d.prototype.geometryZWithOffset=
function(d,e){e=this.calculateOffsetRenderUnits(e);return null!=this.featureExpressionInfoContext?e:d+e};d.prototype.calculateOffsetRenderUnits=function(d){var g=this._meterUnitOffset,e=this.featureExpressionInfoContext;null!=e&&(g+=m.execute(e)*this._metersPerElevationInfoUnit);return g/d.unitInMeters+this._renderUnitOffset};d.prototype.setFromElevationInfo=function(d){this.mode=d.mode;this.unit=d.unit||"meters";this.offsetElevationInfoUnits=e.unwrapOr(d.offset,0)};d.prototype.updateFeatureExpressionInfoContext=
function(d,k,f){if(e.isNone(d))this._featureExpressionInfoContext=null;else{var c=d&&d.arcade;c&&e.isSome(k)&&e.isSome(f)?(this._featureExpressionInfoContext=m.clone(d),m.setContextFeature(this._featureExpressionInfoContext,m.createFeature(c.modules,k,f))):this._featureExpressionInfoContext=d}};d.fromElevationInfo=function(g){var k=new d;e.isSome(g)&&k.setFromElevationInfo(g);return k};return d}();f.ElevationContext=u})},"esri/views/3d/layers/graphics/featureExpressionInfoUtils":function(){define("require exports tslib ../../../../core/Logger ../../../../layers/graphics/dehydratedFeatures ../../../../support/arcadeOnDemand".split(" "),
function(u,f,e,r,m,d){Object.defineProperty(f,"__esModule",{value:!0});var g=r.getLogger("esri.views.3d.layers.graphics.featureExpressionInfoUtils");f.clone=function(d){return{cachedResult:d.cachedResult,arcade:d.arcade?{func:d.arcade.func,context:d.arcade.modules.arcadeUtils.createExecContext(null,{sr:d.arcade.context.spatialReference}),modules:d.arcade.modules}:null}};f.createContextWithoutExpressionSupport=function(d){d=d&&d.expression;return"string"===typeof d&&(d="0"===d?0:null,null!=d)?{cachedResult:d}:
null};f.createContext=function(g,f,c){return e.__awaiter(this,void 0,void 0,function(){var a,b,k,l,t;return e.__generator(this,function(e){switch(e.label){case 0:a=g&&g.expression;if("string"!==typeof a)return[2,null];b="0"===a?0:null;return null!=b?[2,{cachedResult:b}]:[4,d.loadArcade()];case 1:return k=e.sent(),l=k.arcadeUtils,t=l.createSyntaxTree(a),l.dependsOnView(t)?(null!=c&&c.error("Expressions containing '$view' are not supported on ElevationInfo"),[2,{cachedResult:0}]):[2,{arcade:{func:l.createFunction(t),
context:l.createExecContext(null,{sr:f}),modules:k}}]}})})};f.createFeature=function(d,g,c){return d.arcadeUtils.createFeature(g.attributes,g.geometry,c)};f.setContextFeature=function(d,e){null!=d&&null==d.cachedResult&&(e&&d.arcade?(e._geometry&&(e._geometry=m.hydrateGeometry(e._geometry)),d.arcade.modules.arcadeUtils.updateExecContext(d.arcade.context,e)):g.errorOncePerTick("Arcade support required but not provided"))};f.execute=function(d){if(null!=d){if(null!=d.cachedResult)return d.cachedResult;
var g=d.arcade,g=d.arcade.modules.arcadeUtils.executeFunction(g.func,g.context);"number"!==typeof g&&(g=d.cachedResult=0);return g}return 0};f.extractExpressionInfo=function(d,g){void 0===g&&(g=!1);var c=(d=d&&d.featureExpressionInfo)&&d.expression;g||"0"===c||(d=null);return d};f.zeroContext={cachedResult:0}})},"esri/views/3d/layers/graphics/Graphics3DDrapedGraphicLayer":function(){define("require exports tslib ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/aaBoundingRect ./graphicUtils".split(" "),
function(u,f,e,r,m,d,g,k){u=function(){function b(a,b,c){this.graphics3DSymbolLayer=a;this.renderGeometries=b;this.boundingBox=c;this.type="draped";this.stage=null;this._addedToStage=this._visible=!1;this._layerView=null;this.isElevationSource=!1}b.prototype.initialize=function(a,b,c){this.stage=a;this._layerView=c;this._overlayRenderer=this._layerView.view.basemapTerrain.overlayManager.renderer};b.prototype.setVisibility=function(a){if(null!=this.stage){if(this._visible!==a){if((this._visible=a)&&
!this._addedToStage)return this._addedToStage=!0,this._overlayRenderer.addGeometries(this.renderGeometries,this._layerView,0),!0;if(!a&&!this._addedToStage)return!1;a=0;for(var b=this.renderGeometries;a<b.length;a++)b[a].instanceParameters.visible=this._visible;this._overlayRenderer.updateGeometries(this.renderGeometries,this._layerView,1);return!0}return!1}};b.prototype.destroy=function(){this.stage&&this._addedToStage&&this._overlayRenderer.removeGeometries(this.renderGeometries,this._layerView,
1);this._visible=this._addedToStage=!1;this.stage=null};b.prototype.getBSRadius=function(){return this.renderGeometries.reduce(function(a,b){return Math.max(a,b.bsRadius)},0)};b.prototype.getCenterObjectSpace=function(a){void 0===a&&(a=m.vec3f64.create());return r.vec3.set(a,0,0,0)};b.prototype.getBoundingBoxObjectSpace=function(a){void 0===a&&(a=d.create());return d.empty(a)};b.prototype.addObjectState=function(a,b){var c=this;0===a&&(this.renderGeometries.forEach(function(a){var d=a.addHighlight();
b.addRenderGeometry(a,d,c)}),this._addedToStage&&this._overlayRenderer.updateHighlights(this.renderGeometries,this._layerView))};b.prototype.removeObjectState=function(a){this.renderGeometries.forEach(function(b){a.removeRenderGeometry(b)})};b.prototype.removeRenderGeometryObjectState=function(a,b){a.removeHighlight(b);this._addedToStage&&this._overlayRenderer.updateHighlights(this.renderGeometries,this._layerView)};b.prototype.computeAttachmentOrigin=function(b){for(var c=0,d=this.renderGeometries;c<
d.length;c++)d[c].computeAttachmentOrigin(a)&&(b.draped.origin[0]+=a[0],b.draped.origin[1]+=a[1],b.draped.num++)};b.prototype.getProjectedBoundingBox=function(b,c,g,f,m){return e.__awaiter(this,void 0,void 0,function(){var q,t,v,x;return e.__generator(this,function(e){switch(e.label){case 0:d.empty(m);for(q=0;q<this.renderGeometries.length;q++)t=this.renderGeometries[q],this._getRenderGeometryProjectedBoundingRect(t,b,l,g),d.expand(m,l);if(!c)return[3,5];d.center(m,a);v=void 0;x=k.demResolutionForBoundingBox(m,
c);e.label=1;case 1:return e.trys.push([1,3,,4]),[4,c.service.queryElevation(a[0],a[1],f,x)];case 2:return v=e.sent(),[3,4];case 3:return e.sent(),v=null,[3,4];case 4:null!=v&&(m[2]=Math.min(m[2],v),m[5]=Math.max(m[5],v)),e.label=5;case 5:return[2,m]}})})};b.prototype._getRenderGeometryProjectedBoundingRect=function(a,b,g,e){if(this.boundingBox)d.set(c,this.boundingBox);else{var k=a.center;a=a.bsRadius;c[0]=k[0]-a;c[1]=k[1]-a;c[2]=k[2]-a;c[3]=k[0]+a;c[4]=k[1]+a;c[5]=k[2]+a}b(c,0,2);this.calculateRelativeScreenBounds&&
e.push({location:d.center(c),screenSpaceBoundingRect:this.calculateRelativeScreenBounds()});return d.toRect(c,g)};return b}();var l=g.create(),c=d.create(),a=m.vec3f64.create();return u})},"esri/views/3d/layers/graphics/Graphics3DObject3DGraphicLayer":function(){define("require exports tslib ../../../../core/maybe ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../geometry/support/aaBoundingBox ./featureExpressionInfoUtils ./graphicUtils".split(" "),function(u,
f,e,r,m,d,g,k,l){function c(a){return a.isVisible?a.getParameters().transparent?1:2:0}u=function(){function f(a,b,c,d,g,e,k,l,q){this.uniqueGeometries=c;this.uniqueMaterials=d;this.uniqueTextures=g;this.elevationAligner=e;this.elevationContext=k;this._edgeState=l;this.type="object3d";this.stage=this.stageLayer=null;this._addedToStage=this._visible=!1;this.alignedSampledElevation=0;this.needsElevationUpdates=!1;this.graphics3DSymbolLayer=a;this.stageObject=b;this.visibilityMode=null!=q?q:f.VisibilityModes.HIDE_FACERANGE}
Object.defineProperty(f.prototype,"isElevationSource",{get:function(){return!(!this.stageObject.metadata||!this.stageObject.metadata.isElevationSource)},enumerable:!0,configurable:!0});f.prototype.initialize=function(a,b){this.stageLayer=b;this.stage=a;if(this.uniqueMaterials)for(b=0;b<this.uniqueMaterials.length;b++)a.add(3,this.uniqueMaterials[b]);if(this.uniqueGeometries)for(b=0;b<this.uniqueGeometries.length;b++)a.add(2,this.uniqueGeometries[b]);if(this.uniqueTextures)for(b=0;b<this.uniqueTextures.length;b++)a.add(4,
this.uniqueTextures[b]);a.add(1,this.stageObject)};f.prototype.layerOpacityChanged=function(a,b){if(!r.isNone(this._edgeState)){for(var d=c(this._edgeState.baseMaterial),g=!1,e=0,k=this._edgeState.edgeMaterials;e<k.length;e++){var f=k[e];f.objectTransparency!==d&&(f.objectTransparency=d,g=!0)}g&&this.resetEdgeObject(b);this.stage.renderView.ensureEdgeView().updateAllComponentOpacities(this.stageObject,[a])}};f.prototype.slicePlaneEnabledChanged=function(a,b){r.isNone(this._edgeState)||(this.stage.renderView.ensureEdgeView().updateAllComponentMaterials(this.stageObject,
this._edgeState.edgeMaterials,{slicePlaneEnabled:a},!b),this._edgeState.slicePlaneEnabled=a)};f.prototype.setVisibility=function(a){if(null!=this.stage){if(this._visible===a)return!1;(this._visible=a)?this._addedToStage?this.stageObject.setVisible(!0):(this.stageLayer.addObject(this.stageObject),this._addedToStage=!0):this.visibilityMode===f.VisibilityModes.HIDE_FACERANGE?this.stageObject.setVisible(!1):(this.stageLayer.removeObject(this.stageObject),this._addedToStage=!1);if(r.isSome(this._edgeState)){var b=
this.stage.renderView.ensureEdgeView();b.hasObject(this.stageObject)?b.updateObjectVisibility(this.stageObject,a):a&&this.addOrUpdateEdgeObject(b,!1)}return!0}};Object.defineProperty(f.prototype,"visible",{get:function(){return this._visible},enumerable:!0,configurable:!0});f.prototype.destroy=function(){var a=this.stage;if(this.stageLayer){if(this.uniqueMaterials)for(var b=0;b<this.uniqueMaterials.length;b++)a.remove(3,this.uniqueMaterials[b].id);if(this.uniqueGeometries)for(b=0;b<this.uniqueGeometries.length;b++)a.remove(2,
this.uniqueGeometries[b].id);if(this.uniqueTextures)for(b=0;b<this.uniqueTextures.length;b++)a.remove(4,this.uniqueTextures[b].id)}a.remove(1,this.stageObject.id);this._addedToStage&&(this.stageLayer.removeObject(this.stageObject),this._addedToStage=!1);a=this.stage.renderView.ensureEdgeView();a.hasObject(this.stageObject)&&a.removeObject(this.stageObject);this.stageObject.dispose();this._visible=!1;this.stage=this.stageLayer=null};f.prototype.alignWithElevation=function(a,b,c,d){null!=this.elevationAligner&&
(r.isSome(c)&&k.setContextFeature(this.elevationContext.featureExpressionInfoContext,c),a=this.elevationAligner(this,this.elevationContext,a,b),null!=a&&(this.alignedSampledElevation=a),this.resetEdgeObject(d))};f.prototype.getBSRadius=function(){return this.stageObject.getBSRadius()};f.prototype.getCenterObjectSpace=function(a){void 0===a&&(a=d.vec3f64.create());return m.vec3.copy(a,this.stageObject.getCenter(!0))};f.prototype.getBoundingBoxObjectSpace=function(a){void 0===a&&(a=g.create());var b=
this.stageObject;a||(a=g.create());g.setMin(a,b.getBBMin(!0));g.setMax(a,b.getBBMax(!0));return a};f.prototype.computeAttachmentOrigin=function(a){for(var b=0,c=this.stageObject.geometryRecords;b<c.length;b++)c[b].computeAttachmentOrigin(q)&&(m.vec3.transformMat4(q,q,this.stageObject.objectTransformation),m.vec3.add(a.render.origin,a.render.origin,q),a.render.num++)};f.prototype.getProjectedBoundingBox=function(c,d,k,f,t){return e.__awaiter(this,void 0,void 0,function(){var r,x,z,A,E,H,u,O,L,Q;return e.__generator(this,
function(e){switch(e.label){case 0:r=this.getBoundingBoxObjectSpace(t);x=v;z=g.isPoint(r)?1:x.length;for(A=0;A<z;A++)E=x[A],b[0]=r[E[0]],b[1]=r[E[1]],b[2]=r[E[2]],m.vec3.transformMat4(b,b,this.stageObject.objectTransformation),a[3*A+0]=b[0],a[3*A+1]=b[1],a[3*A+2]=b[2];if(!c(a,0,z))return[2,null];g.empty(r);H=null;this.calculateRelativeScreenBounds&&(H=this.calculateRelativeScreenBounds());for(A=0;A<3*z;A+=3){for(u=0;3>u;u++)r[u]=Math.min(r[u],a[A+u]),r[u+3]=Math.max(r[u+3],a[A+u]);H&&k.push({location:a.slice(A,
A+3),screenSpaceBoundingRect:H})}if(!d||!d.service||"absolute-height"===this.elevationContext.mode)return[3,5];g.center(r,q);O="relative-to-scene"===this.elevationContext.mode?"scene":"ground";L=void 0;if(!d.useViewElevation)return[3,1];L=d.service.getElevation(q[0],q[1],O);return[3,4];case 1:return e.trys.push([1,3,,4]),Q=l.demResolutionForBoundingBox(r,d),[4,d.service.queryElevation(q[0],q[1],f,Q,O)];case 2:return L=e.sent(),[3,4];case 3:return e.sent(),L=null,[3,4];case 4:g.offset(r,0,0,-this.alignedSampledElevation+
L),e.label=5;case 5:return[2,r]}})})};f.prototype.addObjectState=function(a,b){0===a&&b.addObject(this.stageObject,this.stageObject.highlight());1===a&&b.addObject(this.stageObject,this.stageObject.occlude())};f.prototype.removeObjectState=function(a){a.removeObject(this.stageObject)};f.prototype.resetEdgeObject=function(a){if(!r.isNone(this._edgeState)){var b=this.stage.renderView.ensureEdgeView();this._visible?this.addOrUpdateEdgeObject(b,a):b.removeObject(this.stageObject)}};f.prototype.addOrUpdateEdgeObject=
function(a,b){var d=this._edgeState;if(!r.isNone(d)){for(var g=c(d.baseMaterial),e=0,k=d.edgeMaterials;e<k.length;e++)k[e].objectTransparency=g;a.addOrUpdateObject(this.stageObject,d.edgeMaterials,{slicePlaneEnabled:d.slicePlaneEnabled},!b,d.addObjectSettings)}};return f}();(function(a){a=a.VisibilityModes||(a.VisibilityModes={});a[a.REMOVE_OBJECT=0]="REMOVE_OBJECT";a[a.HIDE_FACERANGE=1]="HIDE_FACERANGE"})(u||(u={}));var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b=d.vec3f64.create(),q=d.vec3f64.create(),
v=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]];return u})},"esri/views/3d/layers/graphics/Graphics3DSymbolLayer":function(){define("require exports tslib ../../../../Color ../../../../core/arrayUtils ../../../../core/compilerUtils ../../../../core/Logger ../../../../core/mathUtils ../../../../core/maybe ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/vec4f64 ./elevationAlignmentUtils ./ElevationContext ./featureExpressionInfoUtils ./graphicUtils ./Loadable ./symbolComplexity".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z){function A(a,b){a=null!=a?b.attributes[a]:0;return null!=a&&isFinite(a)?a:0}Object.defineProperty(f,"__esModule",{value:!0});var E=g.getLogger("esri.views.3d.layers.graphics.Graphics3DSymbolLayer");u=function(g){function f(a,b,c,d){var e=g.call(this)||this;e._elevationInfoOverride=null;e.complexity=null;e.logger=E;e._elevationOptions={supportsOffsetAdjustment:!1,supportsOnTheGround:!0};e.symbol=a;e.symbolLayer=b;e._context=c;e._renderPriority=d.renderPriority;
e._renderPriorityStep=d.renderPriorityStep;e._elevationContext=new q.ElevationContext;e.complexity=e.computeComplexity();e._updateDrivenProperties(d.ignoreDrivers);e._updateElevationContext();return e}e.__extends(f,g);f.prototype.getCachedSize=function(){return null};Object.defineProperty(f.prototype,"needsDrivenTransparentPass",{get:function(){return this._drivenProperties.opacity&&!this._drivenProperties.opacityAlwaysOpaque},enumerable:!0,configurable:!0});f.prototype._logGeometryCreationWarnings=
function(a,b,c,d){var g="polygons"in a?a.polygons:null;d+=" geometry failed to be created";var e=null;a.projectionSuccess?!b.length||1===b.length&&!b[0].length?e=d+" (no "+c+" were defined)":Array.isArray(b)&&Array.isArray(b[0])?b.some(function(a){return 1===a.length})?e=d+" ("+c+" should contain at least 2 vertices)":g&&0===g.length&&"rings"===c&&(e=d+" (filled "+c+" should use clockwise winding - try reversing the order of vertices)"):e=d+" ("+c+" should be defined as a 2D array)":e=d+" (failed to project geometry to view spatial reference)";
e&&E.warnOncePerTick(e)};f.prototype._validateGeometryType=function(a,b,c){if(m.includes(b,a.type))return!0;this.logger.warn("unsupported geometry type for "+c+(" symbol: "+a.type));return!1};f.prototype._validateGeometry=function(a){return"point"!==a.type||k.isFinite(a.x)&&k.isFinite(a.y)?!0:(E.warn("point coordinate is not a valid number, graphic skipped"),!1)};f.prototype._defaultElevationInfoNoZ=function(){return H};f.prototype._defaultElevationInfoZ=function(){return J};f.prototype._updateElevationContext=
function(){l.isSome(this._elevationInfoOverride)?(this._elevationContext.setFromElevationInfo(this._elevationInfoOverride),this._elevationContext.updateFeatureExpressionInfoContext(null)):this._context.layer.elevationInfo?(this._elevationContext.setFromElevationInfo(this._context.layer.elevationInfo),this._elevationContext.updateFeatureExpressionInfoContext(this._context.featureExpressionInfoContext)):this._elevationContext.reset()};f.prototype.getDefaultElevationInfo=function(a){return a.hasZ?this._defaultElevationInfoZ():
this._defaultElevationInfoNoZ()};f.prototype.getGeometryElevationMode=function(a,b){void 0===b&&(b=this.getDefaultElevationInfo(a));return this._elevationContext.mode||b.mode};f.prototype.setElevationInfoOverride=function(a){this._elevationInfoOverride=a;this._updateElevationContext()};f.prototype.setGraphicElevationContext=function(a,b){var c=l.unwrap(a.geometry),d=this.getDefaultElevationInfo(c);b.unit=null!=this._elevationContext.unit?this._elevationContext.unit:d.unit;b.mode=this.getGeometryElevationMode(c,
d);b.offsetMeters=l.unwrapOr(this._elevationContext.meterUnitOffset,l.unwrapOr(d.offset,0));if(c=!this._elevationOptions.supportsOnTheGround&&"on-the-ground"===b.mode)b.mode="relative-to-ground",b.offsetMeters=0;b.updateFeatureExpressionInfoContext(c?v.zeroContext:this._elevationContext.featureExpressionInfoContext,a,this._context.layer);return b};f.prototype.prepareSymbolLayerPatch=function(a){};f.prototype.updateGeometry=function(a,b){return!1};f.prototype.onRemoveGraphic=function(a){};f.prototype._updateDrivenProperties=
function(a){var b={color:!1,opacity:!1,opacityAlwaysOpaque:!0,size:!1};a||(a=this._context.renderer)&&"visualVariables"in a&&a.visualVariables&&a.visualVariables.forEach(function(a){switch(a.type){case "color":b.color=!0;if(a.stops)for(var c=0;c<a.stops.length;c++){var d=a.stops[c].color;d&&(b.opacity=!0,1>d.a&&(b.opacityAlwaysOpaque=!1))}break;case "opacity":b.opacity=!0;b.opacityAlwaysOpaque=!1;break;case "size":b.size=!0}});this._drivenProperties=b};f.prototype._getLayerOpacity=function(){if(this._context.layerView&&
"fullOpacity"in this._context.layerView)return this._context.layerView.fullOpacity;var a=this._context.layer.opacity;return null==a?1:a};f.prototype._getCombinedOpacity=function(a,b){void 0===b&&(b=B);var c=1;this.draped||(c*=this._getLayerOpacity());if(this._drivenProperties.opacity)return c;l.isSome(a)?c*=a.a:b.hasIntrinsicColor||(c=0);return c};f.prototype._getCombinedOpacityAndColor=function(a,b){void 0===b&&(b=B);b=this._getCombinedOpacity(a,b);if(this._drivenProperties.color)return t.mixinColorAndOpacity(null,
b);a=l.isSome(a)?r.toUnitRGB(a):c.vec3f64.ONES;return t.mixinColorAndOpacity(a,b)};f.prototype._getVertexOpacityAndColor=function(a,b,c){a=t.mixinColorAndOpacity(this._drivenProperties.color?a.color:null,this._drivenProperties.opacity?a.opacity:null);c&&(a[0]*=c,a[1]*=c,a[2]*=c,a[3]*=c);return b?new b(a):a};f.prototype._getIdHint=function(a){void 0===a&&(a="");return this._context.layer.id+"_symbol"+a};f.prototype.isFastUpdatesEnabled=function(){return this._fastUpdates&&this._fastUpdates.enabled};
f.prototype.computeComplexity=function(){return z.defaultSymbolLayerComplexity(this.symbol,this.symbolLayer)};f.prototype.destroy=function(){this.abortLoad()};f.prototype.globalPropertyChanged=function(a,c,g){switch(a){case "opacity":return this.layerOpacityChanged(c,g);case "elevationInfo":return a=this._elevationContext.mode,this._updateElevationContext(),this.layerElevationInfoChanged(c,g,a)===b.SymbolUpdateType.RECREATE?!1:!0;case "slicePlaneEnabled":return this.slicePlaneEnabledChanged(c,g);
case "physicalBasedRenderingEnabled":return this.physicalBasedRenderingChanged();case "pixelRatio":return this.pixelRatioChanged();default:return d.neverReachedSilent(a),!1}};f.prototype.updateGraphics3DGraphicElevationInfo=function(a,c,d){var g=this,e=b.SymbolUpdateType.UPDATE;a.forEach(function(a){var k=c(a);l.isSome(k)?(g.setGraphicElevationContext(a.graphic,k.elevationContext),k.needsElevationUpdates=d(k.elevationContext.mode)):e=b.SymbolUpdateType.RECREATE});return e};f.prototype.applyRendererDiff=
function(a,b){return!1};f.prototype.getFastUpdateAttrValues=function(b){if(!this._fastUpdates.enabled)return null;var c=this._fastUpdates.visualVariables,d=c.size?A(c.size.field,b):0,g=c.color?A(c.color.field,b):0;b=c.opacity?A(c.opacity.field,b):0;return a.vec4f64.fromValues(d,g,b,0)};Object.defineProperty(f.prototype,"draped",{get:function(){return this._draped},enumerable:!0,configurable:!0});f.prototype.ensureDrapedStatus=function(a){if(null==this._draped)return this._draped=a,!0;a!==this.draped&&
E.warnOnce("A symbol can only produce either draped or non-draped visualizations. Use two separate symbol instances for draped and non-draped graphics if necessary.");return!1};return f}(x.Loadable);f.Graphics3DSymbolLayer=u;f.getAttributeValue=A;var H={mode:"on-the-ground",offset:0,unit:"meters"},J={mode:"absolute-height",offset:0,unit:"meters"},B={hasIntrinsicColor:!1};f.default=u})},"esri/views/3d/layers/graphics/Loadable":function(){define(["require","exports","../../../../core/promiseUtils"],
function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function f(){this._abortController=null;this._loadStatus=0;this.logger=this._loader=this._loadError=null}Object.defineProperty(f.prototype,"loadStatus",{get:function(){return this._loadStatus},enumerable:!0,configurable:!0});f.prototype.load=function(f,d){var g=this;if(1===this._loadStatus)return f&&f(),this._loader;if(2===this._loadStatus)return d&&d(this._loadError),this._loader;this._loader||(this._abortController=e.createAbortController(),
this._loader=this.doLoad(this._abortController.signal).then(function(){g._abortController=null;g._loadStatus=1},function(d){g._loadError=d;g._abortController=null;g._loadStatus=2;!e.isAbortError(d)&&g.logger&&d.message&&g.logger.warn(d.message);throw d;}));this._loader.then(f,d).catch(function(){});return this._loader};f.prototype.abortLoad=function(){this._abortController?(this._abortController.abort(),this._abortController=null):0===this._loadStatus&&(this._loadStatus=2);this._loader=null};return f}();
f.Loadable=u})},"esri/views/3d/layers/graphics/symbolComplexity":function(){define("require exports tslib ../../../../core/compilerUtils ../../../../core/maybe ../../../../symbols/support/ObjectSymbol3DLayerResource ./primitiveObjectSymbolUtils ../../webgl-engine/lib/Util ../../webgl-engine/lib/lodRendering/LodResources".split(" "),function(u,f,e,r,m,d,g,k,l){function c(a){for(var b=0,c=0,d=!1,g={bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0,draped:{bytesPerFeature:0,bytesPerFeatureLabel:0,
bytesPerCoordinate:0}},e=0;e<a.length;e++){var k=a[e];k&&(b+=k.primitivesPerFeature,c+=k.primitivesPerCoordinate,g.bytesPerFeature+=k.memory.bytesPerFeature,g.bytesPerFeatureLabel+=k.memory.bytesPerFeatureLabel,g.bytesPerCoordinate+=k.memory.bytesPerCoordinate,g.draped.bytesPerFeature+=k.memory.bytesPerFeature,g.draped.bytesPerFeatureLabel+=k.memory.bytesPerFeatureLabel,g.draped.bytesPerCoordinate+=k.memory.bytesPerCoordinate,d=d||k.estimated)}return{primitivesPerFeature:b,primitivesPerCoordinate:c,
estimated:d,memory:g}}function a(a,c){var g=b(a,c);switch(c.type){case "extrude":return{primitivesPerFeature:-4,primitivesPerCoordinate:4,estimated:!1,memory:g};case "fill":return"mesh-3d"===a.type?{primitivesPerFeature:0,primitivesPerCoordinate:0,estimated:!1,memory:g}:m.isSome(c.outline)&&0<c.outline.size?{primitivesPerFeature:-4,primitivesPerCoordinate:3,estimated:!1,memory:g}:{primitivesPerFeature:-2,primitivesPerCoordinate:1,estimated:!1,memory:g};case "water":return{primitivesPerFeature:-2,
primitivesPerCoordinate:1,estimated:!1,memory:g};case "line":return{primitivesPerFeature:-2,primitivesPerCoordinate:2,estimated:!1,memory:g};case "object":return c.resource&&c.resource.href?{primitivesPerFeature:16,primitivesPerCoordinate:0,estimated:!0,memory:g}:e.__assign(e.__assign({},q(c.resource&&c.resource.primitive||d.defaultPrimitive)),{memory:g});case "path":var k=a=0;switch(c.profile){case "circle":a=10;break;case "quad":a=4;break;default:r.neverReached(c.profile);return}switch(c.join){case "round":k=
3;break;case "miter":case "bevel":k=1;break;default:r.neverReached(c.join);return}var f=2*a,k=a*k*2,l=-2*k-f;switch(c.cap){case "none":break;case "butt":case "square":l+=2*(a-1);break;case "round":l+=2*(4*a+a);break;default:r.neverReached(c.cap);return}return{primitivesPerFeature:l,primitivesPerCoordinate:k+f,estimated:!1,memory:g};case "text":case "icon":return{primitivesPerFeature:2,primitivesPerCoordinate:0,estimated:!1,memory:g};default:r.neverReached(c)}}function b(a,b){a="point-3d"===a.type;
switch(b.type){case "extrude":return b.edges&&0<b.edges.size?f.memoryEstimators.EXTRUDE_EDGES:f.memoryEstimators.EXTRUDE;case "fill":return m.isSome(b.outline)&&0<b.outline.size?f.memoryEstimators.FILL_OUTLINE:f.memoryEstimators.FILL;case "water":return f.memoryEstimators.FILL;case "line":return"round"===b.join?f.memoryEstimators.LINE_ROUND:f.memoryEstimators.LINE_MITER;case "path":switch(b.join){case "round":switch(b.profile){case "circle":return f.memoryEstimators.PATH_ROUND_CIRCLE;case "quad":return f.memoryEstimators.PATH_ROUND_QUAD;
default:r.neverReached(b.profile);return}case "miter":case "bevel":switch(b.profile){case "circle":return f.memoryEstimators.PATH_MITER_CIRCLE;case "quad":return f.memoryEstimators.PATH_MITER_QUAD;default:r.neverReached(b.profile);return}default:r.neverReached(b.join);return}case "object":return a?f.memoryEstimators.OBJECT_POINT:f.memoryEstimators.OBJECT_POLYGON;case "icon":case "text":return a?f.memoryEstimators.ICON_POINT:f.memoryEstimators.ICON_POLYGON;default:r.neverReached(b)}}function q(a){var b=
v[a];if(b)return b;b=g.primitiveLodResources(a,null,null);b={primitivesPerFeature:l.geometriesFromLodLevelResources(b.levels[0]).reduce(function(a,b){return a+b.data.getIndices(k.VertexAttrConstants.POSITION).length/3},0),primitivesPerCoordinate:0,estimated:!1};return v[a]=b}Object.defineProperty(f,"__esModule",{value:!0});f.emptySymbolComplexity={primitivesPerFeature:0,primitivesPerCoordinate:0,estimated:!0,memory:{bytesPerFeature:0,bytesPerCoordinate:0,bytesPerFeatureLabel:0,draped:{bytesPerFeature:0,
bytesPerFeatureLabel:0,bytesPerCoordinate:0}}};f.defaultSymbolComplexity=function(b){if("web-style"===b.type)return f.emptySymbolComplexity;var d=b.symbolLayers.toArray().map(function(c){return a(b,c)});return c(d)};f.totalSymbolComplexities=c;var v={};f.defaultSymbolLayerComplexity=a;f.defaultSymbolLayerMemoryComplexity=b;f.memoryEstimators={ICON_POINT:{bytesPerFeature:7127.413186968842,bytesPerFeatureLabel:4826.302896296296,bytesPerCoordinate:0,draped:{bytesPerFeature:3929.4396628895197,bytesPerFeatureLabel:3550.1332222222227,
bytesPerCoordinate:0}},ICON_POLYGON:{bytesPerFeature:9329.452613976147,bytesPerFeatureLabel:3675.3372604938268,bytesPerCoordinate:60.177252982212096,draped:{bytesPerFeature:6190.247450139383,bytesPerFeatureLabel:3744.074358024691,bytesPerCoordinate:59.488211068026104}},OBJECT_POINT:{bytesPerFeature:2350.5884192634558,bytesPerFeatureLabel:4446.651003703703,bytesPerCoordinate:0,draped:{bytesPerFeature:2350.5884192634558,bytesPerFeatureLabel:4446.651003703703,bytesPerCoordinate:0}},OBJECT_POLYGON:{bytesPerFeature:4583.807620302299,
bytesPerFeatureLabel:3665.342685185186,bytesPerCoordinate:60.11621818101506,draped:{bytesPerFeature:4583.807620302299,bytesPerFeatureLabel:3665.342685185186,bytesPerCoordinate:60.11621818101506}},LINE_MITER:{bytesPerFeature:7321.028181375921,bytesPerFeatureLabel:4048.0226716049388,bytesPerCoordinate:186.55621386363578,draped:{bytesPerFeature:4246.856619435009,bytesPerFeatureLabel:3852.3737679012347,bytesPerCoordinate:163.47884002621583}},LINE_ROUND:{bytesPerFeature:7482.205842738954,bytesPerFeatureLabel:4045.886987654321,
bytesPerCoordinate:191.5452524171851,draped:{bytesPerFeature:4473.481387957992,bytesPerFeatureLabel:3842.1112395061728,bytesPerCoordinate:167.27703460226945}},PATH_MITER_CIRCLE:{bytesPerFeature:9010.489006415351,bytesPerFeatureLabel:4230.9109,bytesPerCoordinate:4618.2594178027275,draped:{bytesPerFeature:9010.489006415351,bytesPerFeatureLabel:4230.9109,bytesPerCoordinate:4618.2594178027275}},PATH_ROUND_CIRCLE:{bytesPerFeature:4104.727250200398,bytesPerFeatureLabel:4251.8525,bytesPerCoordinate:8019.043777064957,
draped:{bytesPerFeature:4104.727250200398,bytesPerFeatureLabel:4251.8525,bytesPerCoordinate:8019.043777064957}},PATH_MITER_QUAD:{bytesPerFeature:9416.372942261387,bytesPerFeatureLabel:4241.2757,bytesPerCoordinate:3176.7222742582203,draped:{bytesPerFeature:9416.372942261387,bytesPerFeatureLabel:4241.2757,bytesPerCoordinate:3176.7222742582203}},PATH_ROUND_QUAD:{bytesPerFeature:6614.431545308682,bytesPerFeatureLabel:4206.7461,bytesPerCoordinate:5141.817789093826,draped:{bytesPerFeature:6614.431545308682,
bytesPerFeatureLabel:4206.7461,bytesPerCoordinate:5141.817789093826}},FILL:{bytesPerFeature:9478.244183633637,bytesPerFeatureLabel:3713.816824691358,bytesPerCoordinate:95.9343604185578,draped:{bytesPerFeature:6287.911108168086,bytesPerFeatureLabel:3790.785032098766,bytesPerCoordinate:83.08783220478168}},FILL_OUTLINE:{bytesPerFeature:13085.871870349445,bytesPerFeatureLabel:3392.613241975309,bytesPerCoordinate:118.63968023169875,draped:{bytesPerFeature:8437.199992480122,bytesPerFeatureLabel:3973.5431172839503,
bytesPerCoordinate:106.33556817014312}},EXTRUDE:{bytesPerFeature:19459.53727140414,bytesPerFeatureLabel:3743.7045209876546,bytesPerCoordinate:372.6819978900477,draped:{bytesPerFeature:19459.53727140414,bytesPerFeatureLabel:3743.7045209876546,bytesPerCoordinate:372.6819978900477}},EXTRUDE_EDGES:{bytesPerFeature:22266.888534913724,bytesPerFeatureLabel:3064.3193358024696,bytesPerCoordinate:374.3725221561312,draped:{bytesPerFeature:22266.888534913724,bytesPerFeatureLabel:3064.3193358024696,bytesPerCoordinate:374.3725221561312}}}})},
"esri/views/3d/layers/graphics/primitiveObjectSymbolUtils":function(){define("require exports ../../../../core/compilerUtils ../../../../geometry/support/aaBoundingBox ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil".split(" "),function(u,f,e,r,m,d){Object.defineProperty(f,"__esModule",{value:!0});var g=r.fromValues(-.5,-.5,-.5,.5,.5,.5),k=r.fromValues(-.5,-.5,0,.5,.5,1),l=r.fromValues(-.5,-.5,0,.5,.5,.5);f.isValidPrimitive=function(a){switch(a){case "sphere":case "cube":case "diamond":case "cylinder":case "cone":case "inverted-cone":case "tetrahedron":return!0}return!1};
f.primitiveBoundingBox=function(a){switch(a){case "sphere":case "cube":case "diamond":return g;case "cylinder":case "cone":case "inverted-cone":return k;case "tetrahedron":return l;default:e.neverReached(a)}};f.primitiveGeometryData=function(a){switch(a){case "sphere":return d.createPolySphereGeometry(.5,2,!0);case "cube":return d.createBoxGeometry(1);case "cylinder":return d.createCylinderGeometry(1,.5,32,[0,0,1],[0,0,.5]);case "cone":return d.cgToGIS(d.createConeGeometry(1,.5,15,!1));case "inverted-cone":return d.cgToGIS(d.createConeGeometry(1,
.5,15,!0));case "tetrahedron":return d.cgToGIS(d.createTetrahedronGeometry(1));case "diamond":return d.cgToGIS(d.createDiamondGeometry(1));default:e.neverReached(a)}};f.primitiveLodResources=function(a,b,g){var k=function(a,c,e){void 0===e&&(e=!1);return{levels:a.map(function(a,k){var f=c(a.tesselation);e&&d.cgToGIS(f);return{components:[{geometry:new m(f,g+("_lod"+k)),material:b}],faceCount:f.indexCount/3,minScreenSpaceRadius:a.minScreenSpaceRadius}})}};switch(a){case "sphere":return k([{tesselation:0,
minScreenSpaceRadius:0},{tesselation:1,minScreenSpaceRadius:8},{tesselation:2,minScreenSpaceRadius:16},{tesselation:3,minScreenSpaceRadius:50},{tesselation:4,minScreenSpaceRadius:250}],function(a){return d.createPolySphereGeometry(.5,a,!0)});case "cube":return k([{tesselation:0,minScreenSpaceRadius:0}],function(){return d.createBoxGeometry(1)});case "cone":return k(c,function(a){return d.createConeGeometry(1,.5,a,!1)},!0);case "inverted-cone":return k(c,function(a){return d.createConeGeometry(1,.5,
a,!0)},!0);case "cylinder":return k(c,function(a){return d.createCylinderGeometry(1,.5,a,[0,0,1],[0,0,.5])});case "tetrahedron":return k([{tesselation:0,minScreenSpaceRadius:0}],function(){return d.createTetrahedronGeometry(1)},!0);case "diamond":return k([{tesselation:0,minScreenSpaceRadius:0}],function(){return d.createDiamondGeometry(1)},!0);default:e.neverReached(a)}};var c=[{tesselation:6,minScreenSpaceRadius:0},{tesselation:18,minScreenSpaceRadius:7},{tesselation:64,minScreenSpaceRadius:65}]})},
"esri/views/3d/webgl-engine/lib/Geometry":function(){define("require exports ./BoundingInfo ./geometryDataUtils ./IdGen ./Util ./Util".split(" "),function(u,f,e,r,m,d,g){return function(){function k(d,c,a){this._boundingInfo=null;this._id=k.__idGen.gen(c);this._data=d;this._boundingInfo=a}Object.defineProperty(k.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0});
k.prototype.getIndices=function(d){return this.data.getIndices(d)};Object.defineProperty(k.prototype,"indexCount",{get:function(){return this.data.indexCount},enumerable:!0,configurable:!0});k.prototype.getAttribute=function(d){return this.data.getAttribute(d)};Object.defineProperty(k.prototype,"vertexCount",{get:function(){return this.data.indexCount},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"faceCount",{get:function(){return this.data.indexCount/3},enumerable:!0,configurable:!0});
Object.defineProperty(k.prototype,"boundingInfo",{get:function(){null==this._boundingInfo&&(this._boundingInfo=this._calculateBoundingInfo());return this._boundingInfo},enumerable:!0,configurable:!0});k.prototype.computeAttachmentOrigin=function(d){return"triangle"===this.data.primitiveType?this.computeAttachmentOriginTriangles(d):this.computeAttachmentOriginPoints(d)};k.prototype.computeAttachmentOriginTriangles=function(d){var c=this.getIndices(g.VertexAttrConstants.POSITION),a=this.getAttribute(g.VertexAttrConstants.POSITION);
return r.computeAttachmentOriginTriangles(a,c,d)};k.prototype.computeAttachmentOriginPoints=function(d){var c=this.getIndices(g.VertexAttrConstants.POSITION),a=this.getAttribute(g.VertexAttrConstants.POSITION);return r.computeAttachmentOriginPoints(a,c,d)};k.prototype.invalidateBoundingInfo=function(){this._boundingInfo=null};k.prototype._calculateBoundingInfo=function(){var k=this.data.getIndices(g.VertexAttrConstants.POSITION),c=this.data.getAttribute(g.VertexAttrConstants.POSITION),a="triangle"===
this.data.primitiveType?3:1;if(0===k.length)for(var k=new Uint32Array(a),b=0;b<a;++b)k[b]=b;b=k.length;d.assert(0===b%a,"Indexing error: "+b.toFixed(0)+" not divisible by "+a.toFixed(0));b=r.generateDefaultIndexArray(b/a);return new e(b,a,k,c)};k.__idGen=new m.IdGen;return k}()})},"esri/views/3d/webgl-engine/lib/BoundingInfo":function(){define("require exports ../../../../core/PooledArray ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ./Util".split(" "),function(u,
f,e,r,m,d){u=function(){function g(e,f,c,a){this.primitiveIndices=e;this._numIndexPerPrimitive=f;this.indices=c;this._position=a;this.center=m.vec3f64.create();d.assert(1<=e.length);d.assert(0===c.length%this._numIndexPerPrimitive);d.assert(c.length>=e.length*this._numIndexPerPrimitive);d.assert(3===this._position.size||4===this._position.size);a=this._position;f=a.data;var b=a.offsetIdx,k=a.strideIdx;a=0;var l=e.length,t=b+k*c[this._numIndexPerPrimitive*e[a]];g.tmpIndices.clear();g.tmpIndices.push(t);
this.bbMin=m.vec3f64.fromValues(f[t],f[t+1],f[t+2]);for(this.bbMax=m.vec3f64.clone(this.bbMin);a<l;++a)for(var x=this._numIndexPerPrimitive*e[a],z=0;z<this._numIndexPerPrimitive;++z){t=b+k*c[x+z];g.tmpIndices.push(t);var A=f[t];this.bbMin[0]=Math.min(A,this.bbMin[0]);this.bbMax[0]=Math.max(A,this.bbMax[0]);A=f[t+1];this.bbMin[1]=Math.min(A,this.bbMin[1]);this.bbMax[1]=Math.max(A,this.bbMax[1]);A=f[t+2];this.bbMin[2]=Math.min(A,this.bbMin[2]);this.bbMax[2]=Math.max(A,this.bbMax[2])}r.vec3.lerp(this.center,
this.bbMin,this.bbMax,.5);this.bsRadius=.5*Math.max(Math.max(this.bbMax[0]-this.bbMin[0],this.bbMax[1]-this.bbMin[1]),this.bbMax[2]-this.bbMin[2]);e=this.bsRadius*this.bsRadius;for(a=0;a<g.tmpIndices.length;++a)t=g.tmpIndices.data[a],c=f[t]-this.center[0],b=f[t+1]-this.center[1],t=f[t+2]-this.center[2],k=c*c+b*b+t*t,k<=e||(k=Math.sqrt(k),l=.5*(k-this.bsRadius),this.bsRadius+=l,e=this.bsRadius*this.bsRadius,k=l/k,this.center[0]+=c*k,this.center[1]+=b*k,this.center[2]+=t*k);g.tmpIndices.clear()}g.prototype.getCenter=
function(){return this.center};g.prototype.getBSRadius=function(){return this.bsRadius};g.prototype.getBBMin=function(){return this.bbMin};g.prototype.getBBMax=function(){return this.bbMax};g.prototype.getPrimitiveIndices=function(){return this.primitiveIndices};g.prototype.getIndices=function(){return this.indices};g.prototype.getPosition=function(){return this._position};g.prototype.getChildren=function(){if(this._children)return this._children;if(1<r.vec3.squaredDistance(this.bbMin,this.bbMax)){for(var d=
r.vec3.lerp(m.vec3f64.create(),this.bbMin,this.bbMax,.5),e=this.primitiveIndices.length,c=new Uint8Array(e),a=Array(8),b=0;8>b;++b)a[b]=0;for(var b=this._position,f=b.data,v=b.offsetIdx,t=b.strideIdx,b=0;b<e;++b){for(var x=0,z=this._numIndexPerPrimitive*this.primitiveIndices[b],A=v+t*this.indices[z],E=f[A],H=f[A+1],J=f[A+2],B=1;B<this._numIndexPerPrimitive;++B){var A=v+t*this.indices[z+B],G=f[A],F=f[A+1],A=f[A+2];G<E&&(E=G);F<H&&(H=F);A<J&&(J=A)}E<d[0]&&(x|=1);H<d[1]&&(x|=2);J<d[2]&&(x|=4);c[b]=x;
++a[x]}for(b=d=0;8>b;++b)0<a[b]&&++d;if(2>d)return;d=Array(8);for(b=0;8>b;++b)d[b]=0<a[b]?new Uint32Array(a[b]):void 0;for(b=0;8>b;++b)a[b]=0;for(b=0;b<e;++b)x=c[b],d[x][a[x]++]=this.primitiveIndices[b];this._children=Array(8);for(b=0;8>b;++b)void 0!==d[b]&&(this._children[b]=new g(d[b],this._numIndexPerPrimitive,this.indices,this._position))}return this._children};return g}();(u||(u={})).tmpIndices=new e({deallocator:null});return u})},"esri/views/3d/webgl-engine/lib/geometryDataUtils":function(){define(["require",
"exports","../../../../core/libs/gl-matrix-2/vec3","../../../../core/libs/gl-matrix-2/vec3f64","../../support/geometryUtils/triangle"],function(u,f,e,r,m){Object.defineProperty(f,"__esModule",{value:!0});var d=1,g=null,k=new Uint32Array([0]);f.generateDefaultIndexArray=function(a){if(1===a)return k;if(a>d||null==g){for(;a>d;)d*=2;g=new Uint32Array(d);for(var b=0;b<d;b++)g[b]=b}return new Uint32Array(g.buffer,0,a)};f.computeAttachmentOriginTriangles=function(d,g,k){if(!d)return!1;var f=d.strideIdx,
l=d.offsetIdx;d=d.data;e.vec3.set(k,0,0,0);e.vec3.set(q,0,0,0);for(var t=0,v=0,r=0;r<g.length-2;r+=3){var x=g[r+0]*f+l,G=g[r+1]*f+l,F=g[r+2]*f+l;e.vec3.set(c,d[x+0],d[x+1],d[x+2]);e.vec3.set(a,d[G+0],d[G+1],d[G+2]);e.vec3.set(b,d[F+0],d[F+1],d[F+2]);(x=m.areaPoints3d(c,a,b))?(e.vec3.add(c,c,a),e.vec3.add(c,c,b),e.vec3.scale(c,c,1/3*x),e.vec3.add(k,k,c),t+=x):(e.vec3.add(q,q,c),e.vec3.add(q,q,a),e.vec3.add(q,q,b),v+=3)}return 0===v&&0===t?!1:0!==t?(e.vec3.scale(k,k,1/t),!0):0!==v?(e.vec3.scale(k,q,
1/v),!0):!1};f.computeAttachmentOriginPoints=function(a,b,c){if(!a||!b)return!1;var d=a.strideIdx,g=a.offsetIdx;a=a.data;e.vec3.set(c,0,0,0);for(var k=-1,f=0,l=0;l<b.length;l++){var q=b[l]*d+g;k!==q&&(c[0]+=a[q+0],c[1]+=a[q+1],c[2]+=a[q+2],f++);k=q}1<f&&e.vec3.scale(c,c,1/f);return 0<f};f.computeAttachmentOriginLines=function(b,d,g,k){if(!b)return!1;var f=b.strideIdx,l=b.offsetIdx;b=b.data;e.vec3.set(k,0,0,0);e.vec3.set(q,0,0,0);var t=0,m=0,v=d?d.length-1:b.length/f-1;g=v+(g?2:0);for(var r=0;r<g;r+=
2){var x=r<v?r:v,z=r<v?r+1:0,x=(d?d[x]:x)*f+l,z=(d?d[z]:z)*f+l;c[0]=b[x+0];c[1]=b[x+1];c[2]=b[x+2];a[0]=b[z+0];a[1]=b[z+1];a[2]=b[z+2];e.vec3.scale(c,e.vec3.add(c,c,a),.5);z=e.vec3.dist(c,a);0<z?(e.vec3.add(k,k,e.vec3.scale(c,c,z)),t+=z):(e.vec3.add(q,q,c),m++)}return 0!==t?(e.vec3.scale(k,k,1/t),!0):0!==m?(e.vec3.scale(k,q,1/m),!0):!1};var l=0;f.getNewId=function(){return l++};var c=r.vec3f64.create(),a=r.vec3f64.create(),b=r.vec3f64.create(),q=r.vec3f64.create()})},"esri/views/3d/support/geometryUtils/triangle":function(){define("require exports ../../../../core/ObjectStack ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../stack ./lineSegment".split(" "),
function(u,f,e,r,m,d,g,k){function l(a){return a?{p0:d.vec3f64.clone(a.p0),p1:d.vec3f64.clone(a.p1),p2:d.vec3f64.clone(a.p2)}:{p0:d.vec3f64.create(),p1:d.vec3f64.create(),p2:d.vec3f64.create()}}function c(a,b,c,d){void 0===d&&(d=l());m.vec3.copy(d.p0,a);m.vec3.copy(d.p1,b);m.vec3.copy(d.p2,c);return d}function a(a,b,c){var d=r.vec2.distance(a,b);b=r.vec2.distance(b,c);a=r.vec2.distance(c,a);c=(d+b+a)/2;d=c*(c-d)*(c-b)*(c-a);return 0>=d?0:Math.sqrt(d)}Object.defineProperty(f,"__esModule",{value:!0});
f.create=l;f.wrap=function(a,b,c){var d=q.get();d.p0=a;d.p1=b;d.p2=c;return d};f.copy=function(a,b){void 0===b&&(b=l());return c(a.p0,a.p1,a.p2,b)};f.fromValues=c;f.distance2=function(a,c){var d=a.p0,e=a.p1;a=a.p2;var f=m.vec3.subtract(g.sv3d.get(),e,d),l=m.vec3.subtract(g.sv3d.get(),a,e),q=m.vec3.subtract(g.sv3d.get(),d,a),t=m.vec3.subtract(g.sv3d.get(),c,d),v=m.vec3.subtract(g.sv3d.get(),c,e),r=m.vec3.subtract(g.sv3d.get(),c,a),x=m.vec3.cross(f,f,q),z=m.vec3.dot(m.vec3.cross(g.sv3d.get(),f,x),t),
v=m.vec3.dot(m.vec3.cross(g.sv3d.get(),l,x),v),r=m.vec3.dot(m.vec3.cross(g.sv3d.get(),q,x),r);if(0<z&&0<v&&0<r)return c=m.vec3.dot(x,t),c*c/m.vec3.dot(x,x);d=k.distance2(k.fromValues(d,f,b.get()),c);e=k.distance2(k.fromValues(e,l,b.get()),c);c=k.distance2(k.fromValues(a,q,b.get()),c);return Math.min(d,e,c)};f.intersectRay=function(a,b,c){var d=b.direction;b=b.origin;var g=a.p0,e=a.p1,k=a.p2,f=e[0]-g[0],l=e[1]-g[1],q=e[2]-g[2],e=k[0]-g[0];a=k[1]-g[1];var k=k[2]-g[2],t=d[1]*k-a*d[2],v=d[2]*e-k*d[0],
r=d[0]*a-e*d[1],x=f*t+l*v+q*r;if(-1E-5<x&&1E-5>x)return!1;var x=1/x,z=b[0]-g[0],A=b[1]-g[1],g=b[2]-g[2],t=x*(z*t+A*v+g*r);if(0>t||1<t)return!1;v=A*q-l*g;q=g*f-q*z;f=z*l-f*A;l=x*(d[0]*v+d[1]*q+d[2]*f);if(0>l||1<t+l)return!1;c&&(m.vec3.scale(c,d,x*(e*v+a*q+k*f)),m.vec3.add(c,b,c));return!0};f.areaPoints2d=a;f.area2d=function(b){return a(b.p0,b.p1,b.p2)};f.areaPoints3d=function(a,b,c){m.vec3.subtract(v,b,a);m.vec3.subtract(t,c,a);return m.vec3.length(m.vec3.cross(v,v,t))/2};var b=new e.ObjectStack(k.create),
q=new e.ObjectStack(function(){return{p0:null,p1:null,p2:null}}),v=d.vec3f64.create(),t=d.vec3f64.create()})},"esri/core/ObjectStack":function(){define(["require","exports","./nextTick"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function f(d){var g=this;this.allocator=d;this.items=[];this.itemsPtr=0;this.tickHandle=e.before(function(){return g.reset()});this.grow()}f.prototype.destroy=function(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=null);this.items=
null};f.prototype.get=function(){0===this.itemsPtr&&e(function(){});this.itemsPtr===this.items.length&&this.grow();return this.items[this.itemsPtr++]};f.prototype.reset=function(){this.items.length=Math.min(Math.min(3*Math.max(8,this.itemsPtr),this.itemsPtr+3*r),this.items.length);this.itemsPtr=0};f.prototype.grow=function(){for(var d=0;d<Math.max(8,Math.min(this.items.length,r));d++)this.items.push(this.allocator())};return f}();f.ObjectStack=u;var r=1024;f.default=u})},"esri/views/3d/support/stack":function(){define(["require",
"exports","../../../core/VectorStack"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.sv2d=e.VectorStack.createVec2f64();f.sv3d=e.VectorStack.createVec3f64();f.sv4d=e.VectorStack.createVec4f64();f.sm3d=e.VectorStack.createMat3f64();f.sm4d=e.VectorStack.createMat4f64();f.sq4d=e.VectorStack.createQuatf64()})},"esri/core/VectorStack":function(){define("require exports ./nextTick ./libs/gl-matrix-2/mat3f64 ./libs/gl-matrix-2/mat4f64 ./libs/gl-matrix-2/quatf64 ./libs/gl-matrix-2/vec2f64 ./libs/gl-matrix-2/vec3f64 ./libs/gl-matrix-2/vec4f64".split(" "),
function(u,f,e,r,m,d,g,k,l){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function a(a,c,d){var b=this;this.itemByteSize=a;this.itemCreate=c;this.buffers=[];this.items=[];this.itemsPtr=this.itemsPerBuffer=0;this.itemsPerBuffer=Math.ceil(d/this.itemByteSize);this.tickHandle=e.before(function(){return b.reset()})}a.prototype.destroy=function(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=null);this.itemsPtr=0;this.buffers=this.items=null};a.prototype.get=function(){0===
this.itemsPtr&&e(function(){});for(var a=Math.floor(this.itemsPtr/this.itemsPerBuffer);this.buffers.length<=a;){for(var c=new ArrayBuffer(this.itemsPerBuffer*this.itemByteSize),d=0;d<this.itemsPerBuffer;++d)this.items.push(this.itemCreate(c,d*this.itemByteSize));this.buffers.push(c)}return this.items[this.itemsPtr++]};a.prototype.reset=function(){for(var a=2*(Math.floor(this.itemsPtr/this.itemsPerBuffer)+1);this.buffers.length>a;)this.buffers.pop(),this.items.length=this.buffers.length*this.itemsPerBuffer;
this.itemsPtr=0};a.createVec2f64=function(b){void 0===b&&(b=c);return new a(16,g.vec2f64.createView,b)};a.createVec3f64=function(b){void 0===b&&(b=c);return new a(24,k.vec3f64.createView,b)};a.createVec4f64=function(b){void 0===b&&(b=c);return new a(32,l.vec4f64.createView,b)};a.createMat3f64=function(b){void 0===b&&(b=c);return new a(72,r.mat3f64.createView,b)};a.createMat4f64=function(b){void 0===b&&(b=c);return new a(128,m.mat4f64.createView,b)};a.createQuatf64=function(b){void 0===b&&(b=c);return new a(32,
d.quatf64.createView,b)};Object.defineProperty(a.prototype,"test",{get:function(){return{size:this.buffers.length*this.itemsPerBuffer*this.itemByteSize}},enumerable:!0,configurable:!0});return a}();f.VectorStack=u;var c=4096})},"esri/core/libs/gl-matrix-2/mat3f64":function(){define(["require","exports","./factories/mat3f64"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.mat3f64=e})},"esri/core/libs/gl-matrix-2/factories/mat3f64":function(){define(["require","exports"],function(u,
f){Object.defineProperty(f,"__esModule",{value:!0});f.create=function(){return[1,0,0,0,1,0,0,0,1]};f.clone=function(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]};f.fromValues=function(e,f,m,d,g,k,l,c,a){return[e,f,m,d,g,k,l,c,a]};f.createView=function(e,f){return new Float64Array(e,f,9)}})},"esri/core/libs/gl-matrix-2/quatf64":function(){define(["require","exports","./factories/quatf64"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.quatf64=e})},"esri/core/libs/gl-matrix-2/factories/quatf64":function(){define(["require",
"exports"],function(u,f){function e(){return[0,0,0,1]}Object.defineProperty(f,"__esModule",{value:!0});f.create=e;f.clone=function(e){return[e[0],e[1],e[2],e[3]]};f.fromValues=function(e,f,d,g){return[e,f,d,g]};f.createView=function(e,f){return new Float64Array(e,f,4)};f.IDENTITY=e()})},"esri/views/3d/support/geometryUtils/lineSegment":function(){define("require exports ../../../../core/mathUtils ../../../../core/ObjectStack ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../stack".split(" "),
function(u,f,e,r,m,d,g){function k(a){return a?{origin:d.vec3f64.clone(a.origin),vector:d.vec3f64.clone(a.vector)}:{origin:d.vec3f64.create(),vector:d.vec3f64.create()}}function l(a,b){var c=t.get();c.origin=a;c.vector=b;return c}function c(a,b,c){void 0===c&&(c=k());m.vec3.copy(c.origin,a);m.vec3.copy(c.vector,b);return c}function a(a,b){b=m.vec3.subtract(g.sv3d.get(),b,a.origin);var c=m.vec3.dot(a.vector,b),d=m.vec3.dot(a.vector,a.vector),c=e.clamp(c/d,0,1);a=m.vec3.subtract(g.sv3d.get(),m.vec3.scale(g.sv3d.get(),
a.vector,c),b);return m.vec3.dot(a,a)}function b(a,b,c,d,k){var f=a.vector,l=a.origin;b=m.vec3.subtract(g.sv3d.get(),b,l);l=m.vec3.length(f);b=m.vec3.dot(f,b)/l;m.vec3.scale(k,f,e.clamp(b,c,d));return m.vec3.add(k,k,a.origin)}function q(a,b,c,d){var k=a.origin,f=m.vec3.add(g.sv3d.get(),k,a.vector);a=b.origin;var l=m.vec3.add(g.sv3d.get(),a,b.vector),q=g.sv3d.get();b=g.sv3d.get();q[0]=k[0]-a[0];q[1]=k[1]-a[1];q[2]=k[2]-a[2];b[0]=l[0]-a[0];b[1]=l[1]-a[1];b[2]=l[2]-a[2];if(1E-6>Math.abs(b[0])&&1E-6>
Math.abs(b[1])&&1E-6>Math.abs(b[2]))return!1;l=g.sv3d.get();l[0]=f[0]-k[0];l[1]=f[1]-k[1];l[2]=f[2]-k[2];if(1E-6>Math.abs(l[0])&&1E-6>Math.abs(l[1])&&1E-6>Math.abs(l[2]))return!1;var f=q[0]*b[0]+q[1]*b[1]+q[2]*b[2],t=b[0]*l[0]+b[1]*l[1]+b[2]*l[2],v=b[0]*b[0]+b[1]*b[1]+b[2]*b[2],r=(l[0]*l[0]+l[1]*l[1]+l[2]*l[2])*v-t*t;if(1E-6>Math.abs(r))return!1;q=(f*t-(q[0]*l[0]+q[1]*l[1]+q[2]*l[2])*v)/r;f=(f+t*q)/v;c&&(q=e.clamp(q,0,1),f=e.clamp(f,0,1));c=g.sv3d.get();t=g.sv3d.get();c[0]=k[0]+q*l[0];c[1]=k[1]+q*
l[1];c[2]=k[2]+q*l[2];t[0]=a[0]+f*b[0];t[1]=a[1]+f*b[1];t[2]=a[2]+f*b[2];d.tA=q;d.tB=f;d.pA=c;d.pB=t;d.distance2=m.vec3.squaredDistance(c,t);return!0}Object.defineProperty(f,"__esModule",{value:!0});f.create=k;f.wrap=l;f.copy=function(a,b){void 0===b&&(b=k());return c(a.origin,a.vector,b)};f.fromValues=c;f.fromPoints=function(a,b,c){void 0===c&&(c=k());m.vec3.copy(c.origin,a);m.vec3.subtract(c.vector,b,a);return c};f.distance2=a;f.distance=function(b,c){return Math.sqrt(a(b,c))};f.projectPoint=function(a,
c,d){return b(a,c,0,1,d)};f.pointAt=function(a,b,c){return m.vec3.add(c,a.origin,m.vec3.scale(c,a.vector,b))};f.projectPointClamp=b;f.closestRayDistance2=function(a,b){if(q(a,l(b.origin,b.direction),!1,v)){b=v.tA;var c=v.pB,d=v.distance2;if(0<=b&&1>=b)return d;if(0>b)return m.vec3.squaredDistance(a.origin,c);if(1<b)return m.vec3.squaredDistance(m.vec3.add(g.sv3d.get(),a.origin,a.vector),c)}return null};f.closestLineSegmentPoint=function(a,b,c){return q(a,b,!0,v)?(m.vec3.copy(c,v.pA),!0):!1};f.closestLineSegmentDistance2=
function(a,b){return q(a,b,!0,v)?v.distance2:null};var v={tA:0,tB:0,pA:d.vec3f64.create(),pB:d.vec3f64.create(),distance2:0},t=new r.ObjectStack(function(){return{origin:null,vector:null}})})},"esri/views/3d/webgl-engine/lib/IdGen":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function e(){this._count=0}e.prototype.gen=function(e){null==e&&(e="a");return e+"_"+this._count++};return e}();f.IdGen=u})},"esri/views/3d/webgl-engine/lib/GeometryUtil":function(){define("require exports ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f32 ../../../../core/libs/gl-matrix-2/vec3f64 ../../support/geometryUtils ./BufferVectorMath ./GeometryData ./Util".split(" "),
function(u,f,e,r,m,d,g,k,l){var c=g.Vec3Compact,a;(function(a){for(var b=[[-.5,-.5,.5],[.5,-.5,.5],[.5,.5,.5],[-.5,.5,.5],[-.5,-.5,-.5],[.5,-.5,-.5],[.5,.5,-.5],[-.5,.5,-.5]],c=[0,0,1,-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1],d=[0,0,1,0,1,1,0,1],g=[0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5],e=Array(36),f=0;6>f;f++)for(var q=0;6>q;q++)e[6*f+q]=f;for(var t=Array(36),f=0;6>f;f++)t[6*f+0]=0,t[6*f+1]=1,t[6*f+2]=2,t[6*f+3]=2,t[6*f+4]=3,t[6*f+5]=0;a.createGeometry=function(a){Array.isArray(a)||
(a=[a,a,a]);for(var f=new Float32Array(24),q=0;8>q;q++)f[3*q]=b[q][0]*a[0],f[3*q+1]=b[q][1]*a[1],f[3*q+2]=b[q][2]*a[2];a={};a[l.VertexAttrConstants.POSITION]=new Uint32Array(g);a[l.VertexAttrConstants.NORMAL]=new Uint32Array(e);a[l.VertexAttrConstants.UV0]=new Uint32Array(t);q={};q[l.VertexAttrConstants.POSITION]={size:3,data:f};q[l.VertexAttrConstants.NORMAL]={size:3,data:new Float32Array(c)};q[l.VertexAttrConstants.UV0]={size:2,data:new Float32Array(d)};return new k.GeometryData(q,a)}})(a||(a={}));
var b;(function(a){var b=[[-.5,0,-.5],[.5,0,-.5],[.5,0,.5],[-.5,0,.5],[0,-.5,0],[0,.5,0]],c=[0,1,-1,1,1,0,0,1,1,-1,1,0,0,-1,-1,1,-1,0,0,-1,1,-1,-1,0],d=[5,1,0,5,2,1,5,3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0],g=[0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7];a.createGeometry=function(a){Array.isArray(a)||(a=[a,a,a]);for(var e=new Float32Array(18),f=0;6>f;f++)e[3*f]=b[f][0]*a[0],e[3*f+1]=b[f][1]*a[1],e[3*f+2]=b[f][2]*a[2];a={};a[l.VertexAttrConstants.POSITION]=new Uint32Array(d);a[l.VertexAttrConstants.NORMAL]=
new Uint32Array(g);f={};f[l.VertexAttrConstants.POSITION]={size:3,data:e};f[l.VertexAttrConstants.NORMAL]={size:3,data:new Float32Array(c)};return new k.GeometryData(f,a)}})(b||(b={}));var q;(function(a){var b=r.vec3f32.fromValues(-.5,0,-.5),c=r.vec3f32.fromValues(.5,0,-.5),d=r.vec3f32.fromValues(0,0,.5),g=r.vec3f32.fromValues(0,.5,0),f=r.vec3f32.create(),q=r.vec3f32.create(),t=r.vec3f32.create(),m=r.vec3f32.create(),v=r.vec3f32.create();e.vec3.subtract(f,b,g);e.vec3.subtract(q,b,c);e.vec3.cross(t,
f,q);e.vec3.normalize(t,t);e.vec3.subtract(f,c,g);e.vec3.subtract(q,c,d);e.vec3.cross(m,f,q);e.vec3.normalize(m,m);e.vec3.subtract(f,d,g);e.vec3.subtract(q,d,b);e.vec3.cross(v,f,q);e.vec3.normalize(v,v);var x=[b,c,d,g],z=[0,-1,0,t[0],t[1],t[2],m[0],m[1],m[2],v[0],v[1],v[2]],A=[0,1,2,3,1,0,3,2,1,3,0,2],u=[0,0,0,1,1,1,2,2,2,3,3,3];a.createGeometry=function(a){Array.isArray(a)||(a=[a,a,a]);for(var b=new Float32Array(12),c=0;4>c;c++)b[3*c]=x[c][0]*a[0],b[3*c+1]=x[c][1]*a[1],b[3*c+2]=x[c][2]*a[2];a={};
a[l.VertexAttrConstants.POSITION]=new Uint32Array(A);a[l.VertexAttrConstants.NORMAL]=new Uint32Array(u);c={};c[l.VertexAttrConstants.POSITION]={size:3,data:b};c[l.VertexAttrConstants.NORMAL]={size:3,data:new Float32Array(z)};return new k.GeometryData(c,a)}})(q||(q={}));var v;(function(f){function v(a,b,c,d,g){if(Math.abs(e.vec3.dot(b,a))>g)return!1;e.vec3.cross(c,a,b);e.vec3.normalize(c,c);e.vec3.cross(d,c,a);e.vec3.normalize(d,d);return!0}function A(a,b,c,d,g,e,k){return v(a,b,g,e,k)||v(a,c,g,e,
k)||v(a,d,g,e,k)}f.createBoxGeometry=a.createGeometry;f.createDiamondGeometry=b.createGeometry;f.createTetrahedronGeometry=q.createGeometry;f.createSphereGeometry=function(a,b,c,d,g,e,f){a=a||50;d=void 0!==d?d:-Math.PI;g=void 0!==g?g:2*Math.PI;e=void 0!==e?e:.5*-Math.PI;f=void 0!==f?f:Math.PI;var q=Math.max(3,Math.floor(b)||8),t=Math.max(2,Math.floor(c)||6),m=(q+1)*(t+1);c=new Float32Array(3*m);b=new Float32Array(3*m);for(var m=new Float32Array(2*m),v=[],r=0,x=0;x<=t;x++){for(var z=[],A=x/t,E=e+A*
f,H=Math.cos(E),B=0;B<=q;B++){var F=B/q,G=d+F*g,J=Math.cos(G)*H,u=Math.sin(E),G=-Math.sin(G)*H;c[3*r]=J*a;c[3*r+1]=u*a;c[3*r+2]=G*a;b[3*r]=J;b[3*r+1]=u;b[3*r+2]=G;m[2*r]=F;m[2*r+1]=A;z.push(r);++r}v.push(z)}a=new Uint32Array(2*q*(t-1)*3);for(x=r=0;x<t;x++)for(B=0;B<q;B++)d=v[x][B],g=v[x][B+1],e=v[x+1][B+1],f=v[x+1][B],0===x?(a[r++]=d,a[r++]=e,a[r++]=f):x===t-1?(a[r++]=d,a[r++]=g,a[r++]=e):(a[r++]=d,a[r++]=g,a[r++]=e,a[r++]=e,a[r++]=f,a[r++]=d);l.assert(r===a.length);q={};q[l.VertexAttrConstants.POSITION]=
a;q[l.VertexAttrConstants.NORMAL]=a;q[l.VertexAttrConstants.UV0]=a;t={};t[l.VertexAttrConstants.POSITION]={size:3,data:c};t[l.VertexAttrConstants.NORMAL]={size:3,data:b};t[l.VertexAttrConstants.UV0]={size:2,data:m};return new k.GeometryData(t,q)};f.createPolySphereGeometry=function(a,b,d){function g(b,d){b>d&&(d=[d,b],b=d[0],d=d[1]);var g=b.toString()+"."+d.toString();if(q[g])return q[g];var k=e.length;e.length+=3;c.add(e,3*b,e,3*d,e,k);c.scale(e,k,a/c.length(e,k));k/=3;return q[g]=k}var e;d?(e=[0,
-1,0,1,0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],d=new Uint32Array([0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1])):(d=a*(1+Math.sqrt(5))/2,e=[-a,d,0,a,d,0,-a,-d,0,a,-d,0,0,-a,d,0,a,d,0,-a,-d,0,a,-d,d,0,-a,d,0,a,-d,0,-a,-d,0,a],d=new Uint32Array([0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1]));for(var f=0;f<e.length;f+=3)c.scale(e,f,a/c.length(e,f));for(var q={},f=0;f<b;f++){for(var t=d.length,m=new Uint32Array(4*t),v=0;v<
t;v+=3){var r=d[v],x=d[v+1],z=d[v+2],A=g(r,x),E=g(x,z),H=g(z,r),B=4*v;m[B]=r;m[B+1]=A;m[B+2]=H;m[B+3]=x;m[B+4]=E;m[B+5]=A;m[B+6]=z;m[B+7]=H;m[B+8]=E;m[B+9]=A;m[B+10]=E;m[B+11]=H}d=m;q={}}b=new Float32Array(e);for(f=0;f<b.length;f+=3)c.normalize(b,f);f={};f[l.VertexAttrConstants.POSITION]=d;f[l.VertexAttrConstants.NORMAL]=d;d={};d[l.VertexAttrConstants.POSITION]={size:3,data:new Float32Array(e)};d[l.VertexAttrConstants.NORMAL]={size:3,data:b};return new k.GeometryData(d,f)};f.createPointGeometry=function(a,
b,c,d,g,e,f,q){b=b?new Float64Array([b[0],b[1],b[2]]):new Float32Array([0,0,0]);a=a?new Float32Array([a[0],a[1],a[2]]):new Float32Array([0,0,1]);e=e?new Float32Array(e):new Float32Array([0,0]);c=c?new Uint8Array([255*c[0],255*c[1],255*c[2],3<c.length?255*c[3]:255]):new Uint8Array([255,255,255,255]);var t=null!=d&&2===d.length?new Float32Array(d):new Float32Array([1,1]);d={};d[l.VertexAttrConstants.POSITION]={size:3,data:b};d[l.VertexAttrConstants.NORMAL]={size:3,data:a};d[l.VertexAttrConstants.UV0]=
{size:e.length,data:e};d[l.VertexAttrConstants.COLOR]={size:4,data:c};d[l.VertexAttrConstants.SIZE]={size:2,data:t};null!=g&&(g=new Float32Array([g[0],g[1],g[2],g[3]]),d[l.VertexAttrConstants.AUXPOS1]={size:4,data:g});null!=f&&(f=new Float32Array([f[0],f[1],f[2],f[3]]),d[l.VertexAttrConstants.AUXPOS2]={size:4,data:f});return null!=q?(k.GeometryData.call(q,d,k.GeometryData.DefaultIndices,"point"),q):new k.GeometryData(d,k.GeometryData.DefaultIndices,"point")};f.updatePointGeometry=function(a,b,c,d,
g,e,k,f){var q=f.vertexAttributes;if(null!=a){var t=q[l.VertexAttrConstants.NORMAL].data;t[0]=a[0];t[1]=a[1];t[2]=a[2]}null!=b&&(t=q[l.VertexAttrConstants.POSITION].data,t[0]=b[0],t[1]=b[1],t[2]=b[2]);null!=c&&(t=q[l.VertexAttrConstants.COLOR].data,t[0]=c[0],t[1]=c[1],t[2]=c[2],t[3]=c[3]);null!=d&&(t=q[l.VertexAttrConstants.SIZE].data,t[0]=d[0],t[1]=d[1]);null!=g&&(t=q[l.VertexAttrConstants.AUXPOS1].data,t[0]=g[0],t[1]=g[1],t[2]=g[2],t[3]=g[3]);null!=e&&(t=q[l.VertexAttrConstants.UV0].data,t[0]=e[0],
t[1]=e[1]);null!=k&&(t=q[l.VertexAttrConstants.AUXPOS2].data,t[0]=k[0],t[1]=k[1],t[2]=k[2],t[3]=k[3]);return f};f.createPointArrayGeometry=function(a,b){for(var c=new Float32Array(3*a.length),d=new Float32Array(b?3*a.length:3),g=new Uint32Array(a.length),e=new Uint32Array(a.length),f=0;f<a.length;f++)c[3*f]=a[f][0],c[3*f+1]=a[f][1],c[3*f+2]=a[f][2],b&&(d[3*f]=b[f][0],d[3*f+1]=b[f][1],d[3*f+2]=b[f][2]),g[f]=f,e[f]=0;b||(d[0]=0,d[1]=1,d[2]=0);a=new Float32Array(2);a[0]=0;a[1]=0;f={};f[l.VertexAttrConstants.POSITION]=
g;f[l.VertexAttrConstants.NORMAL]=b?g:e;f[l.VertexAttrConstants.UV0]=e;b={};b[l.VertexAttrConstants.POSITION]={size:3,data:c};b[l.VertexAttrConstants.NORMAL]={size:3,data:d};b[l.VertexAttrConstants.UV0]={size:2,data:a};return new k.GeometryData(b,f,"point")};f.createTriangleGeometry=function(){var a=new Float32Array([0,0,0,0,0,100,100,0,0]),b=new Uint32Array([0,1,2]),c=new Float32Array([0,1,0]),d=new Uint32Array([0,0,0]),g=new Float32Array([0,0]),e=new Uint32Array([0,0,0]),f={};f[l.VertexAttrConstants.POSITION]=
b;f[l.VertexAttrConstants.NORMAL]=d;f[l.VertexAttrConstants.UV0]=e;b={};b[l.VertexAttrConstants.POSITION]={size:3,data:a};b[l.VertexAttrConstants.NORMAL]={size:3,data:c};b[l.VertexAttrConstants.UV0]={size:2,data:g};return new k.GeometryData(b,f)};var J=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0]];f.createSquareGeometry=function(a){var b,c;void 0===a&&(a=J);for(var d=new Float64Array(12),g=0;4>g;g++)for(var e=0;3>e;e++)d[3*g+e]=a[g][e];var f=new Uint32Array([0,1,2,2,3,0]);a=new Float32Array([0,0,1]);var q=
new Uint32Array([0,0,0,0,0,0]),g=new Float32Array([0,0,1,0,1,1,0,1]),e=new Uint8Array([255,255,255,255]),f=(b={},b[l.VertexAttrConstants.POSITION]=f,b[l.VertexAttrConstants.NORMAL]=q,b[l.VertexAttrConstants.UV0]=f,b[l.VertexAttrConstants.COLOR]=q,b);b=(c={},c[l.VertexAttrConstants.POSITION]={size:3,data:d},c[l.VertexAttrConstants.NORMAL]={size:3,data:a},c[l.VertexAttrConstants.UV0]={size:2,data:g},c[l.VertexAttrConstants.COLOR]={size:4,data:e},c);return new k.GeometryData(b,f)};f.createConeGeometry=
function(a,b,c,d,g,e){void 0===g&&(g=!0);void 0===e&&(e=!0);var f=0,q=r.vec3f32.fromValues(0,f,0),t=r.vec3f32.fromValues(0,f+a,0),m=r.vec3f32.fromValues(0,-1,0),v=r.vec3f32.fromValues(0,1,0);d&&(f=a,t=r.vec3f32.fromValues(0,0,0),q=r.vec3f32.fromValues(0,f,0),m=r.vec3f32.fromValues(0,1,0),v=r.vec3f32.fromValues(0,-1,0));q=[t,q];m=[m,v];v=c+2;t=Math.sqrt(a*a+b*b);if(d)for(d=c-1;0<=d;d--)x=2*Math.PI/c*d,z=r.vec3f32.fromValues(Math.cos(x)*b,f,Math.sin(x)*b),q.push(z),x=r.vec3f32.fromValues(a*Math.cos(x)/
t,-b/t,a*Math.sin(x)/t),m.push(x);else for(d=0;d<c;d++){var x=2*Math.PI/c*d,z=r.vec3f32.fromValues(Math.cos(x)*b,f,Math.sin(x)*b);q.push(z);x=r.vec3f32.fromValues(a*Math.cos(x)/t,b/t,a*Math.sin(x)/t);m.push(x)}a=new Uint32Array(6*(c+2));c=new Uint32Array(6*(c+2));f=b=0;if(g){for(d=3;d<q.length;d++)a[b++]=1,a[b++]=d-1,a[b++]=d,c[f++]=0,c[f++]=0,c[f++]=0;a[b++]=q.length-1;a[b++]=2;a[b++]=1;c[f++]=0;c[f++]=0;c[f++]=0}if(e){for(d=3;d<q.length;d++)a[b++]=d,a[b++]=d-1,a[b++]=0,c[f++]=d,c[f++]=d-1,c[f++]=
1;a[b++]=0;a[b++]=2;a[b++]=q.length-1;c[f++]=1;c[f++]=2;c[f++]=m.length-1}g=new Float32Array(3*v);for(d=0;d<v;d++)g[3*d]=q[d][0],g[3*d+1]=q[d][1],g[3*d+2]=q[d][2];e=new Float32Array(3*v);for(d=0;d<v;d++)e[3*d]=m[d][0],e[3*d+1]=m[d][1],e[3*d+2]=m[d][2];q={};q[l.VertexAttrConstants.POSITION]=a;q[l.VertexAttrConstants.NORMAL]=c;m={};m[l.VertexAttrConstants.POSITION]={size:3,data:g};m[l.VertexAttrConstants.NORMAL]={size:3,data:e};return new k.GeometryData(m,q)};f.createCylinderGeometry=function(a,b,c,
d,g,f){d=d?r.vec3f32.clone(d):r.vec3f32.fromValues(1,0,0);g=g?r.vec3f32.clone(g):r.vec3f32.fromValues(0,0,0);f=void 0===f?!0:f;var q=r.vec3f32.create();e.vec3.normalize(q,d);d=r.vec3f32.create();e.vec3.scale(d,q,Math.abs(a));var t=r.vec3f32.create();e.vec3.scale(t,d,-.5);e.vec3.add(t,t,g);var m=r.vec3f32.fromValues(0,1,0);.2>Math.abs(1-e.vec3.dot(q,m))&&e.vec3.set(m,0,0,1);var v=r.vec3f32.create();e.vec3.cross(v,q,m);e.vec3.normalize(v,v);e.vec3.cross(m,v,q);var x=2*c+(f?2:0),z=c+(f?2:0);a=new Float32Array(3*
x);g=new Float32Array(3*z);var A=new Float32Array(2*x),E=new Uint32Array(3*c*(f?4:2)),H=new Uint32Array(3*c*(f?4:2));f&&(a[3*(x-2)+0]=t[0],a[3*(x-2)+1]=t[1],a[3*(x-2)+2]=t[2],A[2*(x-2)]=0,A[2*(x-2)+1]=0,a[3*(x-1)+0]=a[3*(x-2)+0]+d[0],a[3*(x-1)+1]=a[3*(x-2)+1]+d[1],a[3*(x-1)+2]=a[3*(x-2)+2]+d[2],A[2*(x-1)]=1,A[2*(x-1)+1]=1,g[3*(z-2)+0]=-q[0],g[3*(z-2)+1]=-q[1],g[3*(z-2)+2]=-q[2],g[3*(z-1)+0]=q[0],g[3*(z-1)+1]=q[1],g[3*(z-1)+2]=q[2]);for(var q=function(a,b,c){E[a]=b;H[a]=c},B=0,J=r.vec3f32.create(),
u=r.vec3f32.create(),G=0;G<c;G++){var F=2*Math.PI/c*G;e.vec3.scale(J,m,Math.sin(F));e.vec3.scale(u,v,Math.cos(F));e.vec3.add(J,J,u);g[3*G+0]=J[0];g[3*G+1]=J[1];g[3*G+2]=J[2];e.vec3.scale(J,J,b);e.vec3.add(J,J,t);a[3*G+0]=J[0];a[3*G+1]=J[1];a[3*G+2]=J[2];A[2*G+0]=G/c;A[2*G+1]=0;a[3*(G+c)+0]=a[3*G+0]+d[0];a[3*(G+c)+1]=a[3*G+1]+d[1];a[3*(G+c)+2]=a[3*G+2]+d[2];A[2*(G+c)+0]=G/c;A[2*G+1]=1;F=(G+1)%c;q(B++,G,G);q(B++,G+c,G);q(B++,F,F);q(B++,F,F);q(B++,G+c,G);q(B++,F+c,F)}if(f){for(G=0;G<c;G++)F=(G+1)%c,
q(B++,x-2,z-2),q(B++,G,z-2),q(B++,F,z-2);for(G=0;G<c;G++)F=(G+1)%c,q(B++,G+c,z-1),q(B++,x-1,z-1),q(B++,F+c,z-1)}b={};b[l.VertexAttrConstants.POSITION]=E;b[l.VertexAttrConstants.NORMAL]=H;b[l.VertexAttrConstants.UV0]=E;c={};c[l.VertexAttrConstants.POSITION]={size:3,data:a};c[l.VertexAttrConstants.NORMAL]={size:3,data:g};c[l.VertexAttrConstants.UV0]={size:2,data:A};return new k.GeometryData(c,b)};f.createTubeGeometry=function(a,b,c,d,g){c=c||10;d=null!=d?d:!0;l.assert(1<a.length);for(var e=[],k=[],
q=0;q<c;q++){e.push([0,-q-1,-((q+1)%c)-1]);var t=q/c*2*Math.PI;k.push([Math.cos(t)*b,Math.sin(t)*b])}return f.createPathExtrusionGeometry(k,a,[[0,0,0]],e,d,g)};f.createPathExtrusionGeometry=function(a,b,c,g,f,q){void 0===q&&(q=r.vec3f32.fromValues(0,0,0));var v=a.length,x=new Float32Array(b.length*v*3+(6*c.length||0)),z=new Float32Array(b.length*v+(2*c.length||0)),E=new Float32Array(b.length*v*3+(c?6:0)),H=(b.length-1)*v*6+6*g.length,B=new Uint32Array(H),H=new Uint32Array(H),J=0,G=0,u=0,F=0,R=0,M=
r.vec3f32.create(),T=r.vec3f32.create(),ja=r.vec3f32.create(),da=r.vec3f32.create(),ma=r.vec3f32.create(),fa=r.vec3f32.create(),la=r.vec3f32.create(),ia=m.vec3f64.create(),ca=r.vec3f32.create(),C=r.vec3f32.create(),na=r.vec3f32.create(),pa=r.vec3f32.create(),sa=r.vec3f32.create(),ta=d.plane.create();e.vec3.set(ca,0,1,0);e.vec3.subtract(T,b[1],b[0]);e.vec3.normalize(T,T);f?(e.vec3.add(ia,b[0],q),e.vec3.normalize(ja,ia)):e.vec3.set(ja,0,0,1);A(T,ja,ca,ca,ma,ja,t);e.vec3.copy(da,ja);e.vec3.copy(pa,ma);
for(var W=0;W<c.length;W++)e.vec3.scale(fa,ma,c[W][0]),e.vec3.scale(ia,ja,c[W][2]),e.vec3.add(fa,fa,ia),e.vec3.add(fa,fa,b[0]),x[J++]=fa[0],x[J++]=fa[1],x[J++]=fa[2],z[u++]=0;E[G++]=-T[0];E[G++]=-T[1];E[G++]=-T[2];for(W=0;W<g.length;W++)B[F++]=0<g[W][0]?g[W][0]:-g[W][0]-1+c.length,B[F++]=0<g[W][1]?g[W][1]:-g[W][1]-1+c.length,B[F++]=0<g[W][2]?g[W][2]:-g[W][2]-1+c.length,H[R++]=0,H[R++]=0,H[R++]=0;for(var qa=c.length,W=c.length-1,ra=0;ra<b.length;ra++){var va=!1;0<ra&&(e.vec3.copy(M,T),ra<b.length-
1?(e.vec3.subtract(T,b[ra+1],b[ra]),e.vec3.normalize(T,T)):va=!0,e.vec3.add(C,M,T),e.vec3.normalize(C,C),e.vec3.add(na,b[ra-1],da),d.plane.fromPositionAndNormal(b[ra],C,ta),d.plane.intersectRay(ta,d.ray.wrap(na,M),ia)?(e.vec3.subtract(ia,ia,b[ra]),e.vec3.normalize(ja,ia),e.vec3.cross(ma,C,ja),e.vec3.normalize(ma,ma)):A(C,da,pa,ca,ma,ja,t),e.vec3.copy(da,ja),e.vec3.copy(pa,ma));f&&(e.vec3.add(ia,b[ra],q),e.vec3.normalize(sa,ia));for(var Y=0;Y<v;Y++)if(e.vec3.scale(fa,ma,a[Y][0]),e.vec3.scale(ia,ja,
a[Y][1]),e.vec3.add(fa,fa,ia),e.vec3.normalize(la,fa),E[G++]=la[0],E[G++]=la[1],E[G++]=la[2],f?z[u++]=e.vec3.dot(fa,sa):z[u++]=fa[2],e.vec3.add(fa,fa,b[ra]),x[J++]=fa[0],x[J++]=fa[1],x[J++]=fa[2],!va){var w=(Y+1)%v;B[F++]=qa+Y;B[F++]=qa+v+Y;B[F++]=qa+w;B[F++]=qa+w;B[F++]=qa+v+Y;B[F++]=qa+v+w;for(w=0;6>w;w++)H[R++]=B[F-6+w]-W}qa+=v}a=b[b.length-1];for(W=0;W<c.length;W++)e.vec3.scale(fa,ma,c[W][0]),e.vec3.scale(ia,ja,c[W][1]),e.vec3.add(fa,fa,ia),e.vec3.add(fa,fa,a),x[J++]=fa[0],x[J++]=fa[1],x[J++]=
fa[2],z[u++]=0;c=G/3;E[G++]=T[0];E[G++]=T[1];E[G++]=T[2];v=qa-v;for(W=0;W<g.length;W++)B[F++]=0<=g[W][0]?qa+g[W][0]:-g[W][0]-1+v,B[F++]=0<=g[W][2]?qa+g[W][2]:-g[W][2]-1+v,B[F++]=0<=g[W][1]?qa+g[W][1]:-g[W][1]-1+v,H[R++]=c,H[R++]=c,H[R++]=c;g={};g[l.VertexAttrConstants.POSITION]=B;g[l.VertexAttrConstants.NORMAL]=H;B={};B[l.VertexAttrConstants.POSITION]={size:3,data:x};B.zOffset={size:1,data:z};B[l.VertexAttrConstants.NORMAL]={size:3,data:E};return new k.GeometryData(B,g)};f.createPolylineGeometry=
function(a,b){l.assert(1<a.length,"createPolylineGeometry(): polyline needs at least 2 points");l.assert(3===a[0].length,"createPolylineGeometry(): malformed vertex");l.assert(void 0===b||b.length===a.length,"createPolylineGeometry: need same number of points and normals");l.assert(void 0===b||3===b[0].length,"createPolylineGeometry(): malformed normal");for(var c=new Float64Array(3*a.length),d=new Uint32Array(2*(a.length-1)),g=0,e=0,f=0;f<a.length;f++){for(var q=0;3>q;q++)c[g++]=a[f][q];0<f&&(d[e++]=
f-1,d[e++]=f)}g={};e={};g[l.VertexAttrConstants.POSITION]=d;e[l.VertexAttrConstants.POSITION]={size:3,data:c};if(b){for(var c=new Float32Array(3*b.length),t=0,f=0;f<a.length;f++)for(q=0;3>q;q++)c[t++]=b[f][q];g[l.VertexAttrConstants.NORMAL]=d;e[l.VertexAttrConstants.NORMAL]={size:3,data:c}}return new k.GeometryData(e,g,"line")};f.createExtrudedTriangle=function(a,b,c,d){var g,e,f=new Float32Array(18);a=[[-b,0,d/2],[c,0,d/2],[0,a,d/2],[-b,0,-d/2],[c,0,-d/2],[0,a,-d/2]];for(b=0;6>b;b++)f[3*b]=a[b][0],
f[3*b+1]=a[b][1],f[3*b+2]=a[b][2];a=(g={},g[l.VertexAttrConstants.POSITION]=new Uint32Array([0,1,2,3,0,2,2,5,3,1,4,5,5,2,1,1,0,3,3,4,1,4,3,5]),g);g=(e={},e[l.VertexAttrConstants.POSITION]={size:3,data:f},e);return new k.GeometryData(g,a)};f.transformInPlace=function(a,b){a=a.vertexAttributes[l.VertexAttrConstants.POSITION].data;for(var c=0;c<a.length;c+=3)e.vec3.set(x,a[c],a[c+1],a[c+2]),e.vec3.transformMat4(x,x,b),a[c]=x[0],a[c+1]=x[1],a[c+2]=x[2]};f.addVertexColors=function(a,b){var c=b||[1,1,1,
1];b=new Uint8Array(4);b[0]=255*c[0];b[1]=255*c[1];b[2]=255*c[2];b[3]=255*(3<c.length?c[3]:1);var c={},d=a.getVertexAttr(),g;for(g in d)c[g]=d[g];c[l.VertexAttrConstants.COLOR]={size:4,data:b};b={};for(g in a.indices)b[g]=a.indices[g];b[l.VertexAttrConstants.COLOR]=new Uint32Array(b[l.VertexAttrConstants.POSITION].length);return a=new k.GeometryData(c,b,a.primitiveType)};f.addNormals=function(a){var b=a.getVertexAttr();a=a.indices;for(var c=g.Vec3Compact.subtract,d=new Float32Array(a.position.length/
3*3),f=b.position.data,k=0,q=a.position,t=new Uint32Array(q.length),m=0;m<q.length;m+=3){c(f,3*q[m],f,3*q[m+2],z,0);c(f,3*q[m],f,3*q[m+1],x,0);e.vec3.cross(x,x,z);e.vec3.normalize(x,x);var v=k/3;d[k++]=x[0];d[k++]=x[1];d[k++]=x[2];t[m]=v;t[m+1]=v;t[m+2]=v}b[l.VertexAttrConstants.NORMAL]={size:3,data:d,offsetIdx:0,strideIdx:3};a[l.VertexAttrConstants.NORMAL]=t};f.cgToGIS=function(a,b){void 0===b&&(b=a);var c=a.getVertexAttr();a=c.position.data;var c=c.normal.data,d=b.getVertexAttr(),g=d.position.data,
d=d.normal.data;if(c)for(var e=0;e<c.length;e+=3){var f=c[e+1];d[e+1]=-c[e+2];d[e+2]=f}if(a)for(e=0;e<a.length;e+=3)f=a[e+1],g[e+1]=-a[e+2],g[e+2]=f;return b};f.makeOrthoBasisDirUp=v;f.makeOrthoBasisDirUpFallback=A})(v||(v={}));var t=.99619469809,x=r.vec3f32.create(),z=r.vec3f32.create();return v})},"esri/core/libs/gl-matrix-2/vec3f32":function(){define(["require","exports","./factories/vec3f32"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.vec3f32=e})},"esri/core/libs/gl-matrix-2/factories/vec3f32":function(){define(["require",
"exports"],function(u,f){function e(){return new Float32Array(3)}function r(d,c,a){var b=new Float32Array(3);b[0]=d;b[1]=c;b[2]=a;return b}function m(){return r(1,1,1)}function d(){return r(1,0,0)}function g(){return r(0,1,0)}function k(){return r(0,0,1)}Object.defineProperty(f,"__esModule",{value:!0});f.create=e;f.clone=function(d){var c=new Float32Array(3);c[0]=d[0];c[1]=d[1];c[2]=d[2];return c};f.fromValues=r;f.createView=function(d,c){return new Float32Array(d,c,3)};f.zeros=function(){return e()};
f.ones=m;f.unitX=d;f.unitY=g;f.unitZ=k;f.ZEROS=e();f.ONES=m();f.UNIT_X=d();f.UNIT_Y=g();f.UNIT_Z=k()})},"esri/views/3d/support/geometryUtils":function(){define("require exports ./geometryUtils/axisAngle ./geometryUtils/boundedPlane ./geometryUtils/clipRay ./geometryUtils/frustum ./geometryUtils/lineSegment ./geometryUtils/plane ./geometryUtils/ray ./geometryUtils/sphere ./geometryUtils/triangle ./geometryUtils/vector".split(" "),function(u,f,e,r,m,d,g,k,l,c,a,b){Object.defineProperty(f,"__esModule",
{value:!0});f.plane=k;f.boundedPlane=r;f.triangle=a;f.lineSegment=g;f.ray=l;f.clipRay=m;f.sphere=c;f.frustum=d;f.vector=b;f.axisAngle=e})},"esri/views/3d/support/geometryUtils/axisAngle":function(){define(["require","exports","../../../../core/libs/gl-matrix-2/vec3","../stack","./vector"],function(u,f,e,r,m){function d(d){void 0===d&&(d=f.UP);return[d[0],d[1],d[2],d[3]]}function g(g,e,c,a,b){void 0===b&&(b=d());b[0]=g;b[1]=e;b[2]=c;b[3]=a;return b}Object.defineProperty(f,"__esModule",{value:!0});
f.create=d;f.wrap=function(d,e,c,a){return g(d,e,c,a,r.sv4d.get())};f.wrapAxisAngle=function(d,e){return g(d[0],d[1],d[2],e,r.sv4d.get())};f.copy=function(e,f){void 0===f&&(f=d());return g(e[0],e[1],e[2],e[3],f)};f.fromValues=g;f.fromAxisAndAngle=function(g,f,c){void 0===c&&(c=d());e.vec3.copy(c,g);c[3]=f;return c};f.fromPoints=function(g,f,c){void 0===c&&(c=d());e.vec3.cross(c,g,f);e.vec3.normalize(c,c);c[3]=m.angle(g,f);return c};f.UP=[0,0,1,0]})},"esri/views/3d/support/geometryUtils/vector":function(){define(["require",
"exports","../../../../core/mathUtils","../../../../core/libs/gl-matrix-2/vec3","../../../../core/libs/gl-matrix-2/vec3f64"],function(u,f,e,r,m){Object.defineProperty(f,"__esModule",{value:!0});f.projectPoint=function(d,g,c){g=r.vec3.dot(d,g)/r.vec3.dot(d,d);return r.vec3.scale(c,d,g)};f.projectPointSignedLength=function(d,g){return r.vec3.dot(d,g)/r.vec3.length(d)};f.angle=function(d,g){d=r.vec3.dot(d,g)/(r.vec3.length(d)*r.vec3.length(g));return-e.acosClamped(d)};f.angleAroundAxis=function(f,l,
c){r.vec3.normalize(d,f);r.vec3.normalize(g,l);f=r.vec3.dot(d,g);f=e.acosClamped(f);l=r.vec3.cross(d,d,g);return 0>r.vec3.dot(l,c)?2*Math.PI-f:f};var d=m.vec3f64.create(),g=m.vec3f64.create()})},"esri/views/3d/support/geometryUtils/boundedPlane":function(){define("require exports ../../../../core/compilerUtils ../../../../core/Logger ../../../../core/mathUtils ../../../../core/ObjectStack ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../mathUtils ../stack ./lineSegment ./plane ./ray ./vector".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x){function z(a){void 0===a&&(a=f.UP);return{plane:v.create(a.plane),origin:c.vec3f64.clone(a.origin),basis1:c.vec3f64.clone(a.basis1),basis2:c.vec3f64.clone(a.basis2)}}function A(a,b){void 0===b&&(b=z());return E(a.origin,a.basis1,a.basis2,b)}function E(a,b,c,d){void 0===d&&(d=z());l.vec3.copy(d.origin,a);l.vec3.copy(d.basis1,b);l.vec3.copy(d.basis2,c);H(d);a=d;1E-6<Math.abs(l.vec3.dot(a.basis1,a.basis2)/(l.vec3.length(a.basis1)*l.vec3.length(a.basis2)))&&Z.warn("fromValues()",
"Provided basis vectors are not perpendicular");1E-6<Math.abs(l.vec3.dot(a.basis1,Q(a)))&&Z.warn("fromValues()","Basis vectors and plane normal are not perpendicular");1E-6<Math.abs(-l.vec3.dot(Q(a),a.origin)-a.plane[3])&&Z.warn("fromValues()","Plane offset is not consistent with plane origin");return d}function H(a){v.fromVectorsAndPoint(a.basis2,a.basis1,a.origin,a.plane)}function J(a,c,d){a!==d&&A(a,d);a=l.vec3.scale(b.sv3d.get(),Q(a),c);l.vec3.add(d.origin,d.origin,a);d.plane[3]-=c;return d}function B(a,
b){void 0===b&&(b=z());var c=(a[2]-a[0])/2,d=(a[3]-a[1])/2;l.vec3.set(b.origin,a[0]+c,a[1]+d,0);l.vec3.set(b.basis1,c,0,0);l.vec3.set(b.basis2,0,d,0);v.fromValues(0,0,1,0,b.plane);return b}function G(a,b,c){return v.intersectRay(a.plane,b,c)?S(a,c):!1}function F(c,d,g){var e=ha.get(),f=ha.get();V(c,d,e,f);for(var f=Number.POSITIVE_INFINITY,k=0,q=oa;k<q.length;k++){var t=ba(c,q[k],X.get()),r=b.sv3d.get();v.intersectLineSegment(e,t,r)&&(t=a.directionFromTo(b.sv3d.get(),d.origin,r),t=Math.abs(m.acosClamped(l.vec3.dot(d.direction,
t))),t<f&&(f=t,l.vec3.copy(g,r)))}return f===Number.POSITIVE_INFINITY?M(c,d,g):g}function M(a,c,d){if(G(a,c,d))return d;var g=ha.get(),e=ha.get();V(a,c,g,e);for(var f=Number.POSITIVE_INFINITY,k=0,q=oa;k<q.length;k++){var m=ba(a,q[k],X.get()),r=b.sv3d.get();v.intersectLineSegmentClamp(g,m,r)&&(m=t.distance2(c,r),v.isPointInside(e,r)&&m<f&&(f=m,l.vec3.copy(d,r)))}O(a,c.origin)<f&&R(a,c.origin,d);return d}function R(a,c,d){var g=v.projectPoint(a.plane,c,b.sv3d.get());c=q.projectPointClamp(aa(a,a.basis1),
g,-1,1,b.sv3d.get());g=q.projectPointClamp(aa(a,a.basis2),g,-1,1,b.sv3d.get());l.vec3.subtract(d,l.vec3.add(b.sv3d.get(),c,g),a.origin);return d}function T(a,c,d){var g=a.origin,e=a.basis1,f=a.basis2;c=l.vec3.subtract(b.sv3d.get(),c,g);e=x.projectPointSignedLength(e,c);f=x.projectPointSignedLength(f,c);a=x.projectPointSignedLength(Q(a),c);return l.vec3.set(d,e,f,a)}function O(a,c){c=T(a,c,b.sv3d.get());var d=a.basis2;a=l.vec3.length(a.basis1);d=l.vec3.length(d);a=Math.max(Math.abs(c[0])-a,0);d=Math.max(Math.abs(c[1])-
d,0);c=c[2];return a*a+d*d+c*c}function L(a,b){var c=-a.plane[3];return x.projectPointSignedLength(Q(a),b)-c}function Q(a){return v.normal(a.plane)}function S(a,c){var d=l.vec3.subtract(b.sv3d.get(),c,a.origin);c=l.vec3.squaredLength(a.basis1);var g=l.vec3.squaredLength(a.basis2),e=l.vec3.dot(a.basis1,d);a=l.vec3.dot(a.basis2,d);return 0>-e-c&&0>e-c&&0>-a-g&&0>a-g}function aa(a,b){var c=X.get();l.vec3.copy(c.origin,a.origin);l.vec3.copy(c.vector,b);return c}function ba(a,c,d){var g=a.basis1,e=a.basis2;
a=a.origin;var f=l.vec3.scale(b.sv3d.get(),g,c.origin[0]),k=l.vec3.scale(b.sv3d.get(),e,c.origin[1]);l.vec3.add(d.origin,f,k);l.vec3.add(d.origin,d.origin,a);g=l.vec3.scale(b.sv3d.get(),g,c.direction[0]);c=l.vec3.scale(b.sv3d.get(),e,c.direction[1]);l.vec3.scale(d.vector,l.vec3.add(g,g,c),2);return d}function V(a,b,c,d){a=Q(a);v.fromVectorsAndPoint(a,b.direction,b.origin,c);v.fromVectorsAndPoint(v.normal(c),a,b.origin,d)}Object.defineProperty(f,"__esModule",{value:!0});var Z=r.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");
u=function(){return function(){this.plane=v.create();this.origin=c.vec3f64.create();this.basis1=c.vec3f64.create();this.basis2=c.vec3f64.create()}}();f.BoundedPlaneClass=u;f.create=z;f.wrap=function(a,b,c){var d=ga.get();d.origin=a;d.basis1=b;d.basis2=c;d.plane=v.wrap(0,0,0,0);H(d);return d};f.copy=A;f.fromValues=E;f.updateUnboundedPlane=H;f.elevate=J;f.setExtent=function(a,b,c){B(b,c);J(c,L(a,a.origin),c);return c};f.fromAABoundingRect=B;f.intersectRay=G;f.intersectRayClosestSilhouette=function(a,
c,d){if(G(a,c,d))return d;a=F(a,c,b.sv3d.get());l.vec3.add(d,c.origin,l.vec3.scale(b.sv3d.get(),c.direction,l.vec3.distance(c.origin,a)/l.vec3.length(c.direction)));return d};f.closestPointOnSilhouette=F;f.closestPoint=M;f.projectPoint=R;f.projectPointLocal=T;f.distance2=O;f.distance=function(a,b){return Math.sqrt(O(a,b))};f.distanceToSilhouette=function(a,b){for(var c=Number.NEGATIVE_INFINITY,d=0,g=oa;d<g.length;d++){var e=ba(a,g[d],X.get()),e=q.distance2(e,b);e>c&&(c=e)}return Math.sqrt(c)};f.extrusionContainsPoint=
function(a,b){return v.isPointInside(a.plane,b)&&S(a,b)};f.axisAt=function(a,b,c,d){switch(c){case 0:l.vec3.copy(d,a.basis1);l.vec3.normalize(d,d);break;case 1:l.vec3.copy(d,a.basis2);l.vec3.normalize(d,d);break;case 2:l.vec3.copy(d,Q(a));break;default:e.neverReached(c)}return d};f.altitudeAt=L;f.setAltitudeAt=function(a,b,c,d){var g=L(a,b);a=l.vec3.scale(ea,Q(a),c-g);l.vec3.add(d,b,a);return d};f.equals=function(a,b){return l.vec3.equals(a.basis1,b.basis1)&&l.vec3.equals(a.basis2,b.basis2)&&l.vec3.equals(a.origin,
b.origin)};f.transform=function(a,b,c){a!==c&&A(a,c);g.mat4.invert(ja,b);g.mat4.transpose(ja,ja);l.vec3.transformMat4(c.basis1,a.basis1,ja);l.vec3.transformMat4(c.basis2,a.basis2,ja);l.vec3.transformMat4(c.plane,a.plane,ja);l.vec3.transformMat4(c.origin,a.origin,b);v.setOffsetFromPoint(c.plane,c.origin,c.plane);return c};f.rotate=function(a,b,c,d){a!==d&&A(a,d);g.mat4.rotate(da,g.mat4.identity(da),b,c);l.vec3.transformMat4(d.basis1,a.basis1,da);l.vec3.transformMat4(d.basis2,a.basis2,da);H(d);return d};
f.normal=Q;f.UP={plane:v.create(),origin:c.vec3f64.fromValues(0,0,0),basis1:c.vec3f64.fromValues(1,0,0),basis2:c.vec3f64.fromValues(0,1,0)};var ha=new d.ObjectStack(v.create),X=new d.ObjectStack(q.create),ea=c.vec3f64.create(),ga=new d.ObjectStack(function(){return{origin:null,basis1:null,basis2:null,plane:null}}),oa=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],ja=k.mat4f64.create(),da=k.mat4f64.create()})},"esri/views/3d/support/geometryUtils/plane":function(){define(["require",
"exports","../../../../core/mathUtils","../../../../core/libs/gl-matrix-2/vec3","../stack"],function(u,f,e,r,m){function d(a){void 0===a&&(a=f.UP);return[a[0],a[1],a[2],a[3]]}function g(a,b){void 0===b&&(b=d());return k(a[0],a[1],a[2],a[3],b)}function k(a,b,c,g,e){void 0===e&&(e=d());e[0]=a;e[1]=b;e[2]=c;e[3]=g;return e}function l(a,b,g){void 0===g&&(g=d());r.vec3.copy(g,b);b=r.vec3.dot(b,b);1E-5<Math.abs(b-1)&&1E-12<b&&r.vec3.scale(g,g,1/Math.sqrt(b));c(g,a,g);return g}function c(a,b,c){a!==c&&g(a,
c);c[3]=-r.vec3.dot(c,b);return c}function a(a,b,c,g){void 0===g&&(g=d());a=r.vec3.cross(m.sv3d.get(),b,a);return l(c,a,g)}function b(a,b,c){a=r.vec3.scale(m.sv3d.get(),a,r.vec3.dot(a,b));r.vec3.subtract(c,b,a);return c}function q(a,b){return r.vec3.dot(a,b)+a[3]}function v(a,b,c,d,g,f){var k=r.vec3.dot(a,c);if(0===k)return!1;a=-(r.vec3.dot(a,b)+a[3])/k;g&&(a=d?Math.max(0,a):e.clamp(a,0,1));if(0>a||!d&&1<a)return!1;r.vec3.add(f,b,r.vec3.scale(f,c,a));return!0}Object.defineProperty(f,"__esModule",
{value:!0});f.create=d;f.wrap=function(a,b,c,d){return k(a,b,c,d,m.sv4d.get())};f.copy=g;f.fromValues=k;f.fromNormalAndOffset=function(a,b,c){void 0===c&&(c=d());r.vec3.copy(c,a);c[3]=b;return c};f.fromPositionAndNormal=l;f.fromPoints=function(b,c,g,e){void 0===e&&(e=d());return a(r.vec3.subtract(m.sv3d.get(),b,c),r.vec3.subtract(m.sv3d.get(),g,c),b,e)};f.setOffsetFromPoint=c;f.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};f.fromVectorsAndPoint=a;f.intersectRay=function(a,
b,c){return v(a,b.origin,b.direction,!0,!1,c)};f.intersectLineSegment=function(a,b,c){return v(a,b.origin,b.vector,!1,!1,c)};f.intersectLineSegmentClamp=function(a,b,c){return v(a,b.origin,b.vector,!1,!0,c)};f.isSphereFullyInside=function(a,b){var c=b.radius;return 0<=q(a,b.center)-c};f.isSphereFullyOutside=function(a,b){var c=b.radius;return 0>q(a,b.center)+c};f.isPointInside=function(a,b){return 0<=q(a,b)};f.isPointOutside=function(a,b){return 0>q(a,b)};f.isAABBFullyInside=function(a,b){var c=b[0],
d=b[1],g=b[2],e=b[3],f=b[4];b=b[5];return 0<=a[0]*(0<a[0]?c:e)+a[1]*(0<a[1]?d:f)+a[2]*(0<a[2]?g:b)+a[3]};f.clip=function(a,b){var c=r.vec3.dot(a,b.ray.direction);a=-q(a,b.ray.origin);if(0>a&&0<=c)return!1;if(-1E-6<c&&1E-6>c)return 0<a;if((0>a||0>c)&&!(0>a&&0>c))return!0;a/=c;0<c?a<b.c1&&(b.c1=a):a>b.c0&&(b.c0=a);return b.c0<=b.c1};f.clipInfinite=function(a,b){var c=r.vec3.dot(a,b.ray.direction);a=-q(a,b.ray.origin);if(-1E-6<c&&1E-6>c)return 0<a;a/=c;0<c?a<b.c1&&(b.c1=a):a>b.c0&&(b.c0=a);return b.c0<=
b.c1};f.projectPoint=function(a,c,d){var g=r.vec3.scale(m.sv3d.get(),a,-a[3]);c=r.vec3.subtract(m.sv3d.get(),c,g);a=b(a,c,m.sv3d.get());r.vec3.add(d,a,g);return d};f.projectVector=b;f.distance=function(a,b){return Math.abs(q(a,b))};f.signedDistance=q;f.normal=function(a){return a};f.UP=[0,0,1,0]})},"esri/views/3d/support/geometryUtils/ray":function(){define("require exports ../../../../core/ObjectStack ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../stack".split(" "),
function(u,f,e,r,m,d,g,k){function l(a){return a?{origin:g.vec3f64.clone(a.origin),direction:g.vec3f64.clone(a.direction)}:{origin:g.vec3f64.create(),direction:g.vec3f64.create()}}function c(a,b,c){void 0===c&&(c=l());d.vec3.copy(c.origin,a);d.vec3.copy(c.direction,b);return c}function a(a,b,c){void 0===c&&(c=l());var g=r.castRenderScreenPointArray3(m.vec2.copy(k.sv3d.get(),b));g[2]=0;a.unprojectPoint(g,c.origin);b=r.castRenderScreenPointArray3(m.vec2.copy(k.sv3d.get(),b));b[2]=1;a=a.unprojectPoint(b,
k.sv3d.get());d.vec3.subtract(c.direction,a,c.origin);return c}function b(a,b,c){void 0===c&&(c=l());d.vec3.copy(c.origin,a.eye);b=d.vec3.set(k.sv3d.get(),b[0],b[1],1);a=a.unprojectPoint(b,k.sv3d.get());d.vec3.subtract(c.direction,a,c.origin);return c}function q(a,b){a=d.vec3.cross(k.sv3d.get(),d.vec3.normalize(k.sv3d.get(),a.direction),d.vec3.subtract(k.sv3d.get(),b,a.origin));return d.vec3.dot(a,a)}function v(){return{origin:null,direction:null}}Object.defineProperty(f,"__esModule",{value:!0});
f.create=l;f.wrap=function(a,b){var c=t.get();c.origin=a;c.direction=b;return c};f.copy=function(a,b){void 0===b&&(b=l());return c(a.origin,a.direction,b)};f.fromPoints=function(a,b,c){void 0===c&&(c=l());d.vec3.copy(c.origin,a);d.vec3.subtract(c.direction,b,a);return c};f.fromValues=c;f.fromScreen=function(b,c,d){void 0===d&&(d=l());return a(b,b.screenToRender(c,r.castRenderScreenPointArray3(k.sv3d.get())),d)};f.fromRender=a;f.fromScreenAtEye=function(a,c,d){void 0===d&&(d=l());return b(a,a.screenToRender(c,
r.castRenderScreenPointArray3(k.sv3d.get())),d)};f.fromRenderAtEye=b;f.distance2=q;f.distance=function(a,b){return Math.sqrt(q(a,b))};f.closestPoint=function(a,b,c){b=d.vec3.dot(a.direction,d.vec3.subtract(c,b,a.origin));d.vec3.add(c,a.origin,d.vec3.scale(c,a.direction,b));return c};f.createWrapper=v;var t=new e.ObjectStack(v)})},"esri/views/3d/support/geometryUtils/clipRay":function(){define("require exports ../../../../core/ObjectStack ../../../../core/libs/gl-matrix-2/vec3 ../stack ./ray".split(" "),
function(u,f,e,r,m,d){function g(a){return a?{ray:d.create(a.ray),c0:a.c0,c1:a.c1}:{ray:d.create(),c0:0,c1:Number.MAX_VALUE}}function k(a,c,e,f){void 0===f&&(f=g());d.copy(a,f.ray);f.c0=c;f.c1=e;return f}function l(a,c,e){void 0===e&&(e=g());var b=r.vec3.length(a.vector);d.fromValues(a.origin,c,e.ray);e.c0=0;e.c1=b;return e}function c(a,c,d){return r.vec3.add(d,a.ray.origin,r.vec3.scale(d,a.ray.direction,c))}Object.defineProperty(f,"__esModule",{value:!0});f.create=g;f.wrap=function(b,c,d){var g=
a.get();g.ray=b;g.c0=c;g.c1=d;return g};f.copy=function(a,c){void 0===c&&(c=g());return k(a.ray,a.c0,a.c1,c)};f.fromValues=k;f.fromRay=function(a,c){void 0===c&&(c=g());d.copy(a,c.ray);c.c0=0;c.c1=Number.MAX_VALUE;return c};f.fromLineSegment=function(a,c){void 0===c&&(c=g());var b=r.vec3.normalize(m.sv3d.get(),a.vector);return l(a,b,c)};f.fromLineSegmentAndDirection=l;f.getStart=function(a,d){return c(a,a.c0,d)};f.getEnd=function(a,d){return c(a,a.c1,d)};f.getAt=c;var a=new e.ObjectStack(function(){return{c0:0,
c1:0,ray:null}})})},"esri/views/3d/support/geometryUtils/frustum":function(){define("require exports ../../../../core/ObjectStack ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/vec4 ../../../../core/libs/gl-matrix-2/vec4f64 ../stack ./clipRay ./plane".split(" "),function(u,f,e,r,m,d,g,k,l,c,a){function b(b){if(b){var c=b.planes;b=b.points;return{planes:[a.create(c[0]),a.create(c[1]),a.create(c[2]),
a.create(c[3]),a.create(c[4]),a.create(c[5])],points:[d.vec3f64.clone(b[0]),d.vec3f64.clone(b[1]),d.vec3f64.clone(b[2]),d.vec3f64.clone(b[3]),d.vec3f64.clone(b[4]),d.vec3f64.clone(b[5]),d.vec3f64.clone(b[6]),d.vec3f64.clone(b[7])]}}return{planes:[a.create(),a.create(),a.create(),a.create(),a.create(),a.create()],points:[d.vec3f64.create(),d.vec3f64.create(),d.vec3f64.create(),d.vec3f64.create(),d.vec3f64.create(),d.vec3f64.create(),d.vec3f64.create(),d.vec3f64.create()]}}function q(c,d,g){void 0===
g&&(g=b());for(var e=0;6>e;e++)a.copy(c[e],g.planes[e]);for(e=0;8>e;e++)m.vec3.copy(g.points[e],d[e]);return g}function v(b){var c=b.planes;b=b.points;a.fromPoints(b[4],b[0],b[3],c[0]);a.fromPoints(b[1],b[5],b[6],c[1]);a.fromPoints(b[4],b[5],b[1],c[2]);a.fromPoints(b[3],b[2],b[6],c[3]);a.fromPoints(b[0],b[1],b[2],c[4]);a.fromPoints(b[5],b[4],b[7],c[5])}function t(b,c){for(var d=0;6>d;d++)if(!a.clip(b[d],c))return!1;return!0}Object.defineProperty(f,"__esModule",{value:!0});f.create=b;f.copy=function(a,
c){void 0===c&&(c=b());return q(a.planes,a.points,c)};f.fromValues=q;f.fromMatrix=function(a,c,d){void 0===d&&(d=b());var e=d.points;a=r.mat4.multiply(l.sm4d.get(),c,a);r.mat4.invert(a,a);for(c=0;8>c;++c){var f=g.vec4.transformMat4(l.sv4d.get(),x[c],a);m.vec3.set(e[c],f[0]/f[3],f[1]/f[3],f[2]/f[3])}v(d);return d};f.recomputePlanes=v;f.intersectsSphere=function(b,c){for(var d=0;6>d;d++)if(a.isSphereFullyInside(b[d],c))return!1;return!0};f.intersectsRay=function(a,b){return t(a,c.fromRay(b,z.get()))};
f.intersectClipRay=function(b,c){for(var d=0;6>d;d++)if(!a.clipInfinite(b[d],c))return!1;return!0};f.intersectsLineSegment=function(a,b,d){return t(a,c.fromLineSegmentAndDirection(b,d,z.get()))};f.intersectsPoint=function(b,c){for(var d=0;6>d;d++)if(0<a.signedDistance(b[d],c))return!1;return!0};f.intersectsAABB=function(b,c){for(var d=0;6>d;d++)if(a.isAABBFullyInside(b[d],c))return!1;return!0};f.planePointIndices={bottom:[5,1,0,4],near:[0,1,2,3],far:[5,4,7,6],right:[1,5,6,2],left:[4,0,3,7],top:[7,
3,2,6]};var x=[k.vec4f64.fromValues(-1,-1,-1,1),k.vec4f64.fromValues(1,-1,-1,1),k.vec4f64.fromValues(1,1,-1,1),k.vec4f64.fromValues(-1,1,-1,1),k.vec4f64.fromValues(-1,-1,1,1),k.vec4f64.fromValues(1,-1,1,1),k.vec4f64.fromValues(1,1,1,1),k.vec4f64.fromValues(-1,1,1,1)],z=new e.ObjectStack(c.create)})},"esri/views/3d/support/geometryUtils/sphere":function(){define("require exports ../../../../core/compilerUtils ../../../../core/Logger ../../../../core/mathUtils ../../../../core/ObjectStack ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../geometryUtils ../mathUtils ../stack ./ray".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q){function v(a){return a?{radius:a.radius,center:l.vec3f64.clone(a.center)}:{radius:1,center:l.vec3f64.create()}}function t(a,b){void 0===b&&(b=v());return x(a.radius,a.center,b)}function x(a,b,c){void 0===c&&(c=v());k.vec3.copy(c.center,b);c.radius=a;return c}function z(a,c,d){var g=k.vec3.subtract(b.sv3d.get(),c.origin,a.center),e=k.vec3.dot(c.direction,c.direction),f=2*k.vec3.dot(c.direction,g);a=k.vec3.dot(g,g)-a.radius*a.radius;a=f*f-4*e*a;if(0>a)return!1;g=
Math.sqrt(a);a=(-f-g)/(2*e);e=(-f+g)/(2*e);if(0>a||e<a&&0<e)a=e;if(0>a)return!1;d&&k.vec3.add(d,c.origin,k.vec3.scale(b.sv3d.get(),c.direction,a));return!0}function A(a,d,e){var f=b.sv3d.get(),l=b.sm4d.get();k.vec3.cross(f,d.origin,d.direction);k.vec3.cross(e,f,d.origin);k.vec3.scale(e,e,1/k.vec3.length(e)*a.radius);a=H(a,d.origin);d=c.vector.angle(d.origin,e);g.mat4.identity(l);g.mat4.rotate(l,l,d+a,f);k.vec3.transformMat4(e,e,l);return e}function E(a,c,d){c=k.vec3.subtract(b.sv3d.get(),c,a.center);
c=k.vec3.scale(b.sv3d.get(),c,a.radius/k.vec3.length(c));return k.vec3.add(d,c,a.center)}function H(a,c){c=k.vec3.subtract(b.sv3d.get(),c,a.center);c=k.vec3.length(c);return m.acosClamped(a.radius/(a.radius+Math.abs(a.radius-c)))}function J(b,c,d,g){b=k.vec3.subtract(F,c,b.center);switch(d){case 0:return b=a.cartesianToSpherical(b,F),b=b[2],k.vec3.set(g,-Math.sin(b),Math.cos(b),0);case 1:return b=a.cartesianToSpherical(b,F),d=b[1],b=b[2],c=Math.sin(d),k.vec3.set(g,-c*Math.cos(b),-c*Math.sin(b),Math.cos(d));
case 2:return k.vec3.normalize(g,b);default:e.neverReached(d)}}function B(a,b){b=k.vec3.subtract(O,b,a.center);return k.vec3.length(b)-a.radius}Object.defineProperty(f,"__esModule",{value:!0});var G=r.getLogger("esri.views.3d.support.geometryUtils.sphere");f.create=v;f.wrap=function(a,b){var c=M.get();c.radius=a;c.center=b||T;return c};f.copy=t;f.fromValues=x;f.elevate=function(a,b,c){a!==c&&k.vec3.copy(c.center,a.center);c.radius=a.radius+b;return c};f.setExtent=function(a,b,c){G.error("sphere.setExtent is not yet supported");
return a===c?c:t(a,c)};f.intersectRay=z;f.intersectScreen=function(a,b,c,d){b=q.fromScreenAtEye(b,c,R);return z(a,b,d)};f.intersectsRay=function(a,b){return z(a,b,null)};f.intersectRayClosestSilhouette=function(a,c,d){if(z(a,c,d))return d;a=A(a,c,b.sv3d.get());k.vec3.add(d,c.origin,k.vec3.scale(b.sv3d.get(),c.direction,k.vec3.distance(c.origin,a)/k.vec3.length(c.direction)));return d};f.closestPointOnSilhouette=A;f.closestPoint=function(a,b,c){if(z(a,b,c))return c;q.closestPoint(b,a.center,c);return E(a,
c,c)};f.projectPoint=E;f.distanceToSilhouette=function(a,c){c=k.vec3.subtract(b.sv3d.get(),c,a.center);c=k.vec3.squaredLength(c);return Math.sqrt(Math.abs(c-a.radius*a.radius))};f.angleToSilhouette=H;var F=l.vec3f64.create();f.axisAt=J;f.altitudeAt=B;f.setAltitudeAt=function(a,b,c,d){var g=B(a,b);a=J(a,b,2,O);c=k.vec3.scale(O,a,c-g);k.vec3.add(d,b,c);return d};var M=new d.ObjectStack(function(){return{center:null,radius:0}}),R=q.create(),T=l.vec3f64.create(),O=l.vec3f64.create();Object.freeze(T)})},
"esri/views/3d/webgl-engine/lib/GeometryData":function(){define(["require","exports","./geometryDataUtils","./Util"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function f(d,g,k){void 0===g&&(g=f.DefaultIndices);void 0===k&&(k="triangle");var l={},c;for(c in d){var a=d[c],b=a.size;l[c]={data:a.data,size:b,offsetIdx:0,strideIdx:b}}if(g===f.DefaultIndices){g=r.getFirstObjectValue(l);g=null==g?0:g.data.length/g.size;d=e.generateDefaultIndexArray(g);g={};for(var q in l)g[q]=
d}this._id=e.getNewId();this._vertexAttributes=l;this._indices=g;this._primitiveType=k}Object.defineProperty(f.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"vertexAttributes",{get:function(){return this._vertexAttributes},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"indices",{get:function(){return this._indices},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"indexCount",{get:function(){var d=
r.getFirstObjectValue(this._indices);return null==d?0:d.length},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"primitiveType",{get:function(){return this._primitiveType},enumerable:!0,configurable:!0});f.prototype.getVertexAttr=function(){return this.vertexAttributes};f.prototype.toRenderData=function(){return{id:this._id.toString(),indices:this._indices,vertexAttr:this._vertexAttributes}};f.prototype.getIndices=function(d){return this._indices[d]};f.prototype.getAttribute=function(d){return this._vertexAttributes[d]};
f.prototype.estimateGpuMemoryUsage=function(){var d=0;this._indices[r.VertexAttrConstants.POSITION]&&(d+=12*this._indices[r.VertexAttrConstants.POSITION].length);this._indices[r.VertexAttrConstants.NORMAL]&&(d+=12*this._indices[r.VertexAttrConstants.NORMAL].length);this._indices[r.VertexAttrConstants.UV0]&&(d+=8*this._indices[r.VertexAttrConstants.UV0].length);this._indices[r.VertexAttrConstants.COLOR]&&(d+=4*this._indices[r.VertexAttrConstants.COLOR].length);return d};f.DefaultIndices={};return f}();
f.GeometryData=u})},"esri/views/3d/webgl-engine/lib/lodRendering/LodResources":function(){define(["require","exports","../../../../../core/arrayUtils"],function(u,f,e){function r(f){var d=[];f.components.forEach(function(g){d.push(g.geometry)});return e.unique(d)}Object.defineProperty(f,"__esModule",{value:!0});f.materialsFromLodResources=function(f){var d=[];f.levels.forEach(function(g){g.components.forEach(function(g){d.push(g.material)})});return e.unique(d)};f.texturesFromLodResources=function(f){var d=
[];f.levels.forEach(function(g){g.components.forEach(function(g){g.textures&&d.push.apply(d,g.textures)})});return e.unique(d)};f.geometriesFromLodLevelResources=r;f.geometriesFromLodResources=function(f){var d=[];f.levels.forEach(function(g){g.components.forEach(function(g){d.push(g.geometry)})});return e.unique(d)};f.computeFaceCount=function(e){var d=0;r(e).forEach(function(g){d+=g.data.indexCount/3});return d}})},"esri/views/3d/layers/graphics/pointUtils":function(){define("require exports ../../../../core/maybe ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/coordsUtils ../../../../layers/graphics/dehydratedFeatures ./elevationAlignmentUtils ./elevationAlignmentUtils ./graphicUtils ../../support/projectionUtils ../../webgl-engine/lib/Object3D".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q){Object.defineProperty(f,"__esModule",{value:!0});var v=m.vec3f64.create();f.createStageObjectForHUD=function(a,g,f,k,l,m,u,B,G,F,M){var t=f?f.length:0,x=a.clippingExtent;b.pointToVector(g,v,a.elevationProvider.spatialReference);if(e.isSome(x)&&!d.containsPoint(x,v))return null;b.pointToVector(g,v,a.renderCoordsHelper.spatialReference);x=a.localOriginFactory.getOrigin(v);B=new q({castShadow:!1,metadata:{layerUid:G,graphicUid:F,usesVerticalDistanceToGround:!0},idHint:B});
for(G=0;G<t;G++)B.addGeometry(f[G],k[G],l?l[G]:r.mat4f64.IDENTITY,m,x,M);a=c.applyElevationAlignmentForHUD(B,g,a.elevationProvider,a.renderCoordsHelper,u);return{object:B,sampledElevation:a}};f.extendPointGraphicElevationContext=function(a,c,d){a=a.elevationContext;d=d.spatialReference;b.pointToVector(c,v,d);a.centerPointInElevationSR=k.makeDehydratedPoint(v[0],v[1],c.hasZ?v[2]:0,d)};f.placePointOnGeometry=function(b){switch(b.type){case "point":return b;case "polygon":case "extent":return a.computeCentroid(b);
case "polyline":var c=b.paths[0];if(!c||0===c.length)break;c=g.getPointOnPath(c,g.getPathLength(c)/2);return k.makeDehydratedPoint(c[0],c[1],c[2],b.spatialReference);case "mesh":return b.extent.center}return null};f.geometryToRenderInfo=function(a,b,c,d,g){var e=new Float64Array(3*a.length),f=new Float64Array(e.length);a.forEach(function(a,b){e[3*b+0]=a[0];e[3*b+1]=a[1];e[3*b+2]=2<a.length?a[2]:0});b=l.applyPerVertexElevationAlignment(e,b,0,f,0,e,0,e.length/3,c,d,g);return{numVertices:a.length,position:e,
mapPosition:f,projectionSuccess:null!=b,sampledElevation:b}}})},"esri/views/3d/webgl-engine/lib/Object3D":function(){define("require exports tslib ../../../../core/maybe ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../support/mathUtils ./GeometryRecord ./IdGen ./Object3DStateSet ./Util ../materials/renderers/utils".split(" "),function(u,f,e,r,m,d,g,k,l,c,a,b,q,v){u=function(){function e(a){void 0===
a&&(a={});this._objectTransformation=d.mat4f64.create();this._bvObjectSpace=new x;this._bvWorldSpace=new x;this._bvDirty=!0;this._hasVolatileTransformation=!1;this._visible=!0;this.id=e._idGen.gen(a.idHint);this.castShadow=null!=a.castShadow?a.castShadow:!0;(this.metadata=a.metadata)&&this.metadata.isElevationSource&&(this.metadata.lastValidElevationBB=new t);this.objectTransformation=d.mat4f64.create();this._initializeGeometryRecords(a.geometries,a.materials,a.transformations,a.origins)}Object.defineProperty(e.prototype,
"geometryRecords",{get:function(){return this._geometryRecords},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"geometries",{get:function(){return this._geometries},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"objectTransformation",{get:function(){return this._objectTransformation},set:function(a){m.mat4.copy(this._objectTransformation,a);this._invalidateBoundingVolume();this._notifyDirty("objTransformation")},enumerable:!0,configurable:!0});e.prototype.dispose=
function(){for(var a=0,b=this._geometryRecords;a<b.length;a++)c.pool.release(b[a]);this._geometries=this._geometryRecords=null};e.prototype._initializeGeometryRecords=function(a,b,g,e){if(Array.isArray(a)){q.assert(b.length===a.length,"Object3D: materials don't match geometries");q.assert(g.length===a.length,"Object3D: transformations don't match geometries");this._geometryRecords=Array(a.length);this._geometries=a.slice();for(var f=0;f<a.length;f++)this._geometryRecords[f]=c.pool.acquire(a[f],b[f],
d.mat4f64.clone(g[f]),{highlights:null,occludees:null,visible:!0},e&&e[f]);this._hasVolatileTransformation=!1}else this._geometryRecords=[],this._geometries=[]};Object.defineProperty(e.prototype,"parentLayer",{get:function(){return this._parentLayer},set:function(a){q.assert(null==this._parentLayer||null==a,"Object3D can only be added to a single Layer");this._parentLayer=a},enumerable:!0,configurable:!0});e.prototype.getNumGeometryRecords=function(){return this._geometryRecords.length};e.prototype.findGeometryRecords=
function(a){for(var b=[],c=0;c<this._geometries.length;c++)this._geometries[c]===a&&b.push(this._geometryRecords[c]);return b};e.prototype.getGeometryRecord=function(a){q.assert(0<=a&&a<this._geometryRecords.length,"Object3d.getGeometryDataByIndex: index out of range");return this._geometryRecords[a]};e.prototype.addGeometry=function(a,b,g,e,f,k){g=g?g:d.mat4f64.IDENTITY;this._geometries.push(a);a=c.pool.acquire(a,b,g,e||{highlights:null,occludees:null,visible:!0},f,k);this._geometryRecords.push(a);
this._hasVolatileTransformation=this._geometryRecords.some(function(a){return!!a.shaderTransformation});this._notifyDirty("objGeometryAdded",a);this._invalidateBoundingVolume();return a};e.prototype.removeGeometry=function(a){var b=this._geometryRecords.splice(a,1)[0];c.pool.release(b);this._hasVolatileTransformation=this._geometryRecords.some(function(a){return!!a.shaderTransformation});this._geometries.splice(a,1);this._notifyDirty("objGeometryRemoved",b);this._invalidateBoundingVolume();return b};
e.prototype.removeAllGeometries=function(){for(;0<this.getNumGeometryRecords();)this.removeGeometry(0)};e.prototype.geometryVertexAttrsUpdated=function(a){this._notifyDirty("vertexAttrsUpdated",this._geometryRecords[a]);this._invalidateBoundingVolume()};Object.defineProperty(e.prototype,"isVisible",{get:function(){return this._visible},enumerable:!0,configurable:!0});e.prototype.setVisible=function(a){this._visible=a;a=0;for(var b=this._geometryRecords;a<b.length;a++)b[a].instanceParameters.visible=
this._visible;this._notifyDirty("visibilityChanged")};e.prototype.occlude=function(){for(var a=b.generateObject3DStateId(1),c=0,d=this._geometryRecords;c<d.length;c++){var g=d[c];g.instanceParameters.occludees=v.addObject3DStateID(g.instanceParameters.occludees,a)}this._notifyDirty("occlusionChanged");return a};e.prototype.removeOcclude=function(a){for(var b=0,c=this._geometryRecords;b<c.length;b++){var d=c[b];d.instanceParameters.occludees=v.removeObject3DStateID(d.instanceParameters.occludees,a)}this._notifyDirty("occlusionChanged")};
e.prototype.highlight=function(){for(var a=b.generateObject3DStateId(0),c=0,d=this._geometryRecords;c<d.length;c++){var g=d[c];g.instanceParameters.highlights=v.addObject3DStateID(g.instanceParameters.highlights,a)}this._notifyDirty("highlightChanged");return a};e.prototype.removeHighlight=function(a){for(var b=0,c=this._geometryRecords;b<c.length;b++){var d=c[b];d.instanceParameters.highlights=v.removeObject3DStateID(d.instanceParameters.highlights,a)}this._notifyDirty("highlightChanged")};e.prototype.setGeometryTransformation=
function(a,b){q.assert(0<=a&&a<this._geometryRecords.length,"Object3d.setGeometryTransformation: index out of range");var g=this._geometryRecords[a];c.pool.release(g);b=c.pool.acquire(g.geometry,g.material,d.mat4f64.clone(b),g.instanceParameters);this._geometryRecords[a]=b;this._notifyDirty("objGeometryReplaced",[g,b]);this._invalidateBoundingVolume()};e.prototype.getCombinedStaticTransformation=function(a,b){return m.mat4.multiply(r.unwrapOr(b,d.mat4f64.create()),this.objectTransformation,a.getStaticTransformation())};
e.prototype.getCombinedShaderTransformation=function(a,b){b=b||d.mat4f64.create();m.mat4.multiply(b,this.objectTransformation,a.getShaderTransformation());return b};e.prototype.hasVolativeTransformation=function(){return this._hasVolatileTransformation};e.prototype.getBBMin=function(a){this._validateBoundingVolume();return a?this._bvObjectSpace.bbMin:this._bvWorldSpace.bbMin};e.prototype.getBBMax=function(a){this._validateBoundingVolume();return a?this._bvObjectSpace.bbMax:this._bvWorldSpace.bbMax};
e.prototype.getCenter=function(a){this._validateBoundingVolume();return a?this._bvObjectSpace.center:this._bvWorldSpace.center};e.prototype.getBSRadius=function(a){this._validateBoundingVolume();return a?this._bvObjectSpace.bsRadius:this._bvWorldSpace.bsRadius};e.prototype._validateBoundingVolume=function(){if(this._bvDirty||this._hasVolatileTransformation){this._bvObjectSpace.init();this._bvWorldSpace.init();for(var a=0;a<this._geometryRecords.length;++a){var b=this._geometries[a],c=this._geometryRecords[a],
b=b.boundingInfo;this._calculateTransformedBoundingVolume(b,this._bvObjectSpace,c.getShaderTransformation());this._calculateTransformedBoundingVolume(b,this._bvWorldSpace,this.getCombinedShaderTransformation(c))}g.vec3.lerp(this._bvObjectSpace.center,this._bvObjectSpace.bbMin,this._bvObjectSpace.bbMax,.5);g.vec3.lerp(this._bvWorldSpace.center,this._bvWorldSpace.bbMin,this._bvWorldSpace.bbMax,.5);for(var c=k.vec3f64.create(),d=k.vec3f64.create(),e=l.maxScale(this.objectTransformation),a=0;a<this._geometryRecords.length;++a){var b=
this._geometries[a],f=this._geometryRecords[a].getShaderTransformation(),q=l.maxScale(f),b=b.boundingInfo;g.vec3.transformMat4(c,b.getCenter(),f);f=g.vec3.distance(c,this._bvObjectSpace.center);b=b.getBSRadius()*q;this._bvObjectSpace.bsRadius=Math.max(this._bvObjectSpace.bsRadius,f+b);g.vec3.transformMat4(d,c,this.objectTransformation);q=g.vec3.distance(d,this._bvWorldSpace.center);this._bvWorldSpace.bsRadius=Math.max(this._bvWorldSpace.bsRadius,q+b*e)}this._bvDirty=!1}};e.prototype._calculateTransformedBoundingVolume=
function(a,b,c){var d=a.getBBMin();a=a.getBBMax();var e=k.vec3f64.clone(d),f=k.vec3f64.clone(a);g.vec3.transformMat4(e,e,c);g.vec3.transformMat4(f,f,c);for(var l=0;3>l;++l)b.bbMin[l]=Math.min(b.bbMin[l],e[l],f[l]),b.bbMax[l]=Math.max(b.bbMax[l],e[l],f[l]);for(l=0;3>l;++l){g.vec3.copy(e,d);g.vec3.copy(f,a);e[l]=a[l];f[l]=d[l];g.vec3.transformMat4(e,e,c);g.vec3.transformMat4(f,f,c);for(var q=0;3>q;++q)b.bbMin[q]=Math.min(b.bbMin[q],e[q],f[q]),b.bbMax[q]=Math.max(b.bbMax[q],e[q],f[q])}};e.prototype._invalidateBoundingVolume=
function(){this._bvDirty=!0;this._parentLayer&&this._parentLayer.notifyObjectBBChanged(this,{center:this._bvWorldSpace.center,radius:this._bvWorldSpace.bsRadius})};e.prototype._notifyDirty=function(a,b,c,d){this._parentLayer&&this._parentLayer.notifyDirty(a,b,c||1,d||this)};Object.defineProperty(e.prototype,"test",{get:function(){var a=this;return{hasGeometry:function(b){return-1<a._geometries.indexOf(b)},getGeometryIndex:function(b){return a._geometries.indexOf(b)}}},enumerable:!0,configurable:!0});
e._idGen=new a.IdGen;return e}();var t=function(){function a(){this.bbMin=k.vec3f64.fromValues(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);this.bbMax=k.vec3f64.fromValues(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE)}a.prototype.isEmpty=function(){return this.bbMax[0]<this.bbMin[0]&&this.bbMax[1]<this.bbMin[1]&&this.bbMax[2]<this.bbMin[2]};return a}(),x=function(a){function b(){var b=a.call(this)||this;b.center=k.vec3f64.create();b.bsRadius=0;return b}e.__extends(b,a);b.prototype.init=
function(){g.vec3.set(this.bbMin,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);g.vec3.set(this.bbMax,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);g.vec3.set(this.center,0,0,0);this.bsRadius=0};b.prototype.getCenter=function(){return this.center};b.prototype.getBSRadius=function(){return this.bsRadius};return b}(t);return u})},"esri/views/3d/webgl-engine/lib/GeometryRecord":function(){define(["require","exports","../../../../core/ObjectPool","../../../../core/libs/gl-matrix-2/vec3",
"./IdGen"],function(u,f,e,r,m){return function(){function d(){}d.prototype.acquire=function(g,e,f,c,a,b){this.id=d._idGen.gen(g&&g.id);this.geometry=g;this.material=e;this.transformation=f;this.instanceParameters=c;this.origin=a;this.shaderTransformation=b};d.prototype.getStaticTransformation=function(){return this.transformation};d.prototype.getShaderTransformation=function(){return this.shaderTransformation?this.shaderTransformation(this.transformation):this.transformation};d.prototype.computeAttachmentOrigin=
function(d){return(this.material.computeAttachmentOrigin?this.material.computeAttachmentOrigin(this.geometry,d):this.geometry.computeAttachmentOrigin(d))?(r.vec3.transformMat4(d,d,this.getStaticTransformation()),!0):!1};d._idGen=new m.IdGen;d.pool=new e(d);return d}()})},"esri/views/3d/webgl-engine/lib/Object3DStateSet":function(){define(["require","exports","./IdGen"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});var r=new e.IdGen;f.generateObject3DStateId=function(e){return{id:r.gen(0===
e?"highlight":"occludee"),channel:e}};u=function(){function e(){this.items=[]}e.prototype.addObject=function(d,g){this.items.push({type:0,objectStateId:g,object:d})};e.prototype.addRenderGeometry=function(d,g,e){this.items.push({type:1,objectStateId:g,renderGeometry:d,owner:e})};e.prototype.addExternal=function(d,g){this.items.push({type:2,objectStateId:g,remove:d})};e.prototype.remove=function(d){for(var g=this.items.length-1;0<=g;--g){var e=this.items[g];e.objectStateId===d&&(this._removeObjectStateItem(e),
this.items.splice(g,1))}};e.prototype.removeObject=function(d){for(var g=this.items.length-1;0<=g;--g){var e=this.items[g];0===e.type&&e.object===d&&(this._removeObjectStateItem(e),this.items.splice(g,1))}};e.prototype.removeRenderGeometry=function(d){for(var g=this.items.length-1;0<=g;--g){var e=this.items[g];1===e.type&&e.renderGeometry===d&&(this._removeObjectStateItem(e),this.items.splice(g,1))}};e.prototype.removeAll=function(){var d=this;this.items.forEach(function(g){d._removeObjectStateItem(g)});
this.items=[]};e.prototype._removeObjectStateItem=function(d){switch(d.type){case 0:0===d.objectStateId.channel?d.object.removeHighlight(d.objectStateId):1===d.objectStateId.channel&&d.object.removeOcclude(d.objectStateId);break;case 1:d.owner.removeRenderGeometryObjectState(d.renderGeometry,d.objectStateId);break;case 2:d.remove(d.objectStateId)}};return e}();f.Object3DStateSet=u})},"esri/views/3d/webgl-engine/materials/renderers/utils":function(){define("require exports ../../../../../core/maybe ../../../../../core/maybe ../../../../../core/libs/gl-matrix-2/mat4 ../../../../../core/libs/gl-matrix-2/mat4f64 ../../lib/doublePrecisionUtils ../../lib/Util".split(" "),
function(u,f,e,r,m,d,g,k){Object.defineProperty(f,"__esModule",{value:!0});f.addObject3DStateID=function(a,c){e.isNone(a)&&(a=[]);a.push(c);return a};f.removeObject3DStateID=function(a,c){if(e.isNone(a))return a;a=a.filter(function(a){return a!==c});return 0===a.length?null:a};f.isInstanceHidden=function(a){return r.isSome(a)?!a.visible:!1};f.acquireMaterials=function(a,c){var b=new Map;b.set(0,c.acquire(a,0));b.set(3,c.acquire(a,3));b.set(2,c.acquire(a,2));b.set(1,c.acquire(a,1));b.set(4,c.acquire(a,
4));return b};f.releaseMaterials=function(a,c){c.release(a,0);c.release(a,3);c.release(a,2);c.release(a,1);c.release(a,4)};f.calculateTransformRelToOrigin=function(b,c,d){var g=b.origin.vec3;k.setMatrixTranslation3(a,-g[0],-g[1],-g[2]);r.isSome(b.transformation)?m.mat4.multiply(c,a,b.transformation):m.mat4.copy(c,a);d&&(m.mat4.invert(d,c),m.mat4.transpose(d,d))};f.encodeDoubleVec3=function(a,d,e,f,k){l[0]=a.get(d,0);l[1]=a.get(d,1);l[2]=a.get(d,2);g.encodeDoubleArray(l,c,3);e.set(k,0,c[0]);f.set(k,
0,c[1]);e.set(k,1,c[2]);f.set(k,1,c[3]);e.set(k,2,c[4]);f.set(k,2,c[5])};var l=new Float64Array(3),c=new Float32Array(6),a=d.mat4f64.create()})},"esri/views/3d/webgl-engine/lib/doublePrecisionUtils":function(){define(["require","exports"],function(u,f){function e(d,g,e){for(var f=0;f<e;++f)g[2*f]=d[f],g[2*f+1]=d[f]-g[2*f]}Object.defineProperty(f,"__esModule",{value:!0});f.encodeDouble=function(d,g){m[0]=d;m[1]=d-m[0];g[0]=m[0];g[1]=m[1]};f.encodeDoubleArray=e;f.decodeDoubleArray=function(d,g,e){for(var f=
0;f<e;++f)g[f]=d[2*f]+d[2*f+1]};f.encodeDoubleArraySplit=function(d,g,f,l){for(var c=0;c<l;++c)r[0]=d[c],e(r,m,1),g[c]=m[0],f[c]=m[1]};var r=new Float64Array(1),m=new Float32Array(2)})},"esri/views/3d/layers/graphics/sdfPrimitives":function(){define(["require","exports","../../../../core/compilerUtils","../../webgl-engine/lib/Util"],function(u,f,e,r){function m(a,b){var c=new Uint8Array(4*a*a),d=a/2-.5;b/=2;for(var g=0;g<a;g++)for(var e=0;e<a;e++){var f=e+a*g,k=e-d,l=g-d,k=Math.sqrt(k*k+l*l)-b,k=
k/a+.5;r.packFloatRGBA(k,c,4*f)}return c}function d(b,c){return a(b,c,!1)}function g(b,c){return a(b,c,!0)}function k(a,c){return b(a,c,!1)}function l(a,c){return b(a,c,!0)}function c(a,b){for(var c=new Uint8Array(4*a*a),d=Math.sqrt(1.25),g=(a-b)/2,e=0;e<a;e++)for(var f=0;f<a;f++){var k=(f-g)/b,l=(e-g+.75)/b;r.packFloatRGBA(Math.max(-(1*k+-.5*l)/d,(1*(k-1)+-.5*-l)/d,-l)*b/a+.5,c,4*(e*a+f))}return c}function a(a,b,c){c&&(b/=Math.SQRT2);for(var d=new Uint8Array(4*a*a),g=0;g<a;g++)for(var e=0;e<a;e++){var f=
e-.5*a+.25,k=-g+.5*a-.75,l=g*a+e;if(c)var q=(f+k)/Math.SQRT2,k=(k-f)/Math.SQRT2,f=q;f=Math.max(Math.abs(f),Math.abs(k))-.5*b;f=f/a+.5;r.packFloatRGBA(f,d,4*l)}return d}function b(a,b,c){c&&(b*=Math.SQRT2);b*=.5;for(var d=new Uint8Array(4*a*a),g=0;g<a;g++)for(var e=0;e<a;e++){var f=e-.5*a,k=-g+.5*a-1,l=g*a+e;if(c)var q=(f+k)/Math.SQRT2,k=(k-f)/Math.SQRT2,f=q;q=void 0;f=Math.abs(f);k=Math.abs(k);q=f>k?f>b?Math.sqrt((f-b)*(f-b)+k*k):k:k>b?Math.sqrt(f*f+(k-b)*(k-b)):f;q=q/a+.5;r.packFloatRGBA(q,d,4*l)}return d}
Object.defineProperty(f,"__esModule",{value:!0});f.createType=function(a,b,f){switch(a){case "circle":return m(b,f);case "square":return d(b,f);case "cross":return k(b,f);case "x":return l(b,f);case "kite":return g(b,f);case "triangle":return c(b,f);default:return e.neverReached(a),m(b,f)}};f.createCircle=m;f.createSquare=d;f.createKite=g;f.createCross=k;f.createX=l;f.createTriangle=c})},"esri/views/3d/layers/support/FastSymbolUpdates":function(){define("require exports ../../../../core/compilerUtils ../../../../core/mathUtils ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f64 ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../renderers/support/utils ../../support/debugFlags".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b){function q(a){return null!==a&&void 0!==a}function v(a){return"number"===typeof a}function t(a){return"string"===typeof a}function x(a,b){a&&a.push(b)}function z(b,c,d,g,e){var f=b.minSize,k=b.maxSize;if(b.expression)return x(e,"Could not convert size info: expression not supported"),!1;if(b.useSymbolValue)return b=g.symbolSize[d],c.minSize[d]=b,c.maxSize[d]=b,c.offset[d]=c.minSize[d],c.factor[d]=0,c.type[d]=1,!0;if(q(b.field)){if(q(b.stops)){if(2===b.stops.length&&
v(b.stops[0].size)&&v(b.stops[1].size))return A(b.stops[0].size,b.stops[1].size,b.stops[0].value,b.stops[1].value,c,d),c.type[d]=1,!0;x(e,"Could not convert size info: stops only supported with 2 elements");return!1}if(v(f)&&v(k)&&q(b.minDataValue)&&q(b.maxDataValue))return A(f,k,b.minDataValue,b.maxDataValue,c,d),c.type[d]=1,!0;if(null!=a.meterIn[b.valueUnit])return c.minSize[d]=-Infinity,c.maxSize[d]=Infinity,c.offset[d]=0,c.factor[d]=1/a.meterIn[b.valueUnit],c.type[d]=1,!0;if("unknown"===b.valueUnit)return x(e,
"Could not convert size info: proportional size not supported"),!1;x(e,"Could not convert size info: scale-dependent size not supported");return!1}if(!q(b.field)){if(b.stops&&b.stops[0]&&v(b.stops[0].size))return c.minSize[d]=b.stops[0].size,c.maxSize[d]=b.stops[0].size,c.offset[d]=c.minSize[d],c.factor[d]=0,c.type[d]=1,!0;if(v(f))return c.minSize[d]=f,c.maxSize[d]=f,c.offset[d]=f,c.factor[d]=0,c.type[d]=1,!0}x(e,"Could not convert size info: unsupported variant of sizeInfo");return!1}function A(a,
b,c,d,g,e){d=0<Math.abs(d-c)?(b-a)/(d-c):0;g.minSize[e]=0<d?a:b;g.maxSize[e]=0<d?b:a;g.offset[e]=a-c*d;g.factor[e]=d}function E(a,b,c,d){if(a.normalizationField||a.valueRepresentation)return x(d,"Could not convert size info: unsupported property"),null;var g=a.field;if(null!=g&&!t(g))return x(d,"Could not convert size info: field is not a string"),null;if(!b.size)b.size={field:a.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[0,0,0]};else if(a.field)if(!b.size.field)b.size.field=
a.field;else if(a.field!==b.size.field)return x(d,"Could not convert size info: multiple fields in use"),null;switch(a.axis){case "width":return(g=z(a,b.size,0,c,d))?b:null;case "height":return(g=z(a,b.size,2,c,d))?b:null;case "depth":return(g=z(a,b.size,1,c,d))?b:null;case "width-and-depth":return(g=z(a,b.size,0,c,d))&&z(a,b.size,1,c,d),g?b:null;case null:case void 0:case "all":return(g=(g=(g=z(a,b.size,0,c,d))&&z(a,b.size,1,c,d))&&z(a,b.size,2,c,d))?b:null;default:return x(d,'Could not convert size info: unknown axis "'+
a.axis+'""'),null}}function H(a,b,c){for(var d=0;3>d;++d){var g=b.unitInMeters;1===a.type[d]&&(g*=b.modelSize[d],a.type[d]=2);a.minSize[d]/=g;a.maxSize[d]/=g;a.offset[d]/=g;a.factor[d]/=g}if(0!==a.type[0])b=0;else if(0!==a.type[1])b=1;else if(0!==a.type[2])b=2;else return x(c,"No size axis contains a valid size or scale"),!1;for(d=0;3>d;++d)0===a.type[d]&&(a.minSize[d]=a.minSize[b],a.maxSize[d]=a.maxSize[b],a.offset[d]=a.offset[b],a.factor[d]=a.factor[b],a.type[d]=a.type[b]);return!0}function J(a,
b,c){a[4*b+0]=c.r/255;a[4*b+1]=c.g/255;a[4*b+2]=c.b/255;a[4*b+3]=c.a}function B(a,b,c){if(a.normalizationField)return x(c,"Could not convert color info: unsupported property"),null;if(t(a.field))if(a.stops){if(8<a.stops.length)return x(c,"Could not convert color info: too many color stops"),null;b.color={field:a.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};c=a.stops;for(a=0;8>a;++a){var d=c[Math.min(a,c.length-1)];b.color.values[a]=d.value;
J(b.color.colors,a,d.color)}}else return x(c,"Could not convert color info: missing stops or colors"),null;else if(a.stops&&0<=a.stops.length)for(c=a.stops&&0<=a.stops.length&&a.stops[0].color,b.color={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},a=0;8>a;a++)b.color.values[a]=Infinity,J(b.color.colors,a,c);else return x(c,"Could not convert color info: no field and no colors/stops"),null;return b}function G(a,b,c){if(a.normalizationField)return x(c,
"Could not convert opacity info: unsupported property"),null;if(t(a.field))if(a.stops){if(8<a.stops.length)return x(c,"Could not convert opacity info: too many opacity stops"),null;b.opacity={field:a.field,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};c=a.stops;for(a=0;8>a;++a){var d=c[Math.min(a,c.length-1)];b.opacity.values[a]=d.value;b.opacity.opacityValues[a]=d.opacity}}else return x(c,"Could not convert opacity info: missing stops or opacities"),null;else if(a.stops&&0<=a.stops.length)for(c=
a.stops&&0<=a.stops.length&&a.stops[0].opacity,b.opacity={field:null,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]},a=0;8>a;a++)b.opacity.values[a]=Infinity,b.opacity.opacityValues[a]=c;else return x(c,"Could not convert opacity info: no field and no opacities/stops"),null;return b}function F(a,b,c){a=2===c&&"arithmetic"===a.rotationType;b.offset[c]=a?90:0;b.factor[c]=a?-1:1;b.type[c]=1}function M(a,b,c){if(!t(a.field))return x(c,"Could not convert rotation info: field is not a string"),
null;if(!b.rotation)b.rotation={field:a.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};else if(a.field)if(!b.rotation.field)b.rotation.field=a.field;else if(a.field!==b.rotation.field)return x(c,"Could not convert rotation info: multiple fields in use"),null;switch(a.axis){case "tilt":return F(a,b.rotation,0),b;case "roll":return F(a,b.rotation,1),b;case null:case void 0:case "heading":return F(a,b.rotation,2),b;default:return x(c,'Could not convert rotation info: unknown axis "'+a.axis+'""'),
null}}function R(a,b,c){if(!a)return null;var d=!b.supportedTypes||!!b.supportedTypes.size,g=!b.supportedTypes||!!b.supportedTypes.color,f=!b.supportedTypes||!!b.supportedTypes.rotation,k=!!b.supportedTypes&&!!b.supportedTypes.opacity,l=a.reduce(function(a,l){if(!a)return a;if(l.valueExpression)return x(c,"Could not convert visual variables: arcade expressions not supported"),null;switch(l.type){case "size":return d?E(l,a,b,c):a;case "color":return g?B(l,a,c):a;case "opacity":return k?G(l,a,c):null;
case "rotation":return f?M(l,a,c):a;default:return e.neverReached(l),null}},{size:null,color:null,opacity:null,rotation:null});return 0<a.length&&l&&!l.size&&!l.color&&!l.opacity&&!l.rotation||l&&l.size&&!H(l.size,b,c)?null:l}function T(a,b,c){if(!!a!==!!b||a&&a.field!==b.field)return!1;if(a&&"rotation"===c)for(c=0;3>c;c++)if(a.type[c]!==b.type[c]||a.offset[c]!==b.offset[c]||a.factor[c]!==b.factor[c])return!1;return!0}function O(a,b){var c={vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,vvSizeOffset:null,
vvSizeFactor:null,vvSizeValue:null,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null,vvOpacityEnabled:!1,vvOpacityValues:null,vvOpacityOpacities:null,vvSymbolAnchor:null,vvSymbolRotationMatrix:null},e=a&&null!=a.size;a&&a.size?(c.vvSizeEnabled=!0,c.vvSizeMinSize=a.size.minSize,c.vvSizeMaxSize=a.size.maxSize,c.vvSizeOffset=a.size.offset,c.vvSizeFactor=a.size.factor):a&&e&&(c.vvSizeValue=b.transformation.scale);if(a&&e){c.vvSymbolAnchor=b.transformation.anchor;c.vvSymbolRotationMatrix=d.mat3f64.create();
g.mat4.identity(Q);var f=b.transformation.rotation[2],e=b.transformation.rotation[0],l=b.transformation.rotation[1];b=Q;void 0===b&&(b=k.mat4f64.create());f=f||0;e=e||0;l=l||0;0!==f&&g.mat4.rotateZ(b,b,-f/180*Math.PI);0!==e&&g.mat4.rotateX(b,b,e/180*Math.PI);0!==l&&g.mat4.rotateY(b,b,l/180*Math.PI);m.mat3.fromMat4(c.vvSymbolRotationMatrix,Q)}a&&a.color&&(c.vvColorEnabled=!0,c.vvColorValues=a.color.values,c.vvColorColors=a.color.colors);a&&a.opacity&&(c.vvOpacityEnabled=!0,c.vvOpacityValues=a.opacity.values,
c.vvOpacityOpacities=a.opacity.opacityValues);return c}Object.defineProperty(f,"__esModule",{value:!0});f.convertVisualVariables=R;f.initFastSymbolUpdatesState=function(a,c){return!a||b.DISABLE_FAST_UPDATES?{enabled:!1}:(a=R(a.visualVariables,c))?{enabled:!0,visualVariables:a,materialParameters:O(a,c),requiresShaderTransformation:a&&null!=a.size}:{enabled:!1}};f.updateFastSymbolUpdatesState=function(a,b,c){if(!b||!a.enabled)return!1;var d=a.visualVariables;b=R(b.visualVariables,c);if(!(b&&T(d.size,
b.size,"size")&&T(d.color,b.color,"color")&&T(d.rotation,b.rotation,"rotation")&&T(d.opacity,b.opacity,"opacity")))return!1;a.visualVariables=b;a.materialParameters=O(b,c);a.requiresShaderTransformation=b&&null!=b.size;return!0};f.getMaterialParams=O;var L;(function(a){var b=k.mat4f64.create(),d=c.vec3f64.create();a.evaluateModelTransform=function(a,c,e){if(!a.vvSizeEnabled)return e;g.mat4.copy(b,e);e=a.vvSymbolRotationMatrix;g.mat4.set(Q,e[0],e[1],e[2],0,e[3],e[4],e[5],0,e[6],e[7],e[8],0,0,0,0,1);
g.mat4.multiply(b,b,Q);for(e=0;3>e;++e)d[e]=r.clamp(a.vvSizeOffset[e]+c[0]*a.vvSizeFactor[e],a.vvSizeMinSize[e],a.vvSizeMaxSize[e]);g.mat4.scale(b,b,d);g.mat4.translate(b,b,a.vvSymbolAnchor);return b};a.evaluateModelTransformScale=function(a,b,c){if(!b.vvSizeEnabled)return l.vec3.set(a,1,1,1);for(var d=0;3>d;++d)a[d]=r.clamp(b.vvSizeOffset[d]+c[0]*b.vvSizeFactor[d],b.vvSizeMinSize[d],b.vvSizeMaxSize[d]);return a}})(L||(L={}));var Q=k.mat4f64.create();f.evaluateModelTransform=L.evaluateModelTransform;
f.evaluateModelTransformScale=L.evaluateModelTransformScale})},"esri/core/libs/gl-matrix-2/mat3":function(){define(["require","exports","./math/mat3"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.mat3=e})},"esri/core/libs/gl-matrix-2/math/mat3":function(){define(["require","exports","./common"],function(u,f,e){function r(d,g,e){var f=g[0],c=g[1],a=g[2],b=g[3],k=g[4],m=g[5],t=g[6],r=g[7];g=g[8];var z=e[0],A=e[1],E=e[2],H=e[3],u=e[4],B=e[5],G=e[6],F=e[7];e=e[8];d[0]=z*f+A*b+E*
t;d[1]=z*c+A*k+E*r;d[2]=z*a+A*m+E*g;d[3]=H*f+u*b+B*t;d[4]=H*c+u*k+B*r;d[5]=H*a+u*m+B*g;d[6]=G*f+F*b+e*t;d[7]=G*c+F*k+e*r;d[8]=G*a+F*m+e*g;return d}function m(d,g,e){d[0]=g[0]-e[0];d[1]=g[1]-e[1];d[2]=g[2]-e[2];d[3]=g[3]-e[3];d[4]=g[4]-e[4];d[5]=g[5]-e[5];d[6]=g[6]-e[6];d[7]=g[7]-e[7];d[8]=g[8]-e[8];return d}Object.defineProperty(f,"__esModule",{value:!0});f.fromMat4=function(d,g){d[0]=g[0];d[1]=g[1];d[2]=g[2];d[3]=g[4];d[4]=g[5];d[5]=g[6];d[6]=g[8];d[7]=g[9];d[8]=g[10];return d};f.copy=function(d,
g){d[0]=g[0];d[1]=g[1];d[2]=g[2];d[3]=g[3];d[4]=g[4];d[5]=g[5];d[6]=g[6];d[7]=g[7];d[8]=g[8];return d};f.set=function(d,g,e,f,c,a,b,q,m,t){d[0]=g;d[1]=e;d[2]=f;d[3]=c;d[4]=a;d[5]=b;d[6]=q;d[7]=m;d[8]=t;return d};f.identity=function(d){d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=1;d[5]=0;d[6]=0;d[7]=0;d[8]=1;return d};f.transpose=function(d,g){if(d===g){var e=g[1],f=g[2],c=g[5];d[1]=g[3];d[2]=g[6];d[3]=e;d[5]=g[7];d[6]=f;d[7]=c}else d[0]=g[0],d[1]=g[3],d[2]=g[6],d[3]=g[1],d[4]=g[4],d[5]=g[7],d[6]=g[2],d[7]=g[5],
d[8]=g[8];return d};f.invert=function(d,g){var e=g[0],f=g[1],c=g[2],a=g[3],b=g[4],q=g[5],m=g[6],t=g[7];g=g[8];var r=g*b-q*t,z=-g*a+q*m,A=t*a-b*m,E=e*r+f*z+c*A;if(!E)return null;E=1/E;d[0]=r*E;d[1]=(-g*f+c*t)*E;d[2]=(q*f-c*b)*E;d[3]=z*E;d[4]=(g*e-c*m)*E;d[5]=(-q*e+c*a)*E;d[6]=A*E;d[7]=(-t*e+f*m)*E;d[8]=(b*e-f*a)*E;return d};f.adjoint=function(d,g){var e=g[0],f=g[1],c=g[2],a=g[3],b=g[4],q=g[5],m=g[6],t=g[7];g=g[8];d[0]=b*g-q*t;d[1]=c*t-f*g;d[2]=f*q-c*b;d[3]=q*m-a*g;d[4]=e*g-c*m;d[5]=c*a-e*q;d[6]=a*
t-b*m;d[7]=f*m-e*t;d[8]=e*b-f*a;return d};f.determinant=function(d){var g=d[3],e=d[4],f=d[5],c=d[6],a=d[7],b=d[8];return d[0]*(b*e-f*a)+d[1]*(-b*g+f*c)+d[2]*(a*g-e*c)};f.multiply=r;f.translate=function(d,g,e){var f=g[0],c=g[1],a=g[2],b=g[3],k=g[4],m=g[5],t=g[6],r=g[7];g=g[8];var z=e[0];e=e[1];d[0]=f;d[1]=c;d[2]=a;d[3]=b;d[4]=k;d[5]=m;d[6]=z*f+e*b+t;d[7]=z*c+e*k+r;d[8]=z*a+e*m+g;return d};f.rotate=function(d,g,e){var f=g[0],c=g[1],a=g[2],b=g[3],k=g[4],m=g[5],t=g[6],r=g[7];g=g[8];var z=Math.sin(e);
e=Math.cos(e);d[0]=e*f+z*b;d[1]=e*c+z*k;d[2]=e*a+z*m;d[3]=e*b-z*f;d[4]=e*k-z*c;d[5]=e*m-z*a;d[6]=t;d[7]=r;d[8]=g;return d};f.scale=function(d,g,e){var f=e[0],c=e[1];e=e[2];d[0]=f*g[0];d[1]=f*g[1];d[2]=f*g[2];d[3]=c*g[3];d[4]=c*g[4];d[5]=c*g[5];d[6]=e*g[6];d[7]=e*g[7];d[8]=e*g[8];return d};f.scaleByVec2=function(d,g,e){var f=e[0];e=e[1];d[0]=f*g[0];d[1]=f*g[1];d[2]=f*g[2];d[3]=e*g[3];d[4]=e*g[4];d[5]=e*g[5];return d};f.fromTranslation=function(d,g){d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=1;d[5]=0;d[6]=g[0];
d[7]=g[1];d[8]=1;return d};f.fromRotation=function(d,g){var e=Math.sin(g);g=Math.cos(g);d[0]=g;d[1]=e;d[2]=0;d[3]=-e;d[4]=g;d[5]=0;d[6]=0;d[7]=0;d[8]=1;return d};f.fromScaling=function(d,g){d[0]=g[0];d[1]=0;d[2]=0;d[3]=0;d[4]=g[1];d[5]=0;d[6]=0;d[7]=0;d[8]=1;return d};f.fromMat2d=function(d,g){d[0]=g[0];d[1]=g[1];d[2]=0;d[3]=g[2];d[4]=g[3];d[5]=0;d[6]=g[4];d[7]=g[5];d[8]=1;return d};f.fromQuat=function(d,g){var e=g[0],f=g[1],c=g[2];g=g[3];var a=e+e,b=f+f,q=c+c,e=e*a,m=f*a,f=f*b,t=c*a,r=c*b,c=c*q,
a=g*a,b=g*b;g*=q;d[0]=1-f-c;d[3]=m-g;d[6]=t+b;d[1]=m+g;d[4]=1-e-c;d[7]=r-a;d[2]=t-b;d[5]=r+a;d[8]=1-e-f;return d};f.normalFromMat4Legacy=function(d,g){var e=g[0],f=g[1],c=g[2],a=g[4],b=g[5],q=g[6],m=g[8],t=g[9];g=g[10];var r=g*b-q*t,z=-g*a+q*m,A=t*a-b*m,E=e*r+f*z+c*A;if(!E)return null;E=1/E;d[0]=r*E;d[1]=(-g*f+c*t)*E;d[2]=(q*f-c*b)*E;d[3]=z*E;d[4]=(g*e-c*m)*E;d[5]=(-q*e+c*a)*E;d[6]=A*E;d[7]=(-t*e+f*m)*E;d[8]=(b*e-f*a)*E;return d};f.normalFromMat4=function(d,g){var e=g[0],f=g[1],c=g[2],a=g[3],b=g[4],
q=g[5],m=g[6],t=g[7],r=g[8],z=g[9],A=g[10],E=g[11],H=g[12],u=g[13],B=g[14];g=g[15];var G=e*q-f*b,F=e*m-c*b,M=e*t-a*b,R=f*m-c*q,T=f*t-a*q,O=c*t-a*m,L=r*u-z*H,Q=r*B-A*H,r=r*g-E*H,S=z*B-A*u,z=z*g-E*u,A=A*g-E*B,E=G*A-F*z+M*S+R*r-T*Q+O*L;if(!E)return null;E=1/E;d[0]=(q*A-m*z+t*S)*E;d[1]=(m*r-b*A-t*Q)*E;d[2]=(b*z-q*r+t*L)*E;d[3]=(c*z-f*A-a*S)*E;d[4]=(e*A-c*r+a*Q)*E;d[5]=(f*r-e*z-a*L)*E;d[6]=(u*O-B*T+g*R)*E;d[7]=(B*M-H*O-g*F)*E;d[8]=(H*T-u*M+g*G)*E;return d};f.projection=function(d,g,e){d[0]=2/g;d[1]=0;
d[2]=0;d[3]=0;d[4]=-2/e;d[5]=0;d[6]=-1;d[7]=1;d[8]=1;return d};f.str=function(d){return"mat3("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+", "+d[6]+", "+d[7]+", "+d[8]+")"};f.frob=function(d){return Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)+Math.pow(d[2],2)+Math.pow(d[3],2)+Math.pow(d[4],2)+Math.pow(d[5],2)+Math.pow(d[6],2)+Math.pow(d[7],2)+Math.pow(d[8],2))};f.add=function(d,g,e){d[0]=g[0]+e[0];d[1]=g[1]+e[1];d[2]=g[2]+e[2];d[3]=g[3]+e[3];d[4]=g[4]+e[4];d[5]=g[5]+e[5];d[6]=g[6]+e[6];
d[7]=g[7]+e[7];d[8]=g[8]+e[8];return d};f.subtract=m;f.multiplyScalar=function(d,g,e){d[0]=g[0]*e;d[1]=g[1]*e;d[2]=g[2]*e;d[3]=g[3]*e;d[4]=g[4]*e;d[5]=g[5]*e;d[6]=g[6]*e;d[7]=g[7]*e;d[8]=g[8]*e;return d};f.multiplyScalarAndAdd=function(d,g,e,f){d[0]=g[0]+e[0]*f;d[1]=g[1]+e[1]*f;d[2]=g[2]+e[2]*f;d[3]=g[3]+e[3]*f;d[4]=g[4]+e[4]*f;d[5]=g[5]+e[5]*f;d[6]=g[6]+e[6]*f;d[7]=g[7]+e[7]*f;d[8]=g[8]+e[8]*f;return d};f.exactEquals=function(d,g){return d[0]===g[0]&&d[1]===g[1]&&d[2]===g[2]&&d[3]===g[3]&&d[4]===
g[4]&&d[5]===g[5]&&d[6]===g[6]&&d[7]===g[7]&&d[8]===g[8]};f.equals=function(d,g){var f=d[0],l=d[1],c=d[2],a=d[3],b=d[4],q=d[5],m=d[6],t=d[7];d=d[8];var r=g[0],z=g[1],A=g[2],E=g[3],H=g[4],u=g[5],B=g[6],G=g[7];g=g[8];return Math.abs(f-r)<=e.EPSILON*Math.max(1,Math.abs(f),Math.abs(r))&&Math.abs(l-z)<=e.EPSILON*Math.max(1,Math.abs(l),Math.abs(z))&&Math.abs(c-A)<=e.EPSILON*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(a-E)<=e.EPSILON*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(b-H)<=e.EPSILON*Math.max(1,
Math.abs(b),Math.abs(H))&&Math.abs(q-u)<=e.EPSILON*Math.max(1,Math.abs(q),Math.abs(u))&&Math.abs(m-B)<=e.EPSILON*Math.max(1,Math.abs(m),Math.abs(B))&&Math.abs(t-G)<=e.EPSILON*Math.max(1,Math.abs(t),Math.abs(G))&&Math.abs(d-g)<=e.EPSILON*Math.max(1,Math.abs(d),Math.abs(g))};f.mul=r;f.sub=m})},"esri/views/3d/terrain/OverlayRenderer":function(){define("require exports tslib ../../../core/Accessor ../../../core/Handles ../../../core/Logger ../../../core/MapUtils ../../../core/maybe ../../../core/PooledArray ../../../core/SetUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators ../../../core/libs/gl-matrix-2/mat4 ../../../core/libs/gl-matrix-2/vec3f64 ../support/debugFlags ../webgl-engine/core/shaderTechnique/CommonUniformStore ../webgl-engine/core/shaderTechnique/ShaderTechniqueRepository ../webgl-engine/lib/AutoDisposable ../webgl-engine/lib/Camera ../webgl-engine/lib/GLMaterialRep ../webgl-engine/lib/glUtil3D ../webgl-engine/lib/GridLocalOriginFactory ../webgl-engine/lib/intersectorUtils ../webgl-engine/lib/RenderContext ../webgl-engine/lib/renderStats ../webgl-engine/lib/SortedRenderGeometryRenderer ../webgl-engine/lib/TextureTechnique ../webgl-engine/lighting/Lightsources ../webgl-engine/lighting/SceneLighting ../webgl-engine/materials/lineStippleUtils ../../webgl/FramebufferObject ../../webgl/Texture ../../webgl/Util".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A,E,H,J,B,G,F,M,R,T,O,L,Q,S,aa,ba){Object.defineProperty(f,"__esModule",{value:!0});var V=d.getLogger("esri.views.3d.webgl-engine.lib.OverlayRenderer");u=function(d){function r(){var a=null!==d&&d.apply(this,arguments)||this;a._hasHighlights=!1;a._rendersOccluded=!1;a._hasWater=!1;a._lighting=new L.SceneLighting;a._localOrigins=new B;a._handles=new m;a._layerRenderers=new Map;a._sortedLayerRenderersDirty=!1;a._sortedLayerRenderers=new l;a._stats=new M.RenderStatsAggregator;
a._geometries=new Map;a._renderTargets={};a._uniqueIdx=0;a.longitudeCyclical=null;return a}e.__extends(r,d);r.prototype.initialize=function(){var b=this;this._rctx=this.renderView.renderingContext;this._renderContext=new F(this._rctx,null,null,null,null,null);this._stippleTextureRepository=new Q.StippleTextureRepository;this.waterTextureRepository=this.renderView.waterTextureRepository;this._shaderTechniqueRepository=new z.ShaderTechniqueRepository({rctx:this._rctx,viewingMode:1,commonUniformStore:new x.CommonUniformStore,
stippleTextureRepository:this._stippleTextureRepository,waterTextureRepository:this.waterTextureRepository});a.init(this.waterTextureRepository,"loadingState",function(){return b.emitContentChanged()});this._materialRepository=new H(this.renderView.textureRepository,this._shaderTechniqueRepository);this._materialRepository.onMaterialChanged=function(a){0<(a.renderOccluded&f.overlayRenderOccludedFlag)!==b._rendersOccluded&&b.updateRendersOccluded();b.emitContentChanged();b.notifyChange("updating")};
this._compositingHelper=this.renderView.compositingHelper;this._bindParameters={slot:null,fovY:0,highlightDepthTexture:J.createEmptyDepthTexture(this._rctx),nearFar:[X.near,X.far],origin:null,pixelRatio:null,proj:null,shadowMappingEnabled:!1,slicePlane:null,ssaoEnabled:!1,view:null,viewInvTransp:null,viewport:null,hasOccludees:!1,linearDepthTexture:null,linearDepthTextureID:0,lastFrameColorTexture:null,lastFrameColorTextureID:0,reprojectionMat:null,ssrViewMat:null,rpProjectionMat:null,ssrEnabled:!1};
this._lighting.set({lights:[new O.AmbientLight(v.vec3f64.fromValues(1,1,1))],groundLightingFactor:1,globalFactor:0})};r.prototype.dispose=function(){this._handles.destroy();this._layerRenderers.forEach(function(a){return a.dispose()});this._layerRenderers.clear();for(var a in this._renderTargets)this._renderTargets[a].dispose();this._renderTargets=null;this._bindParameters.highlightDepthTexture.dispose();this._bindParameters.highlightDepthTexture=null;this._shaderTechniqueRepository.dispose();this._shaderTechniqueRepository=
null};r.prototype.disposeRenderTarget=function(a){var b=this._renderTargets[a];b&&b.dispose();delete this._renderTargets[a]};Object.defineProperty(r.prototype,"updating",{get:function(){return this._sortedLayerRenderersDirty||g.someMap(this._layerRenderers,function(a){return a.updating})||this.waterTextureRepository.updating},enumerable:!0,configurable:!0});r.prototype.commitChanges=function(){var a=this,b=!1;this._layerRenderers.forEach(function(c,d){c.commitChanges()&&(b=!0);c.isEmpty&&(a._layerRenderers.delete(d),
a._sortedLayerRenderersDirty=!0,a._handles.remove(d))});this._sortedLayerRenderersDirty&&(this.updateSortedLayerRenderers(),b=!0);this.notifyChange("updating");b&&(this.emitContentChanged(),this.updateHasHighlights(),this.updateRendersOccluded(),this.updateHasWater())};r.prototype.getRenderTargetTexture=function(a){return(a=this._renderTargets[a])?a.colorTexture:null};r.prototype.addGeometries=function(a,b,c){for(var d=0;d<a.length;d++){var g=a[d];null==g.origin&&(g.origin=this._localOrigins.getOrigin(g.center));
g.uniqueName||(g.uniqueName="ov:"+this._uniqueIdx++);this._geometries.set(g.uniqueName,g)}this.ensureLayerRenderer(b).add(a);2===c&&this.notifyGraphicUpdate(a,b,2)};r.prototype.removeGeometries=function(a,b,c){for(var d=0;d<a.length;d++)this._geometries.delete(a[d].uniqueName);(d=this._layerRenderers.get(b))?(d.remove(a),2===c&&this.notifyGraphicUpdate(a,b,2)):V.warn("Attempted to remove geometry for nonexistent layer")};r.prototype.updateGeometries=function(a,b,c){var d=this._layerRenderers.get(b);
d?(d.modify(a,c),this.notifyUpdateGeometries(a,b,c)):V.warn("Attempted to update geometry for nonexistent layer")};r.prototype.notifyUpdateGeometries=function(a,b,c){this.notifyGraphicUpdate(a,b,4===c||2===c?2:1===c?1:0)};r.prototype.notifyGraphicUpdate=function(a,b,c){if(0!==c)for(var d=-1,g=0;g<a.length;g++){var e=a[g].data.graphicUid;e!==d&&(b.notifyGraphicUpdate(e,c),d=e)}};r.prototype.updateHighlights=function(a,b){(b=this._layerRenderers.get(b))?b.modify(a,8):V.warn("Attempted to update highlights for nonexistent layer")};
r.prototype.isEmpty=function(){return 0===this._geometries.size&&!t.OVERLAY_DRAW_DEBUG_TEXTURE};Object.defineProperty(r.prototype,"hasHighlights",{get:function(){return this._hasHighlights},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"hasWater",{get:function(){return this._hasWater},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"rendersOccluded",{get:function(){return this._rendersOccluded},enumerable:!0,configurable:!0});r.prototype.updateLogic=function(a){var b=
!1;this._layerRenderers.forEach(function(c){c.updateLogic(a)&&(b=!0)});return b};r.prototype.updateLayerOrder=function(){this._sortedLayerRenderersDirty=!0};r.prototype.draw=function(a,b){return this.drawPass(0,a,b)};r.prototype.drawWithoutRasterImage=function(a,b){return this.drawPass(0,a,b,2)};r.prototype.drawNormals=function(a,b){return this.drawPass(2,a,b)};r.prototype.drawHighlights=function(a,b){return this.drawPass(4,a,b)};r.prototype.drawOccluded=function(a,b){return this.drawPass(0,a,b,1)};
r.prototype.drawPass=function(a,b,c,d){var g=this;void 0===d&&(d=0);if(0===c.numViews)return!1;this._pixelRatio=c.pixelRatio*Math.abs(c.views[0].extent[2]-c.views[0].extent[0])/Math.abs(c.views[0].viewport[2]-c.views[0].viewport[0]);if(this.isEmpty()||4===a&&!this.hasHighlights||2===a&&!this.hasWater||!this.hasNonZeroSizedView(c))return!1;var e=c.width,l=c.height,q=this._renderTargets[b];if(!q)return!1;q.resize(e,l);var m=this._rctx,r=X;r.pixelRatio=c.pixelRatio||1;this._renderContext.pass=a;this._bindParameters.pixelRatio=
r.pixelRatio;m.bindFramebuffer(q);m.setClearColor(0,0,0,0);m.clearSafe(16384);this.updateLightingUniforms();1===d&&(this._renderContext.renderOccludedMask=f.overlayRenderOccludedFlag);if(t.OVERLAY_DRAW_DEBUG_TEXTURE&&1!==d)for(b=0;b<c.numViews;b++)this.setViewParameters(c.views[b],r),this.drawDebugTexture(e,l,ha[c.index%ha.length]);0<this._layerRenderers.size&&this._sortedLayerRenderers.forEach(function(b){var f=b.layerView;b=b.renderer;if(2!==d||!k.isSome(f)||0!==f.drapeSourceType){var t=k.isSome(f)&&
k.isSome(f.fullOpacity)&&1>f.fullOpacity&&0===a;t&&(g.bindTemporaryFramebuffer(e,l),m.clearSafe(16384));for(var v=0;v<c.numViews;v++)g.setViewParameters(c.views[v],r),b.draw(g._renderContext,g._bindParameters,g._stats);t&&(m.bindFramebuffer(q),g._compositingHelper.composite(g.temporaryTexture,2,k.unwrap(k.unwrap(f).fullOpacity)))}});m.bindFramebuffer(null);q.colorTexture.descriptor.hasMipmap&&q.colorTexture.generateMipmap();this._renderContext.resetRenderOccludedMask();return!0};r.prototype.createRenderTarget=
function(a,b){for(var c=a,d=0;this._renderTargets[c];)c=a+"_"+ ++d;this._renderTargets[c]=new S(this._rctx,{colorTarget:0,depthStencilTarget:0},{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9987,hasMipmap:b,maxAnisotropy:8,width:0,height:0});return c};r.prototype.disposeRenderTargetMemory=function(a){(a=this._renderTargets[a])&&a.resize(0,0)};r.prototype.bindTemporaryFramebuffer=function(a,b){k.isNone(this._temporaryRenderTargetId)&&(this._temporaryRenderTargetId=this.createRenderTarget("temp",
!1));var c=this._renderTargets[this._temporaryRenderTargetId];c.resize(a,b);this._rctx.bindFramebuffer(c)};Object.defineProperty(r.prototype,"temporaryTexture",{get:function(){return this._renderTargets[k.unwrap(this._temporaryRenderTargetId)].colorTexture},enumerable:!0,configurable:!0});r.prototype.getGpuMemoryUsage=function(){var a=0,b;for(b in this._renderTargets)a+=ba.getGpuMemoryUsage(this._renderTargets[b]);return a};r.prototype.getStats=function(){return this._stats.getAggregatedStats()};
r.prototype.hotReloadShaders=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(a){switch(a.label){case 0:return[4,this._shaderTechniqueRepository.hotReload()];case 1:return a.sent(),[2]}})})};r.prototype.intersect=function(a,b,c){var d=this,g=0;this._geometries.forEach(function(e){if(!c||c(e)){d.intersectRenderGeometry(e,b,0,a,g);var f=d.longitudeCyclical;f&&(e.center[0]-e.bsRadius<f.min&&d.intersectRenderGeometry(e,b,f.range,a,g),e.center[0]+e.bsRadius>
f.max&&d.intersectRenderGeometry(e,b,-f.range,a,g));g++}})};r.prototype.intersectRenderGeometry=function(a,b,c,d,g){var e=this,f=0;k.isSome(a.transformation)&&(c+=a.transformation[12],f=a.transformation[13]);ea[0]=b[0]-c;ea[1]=b[1]-f;ea[2]=1;ga[0]=b[0]-c;ga[1]=b[1]-f;ga[2]=0;a.pixelRatio=this._pixelRatio;a.material.intersect(a,null,a.getShaderTransformation(),d,ea,ga,function(b,c,f){e.addIntersectionResult(f,a.material.renderPriority,g,d,a.data.layerUid,a.data.graphicUid)},a.calculateShaderTransformation,
!0)};r.prototype.addIntersectionResult=function(a,b,c,d,g,e){var f={type:"external",metadata:{layerUid:g,graphicUid:e}};g=function(g){g.set(f,null,d.results.ground.dist,d.results.ground.normal,d.results.ground.transformation,b,null,null,a,c);g.intersector="OverlayRenderer"};(null==d.results.min.drapedLayerOrder||b>=d.results.min.drapedLayerOrder)&&(null==d.results.min.dist||d.results.ground.dist<=d.results.min.dist)&&g(d.results.min);0!==d.options.store&&(null==d.results.max.drapedLayerOrder||b<d.results.max.drapedLayerOrder)&&
(null==d.results.max.dist||d.results.ground.dist>d.results.max.dist)&&g(d.results.max);2===d.options.store&&(e=new G.IntersectorResult(d.ray),g(e),d.results.all.push(e))};r.prototype.stopAnimationsAtTime=function(a){this._sortedLayerRenderers.forEach(function(b){return b.renderer.stopAnimationsAtTime(a)})};r.prototype.ensureLayerRenderer=function(b){var c=this,d=this._layerRenderers.get(b);d||(d=new R.SortedRenderGeometryRenderer({rctx:this._rctx,materialRepository:this._materialRepository}),this._layerRenderers.set(b,
d),this._sortedLayerRenderersDirty=!0,this._handles.add([b.watch("fullOpacity",function(){return c.emitContentChanged()}),a.init(d,"updating",function(){return c.notifyChange("updating")})],b));return d};r.prototype.updateSortedLayerRenderers=function(){var a=this;if(this._sortedLayerRenderersDirty&&(this._sortedLayerRenderersDirty=!1,this._sortedLayerRenderers.clear(),0!==this._layerRenderers.size)){var b=g.firstKeyOfMap(this._layerRenderers).view.allLayerViews,d=c.SetFromValues(g.valuesOfMap(this._layerRenderers));
b.forEach(function(b){var c=a._layerRenderers.get(b);c&&(a._sortedLayerRenderers.push(new Z(b,c)),d.delete(c))});d.forEach(function(b){a._sortedLayerRenderers.push(new Z(null,b))})}};r.prototype.setViewParameters=function(a,b){b.viewport=a.viewport;var c=a.extent;q.mat4.ortho(b.projectionMatrix,0,c[2]-c[0],0,c[3]-c[1],b.near,b.far);q.mat4.identity(b.viewMatrix);q.mat4.translate(b.viewMatrix,b.viewMatrix,[-a.extent[0],-a.extent[1],0]);b.setGLViewport(this._rctx);this._renderContext.camera=b;this._bindParameters.view=
b.viewMatrix;this._bindParameters.proj=b.projectionMatrix;this._bindParameters.viewInvTransp=b.viewInverseTransposeMatrix;this._bindParameters.viewport=b.fullViewport;this._shaderTechniqueRepository.getProgramsUsingUniform("proj").forEach(function(a){a.setUniformMatrix4fv("proj",b.projectionMatrix)})};r.prototype.updateLightingUniforms=function(){var a=this;this._shaderTechniqueRepository.getProgramsUsingUniform("lightingMainDirection").forEach(function(b){a._lighting.setUniforms(b)})};r.prototype.hasNonZeroSizedView=
function(a){for(var b=0;b<a.numViews;b++){var c=a.views[b];if(c.extent[0]!==c.extent[2]&&c.extent[1]!==c.extent[3])return!0}return!1};r.prototype.emitContentChanged=function(){if(this.onContentChanged)this.onContentChanged()};r.prototype.updateHasWater=function(){var a=g.someMap(this._layerRenderers,function(a){return a.hasWater});a!==this._hasWater&&(this._hasWater=a)};r.prototype.updateHasHighlights=function(){var a=g.someMap(this._layerRenderers,function(a){return a.hasHighlights});if(a!==this._hasHighlights&&
(this._hasHighlights=a,this.onHasHighlightsChanged))this.onHasHighlightsChanged(this._hasHighlights)};r.prototype.updateRendersOccluded=function(){var a=g.someMap(this._layerRenderers,function(a){return a.rendersOccluded});if(a!==this._rendersOccluded&&(this._rendersOccluded=a,this.onRendersOccludedChanged))this.onRendersOccludedChanged(this.rendersOccluded)};r.prototype.drawDebugTexture=function(a,b,c){var d=this._rctx;this.ensureDebugPatternResources(a,b);a=this._debugPatternProgram;d.bindProgram(a);
d.setPipelineState(this._debugPatternPipelineState);a.setUniform4f("color",c[0],c[1],c[2],1);a.setUniform1i("tex",0);d.bindTexture(this._debugPatternTexture,0);d.bindVAO(this._quadVAO);d.drawArrays(5,0,ba.vertexCount(this._quadVAO,"geometry"))};r.prototype.ensureDebugPatternResources=function(a,b){if(!this._debugPatternTexture){for(var c=new Uint8Array(a*b*4),d=0,g=0;g<b;g++)for(var e=0;e<a;e++){var f=Math.floor(e/10),k=Math.floor(g/10);2>f||2>k||10*f>a-20||10*k>b-20?(c[d++]=255,c[d++]=255,c[d++]=
255,c[d++]=255):(c[d++]=255,c[d++]=255,c[d++]=255,f&1&&k&1?c[d++]=e&1^g&1?0:255:c[d++]=f&1^k&1?0:128)}this._debugPatternTexture=new aa(this._rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:a,height:b},c);a=new T.TextureTechniqueConfiguration;a.hasAlpha=!0;this._debugTextureTechnique=this._shaderTechniqueRepository.acquireAndReleaseExisting(T.TextureTechnique,a,this._debugTextureTechnique);this._debugPatternProgram=this._debugTextureTechnique.program;this._debugPatternPipelineState=
this._debugTextureTechnique.pipeline;this._quadVAO=J.createQuadVAO(this._rctx)}};Object.defineProperty(r.prototype,"test",{get:function(){return{layerRenderers:this._layerRenderers}},enumerable:!0,configurable:!0});e.__decorate([A.autoDispose()],r.prototype,"_shaderTechniqueRepository",void 0);e.__decorate([A.autoDispose()],r.prototype,"_stippleTextureRepository",void 0);e.__decorate([b.property(),A.autoDispose()],r.prototype,"waterTextureRepository",void 0);e.__decorate([b.property()],r.prototype,
"renderView",void 0);e.__decorate([b.property({type:Boolean,readOnly:!0,dependsOn:["waterTextureRepository.updating"]})],r.prototype,"updating",null);return r=e.__decorate([b.subclass("esri.views.3d.terrain.OverlayRenderer")],r)}(A.AutoDisposableMixin(r));f.OverlayRenderer=u;var Z=function(){return function(a,b){this.layerView=a;this.renderer=b}}(),ha=[[1,.5,.5],[.5,.5,1],[.5,1,.5]],X=new E.default;X.near=1;X.far=1E4;var ea=v.vec3f64.create(),ga=v.vec3f64.create();f.DRAPED_Z=-2;f.overlayRenderOccludedFlag=
4})},"esri/views/3d/webgl-engine/core/shaderTechnique/CommonUniformStore":function(){define(["require","exports","../../../../../core/arrayUtils"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function f(){this._uniforms={proj:[],shadowMapDistance:[],viewportPixelSz:[],lightingMainDirection:[]}}f.prototype.dispose=function(){this._uniforms=null};f.prototype.getPrograms=function(e){return this._uniforms[e]||[]};f.prototype.subscribeProgram=function(e){for(var d in this._uniforms)e.hasUniform(d)&&
this._uniforms[d].push(e)};f.prototype.unsubscribeProgram=function(f){for(var d in this._uniforms)e.removeUnordered(this._uniforms[d],f)};return f}();f.CommonUniformStore=u})},"esri/views/3d/webgl-engine/core/shaderTechnique/ShaderTechniqueRepository":function(){define(["require","exports","tslib","../../../../../core/maybe","../../../../../core/promiseUtils"],function(u,f,e,r,m){Object.defineProperty(f,"__esModule",{value:!0});var d=function(){return function(d){this.technique=d;this.refZeroFrame=
this.refCount=0}}();u=function(){function g(d){this._context=d;this._perConstructorInstances=new Map;this._frameCounter=0;this._keepAliveFrameCount=1200}Object.defineProperty(g.prototype,"viewingMode",{get:function(){return this._context.viewingMode},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"constructionContext",{get:function(){return this._context},enumerable:!0,configurable:!0});g.prototype.dispose=function(){this._perConstructorInstances.forEach(function(d){return d.forEach(function(d){return d.technique.dispose()})});
this._perConstructorInstances.clear()};g.prototype.acquire=function(g,e){var c=e.key,a=this._perConstructorInstances.get(g);a||(a=new Map,this._perConstructorInstances.set(g,a));var b=a.get(c);void 0===b&&(b=new d(new g(this._context,e)),a.set(c,b));++b.refCount;return b.technique};g.prototype.acquireAndReleaseExisting=function(d,g,c){return r.isNone(c)?this.acquire(d,g):g.key===c.key&&c instanceof d?c:(this.release(c),this.acquire(d,g))};g.prototype.release=function(d){d=this._perConstructorInstances.get(d.constructor).get(d.key);
--d.refCount;0===d.refCount&&(d.refZeroFrame=this._frameCounter)};g.prototype.frameUpdate=function(){var d=this;this._frameCounter++;this._perConstructorInstances.forEach(function(g,c){g.forEach(function(a,b){0===a.refCount&&a.refZeroFrame+d._keepAliveFrameCount<d._frameCounter&&(a.technique.dispose(),g.delete(b))});0===g.size&&d._perConstructorInstances.delete(c)})};g.prototype.getProgramsUsingUniform=function(d){return this._context.commonUniformStore.getPrograms(d)};g.prototype.hotReload=function(){return e.__awaiter(this,
void 0,void 0,function(){var d,g=this;return e.__generator(this,function(c){switch(c.label){case 0:return d=[],this._perConstructorInstances.forEach(function(a,b){d.push(function(a,b){return e.__awaiter(g,void 0,void 0,function(){var c,d=this;return e.__generator(this,function(g){switch(g.label){case 0:return(c=b.shader)?[4,c.reload()]:[3,2];case 1:g.sent(),a.forEach(function(a){a.technique.reload(d._context)}),g.label=2;case 2:return[2]}})})}(a,b))}),[4,m.all(d)];case 1:return c.sent(),[2]}})})};
return g}();f.ShaderTechniqueRepository=u})},"esri/views/3d/webgl-engine/lib/AutoDisposable":function(){define(["require","exports","tslib"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.AutoDisposableMixin=function(f){return function(f){function d(){var d=null!==f&&f.apply(this,arguments)||this;d._isDisposed=!1;return d}e.__extends(d,f);d.prototype.dispose=function(){for(var d=this.__proto__.__managedDisposables__||[],e=d.length-1;0<=e;e--){var f=d[e];this[f]&&"function"===typeof this[f].dispose&&
this[f].dispose();this[f]=null}this._isDisposed=!0};Object.defineProperty(d.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!0,configurable:!0});return d}(f)};u=function(f){function m(){return null!==f&&f.apply(this,arguments)||this}e.__extends(m,f);return m}(f.AutoDisposableMixin(function(){return function(){}}()));f.AutoDisposable=u;f.autoDispose=function(){return function(e,f){e.hasOwnProperty("__managedDisposables__")||(e.__managedDisposables__=e.__managedDisposables__?
e.__managedDisposables__.slice():[]);e.__managedDisposables__.push(f)}}})},"esri/views/3d/webgl-engine/lib/Camera":function(){define("require exports ../../../../core/mathUtils ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/vec4 ../../../../core/libs/gl-matrix-2/vec4f64 ../../support/geometryUtils ../../support/mathUtils ../../support/geometryUtils/vector ./Util".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function f(b,g,e){void 0===b&&(b=k.vec3f64.create());void 0===g&&(g=k.vec3f64.create());void 0===e&&(e=k.vec3f64.fromValues(0,0,1));this._viewUp=k.vec3f64.create();this._viewForward=k.vec3f64.create();this._viewRight=k.vec3f64.create();this._ray=a.ray.createWrapper();this._viewport=c.vec4f64.fromValues(0,0,1,1);this._padding=c.vec4f64.fromValues(0,0,0,0);this._fov=55/180*Math.PI;this._near=1;this._far=
1E3;this._viewDirty=!0;this._viewMatrix=d.mat4f64.create();this._projectionDirty=!0;this._projectionMatrix=d.mat4f64.create();this._viewProjectionDirty=!0;this._viewProjectionMatrix=d.mat4f64.create();this._viewInverseTransposeMatrixDirty=!0;this._viewInverseTransposeMatrix=d.mat4f64.create();this._frustumDirty=!0;this._frustum=a.frustum.create();this._fullViewport=null;this.pixelRatio=1;this.relativeElevation=0;this._eye=k.vec3f64.clone(b);this._center=k.vec3f64.clone(g);this._up=k.vec3f64.clone(e);
this._padding=c.vec4f64.create()}Object.defineProperty(f.prototype,"eye",{get:function(){return this._eye},set:function(a){this._compareAndSetView(a,this._eye)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"center",{get:function(){return this._center},set:function(a){this._compareAndSetView(a,this._center)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"ray",{get:function(){this._ray.origin=this.eye;this._ray.direction||(this._ray.direction=k.vec3f64.create());
g.vec3.subtract(this._ray.direction,this.center,this.eye);return this._ray},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"up",{get:function(){return this._up},set:function(a){this._compareAndSetView(a,this._up)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"viewMatrix",{get:function(){this._ensureViewClean();return this._viewMatrix},set:function(a){m.mat4.copy(this._viewMatrix,a);this._viewDirty=!1;this._frustumDirty=this._viewProjectionDirty=this._viewInverseTransposeMatrixDirty=
!0},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"viewForward",{get:function(){this._ensureViewClean();return this._viewForward},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"viewUp",{get:function(){this._ensureViewClean();return this._viewUp},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"viewRight",{get:function(){this._ensureViewClean();return this._viewRight},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"near",
{get:function(){return this._near},set:function(a){this._near!==a&&(this._near=a,this._frustumDirty=this._viewProjectionDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"far",{get:function(){return this._far},set:function(a){this._far!==a&&(this._far=a,this._frustumDirty=this._viewProjectionDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"viewport",{get:function(){return this._viewport},set:function(a){this.x=
a[0];this.y=a[1];this.width=a[2];this.height=a[3]},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"x",{get:function(){return this._viewport[0]},set:function(a){a+=this._padding[3];this._viewport[0]!==a&&(this._viewport[0]=a,this._frustumDirty=this._viewProjectionDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"y",{get:function(){return this._viewport[1]},set:function(a){a+=this._padding[2];this._viewport[1]!==a&&(this._viewport[1]=
a,this._frustumDirty=this._viewProjectionDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"width",{get:function(){return this._viewport[2]},set:function(a){this._viewport[2]!==a&&(this._viewport[2]=a,this._frustumDirty=this._viewProjectionDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"height",{get:function(){return this._viewport[3]},set:function(a){this._viewport[3]!==a&&(this._viewport[3]=a,this._frustumDirty=
this._viewProjectionDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"fullWidth",{get:function(){return this._viewport[2]+this._padding[1]+this._padding[3]},set:function(a){this.width=a-(this._padding[1]+this._padding[3])},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"fullHeight",{get:function(){return this._viewport[3]+this._padding[0]+this._padding[2]},set:function(a){this.height=a-(this._padding[0]+this._padding[2])},enumerable:!0,
configurable:!0});Object.defineProperty(f.prototype,"fullViewport",{get:function(){this._fullViewport||(this._fullViewport=c.vec4f64.create());this._fullViewport[0]=this._viewport[0]-this._padding[3];this._fullViewport[1]=this._viewport[1]-this._padding[2];this._fullViewport[2]=this.fullWidth;this._fullViewport[3]=this.fullHeight;return this._fullViewport},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"aspect",{get:function(){return this.width/this.height},enumerable:!0,configurable:!0});
Object.defineProperty(f.prototype,"padding",{get:function(){return this._padding},set:function(a){if(this._padding[0]!==a[0]||this._padding[1]!==a[1]||this._padding[2]!==a[2]||this._padding[3]!==a[3])this._viewport[0]+=a[3]-this._padding[3],this._viewport[1]+=a[2]-this._padding[2],this._viewport[2]-=a[1]+a[3]-(this._padding[1]+this._padding[3]),this._viewport[3]-=a[0]+a[2]-(this._padding[0]+this._padding[2]),l.vec4.copy(this._padding,a),this._frustumDirty=this._viewProjectionDirty=this._projectionDirty=
!0},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"viewProjectionMatrix",{get:function(){this._viewProjectionDirty&&(m.mat4.multiply(this._viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),this._viewProjectionDirty=!1);return this._viewProjectionMatrix},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"projectionMatrix",{get:function(){if(this._projectionDirty){var a=this.width,b=this.height,c=this.near*Math.tan(this.fovY/2),d=c*this.aspect;m.mat4.frustum(this._projectionMatrix,
-d*(1+2*this._padding[3]/a),d*(1+2*this._padding[1]/a),-c*(1+2*this._padding[2]/b),c*(1+2*this._padding[0]/b),this.near,this.far);this._projectionDirty=!1}return this._projectionMatrix},set:function(a){m.mat4.copy(this._projectionMatrix,a);this._projectionDirty=!1;this._frustumDirty=this._viewProjectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"fov",{get:function(){return this._fov},set:function(a){this._fov=a;this._frustumDirty=this._viewProjectionDirty=this._projectionDirty=
!0},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"fovX",{get:function(){return v.fovd2fovx(this._fov,this.width,this.height)},set:function(a){this._fov=v.fovx2fovd(a,this.width,this.height);this._frustumDirty=this._viewProjectionDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"fovY",{get:function(){return v.fovd2fovy(this._fov,this.width,this.height)},set:function(a){this._fov=v.fovy2fovd(a,this.width,this.height);this._frustumDirty=
this._viewProjectionDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"distance",{get:function(){return g.vec3.distance(this._center,this._eye)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"frustum",{get:function(){this._recomputeFrustum();return this._frustum},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"viewInverseTransposeMatrix",{get:function(){if(this._viewInverseTransposeMatrixDirty||this._viewDirty)this._viewInverseTransposeMatrix||
(this._viewInverseTransposeMatrix=d.mat4f64.create()),m.mat4.invert(this._viewInverseTransposeMatrix,this.viewMatrix),m.mat4.transpose(this._viewInverseTransposeMatrix,this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1;return this._viewInverseTransposeMatrix},enumerable:!0,configurable:!0});f.prototype.depthNDCToWorld=function(a){return 2*this.near*this.far/(this.far+this.near-(2*a-1)*(this.far-this.near))};Object.defineProperty(f.prototype,"perRenderPixelRatio",{get:function(){return Math.tan(this.fovX/
2)/(this.width/2)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"perScreenPixelRatio",{get:function(){return this.perRenderPixelRatio*this.pixelRatio},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"aboveGround",{get:function(){return 0<=this.relativeElevation},enumerable:!0,configurable:!0});f.prototype.copyFrom=function(b){g.vec3.copy(this._eye,b._eye);g.vec3.copy(this._center,b._center);g.vec3.copy(this._up,b._up);l.vec4.copy(this._viewport,b._viewport);
l.vec4.copy(this._padding,b._padding);this._near=b._near;this._far=b._far;this._fov=b._fov;this.relativeElevation=b.relativeElevation;this._viewDirty=b._viewDirty;this._viewDirty||(m.mat4.copy(this._viewMatrix,b._viewMatrix),g.vec3.copy(this._viewRight,b._viewRight),g.vec3.copy(this._viewUp,b._viewUp),g.vec3.copy(this._viewForward,b._viewForward));b._projectionDirty?this._projectionDirty=!0:(m.mat4.copy(this._projectionMatrix,b._projectionMatrix),this._projectionDirty=!1);this._viewProjectionDirty=
!0;this._frustumDirty=b._frustumDirty;this._frustumDirty||(a.frustum.copy(b._frustum,this._frustum),this._frustumDirty=!1);b._viewInverseTransposeMatrixDirty?this._viewInverseTransposeMatrixDirty=!0:(this._viewInverseTransposeMatrix?m.mat4.copy(this._viewInverseTransposeMatrix,b._viewInverseTransposeMatrix):this._viewInverseTransposeMatrix=d.mat4f64.clone(b._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1);b._fullViewport?this._fullViewport?l.vec4.copy(this._fullViewport,b._fullViewport):
this._fullViewport=c.vec4f64.clone(b._fullViewport):this._fullViewport=null;this.pixelRatio=b.pixelRatio;return this};f.prototype.copyViewFrom=function(a){this.eye=a.eye;this.center=a.center;this.up=a.up};f.prototype.clone=function(){var a=new f;a.copyFrom(this);return a};f.prototype.equals=function(a){return g.vec3.exactEquals(this._eye,a._eye)&&g.vec3.exactEquals(this._center,a._center)&&g.vec3.exactEquals(this._up,a._up)&&l.vec4.exactEquals(this._viewport,a._viewport)&&l.vec4.exactEquals(this._padding,
a._padding)&&this._near===a._near&&this._far===a._far&&this._fov===a._fov&&this.pixelRatio===a.pixelRatio&&this.relativeElevation===a.relativeElevation};f.prototype.almostEquals=function(a){if(this.pixelRatio!==a.pixelRatio||.001<=Math.abs(a._fov-this._fov))return!1;var b=1-1E-10;g.vec3.sub(z,a._eye,a._center);g.vec3.sub(A,this._eye,this._center);var c=g.vec3.dot(z,A),d=g.vec3.sqrLen(z),e=g.vec3.sqrLen(A);return c*c>=b*d*e&&g.vec3.sqrDist(a._eye,this._eye)<2.5E-7*Math.max(d,e)&&.5>l.vec4.squaredDistance(a._padding,
this._padding)&&.5>l.vec4.squaredDistance(a._viewport,this._viewport)};f.prototype.markViewDirty=function(){this._viewProjectionDirty=this._frustumDirty=this._viewDirty=!0};f.prototype.computeRenderPixelSizeAt=function(a){return this.computeRenderPixelSizeAtDist(this.viewDirectionDistance(a))};f.prototype.computeRenderPixelSizeAtDist=function(a){return a*this.perRenderPixelRatio};f.prototype.computeScreenPixelSizeAt=function(a){return this.computeScreenPixelSizeAtDist(this.viewDirectionDistance(a))};
f.prototype.viewDirectionDistance=function(a){return Math.abs(q.projectPointSignedLength(this.viewForward,g.vec3.subtract(z,a,this._eye)))};f.prototype.computeScreenPixelSizeAtDist=function(a){return a*this.perScreenPixelRatio};f.prototype.computeDistanceFromRadius=function(a,b){return a/Math.tan(Math.min(this.fovX,this.fovY)/(2*(b||1)))};f.prototype.getScreenCenter=function(a){void 0===a&&(a=r.createScreenPointArray());a[0]=(this.padding[3]+this.width/2)/this.pixelRatio;a[1]=(this.padding[0]+this.height/
2)/this.pixelRatio;return a};f.prototype.getRenderCenter=function(a,b,c){void 0===b&&(b=.5);void 0===c&&(c=.5);a||(a=r.createRenderScreenPointArray3());a[0]=this.padding[3]+this.width*b;a[1]=this.padding[2]+this.height*c;2<a.length&&(a[2]=.5);return a};f.prototype.setGLViewport=function(a){var b=this.viewport,c=this.padding;a.setViewport(b[0]-c[3],b[1]-c[2],b[2]+c[1]+c[3],b[3]+c[0]+c[2])};f.prototype.applyProjection=function(a,b,c){void 0===c&&(c=!1);a!==t&&g.vec3.copy(t,a);t[3]=1;c&&(b[2]=-t[2]);
l.vec4.transformMat4(t,t,this.projectionMatrix);g.vec3.scale(t,t,1/Math.abs(t[3]));a=this.fullViewport;b[0]=e.lerp(0,a[0]+a[2],.5+.5*t[0]);b[1]=e.lerp(0,a[1]+a[3],.5+.5*t[1]);c||(b[2]=.5*(t[2]+1));return b};f.prototype.projectPoint=function(a,b){t[0]=a[0];t[1]=a[1];t[2]=a[2];t[3]=1;l.vec4.transformMat4(t,t,this.viewProjectionMatrix);if(0===t[3])return null;g.vec3.scale(t,t,1/Math.abs(t[3]));a=this.fullViewport;"x"in b?(b.x=e.lerp(0,a[0]+a[2],.5+.5*t[0]),b.y=e.lerp(0,a[1]+a[3],.5+.5*t[1])):(b[0]=e.lerp(0,
a[0]+a[2],.5+.5*t[0]),b[1]=e.lerp(0,a[1]+a[3],.5+.5*t[1]),2<b.length&&(b[2]=.5*(t[2]+1)));return b};f.prototype.unprojectPoint=function(a,b){m.mat4.multiply(x,this.projectionMatrix,this.viewMatrix);if(!m.mat4.invert(x,x))return null;var c=this.fullViewport;t[0]=2*(a[0]-c[0])/c[2]-1;t[1]=2*(a[1]-c[1])/c[3]-1;t[2]=2*a[2]-1;t[3]=1;l.vec4.transformMat4(t,t,x);if(0===t[3])return null;b[0]=t[0]/t[3];b[1]=t[1]/t[3];b[2]=t[2]/t[3];return b};f.prototype.computeUp=function(a){"global"===a?this.computeUpGlobal():
this.computeUpLocal()};f.prototype.screenToRender=function(a,b){var c=this.fullHeight-a[1]*this.pixelRatio;b[0]=a[0]*this.pixelRatio;b[1]=c;return b};f.prototype.renderToScreen=function(a,b){var c=(this.fullHeight-a[1])/this.pixelRatio;b[0]=a[0]/this.pixelRatio;b[1]=c;return b};f.prototype.computeUpGlobal=function(){g.vec3.subtract(z,this.center,this.eye);var a=g.vec3.length(this.center);1>a?(g.vec3.set(this.up,0,0,1),this.markViewDirty()):Math.abs(g.vec3.dot(z,this.center))>.9999*g.vec3.length(z)*
a||(g.vec3.cross(this.up,z,this.center),g.vec3.cross(this.up,this.up,z),g.vec3.normalize(this.up,this.up),this.markViewDirty())};f.prototype.computeUpLocal=function(){b.directionFromTo(z,this.eye,this.center);.9999>=Math.abs(z[2])&&(g.vec3.scale(z,z,z[2]),g.vec3.set(this.up,-z[0],-z[1],1-z[2]),g.vec3.normalize(this.up,this.up),this.markViewDirty())};f.prototype._compareAndSetView=function(a,b){g.vec3.exactEquals(a,b)||(g.vec3.copy(b,a),this._viewProjectionDirty=this._frustumDirty=this._viewDirty=
!0)};f.prototype._recomputeFrustum=function(){this._frustumDirty&&(a.frustum.fromMatrix(this.viewMatrix,this.projectionMatrix,this._frustum),this._frustumDirty=!1)};f.prototype._ensureViewClean=function(){this._viewDirty&&(m.mat4.lookAt(this._viewMatrix,this._eye,this._center,this._up),g.vec3.set(this._viewForward,-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10]),g.vec3.set(this._viewUp,this._viewMatrix[1],this._viewMatrix[5],this._viewMatrix[9]),g.vec3.set(this._viewRight,this._viewMatrix[0],
this._viewMatrix[4],this._viewMatrix[8]),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)};return f}();f.default=u;var t=c.vec4f64.create(),x=d.mat4f64.create(),z=k.vec3f64.create(),A=k.vec3f64.create()})},"esri/views/3d/webgl-engine/lib/GLMaterialRep":function(){define("require exports ../../../../core/Logger ../../../../core/maybe ../core/shaderLibrary/ShaderOutputOptions ./Util".split(" "),function(u,f,e,r,m,d){var g=e.getLogger("esri.views.3d.webgl-engine.lib.GLMaterialRep"),k=function(){function g(c){this.refCnt=
0;this.glMaterial=c}g.prototype.incRefCnt=function(){++this.refCnt};g.prototype.decRefCnt=function(){--this.refCnt;d.assert(0<=this.refCnt)};g.prototype.getRefCnt=function(){return this.refCnt};g.prototype.getGLMaterial=function(){return this.glMaterial};return g}();return function(){function d(c,a,b){this._textureRep=c;this._techniqueRep=a;this.onMaterialChanged=b;this._id2glMaterialRef=new Map}d.prototype.acquire=function(c,a){this.ownMaterial(c);var b=m.getShaderOutputID(c.id,a),d=this._id2glMaterialRef.get(b);
null==d?(c=c.getGLMaterial({material:c,techniqueRep:this._techniqueRep,textureRep:this._textureRep,output:a}),d=new k(c),this._id2glMaterialRef.set(b,d)):c=d.getGLMaterial();d.incRefCnt();return c};d.prototype.release=function(c,a){c=m.getShaderOutputID(c.id,a);a=this._id2glMaterialRef.get(c);a.decRefCnt();0===a.getRefCnt()&&((a=a.getGLMaterial())&&a.dispose(),this._id2glMaterialRef.delete(c))};d.prototype.materialChanged=function(c){for(var a=0,b=m.ShaderOutputTypes;a<b.length;a++){var d=b[a];5!==
d.output&&6!==d.output&&(d=this._id2glMaterialRef.get(m.getShaderOutputID(c.id,d.output)))&&d.getGLMaterial()&&(d=d.getGLMaterial(),d.updateParameters&&d.updateParameters())}if(this.onMaterialChanged)this.onMaterialChanged(c)};d.prototype.ownMaterial=function(c){r.isSome(c.materialRepository)&&c.materialRepository!==this&&g.error("Material is already owned by a different material repository");c.materialRepository=this};return d}()})},"esri/views/3d/webgl-engine/core/shaderLibrary/ShaderOutputOptions":function(){define(["require",
"exports","../../../../../core/arrayUtils"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.ShaderOutputTypes=[{output:0,name:"color"},{output:1,name:"depth"},{output:2,name:"normal"},{output:3,name:"depthShadowMap"},{output:4,name:"highlight"},{output:5,name:"draped"},{output:6,name:"occlusion"}];f.getShaderOutputID=function(r,m){return r+"_"+e.find(f.ShaderOutputTypes,function(d){return d.output===m}).name}})},"esri/views/3d/webgl-engine/lib/glUtil3D":function(){define("require exports ./DefaultVertexAttributeLocations ./DefaultVertexBufferLayouts ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject".split(" "),
function(u,f,e,r,m,d,g){Object.defineProperty(f,"__esModule",{value:!0});f.createQuadVAO=function(d,f,c){void 0===f&&(f=r.Pos2);void 0===c&&(c=e.Default3D);var a=null;switch(f){case r.Pos2Tex:a=new Float32Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]);break;default:a=new Float32Array([-1,-1,1,-1,-1,1,1,1])}return new g(d,c,{geometry:f},{geometry:m.createVertex(d,35044,a)})};f.createEmptyTexture=function(g,e){void 0===e&&(e=4);return new d(g,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,
width:e,height:e})};f.createColorTexture=function(g,e,c){void 0===c&&(c=4);for(var a=new Uint8Array(c*c*4),b=0;b<a.length;b+=4)a[b+0]=255*e[0],a[b+1]=255*e[1],a[b+2]=255*e[2],a[b+3]=255*e[3];return new d(g,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:c,height:c},a)};f.createEmptyDepthTexture=function(g){return new d(g,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([255,255,255,255]))}})},"esri/views/3d/webgl-engine/lib/DefaultVertexAttributeLocations":function(){define(["require",
"exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});f.Default3D={position:0,normal:1,uv0:2,color:3,size:4,tangent:4,auxpos1:5,symbolColor:5,auxpos2:6,featureAttribute:6,instanceFeatureAttribute:6,instanceColor:7,model:8,modelNormal:12,modelOriginHi:11,modelOriginLo:15}})},"esri/views/3d/webgl-engine/lib/DefaultVertexBufferLayouts":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});f.Pos3=[{name:"position",count:3,type:5126,
offset:0,stride:12,normalized:!1}];f.Pos3Tex=[{name:"position",count:3,type:5126,offset:0,stride:20,normalized:!1},{name:"uv0",count:2,type:5126,offset:12,stride:20,normalized:!1}];f.Pos3NormalTex=[{name:"position",count:3,type:5126,offset:0,stride:32,normalized:!1},{name:"normal",count:3,type:5126,offset:12,stride:32,normalized:!1},{name:"uv0",count:2,type:5126,offset:24,stride:32,normalized:!1}];f.Pos3Col=[{name:"position",count:3,type:5126,offset:0,stride:16,normalized:!1},{name:"color",count:4,
type:5121,offset:12,stride:16,normalized:!1}];f.Pos2=[{name:"position",count:2,type:5126,offset:0,stride:8,normalized:!1}];f.Pos2Tex=[{name:"position",count:2,type:5126,offset:0,stride:16,normalized:!1},{name:"uv0",count:2,type:5126,offset:8,stride:16,normalized:!1}]})},"esri/views/webgl/BufferObject":function(){define(["require","exports","../../core/has","../../core/typedArrayUtil"],function(u,f,e,r){return function(){function e(d,g,f,l,c){this._glName=this._context=null;this._bufferType=void 0;
this._usage=35044;this._size=-1;this._indexType=void 0;this._context=d;this._bufferType=g;this._usage=f;this._id=e._nextId++;this._glName=this._context.gl.createBuffer();l&&this.setData(l,c)}e.createIndex=function(d,g,f,l){return new e(d,34963,g,f,l)};e.createVertex=function(d,g,f){return new e(d,34962,g,f)};Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"glName",{get:function(){return this._glName},enumerable:!0,
configurable:!0});Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"usage",{get:function(){return this._usage},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"bufferType",{get:function(){return this._bufferType},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"indexType",{get:function(){return this._indexType},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,
"byteSize",{get:function(){return 34962===this._bufferType?this._size:5125===this._indexType?4*this._size:2*this._size},enumerable:!0,configurable:!0});e.prototype.dispose=function(){this._context&&(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context=null)};e.prototype.setData=function(d,g){if(d){if("number"===typeof d){if(0>d&&console.error("Buffer size cannot be negative!"),34963===this._bufferType&&g)switch(this._indexType=g,this._size=d,g){case 5123:d*=
2;break;case 5125:d*=4}}else g=d.byteLength,r.isUint16Array(d)&&(g/=2,this._indexType=5123),r.isUint32Array(d)&&(g/=4,this._indexType=5125),this._size=g;g=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);this._context.gl.bufferData(this._bufferType,d,this._usage);this._context.bindVAO(g)}};e.prototype.setSubData=function(d,g,e,f){void 0===g&&(g=0);void 0===e&&(e=0);if(d){(0>g||g>=this._size)&&console.error("offset is out of range!");var c=g,a=e,b=f,k=d.byteLength;
r.isUint16Array(d)&&(k/=2,c*=2,a*=2,b*=2);r.isUint32Array(d)&&(k/=4,c*=4,a*=4,b*=4);void 0===f&&(f=k-1);e>=f&&console.error("end must be bigger than start!");g+e-f>this._size&&console.error("An attempt to write beyond the end of the buffer!");g=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);e=this._context.gl;d=ArrayBuffer.isView(d)?d.buffer:d;e.bufferSubData(this._bufferType,c,d.slice(a,b));this._context.bindVAO(g)}};e._nextId=0;return e}()})},"esri/views/webgl/Texture":function(){define("require exports tslib ../../core/has ../../core/mathUtils ../../core/maybe".split(" "),
function(u,f,e,r,m,d){return function(){function g(d,f,c){void 0===c&&(c=null);this._glName=this._context=null;this._id=-1;this._descriptor=void 0;this._wrapModeDirty=this._samplingModeDirty=!1;this._boundToUnits=new Set;this._context=d;this._descriptor=e.__assign({target:3553,samplingMode:9729,wrapMode:10497,flipped:!1,hasMipmap:!1,isOpaque:!1,unpackAlignment:4,preMultiplyAlpha:!1},f);this._id=++g._nextId;this.setData(c)}Object.defineProperty(g.prototype,"id",{get:function(){return this._id},enumerable:!0,
configurable:!0});Object.defineProperty(g.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"descriptor",{get:function(){return this._descriptor},enumerable:!0,configurable:!0});g.prototype.dispose=function(){var d=this;if(this._context&&this._context.gl){if(this._glName){var g=this._context.gl;this._boundToUnits.forEach(function(c){d._context.bindTexture(null,c)});g.deleteTexture(this._glName);this._glName=null}this._context=
null}};g.prototype.release=function(){this.dispose()};g.prototype.resize=function(d,g){var c=this._descriptor;if(c.width!==d||c.height!==g)c.width=d,c.height=g,this.setData(null)};g.prototype.setData=function(e){var f=this._context.gl;this._glName||(this._glName=f.createTexture());void 0===e&&(e=null);null===e&&(this._descriptor.width=this._descriptor.width||4,this._descriptor.height=this._descriptor.height||4);var c=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var a=this._descriptor;
g._validateTexture(a);f.pixelStorei(f.UNPACK_ALIGNMENT,a.unpackAlignment);f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,a.flipped?1:0);f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.preMultiplyAlpha?1:0);var b=a.pixelFormat,k=a.internalFormat?a.internalFormat:b;if(e instanceof ImageData||e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement){var m=e.width,t=e.height;e instanceof HTMLVideoElement&&(m=e.videoWidth,t=e.videoHeight);a.width&&a.height&&console.assert(m===
a.width&&t===a.height);f.texImage2D(f.TEXTURE_2D,0,k,b,a.dataType,e);a.hasMipmap&&this.generateMipmap();void 0===a.width&&(a.width=m);void 0===a.height&&(a.height=t)}else{null!=a.width&&null!=a.height||console.error("Width and height must be specified!");f.DEPTH24_STENCIL8&&k===f.DEPTH_STENCIL&&(k=f.DEPTH24_STENCIL8);var m=a.width,t=a.height,r=e;if(d.isSome(r)&&"type"in r&&"compressed"===r.type)for(b=Math.round(Math.log(Math.max(m,t))/Math.LN2)+1,a.hasMipmap=a.hasMipmap&&b===e.levels.length,r=0;;++r){f.compressedTexImage2D(f.TEXTURE_2D,
r,k,m,t,0,e.levels[Math.min(r,e.levels.length-1)]);if(1===m&&1===t||!a.hasMipmap)break;m=Math.max(1,m>>1);t=Math.max(1,t>>1)}else if(d.isSome(e))f.texImage2D(f.TEXTURE_2D,0,k,m,t,0,b,a.dataType,e),a.hasMipmap&&this.generateMipmap();else for(r=0;;++r){f.texImage2D(f.TEXTURE_2D,r,k,m,t,0,b,a.dataType,null);if(1===m&&1===t||!a.hasMipmap)break;m=Math.max(1,m>>1);t=Math.max(1,t>>1)}}g._applySamplingMode(f,this._descriptor);g._applyWrapMode(f,this._descriptor);g._applyAnisotropicFilteringParameters(this._context,
this._descriptor);this._context.bindTexture(c,0)};g.prototype.updateData=function(d,g,c,a,b,e){e||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");var f=this._context.gl,k=this._descriptor,q=this._context.getBoundTexture(0);this._context.bindTexture(this,0);(0>g||0>c||a>k.width||b>k.height||g+a>k.width||c+b>k.height)&&console.error("An attempt to update out of bounds of the texture!");f.pixelStorei(f.UNPACK_ALIGNMENT,
k.unpackAlignment);f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,k.flipped?1:0);f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,k.preMultiplyAlpha?1:0);e instanceof ImageData||e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement?f.texSubImage2D(f.TEXTURE_2D,d,g,c,k.pixelFormat,k.dataType,e):f.texSubImage2D(f.TEXTURE_2D,d,g,c,a,b,k.pixelFormat,k.dataType,e);this._context.bindTexture(q,0)};g.prototype.generateMipmap=function(){var d=this._descriptor;d.hasMipmap||(d.hasMipmap=
!0,g._validateTexture(d));9729===d.samplingMode?(this._samplingModeDirty=!0,d.samplingMode=9985):9728===d.samplingMode&&(this._samplingModeDirty=!0,d.samplingMode=9984);d=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var e=this._context.gl;e.generateMipmap(e.TEXTURE_2D);this._context.bindTexture(d,0)};g.prototype.setSamplingMode=function(d){d!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=d,g._validateTexture(this._descriptor),this._samplingModeDirty=!0)};g.prototype.setWrapMode=
function(d){d!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=d,g._validateTexture(this._descriptor),this._wrapModeDirty=!0)};g.prototype.applyChanges=function(){var d=this._context.gl,e=this._descriptor;this._samplingModeDirty&&(g._applySamplingMode(d,e),this._samplingModeDirty=!1);this._wrapModeDirty&&(g._applyWrapMode(d,e),this._wrapModeDirty=!1)};g.prototype.setBoundToUnit=function(d,g){g?this._boundToUnits.add(d):this._boundToUnits.delete(d)};g._validateTexture=function(d){(0>d.width||
0>d.height)&&console.error("Negative dimension parameters are not allowed!");m.isPowerOfTwo(d.width)&&m.isPowerOfTwo(d.height)||("number"===typeof d.wrapMode?33071!==d.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):33071===d.wrapMode.s&&33071===d.wrapMode.t||console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),d.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))};g._applySamplingMode=function(d,g){var c=
g.samplingMode,a=g.samplingMode;if(9985===c||9987===c)c=9729,g.hasMipmap||(a=9729);else if(9984===c||9986===c)c=9728,g.hasMipmap||(a=9728);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,c);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,a)};g._applyWrapMode=function(d,g){"number"===typeof g.wrapMode?(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,g.wrapMode),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,g.wrapMode)):(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,g.wrapMode.s),d.texParameteri(d.TEXTURE_2D,
d.TEXTURE_WRAP_T,g.wrapMode.t))};g._applyAnisotropicFilteringParameters=function(d,g){if(null!=g.maxAnisotropy){var c=d.capabilities.textureFilterAnisotropic;c&&(d=d.gl,d.texParameterf(d.TEXTURE_2D,c.TEXTURE_MAX_ANISOTROPY,g.maxAnisotropy))}};g._nextId=0;return g}()})},"esri/views/webgl/VertexArrayObject":function(){define(["require","exports","../../core/has","./Util"],function(u,f,e,r){return function(){function e(d,g,f,l,c){this._locations=this._layout=this._glName=this._context=null;this._indexBuffer=
this._buffers=void 0;this._initialized=!1;this._context=d;this._layout=f;this._buffers=l;this._locations=g;c&&(this._indexBuffer=c);this._id=e._nextId++}Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"vertexBuffers",{get:function(){return this._buffers},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,
"indexBuffer",{get:function(){return this._indexBuffer},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"size",{get:function(){var d=this;return Object.keys(this._buffers).reduce(function(g,e){return g+d._buffers[e].size},this._indexBuffer?this._indexBuffer.size:0)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"layout",{get:function(){return this._layout},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"locations",{get:function(){return this._locations},
enumerable:!0,configurable:!0});e.prototype.dispose=function(d){void 0===d&&(d=!0);if(this._context){var g=this._context.capabilities.vao;g&&this._glName&&(g.deleteVertexArray(this._glName),this._glName=null);this._context.getBoundVAO()===this&&this._context.bindVAO(null);if(d){for(var e in this._buffers)this._buffers[e].dispose(),delete this._buffers[e];this._indexBuffer&&(this._indexBuffer.dispose(),this._indexBuffer=null)}this._context=null}};e.prototype.initialize=function(){if(!this._initialized){var d=
this._context.capabilities.vao;if(d){var g=d.createVertexArray();d.bindVertexArray(g);this._bindLayout();d.bindVertexArray(null);this._glName=g}this._initialized=!0}};e.prototype.bind=function(){this.initialize();var d=this._context.capabilities.vao;d?d.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())};e.prototype._bindLayout=function(){var d=this._buffers,g=!!this._context.capabilities.vao,e=this._layout,f=this._indexBuffer;d||console.error("Vertex buffer dictionary is empty!");
var c=this._context.gl,a;for(a in d){var b=d[a];b||console.error("Vertex buffer is uninitialized!");var q=e[a];q||console.error("Vertex element descriptor is empty!");r.bindVertexBufferLayout(this._context,this._locations,b,q)}f&&(g?c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,f.glName):this._context.bindBuffer(f))};e.prototype.unbind=function(){this.initialize();var d=this._context.capabilities.vao;d?d.bindVertexArray(null):this._unbindLayout()};e.prototype._unbindLayout=function(){var d=this._buffers,g=
this._layout;d||console.error("Vertex buffer dictionary is empty!");for(var e in d){var f=d[e];f||console.error("Vertex buffer is uninitialized!");r.unbindVertexBufferLayout(this._context,this._locations,f,g[e])}(d=this._indexBuffer)&&this._context.unbindBuffer(d.bufferType)};e._nextId=0;return e}()})},"esri/views/webgl/Util":function(){define(["require","exports","tslib","../../core/compilerUtils","../../core/maybe"],function(u,f,e,r,m){function d(c){return c[0].stride}function g(c){switch(c){case 5126:return 4;
case 5124:return 4;case 5125:return 4;case 5122:return 2;case 5123:return 2;case 5120:return 1;case 5121:return 1;default:throw r.neverReached(c),Error("Unknown data type");}}function k(c){switch(c){case 6406:case 6409:return 1;case 6410:return 2;case 6407:return 3;case 6408:return 4;case 34041:return 4;case 33325:return 2;case 33326:return 4;case 35898:return 4;case 33327:return 4;case 33328:return 8;case 34842:return 8;case 34836:return 16;case 33189:return 2;case 34041:return 4;case 32854:return 2;
case 36168:return 1;default:r.neverReached(c)}return 0}function l(c){if(m.isNone(c))return 0;if("colorAttachment"in c)return c.glName?l(c.colorAttachment)+l(c.depthStencilAttachment):0;if("descriptor"in c)return c.glName?l(c.descriptor):0;var a=c.internalFormat||"pixelFormat"in c&&c.pixelFormat;if(!a)return 0;var b="hasMipmap"in c&&c.hasMipmap?1.3:1;c=c.width*c.height;return k(a)*c*b}Object.defineProperty(f,"__esModule",{value:!0});f.vertexCount=function(c,a){return c.vertexBuffers[a].size/d(c.layout[a])};
f.getStride=d;f.getBytesPerElement=g;f.getTypedArrayConstructor=function(c){switch(c){case 5120:return Int8Array;case 5126:return Float32Array;case 5124:return Int32Array;case 5122:return Int16Array;case 5121:return Uint8Array;case 5125:return Uint32Array;case 5123:return Uint16Array;default:throw r.neverReached(c),Error("Unknown data type");}};f.addDescriptor=function(c,a,b,d,e,f){var k=g(d);if(0<c.length){var q=c[0].stride,l=q+k*b;c.forEach(function(a){return a.stride=l});c.push({name:a,count:b,
type:d,offset:q,stride:l,normalized:e,divisor:f})}else c.push({name:a,count:b,type:d,offset:0,stride:k*b,normalized:e,divisor:f})};f.hasAttribute=function(c,a){for(var b=0;b<c.length;b++)if(c[b].name===a)return!0;return!1};f.findAttribute=function(c,a){for(var b=0;b<c.length;b++)if(c[b].name===a)return c[b];return null};f.copyFramebufferToTexture=function(c,a,b,d,g){void 0===g&&(g=0);var e=c.getBoundFramebufferObject(),f=c.getBoundTexture(0);c.bindFramebuffer(a);c.bindTexture(b,0);c.gl.copyTexImage2D(c.gl.TEXTURE_2D,
g,b.descriptor.pixelFormat,d[0],d[1],d[2],d[3],0);c.gl.flush();c.bindFramebuffer(e);c.bindTexture(f,0)};f.setBaseInstanceOffset=function(c,a){var b={},d;for(d in c)b[d]=c[d].map(function(b){return b.divisor?e.__assign(e.__assign({},b),{baseInstance:a}):b});return b};f.bindVertexBufferLayout=function(c,a,b,d,g){var e=c.gl,f=c.capabilities.instancing;c.bindBuffer(b);for(c=0;c<d.length;c++){b=d[c];var k=a[b.name],q=(g?g:0+b.baseInstance?b.baseInstance:0)*b.stride;void 0===k&&console.error("There is no location for vertex attribute '"+
b.name+"' defined.");b.baseInstance&&!b.divisor&&console.error("Vertex attribute '"+b.name+"' uses baseInstanceOffset without divisor.");if(4>=b.count)e.vertexAttribPointer(k,b.count,b.type,b.normalized,b.stride,b.offset+q),e.enableVertexAttribArray(k),b.divisor&&0<b.divisor&&f&&f.vertexAttribDivisor(k,b.divisor);else if(9===b.count)for(var l=0;3>l;l++)e.vertexAttribPointer(k+l,3,b.type,b.normalized,b.stride,b.offset+12*l+q),e.enableVertexAttribArray(k+l),b.divisor&&0<b.divisor&&f&&f.vertexAttribDivisor(k+
l,b.divisor);else if(16===b.count)for(l=0;4>l;l++)e.vertexAttribPointer(k+l,4,b.type,b.normalized,b.stride,b.offset+16*l+q),e.enableVertexAttribArray(k+l),b.divisor&&0<b.divisor&&f&&f.vertexAttribDivisor(k+l,b.divisor);else console.error("Unsupported vertex attribute element count: "+b.count)}};f.unbindVertexBufferLayout=function(c,a,b,d){var g=c.gl,e=c.capabilities.instancing;c.bindBuffer(b);for(b=0;b<d.length;b++){var f=d[b],k=a[f.name];if(4>=f.count)g.disableVertexAttribArray(k),f.divisor&&0<f.divisor&&
e&&e.vertexAttribDivisor(k,0);else if(9===f.count)for(var q=0;3>q;q++)g.disableVertexAttribArray(k+q),f.divisor&&0<f.divisor&&e&&e.vertexAttribDivisor(k+q,0);else if(16===f.count)for(q=0;4>q;q++)g.disableVertexAttribArray(k+q),f.divisor&&0<f.divisor&&e&&e.vertexAttribDivisor(k+q,0);else console.error("Unsupported vertex attribute element count: "+f.count)}c.unbindBuffer(34962)};f.getBytesPerElementFormat=k;f.getGpuMemoryUsage=l})},"esri/views/3d/webgl-engine/lib/GridLocalOriginFactory":function(){define("require exports ../../../../core/maybe ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../geometry/SpatialReference ../../support/projectionUtils ./Geometry ./GeometryData ./Layer ./localOrigin ./Object3D ./Util ../materials/RibbonLineMaterial".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t){var x=0;u=function(){function d(){this.ROOT_ORIGIN_ID="rg_root_"+x++;this._origins=new Map;this._gridSize=42E5}d.prototype.getOrigin=function(a){var c=this._origins.get(this.ROOT_ORIGIN_ID);if(null==c){if(e.isSome(d.testOrigin)){var g=d.testOrigin;this._origins.set(this.ROOT_ORIGIN_ID,b.fromValues(g[0],g[1],g[2],this.ROOT_ORIGIN_ID));return this.getOrigin(a)}g=b.fromValues(a[0]+Math.random()-.5,a[1]+Math.random()-.5,a[2]+Math.random()-.5,this.ROOT_ORIGIN_ID);
this._origins.set(this.ROOT_ORIGIN_ID,g);return g}m.vec3.subtract(z,a,c.vec3);z[0]=Math.abs(z[0]);z[1]=Math.abs(z[1]);z[2]=Math.abs(z[2]);g=this._gridSize;if(z[0]<g&&z[1]<g&&z[2]<g)return c;var c=Math.round(a[0]/g),f=Math.round(a[1]/g);a=Math.round(a[2]/g);var k="rg_"+c+"/"+f+"/"+a,q=this._origins.get(k);q||(q=b.fromValues(c*g,f*g,a*g,k),this._origins.set(k,q));return q};d.prototype._drawOriginBox=function(b){var d=window.view,e=d._stage;if(null==this._object){this._material=new t({width:2,color:[0,
1,0,1]},"GridLocalOriginMaterial");e.add(3,this._material);var f=new a("GridLocalOrigin",{isPickable:!1});e.add(0,f);this._object=new q({idHint:"GridLocalOrigin",castShadow:!1});e.add(1,this._object);f.addObject(this._object);e.addToViewContent([f.id])}for(var m=[0,1,5,4,0,2,1,7,6,2,0,1,3,7,5,4,6,2,0],x=m.length,z=new Float32Array(3*x),f=new Uint32Array(2*(x-1)),A=.5*this._gridSize,E=0;E<x;E++)z[3*E+0]=b[0]+(m[E]&1?A:-A),z[3*E+1]=b[1]+(m[E]&2?A:-A),z[3*E+2]=b[2]+(m[E]&4?A:-A),0<E&&(f[2*E+0]=E-1,f[2*
E+1]=E);k.bufferToBuffer(z,g.WebMercator,0,z,d.spatialReference,0,x);d={};d[v.VertexAttrConstants.POSITION]={size:3,data:z};z={};z[v.VertexAttrConstants.POSITION]=f;f=new c.GeometryData(d,z,"line");f=new l(f,"GridLocalOriginBox");e.add(2,f);this._object.addGeometry(f,this._material,r.mat4f64.IDENTITY);console.log(this._origins.size,b)};return d}();var z=d.vec3f64.create();(u||(u={})).testOrigin=null;return u})},"esri/views/3d/webgl-engine/lib/Layer":function(){define("require exports tslib ../../../../core/arrayUtils ../../../../core/Evented ../../../../core/libs/gl-matrix-2/vec3f64 ./IdGen ./Octree".split(" "),
function(u,f,e,r,m,d,g,k){return function(f){function c(a,b,g){var e=f.call(this)||this;e._parentStages=new Map;e._objects=new Set;e.id=c._idGen.gen(a);e.apiLayerUid=g;e.name=a;b=b||{};e.group=b.group||"";e.isVisible=null!=b.isVisible?b.isVisible:!0;e.isPickable=null!=b.isPickable?b.isPickable:!0;e.isSliceable=!1;e.translation=b.translation?d.vec3f64.clone(b.translation):d.vec3f64.create();return e}e.__extends(c,f);c.prototype.addParentStage=function(a){if(!this._parentStages.has(a)){var b=this.on("dirty",
function(b){a.notifyDirty(b.origin,b.dirtyType,b.subObject)});this._parentStages.set(a,b)}};c.prototype.removeParentStage=function(a){var b=this._parentStages.get(a);b&&(b.remove(),this._parentStages.delete(a));this.invalidateSpatialQueryAccelerator()};c.prototype.getName=function(){return this.name};c.prototype.getGroup=function(){return this.group};c.prototype.getTranslation=function(){return this.translation};c.prototype.getObjectIds=function(){return r.keysOfSet(this._objects,function(a){return a.id})};
c.prototype.getObjects=function(){return r.keysOfSet(this._objects)};c.prototype.addObject=function(a){this._objects.add(a);a.parentLayer=this;this.notifyDirty("layerObjectAdded",a);this._octree&&this._octree.add(a)};c.prototype.hasObject=function(a){return this._objects.has(a)};c.prototype.removeObject=function(a){if(!this._objects.delete(a))return!1;a.parentLayer=null;this.notifyDirty("layerObjectRemoved",a);this._octree&&this._octree.remove(a);return!0};c.prototype.notifyObjectBBChanged=function(a,
b){this._octree&&this._octree.update(a,b)};c.prototype.getSpatialQueryAccelerator=function(){!this._octree&&50<this._objects.size&&this._createOctree();return this._octree};c.prototype.shaderTransformationChanged=function(){this.notifyDirty("shaderTransformationChanged",null)};c.prototype.invalidateSpatialQueryAccelerator=function(){this._octree&&(this._octree.destroy(),this._octree=null)};c.prototype.notifyDirty=function(a,b,c,d){this.emit("dirty",{origin:d||this,dirtyType:a,subObject:b})};c.prototype._createOctree=
function(){this._octree=new k({getRadius:function(a){return a.getBSRadius()},getCenter:function(a){return a.getCenter()}});this._octree.add(r.keysOfSet(this._objects))};c._idGen=new g.IdGen;return c}(m)})},"esri/views/3d/webgl-engine/lib/Octree":function(){define("require exports ../../../../core/ObjectPool ../../../../core/PooledArray ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../support/geometryUtils ./Util".split(" "),function(u,f,e,r,m,d,g,k){function l(a,
b,c){c=c||a;c[0]=a[0]+b;c[1]=a[1]+b;c[2]=a[2]+b;return c}function c(a,b,c){return!g.frustum.intersectsSphere(c.planes,g.sphere.wrap(b,a))}function a(a,b,c){if(!Q.length)for(var d=0;8>d;++d)Q.push({index:0,distance:0});for(d=0;8>d;++d){var g=x[d];Q.data[d].index=d;Q.data[d].distance=q(a,b,g)}Q.sort(function(a,b){return a.distance-b.distance});c.clear();for(d=0;8>d;++d)c.push(Q.data[d].index)}function b(a,b){for(var c=Infinity,d=null,g=0;8>g;++g){var e=q(a,b,z[g]);e<c&&(c=e,d=z[g])}return d}function q(a,
b,c){return b*(a[0]*c[0]+a[1]*c[1]+a[2]*c[2])}function v(a){if(Array.isArray(a))return a;E[0]=a;return E}u=function(){function e(a,b){this._maximumObjectsPerNode=10;this._maximumDepth=20;this._degenerateObjects=new Set;this._objectCount=0;this._objectToBoundingSphere=a;b&&(void 0!==b.maximumObjectsPerNode&&(this._maximumObjectsPerNode=b.maximumObjectsPerNode),void 0!==b.maximumDepth&&(this._maximumDepth=b.maximumDepth));this._root=new t(null,d.vec3f64.fromValues(0,0,0),0)}Object.defineProperty(e.prototype,
"center",{get:function(){return this._root.center},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"size",{get:function(){return 2*this._root.halfSize},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"root",{get:function(){return this._root.node},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"maximumObjectsPerNode",{get:function(){return this._maximumObjectsPerNode},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"maximumDepth",
{get:function(){return this._maximumDepth},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"objectCount",{get:function(){return this._objectCount},enumerable:!0,configurable:!0});e.prototype.destroy=function(){this._degenerateObjects.clear();this._root=null;t.clearPool();E[0]=null;F.prune();Q.prune();S.prune()};e.prototype.add=function(a,b){a=v(a);b=null==b?a.length:b;this._objectCount+=b;this._grow(a,b);for(var c=t.acquire(),d=0;d<b;d++){var g=a[d];this._isDegenerate(g)?this._degenerateObjects.add(g):
(c.init(this._root),this._add(g,c))}t.release(c)};e.prototype.remove=function(a,b){a=v(a);this._objectCount-=a.length;for(var c=t.acquire(),d=0;d<a.length;d++){var g=a[d],e=b||this._boundingSphereFromObject(g,M);this._isValidRadius(e.radius)?(c.init(this._root),this._remove(g,e,c)):this._degenerateObjects.delete(g)}t.release(c);this._shrink()};e.prototype.update=function(a,b){if(this._isValidRadius(b.radius)||!this._isDegenerate(a))this.remove(a,b),this.add(a)};e.prototype.forEachAlongRay=function(a,
b,c){var d=this,e=g.ray.wrap(a,b);this._forEachNode(this._root,function(a){if(!d._intersectsNode(e,a))return!1;a=a.node;a.terminals.forEach(function(a){d._intersectsObject(e,a)&&c(a)});null!==a.residents&&a.residents.forEach(function(a){d._intersectsObject(e,a)&&c(a)});return!0})};e.prototype.forEachAlongRayWithVerticalOffset=function(a,b,c,d){var e=this,f=g.ray.wrap(a,b);this._forEachNode(this._root,function(a){if(!e._intersectsNodeWithOffset(f,a,d))return!1;a=a.node;a.terminals.forEach(function(a){e._intersectsObjectWithOffset(f,
a,d)&&c(a)});null!==a.residents&&a.residents.forEach(function(a){e._intersectsObjectWithOffset(f,a,d)&&c(a)});return!0})};e.prototype.forEach=function(a){this._forEachNode(this._root,function(b){b=b.node;b.terminals.forEach(a);null!==b.residents&&b.residents.forEach(a);return!0});this._degenerateObjects.forEach(a)};e.prototype.forEachDegenerateObject=function(a){this._degenerateObjects.forEach(a)};e.prototype.findClosest=function(a,b,c,d,g){return this._findClosest(a,"front-to-back"===b?1:-1,c,d,
g)};e.prototype.forEachInDepthRange=function(a,b,c,d,g,e,f,k){this._forEachInDepthRange(a,b,"front-to-back"===c?1:-1,d,g,e,f,k)};e.prototype.forEachNode=function(a){this._forEachNode(this._root,function(b){return a(b.node,b.center,2*b.halfSize)})};e.prototype._intersectsNode=function(a,b){l(b.center,2*-b.halfSize,B);l(b.center,2*b.halfSize,G);return k.rayBoxTest(a.origin,a.direction,B,G)};e.prototype._intersectsNodeWithOffset=function(a,b,c){l(b.center,2*-b.halfSize,B);l(b.center,2*b.halfSize,G);
c.applyToMinMax(B,G);return k.rayBoxTest(a.origin,a.direction,B,G)};e.prototype._intersectsObject=function(a,b){var c=this._objectToBoundingSphere.getRadius(b);return 0<c?g.sphere.intersectsRay(g.sphere.wrap(c,this._objectToBoundingSphere.getCenter(b)),a):!0};e.prototype._intersectsObjectWithOffset=function(a,b,c){var d=this._objectToBoundingSphere.getRadius(b);return 0<d?g.sphere.intersectsRay(c.applyToBoundingSphere(d,this._objectToBoundingSphere.getCenter(b)),a):!0};e.prototype._forEachNode=function(a,
b){a=t.acquire().init(a);for(var c=[a];0!==c.length;){a=c.pop();if(b(a)&&!a.isLeaf())for(var d=0;d<a.node.children.length;d++)a.node.children[d]&&c.push(t.acquire().init(a).advance(d));t.release(a)}};e.prototype._forEachNodeDepthOrdered=function(b,c,d,g){void 0===g&&(g=1);b=t.acquire().init(b);var e=[b];for(a(d,g,S);0!==e.length;){b=e.pop();if(c(b)&&!b.isLeaf())for(d=7;0<=d;--d)g=S.data[d],g>=b.node.children.length||b.node.children[g]&&e.push(t.acquire().init(b).advance(g));t.release(b)}};e.prototype._findClosest=
function(a,d,g,e,f){var k=this,l=Infinity,t=Infinity,r=null,v=b(a,d),x=0,z=function(b){++x;if(!e||e(b)){var f=k._objectToBoundingSphere.getCenter(b),m=k._objectToBoundingSphere.getRadius(b);if(!g||!c(f,m,g)){var f=q(a,d,f),v=f-m;v<l&&(l=v,t=f+m,r=b)}}};this._forEachNodeDepthOrdered(this._root,function(b){if(null!=f&&x>=f||g&&c(b.center,b.halfSize*A,g))return!1;m.vec3.scale(J,v,b.halfSize);m.vec3.add(J,J,b.center);if(q(a,d,J)>t)return!1;b=b.node;b.terminals.forEach(function(a){z(a)});null!==b.residents&&
b.residents.forEach(function(a){z(a)});return!0},a,d);return r};e.prototype._forEachInDepthRange=function(a,d,g,e,f,k,l,t){var r=this,v=-Infinity,x=Infinity,z={setRange:function(a){1===g?(v=Math.max(v,a.near),x=Math.min(x,a.far)):(v=Math.max(v,-a.far),x=Math.min(x,-a.near))}};z.setRange(e);var E=q(d,g,a),u=b(d,g),B=b(d,-1*g),H=0,G=function(a){++H;if(!l||l(a)){var b=r._objectToBoundingSphere.getCenter(a),e=r._objectToBoundingSphere.getRadius(a),m=q(d,g,b)-E;m-e>x||m+e<v||k&&c(b,e,k)||f(a,z)}};this._forEachNodeDepthOrdered(this._root,
function(a){if(null!=t&&H>=t||k&&c(a.center,a.halfSize*A,k))return!1;m.vec3.scale(J,u,a.halfSize);m.vec3.add(J,J,a.center);if(q(d,g,J)-E>x)return!1;m.vec3.scale(J,B,a.halfSize);m.vec3.add(J,J,a.center);if(q(d,g,J)-E<v)return!1;a=a.node;a.terminals.forEach(function(a){G(a)});null!==a.residents&&a.residents.forEach(function(a){G(a)});return!0},d,g)};e.prototype._remove=function(a,b,c){F.clear();b=c.advanceTo(b,function(a,b){F.push(a.node);F.push(b)})?c.node.terminals:c.node.residents;b.removeUnordered(a);
if(0===b.length)for(a=F.length-2;0<=a&&this._purge(F.data[a],F.data[a+1]);a-=2);};e.prototype._nodeIsEmpty=function(a){if(0!==a.terminals.length)return!1;if(null!==a.residents)return 0===a.residents.length;for(var b=0;b<a.children.length;b++)if(a.children[b])return!1;return!0};e.prototype._purge=function(a,b){0<=b&&(a.children[b]=null);return this._nodeIsEmpty(a)?(null===a.residents&&(a.residents=new r({shrink:!0})),!0):!1};e.prototype._add=function(a,b){b.advanceTo(this._boundingSphereFromObject(a,
M))?b.node.terminals.push(a):(b.node.residents.push(a),b.node.residents.length>this._maximumObjectsPerNode&&b.depth<this._maximumDepth&&this._split(b))};e.prototype._split=function(a){var b=a.node.residents;a.node.residents=null;for(var c=0;c<b.length;c++){var d=t.acquire().init(a);this._add(b.data[c],d);t.release(d)}};e.prototype._grow=function(a,b){var c=this;0!==b&&(a=this._boundingSphereFromObjects(a,b,function(a,b){return c._boundingSphereFromObject(a,b)},R),this._isValidRadius(a.radius)&&!this._fitsInsideTree(a)&&
(this._nodeIsEmpty(this._root.node)?(m.vec3.copy(this._root.center,a.center),this._root.halfSize=1.25*a.radius):(b=t.acquire(),this._rootBoundsForRootAsSubNode(a,b),this._placingRootViolatesMaxDepth(b)?this._rebuildTree(a,b):this._growRootAsSubNode(b),t.release(b))))};e.prototype._rebuildTree=function(a,b){var c=this;m.vec3.copy(T.center,b.center);T.radius=b.halfSize;a=this._boundingSphereFromObjects([a,T],2,function(a){return a},O);b=t.acquire().init(this._root);this._root.initFrom(null,a.center,
1.25*a.radius);this._forEachNode(b,function(a){c.add(a.node.terminals.data,a.node.terminals.length);null!==a.node.residents&&c.add(a.node.residents.data,a.node.residents.length);return!0});t.release(b)};e.prototype._placingRootViolatesMaxDepth=function(a){var b=0;this._forEachNode(this._root,function(a){b=Math.max(b,a.depth);return!0});return b+Math.log(a.halfSize/this._root.halfSize)*Math.LOG2E>this._maximumDepth};e.prototype._rootBoundsForRootAsSubNode=function(a,b){var c=a.radius,d=a.center;a=
-Infinity;for(var g=this._root.center,e=this._root.halfSize,f=0;3>f;f++){var k=Math.max(0,Math.ceil((g[f]-e-(d[f]-c))/(2*e))),q=Math.max(0,Math.ceil((d[f]+c-(g[f]+e))/(2*e)))+1;a=Math.max(a,Math.pow(2,Math.ceil(Math.log(k+q)*Math.LOG2E)));L[f].min=k;L[f].max=q}for(f=0;3>f;f++)k=L[f].min,q=L[f].max,c=(a-(k+q))/2,k+=Math.ceil(c),q+=Math.floor(c),H[f]=g[f]-e-k*e*2+(q+k)*e;return b.initFrom(null,H,a*e,0)};e.prototype._growRootAsSubNode=function(a){var b=this._root.node;m.vec3.copy(R.center,this._root.center);
R.radius=this._root.halfSize;this._root.init(a);a.advanceTo(R,null,!0);a.node.children=b.children;a.node.residents=b.residents;a.node.terminals=b.terminals};e.prototype._shrink=function(){for(;;){var a=this._findShrinkIndex();if(-1===a)break;this._root.advance(a);this._root.depth=0}};e.prototype._findShrinkIndex=function(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;for(var a=null,b=this._root.node.children,c=0,d=0;d<b.length&&null==a;)c=d++,a=b[c];for(;d<b.length;)if(b[d++])return-1;
return c};e.prototype._isDegenerate=function(a){a=this._objectToBoundingSphere.getRadius(a);return!this._isValidRadius(a)};e.prototype._isValidRadius=function(a){return!isNaN(a)&&-Infinity!==a&&Infinity!==a&&0<a};e.prototype._fitsInsideTree=function(a){var b=this._root.center,c=this._root.halfSize,d=a.center;return a.radius<=c&&d[0]>=b[0]-c&&d[0]<=b[0]+c&&d[1]>=b[1]-c&&d[1]<=b[1]+c&&d[2]>=b[2]-c&&d[2]<=b[2]+c};e.prototype._boundingSphereFromObject=function(a,b){m.vec3.copy(b.center,this._objectToBoundingSphere.getCenter(a));
b.radius=this._objectToBoundingSphere.getRadius(a);return b};e.prototype._boundingSphereFromObjects=function(a,b,c,d){if(1===b){var g=c(a[0],R);m.vec3.copy(d.center,g.center);d.radius=g.radius}else{B[0]=Infinity;B[1]=Infinity;B[2]=Infinity;G[0]=-Infinity;G[1]=-Infinity;G[2]=-Infinity;for(var e=0;e<b;e++)if(g=c(a[e],R),this._isValidRadius(g.radius)){var f=B,k=g.center,q=g.radius;f[0]=Math.min(f[0],k[0]-q);f[1]=Math.min(f[1],k[1]-q);f[2]=Math.min(f[2],k[2]-q);f=G;k=g.center;g=g.radius;f[0]=Math.max(f[0],
k[0]+g);f[1]=Math.max(f[1],k[1]+g);f[2]=Math.max(f[2],k[2]+g)}m.vec3.lerp(d.center,B,G,.5);d.radius=Math.max(G[0]-B[0],G[1]-B[1],G[2]-B[2])/2}return d};return e}();var t=function(){function a(a,b,c){void 0===c&&(c=0);this.center=d.vec3f64.create();this.initFrom(a,b,c,0)}a.prototype.init=function(a){return this.initFrom(a.node,a.center,a.halfSize,a.depth)};a.prototype.initFrom=function(b,c,d,g){void 0===b&&(b=null);void 0===d&&(d=this.halfSize);void 0===g&&(g=this.depth);this.node=b||a.createEmptyNode();
c&&m.vec3.copy(this.center,c);this.halfSize=d;this.depth=g;return this};a.prototype.advance=function(b){var c=this.node.children[b];c||(c=a.createEmptyNode(),this.node.children[b]=c);this.node=c;this.halfSize/=2;this.depth++;b=x[b];this.center[0]+=b[0]*this.halfSize;this.center[1]+=b[1]*this.halfSize;this.center[2]+=b[2]*this.halfSize;return this};a.prototype.advanceTo=function(a,b,c){for(void 0===c&&(c=!1);;){if(this.isTerminalFor(a))return b&&b(this,-1),!0;if(this.isLeaf()&&!c)return b&&b(this,
-1),!1;this.isLeaf()&&(this.node.residents=null);var d=this._childIndex(a);b&&b(this,d);this.advance(d)}};a.prototype.isLeaf=function(){return null!=this.node.residents};a.prototype.isTerminalFor=function(a){return a.radius>this.halfSize/2};a.prototype._childIndex=function(a){a=a.center;for(var b=this.center,c=0,d=0;3>d;d++)b[d]<a[d]&&(c|=1<<d);return c};a.createEmptyNode=function(){return{children:[null,null,null,null,null,null,null,null],terminals:new r({shrink:!0}),residents:new r({shrink:!0})}};
a.acquire=function(){return a._pool.acquire()};a.release=function(b){a._pool.release(b)};a.clearPool=function(){a._pool.prune()};a._pool=new e(a);return a}(),x=[d.vec3f64.fromValues(-1,-1,-1),d.vec3f64.fromValues(1,-1,-1),d.vec3f64.fromValues(-1,1,-1),d.vec3f64.fromValues(1,1,-1),d.vec3f64.fromValues(-1,-1,1),d.vec3f64.fromValues(1,-1,1),d.vec3f64.fromValues(-1,1,1),d.vec3f64.fromValues(1,1,1)],z=[d.vec3f64.fromValues(-1,-1,-1),d.vec3f64.fromValues(-1,-1,1),d.vec3f64.fromValues(-1,1,-1),d.vec3f64.fromValues(-1,
1,1),d.vec3f64.fromValues(1,-1,-1),d.vec3f64.fromValues(1,-1,1),d.vec3f64.fromValues(1,1,-1),d.vec3f64.fromValues(1,1,1)],A=Math.sqrt(3),E=[null],H=d.vec3f64.create(),J=d.vec3f64.create(),B=d.vec3f64.create(),G=d.vec3f64.create(),F=new r,M={center:d.vec3f64.create(),radius:0},R={center:d.vec3f64.create(),radius:0},T={center:d.vec3f64.create(),radius:0},O={center:d.vec3f64.create(),radius:0},L=[{min:0,max:0},{min:0,max:0},{min:0,max:0}],Q=new r,S=new r;return u})},"esri/views/3d/webgl-engine/lib/localOrigin":function(){define(["require",
"exports","../../../../core/libs/gl-matrix-2/vec3f64"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.fromVector=function(f,m){return{vec3:e.vec3f64.clone(f),id:m}};f.fromValues=function(f,m,d,g){return{vec3:e.vec3f64.fromValues(f,m,d),id:g}}})},"esri/views/3d/webgl-engine/materials/RibbonLineMaterial":function(){define("require exports tslib ../../../../core/Logger ../../../../core/mathUtils ../../../../core/maybe ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../support/geometryUtils ../../support/buffer/InterleavedLayout ../lib/geometryDataUtils ../lib/GLMaterial ../lib/Material ../lib/Util ./VisualVariableMaterialParameters ./internal/MaterialUtil ./renderers/MergedRenderer ./renderers/utils ../shaders/RibbonLineTechnique ../shaders/RibbonLineTechnique".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A,E,H,J,B){function G(a,b,c,d,g){for(var e=0;e<g;e++)c[d++]=a[b++];return d}var F=r.getLogger("esri.views.3d.webgl-engine.materials.RibbonLineMaterial");u=function(c){function g(a,b){b=c.call(this,b)||this;b.techniqueConfig=new B.RibbonLineTechniqueConfiguration;b.params=A.copyParameters(a,R);b.validateParams();b.params.transparent=1>b.params.color[3]||b.params.transparent;b.layout=b.createLayout();return b}e.__extends(g,c);g.prototype.dispose=function(){};
g.prototype.setParameterValues=function(a){for(var b in a)"cap"===b?F.error("cap cannot be changed after creation"):"join"===b&&"round"===this.params[b]!==("round"===a[b])?F.error("join cannot be changed after creation"):"stipplePattern"===b&&!!this.params[b]!==!!a[b]?F.error("stippledness cannot be changed after creation"):this.params[b]=a[b];this.validateParams();this.parametersChanged()};g.prototype.getParameters=function(){return this.params};g.prototype.getPassParameters=function(){return this.params};
g.prototype.getTechniqueConfig=function(a){this.techniqueConfig.output=a;a=d.isSome(this.params.stipplePattern);this.techniqueConfig.stippleEnabled=a;this.techniqueConfig.stippleIntegerRepeatsEnabled=a&&this.params.stippleIntegerRepeats;this.techniqueConfig.stippleOffColorEnabled=a&&d.isSome(this.params.stippleOffColor);this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled;this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees;this.techniqueConfig.roundJoins="round"===this.params.join;
this.techniqueConfig.roundCaps="round"===this.params.cap;this.techniqueConfig.transparent=this.params.transparent;this.techniqueConfig.polygonOffset=this.params.polygonOffset;this.techniqueConfig.writeDepth=this.params.writeDepth;this.techniqueConfig.vvColor=this.params.vvColorEnabled;this.techniqueConfig.vvOpacity=this.params.vvOpacityEnabled;this.techniqueConfig.vvSize=this.params.vvSizeEnabled;this.techniqueConfig.innerColorEnabled=0<this.params.innerWidth&&d.isSome(this.params.innerColor);this.techniqueConfig.falloffEnabled=
0<this.params.falloff;this.techniqueConfig.occluder=8===this.renderOccluded;return this.techniqueConfig};g.prototype.intersect=function(a,b,c,d,g,e,w,f,k){k?this.intersectDrapedLineGeometry(a,d,e,w):this.intersectLineGeometry(a,b,c,d,this.params.width,w)};g.prototype.intersectDrapedLineGeometry=function(a,b,c,d){if(b.options.selectionMode){b=a.getAttribute(B.RibbonVertexAttributeConstants.POSITION).data;var g=a.getAttribute(B.RibbonVertexAttributeConstants.SIZE),e=this.params.width;this.params.vvSizeEnabled?
(g=a.getAttribute(B.RibbonVertexAttributeConstants.SIZEFEATUREATTRIBUTE).data[0],e*=m.clamp(this.params.vvSizeOffset[0]+g*this.params.vvSizeFactor[0],this.params.vvSizeMinSize[0],this.params.vvSizeMaxSize[0])):g&&(e*=g.data[0]);g=c[0];c=c[1];a=(e/2+4)*a.pixelRatio;for(var e=Number.MAX_VALUE,w=0;w<b.length-5;w+=3){var f=b[w],k=b[w+1],n=g-f,h=c-k,f=b[w+3]-f,k=b[w+4]-k,p=m.clamp((f*n+k*h)/(f*f+k*k),0,1),n=f*p-n,h=k*p-h,h=n*n+h*h;h<e&&(e=h)}e<a*a&&d()}};g.prototype.intersectLineGeometry=function(b,c,
d,g,e,f){if(g.options.selectionMode&&!H.isInstanceHidden(c))if(x.isTranslationMatrix(d)){c=b.data.getVertexAttr();b=c[B.RibbonVertexAttributeConstants.POSITION].data;this.params.vvSizeEnabled?e*=m.clamp(this.params.vvSizeOffset[0]+c[B.RibbonVertexAttributeConstants.SIZEFEATUREATTRIBUTE].data[0]*this.params.vvSizeFactor[0],this.params.vvSizeMinSize[0],this.params.vvSizeMaxSize[0]):c[B.RibbonVertexAttributeConstants.SIZE]&&(e*=c[B.RibbonVertexAttributeConstants.SIZE].data[0]);var w=g.camera,q=V;k.vec2.copy(q,
g.point);e=e*w.pixelRatio/2+4*w.pixelRatio;l.vec3.set(fa[0],q[0]-e,q[1]+e,0);l.vec3.set(fa[1],q[0]+e,q[1]+e,0);l.vec3.set(fa[2],q[0]+e,q[1]-e,0);l.vec3.set(fa[3],q[0]-e,q[1]-e,0);for(var I=0;4>I;I++)w.unprojectPoint(fa[I],la[I]);a.plane.fromPoints(w.eye,la[0],la[1],ia);a.plane.fromPoints(w.eye,la[1],la[2],ca);a.plane.fromPoints(w.eye,la[2],la[3],C);a.plane.fromPoints(w.eye,la[3],la[0],na);c=Number.MAX_VALUE;for(var n=this.params.isClosed?b.length-2:b.length-5,I=0;I<n;I+=3){Q[0]=b[I]+d[12];Q[1]=b[I+
1]+d[13];Q[2]=b[I+2]+d[14];var h=(I+3)%b.length;S[0]=b[h]+d[12];S[1]=b[h+1]+d[13];S[2]=b[h+2]+d[14];if(!(0>a.plane.signedDistance(ia,Q)&&0>a.plane.signedDistance(ia,S)||0>a.plane.signedDistance(ca,Q)&&0>a.plane.signedDistance(ca,S)||0>a.plane.signedDistance(C,Q)&&0>a.plane.signedDistance(C,S)||0>a.plane.signedDistance(na,Q)&&0>a.plane.signedDistance(na,S))){w.projectPoint(Q,Z);w.projectPoint(S,ha);if(0>Z[2]&&0<ha[2]){l.vec3.subtract(aa,Q,S);var h=w.frustum,p=-a.plane.signedDistance(h.planes[4],Q),
h=p/l.vec3.dot(aa,a.plane.normal(h.planes[4]));l.vec3.scale(aa,aa,h);l.vec3.add(Q,Q,aa);w.projectPoint(Q,Z)}else if(0<Z[2]&&0>ha[2])l.vec3.subtract(aa,S,Q),h=w.frustum,p=-a.plane.signedDistance(h.planes[4],S),h=p/l.vec3.dot(aa,a.plane.normal(h.planes[4])),l.vec3.scale(aa,aa,h),l.vec3.add(S,S,aa),w.projectPoint(S,ha);else if(0>Z[2]&&0>ha[2])continue;Z[2]=0;ha[2]=0;h=a.lineSegment.distance2(a.lineSegment.fromPoints(Z,ha,ga),q);h<c&&(c=h,l.vec3.copy(X,Q),l.vec3.copy(ea,S))}}d=g.rayBeginPoint;g=g.rayEndPoint;
c<e*e&&(b=Number.MAX_VALUE,a.lineSegment.closestLineSegmentPoint(a.lineSegment.fromPoints(X,ea,ga),a.lineSegment.fromPoints(d,g,oa),ba)&&(l.vec3.subtract(ba,ba,d),b=l.vec3.length(ba),l.vec3.scale(ba,ba,1/b),b/=l.vec3.distance(d,g)),f(b,ba))}else F.error("intersection assumes a translation-only matrix")};g.prototype.computeAttachmentOrigin=function(a,b){var c=a.data;a="getVertexAttr"in c?c.getVertexAttr():"vertexAttr"in c?c.vertexAttr:null;if(!a)return null;var d=B.RibbonVertexAttributeConstants.POSITION,
c="getVertexAttr"in c?c.getIndices(d):null;return q.computeAttachmentOriginLines(a[d],c,c&&this.params.isClosed,b)};g.prototype.createLayout=function(){var a=b.newLayout().vec3f(B.RibbonVertexAttributeConstants.POSITION).f32(B.RibbonVertexAttributeConstants.SUBDIVISIONFACTOR).vec2f(B.RibbonVertexAttributeConstants.UV0).vec3f(B.RibbonVertexAttributeConstants.AUXPOS1).vec3f(B.RibbonVertexAttributeConstants.AUXPOS2);this.params.vvSizeEnabled?a.f32(B.RibbonVertexAttributeConstants.SIZEFEATUREATTRIBUTE):
a.f32(B.RibbonVertexAttributeConstants.SIZE);this.params.vvColorEnabled?a.f32(B.RibbonVertexAttributeConstants.COLORFEATUREATTRIBUTE):a.vec4f(B.RibbonVertexAttributeConstants.COLOR);this.params.vvOpacityEnabled&&a.f32(B.RibbonVertexAttributeConstants.OPACITYFEATUREATTRIBUTE);return a};g.prototype.createBufferWriter=function(){return new T(this.layout,this.params)};g.prototype.createRenderer=function(a,b){return new E(a,b,this,B.ribbonVertexAttributeLocations)};g.prototype.getGLMaterial=function(a){return 0===
a.output||4===a.output?new M(a):void 0};g.prototype.validateParams=function(){"miter"!==this.params.join&&(this.params.miterLimit=0)};return g}(t.Material);var M=function(a){function b(b){b=a.call(this,b)||this;b.updateParameters();return b}e.__extends(b,a);b.prototype.updateParameters=function(){this.technique=this.techniqueRep.acquireAndReleaseExisting(J.RibbonLineTechnique,this.material.getTechniqueConfig(this.output),this.technique)};b.prototype.beginSlot=function(a){return this.technique.configuration.occluder?
3===a||10===a||11===a:0===this.output?(this.targetSlot=this.technique.configuration.writeDepth?5:8,a===this.targetSlot):3===a};b.prototype._updateOccludeeState=function(a){a.hasOccludees!==this.material.getParameters().sceneHasOcludees&&(this.material.setParameterValues({sceneHasOcludees:a.hasOccludees}),this.updateParameters())};b.prototype.ensureParameters=function(a){0===this.output&&this._updateOccludeeState(a)};b.prototype.bind=function(a,b){a.bindProgram(this.technique.program);this.technique.bindPass(a,
this.material.getPassParameters(),b)};b.prototype.getPipelineState=function(a,b){return b?this.technique.occludeePipeline:this.technique.configuration.occluder?11===a?this.technique.occluderPipelineTransparent:10===a?this.technique.occluderPipelineOpaque:this.technique.occluderPipelineMaskWrite:this.technique.pipeline};return b}(v.GLMaterial),R=e.__assign({width:0,color:[1,1,1,1],join:"miter",cap:"butt",miterLimit:5,writeDepth:!0,polygonOffset:!1,stipplePattern:null,stippleIntegerRepeats:!1,stippleOffColor:null,
slicePlaneEnabled:!1,vvFastUpdate:!1,transparent:!1,isClosed:!1,falloff:0,innerWidth:0,innerColor:null,sceneHasOcludees:!1},z.Default),T=function(){function a(a,b){this.params=b;this.numJoinSubdivisions=this.numCapSubdivisions=0;this.vertexBufferLayout=a;if(!b.isClosed)switch(this.params.cap){case "butt":this.numCapSubdivisions=0;break;case "square":this.numCapSubdivisions=1;break;case "round":this.numCapSubdivisions=O}switch(this.params.join){case "miter":case "bevel":this.numJoinSubdivisions=b.stipplePattern?
1:0;break;case "round":this.numJoinSubdivisions=L}}a.prototype.allocate=function(a){return this.vertexBufferLayout.createBuffer(a)};a.prototype.elementCount=function(a){var b=2*this.numCapSubdivisions+2,c=a.indices[B.RibbonVertexAttributeConstants.POSITION].length/2+1,d=this.params.isClosed,b=d?2:2*b,g=d?0:1,c=d?c:c-1;if(a.vertexAttr[B.RibbonVertexAttributeConstants.SUBDIVISIONS])for(a=a.vertexAttr[B.RibbonVertexAttributeConstants.SUBDIVISIONS].data;g<c;++g)b+=4+2*a[g];else b+=(c-g)*(2*this.numJoinSubdivisions+
4);return b+2};a.prototype.write=function(a,b,c,d){var g=this,e=ja,f=da,w=ma,k=b.vertexAttr[B.RibbonVertexAttributeConstants.POSITION].data,q=b.indices&&b.indices[B.RibbonVertexAttributeConstants.POSITION];q&&q.length!==2*(k.length/3-1)&&console.warn("RibbonLineMaterial does not support indices");q=null;b.vertexAttr[B.RibbonVertexAttributeConstants.SUBDIVISIONS]&&(q=b.vertexAttr[B.RibbonVertexAttributeConstants.SUBDIVISIONS].data);var n=1,h=0;this.params.vvSizeEnabled?h=b.vertexAttr[B.RibbonVertexAttributeConstants.SIZEFEATUREATTRIBUTE].data[0]:
b.vertexAttr[B.RibbonVertexAttributeConstants.SIZE]&&(n=b.vertexAttr[B.RibbonVertexAttributeConstants.SIZE].data[0]);var p=[1,1,1,1],y=0;this.params.vvColorEnabled?y=b.vertexAttr[B.RibbonVertexAttributeConstants.COLORFEATUREATTRIBUTE].data[0]:b.vertexAttr[B.RibbonVertexAttributeConstants.COLOR]&&(p=b.vertexAttr[B.RibbonVertexAttributeConstants.COLOR].data);var D=0;this.params.vvOpacityEnabled&&(D=b.vertexAttr[B.RibbonVertexAttributeConstants.OPACITYFEATUREATTRIBUTE].data[0]);b=k.length/3;a=a.transformation;
var K=new Float32Array(c.buffer);c=this.vertexBufferLayout.stride/4;var P=d*c;d=P;var N=function(a,b,c,d,w,e){K[P++]=b[0];K[P++]=b[1];K[P++]=b[2];K[P++]=d;K[P++]=w;K[P++]=e;K[P++]=a[0];K[P++]=a[1];K[P++]=a[2];K[P++]=c[0];K[P++]=c[1];K[P++]=c[2];g.params.vvSizeEnabled?K[P++]=h:K[P++]=n;g.params.vvColorEnabled?K[P++]=y:(K[P++]=p[0],K[P++]=p[1],K[P++]=p[2],K[P++]=p[3]);g.params.vvOpacityEnabled&&(K[P++]=D)},P=P+c;l.vec3.set(f,k[0],k[1],k[2]);a&&l.vec3.transformMat4(f,f,a);var U=this.params.isClosed;
if(U){var ka=k.length-3;l.vec3.set(e,k[ka],k[ka+1],k[ka+2]);a&&l.vec3.transformMat4(e,e,a)}else{l.vec3.copy(e,f);l.vec3.set(w,k[3],k[4],k[5]);a&&l.vec3.transformMat4(w,w,a);for(ka=0;ka<this.numCapSubdivisions;++ka){var m=1-ka/this.numCapSubdivisions;N(e,f,w,m,1,-4);N(e,f,w,m,1,4)}N(e,f,w,0,0,-4);N(e,f,w,0,0,4);l.vec3.copy(e,f);l.vec3.copy(f,w)}for(var t=U?b:b-1,ka=U?0:1;ka<t;ka++){m=(ka+1)%b*3;l.vec3.set(w,k[m+0],k[m+1],k[m+2]);a&&l.vec3.transformMat4(w,w,a);N(e,f,w,0,1,-1);N(e,f,w,0,1,1);for(var r=
q?q[ka]:this.numJoinSubdivisions,v=0;v<r;++v)m=(v+1)/(r+1),N(e,f,w,m,1,-2),N(e,f,w,m,1,2);N(e,f,w,1,0,-2);N(e,f,w,1,0,2);l.vec3.copy(e,f);l.vec3.copy(f,w)}if(U)P=G(K,d+c,K,P,2*c);else for(N(e,f,w,0,1,-5),N(e,f,w,0,1,5),ka=0;ka<this.numCapSubdivisions;++ka)m=(ka+1)/this.numCapSubdivisions,N(e,f,w,m,1,-5),N(e,f,w,m,1,5);G(K,d+c,K,d,c);P=G(K,P-c,K,P,c)};return a}(),O=3,L=1,Q=c.vec3f64.create(),S=c.vec3f64.create(),aa=c.vec3f64.create(),ba=c.vec3f64.create(),V=c.vec3f64.create(),Z=g.createRenderScreenPointArray3(),
ha=g.createRenderScreenPointArray3(),X=c.vec3f64.create(),ea=c.vec3f64.create(),ga=a.lineSegment.create(),oa=a.lineSegment.create(),ja=c.vec3f64.create(),da=c.vec3f64.create(),ma=c.vec3f64.create(),fa=[g.createRenderScreenPointArray3(),g.createRenderScreenPointArray3(),g.createRenderScreenPointArray3(),g.createRenderScreenPointArray3()],la=[c.vec3f64.create(),c.vec3f64.create(),c.vec3f64.create(),c.vec3f64.create()],ia=a.plane.create(),ca=a.plane.create(),C=a.plane.create(),na=a.plane.create();return u})},
"esri/views/3d/support/buffer/InterleavedLayout":function(){define(["require","exports","./BufferView","./types"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});var m=function(){function d(d,g){this.layout=d;this.buffer="number"===typeof g?new ArrayBuffer(g*d.stride):g;g=0;for(var c=d.fieldNames;g<c.length;g++){var a=c[g],b=d.fields.get(a);this[a]=new b.constructor(this.buffer,b.offset,this.stride)}}Object.defineProperty(d.prototype,"stride",{get:function(){return this.layout.stride},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"count",{get:function(){return this.buffer.byteLength/this.stride},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"byteLength",{get:function(){return this.buffer.byteLength},enumerable:!0,configurable:!0});d.prototype.getField=function(d,g){return(d=this[d])&&d.elementCount===g.ElementCount&&d.elementType===g.ElementType?d:null};d.prototype.slice=function(g,e){return new d(this.layout,this.buffer.slice(g*this.stride,
e*this.stride))};d.prototype.copyFrom=function(d,g,c,a){var b=this.stride;0===b%4?(d=new Uint32Array(d.buffer,g*b,a*b/4),c=new Uint32Array(this.buffer,c*b,a*b/4)):(d=new Uint8Array(d.buffer,g*b,a*b),c=new Uint8Array(this.buffer,c*b,a*b));c.set(d)};return d}();f.InterleavedBuffer=m;var d=function(){function d(){this.stride=0;this.fields=new Map;this.fieldNames=[]}d.prototype.vec2f=function(d,g){this.appendField(d,e.BufferViewVec2f,g);return this};d.prototype.vec2f64=function(d,g){this.appendField(d,
e.BufferViewVec2f64,g);return this};d.prototype.vec3f=function(d,g){this.appendField(d,e.BufferViewVec3f,g);return this};d.prototype.vec3f64=function(d,g){this.appendField(d,e.BufferViewVec3f64,g);return this};d.prototype.vec4f=function(d,g){this.appendField(d,e.BufferViewVec4f,g);return this};d.prototype.vec4f64=function(d,g){this.appendField(d,e.BufferViewVec4f64,g);return this};d.prototype.mat3f=function(d,g){this.appendField(d,e.BufferViewMat3f,g);return this};d.prototype.mat3f64=function(d,g){this.appendField(d,
e.BufferViewMat3f64,g);return this};d.prototype.mat4f=function(d,g){this.appendField(d,e.BufferViewMat4f,g);return this};d.prototype.mat4f64=function(d,g){this.appendField(d,e.BufferViewMat4f64,g);return this};d.prototype.vec4u8=function(d,g){this.appendField(d,e.BufferViewVec4u8,g);return this};d.prototype.f32=function(d,g){this.appendField(d,e.BufferViewFloat,g);return this};d.prototype.f64=function(d,g){this.appendField(d,e.BufferViewFloat64,g);return this};d.prototype.u8=function(d,g){this.appendField(d,
e.BufferViewUint8,g);return this};d.prototype.u16=function(d,g){this.appendField(d,e.BufferViewUint16,g);return this};d.prototype.i8=function(d,g){this.appendField(d,e.BufferViewInt8,g);return this};d.prototype.vec2i8=function(d,g){this.appendField(d,e.BufferViewVec2i8,g);return this};d.prototype.vec2i16=function(d,g){this.appendField(d,e.BufferViewVec2i16,g);return this};d.prototype.vec2u8=function(d,g){this.appendField(d,e.BufferViewVec2u8,g);return this};d.prototype.vec4u16=function(d,g){this.appendField(d,
e.BufferViewVec4u16,g);return this};d.prototype.u32=function(d,g){this.appendField(d,e.BufferViewUint32,g);return this};d.prototype.appendField=function(d,g,c){var a=g.ElementCount*r.elementTypeSize(g.ElementType);this.fields.set(d,{size:a,constructor:g,offset:this.stride,optional:c});this.stride+=a;this.fieldNames.push(d)};d.prototype.alignTo=function(d){this.stride=Math.floor((this.stride+d-1)/d)*d;return this};d.prototype.hasField=function(d){return 0<=this.fieldNames.indexOf(d)};d.prototype.createBuffer=
function(d){return new m(this,d)};d.prototype.createView=function(d){return new m(this,d)};d.prototype.clone=function(){var g=new d;g.stride=this.stride;g.fields=new Map;this.fields.forEach(function(d,c){return g.fields.set(c,d)});g.fieldNames=this.fieldNames.slice();g.BufferType=this.BufferType;return g};return d}();f.InterleavedLayout=d;f.newLayout=function(){return new d}})},"esri/views/3d/support/buffer/BufferView":function(){define("require exports tslib ./internals/Mat3 ./internals/Mat4 ./internals/Scalar ./internals/Vec2 ./internals/Vec3 ./internals/Vec4".split(" "),
function(u,f,e,r,m,d,g,k,l){Object.defineProperty(f,"__esModule",{value:!0});u=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Float32Array,a,d,g,e)||this;a.elementType="f32";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="f32";return a}(d.BufferViewScalarImpl);f.BufferViewFloat=u;u=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Float32Array,a,d,g,e)||this;a.elementType="f32";
return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="f32";return a}(g.BufferViewVec2Impl);f.BufferViewVec2f=u;u=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Float32Array,a,d,g,e)||this;a.elementType="f32";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="f32";return a}(k.BufferViewVec3Impl);f.BufferViewVec3f=u;
u=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Float32Array,a,d,g,e)||this;a.elementType="f32";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="f32";return a}(l.BufferViewVec4Impl);f.BufferViewVec4f=u;u=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Float32Array,a,d,g,e)||this;a.elementType="f32";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,
b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="f32";return a}(r.BufferViewMat3Impl);f.BufferViewMat3f=u;r=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Float64Array,a,d,g,e)||this;a.elementType="f64";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="f64";return a}(r.BufferViewMat3Impl);f.BufferViewMat3f64=r;r=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Float32Array,
a,d,g,e)||this;a.elementType="f32";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="f32";return a}(m.BufferViewMat4Impl);f.BufferViewMat4f=r;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Float64Array,a,d,g,e)||this;a.elementType="f64";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="f64";return a}(m.BufferViewMat4Impl);
f.BufferViewMat4f64=m;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Float64Array,a,d,g,e)||this;a.elementType="f64";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="f64";return a}(d.BufferViewScalarImpl);f.BufferViewFloat64=m;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Float64Array,a,d,g,e)||this;a.elementType="f64";return a}e.__extends(a,c);a.fromTypedArray=function(b,
c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="f64";return a}(g.BufferViewVec2Impl);f.BufferViewVec2f64=m;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Float64Array,a,d,g,e)||this;a.elementType="f64";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="f64";return a}(k.BufferViewVec3Impl);f.BufferViewVec3f64=m;m=function(c){function a(a,d,g,e){void 0===d&&(d=
0);a=c.call(this,Float64Array,a,d,g,e)||this;a.elementType="f64";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="f64";return a}(l.BufferViewVec4Impl);f.BufferViewVec4f64=m;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Uint8Array,a,d,g,e)||this;a.elementType="u8";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType=
"u8";return a}(d.BufferViewScalarImpl);f.BufferViewUint8=m;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Uint8Array,a,d,g,e)||this;a.elementType="u8";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="u8";return a}(g.BufferViewVec2Impl);f.BufferViewVec2u8=m;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Uint8Array,a,d,g,e)||this;a.elementType="u8";return a}e.__extends(a,c);
a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="u8";return a}(k.BufferViewVec3Impl);f.BufferViewVec3u8=m;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Uint8Array,a,d,g,e)||this;a.elementType="u8";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="u8";return a}(l.BufferViewVec4Impl);f.BufferViewVec4u8=m;m=function(c){function a(a,d,
g,e){void 0===d&&(d=0);a=c.call(this,Uint16Array,a,d,g,e)||this;a.elementType="u16";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="u16";return a}(d.BufferViewScalarImpl);f.BufferViewUint16=m;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Uint16Array,a,d,g,e)||this;a.elementType="u16";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+
b.byteLength)};a.ElementType="u16";return a}(g.BufferViewVec2Impl);f.BufferViewVec2u16=m;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Uint16Array,a,d,g,e)||this;a.elementType="u16";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="u16";return a}(k.BufferViewVec3Impl);f.BufferViewVec3u16=m;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Uint16Array,a,d,g,e)||this;a.elementType=
"u16";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="u16";return a}(l.BufferViewVec4Impl);f.BufferViewVec4u16=m;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Uint32Array,a,d,g,e)||this;a.elementType="u32";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="u32";return a}(d.BufferViewScalarImpl);f.BufferViewUint32=
m;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Uint32Array,a,d,g,e)||this;a.elementType="u32";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="u32";return a}(g.BufferViewVec2Impl);f.BufferViewVec2u32=m;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Uint32Array,a,d,g,e)||this;a.elementType="u32";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,
b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="u32";return a}(k.BufferViewVec3Impl);f.BufferViewVec3u32=m;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Uint32Array,a,d,g,e)||this;a.elementType="u32";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="u32";return a}(l.BufferViewVec4Impl);f.BufferViewVec4u32=m;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Int8Array,
a,d,g,e)||this;a.elementType="i8";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="i8";return a}(d.BufferViewScalarImpl);f.BufferViewInt8=m;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Int8Array,a,d,g,e)||this;a.elementType="i8";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="i8";return a}(g.BufferViewVec2Impl);
f.BufferViewVec2i8=m;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Int8Array,a,d,g,e)||this;a.elementType="i8";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="i8";return a}(k.BufferViewVec3Impl);f.BufferViewVec3i8=m;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Int8Array,a,d,g,e)||this;a.elementType="i8";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,
b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="i8";return a}(l.BufferViewVec4Impl);f.BufferViewVec4i8=m;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Int16Array,a,d,g,e)||this;a.elementType="i16";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="i16";return a}(d.BufferViewScalarImpl);f.BufferViewInt16=m;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Int16Array,a,
d,g,e)||this;a.elementType="i16";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="i16";return a}(g.BufferViewVec2Impl);f.BufferViewVec2i16=m;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Int16Array,a,d,g,e)||this;a.elementType="i16";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="i16";return a}(k.BufferViewVec3Impl);
f.BufferViewVec3i16=m;m=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Int16Array,a,d,g,e)||this;a.elementType="i16";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="i16";return a}(l.BufferViewVec4Impl);f.BufferViewVec4i16=m;d=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Int32Array,a,d,g,e)||this;a.elementType="i32";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,
b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="i32";return a}(d.BufferViewScalarImpl);f.BufferViewInt32=d;g=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Int32Array,a,d,g,e)||this;a.elementType="i32";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="i32";return a}(g.BufferViewVec2Impl);f.BufferViewVec2i32=g;k=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Int32Array,
a,d,g,e)||this;a.elementType="i32";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="i32";return a}(k.BufferViewVec3Impl);f.BufferViewVec3i32=k;l=function(c){function a(a,d,g,e){void 0===d&&(d=0);a=c.call(this,Int32Array,a,d,g,e)||this;a.elementType="i32";return a}e.__extends(a,c);a.fromTypedArray=function(b,c){return new a(b.buffer,b.byteOffset,c,b.byteOffset+b.byteLength)};a.ElementType="i32";return a}(l.BufferViewVec4Impl);
f.BufferViewVec4i32=l})},"esri/views/3d/support/buffer/internals/Mat3":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function e(e,f,d,g,k){void 0===d&&(d=0);this.TypedArrayConstructor=e;this.elementCount=9;e=this.TypedArrayConstructor;void 0===g&&(g=9*e.BYTES_PER_ELEMENT);var l=0===f.byteLength?0:d;this.typedBuffer=null==k?new e(f,l):new e(f,l,(k-d)/e.BYTES_PER_ELEMENT);this.typedBufferStride=g/e.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/
this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}e.prototype.getMat=function(e,f){e*=this.typedBufferStride;for(var d=0;9>d;d++)f[d]=this.typedBuffer[e+d];return f};e.prototype.setMat=function(e,f){e*=this.typedBufferStride;for(var d=0;9>d;d++)this.typedBuffer[e+d]=f[d]};e.prototype.get=function(e,f){return this.typedBuffer[e*this.typedBufferStride+f]};e.prototype.set=function(e,f,d){this.typedBuffer[e*this.typedBufferStride+f]=d};e.prototype.copyFrom=
function(e,f,d){var g=this.typedBuffer,k=f.typedBuffer;e*=this.typedBufferStride;f=d*f.typedBufferStride;for(d=0;9>d;++d)g[e+d]=k[f+d]};Object.defineProperty(e.prototype,"buffer",{get:function(){return this.typedBuffer.buffer},enumerable:!0,configurable:!0});e.ElementCount=9;return e}();f.BufferViewMat3Impl=u})},"esri/views/3d/support/buffer/internals/Mat4":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function e(e,f,d,g,k){void 0===
d&&(d=0);this.TypedArrayConstructor=e;this.elementCount=16;e=this.TypedArrayConstructor;void 0===g&&(g=16*e.BYTES_PER_ELEMENT);var l=0===f.byteLength?0:d;this.typedBuffer=null==k?new e(f,l):new e(f,l,(k-d)/e.BYTES_PER_ELEMENT);this.typedBufferStride=g/e.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}e.prototype.getMat=function(e,f){e*=this.typedBufferStride;for(var d=0;16>d;d++)f[d]=
this.typedBuffer[e+d];return f};e.prototype.setMat=function(e,f){e*=this.typedBufferStride;for(var d=0;16>d;d++)this.typedBuffer[e+d]=f[d]};e.prototype.get=function(e,f){return this.typedBuffer[e*this.typedBufferStride+f]};e.prototype.set=function(e,f,d){this.typedBuffer[e*this.typedBufferStride+f]=d};e.prototype.copyFrom=function(e,f,d){var g=this.typedBuffer,k=f.typedBuffer;e*=this.typedBufferStride;f=d*f.typedBufferStride;for(d=0;16>d;++d)g[e+d]=k[f+d]};Object.defineProperty(e.prototype,"buffer",
{get:function(){return this.typedBuffer.buffer},enumerable:!0,configurable:!0});e.ElementCount=16;return e}();f.BufferViewMat4Impl=u})},"esri/views/3d/support/buffer/internals/Scalar":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function e(e,f,d,g,k){void 0===d&&(d=0);this.TypedArrayConstructor=e;this.elementCount=1;e=this.TypedArrayConstructor;void 0===g&&(g=e.BYTES_PER_ELEMENT);var l=0===f.byteLength?0:d;this.typedBuffer=null==
k?new e(f,l):new e(f,l,(k-d)/e.BYTES_PER_ELEMENT);this.typedBufferStride=g/e.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}e.prototype.get=function(e){return this.typedBuffer[e*this.typedBufferStride]};e.prototype.set=function(e,f){this.typedBuffer[e*this.typedBufferStride]=f};Object.defineProperty(e.prototype,"buffer",{get:function(){return this.typedBuffer.buffer},enumerable:!0,
configurable:!0});e.ElementCount=1;return e}();f.BufferViewScalarImpl=u})},"esri/views/3d/support/buffer/internals/Vec2":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/vec2"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function f(e,d,g,f,l){void 0===g&&(g=0);this.TypedArrayConstructor=e;this.elementCount=2;e=this.TypedArrayConstructor;void 0===f&&(f=2*e.BYTES_PER_ELEMENT);var c=0===d.byteLength?0:g;this.typedBuffer=null==l?new e(d,c):
new e(d,c,(l-g)/e.BYTES_PER_ELEMENT);this.typedBufferStride=f/e.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}f.prototype.getVec=function(f,d){return e.vec2.set(d,this.typedBuffer[f*this.typedBufferStride],this.typedBuffer[f*this.typedBufferStride+1])};f.prototype.setVec=function(e,d){this.typedBuffer[e*this.typedBufferStride]=d[0];this.typedBuffer[e*this.typedBufferStride+1]=d[1]};
f.prototype.get=function(e,d){return this.typedBuffer[e*this.typedBufferStride+d]};f.prototype.set=function(e,d,g){this.typedBuffer[e*this.typedBufferStride+d]=g};f.prototype.setValues=function(e,d,g){this.typedBuffer[e*this.typedBufferStride]=d;this.typedBuffer[e*this.typedBufferStride+1]=g};f.prototype.copyFrom=function(e,d,g){var f=this.typedBuffer,l=d.typedBuffer;e*=this.typedBufferStride;d=g*d.typedBufferStride;f[e]=l[d];f[e+1]=l[d+1]};Object.defineProperty(f.prototype,"buffer",{get:function(){return this.typedBuffer.buffer},
enumerable:!0,configurable:!0});f.ElementCount=2;return f}();f.BufferViewVec2Impl=u})},"esri/views/3d/support/buffer/internals/Vec3":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/vec3"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function f(e,d,g,f,l){void 0===g&&(g=0);this.TypedArrayConstructor=e;this.elementCount=3;e=this.TypedArrayConstructor;void 0===f&&(f=3*e.BYTES_PER_ELEMENT);var c=0===d.byteLength?0:g;this.typedBuffer=null==
l?new e(d,c):new e(d,c,(l-g)/e.BYTES_PER_ELEMENT);this.typedBufferStride=f/e.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}f.prototype.getVec=function(f,d){return e.vec3.set(d,this.typedBuffer[f*this.typedBufferStride],this.typedBuffer[f*this.typedBufferStride+1],this.typedBuffer[f*this.typedBufferStride+2])};f.prototype.setVec=function(e,d){this.typedBuffer[e*this.typedBufferStride]=
d[0];this.typedBuffer[e*this.typedBufferStride+1]=d[1];this.typedBuffer[e*this.typedBufferStride+2]=d[2]};f.prototype.get=function(e,d){return this.typedBuffer[e*this.typedBufferStride+d]};f.prototype.set=function(e,d,g){this.typedBuffer[e*this.typedBufferStride+d]=g};f.prototype.setValues=function(e,d,g,f){this.typedBuffer[e*this.typedBufferStride]=d;this.typedBuffer[e*this.typedBufferStride+1]=g;this.typedBuffer[e*this.typedBufferStride+2]=f};f.prototype.copyFrom=function(e,d,g){var f=this.typedBuffer,
l=d.typedBuffer;e*=this.typedBufferStride;d=g*d.typedBufferStride;f[e]=l[d];f[e+1]=l[d+1];f[e+2]=l[d+2]};Object.defineProperty(f.prototype,"buffer",{get:function(){return this.typedBuffer.buffer},enumerable:!0,configurable:!0});f.ElementCount=3;return f}();f.BufferViewVec3Impl=u})},"esri/views/3d/support/buffer/internals/Vec4":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/vec4"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function f(e,
d,g,f,l){void 0===g&&(g=0);this.TypedArrayConstructor=e;this.elementCount=4;e=this.TypedArrayConstructor;void 0===f&&(f=4*e.BYTES_PER_ELEMENT);var c=0===d.byteLength?0:g;this.typedBuffer=null==l?new e(d,c):new e(d,c,(l-g)/e.BYTES_PER_ELEMENT);this.typedBufferStride=f/e.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}f.prototype.getVec=function(f,d){return e.vec4.set(d,this.typedBuffer[f*
this.typedBufferStride],this.typedBuffer[f*this.typedBufferStride+1],this.typedBuffer[f*this.typedBufferStride+2],this.typedBuffer[f*this.typedBufferStride+3])};f.prototype.setVec=function(e,d){this.typedBuffer[e*this.typedBufferStride]=d[0];this.typedBuffer[e*this.typedBufferStride+1]=d[1];this.typedBuffer[e*this.typedBufferStride+2]=d[2];this.typedBuffer[e*this.typedBufferStride+3]=d[3]};f.prototype.get=function(e,d){return this.typedBuffer[e*this.typedBufferStride+d]};f.prototype.set=function(e,
d,g){this.typedBuffer[e*this.typedBufferStride+d]=g};f.prototype.setValues=function(e,d,g,f,l){this.typedBuffer[e*this.typedBufferStride]=d;this.typedBuffer[e*this.typedBufferStride+1]=g;this.typedBuffer[e*this.typedBufferStride+2]=f;this.typedBuffer[e*this.typedBufferStride+3]=l};f.prototype.copyFrom=function(e,d,g){var f=this.typedBuffer,l=d.typedBuffer;e*=this.typedBufferStride;d=g*d.typedBufferStride;f[e]=l[d];f[e+1]=l[d+1];f[e+2]=l[d+2];f[e+3]=l[d+3]};Object.defineProperty(f.prototype,"buffer",
{get:function(){return this.typedBuffer.buffer},enumerable:!0,configurable:!0});f.ElementCount=4;return f}();f.BufferViewVec4Impl=u})},"esri/views/3d/support/buffer/types":function(){define(["require","exports","../../../../core/compilerUtils"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.elementTypeSize=function(f){switch(f){case "u8":return 1;case "u16":return 2;case "u32":return 4;case "i8":return 1;case "i16":return 2;case "i32":return 4;case "f32":return 4;case "f64":return 8;
default:e.neverReached(f)}};f.isSigned=function(f){switch(f){case "u8":case "u16":case "u32":return!1;case "i8":case "i16":case "i32":case "f32":case "f64":return!0;default:e.neverReached(f)}};f.isInteger=function(f){switch(f){case "u8":case "u16":case "u32":case "i8":case "i16":case "i32":return!0;case "f32":case "f64":return!1;default:e.neverReached(f)}};f.maximumValue=function(f){switch(f){case "u8":return 255;case "u16":return 65535;case "u32":return 4294967295;case "i8":return 127;case "i16":return 32767;
case "i32":return 2147483647;case "f32":return 3.402823E38;case "f64":return 1.79769E308;default:e.neverReached(f)}}})},"esri/views/3d/webgl-engine/lib/GLMaterial":function(){define(["require","exports","tslib","./AutoDisposable"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});u=function(f){function d(d){var g=f.call(this)||this;g.material=d.material;g.techniqueRep=d.techniqueRep;g.output=d.output;return g}e.__extends(d,f);d.prototype.getTechnique=function(){return this.technique};
d.prototype.getPipelineState=function(d,e){return this.getTechnique().pipeline};d.prototype.ensureResources=function(d){return 2};d.prototype.ensureParameters=function(d){};return d}(r.AutoDisposable);f.GLMaterial=u})},"esri/views/3d/webgl-engine/lib/Material":function(){define(["require","exports","../../../../core/maybe","./IdGen"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function f(d){this.supportsEdges=!1;this._visible=!0;this._renderOccluded=1;this._insertOrder=
this._renderPriority=0;this.id=f._idGen.gen(d)}f.prototype.dispose=function(){};f.prototype.update=function(d){return!1};Object.defineProperty(f.prototype,"visible",{get:function(){return this._visible},set:function(d){d!==this._visible&&(this._visible=d,this.parametersChanged())},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"renderOccluded",{get:function(){return this._renderOccluded},set:function(d){d!==this._renderOccluded&&(this._renderOccluded=d,this.parametersChanged())},
enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"renderPriority",{get:function(){return this._renderPriority},set:function(d){d!==this._renderPriority&&(this._renderPriority=d,this.parametersChanged())},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"insertOrder",{get:function(){return this._insertOrder},set:function(d){d!==this._insertOrder&&(this._insertOrder=d,this.parametersChanged())},enumerable:!0,configurable:!0});f.prototype.isVisibleInPass=function(d){return!0};
f.prototype.isVisible=function(){return this._visible};f.prototype.parametersChanged=function(){e.isSome(this.materialRepository)&&this.materialRepository.materialChanged(this)};f._idGen=new r.IdGen;return f}();f.Material=u;f.materialPredicate=function(e,d){return e.isVisible()&&e.isVisibleInPass(d.pass)&&0!==(e.renderOccluded&d.renderOccludedMask)}})},"esri/views/3d/webgl-engine/materials/VisualVariableMaterialParameters":function(){define(["require","exports","../../../../core/libs/gl-matrix-2/mat3f64",
"../../../../core/libs/gl-matrix-2/vec3f32"],function(u,f,e,r){var m;(m||(m={})).Default={vvSizeEnabled:!1,vvSizeMinSize:r.vec3f32.fromValues(1,1,1),vvSizeMaxSize:r.vec3f32.fromValues(100,100,100),vvSizeOffset:r.vec3f32.fromValues(0,0,0),vvSizeFactor:r.vec3f32.fromValues(1,1,1),vvSizeValue:r.vec3f32.fromValues(1,1,1),vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],vvOpacityEnabled:!1,vvOpacityValues:[0,0,0,0,0,0,0,0],
vvOpacityOpacities:[1,1,1,1,1,1,1,1],vvSymbolAnchor:[0,0,0],vvSymbolRotationMatrix:e.mat3f64.create()};return m})},"esri/views/3d/webgl-engine/materials/internal/MaterialUtil":function(){define("require exports ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../../../../../geometry/support/aaBoundingBox ../../lib/screenSizePerspectiveUtils ../../lib/Util ../renderers/utils".split(" "),function(u,f,e,r,m,
d,g,k,l,c){function a(c,d,e,f,k,l){var q=v(d,e,J);g.setMin(E,c.getBBMin());g.setMax(E,c.getBBMax());r.isSome(k)&&k.applyToAABB(E);if(t(E,d,q,f)){var q=c.getPrimitiveIndices(),m=c.getIndices(),x=c.getPosition(),z=q?q.length:m.length/3;if(z>R&&(c=c.getChildren(),void 0!==c)){for(q=0;8>q;++q)void 0!==c[q]&&a(c[q],d,e,f,k,l);return}b(d,e,0,z,m,x,q,k,l)}}function b(a,b,c,d,g,e,f,k,l){var t,m,v;if(f){var x,z,A=e.data,E=e.offsetIdx;e=e.strideIdx;var u=a[0],H=a[1];a=a[2];var F=b[0]-u,J=b[1]-H;for(b=b[2]-
a;c<d;++c){var R=f[c],C=3*R;z=E+e*g[C++];var M=A[z++],Q=A[z++];t=A[z];z=E+e*g[C++];var L=A[z++];m=A[z++];x=A[z];z=E+e*g[C];C=A[z++];v=A[z++];z=A[z];r.isSome(k)&&(t=k.applyToVertex(M,Q,t),M=t[0],Q=t[1],t=t[2],x=k.applyToVertex(L,m,x),L=x[0],m=x[1],x=x[2],z=k.applyToVertex(C,v,z),C=z[0],v=z[1],z=z[2]);L-=M;m-=Q;x-=t;C-=M;v-=Q;z-=t;var V=J*z-v*b,O=b*C-z*F,T=F*v-C*J,Z=L*V+m*O+x*T;if(!(Math.abs(Z)<=B)){M=u-M;Q=H-Q;t=a-t;V=M*V+Q*O+t*T;if(0<Z){if(0>V||V>Z)continue}else if(0<V||V<Z)continue;O=Q*x-m*t;t=t*
L-x*M;Q=M*m-L*Q;M=F*O+J*t+b*Q;if(0<Z){if(0>M||V+M>Z)continue}else if(0<M||V+M<Z)continue;Q=(C*O+v*t+z*Q)/Z;0<=Q&&(L=q(L,m,x,C,v,z,G),l(Q,L,R))}}}else for(f=e.data,A=e.offsetIdx,E=e.strideIdx,e=a[0],u=a[1],H=a[2],a=b[0]-e,F=b[1]-u,J=b[2]-H,b=c,c*=3;b<d;++b)if(v=A+E*g[c++],M=f[v++],Q=f[v++],t=f[v],v=A+E*g[c++],R=f[v++],L=f[v++],m=f[v],v=A+E*g[c++],x=f[v++],C=f[v++],v=f[v],r.isSome(k)&&(t=k.applyToVertex(M,Q,t),M=t[0],Q=t[1],t=t[2],m=k.applyToVertex(R,L,m),R=m[0],L=m[1],m=m[2],v=k.applyToVertex(x,C,
v),x=v[0],C=v[1],v=v[2]),R-=M,L-=Q,m-=t,x-=M,C-=Q,v-=t,Z=F*v-C*J,V=J*x-v*a,O=a*C-x*F,z=R*Z+L*V+m*O,!(Math.abs(z)<=B)){M=e-M;Q=u-Q;t=H-t;Z=M*Z+Q*V+t*O;if(0<z){if(0>Z||Z>z)continue}else if(0<Z||Z<z)continue;V=Q*m-L*t;t=t*R-m*M;Q=M*L-R*Q;M=a*V+F*t+J*Q;if(0<z){if(0>M||Z+M>z)continue}else if(0<M||Z+M<z)continue;Q=(x*V+C*t+v*Q)/z;0<=Q&&(R=q(R,L,m,x,C,v,G),l(Q,R,b))}}function q(a,b,c,d,g,e,f){m.vec3.set(F,a,b,c);m.vec3.set(M,d,g,e);m.vec3.cross(f,F,M);m.vec3.normalize(f,f);return f}function v(a,b,c){return m.vec3.set(c,
1/(b[0]-a[0]),1/(b[1]-a[1]),1/(b[2]-a[2]))}function t(a,b,c,d){return x(a,b,c,d,Infinity)}function x(a,b,c,d,g){var e=(a[0]-d-b[0])*c[0],f=(a[3]+d-b[0])*c[0],k=Math.min(e,f),e=Math.max(e,f),f=(a[1]-d-b[1])*c[1],l=(a[4]+d-b[1])*c[1],e=Math.min(e,Math.max(f,l));if(0>e)return!1;k=Math.max(k,Math.min(f,l));if(k>e)return!1;f=(a[2]-d-b[2])*c[2];a=(a[5]+d-b[2])*c[2];e=Math.min(e,Math.max(f,a));if(0>e)return!1;k=Math.max(k,Math.min(f,a));return k>e?!1:k<g}function z(a,b){b=b?z(b):{};for(var c in a){var d=
a[c];d&&d.forEach&&(d=A(d));null==d&&c in b||(b[c]=d)}return b}function A(a){var b=[];a.forEach(function(a){return b.push(a)});return b}Object.defineProperty(f,"__esModule",{value:!0});var E=g.create(),H=l.VertexAttrConstants;f.intersectTriangleGeometry=function(d,g,e,f,k,q,t){g=c.isInstanceHidden(g);e=e.tolerance;g||(d.boundingInfo?(l.assert("triangle"===d.data.primitiveType),a(d.boundingInfo,f,k,e,q,t)):(e=d.getIndices(H.POSITION),d=d.getAttribute(H.POSITION),b(f,k,0,e.length/3,e,d,void 0,q,t)))};
var J=d.vec3f64.create(),B=Math.pow(2,-52),G=d.vec3f64.create();f.intersectTriangles=b;var F=d.vec3f64.create(),M=d.vec3f64.create();f.computeNormal=q;f.computeInvDir=v;f.intersectAabbInvDir=t;f.intersectAabbInvDirBefore=x;f.verticalOffsetAtDistance=function(a,b,c,d,g){var f=(c.screenLength||0)*a.pixelRatio;g&&(f=k.scale(f,d,b,g));return e.glClamp(f*Math.tan(.5*a.fovY)/(.5*a.fullHeight)*b,c.minWorldLength||0,null!=c.maxWorldLength?c.maxWorldLength:Infinity)};f.bindScreenSizePerspective=function(a,
b,c){if(a){var d=a.parameters;b.setUniform4f(c,d.divisor,d.offset,d.minPixelSize,a.paddingPixelsOverride)}};f.copyParameters=z;f.updateParameters=function(a,b){var c=!1,d;for(d in b){var g=b[d];void 0!==g&&(c=!0,Array.isArray(g)?a[d]=g.slice():a[d]=g)}return c};f.intersectDrapedRenderLineGeometry=function(a,b,c,d,g){if(b.options.selectionMode){b=a.getAttribute(H.POSITION).data;var f=a.getAttribute(H.SIZE),k=c[0];c=c[1];a=(((f&&f.data[0])+d)/2+4)*a.pixelRatio;d=Number.MAX_VALUE;for(f=0;f<b.length-
5;f+=3){var l=b[f],q=b[f+1],t=k-l,m=c-q,l=b[f+3]-l,q=b[f+4]-q,r=e.clamp((l*t+q*m)/(l*l+q*q),0,1),t=l*r-t,m=q*r-m,m=t*t+m*m;m<d&&(d=m)}d<a*a&&g()}};f.colorMixModes={multiply:1,ignore:2,replace:3,tint:4};var R=1E3})},"esri/views/3d/webgl-engine/lib/screenSizePerspectiveUtils":function(){define(["require","exports","../../../../core/mathUtils","../../support/earthUtils"],function(u,f,e,r){function m(b,c,d){var g=d.parameters;d=d.paddingPixelsOverride;a.scale=Math.min(g.divisor/(c-g.offset),1);a.factor=
Math.abs(b*b*b);a.minPixelSize=g.minPixelSize;a.paddingPixels=d;return a}function d(a,b){return 0===a?b.minPixelSize:b.minPixelSize*(1+2*b.paddingPixels/a)}function g(a,b){return Math.max(e.lerp(a*b.scale,a,b.factor),d(a,b))}Object.defineProperty(f,"__esModule",{value:!0});f.getSettings=function(a){return new k(a,l)};f.getLabelSettings=function(a){var b=l.curvatureDependent;return new k(a,{curvatureDependent:{min:{curvature:b.min.curvature,tiltAngle:b.min.tiltAngle,scaleFallOffFactor:c.curvatureDependent.min.scaleFallOffFactor},
max:{curvature:b.max.curvature,tiltAngle:b.max.tiltAngle,scaleFallOffFactor:c.curvatureDependent.max.scaleFallOffFactor}},scaleStart:l.scaleStart,scaleFallOffRange:l.scaleFallOffRange,minPixelSize:c.minPixelSize})};f.applyScaleFactor=g;f.applyScaleFactorVec2=function(a,b,c){void 0===c&&(c=[0,0]);var g=Math.min(Math.max(b.scale,d(a[1],b)/a[1]),1);c[0]=e.lerp(a[0]*g,a[0],b.factor);c[1]=e.lerp(a[1]*g,a[1],b.factor);return c};f.precomputeScaleFactor=function(a,b,c,d){a=m(a,b,c);a.minPixelSize=0;a.paddingPixels=
0;a=g(1,a);d.scale=a;d.factor=0;d.minPixelSize=c.parameters.minPixelSize;d.paddingPixels=c.paddingPixelsOverride};f.applyPrecomputedScaleFactor=function(a,b,c){void 0===c&&(c=[0,0]);b=Math.min(Math.max(b.scale,d(a[1],b)/a[1]),1);c[0]=a[0]*b;c[1]=a[1]*b;return c};f.scale=function(a,b,c,d){return g(a,m(b,c,d))};var k=function(){function a(a,b,c,d){void 0===c&&(c={camera:{distance:0,fovY:0},divisor:0,offset:0,minPixelSize:0,paddingPixels:0});this.viewingMode=a;this.description=b;this.parameters=c;this._paddingPixelsOverride=
d;"local"===this.viewingMode?(this.coverageCompensation=this.surfaceCoverageCompensationLocal,this.calculateCurvatureDependentParameters=this.calculateCurvatureDependentParametersLocal):(this.coverageCompensation=this.surfaceCoverageCompensationGlobal,this.calculateCurvatureDependentParameters=this.calculateCurvatureDependentParametersGlobal)}Object.defineProperty(a.prototype,"paddingPixelsOverride",{get:function(){return this._paddingPixelsOverride||this.parameters.paddingPixels},enumerable:!0,configurable:!0});
a.prototype.update=function(a){if(this.parameters&&this.parameters.camera.fovY===a.fovY&&this.parameters.camera.distance===a.distance)return!1;this.calculateParameters(a,this.parameters);return!0};a.prototype.overridePadding=function(b){return b!==this.paddingPixelsOverride?new a(this.viewingMode,this.description,this.parameters,b):this};a.prototype.calculateParameters=function(a,b){var c=this.description,d=c.scaleStart,g=c.scaleFallOffRange,c=c.minPixelSize,e=a.fovY,f=a.distance,k=this.calculateCurvatureDependentParameters(a),
l=this.coverageCompensation(a,k),q=k.tiltAngle,k=k.scaleFallOffFactor,f=Math.sin(q)*f,q=.5*Math.PI-q-e*(.5-d*l),d=f/Math.cos(q),g=(d-f/Math.cos(q+e*g*l)*k)/(1-k);b.camera.fovY=a.fovY;b.camera.distance=a.distance;b.offset=g;b.divisor=d-g;b.minPixelSize=c;return b};a.prototype.calculateCurvatureDependentParametersLocal=function(a,c){void 0===c&&(c=b);c.tiltAngle=this.description.curvatureDependent.min.tiltAngle;c.scaleFallOffFactor=this.description.curvatureDependent.min.scaleFallOffFactor;return c};
a.prototype.calculateCurvatureDependentParametersGlobal=function(a,c){void 0===c&&(c=b);var d=this.description.curvatureDependent;a=1+a.distance/r.earthRadius;var g=[d.min.curvature,d.max.curvature],f=g[0];a=e.clamp((Math.sqrt(a*a-1)-f)/(g[1]-f),0,1);g=[d.min,d.max];d=g[0];g=g[1];c.tiltAngle=e.lerp(d.tiltAngle,g.tiltAngle,a);c.scaleFallOffFactor=e.lerp(d.scaleFallOffFactor,g.scaleFallOffFactor,a);return c};a.prototype.surfaceCoverageCompensationLocal=function(a,b){return(a.fovY-b.tiltAngle)/a.fovY};
a.prototype.surfaceCoverageCompensationGlobal=function(a,b){var c=r.earthRadius*r.earthRadius;b=b.tiltAngle+.5*Math.PI;var d=a.fovY;a=a.distance;a=a*a+c-2*Math.cos(b)*a*r.earthRadius;var g=Math.sqrt(a);return(Math.acos(Math.sqrt(a-c)/g)-Math.asin(r.earthRadius/(g/Math.sin(b)))+.5*d)/d};return a}(),l={curvatureDependent:{min:{curvature:e.deg2rad(10),tiltAngle:e.deg2rad(12),scaleFallOffFactor:.5},max:{curvature:e.deg2rad(70),tiltAngle:e.deg2rad(40),scaleFallOffFactor:.8}},scaleStart:.3,scaleFallOffRange:.65,
minPixelSize:0},c={curvatureDependent:{min:{scaleFallOffFactor:.7},max:{scaleFallOffFactor:.95}},minPixelSize:14},a={scale:0,factor:0,minPixelSize:0,paddingPixels:0},b={tiltAngle:0,scaleFallOffFactor:0}})},"esri/views/3d/webgl-engine/materials/renderers/MergedRenderer":function(){define("require exports ../../../../../core/MapUtils ../../../../../core/MapUtils ../../../../../core/maybe ../../../../../core/maybe ../../../../../core/libs/gl-matrix-2/mat4 ../../../../../core/libs/gl-matrix-2/mat4f64 ../../../support/buffer/glUtil ../../lib/DefaultVertexAttributeLocations ../../lib/renderStats ../../lib/ResizableFloat32Array ../../lib/Util ../WaterGLMaterial ./Instance ./utils ../../../../webgl/BufferObject ../../../../webgl/Util ../../../../webgl/VertexArrayObject".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A,E){function H(a,b,c,d){for(var g=new Map,e=b.vertexBufferLayout.stride/4,f=function(c,d){var f=c.origin,k=a.get(f.id),l=g.get(f.id);null==l&&(l={optimalCount:null==k?0:k.optimalCount,sparseCount:null==k?0:k.buffer.size,toAdd:[],toRemove:[],origin:f.vec3},g.set(f.id,l));f=b.elementCount(c.data)*e;d?(l.optimalCount+=f,l.sparseCount+=f,l.toAdd.push(c)):(l.optimalCount-=f,l.toRemove.push(c))},k=0;k<c.length;k++){var l=c[k];f(l,!0)}for(c=0;c<d.length;c++)l=
d[c],f(l,!1);return g}u=function(){function f(a,b,d,g){void 0===g&&(g=c.Default3D);this.type="MergedRenderer";this._dataByOrigin=new Map;this._hasOccludees=this._hasHighlights=!1;this._rctx=a;this._vertexAttributeLocations=g;this._material=d;this._materialRep=b;this._glMaterials=x.acquireMaterials(this._material,this._materialRep);this._bufferWriter=d.createBufferWriter()}f.prototype.dispose=function(){x.releaseMaterials(this._material,this._materialRep);this._dataByOrigin&&(this._dataByOrigin.forEach(function(a){a.vao.dispose(!0);
a.vao=null}),this._dataByOrigin.clear(),this._dataByOrigin=null);this._glMaterials&&(this._glMaterials.forEach(function(a){a&&a.dispose()}),this._glMaterials.clear(),this._glMaterials=null)};Object.defineProperty(f.prototype,"isEmpty",{get:function(){return 0===this._dataByOrigin.size},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"hasHighlights",{get:function(){return this._hasHighlights},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"hasOccludees",{get:function(){return this._hasOccludees},
enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"hasWater",{get:function(){return!this.isEmpty&&r.someMap(this._glMaterials,function(a){return a instanceof v.WaterGLMaterial})},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"rendersOccluded",{get:function(){return!this.isEmpty&&1!==this._material.renderOccluded},enumerable:!0,configurable:!0});f.prototype.modify=function(a){this.updateGeometries(a.toUpdate);this.addAndRemoveGeometries(a.toAdd,a.toRemove);this.updateRenderCommands()};
f.prototype.addAndRemoveGeometries=function(a,b){var c=this,d=this._bufferWriter,g=d.vertexBufferLayout,e=g.stride/4,f=this._dataByOrigin,k=H(f,d,a,b);k.forEach(function(a,b){k.delete(b);var d=a.optimalCount,l=a.sparseCount,m=f.get(b);null==m&&(q.assert(0<d),m=c.createData(g,d,a.origin),f.set(b,m));if(0===d)m.vao.dispose(!0),m.vao=null,f.delete(b);else{var t=d<a.sparseCount/2;b=J;var r=m.buffer.size,v=m.buffer.array,d=m.buffer.resize(t?d:l,!1);t||d?c.removeAndRebuild(m,a.toRemove,e,v,b):0<a.toRemove.length?
(c.removeByErasing(m,a.toRemove,e,b),0<a.toAdd.length&&(b.end=r)):(b.begin=r,b.end=r);d=B;q.setMatrixTranslation3(d,-a.origin[0],-a.origin[1],-a.origin[2]);c.append(m,a.toAdd,e,d,b);a=m.vao.vertexBuffers.geometry;a.byteSize!==m.buffer.array.buffer.byteLength?a.setData(m.buffer.array):(d=b.begin,b=b.end,d<b&&(d*=4,a.setSubData(m.buffer.array,d,d,4*b)));m.drawCommandsDirty=!0}})};f.prototype.updateGeometries=function(a){for(var b=this._bufferWriter,c=b.vertexBufferLayout.stride/4,d=0;d<a.length;d++){var g=
a[d],e=g.updateType,g=g.renderGeometry,f=this._dataByOrigin.get(g.origin.id),k=f&&f.instances.get(g.uniqueName);if(!k)break;e&1&&(k.isVisible=g.instanceParameters.visible);if(e&9){var l=g.instanceParameters.visible;k.hasHighlights=!!g.instanceParameters.highlights&&l}e&16&&(k.hasOccludees=!!g.instanceParameters.occludees);e&6&&(e=f.buffer.array,l=f.vao,x.calculateTransformRelToOrigin(g,G,F),b.write({transformation:G,invTranspTransformation:F},g.data,b.vertexBufferLayout.createView(e.buffer),k.from),
q.assert(k.from+b.elementCount(g.data)===k.to,"material VBO layout has changed"),l.vertexBuffers.geometry.setSubData(e,k.from*c*4,k.from*c*4,k.to*c*4));f.drawCommandsDirty=!0}};f.prototype.updateRenderCommands=function(){this._dataByOrigin.forEach(function(a){a.hasHiddenInstances=r.someMap(a.instances,function(a){return!a.isVisible});a.hasHighlights=r.someMap(a.instances,function(a){return a.isVisible&&a.hasHighlights});a.hasOccludees=r.someMap(a.instances,function(a){return a.isVisible&&a.hasOccludees})});
this._hasHighlights=r.someMap(this._dataByOrigin,function(a){return a.hasHighlights});this._hasOccludees=r.someMap(this._dataByOrigin,function(a){return a.hasOccludees});var a=function(a){a.drawCommandsDefault=null;a.drawCommandsHighlight=null;a.drawCommandsOccludees=null;a.stats={default:0,highlight:0,occludees:0};if(0!==a.instances.size)if(a.hasOccludees||a.hasHighlights||a.hasHiddenInstances){var b=t.sortInstancesAccordingToRange(e.valuesOfMap(a.instances));a.drawCommandsDefault=[];a.drawCommandsHighlight=
[];a.drawCommandsOccludees=[];for(var c=0;c<b.length;c++){var d=b[c];d.isVisible&&(d.hasOccludees?t.addOrMerge(a.drawCommandsOccludees,d):t.addOrMerge(a.drawCommandsDefault,d),d.hasHighlights&&t.addOrMerge(a.drawCommandsHighlight,d))}b=function(a){for(var b=0,c=0;c<a.length;c++)b+=a[c].count;return b/3};a.stats={default:b(a.drawCommandsDefault),highlight:b(a.drawCommandsHighlight),occludees:b(a.drawCommandsOccludees)}}else b=4*a.buffer.size/A.getStride(a.vao.layout.geometry),a.drawCommandsDefault=
[{first:0,count:b}],a.stats={default:b,highlight:0,occludees:0}};this._dataByOrigin.forEach(function(b){b.drawCommandsDirty&&(a(b),b.drawCommandsDirty=!1)})};f.prototype.updateLogic=function(a){return this._material.update(a)};f.prototype.render=function(b,c,g,e){var f=this,k=this._rctx,l=this._glMaterials.get(c.pass),q=4===c.pass,t=b;2===c.pass&&null===t&&(t=22);if(!l||2!==l.ensureResources(k)||null!=t&&!l.beginSlot(t)||q&&!this._hasHighlights)return!1;l.ensureParameters(g);var r=l.getTechnique(),
v=l.getPipelineState(t,!1);k.setPipelineState(v);l.bind(k,g);var x=!1;this._dataByOrigin.forEach(function(b){if(!(m.isNone(b.drawCommandsDefault)&&m.isNone(b.drawCommandsHighlight)&&m.isNone(b.drawCommandsOccludees)||q&&!b.hasHighlights)){g.origin=b.origin;r.bindDraw(g);r.ensureAttributeLocations(b.vao);k.bindVAO(b.vao);var c=r.primitiveType,z=q?b.drawCommandsHighlight:b.drawCommandsDefault,A=q?b.stats.highlight:b.stats.default;d.isSome(z)&&(f.renderCommands(k,c,z),a.addToRenderStats(z.length,A,e),
x=!0);q||(z=b.drawCommandsOccludees,d.isSome(z)&&(A=l.getPipelineState(t,!0),k.setPipelineState(A),f.renderCommands(k,c,z),k.setPipelineState(v),a.addToRenderStats(z.length,b.stats.occludees,e),x=!0))}});return x};f.prototype.renderCommands=function(a,b,c){for(var d=0;d<c.length;d++)a.drawArrays(b,c[d].first,c[d].count)};f.prototype.createData=function(a,c,d){return{instances:new Map,vao:new E(this._rctx,this._vertexAttributeLocations,{geometry:l.glLayout(a)},{geometry:z.createVertex(this._rctx,35044)}),
buffer:new b.ResizableFloat32Array(c),optimalCount:0,origin:d,hasHiddenInstances:!1,hasHighlights:!1,hasOccludees:!1,drawCommandsDirty:!1,drawCommandsDefault:null,drawCommandsOccludees:null,drawCommandsHighlight:null,stats:{default:0,highlight:0,occludees:0}}};f.prototype.removeAndRebuild=function(a,b,c,d,g){for(var e=0;e<b.length;e++){var f=b[e].uniqueName,k=a.instances.get(f);a.optimalCount-=(k.to-k.from)*c;a.instances.delete(f)}var l=0,q=a.buffer.array;g.begin=0;g.end=0;var m=-1,t=-1,r=0;a.instances.forEach(function(a){var b=
a.from*c,g=a.to*c,e=g-b;m!==t&&t!==b?(q.set(d.subarray(m,t),r),r+=t-m,m=b):-1===m&&(m=b);t=g;a.from=l/c;l+=e;a.to=l/c});m!==t&&q.set(d.subarray(m,t),r);g.end=l};f.prototype.removeByErasing=function(a,b,c,d){d.begin=Infinity;d.end=-Infinity;for(var g=-1,e=-1,f=0;f<b.length;f++){var k=b[f].uniqueName,l=a.instances.get(k),q=l.from*c,l=l.to*c;g!==e&&e!==q?(a.buffer.erase(g,e),g=q):-1===g&&(g=q);e=l;a.instances.delete(k);a.optimalCount-=l-q;q<d.begin&&(d.begin=q);l>d.end&&(d.end=l)}g!==e&&a.buffer.erase(g,
e)};f.prototype.append=function(a,b,c,e,f){for(var k=this._bufferWriter,l=0;l<b.length;l++){var m=b[l],r=d.isSome(m.transformation)?g.mat4.multiply(G,e,m.transformation):e;g.mat4.invert(F,r);g.mat4.transpose(F,F);var v=f.end;k.write({transformation:r,invTranspTransformation:F},m.data,k.vertexBufferLayout.createView(a.buffer.array.buffer),f.end/c);var r=k.elementCount(m.data)*c,x=v+r;q.assert(null==a.instances.get(m.uniqueName));var z=m.instanceParameters.visible,v=new t.Instance(v/c,x/c,z,!!m.instanceParameters.highlights&&
z,!!m.instanceParameters.occludees);a.instances.set(m.uniqueName,v);a.optimalCount+=r;f.end+=r}};Object.defineProperty(f.prototype,"test",{get:function(){return{material:this._material,glMaterials:this._glMaterials}},enumerable:!0,configurable:!0});return f}();var J={begin:0,end:0},B=k.mat4f64.create(),G=k.mat4f64.create(),F=k.mat4f64.create();return u})},"esri/views/3d/support/buffer/glUtil":function(){define(["require","exports","tslib"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});
var r={divisor:0};f.glLayout=function(d,g){void 0===g&&(g={});g=e.__assign(e.__assign({},r),g);var f=d.stride;return d.fieldNames.filter(function(g){g=d.fields.get(g).optional;return!(g&&g.glPadding)}).map(function(e){var c=d.fields.get(e),a=c.constructor.ElementCount;var b=m[c.constructor.ElementType];if(!b)throw Error("BufferType not supported in WebGL");return{name:e,stride:f,count:a,type:b,offset:c.offset,normalized:!(!c.optional||!c.optional.glNormalized),divisor:g.divisor}})};var m={u8:5121,
u16:5123,u32:5125,i8:5120,i16:5122,i32:5124,f32:5126}})},"esri/views/3d/webgl-engine/lib/renderStats":function(){define(["require","exports"],function(u,f){function e(){return{triangles:0,drawCalls:0}}Object.defineProperty(f,"__esModule",{value:!0});f.makeNewRenderStats=e;f.addToRenderStats=function(e,f,d){d&&(d.drawCalls+=e,d.triangles+=f)};u=function(){function f(){this.materialRenderStats=new Map;this.reset()}f.prototype.getMaterialRenderStatsObject=function(f){var d=this.materialRenderStats.get(f);
d||(d=e(),this.materialRenderStats.set(f,d));return d};f.prototype.getAggregatedStats=function(){var f={materialRenderers:{},total:e()};this.materialRenderStats.forEach(function(d,g){f.materialRenderers[g]=d;f.total.drawCalls+=d.drawCalls;f.total.triangles+=d.triangles});return f};f.prototype.reset=function(){this.materialRenderStats.forEach(function(e){e.drawCalls=0;e.triangles=0})};return f}();f.RenderStatsAggregator=u})},"esri/views/3d/webgl-engine/lib/ResizableFloat32Array":function(){define(["require",
"exports","../../../../core/mathUtils"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function f(f){null==f?f=16:65536>f&&(f=e.nextHighestPowerOfTwo(f));this._array=new Float32Array(f);this._size=0}f.prototype.resize=function(e,d){this._size=e;if(this._size>this._array.length){for(e=this._array.length||1;e<this._size;)e*=2;var g=new Float32Array(e);d&&g.set(this._array);this._array=g;return!0}g=2*this._size;if(g<=this._array.length){for(e=this._array.length;e>=g;)e=
Math.floor(e/2);g=new Float32Array(e);d&&g.set(this._array.subarray(0,e));this._array=g;return!0}return!1};f.prototype.append=function(e){var d=this._size;this.resize(this._size+e.length,!0);this._array.set(e,d)};f.prototype.erase=function(e,d){for(;e<d;++e)this._array[e]=0};Object.defineProperty(f.prototype,"array",{get:function(){return this._array},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0});return f}();
f.ResizableFloat32Array=u})},"esri/views/3d/webgl-engine/materials/WaterGLMaterial":function(){define("require exports tslib ../lib/GLMaterial ./WaterTechnique ./internal/MaterialUtil".split(" "),function(u,f,e,r,m,d){Object.defineProperty(f,"__esModule",{value:!0});u=function(g){function f(d){d=g.call(this,d)||this;d.updateParameters();return d}e.__extends(f,g);f.prototype.updateParameters=function(){this.params=d.copyParameters(this.material.getParameters());this.technique=this.techniqueRep.acquireAndReleaseExisting(m.WaterTechnique,
this.material.getTechniqueConfig(this.output),this.technique)};f.prototype.beginSlot=function(d){if(2===this.output)return 22===d;if(5===this.output)return null==d;var c=3;this.params.transparent&&(c=this.params.writeDepth?5:8);return d===c};f.prototype.setElapsedTimeUniform=function(d){d.setUniform1f("timeElapsed",.001*this.material.animation.time*this.params.animationSpeed)};f.prototype._updateShadowState=function(d){d.shadowMappingEnabled!==this.params.receiveShadows&&(this.material.setParameterValues({receiveShadows:d.shadowMappingEnabled}),
this.updateParameters())};f.prototype._updateSSRState=function(d){d.ssrEnabled!==this.params.ssrEnabled&&(this.material.setParameterValues({ssrEnabled:d.ssrEnabled}),this.updateParameters())};f.prototype.ensureResources=function(d){return this.technique.ensureResource(d)};f.prototype.ensureParameters=function(d){0===this.output&&(this._updateShadowState(d),this._updateSSRState(d))};f.prototype.bind=function(d,c){d.bindProgram(this.technique.program);this.technique.bindPass(d,this.params,c);2!==this.output&&
0!==this.output||this.setElapsedTimeUniform(this.technique.program)};return f}(r.GLMaterial);f.WaterGLMaterial=u})},"esri/views/3d/webgl-engine/materials/WaterTechnique":function(){define("require exports tslib ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/Transform.glsl ../core/shaderLibrary/shading/ReadShadowMap.glsl ../core/shaderLibrary/shading/ScreenSpaceReflections.glsl ../core/shaderLibrary/shading/WaterDistortion.glsl ../core/shaderLibrary/util/Camera.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/DefaultTextureUnits ../lib/DefaultVertexAttributeLocations ../shaders/WaterSurface.glsl ../../../webgl/Program ../../../webgl/renderState @dojo/framework/shim/Promise".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z){Object.defineProperty(f,"__esModule",{value:!0});a=function(a){function b(b,c){c=a.call(this,b,c)||this;c.waterTextureRepository=b.waterTextureRepository;return c}e.__extends(b,a);b.prototype.initializeProgram=function(a){var c=b.shader.get(),d=this.configuration,c=c.build({output:d.output,viewingMode:a.viewingMode,slicePlaneEnabled:d.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,receiveShadows:d.receiveShadows,pbrMode:3,useCustomDTRExponentForWater:!0,
ssrEnabled:d.useSSR,highStepCount:!0});return new x(a.rctx,c.generateSource("vertex"),c.generateSource("fragment"),v.Default3D)};b.prototype.ensureResource=function(a){this.waterTextureRepository.ready||this.waterTextureRepository.updating||this.waterTextureRepository.loadTextures(a);return this.waterTextureRepository.ready?2:1};b.prototype.bindPass=function(a,b,c){0===this.configuration.output&&g.ScreenSpaceReflections.bindUniforms(this.program,a,c);if(0===this.configuration.output||2===this.configuration.output)k.WaterDistortion.bindUniforms(this.program,
b),this.waterTextureRepository.bindRepo(a);0!==this.configuration.output&&5!==this.configuration.output||this.program.setUniform4fv("waterColor",b.color)};b.prototype.bindDraw=function(a){m.Transform.bindUniforms(this.program,a);0===this.configuration.output&&(l.Camera.bindUniforms(this.program,a),r.Slice.bindUniformsWithOrigin(this.program,this.configuration,a),d.ReadShadowMap.bindUniforms(this.program,a,q.DefaultTextureUnits.SHADOW_MAP))};b.prototype.initializePipeline=function(){var a=this.configuration;
return 2===a.output?z.makePipelineState({depthTest:{func:513},depthWrite:a.writeDepth&&z.defaultDepthWriteParams,colorWrite:z.defaultColorWriteParams}):z.makePipelineState({blending:a.transparent&&z.separateBlendingParams(770,1,771,771),depthTest:{func:513},depthWrite:a.writeDepth&&z.defaultDepthWriteParams,colorWrite:z.defaultColorWriteParams})};b.shader=new c.ReloadableShaderModule(t,function(){return new Promise(function(a,b){u(["../shaders/WaterSurface.glsl"],a,b)})});return b}(a.ShaderTechnique);
f.WaterTechnique=a;a=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b.output=0;b.receiveShadows=!1;b.slicePlaneEnabled=!1;b.transparent=!1;b.writeDepth=!1;b.useSSR=!1;b.isDraped=!1;return b}e.__extends(c,a);e.__decorate([b.parameter({count:7})],c.prototype,"output",void 0);e.__decorate([b.parameter()],c.prototype,"receiveShadows",void 0);e.__decorate([b.parameter()],c.prototype,"slicePlaneEnabled",void 0);e.__decorate([b.parameter()],c.prototype,"transparent",void 0);e.__decorate([b.parameter()],
c.prototype,"writeDepth",void 0);e.__decorate([b.parameter()],c.prototype,"useSSR",void 0);e.__decorate([b.parameter()],c.prototype,"isDraped",void 0);return c}(b.ShaderTechniqueConfiguration);f.WaterTechniqueConfiguration=a})},"esri/views/3d/webgl-engine/core/shaderLibrary/Slice.glsl":function(){define("require exports tslib ../../../../../core/maybe ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../shaderModules/interfaces".split(" "),function(u,f,e,r,m,d,
g){function k(d,f){if(f.slicePlaneEnabled){d.extensions.add("GL_OES_standard_derivatives");f.sliceEnabledForVertexPrograms&&(d.vertex.uniforms.add("slicePlaneOrigin","vec3"),d.vertex.uniforms.add("slicePlaneBasis1","vec3"),d.vertex.uniforms.add("slicePlaneBasis2","vec3"));d.fragment.uniforms.add("slicePlaneOrigin","vec3");d.fragment.uniforms.add("slicePlaneBasis1","vec3");d.fragment.uniforms.add("slicePlaneBasis2","vec3");var k=g.glsl(c||(c=e.__makeTemplateObject(["\n      struct SliceFactors {\n        float front;\n        float side0;\n        float side1;\n        float side2;\n        float side3;\n      };\n\n      SliceFactors calculateSliceFactors(vec3 pos) {\n        vec3 rel \x3d pos - slicePlaneOrigin;\n\n        vec3 slicePlaneNormal \x3d -cross(slicePlaneBasis1, slicePlaneBasis2);\n        float slicePlaneW \x3d -dot(slicePlaneNormal, slicePlaneOrigin);\n\n        float basis1Len2 \x3d dot(slicePlaneBasis1, slicePlaneBasis1);\n        float basis2Len2 \x3d dot(slicePlaneBasis2, slicePlaneBasis2);\n\n        float basis1Dot \x3d dot(slicePlaneBasis1, rel);\n        float basis2Dot \x3d dot(slicePlaneBasis2, rel);\n\n        return SliceFactors(\n          dot(slicePlaneNormal, pos) + slicePlaneW,\n          -basis1Dot - basis1Len2,\n          basis1Dot - basis1Len2,\n          -basis2Dot - basis2Len2,\n          basis2Dot - basis2Len2\n        );\n      }\n\n      bool sliceByFactors(SliceFactors factors) {\n        return factors.front \x3c 0.0\n          \x26\x26 factors.side0 \x3c 0.0\n          \x26\x26 factors.side1 \x3c 0.0\n          \x26\x26 factors.side2 \x3c 0.0\n          \x26\x26 factors.side3 \x3c 0.0;\n      }\n      \n      bool sliceEnabled() {\n        // a slicePlaneBasis1 vector of zero length is used to disable slicing in the shader during draped rendering.\n        return dot(slicePlaneBasis1, slicePlaneBasis1) !\x3d 0.0;\n      }\n\n      bool sliceByPlane(vec3 pos) {\n        return sliceEnabled() \x26\x26 sliceByFactors(calculateSliceFactors(pos));\n      }\n\n      #define rejectBySlice(_pos_) sliceByPlane(_pos_)\n      #define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }\n    "],
["\n      struct SliceFactors {\n        float front;\n        float side0;\n        float side1;\n        float side2;\n        float side3;\n      };\n\n      SliceFactors calculateSliceFactors(vec3 pos) {\n        vec3 rel \x3d pos - slicePlaneOrigin;\n\n        vec3 slicePlaneNormal \x3d -cross(slicePlaneBasis1, slicePlaneBasis2);\n        float slicePlaneW \x3d -dot(slicePlaneNormal, slicePlaneOrigin);\n\n        float basis1Len2 \x3d dot(slicePlaneBasis1, slicePlaneBasis1);\n        float basis2Len2 \x3d dot(slicePlaneBasis2, slicePlaneBasis2);\n\n        float basis1Dot \x3d dot(slicePlaneBasis1, rel);\n        float basis2Dot \x3d dot(slicePlaneBasis2, rel);\n\n        return SliceFactors(\n          dot(slicePlaneNormal, pos) + slicePlaneW,\n          -basis1Dot - basis1Len2,\n          basis1Dot - basis1Len2,\n          -basis2Dot - basis2Len2,\n          basis2Dot - basis2Len2\n        );\n      }\n\n      bool sliceByFactors(SliceFactors factors) {\n        return factors.front \x3c 0.0\n          \x26\x26 factors.side0 \x3c 0.0\n          \x26\x26 factors.side1 \x3c 0.0\n          \x26\x26 factors.side2 \x3c 0.0\n          \x26\x26 factors.side3 \x3c 0.0;\n      }\n      \n      bool sliceEnabled() {\n        // a slicePlaneBasis1 vector of zero length is used to disable slicing in the shader during draped rendering.\n        return dot(slicePlaneBasis1, slicePlaneBasis1) !\x3d 0.0;\n      }\n\n      bool sliceByPlane(vec3 pos) {\n        return sliceEnabled() \x26\x26 sliceByFactors(calculateSliceFactors(pos));\n      }\n\n      #define rejectBySlice(_pos_) sliceByPlane(_pos_)\n      #define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }\n    "]))),
l=g.glsl(a||(a=e.__makeTemplateObject(["\n      vec4 applySliceHighlight(vec4 color, vec3 pos) {\n        SliceFactors factors \x3d calculateSliceFactors(pos);\n\n        if (sliceByFactors(factors)) {\n          return color;\n        }\n\n        const float HIGHLIGHT_WIDTH \x3d 1.0;\n        const vec4 HIGHLIGHT_COLOR \x3d vec4(0.0, 0.0, 0.0, 0.3);\n\n        factors.front /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);\n        factors.side0 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);\n        factors.side1 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);\n        factors.side2 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);\n        factors.side3 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);\n\n        float highlightFactor \x3d (1.0 - step(0.5, factors.front))\n          * (1.0 - step(0.5, factors.side0))\n          * (1.0 - step(0.5, factors.side1))\n          * (1.0 - step(0.5, factors.side2))\n          * (1.0 - step(0.5, factors.side3));\n\n        return mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);\n      }\n    "],
["\n      vec4 applySliceHighlight(vec4 color, vec3 pos) {\n        SliceFactors factors \x3d calculateSliceFactors(pos);\n\n        if (sliceByFactors(factors)) {\n          return color;\n        }\n\n        const float HIGHLIGHT_WIDTH \x3d 1.0;\n        const vec4 HIGHLIGHT_COLOR \x3d vec4(0.0, 0.0, 0.0, 0.3);\n\n        factors.front /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);\n        factors.side0 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);\n        factors.side1 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);\n        factors.side2 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);\n        factors.side3 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);\n\n        float highlightFactor \x3d (1.0 - step(0.5, factors.front))\n          * (1.0 - step(0.5, factors.side0))\n          * (1.0 - step(0.5, factors.side1))\n          * (1.0 - step(0.5, factors.side2))\n          * (1.0 - step(0.5, factors.side3));\n\n        return mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);\n      }\n    "]))),
l=f.sliceHighlightDisabled?g.glsl(b||(b=e.__makeTemplateObject(["#define highlightSlice(_color_, _pos_) (_color_)"],["#define highlightSlice(_color_, _pos_) (_color_)"]))):g.glsl(q||(q=e.__makeTemplateObject(["\n        "," \n        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))\n      "],["\n        "," \n        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))\n      "])),l);f.sliceEnabledForVertexPrograms&&
d.vertex.code.add(k);d.fragment.code.add(k);d.fragment.code.add(l)}else k=g.glsl(v||(v=e.__makeTemplateObject(["\n      #define rejectBySlice(_pos_) false\n      #define discardBySlice(_pos_) {}\n      #define highlightSlice(_color_, _pos_) (_color_)\n    "],["\n      #define rejectBySlice(_pos_) false\n      #define discardBySlice(_pos_) {}\n      #define highlightSlice(_color_, _pos_) (_color_)\n    "]))),f.sliceEnabledForVertexPrograms&&d.vertex.code.add(k),d.fragment.code.add(k)}Object.defineProperty(f,
"__esModule",{value:!0});f.Slice=k;(function(a){a.bindUniformsWithOrigin=function(b,c,d){a.bindUniforms(b,c,d.slicePlane,d.origin)};a.bindUniforms=function(a,b,c,g){b.slicePlaneEnabled&&(r.isSome(c)?(g?(m.vec3.subtract(l,c.origin,g),a.setUniform3fv("slicePlaneOrigin",l)):a.setUniform3fv("slicePlaneOrigin",c.origin),a.setUniform3fv("slicePlaneBasis1",c.basis1),a.setUniform3fv("slicePlaneBasis2",c.basis2)):(a.setUniform3fv("slicePlaneBasis1",d.vec3f64.ZEROS),a.setUniform3fv("slicePlaneBasis2",d.vec3f64.ZEROS),
a.setUniform3fv("slicePlaneOrigin",d.vec3f64.ZEROS)))}})(k=f.Slice||(f.Slice={}));var l=d.vec3f64.create(),c,a,b,q,v})},"esri/views/3d/webgl-engine/core/shaderModules/interfaces":function(){define(["require","exports"],function(u,f){function e(e){for(var f=[],d=1;d<arguments.length;d++)f[d-1]=arguments[d];for(var d="",g=0;g<f.length;g++)d+=e[g]+f[g];return d+=e[e.length-1]}Object.defineProperty(f,"__esModule",{value:!0});f.glsl=e;(function(e){e.int=function(e){return Math.round(e).toString()};e.float=
function(e){return e.toPrecision(8)}})(e=f.glsl||(f.glsl={}))})},"esri/views/3d/webgl-engine/core/shaderLibrary/Transform.glsl":function(){define("require exports tslib ../../../../../core/libs/gl-matrix-2/mat4 ../../../../../core/libs/gl-matrix-2/mat4f32 ../shaderModules/interfaces".split(" "),function(u,f,e,r,m,d){function g(a,b){b.linearDepth?a.vertex.code.add(d.glsl(l||(l=e.__makeTemplateObject(["\n    vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {\n      vec4 eye \x3d view * vec4(pos, 1.0);\n      depth \x3d (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;\n      return proj * eye;\n    }\n    "],
["\n    vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {\n      vec4 eye \x3d view * vec4(pos, 1.0);\n      depth \x3d (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;\n      return proj * eye;\n    }\n    "])))):a.vertex.code.add(d.glsl(c||(c=e.__makeTemplateObject(["\n    vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {\n      // Make sure the order of operations is the same as in transformPositionWithDepth.\n      return proj * (view * vec4(pos, 1.0));\n    }\n    "],
["\n    vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {\n      // Make sure the order of operations is the same as in transformPositionWithDepth.\n      return proj * (view * vec4(pos, 1.0));\n    }\n    "]))))}Object.defineProperty(f,"__esModule",{value:!0});f.Transform=g;(function(a){function b(a,b,c){r.mat4.translate(k,c,b);a.setUniform3fv("localOrigin",b);a.setUniformMatrix4fv("view",k)}a.bindUniformsCustomOrigin=b;a.bindUniforms=function(a,c){b(a,c.origin,c.view)}})(g=f.Transform||(f.Transform=
{}));var k=m.mat4f32.create(),l,c})},"esri/core/libs/gl-matrix-2/mat4f32":function(){define(["require","exports","./factories/mat4f32"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.mat4f32=e})},"esri/core/libs/gl-matrix-2/factories/mat4f32":function(){define(["require","exports"],function(u,f){function e(){var e=new Float32Array(16);e[0]=1;e[5]=1;e[10]=1;e[15]=1;return e}Object.defineProperty(f,"__esModule",{value:!0});f.create=e;f.clone=function(e){var f=new Float32Array(16);
f[0]=e[0];f[1]=e[1];f[2]=e[2];f[3]=e[3];f[4]=e[4];f[5]=e[5];f[6]=e[6];f[7]=e[7];f[8]=e[8];f[9]=e[9];f[10]=e[10];f[11]=e[11];f[12]=e[12];f[13]=e[13];f[14]=e[14];f[15]=e[15];return f};f.fromValues=function(e,f,d,g,k,l,c,a,b,q,v,t,x,z,A,E){var m=new Float32Array(16);m[0]=e;m[1]=f;m[2]=d;m[3]=g;m[4]=k;m[5]=l;m[6]=c;m[7]=a;m[8]=b;m[9]=q;m[10]=v;m[11]=t;m[12]=x;m[13]=z;m[14]=A;m[15]=E;return m};f.createView=function(e,f){return new Float32Array(e,f,16)};f.IDENTITY=e()})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/ReadShadowMap.glsl":function(){define(["require",
"exports","tslib","../util/RgbaFloatEncoding.glsl","../../shaderModules/interfaces"],function(u,f,e,r,m){function d(d){d.include(r.RgbaFloatEncoding);d.fragment.uniforms.add("depthTex","sampler2D");d.fragment.uniforms.add("shadowMapNum","int");d.fragment.uniforms.add("shadowMapDistance","vec4");d.fragment.uniforms.add("shadowMapMatrix","mat4",4);d.fragment.uniforms.add("depthHalfPixelSz","float");d.fragment.code.add(m.glsl(g||(g=e.__makeTemplateObject(["\n    float readShadowMap(const in vec3 _vpos, float _linearDepth) {\n      float halfPixelSize \x3d depthHalfPixelSz;\n      vec4 distance \x3d shadowMapDistance;\n      float depth \x3d _linearDepth;\n\n      //choose correct cascade\n      int i \x3d depth \x3c distance[1] ? 0 : depth \x3c distance[2] ? 1 : depth \x3c distance[3] ? 2 : 3;\n\n      if (i \x3e\x3d shadowMapNum) { return 0.0; }\n\n      mat4 mat \x3d i \x3d\x3d 0 ? shadowMapMatrix[0] : i \x3d\x3d 1 ? shadowMapMatrix[1] : i \x3d\x3d 2 ? shadowMapMatrix[2] : shadowMapMatrix[3];\n\n      vec4 lv \x3d mat * vec4(_vpos, 1.0);\n      lv.xy /\x3d lv.w;\n\n      // vertex completely outside? -\x3e no shadow\n      vec3 lvpos \x3d 0.5 * lv.xyz + vec3(0.5);\n      if (lvpos.z \x3e\x3d 1.0) { return 0.0; }\n      if (lvpos.x \x3c 0.0 || lvpos.x \x3e 1.0 || lvpos.y \x3c 0.0 || lvpos.y \x3e 1.0) { return 0.0; }\n\n      // calc coord in cascade texture\n      vec2 uv \x3d vec2(float(i - 2 * (i / 2)) * 0.5, float(i / 2) * 0.5) + 0.5 * lvpos.xy;\n\n      float texSize \x3d 0.5 / halfPixelSize;\n\n      // filter, offset by half pixels\n      vec2 st \x3d fract((vec2(halfPixelSize) + uv) * texSize);\n\n      float s00 \x3d rgba2float(texture2D(depthTex, uv + vec2(-halfPixelSize, -halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n      float s10 \x3d rgba2float(texture2D(depthTex, uv + vec2(halfPixelSize, -halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n      float s11 \x3d rgba2float(texture2D(depthTex, uv + vec2(halfPixelSize, halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n      float s01 \x3d rgba2float(texture2D(depthTex, uv + vec2(-halfPixelSize, halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n\n      return mix(mix(s00, s10, st.x), mix(s01, s11, st.x), st.y);\n    }\n  "],
["\n    float readShadowMap(const in vec3 _vpos, float _linearDepth) {\n      float halfPixelSize \x3d depthHalfPixelSz;\n      vec4 distance \x3d shadowMapDistance;\n      float depth \x3d _linearDepth;\n\n      //choose correct cascade\n      int i \x3d depth \x3c distance[1] ? 0 : depth \x3c distance[2] ? 1 : depth \x3c distance[3] ? 2 : 3;\n\n      if (i \x3e\x3d shadowMapNum) { return 0.0; }\n\n      mat4 mat \x3d i \x3d\x3d 0 ? shadowMapMatrix[0] : i \x3d\x3d 1 ? shadowMapMatrix[1] : i \x3d\x3d 2 ? shadowMapMatrix[2] : shadowMapMatrix[3];\n\n      vec4 lv \x3d mat * vec4(_vpos, 1.0);\n      lv.xy /\x3d lv.w;\n\n      // vertex completely outside? -\x3e no shadow\n      vec3 lvpos \x3d 0.5 * lv.xyz + vec3(0.5);\n      if (lvpos.z \x3e\x3d 1.0) { return 0.0; }\n      if (lvpos.x \x3c 0.0 || lvpos.x \x3e 1.0 || lvpos.y \x3c 0.0 || lvpos.y \x3e 1.0) { return 0.0; }\n\n      // calc coord in cascade texture\n      vec2 uv \x3d vec2(float(i - 2 * (i / 2)) * 0.5, float(i / 2) * 0.5) + 0.5 * lvpos.xy;\n\n      float texSize \x3d 0.5 / halfPixelSize;\n\n      // filter, offset by half pixels\n      vec2 st \x3d fract((vec2(halfPixelSize) + uv) * texSize);\n\n      float s00 \x3d rgba2float(texture2D(depthTex, uv + vec2(-halfPixelSize, -halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n      float s10 \x3d rgba2float(texture2D(depthTex, uv + vec2(halfPixelSize, -halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n      float s11 \x3d rgba2float(texture2D(depthTex, uv + vec2(halfPixelSize, halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n      float s01 \x3d rgba2float(texture2D(depthTex, uv + vec2(-halfPixelSize, halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n\n      return mix(mix(s00, s10, st.x), mix(s01, s11, st.x), st.y);\n    }\n  "]))))}
Object.defineProperty(f,"__esModule",{value:!0});f.ReadShadowMap=d;(function(d){d.bindUniforms=function(d,c,a){c.shadowMappingEnabled&&(c.shadowMap.bind(d,a),c.shadowMap.bindView(d,c.origin))};d.bindViewCustomOrigin=function(d,c,a){c.shadowMappingEnabled&&c.shadowMap.bindView(d,a)};d.bindView=function(d,c){c.shadowMappingEnabled&&c.shadowMap.bindView(d,c.origin)}})(d=f.ReadShadowMap||(f.ReadShadowMap={}));var g})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/RgbaFloatEncoding.glsl":function(){define(["require",
"exports","tslib","../../shaderModules/interfaces"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.RgbaFloatEncoding=function(d){var g=r.glsl(m||(m=e.__makeTemplateObject(["\n    // This is the maximum float value representable as 32bit fixed point,\n    // it is rgba2float(vec4(1)) inlined.\n    const float MAX_RGBA_FLOAT \x3d\n      255.0 / 256.0 +\n      255.0 / 256.0 / 256.0 +\n      255.0 / 256.0 / 256.0 / 256.0 +\n      255.0 / 256.0 / 256.0 / 256.0 / 256.0;\n\n    // Factors to convert to fixed point, i.e. factors (256^0, 256^1, 256^2, 256^3)\n    const vec4 FIXED_POINT_FACTORS \x3d vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n\n    vec4 float2rgba(const float value) {\n      // Make sure value is in the domain we can represent\n      float valueInValidDomain \x3d clamp(value, 0.0, MAX_RGBA_FLOAT);\n\n      // Decompose value in 32bit fixed point parts represented as\n      // uint8 rgba components. Decomposition uses the fractional part after multiplying\n      // by a power of 256 (this removes the bits that are represented in the previous\n      // component) and then converts the fractional part to 8bits.\n      vec4 fixedPointU8 \x3d floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\n\n      // Convert uint8 values (from 0 to 255) to floating point representation for\n      // the shader\n      const float toU8AsFloat \x3d 1.0 / 255.0;\n\n      return fixedPointU8 * toU8AsFloat;\n    }\n\n    // Factors to convert rgba back to float\n    const vec4 RGBA_2_FLOAT_FACTORS \x3d vec4(\n      255.0 / (256.0),\n      255.0 / (256.0 * 256.0),\n      255.0 / (256.0 * 256.0 * 256.0),\n      255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n    );\n\n    float rgba2float(vec4 rgba) {\n      // Convert components from 0-\x3e1 back to 0-\x3e255 and then\n      // add the components together with their corresponding\n      // fixed point factors, i.e. (256^1, 256^2, 256^3, 256^4)\n      return dot(rgba, RGBA_2_FLOAT_FACTORS);\n    }\n  "],
["\n    // This is the maximum float value representable as 32bit fixed point,\n    // it is rgba2float(vec4(1)) inlined.\n    const float MAX_RGBA_FLOAT \x3d\n      255.0 / 256.0 +\n      255.0 / 256.0 / 256.0 +\n      255.0 / 256.0 / 256.0 / 256.0 +\n      255.0 / 256.0 / 256.0 / 256.0 / 256.0;\n\n    // Factors to convert to fixed point, i.e. factors (256^0, 256^1, 256^2, 256^3)\n    const vec4 FIXED_POINT_FACTORS \x3d vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n\n    vec4 float2rgba(const float value) {\n      // Make sure value is in the domain we can represent\n      float valueInValidDomain \x3d clamp(value, 0.0, MAX_RGBA_FLOAT);\n\n      // Decompose value in 32bit fixed point parts represented as\n      // uint8 rgba components. Decomposition uses the fractional part after multiplying\n      // by a power of 256 (this removes the bits that are represented in the previous\n      // component) and then converts the fractional part to 8bits.\n      vec4 fixedPointU8 \x3d floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\n\n      // Convert uint8 values (from 0 to 255) to floating point representation for\n      // the shader\n      const float toU8AsFloat \x3d 1.0 / 255.0;\n\n      return fixedPointU8 * toU8AsFloat;\n    }\n\n    // Factors to convert rgba back to float\n    const vec4 RGBA_2_FLOAT_FACTORS \x3d vec4(\n      255.0 / (256.0),\n      255.0 / (256.0 * 256.0),\n      255.0 / (256.0 * 256.0 * 256.0),\n      255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n    );\n\n    float rgba2float(vec4 rgba) {\n      // Convert components from 0-\x3e1 back to 0-\x3e255 and then\n      // add the components together with their corresponding\n      // fixed point factors, i.e. (256^1, 256^2, 256^3, 256^4)\n      return dot(rgba, RGBA_2_FLOAT_FACTORS);\n    }\n  "])));
d.fragment.code.add(g);d.vertex.code.add(g)};var m})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/ScreenSpaceReflections.glsl":function(){define("require exports tslib ../output/ReadLinearDepth.glsl ./Reprojection.glsl ../../shaderModules/interfaces".split(" "),function(u,f,e,r,m,d){function g(g,c){g.fragment.uniforms.add("nearFar","vec2");g.fragment.uniforms.add("depthMapView","sampler2D");g.fragment.uniforms.add("ssrViewMat","mat4");g.include(r.ReadLinearDepth);g.include(m.Reprojection);
g.fragment.code.add(d.glsl(k||(k=e.__makeTemplateObject(["\n  const int maxSteps \x3d ","\n\n  vec4 applyProjectionMat(mat4 projectionMat, vec3 x)\n  {\n    vec4 projectedCoord \x3d  projectionMat * vec4(x, 1.0);\n    projectedCoord.xy /\x3d projectedCoord.w;\n    projectedCoord.xy \x3d projectedCoord.xy*0.5 + 0.5;\n    return projectedCoord;\n  }\n\n  vec3 screenSpaceIntersection(vec3 dir, vec3 startPosition, vec3 viewDir, vec3 normal)\n  {\n    vec3 viewPos \x3d startPosition;\n    vec3 viewPosEnd \x3d startPosition;\n\n    // Project the start position to the screen\n    vec4 projectedCoordStart \x3d applyProjectionMat(rpProjectionMat, viewPos);\n    vec3  Q0 \x3d viewPos / projectedCoordStart.w; // homogeneous camera space\n    float k0 \x3d 1.0/ projectedCoordStart.w;\n\n    // advance the position in the direction of the reflection\n    viewPos +\x3d dir;\n\n    vec4 projectedCoordVanishingPoint \x3d applyProjectionMat(rpProjectionMat, dir);\n\n    // Project the advanced position to the screen\n    vec4 projectedCoordEnd \x3d applyProjectionMat(rpProjectionMat, viewPos);\n    vec3  Q1 \x3d viewPos / projectedCoordEnd.w; // homogeneous camera space\n    float k1 \x3d 1.0/ projectedCoordEnd.w;\n\n    // calculate the reflection direction in the screen space\n    vec2 projectedCoordDir \x3d (projectedCoordEnd.xy - projectedCoordStart.xy);\n    vec2 projectedCoordDistVanishingPoint \x3d (projectedCoordVanishingPoint.xy - projectedCoordStart.xy);\n\n    float yMod \x3d min(abs(projectedCoordDistVanishingPoint.y), 1.0);\n\n    float projectedCoordDirLength \x3d length(projectedCoordDir);\n    float maxSt \x3d float(maxSteps);\n\n    // normalize the projection direction depending on maximum steps\n    // this determines how blocky the reflection looks\n    vec2 dP \x3d yMod * (projectedCoordDir)/(maxSt * projectedCoordDirLength);\n\n    // Normalize the homogeneous camera space coordinates\n    vec3  dQ \x3d yMod * (Q1 - Q0)/(maxSt * projectedCoordDirLength);\n    float dk \x3d yMod * (k1 - k0)/(maxSt * projectedCoordDirLength);\n\n    // initialize the variables for ray marching\n    vec2 P \x3d projectedCoordStart.xy;\n    vec3 Q \x3d Q0;\n    float k \x3d k0;\n    float rayStartZ \x3d -startPosition.z; // estimated ray start depth value\n    float rayEndZ \x3d -startPosition.z;   // estimated ray end depth value\n    float prevEstimateZ \x3d -startPosition.z;\n    float rayDiffZ;\n    float dDepth;\n    float depth;\n    float rayDiffZOld \x3d 0.0;\n\n    // early outs\n    if (dot(normal, dir) \x3c 0.0 || dot(-viewDir, normal) \x3c 0.0)\n      return vec3(P, 0.0);\n\n    for(int i \x3d 0; i \x3c maxSteps; i++)\n    {\n      depth \x3d -linearDepthFromTexture(depthMapView, P, nearFar); // get linear depth from the depth buffer\n\n      // estimate depth of the marching ray\n      rayStartZ \x3d prevEstimateZ;\n      dDepth \x3d -rayStartZ - depth;\n      rayEndZ \x3d (dQ.z * 0.5 + Q.z)/ ((dk * 0.5 + k));\n      rayDiffZ \x3d rayEndZ- rayStartZ;\n      prevEstimateZ \x3d rayEndZ;\n\n      if(-rayEndZ \x3e nearFar[1] || -rayEndZ \x3c nearFar[0] || P.y \x3c 0.0  || P.y \x3e 1.0 )\n      {\n        return vec3(P, 0.);\n      }\n\n      // If we detect a hit - return the intersection point, two conditions:\n      //  - dDepth \x3e 0.0 - sampled point depth is in front of estimated depth\n      //  - if difference between dDepth and rayDiffZOld is not too large\n      //  - if difference between dDepth and 0.025/abs(k) is not too large\n      //  - if the sampled depth is not behind far plane or in front of near plane\n\n      if((dDepth) \x3c 0.025/abs(k) +  abs(rayDiffZOld) \x26\x26 dDepth \x3e 0.0 \x26\x26 depth \x3e nearFar[0] \x26\x26 depth \x3c nearFar[1])\n      {\n          return vec3(P, depth);\n      }\n\n      // continue with ray marching\n      P +\x3d dP;\n      Q.z +\x3d dQ.z;\n      k +\x3d dk;\n      rayDiffZOld \x3d rayDiffZ;\n    }\n    return vec3(P, 0.0);\n  }\n  "],
["\n  const int maxSteps \x3d ","\n\n  vec4 applyProjectionMat(mat4 projectionMat, vec3 x)\n  {\n    vec4 projectedCoord \x3d  projectionMat * vec4(x, 1.0);\n    projectedCoord.xy /\x3d projectedCoord.w;\n    projectedCoord.xy \x3d projectedCoord.xy*0.5 + 0.5;\n    return projectedCoord;\n  }\n\n  vec3 screenSpaceIntersection(vec3 dir, vec3 startPosition, vec3 viewDir, vec3 normal)\n  {\n    vec3 viewPos \x3d startPosition;\n    vec3 viewPosEnd \x3d startPosition;\n\n    // Project the start position to the screen\n    vec4 projectedCoordStart \x3d applyProjectionMat(rpProjectionMat, viewPos);\n    vec3  Q0 \x3d viewPos / projectedCoordStart.w; // homogeneous camera space\n    float k0 \x3d 1.0/ projectedCoordStart.w;\n\n    // advance the position in the direction of the reflection\n    viewPos +\x3d dir;\n\n    vec4 projectedCoordVanishingPoint \x3d applyProjectionMat(rpProjectionMat, dir);\n\n    // Project the advanced position to the screen\n    vec4 projectedCoordEnd \x3d applyProjectionMat(rpProjectionMat, viewPos);\n    vec3  Q1 \x3d viewPos / projectedCoordEnd.w; // homogeneous camera space\n    float k1 \x3d 1.0/ projectedCoordEnd.w;\n\n    // calculate the reflection direction in the screen space\n    vec2 projectedCoordDir \x3d (projectedCoordEnd.xy - projectedCoordStart.xy);\n    vec2 projectedCoordDistVanishingPoint \x3d (projectedCoordVanishingPoint.xy - projectedCoordStart.xy);\n\n    float yMod \x3d min(abs(projectedCoordDistVanishingPoint.y), 1.0);\n\n    float projectedCoordDirLength \x3d length(projectedCoordDir);\n    float maxSt \x3d float(maxSteps);\n\n    // normalize the projection direction depending on maximum steps\n    // this determines how blocky the reflection looks\n    vec2 dP \x3d yMod * (projectedCoordDir)/(maxSt * projectedCoordDirLength);\n\n    // Normalize the homogeneous camera space coordinates\n    vec3  dQ \x3d yMod * (Q1 - Q0)/(maxSt * projectedCoordDirLength);\n    float dk \x3d yMod * (k1 - k0)/(maxSt * projectedCoordDirLength);\n\n    // initialize the variables for ray marching\n    vec2 P \x3d projectedCoordStart.xy;\n    vec3 Q \x3d Q0;\n    float k \x3d k0;\n    float rayStartZ \x3d -startPosition.z; // estimated ray start depth value\n    float rayEndZ \x3d -startPosition.z;   // estimated ray end depth value\n    float prevEstimateZ \x3d -startPosition.z;\n    float rayDiffZ;\n    float dDepth;\n    float depth;\n    float rayDiffZOld \x3d 0.0;\n\n    // early outs\n    if (dot(normal, dir) \x3c 0.0 || dot(-viewDir, normal) \x3c 0.0)\n      return vec3(P, 0.0);\n\n    for(int i \x3d 0; i \x3c maxSteps; i++)\n    {\n      depth \x3d -linearDepthFromTexture(depthMapView, P, nearFar); // get linear depth from the depth buffer\n\n      // estimate depth of the marching ray\n      rayStartZ \x3d prevEstimateZ;\n      dDepth \x3d -rayStartZ - depth;\n      rayEndZ \x3d (dQ.z * 0.5 + Q.z)/ ((dk * 0.5 + k));\n      rayDiffZ \x3d rayEndZ- rayStartZ;\n      prevEstimateZ \x3d rayEndZ;\n\n      if(-rayEndZ \x3e nearFar[1] || -rayEndZ \x3c nearFar[0] || P.y \x3c 0.0  || P.y \x3e 1.0 )\n      {\n        return vec3(P, 0.);\n      }\n\n      // If we detect a hit - return the intersection point, two conditions:\n      //  - dDepth \x3e 0.0 - sampled point depth is in front of estimated depth\n      //  - if difference between dDepth and rayDiffZOld is not too large\n      //  - if difference between dDepth and 0.025/abs(k) is not too large\n      //  - if the sampled depth is not behind far plane or in front of near plane\n\n      if((dDepth) \x3c 0.025/abs(k) +  abs(rayDiffZOld) \x26\x26 dDepth \x3e 0.0 \x26\x26 depth \x3e nearFar[0] \x26\x26 depth \x3c nearFar[1])\n      {\n          return vec3(P, depth);\n      }\n\n      // continue with ray marching\n      P +\x3d dP;\n      Q.z +\x3d dQ.z;\n      k +\x3d dk;\n      rayDiffZOld \x3d rayDiffZ;\n    }\n    return vec3(P, 0.0);\n  }\n  "])),
c.highStepCount?"150;":"75;"))}Object.defineProperty(f,"__esModule",{value:!0});f.ScreenSpaceReflections=g;(function(d){d.bindUniforms=function(c,a,b){b.ssrEnabled&&(c.setUniform1i("depthMapView",b.linearDepthTextureID),a.bindTexture(b.linearDepthTexture,b.linearDepthTextureID),c.setUniform2f("nearFar",b.nearFar[0],b.nearFar[1]),c.setUniformMatrix4fv("ssrViewMat",b.ssrViewMat),m.Reprojection.bindUniforms(c,a,b))}})(g=f.ScreenSpaceReflections||(f.ScreenSpaceReflections={}));var k})},"esri/views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl":function(){define(["require",
"exports","tslib","../util/RgbaFloatEncoding.glsl","../../shaderModules/interfaces"],function(u,f,e,r,m){function d(d){d.include(r.RgbaFloatEncoding);d.fragment.code.add(m.glsl(g||(g=e.__makeTemplateObject(["\n    float linearDepthFromTexture(sampler2D depthTex, vec2 uv, vec2 nearFar) {\n      return -(rgba2float(texture2D(depthTex, uv)) * (nearFar[1] - nearFar[0]) + nearFar[0]);\n    }\n  "],["\n    float linearDepthFromTexture(sampler2D depthTex, vec2 uv, vec2 nearFar) {\n      return -(rgba2float(texture2D(depthTex, uv)) * (nearFar[1] - nearFar[0]) + nearFar[0]);\n    }\n  "]))))}
Object.defineProperty(f,"__esModule",{value:!0});f.ReadLinearDepth=d;(function(d){d.bindUniforms=function(d,c){d.setUniform2fv("nearFar",c.nearFar)}})(d=f.ReadLinearDepth||(f.ReadLinearDepth={}));var g})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/Reprojection.glsl":function(){define(["require","exports","tslib","../../shaderModules/interfaces"],function(u,f,e,r){function m(g){g.fragment.uniforms.add("lastFrameColorMap","sampler2D");g.fragment.uniforms.add("reprojectionMat","mat4");g.fragment.uniforms.add("rpProjectionMat",
"mat4");g.fragment.code.add(r.glsl(d||(d=e.__makeTemplateObject(["\n  vec2 reprojectionCoordinate(vec3 projectionCoordinate)\n  {\n    vec4 zw \x3d rpProjectionMat * vec4(0.0, 0.0, -projectionCoordinate.z, 1.0);\n    vec4 reprojectedCoord \x3d reprojectionMat * vec4(zw.w * (projectionCoordinate.xy * 2.0 - 1.0), zw.z, zw.w);\n    reprojectedCoord.xy /\x3d reprojectedCoord.w;\n    return reprojectedCoord.xy*0.5 + 0.5;\n  }\n  "],["\n  vec2 reprojectionCoordinate(vec3 projectionCoordinate)\n  {\n    vec4 zw \x3d rpProjectionMat * vec4(0.0, 0.0, -projectionCoordinate.z, 1.0);\n    vec4 reprojectedCoord \x3d reprojectionMat * vec4(zw.w * (projectionCoordinate.xy * 2.0 - 1.0), zw.z, zw.w);\n    reprojectedCoord.xy /\x3d reprojectedCoord.w;\n    return reprojectedCoord.xy*0.5 + 0.5;\n  }\n  "]))))}
Object.defineProperty(f,"__esModule",{value:!0});f.Reprojection=m;(function(d){d.bindUniforms=function(d,g,c){d.setUniform1i("lastFrameColorMap",c.lastFrameColorTextureID);g.bindTexture(c.lastFrameColorTexture,c.lastFrameColorTextureID);d.setUniformMatrix4fv("reprojectionMat",c.reprojectionMat);d.setUniformMatrix4fv("rpProjectionMat",c.rpProjectionMat)}})(m=f.Reprojection||(f.Reprojection={}));var d})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/WaterDistortion.glsl":function(){define(["require",
"exports","tslib","./FoamRendering.glsl","../../shaderModules/interfaces"],function(u,f,e,r,m){function d(d){d.fragment.uniforms.add("texWaveNormal","sampler2D");d.fragment.uniforms.add("texWavePerturbation","sampler2D");d.fragment.uniforms.add("waveParams","vec4");d.fragment.uniforms.add("waveDirection","vec2");d.include(r.FoamIntensity);d.fragment.code.add(m.glsl(g||(g=e.__makeTemplateObject(["\n      const vec2  FLOW_JUMP \x3d vec2(6.0/25.0, 5.0/24.0);\n\n      vec2 textureDenormalized2D(sampler2D _tex, vec2 _uv) {\n        return 2.0 * texture2D(_tex, _uv).rg - 1.0;\n      }\n\n      float sampleNoiseTexture(vec2 _uv) {\n        return texture2D(texWavePerturbation, _uv).b;\n      }\n\n      vec3 textureDenormalized3D(sampler2D _tex, vec2 _uv) {\n        return 2.0 * texture2D(_tex, _uv).rgb - 1.0;\n      }\n\n      float computeProgress(vec2 uv, float time) {\n        return fract(time);\n      }\n\n      float computeWeight(vec2 uv, float time) {\n        float progress \x3d computeProgress(uv, time);\n        return 1.0 - abs(1.0 - 2.0 * progress);\n      }\n\n      vec3 computeUVPerturbedWeigth(sampler2D texFlow, vec2 uv, float time, float phaseOffset) {\n        float flowStrength \x3d waveParams[2];\n        float flowOffset \x3d waveParams[3];\n\n        vec2 flowVector \x3d textureDenormalized2D(texFlow, uv) * flowStrength;\n\n        float progress \x3d computeProgress(uv, time + phaseOffset);\n        float weight \x3d computeWeight(uv, time + phaseOffset);\n\n        vec2 result \x3d uv;\n        result -\x3d flowVector * (progress + flowOffset);\n        result +\x3d phaseOffset;\n        result +\x3d (time - progress) * FLOW_JUMP;\n\n        return vec3(result, weight);\n      }\n\n      const float TIME_NOISE_TEXTURE_REPEAT \x3d 0.3737;\n      const float TIME_NOISE_STRENGTH \x3d 7.77;\n\n      vec3 getWaveLayer(sampler2D _texNormal, sampler2D _dudv, vec2 _uv, vec2 _waveDir, float time) {\n        float waveStrength \x3d waveParams[0];\n\n        // overall directional shift in uv's for directional wave movement for\n        // now we do a hard coded scale for wave speed such that a unit length\n        // direction is not too fast.\n        vec2 waveMovement \x3d time * -_waveDir;\n\n        float timeNoise \x3d sampleNoiseTexture(_uv * TIME_NOISE_TEXTURE_REPEAT) * TIME_NOISE_STRENGTH;\n\n        // compute two perturbed uvs and blend weights\n        // then sample the wave normals at the two positions and blend\n        vec3 uv_A \x3d computeUVPerturbedWeigth(_dudv, _uv + waveMovement, time + timeNoise, 0.0);\n        vec3 uv_B \x3d computeUVPerturbedWeigth(_dudv, _uv + waveMovement, time + timeNoise, 0.5);\n\n        vec3 normal_A \x3d textureDenormalized3D(_texNormal, uv_A.xy) * uv_A.z;\n        vec3 normal_B \x3d textureDenormalized3D(_texNormal, uv_B.xy) * uv_B.z;\n\n        // logic to flatten the wave pattern\n        // scale xy components of the normal, then adjust z (up) component\n        vec3 mixNormal \x3d normalize(normal_A + normal_B);\n        mixNormal.xy *\x3d waveStrength;\n        mixNormal.z \x3d sqrt(1.0 - dot(mixNormal.xy, mixNormal.xy));\n\n        return mixNormal;\n      }\n\n      vec4 getSurfaceNormalAndFoam(vec2 _uv, float _time) {\n        float waveTextureRepeat \x3d waveParams[1];\n        vec3 normal \x3d getWaveLayer(texWaveNormal, texWavePerturbation, _uv * waveTextureRepeat, waveDirection, _time);\n        float foam  \x3d normals2FoamIntensity(normal, waveParams[0]);\n        return vec4(normal, foam);\n      }\n    "],
["\n      const vec2  FLOW_JUMP \x3d vec2(6.0/25.0, 5.0/24.0);\n\n      vec2 textureDenormalized2D(sampler2D _tex, vec2 _uv) {\n        return 2.0 * texture2D(_tex, _uv).rg - 1.0;\n      }\n\n      float sampleNoiseTexture(vec2 _uv) {\n        return texture2D(texWavePerturbation, _uv).b;\n      }\n\n      vec3 textureDenormalized3D(sampler2D _tex, vec2 _uv) {\n        return 2.0 * texture2D(_tex, _uv).rgb - 1.0;\n      }\n\n      float computeProgress(vec2 uv, float time) {\n        return fract(time);\n      }\n\n      float computeWeight(vec2 uv, float time) {\n        float progress \x3d computeProgress(uv, time);\n        return 1.0 - abs(1.0 - 2.0 * progress);\n      }\n\n      vec3 computeUVPerturbedWeigth(sampler2D texFlow, vec2 uv, float time, float phaseOffset) {\n        float flowStrength \x3d waveParams[2];\n        float flowOffset \x3d waveParams[3];\n\n        vec2 flowVector \x3d textureDenormalized2D(texFlow, uv) * flowStrength;\n\n        float progress \x3d computeProgress(uv, time + phaseOffset);\n        float weight \x3d computeWeight(uv, time + phaseOffset);\n\n        vec2 result \x3d uv;\n        result -\x3d flowVector * (progress + flowOffset);\n        result +\x3d phaseOffset;\n        result +\x3d (time - progress) * FLOW_JUMP;\n\n        return vec3(result, weight);\n      }\n\n      const float TIME_NOISE_TEXTURE_REPEAT \x3d 0.3737;\n      const float TIME_NOISE_STRENGTH \x3d 7.77;\n\n      vec3 getWaveLayer(sampler2D _texNormal, sampler2D _dudv, vec2 _uv, vec2 _waveDir, float time) {\n        float waveStrength \x3d waveParams[0];\n\n        // overall directional shift in uv's for directional wave movement for\n        // now we do a hard coded scale for wave speed such that a unit length\n        // direction is not too fast.\n        vec2 waveMovement \x3d time * -_waveDir;\n\n        float timeNoise \x3d sampleNoiseTexture(_uv * TIME_NOISE_TEXTURE_REPEAT) * TIME_NOISE_STRENGTH;\n\n        // compute two perturbed uvs and blend weights\n        // then sample the wave normals at the two positions and blend\n        vec3 uv_A \x3d computeUVPerturbedWeigth(_dudv, _uv + waveMovement, time + timeNoise, 0.0);\n        vec3 uv_B \x3d computeUVPerturbedWeigth(_dudv, _uv + waveMovement, time + timeNoise, 0.5);\n\n        vec3 normal_A \x3d textureDenormalized3D(_texNormal, uv_A.xy) * uv_A.z;\n        vec3 normal_B \x3d textureDenormalized3D(_texNormal, uv_B.xy) * uv_B.z;\n\n        // logic to flatten the wave pattern\n        // scale xy components of the normal, then adjust z (up) component\n        vec3 mixNormal \x3d normalize(normal_A + normal_B);\n        mixNormal.xy *\x3d waveStrength;\n        mixNormal.z \x3d sqrt(1.0 - dot(mixNormal.xy, mixNormal.xy));\n\n        return mixNormal;\n      }\n\n      vec4 getSurfaceNormalAndFoam(vec2 _uv, float _time) {\n        float waveTextureRepeat \x3d waveParams[1];\n        vec3 normal \x3d getWaveLayer(texWaveNormal, texWavePerturbation, _uv * waveTextureRepeat, waveDirection, _time);\n        float foam  \x3d normals2FoamIntensity(normal, waveParams[0]);\n        return vec4(normal, foam);\n      }\n    "]))))}
Object.defineProperty(f,"__esModule",{value:!0});f.WaterDistortion=d;(function(d){d.bindUniforms=function(d,c){d.setUniform1i("texWaveNormal",0);d.setUniform1i("texWavePerturbation",1);d.setUniform4f("waveParams",c.waveStrength,c.waveTextureRepeat,c.flowStrength,c.flowOffset);d.setUniform2f("waveDirection",c.waveDirection[0]*c.waveVelocity,c.waveDirection[1]*c.waveVelocity)}})(d=f.WaterDistortion||(f.WaterDistortion={}));var g})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/FoamRendering.glsl":function(){define(["require",
"exports","tslib","../../shaderModules/interfaces"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.FoamIntensity=function(d){d.fragment.code.add(r.glsl(m||(m=e.__makeTemplateObject(["\n    float normals2FoamIntensity(vec3 n, float waveStrength){\n      float normalizationFactor \x3d  max(0.015, waveStrength);\n      return max((n.x + n.y)*0.3303545/normalizationFactor + 0.3303545, 0.0);\n    }\n  "],["\n    float normals2FoamIntensity(vec3 n, float waveStrength){\n      float normalizationFactor \x3d  max(0.015, waveStrength);\n      return max((n.x + n.y)*0.3303545/normalizationFactor + 0.3303545, 0.0);\n    }\n  "]))))};
f.FoamColor=function(g){g.fragment.code.add(r.glsl(d||(d=e.__makeTemplateObject(["\n    vec3 foamIntensity2FoamColor(float foamIntensityExternal, float foamPixelIntensity, vec3 skyZenitColor, float dayMod){\n      return foamIntensityExternal * (0.075 * skyZenitColor * pow(foamPixelIntensity, 4.) +  50.* pow(foamPixelIntensity, 23.0)) * dayMod;\n    }\n  "],["\n    vec3 foamIntensity2FoamColor(float foamIntensityExternal, float foamPixelIntensity, vec3 skyZenitColor, float dayMod){\n      return foamIntensityExternal * (0.075 * skyZenitColor * pow(foamPixelIntensity, 4.) +  50.* pow(foamPixelIntensity, 23.0)) * dayMod;\n    }\n  "]))))};
var m,d})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/Camera.glsl":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});(function(e){function f(e,d,g){e.setUniform3f("camPos",g[3]-d[0],g[7]-d[1],g[11]-d[2])}e.bindUniformsCustomOrigin=f;e.bindUniforms=function(e,d){f(e,d.origin,d.viewInvTransp)}})(f.Camera||(f.Camera={}));(function(e){e.bindUniforms=function(e,f){e.setUniform1f("pixelRatio",f.pixelRatio||1);e.setUniform4fv("viewport",f.viewport)}})(f.Viewport||
(f.Viewport={}))})},"esri/views/3d/webgl-engine/core/shaderTechnique/ReloadableShaderModule":function(){define(["require","exports","tslib"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function f(e,d){this._module=e;this._loadModule=d}f.prototype.get=function(){return this._module};f.prototype.reload=function(){return e.__awaiter(this,void 0,void 0,function(){var f;return e.__generator(this,function(d){switch(d.label){case 0:return f=this,[4,this._loadModule()];case 1:return f._module=
d.sent(),[2,this._module]}})})};return f}();f.ReloadableShaderModule=u})},"esri/views/3d/webgl-engine/core/shaderTechnique/ShaderTechnique":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function e(e,f){if(f){var d=f.__proto__.__configurationParameters||[],g={};g.key=f.key;for(var k=0;k<d.length;k++){var l=d[k];g[l]=f[l]}this._config=g}this._program=this.initializeProgram(e);e.commonUniformStore&&(this._commonUniformStore=e.commonUniformStore,
this._commonUniformStore.subscribeProgram(this._program));this._pipeline=this.initializePipeline(e)}e.prototype.dispose=function(){this._program&&(this._commonUniformStore&&this._commonUniformStore.unsubscribeProgram(this._program),this._program.dispose(),this._program=null)};e.prototype.reload=function(e){this._program&&(this._commonUniformStore&&this._commonUniformStore.unsubscribeProgram(this._program),this._program.dispose());this._program=this.initializeProgram(e);this._commonUniformStore&&this._commonUniformStore.subscribeProgram(this._program)};
Object.defineProperty(e.prototype,"program",{get:function(){return this._program},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"pipeline",{get:function(){return this._pipeline},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"key",{get:function(){return this._config.key},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"configuration",{get:function(){return this._config},enumerable:!0,configurable:!0});e.prototype.bindPass=function(e,f,d){};
e.prototype.bindMaterial=function(e,f,d){};e.prototype.bindDraw=function(e,f,d){};e.prototype.bindPipelineState=function(e){e.setPipelineState(this.pipeline)};e.prototype.ensureAttributeLocations=function(e){this.program.assertCompatibleVertexAttributeLocations(e)};Object.defineProperty(e.prototype,"primitiveType",{get:function(){return 4},enumerable:!0,configurable:!0});return e}();f.ShaderTechnique=u})},"esri/views/3d/webgl-engine/core/shaderTechnique/ShaderTechniqueConfiguration":function(){define(["require",
"exports","../../../../../core/mathUtils"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});u=function(){return function(){this.key=0}}();f.ShaderTechniqueConfiguration=u;f.parameter=function(f){void 0===f&&(f={});return function(m,d){m.__configurationParameters=m.__configurationParameters||[];m.__configurationParameters.push(d);var g="_"+d;void 0===m.__configurationParameters__offset&&(m.__configurationParameters__offset=0);var k=m.__configurationParameters__offset,l=Math.ceil(e.log2(f.count||
2)),c=(1<<l)-1<<k;m.__configurationParameters__offset+=l;if(32<=m.__configurationParameters__offset)throw Error("ShaderTechniqueConfiguration is too complex, requiring more than 32 bits to encode.\n      Either the configuration must be simplified, or this restriction must be relaxed.(Currently used: "+m.__configurationParameters__offset+")");Object.defineProperty(m,d,{get:function(){return this[g]},set:function(a){this.key=this.key&~c|a<<k&c;this[g]=a}})}}})},"esri/views/3d/webgl-engine/lib/DefaultTextureUnits":function(){define(["require",
"exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});f.DefaultTextureUnits={DIFFUSE:0,NORMAL:1,EMISSION:2,OCCLUSION:3,METALLIC_ROUGHNESS:4,SSAO:6,SHADOW_MAP:7}})},"esri/views/3d/webgl-engine/shaders/WaterSurface.glsl":function(){define("require exports tslib ../core/shaderLibrary/ForwardLinearDepth.glsl ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/Transform.glsl ../core/shaderLibrary/shading/NormalUtils.glsl ../core/shaderLibrary/shading/ReadShadowMap.glsl ../core/shaderLibrary/shading/Water.glsl ../core/shaderLibrary/shading/WaterDistortion.glsl ../core/shaderModules/interfaces ../core/shaderModules/ShaderBuilder".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b){Object.defineProperty(f,"__esModule",{value:!0});f.build=function(f){var u=new b.ShaderBuilder;u.include(d.Transform,{linearDepth:!1});u.attributes.add("position","vec3");u.attributes.add("uv0","vec2");u.vertex.uniforms.add("proj","mat4").add("view","mat4").add("localOrigin","vec3");0===f.output&&(u.include(g.NormalUtils,f),u.include(r.ForwardLinearDepth,f),u.varyings.add("vuv","vec2"),u.varyings.add("vpos","vec3"),u.varyings.add("vnormal","vec3"),u.varyings.add("vtbnMatrix",
"mat3"),u.vertex.code.add(a.glsl(q||(q=e.__makeTemplateObject(["\n      void main(void) {\n        vuv \x3d uv0;\n        vpos \x3d position;\n\n        vnormal \x3d getLocalUp(vpos, localOrigin);\n        vtbnMatrix \x3d getTBNMatrix(vnormal);\n\n        gl_Position \x3d transformPosition(proj, view, vpos);\n        forwardLinearDepth();\n      }\n    "],["\n      void main(void) {\n        vuv \x3d uv0;\n        vpos \x3d position;\n\n        vnormal \x3d getLocalUp(vpos, localOrigin);\n        vtbnMatrix \x3d getTBNMatrix(vnormal);\n\n        gl_Position \x3d transformPosition(proj, view, vpos);\n        forwardLinearDepth();\n      }\n    "])))),
u.include(c.WaterDistortion,f),u.include(m.Slice,f),f.receiveShadows&&u.include(k.ReadShadowMap,f),u.include(l.Water,f),u.fragment.uniforms.add("waterColor","vec4").add("lightingMainDirection","vec3").add("lightingMainIntensity","vec3").add("camPos","vec3").add("timeElapsed","float").add("view","mat4"),u.fragment.code.add(a.glsl(v||(v=e.__makeTemplateObject(["\n      void main() {\n        discardBySlice(vpos);\n        vec3 localUp \x3d vnormal;\n        // the created normal is in tangent space\n        vec4 tangentNormalFoam \x3d getSurfaceNormalAndFoam(vuv, timeElapsed);\n\n        // we rotate the normal according to the tangent-bitangent-normal-Matrix\n        vec3 n \x3d normalize(vtbnMatrix * tangentNormalFoam.xyz);\n        vec3 v \x3d -normalize(vpos - camPos);\n        vec3 l \x3d normalize(-lightingMainDirection);\n        "],
["\n      void main() {\n        discardBySlice(vpos);\n        vec3 localUp \x3d vnormal;\n        // the created normal is in tangent space\n        vec4 tangentNormalFoam \x3d getSurfaceNormalAndFoam(vuv, timeElapsed);\n\n        // we rotate the normal according to the tangent-bitangent-normal-Matrix\n        vec3 n \x3d normalize(vtbnMatrix * tangentNormalFoam.xyz);\n        vec3 v \x3d -normalize(vpos - camPos);\n        vec3 l \x3d normalize(-lightingMainDirection);\n        "])))),f.receiveShadows?
u.fragment.code.add(a.glsl(t||(t=e.__makeTemplateObject(["\n        float shadow \x3d 1.0 - readShadowMap(vpos, linearDepth);\n      "],["\n        float shadow \x3d 1.0 - readShadowMap(vpos, linearDepth);\n      "])))):u.fragment.code.add(a.glsl(x||(x=e.__makeTemplateObject(["\n        float shadow \x3d 1.0;\n      "],["\n        float shadow \x3d 1.0;\n      "])))),u.fragment.code.add(a.glsl(z||(z=e.__makeTemplateObject(["\n        vec4 vPosView \x3d view*vec4(vpos, 1.0);\n        vec4 final \x3d vec4(getSeaColor(n, v, l, waterColor.rgb, lightingMainIntensity, localUp, shadow, tangentNormalFoam.w, vPosView.xyz), waterColor.w);\n\n        // gamma correction\n        gl_FragColor \x3d delinearizeGamma(final);\n        gl_FragColor \x3d highlightSlice(gl_FragColor, vpos);\n      }\n    "],
["\n        vec4 vPosView \x3d view*vec4(vpos, 1.0);\n        vec4 final \x3d vec4(getSeaColor(n, v, l, waterColor.rgb, lightingMainIntensity, localUp, shadow, tangentNormalFoam.w, vPosView.xyz), waterColor.w);\n\n        // gamma correction\n        gl_FragColor \x3d delinearizeGamma(final);\n        gl_FragColor \x3d highlightSlice(gl_FragColor, vpos);\n      }\n    "])))));2===f.output&&(u.include(g.NormalUtils,f),u.include(c.WaterDistortion,f),u.include(m.Slice,f),u.varyings.add("vpos","vec3"),
u.varyings.add("vuv","vec2"),u.vertex.code.add(a.glsl(A||(A=e.__makeTemplateObject(["\n        void main(void) {\n          vuv \x3d uv0;\n          vpos \x3d position;\n          gl_Position \x3d transformPosition(proj, view, vpos);\n        }\n    "],["\n        void main(void) {\n          vuv \x3d uv0;\n          vpos \x3d position;\n          gl_Position \x3d transformPosition(proj, view, vpos);\n        }\n    "])))),u.fragment.uniforms.add("timeElapsed","float"),u.fragment.code.add(a.glsl(E||
(E=e.__makeTemplateObject(["\n        void main() {\n          discardBySlice(vpos);\n\n          // the created normal is in tangent space and foam\n          vec4 tangentNormalFoam \x3d getSurfaceNormalAndFoam(vuv, timeElapsed);\n          tangentNormalFoam.xyz \x3d normalize(tangentNormalFoam.xyz);\n\n          gl_FragColor \x3d vec4((tangentNormalFoam.xyz + vec3(1.0)) * 0.5, tangentNormalFoam.w);\n        }\n    "],["\n        void main() {\n          discardBySlice(vpos);\n\n          // the created normal is in tangent space and foam\n          vec4 tangentNormalFoam \x3d getSurfaceNormalAndFoam(vuv, timeElapsed);\n          tangentNormalFoam.xyz \x3d normalize(tangentNormalFoam.xyz);\n\n          gl_FragColor \x3d vec4((tangentNormalFoam.xyz + vec3(1.0)) * 0.5, tangentNormalFoam.w);\n        }\n    "])))));
5===f.output&&(u.include(g.NormalUtils,f),u.varyings.add("vpos","vec3"),u.vertex.code.add(a.glsl(H||(H=e.__makeTemplateObject(["\n        void main(void) {\n          vpos \x3d position;\n          gl_Position \x3d transformPosition(proj, view, vpos);\n        }\n    "],["\n        void main(void) {\n          vpos \x3d position;\n          gl_Position \x3d transformPosition(proj, view, vpos);\n        }\n    "])))),u.fragment.uniforms.add("waterColor","vec4"),u.fragment.code.add(a.glsl(J||(J=e.__makeTemplateObject(["\n        void main() {\n          gl_FragColor \x3d waterColor;\n        }\n    "],
["\n        void main() {\n          gl_FragColor \x3d waterColor;\n        }\n    "])))));return u};var q,v,t,x,z,A,E,H,J})},"esri/views/3d/webgl-engine/core/shaderLibrary/ForwardLinearDepth.glsl":function(){define(["require","exports","tslib","../shaderModules/interfaces"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.ForwardLinearDepth=function(f,l){0===l.output&&l.receiveShadows?(f.varyings.add("linearDepth","float"),f.vertex.code.add(r.glsl(m||(m=e.__makeTemplateObject(["\n      void forwardLinearDepth() { linearDepth \x3d gl_Position.w; }\n    "],
["\n      void forwardLinearDepth() { linearDepth \x3d gl_Position.w; }\n    "]))))):1===l.output||3===l.output?(f.varyings.add("linearDepth","float"),f.vertex.uniforms.add("uCameraNearFar","vec2"),f.vertex.code.add(r.glsl(d||(d=e.__makeTemplateObject(["\n      void forwardLinearDepth() {\n        linearDepth \x3d (-position_view().z - uCameraNearFar[0]) / (uCameraNearFar[1] - uCameraNearFar[0]);\n      }\n    "],["\n      void forwardLinearDepth() {\n        linearDepth \x3d (-position_view().z - uCameraNearFar[0]) / (uCameraNearFar[1] - uCameraNearFar[0]);\n      }\n    "]))))):
f.vertex.code.add(r.glsl(g||(g=e.__makeTemplateObject(["\n      void forwardLinearDepth() {}\n    "],["\n      void forwardLinearDepth() {}\n    "]))))};var m,d,g})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/NormalUtils.glsl":function(){define(["require","exports","tslib","../../shaderModules/interfaces"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.NormalUtils=function(f,c){0===c.viewingMode?f.vertex.code.add(r.glsl(m||(m=e.__makeTemplateObject(["\n      vec3 getLocalUp(in vec3 pos, in vec3 origin) {\n          return normalize(pos + origin);\n      }\n    "],
["\n      vec3 getLocalUp(in vec3 pos, in vec3 origin) {\n          return normalize(pos + origin);\n      }\n    "])))):f.vertex.code.add(r.glsl(d||(d=e.__makeTemplateObject(["\n      vec3 getLocalUp(in vec3 pos, in vec3 origin) {\n          return vec3(0.0, 0.0, 1.0); // WARNING: up-axis dependent code\n      }\n    "],["\n      vec3 getLocalUp(in vec3 pos, in vec3 origin) {\n          return vec3(0.0, 0.0, 1.0); // WARNING: up-axis dependent code\n      }\n    "]))));0===c.viewingMode?f.vertex.code.add(r.glsl(g||
(g=e.__makeTemplateObject(["\n        mat3 getTBNMatrix(in vec3 n) {\n            vec3 t \x3d normalize(cross(vec3(0.0, 0.0, 1.0), n));\n            vec3 b \x3d normalize(cross(n, t));\n            return mat3(t, b, n);\n        }\n    "],["\n        mat3 getTBNMatrix(in vec3 n) {\n            vec3 t \x3d normalize(cross(vec3(0.0, 0.0, 1.0), n));\n            vec3 b \x3d normalize(cross(n, t));\n            return mat3(t, b, n);\n        }\n    "])))):f.vertex.code.add(r.glsl(k||(k=e.__makeTemplateObject(["\n        mat3 getTBNMatrix(in vec3 n) {\n            vec3 t \x3d vec3(1.0, 0.0, 0.0);\n            vec3 b \x3d normalize(cross(n, t));\n            return mat3(t, b, n);\n        }\n    "],
["\n        mat3 getTBNMatrix(in vec3 n) {\n            vec3 t \x3d vec3(1.0, 0.0, 0.0);\n            vec3 b \x3d normalize(cross(n, t));\n            return mat3(t, b, n);\n        }\n    "]))))};var m,d,g,k})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/Water.glsl":function(){define("require exports tslib ./FoamRendering.glsl ./Gamma.glsl ./PhysicallyBasedRendering.glsl ./ScreenSpaceReflections.glsl ../../shaderModules/interfaces".split(" "),function(u,f,e,r,m,d,g,k){Object.defineProperty(f,
"__esModule",{value:!0});f.Water=function(b,f){b.include(d.PhysicallyBasedRendering,f);b.include(m.Gamma);b.include(r.FoamColor);f.ssrEnabled&&b.include(g.ScreenSpaceReflections,f);b.fragment.code.add(k.glsl(l||(l=e.__makeTemplateObject(["\n    const vec3 fresnelSky \x3d  vec3(0.02, 1.0, 15.0); // f0, f0max, exp\n    const vec2 fresnelMaterial \x3d  vec2(0.02, 0.1); // f0, f0max for specular term\n    const float roughness \x3d 0.015;\n    const float foamIntensityExternal \x3d 1.7;\n    const float ssrIntensity \x3d 0.65;\n    const float ssrHeightFadeStart \x3d 300000.0;\n    const float ssrHeightFadeEnd \x3d 500000.0;\n    const float waterDiffusion \x3d 0.775;\n    const float waterSeeColorMod \x3d 0.8;\n    const float correctionViewingPowerFactor \x3d 0.4;\n\n    const vec3 skyZenitColor \x3d vec3(0.52, 0.68, 0.90);\n    const vec3 skyColor \x3d vec3(0.67, 0.79, 0.9);\n\n    PBRShadingWater shadingInfo;\n\n    /*\n    *   This function is an approximation for the sky gradient reflected\n    *   the water surface and describes a combination of two fresnel terms.\n    *   @parameter: cosTheta \x3d is the result of max(dot(n,v), 0.0)\n    *   @parameter: horizon \x3d the dominant color of the sky horizon\n    *   @parameter: cosTheta \x3d the dominant color of the sky zenit\n    */\n    vec3 getSkyGradientColor(in float cosTheta, in vec3 horizon, in vec3 zenit) {\n      float exponent \x3d pow((1.0 - cosTheta), fresnelSky[2]);\n      return mix(zenit, horizon, exponent);\n    }\n\n    /*\n    *   This function determines the water color per pixel.\n    *   @parameter: n \x3d normal facing away from the surface\n    *   @parameter: v \x3d view direction facing away from the surface.\n    *   @parameter: l \x3d light direction facing away from the surface\n    *   @parameter: lightIntensity \x3d light intensity, currently between 0...PI\n    *   @parameter: localUp \x3d a normal for the general direction of the surface\n    *   @parameter: shadow \x3d the amount of shadow at this pixel (0 \x3d no shadow)\n    */\n    vec3 getSeaColor(in vec3 n, in vec3 v, in vec3 l, vec3 color, in vec3 lightIntensity, in vec3 localUp, in float shadow, float foamIntensity, vec3 positionView) {\n\n      float reflectionHit \x3d 0.;\n      vec3 seaWaterColor \x3d linearizeGamma(color);\n      // using half vector to determine the specular light\n      vec3 h \x3d normalize(l + v);\n      shadingInfo.NdotL \x3d clamp(dot(n, l), 0.0, 1.0);\n      shadingInfo.NdotV \x3d clamp(dot(n, v), 0.001, 1.0);\n      shadingInfo.VdotN \x3d clamp(dot(v, n), 0.001, 1.0);\n      shadingInfo.NdotH \x3d clamp(dot(n, h), 0.0, 1.0);\n      shadingInfo.VdotH \x3d clamp(dot(v, h), 0.0, 1.0);\n      shadingInfo.LdotH \x3d clamp(dot(l, h), 0.0, 1.0);\n\n      // angle between vertex normal and view direction\n      float upDotV \x3d max(dot(localUp,v), 0.0);\n      // reflected sky color: the reflected sky color consists of two main colors, the\n      // reflected color at the horizon and the reflected color of the zenit.\n      // the reflected sky color is then an approximation based on the fresnel term.\n      vec3 skyHorizon \x3d linearizeGamma(skyColor);\n      vec3 skyZenit \x3d linearizeGamma(skyZenitColor);\n      vec3 skyColor \x3d getSkyGradientColor(upDotV, skyHorizon, skyZenit );\n\n      // we use the upDotL to smoothen out the\n      // reflected color of the water\n      float upDotL \x3d max(dot(localUp,l),0.0);\n\n      // The approximated sky color is adjusted according to the sun position.\n      // This is done as approximation for e.g. night views.\n      float daytimeMod \x3d 0.1 + upDotL * 0.9;\n      skyColor *\x3d daytimeMod;\n\n      // If a water surface is in shadow we just use a slight darkening of the\n      // water surface expressed with this shadowModifier.\n      float shadowModifier \x3d clamp(shadow, 0.8, 1.0);\n\n      // The reflected sky color consists of the fresnel reflection multiplied with the approximated sky color.\n      // The shadow is influencing the frensel term to keep the shadow impression for really near views. As long\n      // as reflection are absent there is a need to have a slight shadow for depth perception.\n      vec3 fresnelModifier \x3d fresnelReflection(shadingInfo.VdotN, vec3(fresnelSky[0]), fresnelSky[1]);\n      vec3 reflSky \x3d fresnelModifier * skyColor * shadowModifier;\n\n      // The reflected sea color is the input water color combined with the reflected sky color.\n      // The reflected sky color is modified by the incoming light.\n      vec3 reflSea \x3d seaWaterColor * mix(skyColor, upDotL * lightIntensity * LIGHT_NORMALIZATION, 2.0 / 3.0) * shadowModifier;\n\n      vec3 specular \x3d vec3(0.0);\n      // This prevents the specular light to be rendered when:\n      // - sun is behind a polygon (e.g. sundown for elevated polygons where nDotL might be still ok)\n      // - viewer is under water (for this localUp is better than n)\n      if(upDotV \x3e 0.0 \x26\x26 upDotL \x3e 0.0) {\n        // calculate the cook torrance BRDF but with simplified occlusion\n        vec3 specularSun \x3d brdfSpecularWater(shadingInfo, roughness, vec3(fresnelMaterial[0]), fresnelMaterial[1]);\n\n        // Normalize light intensity to be between 0...1. Shadow cancels out specular light here\n        vec3 incidentLight \x3d lightIntensity * LIGHT_NORMALIZATION * shadow;\n\n        specular \x3d shadingInfo.NdotL * incidentLight * specularSun;\n      }\n\n      vec3 foam \x3d vec3(0.0);\n      if(upDotV \x3e 0.0) {\n        foam \x3d foamIntensity2FoamColor(foamIntensityExternal, foamIntensity, skyZenitColor, daytimeMod);\n      }\n      "],
["\n    const vec3 fresnelSky \x3d  vec3(0.02, 1.0, 15.0); // f0, f0max, exp\n    const vec2 fresnelMaterial \x3d  vec2(0.02, 0.1); // f0, f0max for specular term\n    const float roughness \x3d 0.015;\n    const float foamIntensityExternal \x3d 1.7;\n    const float ssrIntensity \x3d 0.65;\n    const float ssrHeightFadeStart \x3d 300000.0;\n    const float ssrHeightFadeEnd \x3d 500000.0;\n    const float waterDiffusion \x3d 0.775;\n    const float waterSeeColorMod \x3d 0.8;\n    const float correctionViewingPowerFactor \x3d 0.4;\n\n    const vec3 skyZenitColor \x3d vec3(0.52, 0.68, 0.90);\n    const vec3 skyColor \x3d vec3(0.67, 0.79, 0.9);\n\n    PBRShadingWater shadingInfo;\n\n    /*\n    *   This function is an approximation for the sky gradient reflected\n    *   the water surface and describes a combination of two fresnel terms.\n    *   @parameter: cosTheta \x3d is the result of max(dot(n,v), 0.0)\n    *   @parameter: horizon \x3d the dominant color of the sky horizon\n    *   @parameter: cosTheta \x3d the dominant color of the sky zenit\n    */\n    vec3 getSkyGradientColor(in float cosTheta, in vec3 horizon, in vec3 zenit) {\n      float exponent \x3d pow((1.0 - cosTheta), fresnelSky[2]);\n      return mix(zenit, horizon, exponent);\n    }\n\n    /*\n    *   This function determines the water color per pixel.\n    *   @parameter: n \x3d normal facing away from the surface\n    *   @parameter: v \x3d view direction facing away from the surface.\n    *   @parameter: l \x3d light direction facing away from the surface\n    *   @parameter: lightIntensity \x3d light intensity, currently between 0...PI\n    *   @parameter: localUp \x3d a normal for the general direction of the surface\n    *   @parameter: shadow \x3d the amount of shadow at this pixel (0 \x3d no shadow)\n    */\n    vec3 getSeaColor(in vec3 n, in vec3 v, in vec3 l, vec3 color, in vec3 lightIntensity, in vec3 localUp, in float shadow, float foamIntensity, vec3 positionView) {\n\n      float reflectionHit \x3d 0.;\n      vec3 seaWaterColor \x3d linearizeGamma(color);\n      // using half vector to determine the specular light\n      vec3 h \x3d normalize(l + v);\n      shadingInfo.NdotL \x3d clamp(dot(n, l), 0.0, 1.0);\n      shadingInfo.NdotV \x3d clamp(dot(n, v), 0.001, 1.0);\n      shadingInfo.VdotN \x3d clamp(dot(v, n), 0.001, 1.0);\n      shadingInfo.NdotH \x3d clamp(dot(n, h), 0.0, 1.0);\n      shadingInfo.VdotH \x3d clamp(dot(v, h), 0.0, 1.0);\n      shadingInfo.LdotH \x3d clamp(dot(l, h), 0.0, 1.0);\n\n      // angle between vertex normal and view direction\n      float upDotV \x3d max(dot(localUp,v), 0.0);\n      // reflected sky color: the reflected sky color consists of two main colors, the\n      // reflected color at the horizon and the reflected color of the zenit.\n      // the reflected sky color is then an approximation based on the fresnel term.\n      vec3 skyHorizon \x3d linearizeGamma(skyColor);\n      vec3 skyZenit \x3d linearizeGamma(skyZenitColor);\n      vec3 skyColor \x3d getSkyGradientColor(upDotV, skyHorizon, skyZenit );\n\n      // we use the upDotL to smoothen out the\n      // reflected color of the water\n      float upDotL \x3d max(dot(localUp,l),0.0);\n\n      // The approximated sky color is adjusted according to the sun position.\n      // This is done as approximation for e.g. night views.\n      float daytimeMod \x3d 0.1 + upDotL * 0.9;\n      skyColor *\x3d daytimeMod;\n\n      // If a water surface is in shadow we just use a slight darkening of the\n      // water surface expressed with this shadowModifier.\n      float shadowModifier \x3d clamp(shadow, 0.8, 1.0);\n\n      // The reflected sky color consists of the fresnel reflection multiplied with the approximated sky color.\n      // The shadow is influencing the frensel term to keep the shadow impression for really near views. As long\n      // as reflection are absent there is a need to have a slight shadow for depth perception.\n      vec3 fresnelModifier \x3d fresnelReflection(shadingInfo.VdotN, vec3(fresnelSky[0]), fresnelSky[1]);\n      vec3 reflSky \x3d fresnelModifier * skyColor * shadowModifier;\n\n      // The reflected sea color is the input water color combined with the reflected sky color.\n      // The reflected sky color is modified by the incoming light.\n      vec3 reflSea \x3d seaWaterColor * mix(skyColor, upDotL * lightIntensity * LIGHT_NORMALIZATION, 2.0 / 3.0) * shadowModifier;\n\n      vec3 specular \x3d vec3(0.0);\n      // This prevents the specular light to be rendered when:\n      // - sun is behind a polygon (e.g. sundown for elevated polygons where nDotL might be still ok)\n      // - viewer is under water (for this localUp is better than n)\n      if(upDotV \x3e 0.0 \x26\x26 upDotL \x3e 0.0) {\n        // calculate the cook torrance BRDF but with simplified occlusion\n        vec3 specularSun \x3d brdfSpecularWater(shadingInfo, roughness, vec3(fresnelMaterial[0]), fresnelMaterial[1]);\n\n        // Normalize light intensity to be between 0...1. Shadow cancels out specular light here\n        vec3 incidentLight \x3d lightIntensity * LIGHT_NORMALIZATION * shadow;\n\n        specular \x3d shadingInfo.NdotL * incidentLight * specularSun;\n      }\n\n      vec3 foam \x3d vec3(0.0);\n      if(upDotV \x3e 0.0) {\n        foam \x3d foamIntensity2FoamColor(foamIntensityExternal, foamIntensity, skyZenitColor, daytimeMod);\n      }\n      "]))));
f.ssrEnabled?b.fragment.code.add(k.glsl(c||(c=e.__makeTemplateObject(["\n      // Convert the world position to view position\n      vec4 viewPosition \x3d vec4(positionView.xyz, 1.0);\n      vec3 viewDir \x3d normalize(viewPosition.xyz);\n      vec4 viewNormalVectorCoordinate \x3d ssrViewMat *vec4(n, 0.0);\n      vec3 viewNormal \x3d normalize(viewNormalVectorCoordinate.xyz);\n      vec4 viewUp \x3d ssrViewMat *vec4(localUp, 0.0);\n\n      // at steeper viewing angles we use more of a vertex normal (in this case up) then the wave normal\n      // this removes some artifacts of normal mapping\n      float correctionViewingFactor \x3d pow(max(dot(-viewDir, viewUp.xyz), 0.0), correctionViewingPowerFactor);\n      vec3 viewNormalCorrected \x3d mix(viewUp.xyz, viewNormal, correctionViewingFactor);\n\n      vec3 reflected \x3d normalize(reflect(viewDir, viewNormalCorrected));\n\n      // perform screen space reflection to detect hit\n      vec3 hitCoordinate \x3d screenSpaceIntersection( normalize(reflected), viewPosition.xyz, viewDir, viewUp.xyz);\n      vec3 reflectedColor \x3d vec3(0.0);\n\n      // if there is a hit with ssr find reflected color from the reprojeted frame\n      if (hitCoordinate.z \x3e 0.0)\n      {\n        vec2 reprojectedCoordinate \x3d reprojectionCoordinate(hitCoordinate);\n\n        // fade out if there if the hit is near end of Y axis\n        vec2 dCoords \x3d smoothstep(0.3, 0.6, abs(vec2(0.5, 0.5) - hitCoordinate.xy));\n        float heightMod \x3d smoothstep(ssrHeightFadeEnd, ssrHeightFadeStart, -positionView.z);\n        reflectionHit \x3d waterDiffusion * clamp(1.0 - (1.3*dCoords.y), 0.0, 1.0) * heightMod;\n\n        reflectedColor \x3d linearizeGamma(texture2D(lastFrameColorMap, reprojectedCoordinate).xyz)* reflectionHit * fresnelModifier.y * ssrIntensity;\n      }\n      float seeColorMod \x3d  mix(waterSeeColorMod, waterSeeColorMod*0.5, reflectionHit);\n      // combining reflected sky, reflected sea, specular highlight and SSR reflections.\n      return tonemapACES((1. - reflectionHit) * reflSky + reflectedColor + reflSea * seeColorMod + specular + foam);\n    }\n  "],
["\n      // Convert the world position to view position\n      vec4 viewPosition \x3d vec4(positionView.xyz, 1.0);\n      vec3 viewDir \x3d normalize(viewPosition.xyz);\n      vec4 viewNormalVectorCoordinate \x3d ssrViewMat *vec4(n, 0.0);\n      vec3 viewNormal \x3d normalize(viewNormalVectorCoordinate.xyz);\n      vec4 viewUp \x3d ssrViewMat *vec4(localUp, 0.0);\n\n      // at steeper viewing angles we use more of a vertex normal (in this case up) then the wave normal\n      // this removes some artifacts of normal mapping\n      float correctionViewingFactor \x3d pow(max(dot(-viewDir, viewUp.xyz), 0.0), correctionViewingPowerFactor);\n      vec3 viewNormalCorrected \x3d mix(viewUp.xyz, viewNormal, correctionViewingFactor);\n\n      vec3 reflected \x3d normalize(reflect(viewDir, viewNormalCorrected));\n\n      // perform screen space reflection to detect hit\n      vec3 hitCoordinate \x3d screenSpaceIntersection( normalize(reflected), viewPosition.xyz, viewDir, viewUp.xyz);\n      vec3 reflectedColor \x3d vec3(0.0);\n\n      // if there is a hit with ssr find reflected color from the reprojeted frame\n      if (hitCoordinate.z \x3e 0.0)\n      {\n        vec2 reprojectedCoordinate \x3d reprojectionCoordinate(hitCoordinate);\n\n        // fade out if there if the hit is near end of Y axis\n        vec2 dCoords \x3d smoothstep(0.3, 0.6, abs(vec2(0.5, 0.5) - hitCoordinate.xy));\n        float heightMod \x3d smoothstep(ssrHeightFadeEnd, ssrHeightFadeStart, -positionView.z);\n        reflectionHit \x3d waterDiffusion * clamp(1.0 - (1.3*dCoords.y), 0.0, 1.0) * heightMod;\n\n        reflectedColor \x3d linearizeGamma(texture2D(lastFrameColorMap, reprojectedCoordinate).xyz)* reflectionHit * fresnelModifier.y * ssrIntensity;\n      }\n      float seeColorMod \x3d  mix(waterSeeColorMod, waterSeeColorMod*0.5, reflectionHit);\n      // combining reflected sky, reflected sea, specular highlight and SSR reflections.\n      return tonemapACES((1. - reflectionHit) * reflSky + reflectedColor + reflSea * seeColorMod + specular + foam);\n    }\n  "])))):
b.fragment.code.add(k.glsl(a||(a=e.__makeTemplateObject(["\n      // combining reflected sky, reflected sea, specular highlight and SSR reflections.\n      return tonemapACES(reflSky + reflSea * waterSeeColorMod + specular + foam);\n    }\n  "],["\n      // combining reflected sky, reflected sea, specular highlight and SSR reflections.\n      return tonemapACES(reflSky + reflSea * waterSeeColorMod + specular + foam);\n    }\n  "]))))};var l,c,a})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/Gamma.glsl":function(){define(["require",
"exports","tslib","../../shaderModules/interfaces"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.Gamma=function(d){d.fragment.code.add(r.glsl(m||(m=e.__makeTemplateObject(["\n    const float GAMMA \x3d 2.2;\n    const float INV_GAMMA \x3d 0.4545454545;\n\n    vec4 delinearizeGamma(vec4 color) {\n      return vec4(pow(color.rgb, vec3(INV_GAMMA)), color.w);\n    }\n\n    vec3 linearizeGamma(vec3 color) {\n      return pow(color, vec3(GAMMA));\n    }\n  "],["\n    const float GAMMA \x3d 2.2;\n    const float INV_GAMMA \x3d 0.4545454545;\n\n    vec4 delinearizeGamma(vec4 color) {\n      return vec4(pow(color.rgb, vec3(INV_GAMMA)), color.w);\n    }\n\n    vec3 linearizeGamma(vec3 color) {\n      return pow(color, vec3(GAMMA));\n    }\n  "]))))};
var m})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRendering.glsl":function(){define("require exports tslib ./AnalyticalSkyModel.glsl ./PiUtils.glsl ../../shaderModules/interfaces".split(" "),function(u,f,e,r,m,d){Object.defineProperty(f,"__esModule",{value:!0});f.PhysicallyBasedRendering=function(f,E){var A=f.fragment.code;f.include(m.PiUtils);if(3===E.pbrMode||4===E.pbrMode)A.add(d.glsl(g||(g=e.__makeTemplateObject(["\n    struct PBRShadingWater\n    {\n        float NdotL;   // cos angle between normal and light direction\n        float NdotV;   // cos angle between normal and view direction\n        float NdotH;   // cos angle between normal and half vector\n        float VdotH;   // cos angle between view direction and half vector\n        float LdotH;   // cos angle between light direction and half vector\n        float VdotN;   // cos angle between view direction and normal vector\n    };\n\n    float dtrExponent \x3d ",
";\n    "],["\n    struct PBRShadingWater\n    {\n        float NdotL;   // cos angle between normal and light direction\n        float NdotV;   // cos angle between normal and view direction\n        float NdotH;   // cos angle between normal and half vector\n        float VdotH;   // cos angle between view direction and half vector\n        float LdotH;   // cos angle between light direction and half vector\n        float VdotN;   // cos angle between view direction and normal vector\n    };\n\n    float dtrExponent \x3d ",
";\n    "])),E.useCustomDTRExponentForWater?"2.2":"2.0")),A.add(d.glsl(k||(k=e.__makeTemplateObject(["\n    vec3 fresnelReflection(float angle, vec3 f0, float f90) {\n      return f0 + (f90 - f0) * pow(1.0 - angle, 5.0);\n    }\n    "],["\n    vec3 fresnelReflection(float angle, vec3 f0, float f90) {\n      return f0 + (f90 - f0) * pow(1.0 - angle, 5.0);\n    }\n    "])))),A.add(d.glsl(l||(l=e.__makeTemplateObject(["\n    float normalDistributionWater(float NdotH, float roughness)\n    {\n      float r2 \x3d roughness * roughness;\n      float NdotH2 \x3d NdotH * NdotH;\n      float denom \x3d pow((NdotH2 * (r2 - 1.0) + 1.0), dtrExponent) * PI;\n      return r2 / denom;\n    }\n    "],
["\n    float normalDistributionWater(float NdotH, float roughness)\n    {\n      float r2 \x3d roughness * roughness;\n      float NdotH2 \x3d NdotH * NdotH;\n      float denom \x3d pow((NdotH2 * (r2 - 1.0) + 1.0), dtrExponent) * PI;\n      return r2 / denom;\n    }\n    "])))),A.add(d.glsl(c||(c=e.__makeTemplateObject(["\n    float geometricOcclusionKelemen(float LoH)\n    {\n        return 0.25 / (LoH * LoH);\n    }\n    "],["\n    float geometricOcclusionKelemen(float LoH)\n    {\n        return 0.25 / (LoH * LoH);\n    }\n    "])))),
A.add(d.glsl(a||(a=e.__makeTemplateObject(["\n    vec3 brdfSpecularWater(in PBRShadingWater props, float roughness, vec3 F0, float F0Max)\n    {\n      vec3  F \x3d fresnelReflection(props.VdotH, F0, F0Max);\n      float dSun \x3d normalDistributionWater(props.NdotH, roughness);\n      float V \x3d geometricOcclusionKelemen(props.LdotH);\n\n      float diffusionSunHaze \x3d mix(roughness + 0.045, roughness + 0.385, 1.0 - props.VdotH);\n      float strengthSunHaze  \x3d 1.2;\n      float dSunHaze \x3d normalDistributionWater(props.NdotH, diffusionSunHaze)*strengthSunHaze;\n\n      return ((dSun + dSunHaze) * V) * F;\n    }\n\n    vec3 tonemapACES(const vec3 x) {\n      return (x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14);\n    }\n    "],
["\n    vec3 brdfSpecularWater(in PBRShadingWater props, float roughness, vec3 F0, float F0Max)\n    {\n      vec3  F \x3d fresnelReflection(props.VdotH, F0, F0Max);\n      float dSun \x3d normalDistributionWater(props.NdotH, roughness);\n      float V \x3d geometricOcclusionKelemen(props.LdotH);\n\n      float diffusionSunHaze \x3d mix(roughness + 0.045, roughness + 0.385, 1.0 - props.VdotH);\n      float strengthSunHaze  \x3d 1.2;\n      float dSunHaze \x3d normalDistributionWater(props.NdotH, diffusionSunHaze)*strengthSunHaze;\n\n      return ((dSun + dSunHaze) * V) * F;\n    }\n\n    vec3 tonemapACES(const vec3 x) {\n      return (x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14);\n    }\n    "]))));
else if(1===E.pbrMode||2===E.pbrMode)f.include(r.AnalyticalSkyModel),A.add(d.glsl(b||(b=e.__makeTemplateObject(["\n    struct PBRShadingInfo\n    {\n        float NdotL;                  // cos angle between normal and light direction\n        float NdotV;                  // cos angle between normal and view direction\n        float NdotH;                  // cos angle between normal and half vector\n        float VdotH;                  // cos angle between view direction and half vector\n        float LdotH;                  // cos angle between view light direction and half vector\n        float NdotNG;                 // cos angle between normal and normal of the ground\n        float RdotNG;                 // cos angle between view direction reflected of the normal and normal of the ground\n        float NdotAmbDir;             // cos angle between view direction and the fill light in ambient illumination\n        float NdotH_Horizon;          // cos angle between normal and half vector defined with horizon illumination\n        vec3 skyRadianceToSurface;         // integrated radiance of the sky based on the surface roughness (used for specular reflection)\n        vec3 groundRadianceToSurface;      // integrated radiance of the ground based on the surface roughness (used for specular reflection)\n        vec3 skyIrradianceToSurface;       // irradiance of the sky (used for diffuse reflection)\n        vec3 groundIrradianceToSurface;    // irradiance of the ground (used for diffuse reflection)\n\n        float averageAmbientRadiance;      // average ambient radiance used to deduce black level in gamut mapping\n        float ssao;                   // ssao coefficient\n        vec3 albedoLinear;            // linear color of the albedo\n        vec3 f0;                      // fresnel value at normal incident light\n        vec3 f90;                     // fresnel value at 90o of incident light\n\n        vec3 diffuseColor;            // diffuse color of the material used in environment illumination\n        float metalness;              // metalness of the material\n        float roughness;              // roughness of the material\n    };\n    "],
["\n    struct PBRShadingInfo\n    {\n        float NdotL;                  // cos angle between normal and light direction\n        float NdotV;                  // cos angle between normal and view direction\n        float NdotH;                  // cos angle between normal and half vector\n        float VdotH;                  // cos angle between view direction and half vector\n        float LdotH;                  // cos angle between view light direction and half vector\n        float NdotNG;                 // cos angle between normal and normal of the ground\n        float RdotNG;                 // cos angle between view direction reflected of the normal and normal of the ground\n        float NdotAmbDir;             // cos angle between view direction and the fill light in ambient illumination\n        float NdotH_Horizon;          // cos angle between normal and half vector defined with horizon illumination\n        vec3 skyRadianceToSurface;         // integrated radiance of the sky based on the surface roughness (used for specular reflection)\n        vec3 groundRadianceToSurface;      // integrated radiance of the ground based on the surface roughness (used for specular reflection)\n        vec3 skyIrradianceToSurface;       // irradiance of the sky (used for diffuse reflection)\n        vec3 groundIrradianceToSurface;    // irradiance of the ground (used for diffuse reflection)\n\n        float averageAmbientRadiance;      // average ambient radiance used to deduce black level in gamut mapping\n        float ssao;                   // ssao coefficient\n        vec3 albedoLinear;            // linear color of the albedo\n        vec3 f0;                      // fresnel value at normal incident light\n        vec3 f90;                     // fresnel value at 90o of incident light\n\n        vec3 diffuseColor;            // diffuse color of the material used in environment illumination\n        float metalness;              // metalness of the material\n        float roughness;              // roughness of the material\n    };\n    "])))),
A.add(d.glsl(q||(q=e.__makeTemplateObject(["\n    float normalDistribution(float NdotH, float roughness)\n    {\n        float a \x3d NdotH * roughness;\n        float b \x3d roughness / (1.0 - NdotH * NdotH + a * a);\n        return b * b * INV_PI;\n    }\n    "],["\n    float normalDistribution(float NdotH, float roughness)\n    {\n        float a \x3d NdotH * roughness;\n        float b \x3d roughness / (1.0 - NdotH * NdotH + a * a);\n        return b * b * INV_PI;\n    }\n    "])))),A.add(d.glsl(v||
(v=e.__makeTemplateObject(["\n    const vec4 c0 \x3d vec4(-1.0, -0.0275, -0.572,  0.022);\n    const vec4 c1 \x3d vec4( 1.0,  0.0425,  1.040, -0.040);\n    const vec2 c2 \x3d vec2(-1.04, 1.04);\n\n    vec2 prefilteredDFGAnalytical(float roughness, float NdotV) {\n        vec4 r \x3d roughness * c0 + c1;\n        float a004 \x3d min(r.x * r.x, exp2(-9.28 * NdotV)) * r.x + r.y;\n        return c2 * a004 + r.zw;\n    }\n    "],["\n    const vec4 c0 \x3d vec4(-1.0, -0.0275, -0.572,  0.022);\n    const vec4 c1 \x3d vec4( 1.0,  0.0425,  1.040, -0.040);\n    const vec2 c2 \x3d vec2(-1.04, 1.04);\n\n    vec2 prefilteredDFGAnalytical(float roughness, float NdotV) {\n        vec4 r \x3d roughness * c0 + c1;\n        float a004 \x3d min(r.x * r.x, exp2(-9.28 * NdotV)) * r.x + r.y;\n        return c2 * a004 + r.zw;\n    }\n    "])))),
A.add(d.glsl(t||(t=e.__makeTemplateObject(["\n    vec3 evaluateEnvironmentIllumination(PBRShadingInfo inputs) {\n      vec3 indirectDiffuse \x3d evaluateDiffuseIlluminationHemisphere(inputs.groundIrradianceToSurface, inputs.skyIrradianceToSurface, inputs.NdotNG);\n      vec3 indirectSpecular \x3d evaluateSpecularIlluminationHemisphere(inputs.groundRadianceToSurface, inputs.skyRadianceToSurface, inputs.RdotNG, inputs.roughness);\n\n      // From diffuse illumination calculate reflected color\n      vec3 diffuseComponent \x3d inputs.diffuseColor * indirectDiffuse * INV_PI;\n\n      // From specular illumination calculate reflected color\n      vec2 dfg \x3d prefilteredDFGAnalytical(inputs.roughness, inputs.NdotV);\n      vec3 specularColor \x3d inputs.f0 * dfg.x + inputs.f90 * dfg.y;\n      vec3 specularComponent \x3d specularColor * indirectSpecular;\n\n      return (diffuseComponent + specularComponent);\n    }\n    "],
["\n    vec3 evaluateEnvironmentIllumination(PBRShadingInfo inputs) {\n      vec3 indirectDiffuse \x3d evaluateDiffuseIlluminationHemisphere(inputs.groundIrradianceToSurface, inputs.skyIrradianceToSurface, inputs.NdotNG);\n      vec3 indirectSpecular \x3d evaluateSpecularIlluminationHemisphere(inputs.groundRadianceToSurface, inputs.skyRadianceToSurface, inputs.RdotNG, inputs.roughness);\n\n      // From diffuse illumination calculate reflected color\n      vec3 diffuseComponent \x3d inputs.diffuseColor * indirectDiffuse * INV_PI;\n\n      // From specular illumination calculate reflected color\n      vec2 dfg \x3d prefilteredDFGAnalytical(inputs.roughness, inputs.NdotV);\n      vec3 specularColor \x3d inputs.f0 * dfg.x + inputs.f90 * dfg.y;\n      vec3 specularComponent \x3d specularColor * indirectSpecular;\n\n      return (diffuseComponent + specularComponent);\n    }\n    "])))),
A.add(d.glsl(x||(x=e.__makeTemplateObject(["\n    float gamutMapChanel(float x, vec2 p){\n      return (x \x3c p.x) ? mix(0.0, p.y, x/p.x) : mix(p.y, 1.0, (x - p.x) / (1.0 - p.x) );\n    }"],["\n    float gamutMapChanel(float x, vec2 p){\n      return (x \x3c p.x) ? mix(0.0, p.y, x/p.x) : mix(p.y, 1.0, (x - p.x) / (1.0 - p.x) );\n    }"])))),A.add(d.glsl(z||(z=e.__makeTemplateObject(["\n    vec3 blackLevelSoftCompression(vec3 inColor, PBRShadingInfo inputs){\n      vec3 outColor;\n      vec2 p \x3d vec2(0.02 * (inputs.averageAmbientRadiance), 0.0075 * (inputs.averageAmbientRadiance));\n      outColor.x \x3d gamutMapChanel(inColor.x, p) ;\n      outColor.y \x3d gamutMapChanel(inColor.y, p) ;\n      outColor.z \x3d gamutMapChanel(inColor.z, p) ;\n      return outColor;\n    }\n    "],
["\n    vec3 blackLevelSoftCompression(vec3 inColor, PBRShadingInfo inputs){\n      vec3 outColor;\n      vec2 p \x3d vec2(0.02 * (inputs.averageAmbientRadiance), 0.0075 * (inputs.averageAmbientRadiance));\n      outColor.x \x3d gamutMapChanel(inColor.x, p) ;\n      outColor.y \x3d gamutMapChanel(inColor.y, p) ;\n      outColor.z \x3d gamutMapChanel(inColor.z, p) ;\n      return outColor;\n    }\n    "]))))};var g,k,l,c,a,b,q,v,t,x,z})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/AnalyticalSkyModel.glsl":function(){define(["require",
"exports","tslib","../../shaderModules/interfaces"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.AnalyticalSkyModel=function(f){f=f.fragment.code;f.add(r.glsl(m||(m=e.__makeTemplateObject(["\n    vec3 evaluateDiffuseIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float NdotNG)\n    {\n      return ((1.0 - NdotNG) * ambientGround + (1.0 + NdotNG) * ambientSky) * 0.5;\n    }\n    "],["\n    vec3 evaluateDiffuseIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float NdotNG)\n    {\n      return ((1.0 - NdotNG) * ambientGround + (1.0 + NdotNG) * ambientSky) * 0.5;\n    }\n    "]))));
f.add(r.glsl(d||(d=e.__makeTemplateObject(["\n    float integratedRadiance(float cosTheta2, float roughness)\n    {\n      return (cosTheta2 - 1.0) / (cosTheta2 * (1.0 - roughness * roughness) - 1.0);\n    }\n    "],["\n    float integratedRadiance(float cosTheta2, float roughness)\n    {\n      return (cosTheta2 - 1.0) / (cosTheta2 * (1.0 - roughness * roughness) - 1.0);\n    }\n    "]))));f.add(r.glsl(g||(g=e.__makeTemplateObject(["\n    vec3 evaluateSpecularIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float RdotNG, float roughness)\n    {\n      float cosTheta2 \x3d 1.0 - RdotNG * RdotNG;\n      float intRadTheta \x3d integratedRadiance(cosTheta2, roughness);\n\n      // Calculate the integrated directional radiance of the ground and the sky\n      float ground \x3d RdotNG \x3c 0.0 ? 1.0 - intRadTheta : 1.0 + intRadTheta;\n      float sky \x3d 2.0 - ground;\n      return (ground * ambientGround + sky * ambientSky) * 0.5;\n    }\n    "],
["\n    vec3 evaluateSpecularIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float RdotNG, float roughness)\n    {\n      float cosTheta2 \x3d 1.0 - RdotNG * RdotNG;\n      float intRadTheta \x3d integratedRadiance(cosTheta2, roughness);\n\n      // Calculate the integrated directional radiance of the ground and the sky\n      float ground \x3d RdotNG \x3c 0.0 ? 1.0 - intRadTheta : 1.0 + intRadTheta;\n      float sky \x3d 2.0 - ground;\n      return (ground * ambientGround + sky * ambientSky) * 0.5;\n    }\n    "]))))};
var m,d,g})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/PiUtils.glsl":function(){define(["require","exports","tslib","../../shaderModules/interfaces"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.PiUtils=function(g){g.vertex.code.add(r.glsl(m||(m=e.__makeTemplateObject(["\n    const float PI \x3d 3.141592653589793;\n  "],["\n    const float PI \x3d 3.141592653589793;\n  "]))));g.fragment.code.add(r.glsl(d||(d=e.__makeTemplateObject(["\n    const float PI \x3d 3.141592653589793;\n    const float LIGHT_NORMALIZATION \x3d 1.0 / PI;\n    const float INV_PI \x3d 0.3183098861837907;\n    const float HALF_PI \x3d 1.570796326794897;\n    "],
["\n    const float PI \x3d 3.141592653589793;\n    const float LIGHT_NORMALIZATION \x3d 1.0 / PI;\n    const float INV_PI \x3d 0.3183098861837907;\n    const float HALF_PI \x3d 1.570796326794897;\n    "]))))};var m,d})},"esri/views/3d/webgl-engine/core/shaderModules/ShaderBuilder":function(){define(["require","exports","../../../../../core/Logger","../../../../../core/MapUtils","../../../../../core/SetUtils"],function(u,f,e,r,m){Object.defineProperty(f,"__esModule",{value:!0});var d=e.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder");
u=function(){function e(){this.vertex=new l;this.fragment=new l;this.attributes=new c;this.varyings=new a;this.extensions=new b;this.defines=new q;this._includedModules=new Map}e.prototype.include=function(a,b){this._includedModules.has(a)?this._includedModules.get(a)!==b&&d.error("Trying to include shader module multiple times with different sets of options."):(this._includedModules.set(a,b),"shaderModule"in a?a.shaderModule(this,b):a(this,b))};e.prototype.generateSource=function(a){var b=this.extensions.generateSource(a),
c=this.attributes.generateSource(a),d=this.varyings.generateSource(),e="vertex"===a?this.vertex:this.fragment,g=e.uniforms.generateSource(),f=e.code.generateSource();a="vertex"===a?t:v;e=this.defines.generateSource().concat(e.defines.generateSource());return"\n"+b.join("\n")+"\n\n"+e.join("\n")+"\n\n"+a+"\n\n"+g.join("\n")+"\n\n"+c.join("\n")+"\n\n"+d.join("\n")+"\n\n"+f.join("\n")};return e}();f.ShaderBuilder=u;var g=function(){function a(){this._entries=[];this._set=new Set}a.prototype.add=function(a,
b,c){var d=a+"_"+b+"_"+c;this._set.has(d)||(this._entries.push([a,b,c]),this._set.add(d));return this};a.prototype.generateSource=function(){return this._entries.map(function(a){var b=a[2];return"uniform "+a[1]+" "+a[0]+(b?"["+b+"]":"")+";"})};return a}(),k=function(){function a(){this._entries=[]}a.prototype.add=function(a){this._entries.push(a)};a.prototype.generateSource=function(){return this._entries};return a}(),l=function(){return function(){this.uniforms=new g;this.code=new k;this.defines=
new q}}(),c=function(){function a(){this._entries=[]}a.prototype.add=function(a,b){this._entries.push([a,b])};a.prototype.generateSource=function(a){return"fragment"===a?[]:this._entries.map(function(a){return"attribute "+a[1]+" "+a[0]+";"})};return a}(),a=function(){function a(){this._entries=[]}a.prototype.add=function(a,b){this._entries.push([a,b])};a.prototype.generateSource=function(){return this._entries.map(function(a){return"varying "+a[1]+" "+a[0]+";"})};return a}(),b=function(){function a(){this._entries=
new Set}a.prototype.add=function(a){this._entries.add(a)};a.prototype.generateSource=function(b){var c="vertex"===b?a.WHITELIST_VERTEX:a.WHITELIST_FRAGMENT;return m.valuesOfSet(this._entries).filter(function(a){return 0<=c.indexOf(a)}).map(function(a){return"#extension "+a+" : enable"})};a.WHITELIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"];a.WHITELIST_VERTEX=[];return a}(),q=function(){function a(){this._entries=new Map}a.prototype.addInt=function(a,b){b=0===b%1?b.toFixed(0):
b.toString();this._entries.set(a,b)};a.prototype.addFloat=function(a,b){b=0===b%1?b.toFixed(1):b.toString();this._entries.set(a,b)};a.prototype.generateSource=function(){return r.pairsOfMap(this._entries).map(function(a){return"#define "+a[0]+" "+a[1]})};return a}(),v="#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump sampler2D;\n#endif",t="precision highp float;\nprecision highp sampler2D;"})},"esri/views/webgl/Program":function(){define(["require",
"exports","../../core/has","../../core/maybe","./ShaderTranspiler"],function(u,f,e,r,m){function d(d,e){if(r.isNone(d)||d.length!==e.length)return!0;for(var g=0;g<d.length;++g)if(d[g]!==e[g])return!0;return!1}return function(){function e(d,g,c,a,b){void 0===b&&(b={});this._glName=this._context=null;this._locations={};this._id=void 0;this._initialized=!1;this._fShader=this._vShader=null;this._defines={};this._nameToUniformLocation={};this._nameToAttribLocation={};this._nameToUniform1={};this._nameToUniform1v=
{};this._nameToUniform2={};this._nameToUniform3={};this._nameToUniform4={};this._nameToUniformMatrix3={};this._nameToUniformMatrix4={};d||console.error("RenderingContext isn't initialized!");0===g.length&&console.error("Shaders source should not be empty!");this._context=d;this._vertexShaderSource=g;this._fragmentShaderSource=c;if(Array.isArray(b))for(d=0;d<b.length;d++)this._defines[b[d]]="1";else this._defines=b;this._id=e._nextId++;this._locations=a}Object.defineProperty(e.prototype,"id",{get:function(){return this._id},
enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0});e.prototype.getDefine=function(d){return this._defines[d]};e.prototype.dispose=function(){if(this._context){var d=this._context.gl;this._vShader&&(d.deleteShader(this._vShader),this._vShader=null);this._fShader&&(d.deleteShader(this._fShader),
this._fShader=null);this._glName&&(d.deleteProgram(this._glName),this._glName=null);this._context=null}};e.prototype.initialize=function(){if(!this._initialized){this._vShader=this._loadShader(35633);this._fShader=this._loadShader(35632);this._vShader&&this._fShader||console.error("Error loading shaders!");var d=this._context.gl,e=d.createProgram();d.attachShader(e,this._vShader);d.attachShader(e,this._fShader);for(var c in this._locations)d.bindAttribLocation(e,this._locations[c],c);d.linkProgram(e);
this._glName=e;this._initialized=!0}};e.prototype.getUniformLocation=function(d){this.initialize();void 0===this._nameToUniformLocation[d]&&(this._nameToUniformLocation[d]=this._context.gl.getUniformLocation(this._glName,d));return this._nameToUniformLocation[d]};e.prototype.hasUniform=function(d){return null!==this.getUniformLocation(d)};e.prototype.getAttribLocation=function(d){this.initialize();void 0===this._nameToAttribLocation[d]&&(this._nameToAttribLocation[d]=this._context.gl.getAttribLocation(this._glName,
d));return this._nameToAttribLocation[d]};e.prototype.setUniform1i=function(d,e){var c=this._nameToUniform1[d];if(void 0===c||e!==c)this._context.bindProgram(this),this._context.gl.uniform1i(this.getUniformLocation(d),e),this._nameToUniform1[d]=e};e.prototype.setUniform1iv=function(g,f){var c=this._nameToUniform1v[g];d(c,f)&&(this._context.bindProgram(this),this._context.gl.uniform1iv(this.getUniformLocation(g),f),void 0===c?this._nameToUniform1v[g]=e._arrayCopy(f):e._arrayAssign(f,c))};e.prototype.setUniform2iv=
function(g,f){var c=this._nameToUniform2[g];d(c,f)&&(this._context.bindProgram(this),this._context.gl.uniform2iv(this.getUniformLocation(g),f),void 0===c?this._nameToUniform2[g]=e._arrayCopy(f):e._arrayAssign(f,c))};e.prototype.setUniform3iv=function(g,f){var c=this._nameToUniform3[g];d(c,f)&&(this._context.bindProgram(this),this._context.gl.uniform3iv(this.getUniformLocation(g),f),void 0===c?this._nameToUniform3[g]=e._arrayCopy(f):e._arrayAssign(f,c))};e.prototype.setUniform4iv=function(g,f){var c=
this._nameToUniform4[g];d(c,f)&&(this._context.bindProgram(this),this._context.gl.uniform4iv(this.getUniformLocation(g),f),void 0===c?this._nameToUniform4[g]=e._arrayCopy(f):e._arrayAssign(f,c))};e.prototype.setUniform1f=function(d,e){var c=this._nameToUniform1[d];if(void 0===c||e!==c)this._context.bindProgram(this),this._context.gl.uniform1f(this.getUniformLocation(d),e),this._nameToUniform1[d]=e};e.prototype.setUniform1fv=function(g,f){var c=this._nameToUniform1v[g];d(c,f)&&(this._context.bindProgram(this),
this._context.gl.uniform1fv(this.getUniformLocation(g),f),void 0===c?this._nameToUniform1v[g]=e._arrayCopy(f):e._arrayAssign(f,c))};e.prototype.setUniform2f=function(d,e,c){var a=this._nameToUniform2[d];if(void 0===a||e!==a[0]||c!==a[1])this._context.bindProgram(this),this._context.gl.uniform2f(this.getUniformLocation(d),e,c),void 0===a?this._nameToUniform2[d]=[e,c]:(a[0]=e,a[1]=c)};e.prototype.setUniform2fv=function(g,f){var c=this._nameToUniform2[g];d(c,f)&&(this._context.bindProgram(this),this._context.gl.uniform2fv(this.getUniformLocation(g),
f),void 0===c?this._nameToUniform2[g]=e._arrayCopy(f):e._arrayAssign(f,c))};e.prototype.setUniform3f=function(d,e,c,a){var b=this._nameToUniform3[d];if(void 0===b||e!==b[0]||c!==b[1]||a!==b[2])this._context.bindProgram(this),this._context.gl.uniform3f(this.getUniformLocation(d),e,c,a),void 0===b?this._nameToUniform3[d]=[e,c,a]:(b[0]=e,b[1]=c,b[2]=a)};e.prototype.setUniform3fv=function(g,f){var c=this._nameToUniform3[g];d(c,f)&&(this._context.bindProgram(this),this._context.gl.uniform3fv(this.getUniformLocation(g),
f),void 0===c?this._nameToUniform3[g]=e._arrayCopy(f):e._arrayAssign(f,c))};e.prototype.setUniform4f=function(d,e,c,a,b){var g=this._nameToUniform4[d];if(void 0===g||e!==g[0]||c!==g[1]||a!==g[2]||b!==g[3])this._context.bindProgram(this),this._context.gl.uniform4f(this.getUniformLocation(d),e,c,a,b),void 0===g?this._nameToUniform4[d]=[e,c,a,b]:(g[0]=e,g[1]=c,g[2]=a,g[3]=b)};e.prototype.setUniform4fv=function(g,f){var c=this._nameToUniform4[g];d(c,f)&&(this._context.bindProgram(this),this._context.gl.uniform4fv(this.getUniformLocation(g),
f),void 0===c?this._nameToUniform4[g]=e._arrayCopy(f):e._arrayAssign(f,c))};e.prototype.setUniformMatrix3fv=function(g,f,c){void 0===c&&(c=!1);var a=this._nameToUniformMatrix3[g],b;b=r.isNone(a)?!0:9!==a.length?d(a,f):9!==a.length||a[0]!==f[0]||a[1]!==f[1]||a[2]!==f[2]||a[3]!==f[3]||a[4]!==f[4]||a[5]!==f[5]||a[6]!==f[6]||a[7]!==f[7]||a[8]!==f[8];b&&(this._context.bindProgram(this),this._context.gl.uniformMatrix3fv(this.getUniformLocation(g),c,f),void 0===a?this._nameToUniformMatrix3[g]=e._arrayCopy(f):
e._arrayAssign(f,a))};e.prototype.setUniformMatrix4fv=function(g,f,c){void 0===c&&(c=!1);var a=this._nameToUniformMatrix4[g],b;b=r.isNone(a)?!0:16!==a.length?d(a,f):16!==a.length||a[0]!==f[0]||a[1]!==f[1]||a[2]!==f[2]||a[3]!==f[3]||a[4]!==f[4]||a[5]!==f[5]||a[6]!==f[6]||a[7]!==f[7]||a[8]!==f[8]||a[9]!==f[9]||a[10]!==f[10]||a[11]!==f[11]||a[12]!==f[12]||a[13]!==f[13]||a[14]!==f[14]||a[15]!==f[15];b&&(this._context.bindProgram(this),this._context.gl.uniformMatrix4fv(this.getUniformLocation(g),c,f),
void 0===a?this._nameToUniformMatrix4[g]=e._arrayCopy(f):e._arrayAssign(f,a))};e.prototype.assertCompatibleVertexAttributeLocations=function(d){(d=d.locations===this.locations)||console.error("VertexAttributeLocations are incompatible");return d};e._padToThree=function(d){var e=d.toString();1E3>d&&(e=("  "+d).slice(-3));return e};e.prototype._addLineNumbers=function(d){var g=2;return d.replace(/\n/g,function(){return"\n"+e._padToThree(g++)+":"})};e.prototype._loadShader=function(d){var e=35633===
d,c=e?this._vertexShaderSource:this._fragmentShaderSource,a="",b;for(b in this._defines)a+="#define "+b+" "+this._defines[b]+"\n";c=a+c;"webgl2"===this._context.contextVersion&&(c=m.transpileShader(c,e?"vertex":"fragment"));e=this._context.gl;d=e.createShader(d);e.shaderSource(d,c);e.compileShader(d);return d};e._arrayCopy=function(d){for(var e=[],c=0;c<d.length;++c)e.push(d[c]);return e};e._arrayAssign=function(d,e){for(var c=0;c<d.length;++c)e[c]=d[c]};e._nextId=0;return e}()})},"esri/views/webgl/ShaderTranspiler":function(){define(["require",
"exports","./reservedWordsGLSL3","./lib/glsl-tokenizer/string"],function(u,f,e,r){function m(d){return d.map(function(c){return"eof"!==c.type?c.data:""}).join("")}function d(e,c,a,b){b=b||a;for(var g=0;g<e.length;g++){var f=e[g];if("ident"===f.type&&f.data===a)return b in c?c[b]++:c[b]=0,d(e,c,b+"_"+c[b],b)}return a}function g(d,c,a){void 0===a&&(a="afterVersion");var b={data:"\n",type:"whitespace"},e=function(a){return a<d.length?/[^\r\n]$/.test(d[a].data):!1},g=function(b){for(var c=-1,d=0,e=-1,
g=0;g<b.length;g++){var f=b[g];"preprocessor"===f.type&&(f.data.match(/\#(if|ifdef|ifndef)\s+.+/)?++d:f.data.match(/\#endif\s*.*/)&&--d);("afterVersion"===a||"afterPrecision"===a)&&"preprocessor"===f.type&&/^#version/.test(f.data)&&(e=Math.max(e,g));if("afterPrecision"===a&&"keyword"===f.type&&"precision"===f.data){a:{for(f=g;f<b.length;f++){var k=b[f];if("operator"===k.type&&";"===k.data)break a}f=null}if(null===f)throw Error("precision statement not followed by any semicolons!");e=Math.max(e,f)}c<
e&&0===d&&(c=g)}return c+1}(d);e(g-1)&&d.splice(g++,0,b);for(var f=0;f<c.length;f++){var k=c[f];d.splice(g++,0,k)}e(g-1)&&e(g)&&d.splice(g,0,b)}Object.defineProperty(f,"__esModule",{value:!0});var k=["GL_OES_standard_derivatives","GL_EXT_frag_depth","GL_EXT_draw_buffers","GL_EXT_shader_texture_lod"];f.transpileShader=function(f,c){f=r(f);var a;a:{a="100";var b="300 es";void 0===a&&(a="100");void 0===b&&(b="300 es");for(var q=/^\s*\#version\s+([0-9]+(\s+[a-zA-Z]+)?)\s*/,l=0;l<f.length;l++){var t=f[l];
if("preprocessor"===t.type){var x=q.exec(t.data);if(x){q=x[1].replace(/\s\s+/g," ");if(q===b){a=q;break a}if(q===a){t.data="#version "+b;break a}throw Error("unknown glsl version: "+q);}}}f.splice(0,0,{type:"preprocessor",data:"#version "+b},{type:"whitespace",data:"\n"});a=null}if("300 es"===a)throw Error("shader is already glsl 300 es");q=t=null;l={};x={};for(a=0;a<f.length;++a)switch(b=f[a],b.type){case "keyword":"vertex"===c&&"attribute"===b.data?b.data="in":"varying"===b.data&&(b.data="vertex"===
c?"out":"in");break;case "builtin":/^texture(2D|Cube)(Proj)?(Lod|Grad)?(EXT)?$/.test(b.data.trim())&&(b.data=b.data.replace(/(2D|Cube|EXT)/g,""));if("fragment"===c&&"gl_FragColor"===b.data){if(!t){var t=d(f,l,"fragColor"),z=void 0;void 0===z&&(z="lowp");g(f,[{type:"keyword",data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:z},{type:"whitespace",data:" "},{type:"keyword",data:"vec4"},{type:"whitespace",data:" "},{type:"ident",data:t},{type:"operator",data:";"}],"afterPrecision")}b.data=
t}else"fragment"===c&&"gl_FragDepthEXT"===b.data&&(q||(q=d(f,l,"gl_FragDepth")),b.data=q);break;case "ident":if(0<=e.indexOf(b.data)){if(z="vertex"===c)a:{for(z=a-1;0<=z;z--){var A=f[z];if("whitespace"!==A.type&&"block-comment"!==A.type)if("keyword"===A.type){if("attribute"===A.data||"in"===A.data){z=!0;break a}}else break}z=!1}if(z)throw Error("attribute in vertex shader uses a name that is a reserved word in glsl 300 es");b.data in x||(x[b.data]=d(f,l,b.data));b.data=x[b.data]}}for(a=f.length-1;0<=
a;--a)b=f[a],"preprocessor"===b.type&&((c=b.data.match(/\#extension\s+(.*)\:/))&&c[1]&&0<=k.indexOf(c[1].trim())&&(c=f[a+1],f.splice(a,c&&"whitespace"===c.type?2:1)),(c=b.data.match(/\#ifdef\s+(.*)/))&&c[1]&&0<=k.indexOf(c[1].trim())&&(b.data="#if 1"),(c=b.data.match(/\#ifndef\s+(.*)/))&&c[1]&&0<=k.indexOf(c[1].trim())&&(b.data="#if 0"));return m(f)}})},"esri/views/webgl/reservedWordsGLSL3":function(){define(["require","exports"],function(u,f){return"layout centroid smooth case mat2x2 mat2x3 mat2x4 mat3x2 mat3x3 mat3x4 mat4x2 mat4x3 mat4x4 uint uvec2 uvec3 uvec4 samplerCubeShadow sampler2DArray sampler2DArrayShadow isampler2D isampler3D isamplerCube isampler2DArray usampler2D usampler3D usamplerCube usampler2DArray coherent restrict readonly writeonly resource atomic_uint noperspective patch sample subroutine common partition active filter image1D image2D image3D imageCube iimage1D iimage2D iimage3D iimageCube uimage1D uimage2D uimage3D uimageCube image1DArray image2DArray iimage1DArray iimage2DArray uimage1DArray uimage2DArray image1DShadow image2DShadow image1DArrayShadow image2DArrayShadow imageBuffer iimageBuffer uimageBuffer sampler1DArray sampler1DArrayShadow isampler1D isampler1DArray usampler1D usampler1DArray isampler2DRect usampler2DRect samplerBuffer isamplerBuffer usamplerBuffer sampler2DMS isampler2DMS usampler2DMS sampler2DMSArray isampler2DMSArray usampler2DMSArray trunc round roundEven isnan isinf floatBitsToInt floatBitsToUint intBitsToFloat uintBitsToFloat packSnorm2x16 unpackSnorm2x16 packUnorm2x16 unpackUnorm2x16 packHalf2x16 unpackHalf2x16 outerProduct transpose determinant inverse texture textureSize textureProj textureLod textureOffset texelFetch texelFetchOffset textureProjOffset textureLodOffset textureProjLod textureProjLodOffset textureGrad textureGradOffset textureProjGrad textureProjGradOffset".split(" ")})},
"esri/views/webgl/lib/glsl-tokenizer/string":function(){define(["./index"],function(u){"use strict;";return function(f){var e=u(),r=[],r=r.concat(e(f));return r=r.concat(e(null))}})},"esri/views/webgl/lib/glsl-tokenizer/index":function(){define(["./lib/literals","./lib/operators","./lib/builtins"],function(u,f,e){"use strict;";var r="block-comment line-comment preprocessor operator integer float ident builtin keyword whitespace eof integer".split(" ");return function(){function m(a){a.length&&A.push({type:r[v],
data:a,position:J,line:E,column:H})}function d(){z=z.length?[]:z;if("/"===x&&"*"===t)return J=q+b-1,v=0,x=t,b+1;if("/"===x&&"/"===t)return J=q+b-1,v=1,x=t,b+1;if("#"===t)return v=2,J=q+b,b;if(/\s/.test(t))return v=9,J=q+b,b;B=/\d/.test(t);G=/[^\w_]/.test(t);J=q+b;v=B?4:G?3:9999;return b}function g(){if(("\r"===t||"\n"===t)&&"\\"!==x)return m(z.join("")),v=999,b;z.push(t);x=t;return b+1}function k(){if("."===x&&/\d/.test(t))return v=5,b;if("/"===x&&"*"===t)return v=0,b;if("/"===x&&"/"===t)return v=
1,b;if("."===t&&z.length){for(;l(z););v=5;return b}if(";"===t||")"===t||"("===t){if(z.length)for(;l(z););m(t);v=999;return b+1}var a=2===z.length&&"\x3d"!==t;if(/[\w_\d\s]/.test(t)||a){for(;l(z););v=999;return b}z.push(t);x=t;return b+1}function l(a){var b=0,c,d;do{c=f.indexOf(a.slice(0,a.length+b).join(""));d=f[c];if(-1===c){if(0<b--+a.length)continue;d=a.slice(0,1).join("")}m(d);J+=d.length;z=z.slice(d.length);return z.length}while(1)}function c(){if("."===t||/[eE]/.test(t))return z.push(t),v=5,
x=t,b+1;if("x"===t&&1===z.length&&"0"===z[0])return v=11,z.push(t),x=t,b+1;if(/[^\d]/.test(t))return m(z.join("")),v=999,b;z.push(t);x=t;return b+1}function a(){"f"===t&&(z.push(t),x=t,b+=1);if(/[eE]/.test(t)||"-"===t&&/[eE]/.test(x))return z.push(t),x=t,b+1;if(/[^\d]/.test(t))return m(z.join("")),v=999,b;z.push(t);x=t;return b+1}var b=0,q=0,v=999,t,x,z=[],A=[],E=1,H=0,J=0,B=!1,G=!1,F="",M;return function(f){A=[];if(null!==f){f=f.replace?f.replace(/\r\n/g,"\n"):f;b=0;F+=f;for(M=F.length;t=F[b],b<
M;){f=b;switch(v){case 0:"/"===t&&"*"===x?(z.push(t),m(z.join("")),v=999):(z.push(t),x=t);b+=1;break;case 1:b=g();break;case 2:b=g();break;case 3:b=k();break;case 4:b=c();break;case 11:/[^a-fA-F0-9]/.test(t)?(m(z.join("")),v=999):(z.push(t),x=t,b+=1);break;case 5:b=a();break;case 9999:if(/[^\d\w_]/.test(t)){var l=z.join("");v=-1<u.indexOf(l)?8:-1<e.indexOf(l)?7:6;m(z.join(""));v=999}else z.push(t),x=t,b+=1;break;case 9:/[^\s]/g.test(t)?(m(z.join("")),v=999):(z.push(t),x=t,b+=1);break;case 999:b=d()}if(f!==
b)switch(F[f]){case "\n":H=0;++E;break;default:++H}}q+=b;F=F.slice(b);return A}z.length&&m(z.join(""));v=10;m("(eof)");return A}}})},"esri/views/webgl/lib/glsl-tokenizer/lib/literals":function(){define([],function(){return"precision highp mediump lowp attribute const uniform varying break continue do for while if else in out inout float int void bool true false discard return mat2 mat3 mat4 vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadow struct asm class union enum typedef template this packed goto switch default inline noinline volatile public static extern external interface long short double half fixed unsigned input output hvec2 hvec3 hvec4 dvec2 dvec3 dvec4 fvec2 fvec3 fvec4 sampler2DRect sampler3DRect sampler2DRectShadow sizeof cast namespace using".split(" ")})},
"esri/views/webgl/lib/glsl-tokenizer/lib/operators":function(){define([],function(){"use strict;";return"\x3c\x3c\x3d \x3e\x3e\x3d ++ -- \x3c\x3c \x3e\x3e \x3c\x3d \x3e\x3d \x3d\x3d !\x3d \x26\x26 || +\x3d -\x3d *\x3d /\x3d %\x3d \x26\x3d ^^ ^\x3d |\x3d ( ) [ ] . ! ~ * / % + - \x3c \x3e \x26 ^ | ? : \x3d , ; { }".split(" ")})},"esri/views/webgl/lib/glsl-tokenizer/lib/builtins":function(){define([],function(){return"abs acos all any asin atan ceil clamp cos cross dFdx dFdy degrees distance dot equal exp exp2 faceforward floor fract gl_BackColor gl_BackLightModelProduct gl_BackLightProduct gl_BackMaterial gl_BackSecondaryColor gl_ClipPlane gl_ClipVertex gl_Color gl_DepthRange gl_DepthRangeParameters gl_EyePlaneQ gl_EyePlaneR gl_EyePlaneS gl_EyePlaneT gl_Fog gl_FogCoord gl_FogFragCoord gl_FogParameters gl_FragColor gl_FragCoord gl_FragData gl_FragDepth gl_FragDepthEXT gl_FrontColor gl_FrontFacing gl_FrontLightModelProduct gl_FrontLightProduct gl_FrontMaterial gl_FrontSecondaryColor gl_LightModel gl_LightModelParameters gl_LightModelProducts gl_LightProducts gl_LightSource gl_LightSourceParameters gl_MaterialParameters gl_MaxClipPlanes gl_MaxCombinedTextureImageUnits gl_MaxDrawBuffers gl_MaxFragmentUniformComponents gl_MaxLights gl_MaxTextureCoords gl_MaxTextureImageUnits gl_MaxTextureUnits gl_MaxVaryingFloats gl_MaxVertexAttribs gl_MaxVertexTextureImageUnits gl_MaxVertexUniformComponents gl_ModelViewMatrix gl_ModelViewMatrixInverse gl_ModelViewMatrixInverseTranspose gl_ModelViewMatrixTranspose gl_ModelViewProjectionMatrix gl_ModelViewProjectionMatrixInverse gl_ModelViewProjectionMatrixInverseTranspose gl_ModelViewProjectionMatrixTranspose gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 gl_Normal gl_NormalMatrix gl_NormalScale gl_ObjectPlaneQ gl_ObjectPlaneR gl_ObjectPlaneS gl_ObjectPlaneT gl_Point gl_PointCoord gl_PointParameters gl_PointSize gl_Position gl_ProjectionMatrix gl_ProjectionMatrixInverse gl_ProjectionMatrixInverseTranspose gl_ProjectionMatrixTranspose gl_SecondaryColor gl_TexCoord gl_TextureEnvColor gl_TextureMatrix gl_TextureMatrixInverse gl_TextureMatrixInverseTranspose gl_TextureMatrixTranspose gl_Vertex greaterThan greaterThanEqual inversesqrt length lessThan lessThanEqual log log2 matrixCompMult max min mix mod normalize not notEqual pow radians reflect refract sign sin smoothstep sqrt step tan texture2D texture2DLod texture2DProj texture2DProjLod textureCube textureCubeLod texture2DLodEXT texture2DProjLodEXT textureCubeLodEXT texture2DGradEXT texture2DProjGradEXT textureCubeGradEXT".split(" ")})},
"esri/views/webgl/renderState":function(){define(["require","exports","tslib"],function(u,f,e){function r(a){return J.intern(a)}function m(a){return B.intern(a)}function d(a){return G.intern(a)}function g(a){return F.intern(a)}function k(a){return M.intern(a)}function l(a){return R.intern(a)}function c(a){return T.intern(a)}function a(a){return O.intern(a)}function b(a){return"["+a.join(",")+"]"}function q(a){return a?b([a.srcRgb,a.srcAlpha,a.dstRgb,a.dstAlpha,a.opRgb,a.opAlpha,a.color.r,a.color.g,
a.color.b,a.color.a]):null}function v(a){return a?b([a.face,a.mode]):null}function t(a){return a?b([a.factor,a.units]):null}function x(a){return a?b([a.func]):null}function z(a){return a?b([a.function.func,a.function.ref,a.function.mask,a.operation.fail,a.operation.zFail,a.operation.zPass]):null}function A(a){return a?b([a.zNear,a.zFar]):null}function E(a){return a?b([a.r,a.g,a.b,a.a]):null}function H(a){return a?b([a.mask]):null}Object.defineProperty(f,"__esModule",{value:!0});f.simpleBlendingParams=
function(a,b,c,d){void 0===c&&(c=32774);void 0===d&&(d=[0,0,0,0]);return{srcRgb:a,srcAlpha:a,dstRgb:b,dstAlpha:b,opRgb:c,opAlpha:c,color:{r:d[0],g:d[1],b:d[2],a:d[3]}}};f.separateBlendingParams=function(a,b,c,d,e,g,f){void 0===e&&(e=32774);void 0===g&&(g=32774);void 0===f&&(f=[0,0,0,0]);return{srcRgb:a,srcAlpha:b,dstRgb:c,dstAlpha:d,opRgb:e,opAlpha:g,color:{r:f[0],g:f[1],b:f[2],a:f[3]}}};f.backFaceCullingParams={face:1029,mode:2305};f.defaultDepthWriteParams={zNear:0,zFar:1};f.defaultColorWriteParams=
{r:!0,g:!0,b:!0,a:!0};f.makeBlending=r;f.makeCulling=m;f.makePolygonOffset=d;f.makeDepthTest=g;f.makeStencilTest=k;f.makeDepthWrite=l;f.makeColorWrite=c;f.makeStencilWrite=a;f.makePipelineState=function(a){return L.intern(a)};u=function(){function a(a,b){this.makeKey=a;this.makeRef=b;this.interns=new Map}a.prototype.intern=function(a){if(!a)return null;var b=this.makeKey(a),c=this.interns;c.has(b)||c.set(b,this.makeRef(a));return c.get(b)};return a}();var J=new u(q,function(a){return e.__assign({__tag:"Blending"},
a)}),B=new u(v,function(a){return e.__assign({__tag:"Culling"},a)}),G=new u(t,function(a){return e.__assign({__tag:"PolygonOffset"},a)}),F=new u(x,function(a){return e.__assign({__tag:"DepthTest"},a)}),M=new u(z,function(a){return e.__assign({__tag:"StencilTest"},a)}),R=new u(A,function(a){return e.__assign({__tag:"DepthWrite"},a)}),T=new u(E,function(a){return e.__assign({__tag:"ColorWrite"},a)}),O=new u(H,function(a){return e.__assign({__tag:"StencilWrite"},a)}),L=new u(function(a){return a?b([q(a.blending),
v(a.culling),t(a.polygonOffset),x(a.depthTest),z(a.stencilTest),A(a.depthWrite),E(a.colorWrite),H(a.stencilWrite)]):null},function(b){return{blending:r(b.blending),culling:m(b.culling),polygonOffset:d(b.polygonOffset),depthTest:g(b.depthTest),stencilTest:k(b.stencilTest),depthWrite:l(b.depthWrite),colorWrite:c(b.colorWrite),stencilWrite:a(b.stencilWrite)}});u=function(){function a(a){this._stencilWriteInvalid=this._colorWriteInvalid=this._depthWriteInvalid=this._stencilTestInvalid=this._depthTestInvalid=
this._polygonOffsetInvalid=this._cullingInvalid=this._blendingInvalid=this._pipelineInvalid=!0;this._stateSetters=a}a.prototype.setPipeline=function(a){if(this._pipelineInvalid||a!==this._pipeline)this.setBlending(a.blending),this.setCulling(a.culling),this.setPolygonOffset(a.polygonOffset),this.setDepthTest(a.depthTest),this.setStencilTest(a.stencilTest),this.setDepthWrite(a.depthWrite),this.setColorWrite(a.colorWrite),this.setStencilWrite(a.stencilWrite),this._pipeline=a;this._pipelineInvalid=!1};
a.prototype.invalidateBlending=function(){this._pipelineInvalid=this._blendingInvalid=!0};a.prototype.invalidateCulling=function(){this._pipelineInvalid=this._cullingInvalid=!0};a.prototype.invalidatePolygonOffset=function(){this._pipelineInvalid=this._polygonOffsetInvalid=!0};a.prototype.invalidateDepthTest=function(){this._pipelineInvalid=this._depthTestInvalid=!0};a.prototype.invalidateStencilTest=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};a.prototype.invalidateDepthWrite=function(){this._pipelineInvalid=
this._depthWriteInvalid=!0};a.prototype.invalidateColorWrite=function(){this._pipelineInvalid=this._colorWriteInvalid=!0};a.prototype.invalidateStencilWrite=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};a.prototype.setBlending=function(a){this._blending=this.setSubState(a,this._blending,this._blendingInvalid,this._stateSetters.setBlending);this._blendingInvalid=!1};a.prototype.setCulling=function(a){this._culling=this.setSubState(a,this._culling,this._cullingInvalid,this._stateSetters.setCulling);
this._cullingInvalid=!1};a.prototype.setPolygonOffset=function(a){this._polygonOffset=this.setSubState(a,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset);this._polygonOffsetInvalid=!1};a.prototype.setDepthTest=function(a){this._depthTest=this.setSubState(a,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest);this._depthTestInvalid=!1};a.prototype.setStencilTest=function(a){this._stencilTest=this.setSubState(a,this._stencilTest,this._stencilTestInvalid,
this._stateSetters.setStencilTest);this._stencilTestInvalid=!1};a.prototype.setDepthWrite=function(a){this._depthWrite=this.setSubState(a,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite);this._depthWriteInvalid=!1};a.prototype.setColorWrite=function(a){this._colorWrite=this.setSubState(a,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite);this._colorWriteInvalid=!1};a.prototype.setStencilWrite=function(a){this._stencilWrite=this.setSubState(a,this._stencilWrite,
this._stencilWriteInvalid,this._stateSetters.setStencilWrite);this._stencilTestInvalid=!1};a.prototype.setSubState=function(a,b,c,d){if(c||a!==b)d(a),this._pipelineInvalid=!0;return a};return a}();f.StateTracker=u})},"esri/views/3d/webgl-engine/materials/renderers/Instance":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/mat4","../../../../../core/libs/gl-matrix-2/mat4f64"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});u=function(){return function(f,
d,g,k,l,c){this.from=f;this.to=d;this.isVisible=g;this.hasHighlights=k;this.hasOccludees=l;this.transformation=c;null!=c&&(this.transformationNormal=r.mat4f64.clone(c),e.mat4.invert(this.transformationNormal,this.transformationNormal),e.mat4.transpose(this.transformationNormal,this.transformationNormal))}}();f.Instance=u;f.sortInstancesAccordingToRange=function(e){return e.sort(function(d,e){return d.from===e.from?d.to>e.to?1:d.to<e.to?-1:0:d.from>e.from?1:d.from<e.from?-1:0})};f.addOrMerge=function(e,
d){if(0===e.length)e.push({first:d.from,count:d.to-d.from});else{var g=e[e.length-1],f;f=g.first+g.count>=d.from?!0:!1;f?g.count=d.from-g.first+d.to-d.from:e.push({first:d.from,count:d.to-d.from})}}})},"esri/views/3d/webgl-engine/shaders/RibbonLineTechnique":function(){define("require exports tslib ../../../../core/maybe ../../../../core/maybe ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/Transform.glsl ../core/shaderLibrary/output/OutputHighlight.glsl ../core/shaderLibrary/shading/VisualVariables.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/StencilUtils ./RibbonLine.glsl ../../../webgl/Program ../../../webgl/renderState @dojo/framework/shim/Promise".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x){Object.defineProperty(f,"__esModule",{value:!0});f.RibbonVertexAttributeConstants={POSITION:"position",SUBDIVISIONFACTOR:"subdivisionFactor",UV0:"uv0",AUXPOS1:"auxpos1",AUXPOS2:"auxpos2",SUBDIVISIONS:"subdivisions",COLOR:"color",COLORFEATUREATTRIBUTE:"colorFeatureAttribute",SIZE:"size",SIZEFEATUREATTRIBUTE:"sizeFeatureAttribute",OPACITYFEATUREATTRIBUTE:"opacityFeatureAttribute"};f.ribbonVertexAttributeLocations={position:0,subdivisionFactor:1,uv0:2,auxpos1:3,
auxpos2:4,size:6,sizeFeatureAttribute:6,color:5,colorFeatureAttribute:5,opacityFeatureAttribute:7};a=function(a){function b(b,c){c=a.call(this,b,c)||this;c.stipplePattern=null;c.stippleTextureBind=null;c.stippleTextureRepository=b.stippleTextureRepository;return c}e.__extends(b,a);b.prototype.initializeProgram=function(a){var c=b.shader.get(),d=this.configuration,c=c.build({output:d.output,slicePlaneEnabled:d.slicePlaneEnabled,sliceHighlightDisabled:d.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1,
stippleEnabled:d.stippleEnabled,stippleOffColorEnabled:d.stippleOffColorEnabled,stippleUVMaxEnabled:d.stippleIntegerRepeatsEnabled,stippleIntegerRepeatsEnabled:d.stippleIntegerRepeatsEnabled,roundCaps:d.roundCaps,roundJoins:d.roundJoins,vvColor:d.vvColor,vvSize:d.vvSize,vvInstancingEnabled:!0,vvOpacity:d.vvOpacity,falloffEnabled:d.falloffEnabled,innerColorEnabled:d.innerColorEnabled});return new t(a.rctx,c.generateSource("vertex"),c.generateSource("fragment"),f.ribbonVertexAttributeLocations)};b.prototype.dispose=
function(){a.prototype.dispose.call(this);this.stippleTextureRepository.release(this.stipplePattern);this.stippleTextureBind=this.stipplePattern=null};b.prototype.bindPass=function(a,b,c){4===this.configuration.output&&k.OutputHighlight.bindOutputHighlight(a,this.program,c);this.program.setUniform1f("intrinsicWidth",b.width);this.program.setUniform4fv("intrinsicColor",b.color);this.program.setUniform1f("miterLimit","miter"!==b.join?0:b.miterLimit);this.program.setUniform1f("nearPlane",c.nearFar[0]);
this.program.setUniform1f("pixelRatio",c.pixelRatio);this.program.setUniform2fv("screenSize",[c.viewport[2],c.viewport[3]]);l.VisualVariables.bindUniformsWithOpacity(this.program,b);if(this.stipplePattern!==b.stipplePattern){var d=b.stipplePattern;this.stippleTextureBind=this.stippleTextureRepository.swap(this.stipplePattern,d);this.stipplePattern=d}this.configuration.stippleEnabled&&(a=m.isSome(this.stippleTextureBind)?this.stippleTextureBind(a,0)*c.pixelRatio:1,this.program.setUniform1i("stipplePatternTexture",
0),this.program.setUniform1f("stipplePatternPixelSizeInv",1/a),this.configuration.stippleOffColorEnabled&&(a=r.unwrap(b.stippleOffColor),this.program.setUniform4f("stippleOffColor",a[0],a[1],a[2],3<a.length?a[3]:1)));this.configuration.falloffEnabled&&this.program.setUniform1f("falloff",b.falloff);this.configuration.innerColorEnabled&&(this.program.setUniform4fv("innerColor",r.unwrapOr(b.innerColor,b.color)),this.program.setUniform1f("innerWidth",b.innerWidth*c.pixelRatio))};b.prototype.bindDraw=
function(a){g.Transform.bindUniforms(this.program,a);d.Slice.bindUniformsWithOrigin(this.program,this.configuration,a)};b.prototype.initializePipeline=function(){var a=this.configuration,b=x.separateBlendingParams(770,1,771,771),c=a.polygonOffset&&z;a.occluder&&(this._occluderPipelineTransparent=x.makePipelineState({blending:b,polygonOffset:c,depthTest:q.depthCompareAlways,depthWrite:null,colorWrite:x.defaultColorWriteParams,stencilWrite:null,stencilTest:q.stencilToolTransparentOccluderParams}),this._occluderPipelineOpaque=
x.makePipelineState({polygonOffset:c,depthTest:q.depthCompareAlways,depthWrite:null,colorWrite:x.defaultColorWriteParams,stencilWrite:q.stencilWriteMaskOff,stencilTest:q.stencilToolMaskOccluderParams}),this._occluderPipelineMaskWrite=x.makePipelineState({polygonOffset:c,depthTest:q.depthCompareLess,depthWrite:null,colorWrite:null,stencilWrite:q.stencilWriteMaskOn,stencilTest:q.stencilToolMaskBaseParams}));if(0===a.output){var d=function(d){return x.makePipelineState({blending:b,polygonOffset:c,depthTest:q.depthCompareLess,
depthWrite:!a.transparent&&a.writeDepth&&x.defaultDepthWriteParams,colorWrite:x.defaultColorWriteParams,stencilWrite:a.sceneHasOcludees?q.stencilWriteMaskOn:null,stencilTest:a.sceneHasOcludees?d?q.stencilToolMaskBaseParams:a.sceneHasOcludees?q.stencilBaseAllZerosParams:null:null})};this._occludeePipeline=d(!0);return d(!1)}return x.makePipelineState({polygonOffset:c,depthTest:q.depthCompareLess,depthWrite:!a.transparent&&a.writeDepth&&x.defaultDepthWriteParams,colorWrite:x.defaultColorWriteParams})};
Object.defineProperty(b.prototype,"occluderPipelineTransparent",{get:function(){return this._occluderPipelineTransparent},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"occluderPipelineOpaque",{get:function(){return this._occluderPipelineOpaque},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"occludeePipeline",{get:function(){return this._occludeePipeline},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"occluderPipelineMaskWrite",{get:function(){return this._occluderPipelineMaskWrite},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"primitiveType",{get:function(){return 5},enumerable:!0,configurable:!0});b.shader=new c.ReloadableShaderModule(v,function(){return new Promise(function(a,b){u(["./RibbonLine.glsl"],a,b)})});return b}(a.ShaderTechnique);f.RibbonLineTechnique=a;var z={factor:0,units:-4};a=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b.output=0;b.occluder=!1;b.slicePlaneEnabled=!1;b.sliceHighlightDisabled=!1;b.vertexColors=!1;
b.transparent=!1;b.polygonOffset=!1;b.writeDepth=!1;b.stippleEnabled=!1;b.stippleOffColorEnabled=!1;b.stippleIntegerRepeatsEnabled=!1;b.roundCaps=!1;b.roundJoins=!1;b.vvSize=!1;b.vvColor=!1;b.vvOpacity=!1;b.falloffEnabled=!1;b.innerColorEnabled=!1;b.sceneHasOcludees=!1;return b}e.__extends(c,a);e.__decorate([b.parameter({count:7})],c.prototype,"output",void 0);e.__decorate([b.parameter()],c.prototype,"occluder",void 0);e.__decorate([b.parameter()],c.prototype,"slicePlaneEnabled",void 0);e.__decorate([b.parameter()],
c.prototype,"sliceHighlightDisabled",void 0);e.__decorate([b.parameter()],c.prototype,"vertexColors",void 0);e.__decorate([b.parameter()],c.prototype,"transparent",void 0);e.__decorate([b.parameter()],c.prototype,"polygonOffset",void 0);e.__decorate([b.parameter()],c.prototype,"writeDepth",void 0);e.__decorate([b.parameter()],c.prototype,"stippleEnabled",void 0);e.__decorate([b.parameter()],c.prototype,"stippleOffColorEnabled",void 0);e.__decorate([b.parameter()],c.prototype,"stippleIntegerRepeatsEnabled",
void 0);e.__decorate([b.parameter()],c.prototype,"roundCaps",void 0);e.__decorate([b.parameter()],c.prototype,"roundJoins",void 0);e.__decorate([b.parameter()],c.prototype,"vvSize",void 0);e.__decorate([b.parameter()],c.prototype,"vvColor",void 0);e.__decorate([b.parameter()],c.prototype,"vvOpacity",void 0);e.__decorate([b.parameter()],c.prototype,"falloffEnabled",void 0);e.__decorate([b.parameter()],c.prototype,"innerColorEnabled",void 0);e.__decorate([b.parameter()],c.prototype,"sceneHasOcludees",
void 0);return c}(b.ShaderTechniqueConfiguration);f.RibbonLineTechniqueConfiguration=a})},"esri/views/3d/webgl-engine/core/shaderLibrary/output/OutputHighlight.glsl":function(){define(["require","exports","tslib","../../shaderModules/interfaces"],function(u,f,e,r){function m(g){g.fragment.uniforms.add("depthTex","sampler2D");g.fragment.uniforms.add("highlightViewportPixelSz","vec4");g.fragment.code.add(r.glsl(d||(d=e.__makeTemplateObject(["\n    void outputHighlight() {\n      vec4 fragCoord \x3d gl_FragCoord;\n\n      float sceneDepth \x3d texture2D(depthTex, (fragCoord.xy - highlightViewportPixelSz.xy) * highlightViewportPixelSz.zw).r;\n      if (fragCoord.z \x3e sceneDepth + 5e-7) {\n        gl_FragColor \x3d vec4(1.0, 1.0, 0.0, 1.0);\n      }\n      else {\n        gl_FragColor \x3d vec4(1.0, 0.0, 1.0, 1.0);\n      }\n    }\n  "],
["\n    void outputHighlight() {\n      vec4 fragCoord \x3d gl_FragCoord;\n\n      float sceneDepth \x3d texture2D(depthTex, (fragCoord.xy - highlightViewportPixelSz.xy) * highlightViewportPixelSz.zw).r;\n      if (fragCoord.z \x3e sceneDepth + 5e-7) {\n        gl_FragColor \x3d vec4(1.0, 1.0, 0.0, 1.0);\n      }\n      else {\n        gl_FragColor \x3d vec4(1.0, 0.0, 1.0, 1.0);\n      }\n    }\n  "]))))}Object.defineProperty(f,"__esModule",{value:!0});f.OutputHighlight=m;(function(d){d.bindOutputHighlight=
function(d,e,c){d.bindTexture(c.highlightDepthTexture,5);e.setUniform1i("depthTex",5);e.setUniform4f("highlightViewportPixelSz",0,0,1/c.viewport[2],1/c.viewport[3])}})(m=f.OutputHighlight||(f.OutputHighlight={}));var d})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl":function(){define(["require","exports","tslib","../../shaderModules/interfaces"],function(u,f,e,r){function m(f,m){m.vvInstancingEnabled&&(m.vvSize||m.vvColor)&&f.attributes.add("instanceFeatureAttribute",
"vec4");m.vvSize?(f.vertex.uniforms.add("vvSizeMinSize","vec3"),f.vertex.uniforms.add("vvSizeMaxSize","vec3"),f.vertex.uniforms.add("vvSizeOffset","vec3"),f.vertex.uniforms.add("vvSizeFactor","vec3"),f.vertex.uniforms.add("vvSymbolRotationMatrix","mat3"),f.vertex.uniforms.add("vvSymbolAnchor","vec3"),f.vertex.code.add(r.glsl(d||(d=e.__makeTemplateObject(["\n      vec3 vvScale(vec4 _featureAttribute) {\n        return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);\n      }\n\n      vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {\n        return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);\n      }\n    "],
["\n      vec3 vvScale(vec4 _featureAttribute) {\n        return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);\n      }\n\n      vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {\n        return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);\n      }\n    "])))),f.vertex.code.add(r.glsl(k||(k=e.__makeTemplateObject(["\n      const float eps \x3d 1.192092896e-07;\n      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {\n        vec3 vvScale \x3d clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);\n        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);\n      }\n\n      ",
"\n    "],["\n      const float eps \x3d 1.192092896e-07;\n      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {\n        vec3 vvScale \x3d clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);\n        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);\n      }\n\n      ","\n    "])),m.vvInstancingEnabled?r.glsl(g||(g=e.__makeTemplateObject(["\n      vec4 vvLocalNormal(vec3 _normal) {\n        return vvTransformNormal(_normal, instanceFeatureAttribute);\n      }\n\n      vec4 localPosition() {\n        return vvTransformPosition(position, instanceFeatureAttribute);\n      }"],
["\n      vec4 vvLocalNormal(vec3 _normal) {\n        return vvTransformNormal(_normal, instanceFeatureAttribute);\n      }\n\n      vec4 localPosition() {\n        return vvTransformPosition(position, instanceFeatureAttribute);\n      }"]))):""))):f.vertex.code.add(r.glsl(l||(l=e.__makeTemplateObject(["\n      vec4 localPosition() { return vec4(position, 1.0); }\n\n      vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }\n    "],["\n      vec4 localPosition() { return vec4(position, 1.0); }\n\n      vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }\n    "]))));
m.vvColor?(f.vertex.defines.addInt("VV_COLOR_N",8),f.vertex.code.add(r.glsl(a||(a=e.__makeTemplateObject(["\n      uniform float vvColorValues[VV_COLOR_N];\n      uniform vec4 vvColorColors[VV_COLOR_N];\n\n      vec4 vvGetColor(vec4 featureAttribute, float values[VV_COLOR_N], vec4 colors[VV_COLOR_N]) {\n        float value \x3d featureAttribute.y;\n        if (value \x3c\x3d values[0]) {\n          return colors[0];\n        }\n\n        for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n          if (values[i] \x3e\x3d value) {\n            float f \x3d (value - values[i-1]) / (values[i] - values[i-1]);\n            return mix(colors[i-1], colors[i], f);\n          }\n        }\n        return colors[VV_COLOR_N - 1];\n      }\n\n      ",
"\n    "],["\n      uniform float vvColorValues[VV_COLOR_N];\n      uniform vec4 vvColorColors[VV_COLOR_N];\n\n      vec4 vvGetColor(vec4 featureAttribute, float values[VV_COLOR_N], vec4 colors[VV_COLOR_N]) {\n        float value \x3d featureAttribute.y;\n        if (value \x3c\x3d values[0]) {\n          return colors[0];\n        }\n\n        for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n          if (values[i] \x3e\x3d value) {\n            float f \x3d (value - values[i-1]) / (values[i] - values[i-1]);\n            return mix(colors[i-1], colors[i], f);\n          }\n        }\n        return colors[VV_COLOR_N - 1];\n      }\n\n      ",
"\n    "])),m.vvInstancingEnabled?r.glsl(c||(c=e.__makeTemplateObject(["\n      vec4 vvColor() {\n        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);\n      }"],["\n      vec4 vvColor() {\n        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);\n      }"]))):""))):f.vertex.code.add(r.glsl(b||(b=e.__makeTemplateObject(["\n      vec4 vvColor() { return vec4(1.0); }\n    "],["\n      vec4 vvColor() { return vec4(1.0); }\n    "]))))}Object.defineProperty(f,
"__esModule",{value:!0});f.VisualVariables=m;(function(a){function b(a,b){b.vvSizeEnabled&&(a.setUniform3fv("vvSizeMinSize",b.vvSizeMinSize),a.setUniform3fv("vvSizeMaxSize",b.vvSizeMaxSize),a.setUniform3fv("vvSizeOffset",b.vvSizeOffset),a.setUniform3fv("vvSizeFactor",b.vvSizeFactor));b.vvColorEnabled&&(a.setUniform1fv("vvColorValues",b.vvColorValues),a.setUniform4fv("vvColorColors",b.vvColorColors))}a.bindUniforms=b;a.bindUniformsWithOpacity=function(a,c){b(a,c);c.vvOpacityEnabled&&(a.setUniform1fv("vvOpacityValues",
c.vvOpacityValues),a.setUniform1fv("vvOpacityOpacities",c.vvOpacityOpacities))};a.bindUniformsForSymbols=function(a,c){b(a,c);c.vvSizeEnabled&&(a.setUniform3fv("vvSymbolAnchor",c.vvSymbolAnchor),a.setUniformMatrix3fv("vvSymbolRotationMatrix",c.vvSymbolRotationMatrix))}})(m=f.VisualVariables||(f.VisualVariables={}));var d,g,k,l,c,a,b})},"esri/views/3d/webgl-engine/lib/StencilUtils":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});f.depthCompareLess=
{func:513};f.depthCompareAlways={func:519};f.stencilWriteMaskOn={mask:255};f.stencilWriteMaskOff={mask:0};f.renderWhenBitIsNotSet=function(e){return{function:{func:517,ref:e,mask:e},operation:{fail:7680,zFail:7680,zPass:7680}}};f.replaceBitWhenDepthTestPasses=function(e){return{function:{func:519,ref:e,mask:e},operation:{fail:7680,zFail:7680,zPass:7681}}};f.stencilBaseAllZerosParams={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:0}};f.stencilToolMaskBaseParams={function:{func:519,
ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7681}};f.stencilToolMaskOccluderParams={function:{func:514,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}};f.stencilToolTransparentOccluderParams={function:{func:517,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}}})},"esri/views/3d/webgl-engine/shaders/RibbonLine.glsl":function(){define("require exports tslib ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/attributes/RibbonVertexPosition.glsl ../core/shaderLibrary/shading/LineStipple.glsl ../core/shaderLibrary/shading/PiUtils.glsl ../core/shaderModules/interfaces ../core/shaderModules/ShaderBuilder".split(" "),
function(u,f,e,r,m,d,g,k,l){Object.defineProperty(f,"__esModule",{value:!0});f.build=function(f){var u=new l.ShaderBuilder;u.extensions.add("GL_OES_standard_derivatives");u.include(g.PiUtils);u.include(m.RibbonVertexPosition,f);u.include(d.LineStipple,f);u.vertex.uniforms.add("proj","mat4").add("view","mat4").add("nearPlane","float").add("pixelRatio","float").add("miterLimit","float").add("screenSize","vec2");u.attributes.add("position","vec3");u.attributes.add("subdivisionFactor","float");u.attributes.add("uv0",
"vec2");u.attributes.add("auxpos1","vec3");u.attributes.add("auxpos2","vec3");u.varyings.add("vColor","vec4");u.varyings.add("vpos","vec3");var Z=f.falloffEnabled,ea=f.innerColorEnabled;ea&&u.varyings.add("vLineDistance","float");Z&&u.varyings.add("vLineDistanceNorm","float");f.falloffEnabled&&u.fragment.uniforms.add("falloff","float");f.innerColorEnabled&&(u.fragment.uniforms.add("innerColor","vec4"),u.fragment.uniforms.add("innerWidth","float"));u.vertex.code.add(k.glsl(c||(c=e.__makeTemplateObject(["\n\t\t#define PERPENDICULAR(v) vec2(v.y, -v.x);\n\t\t#define ISOUTSIDE (left.x * right.y - left.y * right.x)*uv0.y \x3e 0.0\n\n\t\tfloat interp(float ncp, vec4 a, vec4 b) {\n\t\t\treturn (-ncp - a.z) / (b.z - a.z);\n\t\t}\n\n\t\tvec2 rotate(vec2 v, float a) {\n\t\t\tfloat s \x3d sin(a);\n\t\t\tfloat c \x3d cos(a);\n\t\t\tmat2 m \x3d mat2(c, -s, s, c);\n\t\t\treturn m * v;\n\t\t}\n"],
["\n\t\t#define PERPENDICULAR(v) vec2(v.y, -v.x);\n\t\t#define ISOUTSIDE (left.x * right.y - left.y * right.x)*uv0.y \x3e 0.0\n\n\t\tfloat interp(float ncp, vec4 a, vec4 b) {\n\t\t\treturn (-ncp - a.z) / (b.z - a.z);\n\t\t}\n\n\t\tvec2 rotate(vec2 v, float a) {\n\t\t\tfloat s \x3d sin(a);\n\t\t\tfloat c \x3d cos(a);\n\t\t\tmat2 m \x3d mat2(c, -s, s, c);\n\t\t\treturn m * v;\n\t\t}\n"]))));u.vertex.code.add(k.glsl(a||(a=e.__makeTemplateObject(["\n    vec4 projectAndScale(vec4 pos) {\n      vec4 posNdc \x3d proj * pos;\n\n      // Note that posNdc is in -1:1, scaling by screenSize converts this to a coordinate system\n      // that is twice scaled (going from -size:size).\n      posNdc.xy *\x3d screenSize / posNdc.w;\n      return posNdc;\n    }\n"],
["\n    vec4 projectAndScale(vec4 pos) {\n      vec4 posNdc \x3d proj * pos;\n\n      // Note that posNdc is in -1:1, scaling by screenSize converts this to a coordinate system\n      // that is twice scaled (going from -size:size).\n      posNdc.xy *\x3d screenSize / posNdc.w;\n      return posNdc;\n    }\n"]))));u.vertex.code.add(k.glsl(b||(b=e.__makeTemplateObject(["\n    void clipAndTransform(inout vec4 pos, inout vec4 prev, inout vec4 next, in bool isStartVertex) {\n      float vnp \x3d nearPlane*0.99;\n\n      //current pos behind ncp --\x3e we need to clip\n      if(pos.z \x3e -nearPlane) {\n        if (!isStartVertex) {\n          //previous in front of ncp\n          if(prev.z \x3c -nearPlane) {\n            pos \x3d mix(prev, pos, interp(vnp, prev, pos));\n            next \x3d pos;\n          } else {\n            pos \x3d vec4(0.0, 0.0, 0.0, 1.0);\n          }\n        }\n        //next in front of ncp\n        if(isStartVertex) {\n          if(next.z \x3c -nearPlane) {\n            pos \x3d mix(pos, next, interp(vnp, pos, next));\n            prev \x3d pos;\n          } else {\n            pos \x3d vec4(0.0, 0.0, 0.0, 1.0);\n          }\n        }\n      } else {\n        //current position visible\n        //previous behind ncp\n        if (prev.z \x3e -nearPlane) {\n          prev \x3d mix(pos, prev, interp(vnp, pos, prev));\n        }\n        //next behind ncp\n        if (next.z \x3e -nearPlane) {\n          next \x3d mix(next, pos, interp(vnp, next, pos));\n        }\n      }\n\n      pos \x3d projectAndScale(pos);\n      next \x3d projectAndScale(next);\n      prev \x3d projectAndScale(prev);\n    }\n"],
["\n    void clipAndTransform(inout vec4 pos, inout vec4 prev, inout vec4 next, in bool isStartVertex) {\n      float vnp \x3d nearPlane*0.99;\n\n      //current pos behind ncp --\x3e we need to clip\n      if(pos.z \x3e -nearPlane) {\n        if (!isStartVertex) {\n          //previous in front of ncp\n          if(prev.z \x3c -nearPlane) {\n            pos \x3d mix(prev, pos, interp(vnp, prev, pos));\n            next \x3d pos;\n          } else {\n            pos \x3d vec4(0.0, 0.0, 0.0, 1.0);\n          }\n        }\n        //next in front of ncp\n        if(isStartVertex) {\n          if(next.z \x3c -nearPlane) {\n            pos \x3d mix(pos, next, interp(vnp, pos, next));\n            prev \x3d pos;\n          } else {\n            pos \x3d vec4(0.0, 0.0, 0.0, 1.0);\n          }\n        }\n      } else {\n        //current position visible\n        //previous behind ncp\n        if (prev.z \x3e -nearPlane) {\n          prev \x3d mix(pos, prev, interp(vnp, pos, prev));\n        }\n        //next behind ncp\n        if (next.z \x3e -nearPlane) {\n          next \x3d mix(next, pos, interp(vnp, next, pos));\n        }\n      }\n\n      pos \x3d projectAndScale(pos);\n      next \x3d projectAndScale(next);\n      prev \x3d projectAndScale(prev);\n    }\n"]))));
u.vertex.code.add(k.glsl(q||(q=e.__makeTemplateObject(["\n  void main(void) {\n    float coverage \x3d 1.0;\n    vpos \x3d position;\n\n    // Check for special value of uv0.y which is used by the Renderer when graphics\n    // are removed before the VBO is recompacted. If this is the case, then we just\n    // project outside of clip space.\n    if (uv0.y \x3d\x3d 0.0) {\n      // Project out of clip space\n      gl_Position \x3d vec4(1e038, 1e038, 1e038, 1.0);\n    }\n    else {\n      bool isStartVertex \x3d abs(abs(uv0.y)-3.0) \x3d\x3d 1.0;\n      bool isJoin \x3d abs(uv0.y)-3.0 \x3c 0.0;\n\n      float lineWidth \x3d getSize() * pixelRatio;\n\n      // convert sub-pixel coverage to alpha\n      if (lineWidth \x3c 1.0) {\n        coverage \x3d lineWidth;\n        lineWidth \x3d 1.0;\n      }else{\n        // Ribbon lines cannot properly render non-integer sizes. Round width to integer size if\n        // larger than one for better quality. Note that we do render \x3c 1 pixels more or less correctly\n        // so we only really care to round anything larger than 1.\n        lineWidth \x3d floor(lineWidth + 0.5);\n      }\n\n      vec4 pos  \x3d view * vec4(position.xyz, 1.0);\n      vec4 prev \x3d view * vec4(auxpos1.xyz, 1.0);\n      vec4 next \x3d view * vec4(auxpos2.xyz, 1.0);\n\n      clipAndTransform(pos, prev, next, isStartVertex);\n\n      vec2 left \x3d (pos.xy - prev.xy);\n      vec2 right \x3d (next.xy - pos.xy);\n\n      float leftLen \x3d length(left);\n      float rightLen \x3d length(right);\n  "],
["\n  void main(void) {\n    float coverage \x3d 1.0;\n    vpos \x3d position;\n\n    // Check for special value of uv0.y which is used by the Renderer when graphics\n    // are removed before the VBO is recompacted. If this is the case, then we just\n    // project outside of clip space.\n    if (uv0.y \x3d\x3d 0.0) {\n      // Project out of clip space\n      gl_Position \x3d vec4(1e038, 1e038, 1e038, 1.0);\n    }\n    else {\n      bool isStartVertex \x3d abs(abs(uv0.y)-3.0) \x3d\x3d 1.0;\n      bool isJoin \x3d abs(uv0.y)-3.0 \x3c 0.0;\n\n      float lineWidth \x3d getSize() * pixelRatio;\n\n      // convert sub-pixel coverage to alpha\n      if (lineWidth \x3c 1.0) {\n        coverage \x3d lineWidth;\n        lineWidth \x3d 1.0;\n      }else{\n        // Ribbon lines cannot properly render non-integer sizes. Round width to integer size if\n        // larger than one for better quality. Note that we do render \x3c 1 pixels more or less correctly\n        // so we only really care to round anything larger than 1.\n        lineWidth \x3d floor(lineWidth + 0.5);\n      }\n\n      vec4 pos  \x3d view * vec4(position.xyz, 1.0);\n      vec4 prev \x3d view * vec4(auxpos1.xyz, 1.0);\n      vec4 next \x3d view * vec4(auxpos2.xyz, 1.0);\n\n      clipAndTransform(pos, prev, next, isStartVertex);\n\n      vec2 left \x3d (pos.xy - prev.xy);\n      vec2 right \x3d (next.xy - pos.xy);\n\n      float leftLen \x3d length(left);\n      float rightLen \x3d length(right);\n  "]))));
f.stippleEnabled&&u.vertex.code.add(k.glsl(v||(v=e.__makeTemplateObject(["\n      // uv0.x is either 0 or 1, depending on whether this is considered the start of a line segment\n      // or the end. If start, then use pos-\x3enext, otherwise use prev-\x3epos to define the line segment\n      // vector\n      vec4 stippleSegmentInfo \x3d mix(vec4(pos.xy, right), vec4(prev.xy, left), uv0.x);\n      vec2 stippleSegmentOrigin \x3d stippleSegmentInfo.xy;\n\n      // Scale s.t. it's in units of stipple pattern size.\n      vec2 stippleSegmentDirection \x3d stippleSegmentInfo.zw;\n    "],
["\n      // uv0.x is either 0 or 1, depending on whether this is considered the start of a line segment\n      // or the end. If start, then use pos-\x3enext, otherwise use prev-\x3epos to define the line segment\n      // vector\n      vec4 stippleSegmentInfo \x3d mix(vec4(pos.xy, right), vec4(prev.xy, left), uv0.x);\n      vec2 stippleSegmentOrigin \x3d stippleSegmentInfo.xy;\n\n      // Scale s.t. it's in units of stipple pattern size.\n      vec2 stippleSegmentDirection \x3d stippleSegmentInfo.zw;\n    "]))));
u.vertex.code.add(k.glsl(t||(t=e.__makeTemplateObject(['\n    left \x3d (leftLen \x3e 0.001) ? left/leftLen : vec2(0.0, 0.0);\n    right \x3d (rightLen \x3e 0.001) ? right/rightLen : vec2(0.0, 0.0);\n\n    vec2 capDisplacementDir \x3d vec2(0, 0);\n    vec2 joinDisplacementDir \x3d vec2(0, 0);\n    float displacementLen \x3d lineWidth;\n\n    if (isJoin) {\n\n      // JOIN handling ---------------------------------------------------\n      // determine if vertex is on the "outside or "inside" of the join\n      bool isOutside \x3d ISOUTSIDE;\n\n      // compute miter join position first\n      joinDisplacementDir \x3d normalize(left + right);\n      joinDisplacementDir \x3d PERPENDICULAR(joinDisplacementDir);\n\n      // compute miter stretch\n      if (leftLen \x3e 0.001 \x26\x26 rightLen \x3e 0.001) {\n        float nDotSeg \x3d dot(joinDisplacementDir, left);\n        displacementLen /\x3d length(nDotSeg * left - joinDisplacementDir);\n\n        // limit displacement of inner vertices\n        if (!isOutside) {\n          displacementLen \x3d min(displacementLen, min(leftLen, rightLen)/abs(nDotSeg));\n        }\n      }\n\n      if (isOutside \x26\x26 (displacementLen \x3e miterLimit * lineWidth)) {\n    '],
['\n    left \x3d (leftLen \x3e 0.001) ? left/leftLen : vec2(0.0, 0.0);\n    right \x3d (rightLen \x3e 0.001) ? right/rightLen : vec2(0.0, 0.0);\n\n    vec2 capDisplacementDir \x3d vec2(0, 0);\n    vec2 joinDisplacementDir \x3d vec2(0, 0);\n    float displacementLen \x3d lineWidth;\n\n    if (isJoin) {\n\n      // JOIN handling ---------------------------------------------------\n      // determine if vertex is on the "outside or "inside" of the join\n      bool isOutside \x3d ISOUTSIDE;\n\n      // compute miter join position first\n      joinDisplacementDir \x3d normalize(left + right);\n      joinDisplacementDir \x3d PERPENDICULAR(joinDisplacementDir);\n\n      // compute miter stretch\n      if (leftLen \x3e 0.001 \x26\x26 rightLen \x3e 0.001) {\n        float nDotSeg \x3d dot(joinDisplacementDir, left);\n        displacementLen /\x3d length(nDotSeg * left - joinDisplacementDir);\n\n        // limit displacement of inner vertices\n        if (!isOutside) {\n          displacementLen \x3d min(displacementLen, min(leftLen, rightLen)/abs(nDotSeg));\n        }\n      }\n\n      if (isOutside \x26\x26 (displacementLen \x3e miterLimit * lineWidth)) {\n    ']))));
f.roundJoins?u.vertex.code.add(k.glsl(x||(x=e.__makeTemplateObject(["\n        vec2 startDir;\n        vec2 endDir;\n\n        if (leftLen \x3c 0.001) {\n          startDir \x3d right;\n        }\n        else{\n          startDir \x3d left;\n        }\n        startDir \x3d normalize(startDir);\n        startDir \x3d PERPENDICULAR(startDir);\n\n        if (rightLen \x3c 0.001) {\n          endDir \x3d left;\n        }\n        else{\n          endDir \x3d right;\n        }\n        endDir \x3d normalize(endDir);\n        endDir \x3d PERPENDICULAR(endDir);\n\n        float rotationAngle \x3d acos(clamp(dot(startDir, endDir), -1.0, 1.0));\n        joinDisplacementDir \x3d rotate(startDir, -sign(uv0.y) * subdivisionFactor * rotationAngle);\n      "],
["\n        vec2 startDir;\n        vec2 endDir;\n\n        if (leftLen \x3c 0.001) {\n          startDir \x3d right;\n        }\n        else{\n          startDir \x3d left;\n        }\n        startDir \x3d normalize(startDir);\n        startDir \x3d PERPENDICULAR(startDir);\n\n        if (rightLen \x3c 0.001) {\n          endDir \x3d left;\n        }\n        else{\n          endDir \x3d right;\n        }\n        endDir \x3d normalize(endDir);\n        endDir \x3d PERPENDICULAR(endDir);\n\n        float rotationAngle \x3d acos(clamp(dot(startDir, endDir), -1.0, 1.0));\n        joinDisplacementDir \x3d rotate(startDir, -sign(uv0.y) * subdivisionFactor * rotationAngle);\n      "])))):
u.vertex.code.add(k.glsl(z||(z=e.__makeTemplateObject(["\n        // convert to bevel join if miterLimit is exceeded\n        if (leftLen \x3c 0.001) {\n          joinDisplacementDir \x3d right;\n        }\n        else if (rightLen \x3c 0.001) {\n          joinDisplacementDir \x3d left;\n        }\n        else {\n          joinDisplacementDir \x3d isStartVertex ? right : left;\n        }\n        joinDisplacementDir \x3d normalize(joinDisplacementDir);\n        joinDisplacementDir \x3d PERPENDICULAR(joinDisplacementDir);\n  "],
["\n        // convert to bevel join if miterLimit is exceeded\n        if (leftLen \x3c 0.001) {\n          joinDisplacementDir \x3d right;\n        }\n        else if (rightLen \x3c 0.001) {\n          joinDisplacementDir \x3d left;\n        }\n        else {\n          joinDisplacementDir \x3d isStartVertex ? right : left;\n        }\n        joinDisplacementDir \x3d normalize(joinDisplacementDir);\n        joinDisplacementDir \x3d PERPENDICULAR(joinDisplacementDir);\n  "]))));u.vertex.code.add(k.glsl(A||
(A=e.__makeTemplateObject(["\n        displacementLen \x3d lineWidth;\n      }\n    } else {\n    // CAP handling ---------------------------------------------------\n    if (leftLen \x3c 0.001) {\n      joinDisplacementDir \x3d right;\n    }\n    else if (rightLen \x3c 0.001) {\n      joinDisplacementDir \x3d left;\n    }\n    else {\n      joinDisplacementDir \x3d isStartVertex ? right : left;\n    }\n    joinDisplacementDir \x3d normalize(joinDisplacementDir);\n    joinDisplacementDir \x3d PERPENDICULAR(joinDisplacementDir);\n    displacementLen \x3d lineWidth;\n\n    capDisplacementDir \x3d isStartVertex ? -right : left;\n  "],
["\n        displacementLen \x3d lineWidth;\n      }\n    } else {\n    // CAP handling ---------------------------------------------------\n    if (leftLen \x3c 0.001) {\n      joinDisplacementDir \x3d right;\n    }\n    else if (rightLen \x3c 0.001) {\n      joinDisplacementDir \x3d left;\n    }\n    else {\n      joinDisplacementDir \x3d isStartVertex ? right : left;\n    }\n    joinDisplacementDir \x3d normalize(joinDisplacementDir);\n    joinDisplacementDir \x3d PERPENDICULAR(joinDisplacementDir);\n    displacementLen \x3d lineWidth;\n\n    capDisplacementDir \x3d isStartVertex ? -right : left;\n  "]))));
f.roundCaps?u.vertex.code.add(k.glsl(E||(E=e.__makeTemplateObject(["\n    float angle \x3d subdivisionFactor*PI*0.5;\n    joinDisplacementDir *\x3d cos(angle);\n    capDisplacementDir *\x3d sin(angle);\n    "],["\n    float angle \x3d subdivisionFactor*PI*0.5;\n    joinDisplacementDir *\x3d cos(angle);\n    capDisplacementDir *\x3d sin(angle);\n    "])))):u.vertex.code.add(k.glsl(H||(H=e.__makeTemplateObject(["\n    capDisplacementDir *\x3d subdivisionFactor;\n    "],["\n    capDisplacementDir *\x3d subdivisionFactor;\n    "]))));
u.vertex.code.add(k.glsl(F||(F=e.__makeTemplateObject(["\n  }\n\n  // Displacement (in pixels) caused by join/or cap\n  vec2 dpos \x3d joinDisplacementDir * sign(uv0.y) * displacementLen + capDisplacementDir * displacementLen;\n\n  ","\n\n  ","\n  ","\n\n  pos.xy +\x3d dpos;\n  "],["\n  }\n\n  // Displacement (in pixels) caused by join/or cap\n  vec2 dpos \x3d joinDisplacementDir * sign(uv0.y) * displacementLen + capDisplacementDir * displacementLen;\n\n  ","\n\n  ","\n  ","\n\n  pos.xy +\x3d dpos;\n  "])),
Z||ea?k.glsl(J||(J=e.__makeTemplateObject(["float lineDist \x3d lineWidth * sign(uv0.y) * pos.w;"],["float lineDist \x3d lineWidth * sign(uv0.y) * pos.w;"]))):"",ea?k.glsl(B||(B=e.__makeTemplateObject(["vLineDistance \x3d lineDist;"],["vLineDistance \x3d lineDist;"]))):"",Z?k.glsl(G||(G=e.__makeTemplateObject(["vLineDistanceNorm \x3d lineDist / lineWidth;"],["vLineDistanceNorm \x3d lineDist / lineWidth;"]))):""));f.stippleEnabled&&(u.vertex.code.add(k.glsl(M||(M=e.__makeTemplateObject(["\n    {\n      // Compute the stipple pattern UV coordinate from the actual position, based on the origin\n      // and direction of the line segment on which the stipple pattern is based.\n\n      // Project the vector from the origin of the segment to the vertex onto the line segment.\n      // Note the 0.5 factor due to projected positions being at twice the screen size scale (see projectAndScale)\n      vec2 posVec \x3d pos.xy - stippleSegmentOrigin;\n\n      float stippleSegmentDirectionLength \x3d length(stippleSegmentDirection);\n    "],
["\n    {\n      // Compute the stipple pattern UV coordinate from the actual position, based on the origin\n      // and direction of the line segment on which the stipple pattern is based.\n\n      // Project the vector from the origin of the segment to the vertex onto the line segment.\n      // Note the 0.5 factor due to projected positions being at twice the screen size scale (see projectAndScale)\n      vec2 posVec \x3d pos.xy - stippleSegmentOrigin;\n\n      float stippleSegmentDirectionLength \x3d length(stippleSegmentDirection);\n    "])))),
f.stippleIntegerRepeatsEnabled&&u.vertex.code.add(k.glsl(R||(R=e.__makeTemplateObject(["\n      float numberOfPatternRepeats \x3d stippleSegmentDirectionLength * 0.5 * stipplePatternPixelSizeInv;\n      float roundedNumberOfPatternRepeats \x3d max(1.0, floor(numberOfPatternRepeats + 0.5));\n      stipplePatternUvMax \x3d roundedNumberOfPatternRepeats;\n      "],["\n      float numberOfPatternRepeats \x3d stippleSegmentDirectionLength * 0.5 * stipplePatternPixelSizeInv;\n      float roundedNumberOfPatternRepeats \x3d max(1.0, floor(numberOfPatternRepeats + 0.5));\n      stipplePatternUvMax \x3d roundedNumberOfPatternRepeats;\n      "])))),
u.vertex.code.add(k.glsl(T||(T=e.__makeTemplateObject(["\n      if (stippleSegmentDirectionLength \x3e\x3d 0.001) {\n        // Project the vertex position onto the line segment.\n        float projectedLength \x3d dot(stippleSegmentDirection, posVec) / stippleSegmentDirectionLength * 0.5;\n     ","\n        stipplePatternUv \x3d projectedLength * wholeNumberOfRepeatsScale * stipplePatternPixelSizeInv * pos.w;\n        } else {\n          stipplePatternUv \x3d 1.0;\n        }\n      }\n    "],["\n      if (stippleSegmentDirectionLength \x3e\x3d 0.001) {\n        // Project the vertex position onto the line segment.\n        float projectedLength \x3d dot(stippleSegmentDirection, posVec) / stippleSegmentDirectionLength * 0.5;\n     ",
"\n        stipplePatternUv \x3d projectedLength * wholeNumberOfRepeatsScale * stipplePatternPixelSizeInv * pos.w;\n        } else {\n          stipplePatternUv \x3d 1.0;\n        }\n      }\n    "])),f.stippleIntegerRepeatsEnabled?"float wholeNumberOfRepeatsScale \x3d roundedNumberOfPatternRepeats / numberOfPatternRepeats;":"float wholeNumberOfRepeatsScale \x3d 1.0;")));u.vertex.code.add(k.glsl(O||(O=e.__makeTemplateObject(["\n      // Convert back into NDC\n      pos.xy \x3d pos.xy / screenSize * pos.w;\n\n      vColor \x3d getColor();\n      vColor.a *\x3d coverage;\n\n      gl_Position \x3d pos;\n    }\n  }\n  "],
["\n      // Convert back into NDC\n      pos.xy \x3d pos.xy / screenSize * pos.w;\n\n      vColor \x3d getColor();\n      vColor.a *\x3d coverage;\n\n      gl_Position \x3d pos;\n    }\n  }\n  "]))));u.include(r.Slice,f);0===f.output&&(u.fragment.uniforms.add("intrinsicColor","vec4"),u.fragment.code.add(k.glsl(L||(L=e.__makeTemplateObject(["\n    void main() {\n      discardBySlice(vpos);\n      float stippleAlpha \x3d getStippleAlpha();\n      discardByStippleAlpha(stippleAlpha, STIPPLE_ALPHA_COLOR_DISCARD);\n\n      vec4 color \x3d intrinsicColor * vColor;\n    "],
["\n    void main() {\n      discardBySlice(vpos);\n      float stippleAlpha \x3d getStippleAlpha();\n      discardByStippleAlpha(stippleAlpha, STIPPLE_ALPHA_COLOR_DISCARD);\n\n      vec4 color \x3d intrinsicColor * vColor;\n    "])))),f.innerColorEnabled&&(u.fragment.uniforms.add("pixelRatio","float"),u.fragment.code.add(k.glsl(Q||(Q=e.__makeTemplateObject(["\n      float distToInner \x3d abs(vLineDistance * gl_FragCoord.w) - innerWidth;\n      float innerAA \x3d clamp(0.5 - distToInner, 0.0, 1.0);\n      float innerAlpha \x3d innerColor.a + color.a * (1.0 - innerColor.a);\n      color \x3d mix(color, vec4(innerColor.rgb, innerAlpha), innerAA);\n      "],
["\n      float distToInner \x3d abs(vLineDistance * gl_FragCoord.w) - innerWidth;\n      float innerAA \x3d clamp(0.5 - distToInner, 0.0, 1.0);\n      float innerAlpha \x3d innerColor.a + color.a * (1.0 - innerColor.a);\n      color \x3d mix(color, vec4(innerColor.rgb, innerAlpha), innerAA);\n      "]))))),u.fragment.code.add(k.glsl(S||(S=e.__makeTemplateObject(["\n      vec4 finalColor \x3d blendStipple(color, stippleAlpha);\n    "],["\n      vec4 finalColor \x3d blendStipple(color, stippleAlpha);\n    "])))),
f.falloffEnabled&&u.fragment.code.add(k.glsl(aa||(aa=e.__makeTemplateObject(["\n      finalColor.a *\x3d pow(max(0.0, 1.0 - abs(vLineDistanceNorm * gl_FragCoord.w)), falloff);\n      "],["\n      finalColor.a *\x3d pow(max(0.0, 1.0 - abs(vLineDistanceNorm * gl_FragCoord.w)), falloff);\n      "])))),u.fragment.code.add(k.glsl(ba||(ba=e.__makeTemplateObject(["\n      gl_FragColor \x3d highlightSlice(finalColor, vpos);\n    }\n    "],["\n      gl_FragColor \x3d highlightSlice(finalColor, vpos);\n    }\n    "])))));
4===f.output&&u.fragment.code.add(k.glsl(V||(V=e.__makeTemplateObject(["\n      void main() {\n        discardBySlice(vpos);\n        discardByStippleAlpha(getStippleAlpha(), STIPPLE_ALPHA_HIGHLIGHT_DISCARD);\n        gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n      }\n    "],["\n      void main() {\n        discardBySlice(vpos);\n        discardByStippleAlpha(getStippleAlpha(), STIPPLE_ALPHA_HIGHLIGHT_DISCARD);\n        gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n      }\n    "]))));return u};
var c,a,b,q,v,t,x,z,A,E,H,J,B,G,F,M,R,T,O,L,Q,S,aa,ba,V})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/RibbonVertexPosition.glsl":function(){define(["require","exports","tslib","../../shaderModules/interfaces"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.RibbonVertexPosition=function(a,b){a.vertex.uniforms.add("intrinsicWidth","float");b.vvSize?(a.attributes.add("sizeFeatureAttribute","float"),a.vertex.uniforms.add("vvSizeMinSize","vec3"),a.vertex.uniforms.add("vvSizeMaxSize",
"vec3"),a.vertex.uniforms.add("vvSizeOffset","vec3"),a.vertex.uniforms.add("vvSizeFactor","vec3"),a.vertex.code.add(r.glsl(m||(m=e.__makeTemplateObject(["\n    float getSize() {\n      return intrinsicWidth * clamp(vvSizeOffset + sizeFeatureAttribute * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize).x;\n    }\n    "],["\n    float getSize() {\n      return intrinsicWidth * clamp(vvSizeOffset + sizeFeatureAttribute * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize).x;\n    }\n    "]))))):(a.attributes.add("size",
"float"),a.vertex.code.add(r.glsl(d||(d=e.__makeTemplateObject(["\n    float getSize(){\n      return intrinsicWidth * size;\n    }\n    "],["\n    float getSize(){\n      return intrinsicWidth * size;\n    }\n    "])))));b.vvOpacity?(a.attributes.add("opacityFeatureAttribute","float"),a.vertex.defines.addInt("VV_OPACITY_N",8),a.vertex.code.add(r.glsl(g||(g=e.__makeTemplateObject(["\n    uniform float vvOpacityValues[VV_OPACITY_N];\n    uniform float vvOpacityOpacities[VV_OPACITY_N];\n\n    float interpolateOpacity( float value ){\n      if (value \x3c\x3d vvOpacityValues[0]) {\n        return vvOpacityOpacities[0];\n      }\n\n      for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\n        if (vvOpacityValues[i] \x3e\x3d value) {\n          float f \x3d (value - vvOpacityValues[i-1]) / (vvOpacityValues[i] - vvOpacityValues[i-1]);\n          return mix(vvOpacityOpacities[i-1], vvOpacityOpacities[i], f);\n        }\n      }\n\n      return vvOpacityOpacities[VV_OPACITY_N - 1];\n    }\n\n    vec4 applyOpacity( vec4 color ){\n      return vec4(color.xyz, interpolateOpacity(opacityFeatureAttribute));\n    }\n    "],
["\n    uniform float vvOpacityValues[VV_OPACITY_N];\n    uniform float vvOpacityOpacities[VV_OPACITY_N];\n\n    float interpolateOpacity( float value ){\n      if (value \x3c\x3d vvOpacityValues[0]) {\n        return vvOpacityOpacities[0];\n      }\n\n      for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\n        if (vvOpacityValues[i] \x3e\x3d value) {\n          float f \x3d (value - vvOpacityValues[i-1]) / (vvOpacityValues[i] - vvOpacityValues[i-1]);\n          return mix(vvOpacityOpacities[i-1], vvOpacityOpacities[i], f);\n        }\n      }\n\n      return vvOpacityOpacities[VV_OPACITY_N - 1];\n    }\n\n    vec4 applyOpacity( vec4 color ){\n      return vec4(color.xyz, interpolateOpacity(opacityFeatureAttribute));\n    }\n    "]))))):
a.vertex.code.add(r.glsl(k||(k=e.__makeTemplateObject(["\n    vec4 applyOpacity( vec4 color ){\n      return color;\n    }\n    "],["\n    vec4 applyOpacity( vec4 color ){\n      return color;\n    }\n    "]))));b.vvColor?(a.attributes.add("colorFeatureAttribute","float"),a.vertex.defines.addInt("VV_COLOR_N",8),a.vertex.code.add(r.glsl(l||(l=e.__makeTemplateObject(["\n    uniform float vvColorValues[VV_COLOR_N];\n    uniform vec4 vvColorColors[VV_COLOR_N];\n\n    vec4 interpolateColor( float value ) {\n      if (value \x3c\x3d vvColorValues[0]) {\n        return vvColorColors[0];\n      }\n\n      for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n        if (vvColorValues[i] \x3e\x3d value) {\n          float f \x3d (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);\n          return mix(vvColorColors[i-1], vvColorColors[i], f);\n        }\n      }\n\n      return vvColorColors[VV_COLOR_N - 1];\n    }\n\n    vec4 getColor(){\n      return applyOpacity(interpolateColor(colorFeatureAttribute));\n    }\n    "],
["\n    uniform float vvColorValues[VV_COLOR_N];\n    uniform vec4 vvColorColors[VV_COLOR_N];\n\n    vec4 interpolateColor( float value ) {\n      if (value \x3c\x3d vvColorValues[0]) {\n        return vvColorColors[0];\n      }\n\n      for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n        if (vvColorValues[i] \x3e\x3d value) {\n          float f \x3d (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);\n          return mix(vvColorColors[i-1], vvColorColors[i], f);\n        }\n      }\n\n      return vvColorColors[VV_COLOR_N - 1];\n    }\n\n    vec4 getColor(){\n      return applyOpacity(interpolateColor(colorFeatureAttribute));\n    }\n    "]))))):
(a.attributes.add("color","vec4"),a.vertex.code.add(r.glsl(c||(c=e.__makeTemplateObject(["\n    vec4 getColor(){\n      return applyOpacity(color);\n    }\n    "],["\n    vec4 getColor(){\n      return applyOpacity(color);\n    }\n    "])))))};var m,d,g,k,l,c})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/LineStipple.glsl":function(){define(["require","exports","tslib","../../shaderModules/interfaces"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.LineStipple=function(f,
c){f.defines.addFloat("STIPPLE_ALPHA_COLOR_DISCARD",.001);f.defines.addFloat("STIPPLE_ALPHA_HIGHLIGHT_DISCARD",.5);c.stippleEnabled?(f.vertex.uniforms.add("stipplePatternPixelSizeInv","float"),c.stippleUVMaxEnabled&&f.varyings.add("stipplePatternUvMax","float"),f.varyings.add("stipplePatternUv","float"),f.fragment.uniforms.add("stipplePatternTexture","sampler2D"),c.stippleOffColorEnabled&&f.fragment.uniforms.add("stippleOffColor","vec4"),f.fragment.code.add(r.glsl(m||(m=e.__makeTemplateObject(["\n  float getStippleAlpha() {\n    float stipplePatternUvClamped \x3d stipplePatternUv * gl_FragCoord.w;\n    ",
"\n\n    return texture2D(stipplePatternTexture, vec2(mod(stipplePatternUvClamped, 1.0), 0.5)).a;\n  }"],["\n  float getStippleAlpha() {\n    float stipplePatternUvClamped \x3d stipplePatternUv * gl_FragCoord.w;\n    ","\n\n    return texture2D(stipplePatternTexture, vec2(mod(stipplePatternUvClamped, 1.0), 0.5)).a;\n  }"])),c.stippleUVMaxEnabled?"stipplePatternUvClamped \x3d clamp(stipplePatternUvClamped, 0.0, stipplePatternUvMax);":"")),c.stippleOffColorEnabled?f.fragment.code.add(r.glsl(d||(d=e.__makeTemplateObject(["\n    #define discardByStippleAlpha(stippleAlpha, threshold) {}\n    #define blendStipple(color, stippleAlpha) mix(color, stippleOffColor, stippleAlpha)\n    "],
["\n    #define discardByStippleAlpha(stippleAlpha, threshold) {}\n    #define blendStipple(color, stippleAlpha) mix(color, stippleOffColor, stippleAlpha)\n    "])))):f.fragment.code.add(r.glsl(g||(g=e.__makeTemplateObject(["\n    #define discardByStippleAlpha(stippleAlpha, threshold) if (stippleAlpha \x3c threshold) { discard; }\n    #define blendStipple(color, stippleAlpha) vec4(color.rgb, color.a * stippleAlpha)\n    "],["\n    #define discardByStippleAlpha(stippleAlpha, threshold) if (stippleAlpha \x3c threshold) { discard; }\n    #define blendStipple(color, stippleAlpha) vec4(color.rgb, color.a * stippleAlpha)\n    "]))))):
f.fragment.code.add(r.glsl(k||(k=e.__makeTemplateObject(["\n  float getStippleAlpha() { return 1.0; }\n\n  #define discardByStippleAlpha(_stippleAlpha_, _threshold_) {}\n  #define blendStipple(color, _stippleAlpha_) color\n  "],["\n  float getStippleAlpha() { return 1.0; }\n\n  #define discardByStippleAlpha(_stippleAlpha_, _threshold_) {}\n  #define blendStipple(color, _stippleAlpha_) color\n  "]))))};var m,d,g,k})},"esri/views/3d/webgl-engine/lib/intersectorUtils":function(){define("require exports ../../../../core/maybe ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f64 ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/quat ../../../../core/libs/gl-matrix-2/quatf64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f32 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/vec4 ../../../../core/libs/gl-matrix-2/vec4f64 ../../support/geometryUtils ../../support/geometryUtils/boundedPlane ../../support/geometryUtils/sphere ./Object3D".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A){function E(a,b){return e.isNone(a)||null==a.layerUid?null:e.isSome(b.graphicsView)&&a.layerUid===b.graphicsView.mockLayerId?b.graphics:b.map.findLayerByUid(a.layerUid)}function H(a,b){if(e.isNone(a))return null;var c=E(a,b);return e.isNone(c)?null:c===b.graphics?e.isSome(b.graphicsView)?e.unwrap(b.graphicsView.getGraphicFromGraphicUid(a.graphicUid)):null:(b=b.allLayerViews.find(function(a){return a.layer===c}))?J(b,a):null}function J(a,b){return!a||a.suspended?
null:"getGraphicFromIntersectorMetadata"in a&&b?a.getGraphicFromIntersectorMetadata(b):"getGraphicFromGraphicUid"in a&&null!=b.graphicUid?a.getGraphicFromGraphicUid(b.graphicUid):null}Object.defineProperty(f,"__esModule",{value:!0});f.sliceFilterPredicate=function(a){return function(b,d,e){c.vec3.lerp(L,b,d,e);return!x.extrusionContainsPoint(a,L)}};u=function(){return function(){this.verticalOffset=0;this.selectionMode=!1;this.selectOpaqueTerrainOnly=this.hud=!0;this.invisibleTerrain=!1;this.storeTerrainResults=
this.backfacesTerrain=!0;this.store=2}}();f.IntersectorOptions=u;u=function(){function a(){this._transform=g.mat4f64.create();this._transformInverse=new B({value:this._transform},d.mat4.invert,g.mat4f64.create);this._transformInverseTranspose=new B(this._transformInverse,d.mat4.transpose,g.mat4f64.create);this._transformTranspose=new B({value:this._transform},d.mat4.transpose,g.mat4f64.create);this._transformInverseRotation=new B({value:this._transform},r.mat3.normalFromMat4Legacy,m.mat3f64.create)}
a.prototype.invalidateLazyTransforms=function(){this._transformInverse.invalidate();this._transformInverseTranspose.invalidate();this._transformTranspose.invalidate();this._transformInverseRotation.invalidate()};Object.defineProperty(a.prototype,"transform",{get:function(){return this._transform},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"inverse",{get:function(){return this._transformInverse.value},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"inverseTranspose",
{get:function(){return this._transformInverseTranspose.value},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"inverseRotation",{get:function(){return this._transformInverseRotation.value},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"transpose",{get:function(){return this._transformTranspose.value},enumerable:!0,configurable:!0});a.prototype.setTransformMatrix=function(a){d.mat4.copy(this._transform,a)};a.prototype.multiplyTransform=function(a){d.mat4.multiply(this._transform,
this._transform,a)};a.prototype.set=function(a){d.mat4.copy(this._transform,a);this.invalidateLazyTransforms()};a.prototype.setAndInvalidateLazyTransforms=function(a,b){this.setTransformMatrix(a);this.multiplyTransform(b);this.invalidateLazyTransforms()};return a}();f.IntersectorTransform=u;var B=function(){function a(a,b,c){this.original=a;this.update=b;this.dirty=!0;this.transform=c()}a.prototype.invalidate=function(){this.dirty=!0};Object.defineProperty(a.prototype,"value",{get:function(){this.dirty&&
(this.update(this.transform,this.original.value),this.dirty=!1);return this.transform},enumerable:!0,configurable:!0});return a}();u=function(){function a(){this.min=new G;this.max=new G;this.hud=new G;this.ground=new G}a.prototype.init=function(a){this.min.init(a);this.max.init(a);this.hud.init(a);this.ground.init(a);this.all=[]};return a}();f.IntersectorResults=u;var G=function(){function a(a){this.normal=b.vec3f64.create();this.transformation=g.mat4f64.create();this._ray=t.ray.create();this.init(a)}
Object.defineProperty(a.prototype,"ray",{get:function(){return this._ray},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasIntersectionPoint",{get:function(){return null!=this.dist},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"distanceInRenderSpace",{get:function(){if(null!=this.dist)return c.vec3.scale(Q,this.ray.direction,this.dist),c.vec3.length(Q)},enumerable:!0,configurable:!0});a.prototype.getIntersectionPoint=function(a){if(!this.hasIntersectionPoint)return!1;
c.vec3.scale(Q,this.ray.direction,this.dist);c.vec3.add(a,this.ray.origin,Q);return!0};a.prototype.getTransformedNormal=function(a){c.vec3.copy(S,this.normal);S[3]=0;q.vec4.transformMat4(S,S,this.transformation);c.vec3.copy(a,S);c.vec3.normalize(a,a);return a};a.prototype.init=function(a){this.drapedLayerGraphicOrder=this.drapedLayerOrder=this.name=this.target=this.dist=void 0;this.triangleNr=this.geometryId=this.center=null;this.intersector="Stage";a?t.ray.copy(a,this._ray):this._ray=t.ray.create()};
a.prototype.set=function(a,e,g,f,k,l,q,m,t,r){a instanceof A&&(a={type:"stage",obj:a});this.dist=g;c.vec3.copy(this.normal,f);d.mat4.copy(this.transformation,k);this.target=a;this.name=e;this.drapedLayerOrder=l;this.center=q?b.vec3f64.clone(q):null;this.geometryId=m;this.triangleNr=t;this.drapedLayerGraphicOrder=r};a.prototype.copyFrom=function(a){t.ray.copy(a._ray,this._ray);this.dist=a.dist;this.target=a.target;this.name=a.name;this.drapedLayerOrder=a.drapedLayerOrder;this.center=a.center?b.vec3f64.clone(a.center):
null;this.geometryId=a.geometryId;this.triangleNr=a.triangleNr;this.intersector=a.intersector;this.drapedLayerGraphicOrder=a.drapedLayerGraphicOrder;c.vec3.copy(this.normal,a.normal);d.mat4.copy(this.transformation,a.transformation)};a.prototype.toOwner=function(a){if(!this.target)return null;switch(this.target.type){case "stage":return E(this.target.obj.metadata,a);case "external":switch(this.intersector){case "PointRenderer":var b=this.target.metadata.layerUid;return null!=b?a.map.findLayerByUid(b):
null;case "I3S":case "IM":case "LodRenderer":case "OverlayRenderer":return E(this.target.metadata,a);case "TerrainRenderer":return a.map&&a.map.ground}}return null};a.prototype.toGraphic=function(a){if(!this.target)return null;switch(this.target.type){case "stage":return H(this.target.obj.metadata,a);case "external":switch(this.intersector){case "PointRenderer":return this.target.metadata.createGraphic();case "I3S":case "IM":case "LodRenderer":case "OverlayRenderer":return H(this.target.metadata,
a)}}return null};return a}();f.IntersectorResult=G;u=function(){function a(a){void 0===a&&(a=0);this.offset=a;this.tmpVertex=b.vec3f64.create()}a.prototype.applyToVertex=function(a,b,c){var d=a+this.localOrigin[0],e=b+this.localOrigin[1],g=c+this.localOrigin[2],f=this.offset/Math.sqrt(d*d+e*e+g*g);this.tmpVertex[0]=a+d*f;this.tmpVertex[1]=b+e*f;this.tmpVertex[2]=c+g*f;return this.tmpVertex};a.prototype.applyToAABB=function(a){var b=a[0]+this.localOrigin[0],c=a[1]+this.localOrigin[1],d=a[2]+this.localOrigin[2],
e=a[3]+this.localOrigin[0],g=a[4]+this.localOrigin[1],f=a[5]+this.localOrigin[2],k=this.offset/Math.sqrt(b*b+c*c+d*d);a[0]+=b*k;a[1]+=c*k;a[2]+=d*k;b=this.offset/Math.sqrt(e*e+g*g+f*f);a[3]+=e*b;a[4]+=g*b;a[5]+=f*b;return a};return a}();f.TerrainVerticalOffsetGlobalViewingMode=u;var F=function(){function d(c){void 0===c&&(c=0);this.offset=c;this.componentLocalOriginLength=0;this.tmpVertex=b.vec3f64.create();this.mbs=v.vec4f64.create();this.obb={center:b.vec3f64.create(),halfSize:a.vec3f32.create(),
quaternion:null}}Object.defineProperty(d.prototype,"localOrigin",{set:function(a){this.componentLocalOriginLength=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2])},enumerable:!0,configurable:!0});d.prototype.applyToVertex=function(a,b,c){var d=c+this.componentLocalOriginLength,e=this.offset/Math.sqrt(a*a+b*b+d*d);this.tmpVertex[0]=a+a*e;this.tmpVertex[1]=b+b*e;this.tmpVertex[2]=c+d*e;return this.tmpVertex};d.prototype.applyToAABB=function(a){var b=a[0],c=a[1],d=a[2]+this.componentLocalOriginLength,e=a[3],
g=a[4],f=a[5]+this.componentLocalOriginLength,k=this.offset/Math.sqrt(b*b+c*c+d*d);a[0]+=b*k;a[1]+=c*k;a[2]+=d*k;b=this.offset/Math.sqrt(e*e+g*g+f*f);a[3]+=e*b;a[4]+=g*b;a[5]+=f*b;return a};d.prototype.applyToMbs=function(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]),c=this.offset/b;this.mbs[0]=a[0]+a[0]*c;this.mbs[1]=a[1]+a[1]*c;this.mbs[2]=a[2]+a[2]*c;this.mbs[3]=a[3]+a[3]*this.offset/b;return this.mbs};d.prototype.applyToObb=function(a){var b=a.center,d=this.offset/Math.sqrt(b[0]*b[0]+b[1]*
b[1]+b[2]*b[2]);this.obb.center[0]=b[0]+b[0]*d;this.obb.center[1]=b[1]+b[1]*d;this.obb.center[2]=b[2]+b[2]*d;c.vec3.transformQuat(this.obb.halfSize,a.halfSize,a.quaternion);c.vec3.add(this.obb.halfSize,this.obb.halfSize,a.center);b=this.offset/Math.sqrt(this.obb.halfSize[0]*this.obb.halfSize[0]+this.obb.halfSize[1]*this.obb.halfSize[1]+this.obb.halfSize[2]*this.obb.halfSize[2]);this.obb.halfSize[0]+=this.obb.halfSize[0]*b;this.obb.halfSize[1]+=this.obb.halfSize[1]*b;this.obb.halfSize[2]+=this.obb.halfSize[2]*
b;c.vec3.subtract(this.obb.halfSize,this.obb.halfSize,a.center);k.quat.conjugate(aa,a.quaternion);c.vec3.transformQuat(this.obb.halfSize,this.obb.halfSize,aa);this.obb.halfSize[0]*=0>this.obb.halfSize[0]?-1:1;this.obb.halfSize[1]*=0>this.obb.halfSize[1]?-1:1;this.obb.halfSize[2]*=0>this.obb.halfSize[2]?-1:1;this.obb.quaternion=a.quaternion;return this.obb};return d}();f.I3SVerticalOffsetGlobalViewingMode=F;var M=function(){function a(a){void 0===a&&(a=0);this.offset=a;this.sphere=z.create();this.tmpVertex=
b.vec3f64.create()}a.prototype.applyToVertex=function(a,b,c){var d=this.objectTransform.transform,e=d[0]*a+d[4]*b+d[8]*c+d[12],g=d[1]*a+d[5]*b+d[9]*c+d[13];a=d[2]*a+d[6]*b+d[10]*c+d[14];b=this.offset/Math.sqrt(e*e+g*g+a*a);e+=e*b;g+=g*b;a+=a*b;b=this.objectTransform.inverse;this.tmpVertex[0]=b[0]*e+b[4]*g+b[8]*a+b[12];this.tmpVertex[1]=b[1]*e+b[5]*g+b[9]*a+b[13];this.tmpVertex[2]=b[2]*e+b[6]*g+b[10]*a+b[14];return this.tmpVertex};a.prototype.applyToMinMax=function(a,b){var c=this.offset/Math.sqrt(a[0]*
a[0]+a[1]*a[1]+a[2]*a[2]);a[0]+=a[0]*c;a[1]+=a[1]*c;a[2]+=a[2]*c;a=this.offset/Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2]);b[0]+=b[0]*a;b[1]+=b[1]*a;b[2]+=b[2]*a};a.prototype.applyToAABB=function(a){var b=this.offset/Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);a[0]+=a[0]*b;a[1]+=a[1]*b;a[2]+=a[2]*b;b=this.offset/Math.sqrt(a[3]*a[3]+a[4]*a[4]+a[5]*a[5]);a[3]+=a[3]*b;a[4]+=a[4]*b;a[5]+=a[5]*b;return a};a.prototype.applyToBoundingSphere=function(a,b){var c=Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2]),d=this.offset/
c;this.sphere.center[0]=b[0]+b[0]*d;this.sphere.center[1]=b[1]+b[1]*d;this.sphere.center[2]=b[2]+b[2]*d;this.sphere.radius=a+a*this.offset/c;return this.sphere};return a}();f.Object3DVerticalOffsetGlobalViewingMode=M;var R=new M;f.getVerticalOffsetObject3D=function(a){return e.isSome(a)?(R.offset=a,R):null};var T=new F;f.getVerticalOffsetI3S=function(a){return e.isSome(a)?(T.offset=a,T):null};var O=new u;f.getVerticalOffsetTerrain=function(a){return e.isSome(a)?(O.offset=a,O):null};f.TERRAIN_ID="terrain";
var L=b.vec3f64.create(),Q=b.vec3f64.create(),S=v.vec4f64.create(),aa=l.quatf64.create()})},"esri/core/libs/gl-matrix-2/quat":function(){define(["require","exports","./math/quat"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.quat=e})},"esri/core/libs/gl-matrix-2/math/quat":function(){define("require exports ../factories/mat3f64 ../factories/quatf64 ../factories/vec3f64 ./common ./vec3 ./vec4".split(" "),function(u,f,e,r,m,d,g,k){function l(a,b,c){c*=.5;var d=Math.sin(c);a[0]=
d*b[0];a[1]=d*b[1];a[2]=d*b[2];a[3]=Math.cos(c);return a}function c(a,b,c){var d=b[0],e=b[1],g=b[2];b=b[3];var f=c[0],k=c[1],l=c[2];c=c[3];a[0]=d*c+b*f+e*l-g*k;a[1]=e*c+b*k+g*f-d*l;a[2]=g*c+b*l+d*k-e*f;a[3]=b*c-d*f-e*k-g*l;return a}function a(a,b,c,e){var g=b[0],f=b[1],k=b[2];b=b[3];var l=c[0],q=c[1],m=c[2];c=c[3];var t,r,v;r=g*l+f*q+k*m+b*c;0>r&&(r=-r,l=-l,q=-q,m=-m,c=-c);1-r>d.EPSILON?(t=Math.acos(r),v=Math.sin(t),r=Math.sin((1-e)*t)/v,e=Math.sin(e*t)/v):r=1-e;a[0]=r*g+e*l;a[1]=r*f+e*q;a[2]=r*k+
e*m;a[3]=r*b+e*c;return a}function b(a,b){var c=b[0]+b[4]+b[8];if(0<c)c=Math.sqrt(c+1),a[3]=.5*c,c=.5/c,a[0]=(b[5]-b[7])*c,a[1]=(b[6]-b[2])*c,a[2]=(b[1]-b[3])*c;else{var d=0;b[4]>b[0]&&(d=1);b[8]>b[3*d+d]&&(d=2);var e=(d+1)%3,g=(d+2)%3,c=Math.sqrt(b[3*d+d]-b[3*e+e]-b[3*g+g]+1);a[d]=.5*c;c=.5/c;a[3]=(b[3*e+g]-b[3*g+e])*c;a[e]=(b[3*e+d]+b[3*d+e])*c;a[g]=(b[3*g+d]+b[3*d+g])*c}return a}Object.defineProperty(f,"__esModule",{value:!0});f.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};f.setAxisAngle=
l;f.getAxisAngle=function(a,b){var c=2*Math.acos(b[3]),e=Math.sin(c/2);e>d.EPSILON?(a[0]=b[0]/e,a[1]=b[1]/e,a[2]=b[2]/e):(a[0]=1,a[1]=0,a[2]=0);return c};f.multiply=c;f.rotateX=function(a,b,c){c*=.5;var d=b[0],e=b[1],g=b[2];b=b[3];var f=Math.sin(c);c=Math.cos(c);a[0]=d*c+b*f;a[1]=e*c+g*f;a[2]=g*c-e*f;a[3]=b*c-d*f;return a};f.rotateY=function(a,b,c){c*=.5;var d=b[0],e=b[1],g=b[2];b=b[3];var f=Math.sin(c);c=Math.cos(c);a[0]=d*c-g*f;a[1]=e*c+b*f;a[2]=g*c+d*f;a[3]=b*c-e*f;return a};f.rotateZ=function(a,
b,c){c*=.5;var d=b[0],e=b[1],g=b[2];b=b[3];var f=Math.sin(c);c=Math.cos(c);a[0]=d*c+e*f;a[1]=e*c-d*f;a[2]=g*c+b*f;a[3]=b*c-g*f;return a};f.calculateW=function(a,b){var c=b[0],d=b[1];b=b[2];a[0]=c;a[1]=d;a[2]=b;a[3]=Math.sqrt(Math.abs(1-c*c-d*d-b*b));return a};f.slerp=a;f.random=function(a){var b=d.RANDOM(),c=d.RANDOM(),e=d.RANDOM(),g=Math.sqrt(1-b),b=Math.sqrt(b);a[0]=g*Math.sin(2*Math.PI*c);a[1]=g*Math.cos(2*Math.PI*c);a[2]=b*Math.sin(2*Math.PI*e);a[3]=b*Math.cos(2*Math.PI*e);return a};f.invert=
function(a,b){var c=b[0],d=b[1],e=b[2];b=b[3];var g=c*c+d*d+e*e+b*b,g=g?1/g:0;a[0]=-c*g;a[1]=-d*g;a[2]=-e*g;a[3]=b*g;return a};f.conjugate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=b[3];return a};f.fromMat3=b;f.fromEuler=function(a,b,c,d){var e=.5*Math.PI/180;b*=e;c*=e;d*=e;e=Math.sin(b);b=Math.cos(b);var g=Math.sin(c);c=Math.cos(c);var f=Math.sin(d);d=Math.cos(d);a[0]=e*c*d-b*g*f;a[1]=b*g*d+e*c*f;a[2]=b*c*f-e*g*d;a[3]=b*c*d+e*g*f;return a};f.str=function(a){return"quat("+a[0]+", "+a[1]+
", "+a[2]+", "+a[3]+")"};f.copy=k.copy;f.set=k.set;f.add=k.add;f.mul=c;f.scale=k.scale;f.dot=k.dot;f.lerp=k.lerp;f.length=k.length;f.len=f.length;f.squaredLength=k.squaredLength;f.sqrLen=f.squaredLength;f.normalize=k.normalize;f.exactEquals=k.exactEquals;f.equals=k.equals;f.rotationTo=function(a,b,c){var d=g.dot(b,c);if(-.999999>d)return g.cross(q,v,b),1E-6>g.len(q)&&g.cross(q,t,b),g.normalize(q,q),l(a,q,Math.PI),a;if(.999999<d)return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a;g.cross(q,b,c);a[0]=q[0];a[1]=q[1];
a[2]=q[2];a[3]=1+d;return f.normalize(a,a)};var q=m.create(),v=m.fromValues(1,0,0),t=m.fromValues(0,1,0);f.sqlerp=function(b,c,d,e,g,f){a(x,c,g,f);a(z,d,e,f);a(b,x,z,2*f*(1-f));return b};var x=r.create(),z=r.create();f.setAxes=function(a,c,d,e){var g=A;g[0]=d[0];g[3]=d[1];g[6]=d[2];g[1]=e[0];g[4]=e[1];g[7]=e[2];g[2]=-c[0];g[5]=-c[1];g[8]=-c[2];return f.normalize(a,b(a,g))};var A=e.create()})},"esri/views/3d/webgl-engine/lib/RenderContext":function(){define(["require","exports"],function(u,f){return function(){function e(e,
f,d,g,k,l){this.camera=null;this.slot=this.pass=0;this.highlightDepthTexture=null;this.renderOccludedMask=13;this.hasOccludees=!1;this.rctx=e;this.offscreenRenderingHelper=f;this.scenelightingData=d;this.shadowMap=g;this.ssaoHelper=k;this.sliceHelper=l}e.prototype.resetRenderOccludedMask=function(){this.renderOccludedMask=13};Object.defineProperty(e.prototype,"isHighlightPass",{get:function(){return 4===this.pass},enumerable:!0,configurable:!0});return e}()})},"esri/views/3d/webgl-engine/lib/SortedRenderGeometryRenderer":function(){define("require exports tslib ../../../../core/Accessor ../../../../core/MapUtils ../../../../core/maybe ../../../../core/PooledArray ../../../../core/accessorSupport/decorators ./Material ./rendererUtils".split(" "),
function(u,f,e,r,m,d,g,k,l,c){Object.defineProperty(f,"__esModule",{value:!0});var a=function(){return function(){}}();u=function(b){function f(){var c=null!==b&&b.apply(this,arguments)||this;c._pendingAddsRemoves=new Map;c._adds=new g;c._removes=new g;c._updates=new g({allocator:function(b){return b||new a},deallocator:function(a){a.renderGeometry=null;return a}});c._materialRenderers=new Map;c._sortedMaterialRenderers=new g;c._hasHighlights=!1;c._hasWater=!1;return c}e.__extends(f,b);f.prototype.dispose=
function(){this._adds.prune();this._removes.prune();this._updates.prune();this._materialRenderers&&(this._materialRenderers.forEach(function(a){return a.dispose()}),this._materialRenderers.clear(),this._sortedMaterialRenderers.clear())};Object.defineProperty(f.prototype,"updating",{get:function(){return 0<this._pendingAddsRemoves.size||0<this._updates.length},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"hasHighlights",{get:function(){return this._hasHighlights},enumerable:!0,
configurable:!0});Object.defineProperty(f.prototype,"hasWater",{get:function(){return this._hasWater},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"rendersOccluded",{get:function(){return m.someMap(this._materialRenderers,function(a){return a.rendersOccluded})},enumerable:!0,configurable:!0});f.prototype.stopAnimationsAtTime=function(a){this._sortedMaterialRenderers.forEach(function(b){return d.applySome(b.material.animation,function(b){return b.stopAtTime(a)})})};Object.defineProperty(f.prototype,
"isEmpty",{get:function(){return!this.updating&&0===this._materialRenderers.size},enumerable:!0,configurable:!0});f.prototype.commitChanges=function(){var a=this,b=!1;if(!this.updating)return!1;this.updateAddsRemoves();var d=!1,e=!1;c.splitRenderGeometryChangeSetByMaterial({numToAdd:this._adds.length,toAdd:this._adds.data,numToRemove:this._removes.length,toRemove:this._removes.data,numToUpdate:this._updates.length,toUpdate:this._updates.data}).forEach(function(c,g){var f=a._materialRenderers.get(g);
!f&&0<c.toAdd.length&&(f=g.createRenderer(a.rctx,a.materialRepository),a._materialRenderers.set(g,f),e=d=b=!0);if(f){var k=d||f.hasHighlights,l=e||f.hasWater;f.modify(c);d=d||k!==f.hasHighlights;e=e||l!==f.hasWater;f.isEmpty&&(a._materialRenderers.delete(g),f.dispose(),b=!0)}});this._adds.clear();this._removes.clear();this._updates.clear();this._pendingAddsRemoves.clear();b&&this.updateSortedMaterialRenderers();d&&(this._hasHighlights=m.someMap(this._materialRenderers,function(a){return a.hasHighlights}));
e&&(this._hasWater=m.someMap(this._materialRenderers,function(a){return a.hasWater}));this.notifyChange("updating");return!0};f.prototype.add=function(a){for(var b=0===this._pendingAddsRemoves.size,c=0;c<a.length;c++)this._pendingAddsRemoves.set(a[c],0);b&&0<this._pendingAddsRemoves.size&&this.notifyChange("updating")};f.prototype.remove=function(a){for(var b=0===this._pendingAddsRemoves.size,c=0;c<a.length;c++){var d=a[c],e=this._pendingAddsRemoves.get(d);0===e?this._pendingAddsRemoves.set(d,2):
2!==e&&this._pendingAddsRemoves.set(d,1)}b&&0<this._pendingAddsRemoves.size&&this.notifyChange("updating")};f.prototype.modify=function(a,b){for(var c=0===this._updates.length,d=0;d<a.length;d++){var e=a[d],g=this._updates.pushNew();g.renderGeometry=e;g.updateType=b}c&&0<this._updates.length&&this.notifyChange("updating")};f.prototype.updateLogic=function(a){for(var b=!1,c=0;c<this._sortedMaterialRenderers.length;c++){var d=this._sortedMaterialRenderers.data[c].materialRenderer;d.updateLogic&&d.updateLogic(a)&&
(b=!0)}return b};f.prototype.draw=function(a,b,c){for(var d=0;d<this._sortedMaterialRenderers.length;d++){var e=this._sortedMaterialRenderers.data[d];if(l.materialPredicate(e.material,a)){var g=c.getMaterialRenderStatsObject(e.materialRenderer.type);e.materialRenderer.render(null,a,b,g)}}};f.prototype.updateSortedMaterialRenderers=function(){var a=this;this._sortedMaterialRenderers.clear();var b=0;this._materialRenderers.forEach(function(c,d){d.insertOrder=b++;a._sortedMaterialRenderers.push({material:d,
materialRenderer:c})});this._sortedMaterialRenderers.sort(function(a,b){var c=b.material.renderPriority-a.material.renderPriority;return 0!==c?c:a.material.insertOrder-b.material.insertOrder})};f.prototype.updateAddsRemoves=function(){var a=this;this._adds.clear();this._removes.clear();this._pendingAddsRemoves.forEach(function(b,c){switch(b){case 0:a._adds.push(c);break;case 1:a._removes.push(c)}});for(var b=0;b<this._updates.length;)this._pendingAddsRemoves.has(this._updates.data[b].renderGeometry)?
this._updates.removeUnorderedIndex(b):b++};Object.defineProperty(f.prototype,"test",{get:function(){return{sortedMaterialRenderers:this._sortedMaterialRenderers}},enumerable:!0,configurable:!0});e.__decorate([k.property()],f.prototype,"rctx",void 0);e.__decorate([k.property()],f.prototype,"materialRepository",void 0);e.__decorate([k.property()],f.prototype,"updating",null);return f=e.__decorate([k.subclass("esri.views.3d.webgl-engine.lib.SortedRenderGeometryRenderer")],f)}(r);f.SortedRenderGeometryRenderer=
u})},"esri/views/3d/webgl-engine/lib/rendererUtils":function(){define(["require","exports","./Util"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.splitRenderGeometryChangeSetByMaterial=function(f){for(var m=new Map,d=null,g=null,k=function(a){if(a===d)return g;var b=m.get(a);b||(b={toAdd:[],numToAdd:-1,toRemove:[],numToRemove:-1,toUpdate:[],numToUpdate:-1},m.set(a,b));d=a;return g=b},l=0;l<f.numToAdd;l++){var c=f.toAdd[l];if(1<=e.getFirstObjectValue(c.data.indices).length){var a=
k(c.material);a.toAdd.push(c)}}for(l=0;l<f.numToRemove;l++)c=f.toRemove[l],1<=e.getFirstObjectValue(c.data.indices).length&&(a=k(c.material),a.toRemove.push(c));for(l=0;l<f.numToUpdate;l++)c=f.toUpdate[l],1<=e.getFirstObjectValue(c.renderGeometry.data.indices).length&&(a=k(c.renderGeometry.material),a.toUpdate.push(c));return m}})},"esri/views/3d/webgl-engine/lib/TextureTechnique":function(){define("require exports tslib ../core/shaderLibrary/util/TextureOnly.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ./DefaultVertexAttributeLocations ../../../webgl/Program ../../../webgl/renderState @dojo/framework/shim/Promise".split(" "),
function(u,f,e,r,m,d,g,k,l,c){Object.defineProperty(f,"__esModule",{value:!0});d=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e.__extends(b,a);b.prototype.initializeProgram=function(a){var c=b.shader.get().build();return new l(a.rctx,c.generateSource("vertex"),c.generateSource("fragment"),k.Default3D)};b.prototype.initializePipeline=function(){return this.configuration.hasAlpha?c.makePipelineState({blending:c.separateBlendingParams(770,1,771,771),colorWrite:c.defaultColorWriteParams}):
c.makePipelineState({colorWrite:c.defaultColorWriteParams})};b.shader=new m.ReloadableShaderModule(r,function(){return new Promise(function(a,b){u(["../core/shaderLibrary/util/TextureOnly.glsl"],a,b)})});return b}(d.ShaderTechnique);f.TextureTechnique=d;d=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.hasAlpha=!1;return b}e.__extends(b,a);e.__decorate([g.parameter()],b.prototype,"hasAlpha",void 0);return b}(g.ShaderTechniqueConfiguration);f.TextureTechniqueConfiguration=
d})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/TextureOnly.glsl":function(){define("require exports tslib ../ScreenSpacePass ../../shaderModules/interfaces ../../shaderModules/ShaderBuilder".split(" "),function(u,f,e,r,m,d){Object.defineProperty(f,"__esModule",{value:!0});f.build=function(){var f=new d.ShaderBuilder;f.include(r.ScreenSpacePass);f.fragment.uniforms.add("tex","sampler2D");f.fragment.uniforms.add("color","vec4");f.fragment.code.add(m.glsl(g||(g=e.__makeTemplateObject(["\n    void main() {\n      vec4 texColor \x3d texture2D(tex, uv);\n      gl_FragColor \x3d texColor * color;\n    }\n  "],
["\n    void main() {\n      vec4 texColor \x3d texture2D(tex, uv);\n      gl_FragColor \x3d texColor * color;\n    }\n  "]))));return f};var g})},"esri/views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass":function(){define(["require","exports","tslib","../shaderModules/interfaces"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.ScreenSpacePass=function(d){d.attributes.add("position","vec2");d.varyings.add("uv","vec2");d.vertex.code.add(r.glsl(m||(m=e.__makeTemplateObject(["\n    void main(void) {\n      gl_Position \x3d vec4(position, 0.0, 1.0);\n      uv \x3d position * 0.5 + vec2(0.5);\n    } \n  "],
["\n    void main(void) {\n      gl_Position \x3d vec4(position, 0.0, 1.0);\n      uv \x3d position * 0.5 + vec2(0.5);\n    } \n  "]))))};var m})},"esri/views/3d/webgl-engine/lighting/Lightsources":function(){define(["require","exports","../../../../core/libs/gl-matrix-2/vec3f64"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});u=function(){return function(f,m,d){void 0===f&&(f=e.vec3f64.create());void 0===m&&(m=e.vec3f64.fromValues(.57735,.57735,.57735));void 0===d&&(d=!0);this.intensity=
f;this.direction=m;this.castShadows=d}}();f.MainLight=u;u=function(){return function(f,m){void 0===f&&(f=e.vec3f64.create());void 0===m&&(m=e.vec3f64.fromValues(.57735,.57735,.57735));this.intensity=e.vec3f64.create();this.direction=e.vec3f64.create();this.intensity=f;this.direction=m}}();f.FillLight=u;u=function(){return function(f){void 0===f&&(f=e.vec3f64.create());this.intensity=f}}();f.AmbientLight=u;u=function(){return function(){this.sh={r:[0],g:[0],b:[0]}}}();f.SphericalHarmonicsLight=u})},
"esri/views/3d/webgl-engine/lighting/SceneLighting":function(){define(["require","exports","../../../../core/libs/gl-matrix-2/vec3","../../../../core/libs/gl-matrix-2/vec3f64","./SphericalHarmonics"],function(u,f,e,r,m){Object.defineProperty(f,"__esModule",{value:!0});var d=r.vec3f64.create();u=function(){function g(){this._renderLighting={main:{intensity:r.vec3f64.create(),direction:r.vec3f64.fromValues(1,0,0),castShadows:!1},sphericalHarmonics:{sh:{r:[0],g:[0],b:[0]}}};this._shOrder=2;this._oldSunlight=
{direction:r.vec3f64.create(),ambient:{color:r.vec3f64.create(),intensity:0},diffuse:{color:r.vec3f64.create(),intensity:0}}}g.prototype.setLightDirectionUniform=function(d){d.setUniform3fv("lightingMainDirection",this._renderLighting.main.direction)};g.prototype.setUniforms=function(d,e){void 0===e&&(e=!1);e?d.setUniform1f("lightingFixedFactor",(1-this._info.groundLightingFactor)*(1-this._info.globalFactor)):d.setUniform1f("lightingFixedFactor",0);d.setUniform1f("lightingGlobalFactor",this._info.globalFactor);
this.setLightDirectionUniform(d);d.setUniform3fv("lightingMainIntensity",this._renderLighting.main.intensity);d.setUniform1f("ambientBoostFactor",.4);e=this._renderLighting.sphericalHarmonics.sh;0===this._shOrder?d.setUniform3f("lightingAmbientSH0",e.r[0],e.g[0],e.b[0]):1===this._shOrder?(d.setUniform4f("lightingAmbientSH_R",e.r[0],e.r[1],e.r[2],e.r[3]),d.setUniform4f("lightingAmbientSH_G",e.g[0],e.g[1],e.g[2],e.g[3]),d.setUniform4f("lightingAmbientSH_B",e.b[0],e.b[1],e.b[2],e.b[3])):2===this._shOrder&&
(d.setUniform3f("lightingAmbientSH0",e.r[0],e.g[0],e.b[0]),d.setUniform4f("lightingAmbientSH_R1",e.r[1],e.r[2],e.r[3],e.r[4]),d.setUniform4f("lightingAmbientSH_G1",e.g[1],e.g[2],e.g[3],e.g[4]),d.setUniform4f("lightingAmbientSH_B1",e.b[1],e.b[2],e.b[3],e.b[4]),d.setUniform4f("lightingAmbientSH_R2",e.r[5],e.r[6],e.r[7],e.r[8]),d.setUniform4f("lightingAmbientSH_G2",e.g[5],e.g[6],e.g[7],e.g[8]),d.setUniform4f("lightingAmbientSH_B2",e.b[5],e.b[6],e.b[7],e.b[8]))};g.prototype.set=function(g){this._info=
g;m.combineLights(g.lights,this._shOrder,this._renderLighting);e.vec3.negate(this._oldSunlight.direction,this._renderLighting.main.direction);g=1/Math.PI;this._oldSunlight.ambient.color[0]=.282095*this._renderLighting.sphericalHarmonics.sh.r[0]*g;this._oldSunlight.ambient.color[1]=.282095*this._renderLighting.sphericalHarmonics.sh.g[0]*g;this._oldSunlight.ambient.color[2]=.282095*this._renderLighting.sphericalHarmonics.sh.b[0]*g;this._oldSunlight.ambient.intensity=1;this._oldSunlight.diffuse.color[0]=
this._renderLighting.main.intensity[0]*g;this._oldSunlight.diffuse.color[1]=this._renderLighting.main.intensity[1]*g;this._oldSunlight.diffuse.color[2]=this._renderLighting.main.intensity[2]*g;this._oldSunlight.diffuse.intensity=1;g=e.vec3.copy(d,this._oldSunlight.diffuse.color);e.vec3.scale(g,g,.4*this._info.globalFactor);e.vec3.add(this._oldSunlight.ambient.color,this._oldSunlight.ambient.color,g)};Object.defineProperty(g.prototype,"globalFactor",{get:function(){return this._info.globalFactor},
enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"old",{get:function(){return this._oldSunlight},enumerable:!0,configurable:!0});return g}();f.SceneLighting=u})},"esri/views/3d/webgl-engine/lighting/SphericalHarmonics":function(){define("require exports ../../../../core/mathUtils ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../lib/LongVectorMath ./Lightsources".split(" "),function(u,f,e,r,m,d,g){function k(a){return(a+1)*(a+1)}function l(a){return e.clamp(Math.floor(Math.sqrt(a)-
1),0,2)}function c(a,b,c){var d=a[0],e=a[1];a=a[2];c=c||[];c.length=k(b);0<=b&&(c[0]=.28209479177);1<=b&&(c[1]=.4886025119*d,c[2]=.4886025119*a,c[3]=.4886025119*e);2<=b&&(c[4]=1.09254843059*d*e,c[5]=1.09254843059*e*a,c[6]=.31539156525*(3*a*a-1),c[7]=1.09254843059*d*a,c[8]=.54627421529*(d*d-e*e));return c}function a(a,b){a=k(a);b=b||{r:[],g:[],b:[]};b.r.length=b.g.length=b.b.length=a;for(var c=0;c<a;c++)b.r[c]=b.g[c]=b.b[c]=0;return b}function b(a,b){for(var e=l(b.r.length),g=0;g<a.length;g++){var f=
a[g];r.vec3.negate(E,f.direction);c(E,e,z);d.elementwiseProduct(z,H);d.scalarProduct(z,f.intensity[0],A);d.add(b.r,A);d.scalarProduct(z,f.intensity[1],A);d.add(b.g,A);d.scalarProduct(z,f.intensity[2],A);d.add(b.b,A)}return b}function q(a,b){c(E,0,z);for(var d=0;d<a.length;d++){var e=a[d];b.r[0]+=z[0]*H[0]*e.intensity[0]*4*Math.PI;b.g[0]+=z[0]*H[0]*e.intensity[1]*4*Math.PI;b.b[0]+=z[0]*H[0]*e.intensity[2]*4*Math.PI}return b}Object.defineProperty(f,"__esModule",{value:!0});f.numberOfCoefficients=k;
f.numberOfCoefficientsInBand=function(a){return 2*a+1};f.orderFromNumberOfCoefficients=l;f.computeCoefficients=c;f.initSHCoefficients=a;f.projectFillLights=b;f.projectAmbientLights=q;f.combineLights=function(c,e,f){a(e,f.sphericalHarmonics.sh);r.vec3.set(f.main.intensity,0,0,0);var k=!1,l=v,m=t;e=x;l.length=0;m.length=0;for(var z=e.length=0;z<c.length;z++){var A=c[z];A instanceof g.MainLight&&!k?(r.vec3.copy(f.main.direction,A.direction),f.main.intensity[0]=A.intensity[0],f.main.intensity[1]=A.intensity[1],
f.main.intensity[2]=A.intensity[2],f.main.castShadows=A.castShadows,k=!0):A instanceof g.MainLight||A instanceof g.FillLight?l.push(A):A instanceof g.AmbientLight?m.push(A):A instanceof g.SphericalHarmonicsLight&&e.push(A)}b(l,f.sphericalHarmonics.sh);q(m,f.sphericalHarmonics.sh);for(c=0;c<e.length;c++)A=e[c],d.add(f.sphericalHarmonics.sh.r,A.sh.r),d.add(f.sphericalHarmonics.sh.g,A.sh.g),d.add(f.sphericalHarmonics.sh.b,A.sh.b)};var v=[],t=[],x=[],z=[0],A=[0],E=m.vec3f64.create(),H=[3.141593,2.094395,
2.094395,2.094395,.785398,.785398,.785398,.785398,.785398]})},"esri/views/3d/webgl-engine/lib/LongVectorMath":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});f.dotProduct=function(e,f){for(var m=0,d=0;d<e.length;d++)m+=e[d]*f[d];return m};f.elementwiseProduct=function(e,f,m){m=m||e;m.length=e.length;for(var d=0;d<e.length;d++)m[d]=e[d]*f[d];return m};f.scalarProduct=function(e,f,m){m=m||e;m.length=e.length;for(var d=0;d<e.length;d++)m[d]=e[d]*
f;return m};f.add=function(e,f,m){m=m||e;m.length=e.length;for(var d=0;d<e.length;d++)m[d]=e[d]+f[d];return m}})},"esri/views/3d/webgl-engine/materials/lineStippleUtils":function(){define(["require","exports","../../../../core/maybe","../../../webgl"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function f(){this.cache=new Map}f.prototype.dispose=function(){this.cache.forEach(function(d){e.isSome(d.texture)&&(d.texture.dispose(),d.texture=null)});this.cache.clear()};
f.prototype.acquire=function(d){if(e.isNone(d))return null;var g=this.patternId(d),f=this.cache.get(g);if(f)return f.refCount++,f.bind;var l=this.patternToTextureData(d,2),c=l.length/2,a={refCount:1,texture:null,bind:function(b,d){e.isNone(a.texture)&&(a.texture=new r.Texture(b,{width:l.length,height:1,internalFormat:6406,pixelFormat:6406,dataType:5121,wrapMode:33071},l));b.bindTexture(a.texture,d);return c}};this.cache.set(g,a);return a.bind};f.prototype.release=function(d){if(!e.isNone(d)){d=this.patternId(d);
var g=this.cache.get(d);g&&(g.refCount--,0===g.refCount&&(e.isSome(g.texture)&&g.texture.dispose(),this.cache.delete(d)))}};f.prototype.swap=function(d,e){e=this.acquire(e);this.release(d);return e};f.prototype.bind=function(d,g,f,l,c){d=e.isSome(l)?l(d,c)*g.pixelRatio:1;f.setUniform1i("stipplePatternTexture",c);f.setUniform1f("stipplePatternPixelSizeInv",1/d)};f.prototype.patternId=function(d){return d.join(",")};f.prototype.patternToTextureData=function(d,e){for(var g=d.reduce(function(a,b){return a+
b})*e,g=new Uint8Array(g),f=!0,c=0,a=0;a<d.length;a++){for(var b=d[a],q=0;q<b*e;q++)g[c++]=f?255:0;f=!f}return g};return f}();f.StippleTextureRepository=u;f.createStipplePattern=function(f){return e.isNone(f)?f:f.slice()};f.createStipplePatternSimple=function(e){return[e,e]}})},"esri/views/webgl":function(){define("require exports ./webgl/BufferObject ./webgl/FramebufferObject ./webgl/Program ./webgl/Renderbuffer ./webgl/RenderingContext ./webgl/ShaderCompiler ./webgl/Texture ./webgl/VertexArrayObject ./webgl/ProgramCache ./webgl/programUtils ./webgl/context-util".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q){Object.defineProperty(f,"__esModule",{value:!0});f.BufferObject=e;f.FramebufferObject=r;f.Program=m;f.Renderbuffer=d;f.RenderingContext=g;f.ShaderCompiler=k;f.Texture=l;f.VertexArrayObject=c;f.ProgramCache=a.ProgramCache;f.createProgram=b.createProgram;f.glslifyDefineMap=b.glslifyDefineMap;f.createContextOrErrorHTML=q.createContextOrErrorHTML})},"esri/views/webgl/FramebufferObject":function(){define(["require","exports","../../core/has","./Renderbuffer","./Texture"],
function(u,f,e,r,m){return function(){function d(e,f,l,c){this._colorAttachment=this._stencilAttachment=this._depthAttachment=this._glName=this._context=null;this._initialized=!1;this._context=e;this._desc={colorTarget:f.colorTarget,depthStencilTarget:f.depthStencilTarget,width:f.width,height:f.height,multisampled:f.multisampled};this._id=d._nextId++;l&&(e=void 0,l instanceof m?(this._colorAttachment=l,e=l.descriptor):(e=l,this._colorAttachment=new m(this._context,e)),0!==this._desc.colorTarget&&
console.error("Framebuffer is initialized with a texture however the descriptor indicates using a renderbuffer color attachment!"),d._validateTextureDimensions(e,this._desc));c instanceof r?(2===f.depthStencilTarget?this._stencilAttachment=c:1===f.depthStencilTarget||3===f.depthStencilTarget?this._depthAttachment=c:console.error('If a Renderbuffer is provided, "depthStencilTarget" must be one of STENCIL_RENDER_BUFFER, DEPTH_RENDER_BUFFER or DEPTH_STENCIL_RENDER_BUFFER'),d._validateBufferDimensions(c.descriptor,
this._desc)):c&&(this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),f=void 0,c instanceof m?(this._depthStencilTexture=c,f=this._depthStencilTexture.descriptor):(f=c,this._depthStencilTexture=new m(this._context,f)),d._validateTextureDimensions(f,this._desc))}Object.defineProperty(d.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"colorTexture",{get:function(){return this._colorAttachment instanceof m?this._colorAttachment:null},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"colorAttachment",{get:function(){return this._colorAttachment},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"depthStencilAttachment",{get:function(){return this._depthStencilTexture||this._depthAttachment||this._stencilAttachment},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"depthStencilTexture",{get:function(){return this._depthStencilTexture},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"width",{get:function(){return this._desc.width},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"height",{get:function(){return this._desc.height},enumerable:!0,
configurable:!0});d.prototype.dispose=function(){if(this._context){var d=this._context,e=d.getBoundFramebufferObject();this._disposeColorAttachment();this._disposeDepthStencilAttachments();this._glName&&(d.gl.deleteFramebuffer(this._glName),this._glName=null);d.bindFramebuffer(e);this._context=null}};d.prototype.attachColorTexture=function(e){if(e){d._validateTextureDimensions(e.descriptor,this._desc);this._disposeColorAttachment();if(this._initialized){this._context.bindFramebuffer(this);var g=this._context.gl;
g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,e.glName,0)}this._colorAttachment=e}};d.prototype.detachColorTexture=function(){if(this._colorAttachment instanceof m){var d=this._colorAttachment;if(this._initialized){this._context.bindFramebuffer(this);var e=this._context.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}this._colorAttachment=null;return d}};d.prototype.attachDepthStencilTexture=function(e){if(e){var g=e.descriptor;34041!==g.pixelFormat&&
console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!");34042!==g.dataType&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8_WEBGL!");this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!");d._validateTextureDimensions(g,this._desc);4!==this._desc.depthStencilTarget&&(this._desc.depthStencilTarget=4);this._disposeDepthStencilAttachments();
this._initialized&&(this._context.bindFramebuffer(this),g=this._context.gl,g.framebufferTexture2D(g.FRAMEBUFFER,g.DEPTH_STENCIL_ATTACHMENT,g.TEXTURE_2D,e.glName,0));this._depthStencilTexture=e}};d.prototype.detachDepthStencilTexture=function(){var d=this._depthStencilTexture;if(d&&this._initialized){this._context.bindFramebuffer(this);var e=this._context.gl;this._context.gl.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,null,0)}this._depthStencilTexture=null;return d};
d.prototype.attachDepthStencilBuffer=function(e){if(e){var g=e.descriptor;34041!==g.internalFormat&&33189!==g.internalFormat&&console.error("Depth/Stencil buffer must have correct internalFormat");d._validateBufferDimensions(g,this._desc);this._disposeDepthStencilAttachments();this._desc.depthStencilTarget=34041===g.internalFormat?3:1;this._initialized&&(this._context.bindFramebuffer(this),g=this._context.gl,g.framebufferRenderbuffer(g.FRAMEBUFFER,1===this._desc.depthStencilTarget?g.DEPTH_ATTACHMENT:
g.DEPTH_STENCIL_ATTACHMENT,g.RENDERBUFFER,e.glName));this._depthAttachment=e}};d.prototype.detachDepthStencilBuffer=function(){var d=this._context.gl,e=this._depthAttachment;e&&this._initialized&&(this._context.bindFramebuffer(this),d.framebufferRenderbuffer(d.FRAMEBUFFER,1===this._desc.depthStencilTarget?d.DEPTH_ATTACHMENT:d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,null));this._depthAttachment=null;return e};d.prototype.copyToTexture=function(d,e,f,c,a,b,q){(0>d||0>e||0>a||0>b)&&console.error("Offsets cannot be negative!");
(0>=f||0>=c)&&console.error("Copy width and height must be greater than zero!");var g=this._desc,k=q.descriptor;3553!==q.descriptor.target&&console.error("Texture target must be TEXTURE_2D!");(d+f>g.width||e+c>g.height||a+f>k.width||b+c>k.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");g=this._context;g.bindTexture(q);g.bindFramebuffer(this);g.gl.copyTexSubImage2D(3553,0,a,b,d,e,f,c)};d.prototype.readPixels=function(d,e,f,c,a,b,q){(0>=
f||0>=c)&&console.error("Copy width and height must be greater than zero!");q||console.error("Target memory is not initialized!");this._context.bindFramebuffer(this);this._context.gl.readPixels(d,e,f,c,a,b,q)};d.prototype.resize=function(e,f){var g=this._desc;if(g.width!==e||g.height!==f)if(this._initialized){g.width=e;g.height=f;this._colorAttachment instanceof m?(c=this._colorAttachment,g=c.descriptor,g.width=e,g.height=f,this._colorAttachment.dispose(),this._colorAttachment=new m(this._context,
g),d._validateTextureDimensions(c.descriptor,this._desc)):this._colorAttachment&&this._disposeColorAttachment();if(null!=this._depthStencilTexture)g=this._depthStencilTexture.descriptor,g.width=e,g.height=f,this._depthStencilTexture.dispose(),this._depthStencilTexture=new m(this._context,g);else if(this._depthAttachment||this._stencilAttachment)this._depthAttachment&&this._depthAttachment.resize(e,f),this._stencilAttachment&&this._stencilAttachment.resize(e,f);this._context.getBoundFramebufferObject()===
this&&this._context.bindFramebuffer(null);this._initialized=!1}else{g.width=e;g.height=f;if(this._colorAttachment instanceof m){var c=this._colorAttachment;c.resize(e,f)}this._depthStencilTexture&&this._depthStencilTexture.resize(e,f)}};d.prototype.initialize=function(){if(this._initialized)return!1;var d=this._context.gl;this._glName&&d.deleteFramebuffer(this._glName);var e=d.createFramebuffer(),f=this._desc;d.bindFramebuffer(d.FRAMEBUFFER,e);if(!this._colorAttachment)if(0===f.colorTarget)this._colorAttachment=
new m(this._context,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:f.width,height:f.height});else{var c=new r(this._context,{internalFormat:32854,width:f.width,height:f.height});d.framebufferRenderbuffer(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.RENDERBUFFER,c.glName);this._colorAttachment=c}this._colorAttachment instanceof m&&d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,this._colorAttachment.glName,0);switch(f.depthStencilTarget){case 1:case 3:this._depthAttachment||
(this._depthAttachment=new r(this._context,{internalFormat:1===f.depthStencilTarget?33189:34041,width:f.width,height:f.height}));d.framebufferRenderbuffer(d.FRAMEBUFFER,1===f.depthStencilTarget?d.DEPTH_ATTACHMENT:d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,this._depthAttachment.glName);break;case 2:this._stencilAttachment||(this._stencilAttachment=new r(this._context,{internalFormat:36168,width:f.width,height:f.height}));d.framebufferRenderbuffer(d.FRAMEBUFFER,d.STENCIL_ATTACHMENT,d.RENDERBUFFER,this._stencilAttachment.glName);
break;case 4:this._depthStencilTexture||(this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),this._depthStencilTexture=new m(this._context,{target:3553,pixelFormat:34041,dataType:34042,samplingMode:9728,wrapMode:33071,width:f.width,height:f.height})),d.framebufferTexture2D(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.TEXTURE_2D,this._depthStencilTexture.glName,0)}this._glName=
e;return this._initialized=!0};d.prototype._disposeColorAttachment=function(){if(this._colorAttachment instanceof m){var d=this._colorAttachment;if(this._initialized){this._context.bindFramebuffer(this);var e=this._context.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}d.dispose()}else this._colorAttachment instanceof WebGLRenderbuffer&&(d=this._colorAttachment,e=this._context.gl,this._initialized&&(this._context.bindFramebuffer(this),e.framebufferRenderbuffer(e.FRAMEBUFFER,
e.COLOR_ATTACHMENT0,e.RENDERBUFFER,null)),this._context.gl.deleteRenderbuffer(d));this._colorAttachment=null};d.prototype._disposeDepthStencilAttachments=function(){var d=this._context.gl;this._depthAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),d.framebufferRenderbuffer(d.FRAMEBUFFER,1===this._desc.depthStencilTarget?d.DEPTH_ATTACHMENT:d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,null)),this._depthAttachment.dispose(),this._depthAttachment=null);this._stencilAttachment&&(this._initialized&&
(this._context.bindFramebuffer(this),d.framebufferRenderbuffer(d.FRAMEBUFFER,d.STENCIL_ATTACHMENT,d.RENDERBUFFER,null)),this._stencilAttachment.dispose(),this._stencilAttachment=null);this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),d.framebufferTexture2D(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.TEXTURE_2D,null,0)),this._depthStencilTexture.dispose(),this._depthStencilTexture=null)};d._validateBufferDimensions=function(d,e){console.assert(0<=d.width&&0<=d.height);
void 0!==e.width&&0<=e.width&&void 0!==e.height&&0<=e.height?e.width===d.width&&e.height===d.height||console.error("Renderbuffer dimensions must match the framebuffer's!"):(e.width=d.width,e.height=d.height)};d._validateTextureDimensions=function(d,e){console.assert(0<=d.width&&0<=d.height);3553!==d.target&&console.error("Texture type must be TEXTURE_2D!");void 0!==e.width&&0<=e.width&&void 0!==e.height&&0<=e.height?e.width===d.width&&e.height===d.height||console.error("Color attachment texture must match the framebuffer's!"):
(e.width=d.width,e.height=d.height)};d._nextId=0;return d}()})},"esri/views/webgl/Renderbuffer":function(){define(["require","exports","../../core/has"],function(u,f,e){return function(){function e(f,d){this._context=f;this._desc=d;this._glName=null;this._id=-1;f=this._context.gl;this._id=++e._nextId;this._glName=f.createRenderbuffer();this._context.bindRenderbuffer(this);f.renderbufferStorage(f.RENDERBUFFER,d.internalFormat,d.width,d.height)}Object.defineProperty(e.prototype,"descriptor",{get:function(){return this._desc},
enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});e.prototype.resize=function(e,d){var g=this._context.gl,f=this._desc;if(f.width!==e||f.height!==d)f.width=e,f.height=d,this._context.bindRenderbuffer(this),g.renderbufferStorage(g.RENDERBUFFER,f.internalFormat,f.width,f.height)};e.prototype.dispose=function(){this._glName&&
(this._context.gl.deleteRenderbuffer(this._glName),this._glName=null);this._context=null};e._nextId=0;return e}()})},"esri/views/webgl/RenderingContext":function(){define("require exports ../../core/has ../../core/maybe ./enums ./InstanceCounter ./renderState ./capabilities/isWebGL2Context ./capabilities/load".split(" "),function(u,f,e,r,m,d,g,k,l){return function(){function c(a,b){var c=this;this.gl=null;this._blendEnabled=!1;this._blendColorState={r:0,g:0,b:0,a:0};this._blendFunctionState={srcRGB:1,
dstRGB:0,srcAlpha:1,dstAlpha:0};this._blendEquationState={mode:32774,modeAlpha:32774};this._colorMaskState={r:!0,g:!0,b:!0,a:!0};this._polygonCullingEnabled=!1;this._cullFace=1029;this._frontFace=2305;this._scissorTestEnabled=!1;this._scissorRect={x:0,y:0,width:0,height:0};this._depthTestEnabled=!1;this._depthFunction=513;this._clearDepth=1;this._depthWriteEnabled=!0;this._depthRange={zNear:0,zFar:1};this._viewport=null;this._polygonOffsetFillEnabled=this._stencilTestEnabled=!1;this._polygonOffset=
[0,0];this._stencilFunction={face:1032,func:519,ref:0,mask:1};this._clearStencil=0;this._stencilWriteMask=1;this._stencilOperation={face:1032,fail:7680,zFail:7680,zPass:7680};this._clearColor={r:0,g:0,b:0,a:0};this._activeRenderbuffer=this._activeFramebuffer=this._activeIndexBuffer=this._activeVertexBuffer=this._activeShaderProgram=null;this._activeTextureUnit=0;this._textureUnitMap={};this._numOfTriangles=this._numOfDrawCalls=0;this.contextVersion=k.default(a)?"webgl2":"webgl";this.gl=a;a instanceof
WebGLRenderingContext&&this.gl.getExtension("OES_element_index_uint");this._capabilities=l.loadCapabilities(a,b);a=this.gl.getParameter(this.gl.VIEWPORT);this._viewport={x:a[0],y:a[1],width:a[2],height:a[3]};this._stateTracker=new g.StateTracker({setBlending:function(a){a?(c.setBlendingEnabled(!0),c.setBlendEquationSeparate(a.opRgb,a.opAlpha),c.setBlendFunctionSeparate(a.srcRgb,a.dstRgb,a.srcAlpha,a.dstAlpha),a=a.color,c.setBlendColor(a.r,a.g,a.b,a.a)):c.setBlendingEnabled(!1)},setCulling:function(a){a?
(c.setFaceCullingEnabled(!0),c.setCullFace(a.face),c.setFrontFace(a.mode)):c.setFaceCullingEnabled(!1)},setPolygonOffset:function(a){a?(c.setPolygonOffsetFillEnabled(!0),c.setPolygonOffset(a.factor,a.units)):c.setPolygonOffsetFillEnabled(!1)},setDepthTest:function(a){a?(c.setDepthTestEnabled(!0),c.setDepthFunction(a.func)):c.setDepthTestEnabled(!1)},setStencilTest:function(a){if(a){c.setStencilTestEnabled(!0);var b=a.function;c.setStencilFunction(b.func,b.ref,b.mask);a=a.operation;c.setStencilOp(a.fail,
a.zFail,a.zPass)}else c.setStencilTestEnabled(!1)},setDepthWrite:function(a){a?(c.setDepthWriteEnabled(!0),c.setDepthRange(a.zNear,a.zFar)):c.setDepthWriteEnabled(!1)},setColorWrite:function(a){a?c.setColorMask(a.r,a.g,a.b,a.a):c.setColorMask(!1,!1,!1,!1)},setStencilWrite:function(a){a?c.setStencilWriteMask(a.mask):c.setStencilWriteMask(0)}});this.enforceState()}Object.defineProperty(c.prototype,"contextAttributes",{get:function(){return this.gl.getContextAttributes()},enumerable:!0,configurable:!0});
Object.defineProperty(c.prototype,"parameters",{get:function(){if(!this._parameters){var a=this.capabilities.textureFilterAnisotropic;this._parameters={versionString:this.gl.getParameter(this.gl.VERSION),maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:a?this.gl.getParameter(a.MAX_TEXTURE_MAX_ANISOTROPY):void 0,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),
maxTextureSize:this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE)}}return this._parameters},enumerable:!0,configurable:!0});c.prototype.dispose=function(){this.bindVAO(null);this.unbindBuffer(34962);this.unbindBuffer(34963);this._textureUnitMap={};this.gl=null};c.prototype.setPipelineState=function(a){this._stateTracker.setPipeline(a)};c.prototype.setBlendingEnabled=function(a){this._blendEnabled!==a&&(!0===a?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._blendEnabled=a,this._stateTracker.invalidateBlending())};
c.prototype.setBlendColor=function(a,b,c,d){if(a!==this._blendColorState.r||b!==this._blendColorState.g||c!==this._blendColorState.b||d!==this._blendColorState.a)this.gl.blendColor(a,b,c,d),this._blendColorState.r=a,this._blendColorState.g=b,this._blendColorState.b=c,this._blendColorState.a=d,this._stateTracker.invalidateBlending()};c.prototype.setBlendFunction=function(a,b){if(a!==this._blendFunctionState.srcRGB||b!==this._blendFunctionState.dstRGB)this.gl.blendFunc(a,b),this._blendFunctionState.srcRGB=
a,this._blendFunctionState.srcAlpha=a,this._blendFunctionState.dstRGB=b,this._blendFunctionState.dstAlpha=b,this._stateTracker.invalidateBlending()};c.prototype.setBlendFunctionSeparate=function(a,b,c,d){if(this._blendFunctionState.srcRGB!==a||this._blendFunctionState.srcAlpha!==c||this._blendFunctionState.dstRGB!==b||this._blendFunctionState.dstAlpha!==d)this.gl.blendFuncSeparate(a,b,c,d),this._blendFunctionState.srcRGB=a,this._blendFunctionState.srcAlpha=c,this._blendFunctionState.dstRGB=b,this._blendFunctionState.dstAlpha=
d,this._stateTracker.invalidateBlending()};c.prototype.setBlendEquation=function(a){this._blendEquationState.mode!==a&&(this.gl.blendEquation(a),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=a,this._stateTracker.invalidateBlending())};c.prototype.setBlendEquationSeparate=function(a,b){if(this._blendEquationState.mode!==a||this._blendEquationState.modeAlpha!==b)this.gl.blendEquationSeparate(a,b),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=b,this._stateTracker.invalidateBlending()};
c.prototype.setColorMask=function(a,b,c,d){if(this._colorMaskState.r!==a||this._colorMaskState.g!==b||this._colorMaskState.b!==c||this._colorMaskState.a!==d)this.gl.colorMask(a,b,c,d),this._colorMaskState.r=a,this._colorMaskState.g=b,this._colorMaskState.b=c,this._colorMaskState.a=d,this._stateTracker.invalidateColorWrite()};c.prototype.setClearColor=function(a,b,c,d){if(this._clearColor.r!==a||this._clearColor.g!==b||this._clearColor.b!==c||this._clearColor.a!==d)this.gl.clearColor(a,b,c,d),this._clearColor.r=
a,this._clearColor.g=b,this._clearColor.b=c,this._clearColor.a=d};c.prototype.setFaceCullingEnabled=function(a){this._polygonCullingEnabled!==a&&(!0===a?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._polygonCullingEnabled=a,this._stateTracker.invalidateCulling())};c.prototype.setPolygonOffsetFillEnabled=function(a){this._polygonOffsetFillEnabled!==a&&(!0===a?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._polygonOffsetFillEnabled=
a,this._stateTracker.invalidatePolygonOffset())};c.prototype.setPolygonOffset=function(a,b){if(this._polygonOffset[0]!==a||this._polygonOffset[1]!==b)this._polygonOffset[0]=a,this._polygonOffset[1]=b,this.gl.polygonOffset(a,b),this._stateTracker.invalidatePolygonOffset()};c.prototype.setCullFace=function(a){this._cullFace!==a&&(this.gl.cullFace(a),this._cullFace=a,this._stateTracker.invalidateCulling())};c.prototype.setFrontFace=function(a){this._frontFace!==a&&(this.gl.frontFace(a),this._frontFace=
a,this._stateTracker.invalidateCulling())};c.prototype.setScissorTestEnabled=function(a){this._scissorTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._scissorTestEnabled=a)};c.prototype.setScissorRect=function(a,b,c,d){if(this._scissorRect.x!==a||this._scissorRect.y!==b||this._scissorRect.width!==c||this._scissorRect.height!==d)this.gl.scissor(a,b,c,d),this._scissorRect.x=a,this._scissorRect.y=b,this._scissorRect.width=c,this._scissorRect.height=
d};c.prototype.setDepthTestEnabled=function(a){this._depthTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._depthTestEnabled=a,this._stateTracker.invalidateDepthTest())};c.prototype.setClearDepth=function(a){this._clearDepth!==a&&(this.gl.clearDepth(a),this._clearDepth=a)};c.prototype.setDepthFunction=function(a){this._depthFunction!==a&&(this.gl.depthFunc(a),this._depthFunction=a,this._stateTracker.invalidateDepthTest())};c.prototype.setDepthWriteEnabled=
function(a){this._depthWriteEnabled!==a&&(this.gl.depthMask(a),this._depthWriteEnabled=a,this._stateTracker.invalidateDepthWrite())};c.prototype.setDepthRange=function(a,b){if(this._depthRange.zNear!==a||this._depthRange.zFar!==b)this.gl.depthRange(a,b),this._depthRange.zNear=a,this._depthRange.zFar=b,this._stateTracker.invalidateDepthWrite()};c.prototype.setStencilTestEnabled=function(a){this._stencilTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),
this._stencilTestEnabled=a,this._stateTracker.invalidateStencilTest())};c.prototype.setClearStencil=function(a){a!==this._clearStencil&&(this.gl.clearStencil(a),this._clearStencil=a)};c.prototype.setStencilFunction=function(a,b,c){if(this._stencilFunction.func!==a||this._stencilFunction.ref!==b||this._stencilFunction.mask!==c)this.gl.stencilFunc(a,b,c),this._stencilFunction.face=1032,this._stencilFunction.func=a,this._stencilFunction.ref=b,this._stencilFunction.mask=c,this._stateTracker.invalidateStencilTest()};
c.prototype.setStencilFunctionSeparate=function(a,b,c,d){if(this._stencilFunction.face!==a||this._stencilFunction.func!==b||this._stencilFunction.ref!==c||this._stencilFunction.mask!==d)this.gl.stencilFuncSeparate(a,b,c,d),this._stencilFunction.face=a,this._stencilFunction.func=b,this._stencilFunction.ref=c,this._stencilFunction.mask=d,this._stateTracker.invalidateStencilTest()};c.prototype.setStencilWriteMask=function(a){this._stencilWriteMask!==a&&(this.gl.stencilMask(a),this._stencilWriteMask=
a,this._stateTracker.invalidateStencilWrite())};c.prototype.setStencilOp=function(a,b,c){if(this._stencilOperation.fail!==a||this._stencilOperation.zFail!==b||this._stencilOperation.zPass!==c)this.gl.stencilOp(a,b,c),this._stencilOperation.face=1032,this._stencilOperation.fail=a,this._stencilOperation.zFail=b,this._stencilOperation.zPass=c,this._stateTracker.invalidateStencilTest()};c.prototype.setStencilOpSeparate=function(a,b,c,d){if(this._stencilOperation.face!==a||this._stencilOperation.fail!==
b||this._stencilOperation.zFail!==c||this._stencilOperation.zPass!==d)this.gl.stencilOpSeparate(a,b,c,d),this._stencilOperation.face=a,this._stencilOperation.face=a,this._stencilOperation.fail=b,this._stencilOperation.zFail=c,this._stencilOperation.zPass=d,this._stateTracker.invalidateStencilTest()};c.prototype.setActiveTexture=function(a){var b=this._activeTextureUnit;0<=a&&a!==this._activeTextureUnit&&(this.gl.activeTexture(m.BASE_TEXTURE_UNIT+a),this._activeTextureUnit=a);return b};c.prototype.clear=
function(a){a&&this.gl.clear(a)};c.prototype.clearSafe=function(a,b){void 0===b&&(b=255);a&&(a&16384&&this.setColorMask(!0,!0,!0,!0),a&256&&this.setDepthWriteEnabled(!0),a&1024&&this.setStencilWriteMask(b),this.gl.clear(a))};c.prototype.drawArrays=function(a,b,c){this.gl.drawArrays(a,b,c)};c.prototype.drawElements=function(a,b,c,d){5123===c?this.gl.drawElements(a,b,c,d):5125===c&&this.gl.drawElements(a,b,c,d)};c.prototype.logIno=function(){};Object.defineProperty(c.prototype,"capabilities",{get:function(){return this._capabilities},
enumerable:!0,configurable:!0});c.prototype.setViewport=function(a,b,c,d){var e=this._viewport;if(e.x!==a||e.y!==b||e.width!==c||e.height!==d)e.x=a,e.y=b,e.width=c,e.height=d,this.gl.viewport(a,b,c,d)};c.prototype.getViewport=function(){return{x:this._viewport.x,y:this._viewport.y,width:this._viewport.width,height:this._viewport.height}};c.prototype.bindProgram=function(a){a?this._activeShaderProgram!==a&&(a.initialize(),this.gl.useProgram(a.glName),this._activeShaderProgram=a):(this.gl.useProgram(null),
this._activeShaderProgram=null)};c.prototype.bindTexture=function(a,b){void 0===b&&(b=0);-1===c._MAX_TEXTURE_IMAGE_UNITS&&(c._MAX_TEXTURE_IMAGE_UNITS=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS));(b>=c._MAX_TEXTURE_IMAGE_UNITS||0>b)&&console.error("Input texture unit is out of range of available units!");var d=this._textureUnitMap[b];this.setActiveTexture(b);null==a||null==a.glName?(null!=d&&(this.gl.bindTexture(d.descriptor.target,null),d.setBoundToUnit(b,!1)),this._textureUnitMap[b]=null):
d&&d.id===a.id?a.applyChanges():(d&&d.setBoundToUnit(b,!1),this.gl.bindTexture(a.descriptor.target,a.glName),a.setBoundToUnit(b,!0),a.applyChanges(),this._textureUnitMap[b]=a)};c.prototype.bindFramebuffer=function(a){r.isNone(a)?(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this._activeFramebuffer=null):this._activeFramebuffer!==a&&(a.initialize()||this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,a.glName),this._activeFramebuffer=a)};c.prototype.bindBuffer=function(a){a&&(34962===a.bufferType?this._activeVertexBuffer=
c._bindBuffer(this.gl,a,a.bufferType,this._activeVertexBuffer):this._activeIndexBuffer=c._bindBuffer(this.gl,a,a.bufferType,this._activeIndexBuffer))};c.prototype.bindRenderbuffer=function(a){var b=this.gl;a||(b.bindRenderbuffer(b.RENDERBUFFER,null),this._activeRenderbuffer=null);this._activeRenderbuffer!==a&&(b.bindRenderbuffer(b.RENDERBUFFER,a.glName),this._activeRenderbuffer=a)};c.prototype.unbindBuffer=function(a){34962===a?this._activeVertexBuffer=c._bindBuffer(this.gl,null,a,this._activeVertexBuffer):
this._activeIndexBuffer=c._bindBuffer(this.gl,null,a,this._activeIndexBuffer)};c.prototype.bindVAO=function(a){a?this._activeVertexArrayObject&&this._activeVertexArrayObject.id===a.id||(a.bind(),this._activeVertexArrayObject=a):this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null)};c.prototype.getBoundTexture=function(a){return this._textureUnitMap[a]};c.prototype.getBoundFramebufferObject=function(){return this._activeFramebuffer};c.prototype.getBoundVAO=
function(){return this._activeVertexArrayObject};c.prototype.resetState=function(){this.bindProgram(null);this.bindVAO(null);this.bindFramebuffer(null);this.unbindBuffer(34962);this.unbindBuffer(34963);for(var a=0;a<this.parameters.maxTextureImageUnits;a++)this.bindTexture(null,a);this.setBlendingEnabled(!1);this.setBlendFunction(1,0);this.setBlendEquation(32774);this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);this.setCullFace(1029);this.setFrontFace(2305);this.setPolygonOffsetFillEnabled(!1);
this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(513);this.setDepthRange(0,1);this.setStencilTestEnabled(!1);this.setStencilFunction(519,0,0);this.setStencilOp(7680,7680,7680);this.setClearColor(0,0,0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,
this.gl.canvas.height)};c.prototype.enforceState=function(){var a=this.gl,b=this.capabilities.vao;b&&b.bindVertexArray(null);for(var c=0;c<this.parameters.maxVertexAttributes;c++)a.disableVertexAttribArray(c);this._activeVertexBuffer?a.bindBuffer(this._activeVertexBuffer.bufferType,this._activeVertexBuffer.glName):a.bindBuffer(34962,null);this._activeIndexBuffer?a.bindBuffer(this._activeIndexBuffer.bufferType,this._activeIndexBuffer.glName):a.bindBuffer(34963,null);if(b&&this._activeVertexArrayObject){if(b=
this._activeVertexArrayObject)this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null;this.bindVAO(b)}a.bindFramebuffer(a.FRAMEBUFFER,this._activeFramebuffer?this._activeFramebuffer.glName:null);a.useProgram(this._activeShaderProgram?this._activeShaderProgram.glName:null);a.blendColor(this._blendColorState.r,this._blendColorState.g,this._blendColorState.b,this._blendColorState.a);a.bindRenderbuffer(a.RENDERBUFFER,this._activeRenderbuffer?this._activeRenderbuffer.glName:null);!0===
this._blendEnabled?a.enable(this.gl.BLEND):a.disable(this.gl.BLEND);a.blendEquationSeparate(this._blendEquationState.mode,this._blendEquationState.modeAlpha);a.blendFuncSeparate(this._blendFunctionState.srcRGB,this._blendFunctionState.dstRGB,this._blendFunctionState.srcAlpha,this._blendFunctionState.dstAlpha);a.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a);a.clearDepth(this._clearDepth);a.clearStencil(this._clearStencil);a.colorMask(this._colorMaskState.r,
this._colorMaskState.g,this._colorMaskState.b,this._colorMaskState.a);a.cullFace(this._cullFace);a.depthFunc(this._depthFunction);a.depthRange(this._depthRange.zNear,this._depthRange.zFar);!0===this._depthTestEnabled?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST);a.depthMask(this._depthWriteEnabled);a.frontFace(this._frontFace);a.lineWidth(1);!0===this._polygonCullingEnabled?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE);a.polygonOffset(this._polygonOffset[0],this._polygonOffset[1]);!0===this._polygonOffsetFillEnabled?
a.enable(a.POLYGON_OFFSET_FILL):a.disable(a.POLYGON_OFFSET_FILL);a.scissor(this._scissorRect.x,this._scissorRect.y,this._scissorRect.width,this._scissorRect.height);!0===this._scissorTestEnabled?a.enable(a.SCISSOR_TEST):a.disable(a.SCISSOR_TEST);a.stencilFunc(this._stencilFunction.func,this._stencilFunction.ref,this._stencilFunction.mask);a.stencilOpSeparate(this._stencilOperation.face,this._stencilOperation.fail,this._stencilOperation.zFail,this._stencilOperation.zPass);!0===this._stencilTestEnabled?
a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST);a.stencilMask(this._stencilWriteMask);for(b=0;b<this.parameters.maxTextureImageUnits;b++)a.activeTexture(m.BASE_TEXTURE_UNIT+b),a.bindTexture(3553,null),(c=this._textureUnitMap[b])&&a.bindTexture(c.descriptor.target,c.glName);a.activeTexture(m.BASE_TEXTURE_UNIT+this._activeTextureUnit);a.viewport(this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height)};c._bindBuffer=function(a,b,c,d){if(!b)return a.bindBuffer(c,null),null;if(d===
b)return d;a.bindBuffer(c,b.glName);return b};c._MAX_TEXTURE_IMAGE_UNITS=-1;return c}()})},"esri/views/webgl/enums":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});f.BASE_TEXTURE_UNIT=33984})},"esri/views/webgl/InstanceCounter":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function e(){this._current=[];this._max=[];for(this._allocations=new Map;6>this._current.length;)this._current.push(0),
this._max.push(0)}e.prototype.increment=function(e,f){f=++this._current[e];this._max[e]=Math.max(f,this._max[e])};e.prototype.decrement=function(e,f){--this._current[e]};Object.defineProperty(e.prototype,"max",{get:function(){return this._max},enumerable:!0,configurable:!0});e.prototype.printResourceCount=function(){console.log("Live objects:");console.log("Textures: "+this._current[0]);console.log("Buffers: "+this._current[1]);console.log("VAOs: "+this._current[2]);console.log("Programs: "+this._current[3]);
console.log("Framebuffers: "+this._current[4]);console.log("Renderbuffers: "+this._current[5]);0<this._allocations.size&&(console.log(this._allocations.size+" live object allocations:"),this._allocations.forEach(function(e){return console.log(e)}))};return e}();f.InstanceCounter=u})},"esri/views/webgl/capabilities/isWebGL2Context":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});f.default=function(e){return window.WebGL2RenderingContext&&e instanceof
window.WebGL2RenderingContext}})},"esri/views/webgl/capabilities/load":function(){define("require exports ./DisjointTimerQuery ./Instancing ./isWebGL2Context ./LoseContext ./VertexArrayObjects".split(" "),function(u,f,e,r,m,d,g){function k(d,c,a,b,e){if(b&&m.default(d))return!0;if(c[a])return!1;for(c=0;c<e.length;c++)if(d.getExtension(e[c]))return!0;return!1}Object.defineProperty(f,"__esModule",{value:!0});f.loadCapabilities=function(f,c){var a=c&&c.disabledExtensions||{},b=c&&c.debugWebGLExtensions||
{},l,v,t,x,z,A,u,H,J,B=null,G=null,F=null,M=null;return{get instancing(){l||(l=r.load(f));return l},get vao(){v||(v=g.load(f,a));return v},get compressedTextureS3TC(){if(!t)if(a.compressedTextureS3TC)t=null;else{var b=f.getExtension("WEBGL_compressed_texture_s3tc");t=b?{COMPRESSED_RGB_S3TC_DXT1:b.COMPRESSED_RGB_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT1:b.COMPRESSED_RGBA_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT3:b.COMPRESSED_RGBA_S3TC_DXT3_EXT,COMPRESSED_RGBA_S3TC_DXT5:b.COMPRESSED_RGBA_S3TC_DXT5_EXT}:
null}return t},get textureFilterAnisotropic(){if(!x)if(a.textureFilterAnisotropic)x=null;else{var b=f.getExtension("EXT_texture_filter_anisotropic")||f.getExtension("MOZ_EXT_texture_filter_anisotropic")||f.getExtension("WEBKIT_EXT_texture_filter_anisotropic");x=b?{MAX_TEXTURE_MAX_ANISOTROPY:b.MAX_TEXTURE_MAX_ANISOTROPY_EXT,TEXTURE_MAX_ANISOTROPY:b.TEXTURE_MAX_ANISOTROPY_EXT}:null}return x},get disjointTimerQuery(){z||(z=e.load(f,a));return z},get textureFloat(){if(!A)if(m.default(f))A={textureFloat:!0,
textureFloatLinear:!a.textureFloatLinear&&!!f.getExtension("OES_texture_float_linear"),textureHalfFloat:!0,textureHalfFloatLinear:!a.textureHalfFloatLinear&&!!f.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:f.HALF_FLOAT};else if(f instanceof WebGLRenderingContext){var b=!a.textureHalfFloat&&f.getExtension("OES_texture_half_float");A={textureFloat:!a.textureFloat&&!!f.getExtension("OES_texture_float"),textureFloatLinear:!a.textureFloatLinear&&!!f.getExtension("OES_texture_float_linear"),
textureHalfFloat:!!b,textureHalfFloatLinear:!a.textureHalfFloatLinear&&!!f.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:b?b.HALF_FLOAT_OES:void 0}}else A=null;return A},get colorBufferFloat(){if(!u)if(m.default(f)){var b=!a.colorBufferFloat&&f.getExtension("EXT_color_buffer_half_float"),c=!a.colorBufferFloat&&f.getExtension("EXT_color_buffer_float");u=b||c?{textureFloat:!!c,textureHalfFloat:!!b,R16F:f.R16F,RG16F:f.RG16F,RGBA16F:f.RGBA16F,R32F:f.R32F,RG32F:f.RG32F,RGBA32F:f.RGBA32F,R11F_G11F_B10F:f.R11F_G11F_B10F,
RGB16F:f.RGB16F}:null}else f instanceof WebGLRenderingContext?(b=!a.colorBufferFloat&&f.getExtension("EXT_color_buffer_half_float"),c=!a.colorBufferFloat&&f.getExtension("WEBGL_color_buffer_float"),u=b||c?{textureFloat:!!c,textureHalfFloat:!!b,RGBA16F:b?b.RGBA16F_EXT:void 0,RGB16F:b?b.RGB16F_EXT:void 0,RGBA32F:c?c.RGBA32F_EXT:void 0}:null):u=null;return u},get blendMinMax(){if(!H)if(m.default(f))H={MIN:f.MIN,MAX:f.MAX};else if(a.blendMinMax)H=null;else{var b=f.getExtension("EXT_blend_minmax");H=b?
{MIN:b.MIN_EXT,MAX:b.MAX_EXT}:null}return H},get depthTexture(){null===B&&(B=k(f,a,"depthTexture",!0,["WEBGL_depth_texture","MOZ_WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]));return B},get standardDerivatives(){null===G&&(G=k(f,a,"standardDerivatives",!0,["OES_standard_derivatives"]));return G},get shaderTextureLOD(){null===F&&(F=k(f,a,"shaderTextureLOD",!0,["EXT_shader_texture_lod"]));return F},get fragDepth(){null===M&&(M=k(f,a,"fragDepth",!0,["EXT_frag_depth"]));return M},get loseContext(){J||
(J=d.load(f,b));return J}}}})},"esri/views/webgl/capabilities/DisjointTimerQuery":function(){define(["require","exports","./isWebGL2Context"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.load=function(f,m){if(m.disjointTimerQuery)return null;var d=f.getExtension("EXT_disjoint_timer_query")||f.getExtension("EXT_disjoint_timer_query_webgl2");return d?e.default(f)?{createQuery:function(){return f.createQuery()},resultAvailable:function(d){return f.getQueryParameter(d,f.QUERY_RESULT_AVAILABLE)},
getResult:function(d){return f.getQueryParameter(d,f.QUERY_RESULT)},disjoint:function(){return f.getParameter(d.GPU_DISJOINT_EXT)},beginTimeElapsed:function(e){return f.beginQuery(d.TIME_ELAPSED_EXT,e)},endTimeElapsed:function(){return f.endQuery(d.TIME_ELAPSED_EXT)},createTimestamp:function(e){return d.queryCounterEXT(e,d.TIMESTAMP_EXT)},timestampBits:function(){return f.getQuery(d.TIMESTAMP_EXT,d.QUERY_COUNTER_BITS_EXT)}}:{createQuery:function(){return d.createQueryEXT()},resultAvailable:function(e){return d.getQueryObjectEXT(e,
d.QUERY_RESULT_AVAILABLE_EXT)},getResult:function(e){return d.getQueryObjectEXT(e,d.QUERY_RESULT_EXT)},disjoint:function(){return f.getParameter(d.GPU_DISJOINT_EXT)},beginTimeElapsed:function(e){return d.beginQueryEXT(d.TIME_ELAPSED_EXT,e)},endTimeElapsed:function(){return d.endQueryEXT(d.TIME_ELAPSED_EXT)},createTimestamp:function(e){return d.queryCounterEXT(e,d.TIMESTAMP_EXT)},timestampBits:function(){return d.getQueryEXT(d.TIMESTAMP_EXT,d.QUERY_COUNTER_BITS_EXT)}}:null}})},"esri/views/webgl/capabilities/Instancing":function(){define(["require",
"exports","./isWebGL2Context"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.load=function(f){return e.default(f)?{drawArraysInstanced:f.drawArraysInstanced.bind(f),drawElementsInstanced:f.drawElementsInstanced.bind(f),vertexAttribDivisor:f.vertexAttribDivisor.bind(f)}:(f=f.getExtension("ANGLE_instanced_arrays"))?{drawArraysInstanced:f.drawArraysInstancedANGLE.bind(f),drawElementsInstanced:f.drawElementsInstancedANGLE.bind(f),vertexAttribDivisor:f.vertexAttribDivisorANGLE.bind(f)}:
null}})},"esri/views/webgl/capabilities/LoseContext":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});f.load=function(e,f){var m=f.loseContext&&e.getExtension("WEBGL_lose_context");return m?{loseRenderingContext:function(){return m.loseContext()}}:null}})},"esri/views/webgl/capabilities/VertexArrayObjects":function(){define(["require","exports","./isWebGL2Context"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.load=function(f,
m){return e.default(f)?{createVertexArray:f.createVertexArray.bind(f),deleteVertexArray:f.deleteVertexArray.bind(f),bindVertexArray:f.bindVertexArray.bind(f)}:m.vao?null:(f=f.getExtension("OES_vertex_array_object")||f.getExtension("MOZ_OES_vertex_array_object")||f.getExtension("WEBKIT_OES_vertex_array_object"))?{createVertexArray:f.createVertexArrayOES.bind(f),deleteVertexArray:f.deleteVertexArrayOES.bind(f),bindVertexArray:f.bindVertexArrayOES.bind(f)}:null}})},"esri/views/webgl/ShaderCompiler":function(){define(["require",
"exports"],function(u,f){return function(){function e(e){this.readFile=e}e.prototype.resolveIncludes=function(e){return this.resolve(e)};e.prototype.resolve=function(e,f){var d=this;void 0===f&&(f=new Map);if(f.has(e))return f.get(e);var g=this.read(e);if(!g)throw Error("cannot find shader file "+e);for(var k=/^[^\S\n]*#include\s+<(\S+)>[^\S\n]?/gm,l=k.exec(g),c=[];null!=l;)c.push({path:l[1],start:l.index,length:l[0].length}),l=k.exec(g);var a=0,b="";c.forEach(function(c){b+=g.slice(a,c.start);b+=
f.has(c.path)?"":d.resolve(c.path,f);a=c.start+c.length});b+=g.slice(a);f.set(e,b);return b};e.prototype.read=function(e){return this.readFile(e)};return e}()})},"esri/views/webgl/ProgramCache":function(){define(["require","exports","./programUtils"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function f(e){this._programCacheByTemplate=new Map;this._rctx=e}f.prototype.dispose=function(){this._programCacheByTemplate.forEach(function(e){e.programs.forEach(function(d){d.dispose()})});
this._programCacheByTemplate=null};f.prototype.getProgram=function(f,d){var g=this;this._programCacheByTemplate.has(f)||this.addProgramTemplate(f,function(d){return e.createProgram(g._rctx,f,d)});return this.getProgramTemplateInstance(f,d)};f.prototype.addProgramTemplate=function(e,d){this._programCacheByTemplate.set(e,{constructor:d,programs:new Map})};f.prototype.getProgramTemplateInstance=function(e,d){if(e=this._programCacheByTemplate.get(e)){var g=d?JSON.stringify(d):"default";e.programs.has(g)||
(d=e.constructor(d),e.programs.set(g,d));return e.programs.get(g)}return null};return f}();f.ProgramCache=u})},"esri/views/webgl/programUtils":function(){define(["require","exports","./Program"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.glslifyDefineMap=function(e){var f="",d;for(d in e){var g=e[d];if("boolean"===typeof g)g&&(f+="#define "+d+"\n");else if("number"===typeof g)f+="#define "+d+" "+g.toFixed()+"\n";else if("object"===typeof g){var k=g.options,l=0,c;for(c in k)f+=
"#define "+k[c]+" "+(l++).toFixed()+"\n";f+="#define "+d+" "+k[g.value]+"\n"}}return f};f.createProgram=function(f,m,d,g){d=d||{};g=g||"";d="function"===typeof m.shaders?m.shaders(d):m.shaders;return new e(f,g+d.vertexShader,g+d.fragmentShader,m.attributes)}})},"esri/views/3d/webgl-engine/lib/RenderGeometry":function(){define("require exports ../../../../core/maybe ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../support/mathUtils ./geometryDataUtils ./Object3DStateSet ./Util ../materials/renderers/utils".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q){return function(){function f(a,b,c,d,e,f,k){this.uniqueName=null;this.shaderTransformationDirty=!0;this.data=a.toRenderData();this.boundingInfo=b;this.material=c;this.origin=null;this.center=g.vec3f64.create();this.bsRadius=0;this.transformation=null;this.calculateShaderTransformation=e;d&&this.updateTransformation(d,f);this.castShadow=k;this.instanceParameters={highlights:null,occludees:null,visible:!0}}f.prototype.updateTransformation=function(a,b){this.transformation=
a;this.shaderTransformationDirty=!0;this.bsRadius=this.getBoundingSphere(a,b,this.center)};f.prototype.shaderTransformationChanged=function(){this.shaderTransformationDirty=!0};f.prototype.getBoundingSphere=function(a,b,c){b=b||l.maxScale(a);d.vec3.transformMat4(c,this.boundingInfo.getCenter(),a);return this.boundingInfo.getBSRadius()*b};Object.defineProperty(f.prototype,"hasShaderTransformation",{get:function(){return!!this.calculateShaderTransformation},enumerable:!0,configurable:!0});f.prototype.getShaderTransformation=
function(){if(!this.calculateShaderTransformation)return e.unwrapOr(this.transformation,k.IDENTITY);this.shaderTransformationDirty&&(this.shaderTransformation||(this.shaderTransformation=m.mat4f64.create()),r.mat4.copy(this.shaderTransformation,this.calculateShaderTransformation(e.unwrapOr(this.transformation,k.IDENTITY))),this.shaderTransformationDirty=!1);return this.shaderTransformation};f.prototype.computeAttachmentOrigin=function(a){if(this.material.computeAttachmentOrigin)return this.material.computeAttachmentOrigin(this,
a)?(e.isSome(this.transformation)&&d.vec3.transformMat4(a,a,this.transformation),!0):!1;var g=this.getIndices(b.VertexAttrConstants.POSITION),f=this.getAttribute(b.VertexAttrConstants.POSITION);return c.computeAttachmentOriginTriangles(f,g,a)?(e.isSome(this.transformation)&&d.vec3.transformMat4(a,a,this.transformation),!0):!1};f.prototype.getIndices=function(a){return"indices"in this.data?this.data.indices[a]:null};f.prototype.getAttribute=function(a){return"vertexAttr"in this.data?this.data.vertexAttr[a]:
null};f.prototype.addHighlight=function(){var b=a.generateObject3DStateId(0),c=this.instanceParameters;c.highlights=q.addObject3DStateID(c.highlights,b);return b};f.prototype.removeHighlight=function(a){var b=this.instanceParameters;b.highlights=q.removeObject3DStateID(b.highlights,a)};return f}()})},"esri/views/3d/webgl-engine/lib/Texture":function(){define("require exports tslib ../../../../core/compilerUtils ../../../../core/Error ../../../../core/Evented ../../../../core/mathUtils ../../../../core/mathUtils ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/typedArrayUtil ../../../../core/urlUtils ../../../../support/requestUtils ../../support/imageUtils ./DDSUtil ./glUtil3D ./IdGen ./Util ../../../webgl/FramebufferObject ../../../webgl/Texture ../../../webgl/Util ../../../webgl/capabilities/isWebGL2Context".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A,E,H,J,B){return function(){function f(a,b,c){this.data=a;this.loadingController=this.loadingPromise=this.powerOfTwoStretchInfo=this.glTexture=null;this.events=new d;this.data=a;this.id=f.idGen.gen(b);this.params=c||{};this.params.mipmap=!1!==this.params.mipmap;this.params.noUnpackFlip=this.params.noUnpackFlip||!1;this.params.preMultiplyAlpha=this.params.preMultiplyAlpha||!1;this.params.wrap=this.params.wrap||{s:10497,t:10497};this.params.powerOfTwoResizeMode=
this.params.powerOfTwoResizeMode||1;this.estimatedTexMemRequired=f.estimateTexMemRequired(this.data,this.params);this.startPreload()}f.prototype.startPreload=function(){var a=this.data;l.isNone(a)||(a instanceof HTMLVideoElement?this.startPreloadVideoElement(a):a instanceof HTMLImageElement&&this.startPreloadImageElement(a))};f.prototype.startPreloadVideoElement=function(a){b.isBlobProtocol(a.src)||"auto"===a.preload&&a.crossOrigin||(a.preload="auto",a.crossOrigin="anonymous",a.src=a.src)};f.prototype.startPreloadImageElement=
function(a){b.isDataProtocol(a.src)||b.isBlobProtocol(a.src)||a.crossOrigin||(a.crossOrigin="anonymous",a.src=a.src)};f.getDataDimensions=function(a){return a instanceof HTMLVideoElement?{width:a.videoWidth,height:a.videoHeight}:a};f.estimateTexMemRequired=function(b,c){if(l.isNone(b))return 0;if(a.isArrayBuffer(b)||a.isUint8Array(b))return b.byteLength;b=b instanceof Image||b instanceof ImageData||b instanceof HTMLCanvasElement||b instanceof HTMLVideoElement?f.getDataDimensions(b):c;return(c.mipmap?
4/3:1)*b.width*b.height*(c.components||4)||0};f.prototype.dispose=function(){this.data=void 0};Object.defineProperty(f.prototype,"width",{get:function(){return this.params.width},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"height",{get:function(){return this.params.height},enumerable:!0,configurable:!0});f.prototype.createDescriptor=function(a){return{target:3553,pixelFormat:6408,dataType:5121,wrapMode:this.params.wrap,flipped:!this.params.noUnpackFlip,samplingMode:this.params.mipmap?
9987:9729,hasMipmap:this.params.mipmap,preMultiplyAlpha:this.params.preMultiplyAlpha,maxAnisotropy:this.params.mipmap&&!this.params.disableAnisotropy?a.parameters.maxMaxAnisotropy:void 0}};f.prototype.load=function(b,c){if(l.isSome(this.glTexture))return this.glTexture;if(l.isSome(this.loadingPromise))return this.loadingPromise;var d=this.data;if(l.isNone(d))return this.glTexture=new H(b,this.createDescriptor(b),null),b.bindTexture(this.glTexture),this.glTexture;if("string"===typeof d)return this.loadFromURL(b,
c,d);if(d instanceof Image)return this.loadFromImageElement(b,c,d);if(d instanceof HTMLVideoElement)return this.loadFromVideoElement(b,c,d);if(d instanceof ImageData||d instanceof HTMLCanvasElement)return this.loadFromImage(b,d,c);if((a.isArrayBuffer(d)||a.isUint8Array(d))&&this.params.encoding===f.DDS_ENCODING)return this.loadFromDDSData(b,d);if(a.isUint8Array(d))return this.loadFromPixelData(b,d);if(a.isArrayBuffer(d))return this.loadFromPixelData(b,new Uint8Array(d));r.neverReachedSilent(d);return null};
Object.defineProperty(f.prototype,"requiresFrameUpdates",{get:function(){return this.data instanceof HTMLVideoElement},enumerable:!0,configurable:!0});f.prototype.frameUpdate=function(a,b,c){if(!(this.data instanceof HTMLVideoElement)||l.isNone(this.glTexture)||2>this.data.readyState||c===this.data.currentTime)return c;if(l.isSome(this.powerOfTwoStretchInfo)){var d=this.powerOfTwoStretchInfo;c=d.framebuffer;var e=d.vao,d=d.sourceTexture;d.setData(this.data);this.drawStretchedTexture(a,b,c,e,d,this.glTexture)}else b=
this.data,a=b.width,b=b.height,e=this.glTexture.descriptor,c=e.width,e=e.height,a!==c||b!==e?this.glTexture.updateData(0,0,0,Math.min(a,c),Math.min(b,e),this.data):this.glTexture.setData(this.data);this.glTexture.descriptor.hasMipmap&&this.glTexture.generateMipmap();return this.data.currentTime};f.prototype.loadFromDDSData=function(a,b){this.glTexture=t.createDDSTexture(a,this.createDescriptor(a),b,this.params.mipmap);a.bindTexture(this.glTexture);return this.glTexture};f.prototype.loadFromPixelData=
function(a,b){A.assert(0<this.params.width&&0<this.params.height);var c=this.createDescriptor(a);c.pixelFormat=1===this.params.components?6409:3===this.params.components?6407:6408;c.width=this.params.width;c.height=this.params.height;this.glTexture=new H(a,c,b);a.bindTexture(this.glTexture);return this.glTexture};f.prototype.loadAsync=function(a){return e.__awaiter(this,void 0,void 0,function(){var b,d,g,f=this;return e.__generator(this,function(e){this.loadingController=b=c.createAbortController();
this.loadingPromise=d=a(b.signal);g=function(){f.loadingController===b&&(f.loadingController=null);f.loadingPromise===d&&(f.loadingPromise=null)};d.then(g,g);return[2,d]})})};f.prototype.loadFromURL=function(a,b,c){var d=this;return this.loadAsync(function(g){return e.__awaiter(d,void 0,void 0,function(){var d;return e.__generator(this,function(e){switch(e.label){case 0:return[4,v.requestImage(c,{signal:g})];case 1:return d=e.sent(),[2,this.loadFromImage(a,d,b)]}})})})};f.prototype.loadFromImageElement=
function(a,b,c){var d=this;return c.complete?this.loadFromImage(a,c,b):this.loadAsync(function(g){return e.__awaiter(d,void 0,void 0,function(){var d;return e.__generator(this,function(e){switch(e.label){case 0:return[4,q.loadImageAsync(c,c.src,!1,g)];case 1:return d=e.sent(),[2,this.loadFromImage(a,d,b)]}})})})};f.prototype.loadFromVideoElement=function(a,b,c){return 2<=c.readyState?this.loadFromImage(a,c,b):this.loadFromVideoElementAsync(a,b,c)};f.prototype.loadFromVideoElementAsync=function(a,
b,d){var e=this;return this.loadAsync(function(g){return c.create(function(f,k){var q=function(){d.removeEventListener("loadeddata",t);d.removeEventListener("error",r);l.isSome(v)&&v.remove()},t=function(){2<=d.readyState&&(q(),f(e.loadFromImage(a,d,b)))},r=function(a){q();k(a||new m("Failed to load video"))};d.addEventListener("loadeddata",t);d.addEventListener("error",r);var v=c.onAbort(g,function(){return r(c.createAbortError())})})})};f.prototype.loadFromImage=function(a,b,c){var d=f.getDataDimensions(b);
this.params.width=d.width;this.params.height=d.height;var e=this.createDescriptor(a);e.pixelFormat=3===this.params.components?6407:6408;if(this.requiresPowerOfTwo(a,e)&&(!k.isPowerOfTwo(d.width)||!k.isPowerOfTwo(d.height)))return this.glTexture=this.makePowerOfTwoTexture(a,b,d,e,c),a.bindTexture(this.glTexture),this.glTexture;e.width=d.width;e.height=d.height;this.glTexture=new H(a,e,b);a.bindTexture(this.glTexture);return this.glTexture};f.prototype.requiresPowerOfTwo=function(a,b){var c="number"===
typeof b.wrapMode?33071===b.wrapMode:33071===b.wrapMode.s&&33071===b.wrapMode.t;return!B.default(a.gl)&&(b.hasMipmap||!c)};f.prototype.makePowerOfTwoTexture=function(a,b,c,d,e){var f=c.width;c=c.height;var k=g.nextHighestPowerOfTwo(f),l=g.nextHighestPowerOfTwo(c);d.width=k;d.height=l;var q;switch(this.params.powerOfTwoResizeMode){case 2:d.textureCoordinateScaleFactor=[f/k,c/l];q=new H(a,d);q.updateData(0,0,0,f,c,b);break;case 1:case null:case void 0:q=this.stretchToPowerOfTwo(a,b,d,e);break;default:r.neverReached(this.params.powerOfTwoResizeMode)}d.hasMipmap&&
q.generateMipmap();return q};f.prototype.stretchToPowerOfTwo=function(a,b,c,d){var e=new H(a,c),g=new E(a,{colorTarget:0,depthStencilTarget:0},e);b=new H(a,{target:3553,pixelFormat:c.pixelFormat,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!!c.flipped,maxAnisotropy:8,preMultiplyAlpha:c.preMultiplyAlpha},b);c=x.createQuadVAO(a);this.drawStretchedTexture(a,d,g,c,b,e);this.requiresFrameUpdates?this.powerOfTwoStretchInfo={vao:c,sourceTexture:b,framebuffer:g}:(c.dispose(!0),b.dispose(),g.detachColorTexture(),
a.bindFramebuffer(null),g.dispose());return e};f.prototype.drawStretchedTexture=function(a,b,c,d,e,g){a.bindFramebuffer(c);c=a.getViewport();a.setViewport(0,0,g.descriptor.width,g.descriptor.height);g=b.program;a.bindProgram(g);g.setUniform4f("color",1,1,1,1);g.setUniform1i("tex",0);a.bindTexture(e,0);a.bindVAO(d);a.setPipelineState(b.pipeline);a.drawArrays(5,0,J.vertexCount(d,"geometry"));a.bindFramebuffer(null);a.setViewport(c.x,c.y,c.width,c.height)};f.prototype.unload=function(){if(l.isSome(this.powerOfTwoStretchInfo)){var a=
this.powerOfTwoStretchInfo,b=a.framebuffer,c=a.sourceTexture;a.vao.dispose(!0);c.dispose();b.dispose();this.powerOfTwoStretchInfo=this.glTexture=null}l.isSome(this.glTexture)&&(this.glTexture.dispose(),this.glTexture=null);l.isSome(this.loadingController)&&(a=this.loadingController,this.loadingPromise=this.loadingController=null,a.abort());this.events.emit("unloaded")};f.idGen=new z.IdGen;f.DDS_ENCODING="image/vnd-ms.dds";return f}()})},"esri/views/3d/support/imageUtils":function(){define(["require",
"exports","tslib","../../../request"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.requestImage=function(f,d){return r(f,e.__assign({responseType:"image"},d)).then(function(d){return d.data})}})},"esri/views/3d/webgl-engine/lib/DDSUtil":function(){define(["require","exports","../../../../core/Logger","../../../../core/mathUtils","../../../webgl/Texture"],function(u,f,e,r,m){function d(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}
function g(b,d){var e=new Int32Array(b,0,31);if(542327876!==e[0])return k.error("Invalid magic number in DDS header"),null;if(!(e[20]&4))return k.error("Unsupported format, must contain a FourCC code"),null;var g=e[21],f;switch(g){case l:g=8;f=33776;break;case c:g=16;f=33778;break;case a:g=16;f=33779;break;default:return k.error("Unsupported FourCC code:",String.fromCharCode(g&255,g>>8&255,g>>16&255,g>>24&255)),null}var q=1,m=e[4],u=e[3];if(0!==(m&3)||0!==(u&3))k.warn("Rounding up compressed texture size to nearest multiple of 4."),
m=m+3&-4,u=u+3&-4;var H=m,J=u;e[2]&131072&&!1!==d&&(q=Math.max(1,e[7]));1===q||r.isPowerOfTwo(m)&&r.isPowerOfTwo(u)||(k.warn("Ignoring mipmaps of non power of two sized compressed texture."),q=1);for(var B=e[1]+4,G=[],F=0;F<q;++F)e=(m+3>>2)*(u+3>>2)*g,d=new Uint8Array(b,B,e),G.push(d),B+=e,m=Math.max(1,m>>1),u=Math.max(1,u>>1);return{textureData:{type:"compressed",levels:G},internalFormat:f,width:H,height:J}}Object.defineProperty(f,"__esModule",{value:!0});var k=e.getLogger("esri.views.3d.webgl-engine.lib.DDSUtil"),
l=d("DXT1"),c=d("DXT3"),a=d("DXT5");f.createDDSTexture=function(a,c,d,e){var b=g(d,e);d=b.textureData;e=b.internalFormat;var f=b.width,b=b.height;c.samplingMode=1<d.levels.length?9987:9729;c.hasMipmap=1<d.levels.length;c.internalFormat=e;c.width=f;c.height=b;c=new m(a,c,d);a.bindTexture(c);return c};f.createDDSTextureData=g})},"esri/views/3d/webgl-engine/materials/HUDMaterial":function(){define("require exports tslib ../../../../core/mathUtils ../../../../core/maybe ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f64 ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/types/mat4 ../../../../geometry/support/aaBoundingRect ../../support/buffer/InterleavedLayout ../lib/geometryDataUtils ../lib/GLMaterialTexture ../lib/Material ../lib/screenSizePerspectiveUtils ../lib/Util ./internal/bufferWriterUtils ./internal/MaterialUtil ./renderers/MergedRenderer ./renderers/utils ../shaders/HUDMaterial.glsl ../shaders/HUDMaterialTechnique".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A,E,H,J,B,G,F,M,R,T,O){function L(a,b,c,d,e,g,w,f){b=b-e-(0<f[0]?d[0]*f[0]:0);var k=b+d[0]+2*e;c=c-e-(0<f[1]?d[1]*f[1]:0);e=c+d[1]+2*e;w.textureIsSignedDistanceField&&(w=w.distanceFieldBoundingBox,b+=d[0]*w[0],c+=d[1]*w[1],k-=d[0]*(1-w[2]),e-=d[1]*(1-w[3]),b-=g,k+=g,c-=g,e+=g);return a[0]>b&&a[0]<k&&a[1]>c&&a[1]<e}Object.defineProperty(f,"__esModule",{value:!0});u=function(b){function c(a,c){c=b.call(this,c)||this;c.techniqueConfig=new O.HUDMaterialTechniqueConfiguration;
c.params=F.copyParameters(a,na);return c}e.__extends(c,b);c.prototype.setParameterValues=function(a){for(var b in a)"textureId"===b&&B.assert(!!this.params.textureId,"Can only change texture of material that already has a texture"),this.params[b]=a[b];this.parametersChanged()};c.prototype.getParameters=function(){return this.params};c.prototype.getTechniqueConfig=function(a){this.techniqueConfig.output=a;this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled;this.techniqueConfig.verticalOffset=
!!this.params.verticalOffset;this.techniqueConfig.screenSizePerspective=!!this.params.screenSizePerspective;this.techniqueConfig.screenCenterOffsetUnitsEnabled="screen"===this.params.centerOffsetUnits?1:0;this.techniqueConfig.polygonOffsetEnabled=this.params.polygonOffset;this.techniqueConfig.occlusionTestEnabled=this.params.occlusionTest;this.techniqueConfig.sdf=this.params.textureIsSignedDistanceField;this.techniqueConfig.vvSize=!!this.params.vvSizeEnabled;this.techniqueConfig.vvColor=!!this.params.vvColorEnabled;
0===a&&(this.techniqueConfig.debugDrawBorder=!!this.params.debugDrawBorder);4===a&&(this.techniqueConfig.binaryHighlightOcclusion=this.params.binaryHighlightOcclusion);this.techniqueConfig.depthEnabled=this.params.depthEnabled;return this.techniqueConfig};c.prototype.intersect=function(a,b,c,d,e,g,f,n,h){h?this.intersectDrapedHudGeometry(a,g,f,n):this.intersectHudGeometry(a,b,c,d,f,n)};c.prototype.intersectDrapedHudGeometry=function(a,b,c,d){var e=a.getAttribute(B.VertexAttrConstants.POSITION),g=
a.getAttribute(B.VertexAttrConstants.SIZE),f=this.params,n=T.calculateAnchorPosForRendering(f),h=1,p=1;d&&(p=d(fa),h=p[0],p=p[5]);h*=a.pixelRatio;p*=a.pixelRatio;d=ia*a.pixelRatio;for(var y=0;y<e.data.length/e.size;y++){var D=y*e.size,K=e.data[D],D=e.data[D+1],P=y*g.size;ca[0]=g.data[P]*h;ca[1]=g.data[P+1]*p;P=void 0;f.textureIsSignedDistanceField&&(P=f.outlineSize*a.pixelRatio/2);L(b,K,D,ca,d,P,f,n)&&c()}};c.prototype.intersectHudGeometry=function(a,b,c,d,e,f){if(d.options.selectionMode&&d.options.hud&&
!R.isInstanceHidden(b)){var w=a.data;a=this.params;var n=b=1;g.mat3.fromMat4(ga,c);if(f){n=f(fa);b=n[0];n=n[5];f=ga;var h=f[0],p=f[1],y=f[2],D=f[3],K=f[4],P=f[5],N=f[6],U=f[7],k=f[8],m=1/Math.sqrt(h*h+p*p+y*y),t=1/Math.sqrt(D*D+K*K+P*P),r=1/Math.sqrt(N*N+U*U+k*k);f[0]=h*m;f[1]=p*m;f[2]=y*m;f[3]=D*t;f[4]=K*t;f[5]=P*t;f[6]=N*r;f[7]=U*r;f[8]=k*r}f=w.getVertexAttr()[B.VertexAttrConstants.POSITION];h=w.getVertexAttr()[B.VertexAttrConstants.SIZE];p=w.getVertexAttr()[B.VertexAttrConstants.NORMAL];w=w.getVertexAttr()[B.VertexAttrConstants.AUXPOS1];
B.assert(3<=f.size);y=d.point;D=d.camera;K=T.calculateAnchorPosForRendering(a);b*=D.pixelRatio;n*=D.pixelRatio;P="screen"===this.params.centerOffsetUnits;for(N=0;N<f.data.length/f.size;N++)U=N*f.size,q.vec3.set(V,f.data[U],f.data[U+1],f.data[U+2]),q.vec3.transformMat4(V,V,c),U=N*h.size,ca[0]=h.data[U]*b,ca[1]=h.data[U+1]*n,q.vec3.transformMat4(V,V,D.viewMatrix),U=N*w.size,q.vec3.set(da,w.data[U+0],w.data[U+1],w.data[U+2]),P||(V[0]+=da[0],V[1]+=da[1],0!==da[2]&&(U=da[2],q.vec3.normalize(da,V),q.vec3.subtract(V,
V,q.vec3.scale(da,da,U)))),U=N*p.size,q.vec3.set(Z,p.data[U],p.data[U+1],p.data[U+2]),this.normalAndViewAngle(Z,ga,D,ma),this.applyVerticalOffsetTransformationView(V,ma,D,aa),D.applyProjection(V,ha),-1<ha[0]&&(U=Math.floor(ha[0])+this.params.screenOffset[0],k=Math.floor(ha[1])+this.params.screenOffset[1],P&&(U+=da[0],0!==da[1]&&(k+=J.applyScaleFactor(da[1],aa.factorAlignment))),J.applyPrecomputedScaleFactor(ca,aa.factor,ca),m=la*D.pixelRatio,t=void 0,a.textureIsSignedDistanceField&&(t=a.outlineSize*
D.pixelRatio/2),L(y,U,k,ca,m,t,a,K)&&(k=d.ray,q.vec3.transformMat4(ea,V,l.mat4.invert(ja,D.viewMatrix)),ha[0]=y[0],ha[1]=y[1],D.unprojectPoint(ha,V),U=v.vec3f64.create(),q.vec3.copy(U,k.direction),m=1/q.vec3.length(U),q.vec3.scale(U,U,m),k=q.vec3.distance(k.origin,V)*m,e(k,U,-1,1,!0,ea)))}};c.prototype.computeAttachmentOrigin=function(a,b){a=a.data;var c="getVertexAttr"in a?a.getVertexAttr():"vertexAttr"in a?a.vertexAttr:null;if(!c)return null;var d=B.VertexAttrConstants.POSITION,c=c[d];a="getIndices"in
a?a.getIndices(d):"indices"in a?a.indices[d]:null;return A.computeAttachmentOriginPoints(c,a,b)};c.prototype.createBufferWriter=function(){return new sa(this)};c.prototype.createRenderer=function(a,b){return new M(a,b,this)};c.prototype.normalAndViewAngle=function(a,b,c,d){t.isMat4(b)&&(b=g.mat3.fromMat4(oa,b));q.vec3.transformMat3(d.normal,a,b);q.vec3.transformMat4(d.normal,d.normal,c.viewInverseTransposeMatrix);d.cosAngle=q.vec3.dot(X,C);return d};c.prototype.updateScaleInfo=function(a,b,c){var d=
this.params;d.screenSizePerspective?J.precomputeScaleFactor(c,b,d.screenSizePerspective,a.factor):(a.factor.scale=1,a.factor.factor=0,a.factor.minPixelSize=0,a.factor.paddingPixels=0);d.screenSizePerspectiveAlignment?J.precomputeScaleFactor(c,b,d.screenSizePerspectiveAlignment,a.factorAlignment):(a.factorAlignment.factor=a.factor.factor,a.factorAlignment.scale=a.factor.scale,a.factorAlignment.minPixelSize=a.factor.minPixelSize,a.factorAlignment.paddingPixels=a.factor.paddingPixels)};c.prototype.applyShaderOffsetsView=
function(a,b,c,d,e,g,f){b=this.normalAndViewAngle(b,c,e,ma);this.applyVerticalGroundOffsetView(a,b,e,f);this.applyVerticalOffsetTransformationView(f,b,e,g);this.applyPolygonOffsetView(f,b,d[3],e,f);this.applyCenterOffsetView(f,d,f);return f};c.prototype.applyShaderOffsetsNDC=function(a,b,c,d,e){this.applyCenterOffsetNDC(a,b,c,d);m.isSome(e)&&q.vec3.copy(e,d);this.applyPolygonOffsetNDC(d,b,c,d);return d};c.prototype.applyPolygonOffsetView=function(a,b,c,d,e){var w=d.aboveGround?1:-1;c=r.sign(c);0===
c&&(c=w);w*=c;if(0>=this.params.shaderPolygonOffset)return q.vec3.copy(e,a);b=r.clamp(Math.abs(b.cosAngle),.01,1);d=1-Math.sqrt(1-b*b)/b/d.viewport[2];0<w?q.vec3.scale(e,a,d):q.vec3.scale(e,a,1/d);return e};c.prototype.applyVerticalGroundOffsetView=function(a,b,c,d){var e=q.vec3.length(a),g=c.aboveGround?1:-1;c=.5*c.computeRenderPixelSizeAtDist(e);b=q.vec3.scale(V,b.normal,g*c);q.vec3.add(d,a,b);return d};c.prototype.applyVerticalOffsetTransformationView=function(a,b,c,d){var e=this.params;if(!e.verticalOffset||
!e.verticalOffset.screenLength){if(e.screenSizePerspective||e.screenSizePerspectiveAlignment){var g=q.vec3.length(a);this.updateScaleInfo(d,g,b.cosAngle)}else d.factor.scale=1,d.factorAlignment.scale=1;return a}g=q.vec3.length(a);c=F.verticalOffsetAtDistance(c,g,e.verticalOffset,b.cosAngle,e.screenSizePerspectiveAlignment||e.screenSizePerspective);this.updateScaleInfo(d,g,b.cosAngle);q.vec3.scale(b.normal,b.normal,c);return q.vec3.add(a,a,b.normal)};c.prototype.applyCenterOffsetView=function(a,b,
c){var d="screen"!==this.params.centerOffsetUnits;c!==a&&q.vec3.copy(c,a);d&&(c[0]+=b[0],c[1]+=b[1],b[2]&&(q.vec3.normalize(Z,c),q.vec3.add(c,c,q.vec3.scale(Z,Z,b[2]))));return c};c.prototype.applyCenterOffsetNDC=function(a,b,c,d){var e="screen"!==this.params.centerOffsetUnits;d!==a&&q.vec3.copy(d,a);e||(d[0]+=b[0]/c.fullWidth*2,d[1]+=b[1]/c.fullHeight*2);return d};c.prototype.applyPolygonOffsetNDC=function(a,b,c,d){var e=this.params.shaderPolygonOffset;a!==d&&q.vec3.copy(d,a);e&&(a=c.aboveGround?
1:-1,b=a*r.sign(b[3]),d[2]-=(b||a)*e);return d};c.prototype.getGLMaterial=function(a){if(0===a.output)return new Q(a);if(4===a.output)return new S(a)};c.prototype.calculateRelativeScreenBounds=function(b,c,d){void 0===d&&(d=x.create());var e=this.params,w=d;void 0===w&&(w=ba);a.vec2.copy(w,e.anchorPos);w[0]*=-b[0];w[1]*=-b[1];w[0]+=e.screenOffset[0]*c;w[1]+=e.screenOffset[1]*c;d[2]=d[0]+b[0];d[3]=d[1]+b[1];return d};c.shouldRenderVisibilityDuringRenderPass=function(a){return 0===a||4};return c}(H.Material);
f.default=u;f=function(a){function b(b){b=a.call(this,e.__assign(e.__assign({},b),b.material.getParameters()))||this;b.updateParameters();return b}e.__extends(b,a);b.prototype.beginSlot=function(a){return a===(this.params.drawInSecondSlot?19:18)};b.prototype.updateParameters=function(){this.params=F.copyParameters(this.material.getParameters());this.updateTexture(this.params.textureId);this.selectProgram()};b.prototype.selectProgram=function(){this.technique=this.techniqueRep.acquireAndReleaseExisting(O.HUDMaterialTechnique,
this.material.getTechniqueConfig(this.output),this.technique)};b.prototype.bind=function(a,b){a.bindProgram(this.technique.program);this.bindTexture(a,this.technique.program);this.bindTextureScale(a,this.technique.program);this.technique.bindPass(a,this.params,b)};return b}(E);var Q=function(a){function b(b){b=a.call(this,e.__assign(e.__assign({},b),{output:0}))||this;b.isOcclusionSlot=!1;return b}e.__extends(b,a);b.prototype.beginSlot=function(a){var b=this.params.drawInSecondSlot?19:18;if(this.params.occlusionTest)return this.isOcclusionSlot=
12===a,12===a||a===b;this.isOcclusionSlot=!1;return a===b};b.prototype.getTechnique=function(){return this.isOcclusionSlot?this.occlusionTechnique:this.technique};b.prototype.selectProgram=function(){this.technique=this.techniqueRep.acquireAndReleaseExisting(O.HUDMaterialTechnique,this.material.getTechniqueConfig(this.output),this.technique);this.occlusionTechnique=this.techniqueRep.acquireAndReleaseExisting(O.HUDMaterialTechnique,this.material.getTechniqueConfig(6),this.occlusionTechnique)};b.prototype.bind=
function(a,b){var c=this.getTechnique();a.bindProgram(c.program);this.isOcclusionSlot||(this.bindTexture(a,c.program),this.bindTextureScale(a,c.program));c.bindPass(a,this.params,b)};return b}(f),S=function(a){function b(b){return a.call(this,e.__assign(e.__assign({},b),{output:4}))||this}e.__extends(b,a);return b}(f),aa={factor:{scale:0,factor:0,minPixelSize:0,paddingPixels:0},factorAlignment:{scale:0,factor:0,minPixelSize:0,paddingPixels:0}},ba=b.vec2f64.create(),V=v.vec3f64.create(),Z=v.vec3f64.create(),
ha=d.createRenderScreenPointArray3(),X=v.vec3f64.create(),ea=v.vec3f64.create(),ga=k.mat3f64.create(),oa=k.mat3f64.create(),ja=c.mat4f64.create(),da=v.vec3f64.create(),ma={normal:X,cosAngle:0},fa=c.mat4f64.create(),la=1,ia=2,ca=[0,0],C=v.vec3f64.fromValues(0,0,1),na={texCoordScale:[1,1],occlusionTest:!0,binaryHighlightOcclusion:!0,drawInSecondSlot:!1,color:[1,1,1,1],outlineColor:[1,1,1,1],outlineSize:0,textureIsSignedDistanceField:!1,distanceFieldBoundingBox:null,vvSizeEnabled:!1,vvSizeMinSize:[1,
1,1],vvSizeMaxSize:[100,100,100],vvSizeOffset:[0,0,0],vvSizeFactor:[1,1,1],vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],screenOffset:[0,0],verticalOffset:null,screenSizePerspective:null,screenSizePerspectiveAlignment:null,slicePlaneEnabled:!1,anchorPos:b.vec2f64.fromValues(.5,.5),shaderPolygonOffset:1E-5,polygonOffset:!1,textureId:null,centerOffsetUnits:"world",depthEnabled:!0,debugDrawBorder:!1},pa=z.newLayout().vec3f(B.VertexAttrConstants.POSITION).vec3f(B.VertexAttrConstants.NORMAL).vec2f(B.VertexAttrConstants.UV0).vec4u8(B.VertexAttrConstants.COLOR).vec2f(B.VertexAttrConstants.SIZE).vec4f(B.VertexAttrConstants.AUXPOS1).vec4f(B.VertexAttrConstants.AUXPOS2),
sa=function(){function a(a){this.material=a;this.vertexBufferLayout=pa}a.prototype.allocate=function(a){return this.vertexBufferLayout.createBuffer(a)};a.prototype.elementCount=function(a){return 6*a.indices[B.VertexAttrConstants.POSITION].length};a.prototype.write=function(a,b,c,d){G.writePosition(b.indices[B.VertexAttrConstants.POSITION],b.vertexAttr[B.VertexAttrConstants.POSITION].data,a.transformation,c.position,d,6);G.writeNormal(b.indices[B.VertexAttrConstants.NORMAL],b.vertexAttr[B.VertexAttrConstants.NORMAL].data,
a.invTranspTransformation,c.normal,d,6);a=b.vertexAttr[B.VertexAttrConstants.UV0].data;var e=void 0,w=void 0,g=void 0,f=void 0;null==a||4>a.length?(a=this.material.getParameters(),w=e=0,g=a.texCoordScale[0],f=a.texCoordScale[1]):(e=a[0],w=a[1],g=a[2],f=a[3]);var g=Math.min(1.99999,g+1),f=Math.min(1.99999,f+1),n=b.indices[B.VertexAttrConstants.POSITION].length,h=c.uv0;a=d;for(var p=0;p<n;++p)h.set(a,0,e),h.set(a,1,w),a+=1,h.set(a,0,g),h.set(a,1,w),a+=1,h.set(a,0,g),h.set(a,1,f),a+=1,h.set(a,0,g),h.set(a,
1,f),a+=1,h.set(a,0,e),h.set(a,1,f),a+=1,h.set(a,0,e),h.set(a,1,w),a+=1;G.writeColor(b.indices[B.VertexAttrConstants.COLOR],b.vertexAttr[B.VertexAttrConstants.COLOR].data,4,c.color,d,6);e=b.indices[B.VertexAttrConstants.SIZE];w=b.vertexAttr[B.VertexAttrConstants.SIZE].data;g=e.length;f=c.size;a=d;for(p=0;p<g;++p)for(var n=w[2*e[p]],h=w[2*e[p]+1],y=0;6>y;++y)f.set(a,0,n),f.set(a,1,h),a+=1;b.indices[B.VertexAttrConstants.AUXPOS1]&&b.vertexAttr[B.VertexAttrConstants.AUXPOS1]&&G.writeBufferVec4(b.indices[B.VertexAttrConstants.AUXPOS1],
b.vertexAttr[B.VertexAttrConstants.AUXPOS1].data,c.auxpos1,d,6);b.indices[B.VertexAttrConstants.AUXPOS2]&&b.vertexAttr[B.VertexAttrConstants.AUXPOS2]&&G.writeBufferVec4(b.indices[B.VertexAttrConstants.AUXPOS2],b.vertexAttr[B.VertexAttrConstants.AUXPOS2].data,c.auxpos2,d,6)};return a}()})},"esri/core/libs/gl-matrix-2/types/mat4":function(){define(["require","exports"],function(u,f){function e(e){return e instanceof Float32Array&&16<=e.length}function r(e){return Array.isArray(e)&&16<=e.length}Object.defineProperty(f,
"__esModule",{value:!0});f.isMat4f32=e;f.isMat4f64=r;f.isMat4=function(f){return e(f)||r(f)}})},"esri/views/3d/webgl-engine/lib/GLMaterialTexture":function(){define("require exports tslib ../../../../core/maybe ./DefaultTextureUnits ./GLMaterial".split(" "),function(u,f,e,r,m,d){return function(d){function g(e){var c=d.call(this,e)||this;c._textureIDs=new Set;c._textureRepository=e.textureRep;c._textureId=e.textureId;c._initTransparent=!!e.initTextureTransparent;c._texture=c._acquireIfNotUndefined(c._textureId);
c._textureNormal=c._acquireIfNotUndefined(e.normalTextureId);c._textureEmissive=c._acquireIfNotUndefined(e.emissiveTextureId);c._textureOcclusion=c._acquireIfNotUndefined(e.occlusionTextureId);c._textureMetallicRoughness=c._acquireIfNotUndefined(e.metallicRoughnessTextureId);return c}e.__extends(g,d);g.prototype.dispose=function(){var d=this;this._textureIDs.forEach(function(c){return d._textureRepository.release(c)});this._textureIDs.clear()};g.prototype.updateTexture=function(d){d!==this._textureId&&
(this._releaseIfNotUndefined(this._textureId),this._textureId=d,this._texture=this._acquireIfNotUndefined(this._textureId))};g.prototype.bindTexture=function(d,c){r.isSome(this._texture)&&(c.setUniform1i("tex",m.DefaultTextureUnits.DIFFUSE),d.bindTexture(this._texture.glTexture,m.DefaultTextureUnits.DIFFUSE));r.isSome(this._textureNormal)&&(c.setUniform1i("normalTexture",m.DefaultTextureUnits.NORMAL),d.bindTexture(this._textureNormal.glTexture,m.DefaultTextureUnits.NORMAL));r.isSome(this._textureEmissive)&&
(c.setUniform1i("texEmission",m.DefaultTextureUnits.EMISSION),d.bindTexture(this._textureEmissive.glTexture,m.DefaultTextureUnits.EMISSION));r.isSome(this._textureOcclusion)&&(c.setUniform1i("texOcclusion",m.DefaultTextureUnits.OCCLUSION),d.bindTexture(this._textureOcclusion.glTexture,m.DefaultTextureUnits.OCCLUSION));r.isSome(this._textureMetallicRoughness)&&(c.setUniform1i("texMetallicRoughness",m.DefaultTextureUnits.METALLIC_ROUGHNESS),d.bindTexture(this._textureMetallicRoughness.glTexture,m.DefaultTextureUnits.METALLIC_ROUGHNESS))};
g.prototype.bindTextureScale=function(d,c){(d=r.isSome(this._texture)&&this._texture.glTexture)&&d.descriptor.textureCoordinateScaleFactor?c.setUniform2fv("textureCoordinateScaleFactor",d.descriptor.textureCoordinateScaleFactor):c.setUniform2f("textureCoordinateScaleFactor",1,1)};g.prototype._acquireIfNotUndefined=function(d){if(!r.isNone(d))return this._textureIDs.add(d),this._textureRepository.acquire(d,this._initTransparent)};g.prototype._releaseIfNotUndefined=function(d){void 0!==d&&(this._textureIDs.delete(d),
this._textureRepository.release(d))};return g}(d.GLMaterial)})},"esri/views/3d/webgl-engine/materials/internal/bufferWriterUtils":function(){define(["require","exports","../../../support/buffer/BufferView","../../lib/Util"],function(u,f,e,r){function m(a,b,c,d,e){var g=c.typedBuffer;c=c.typedBufferStride;var f=a.length;d*=c;if(null==e||1===e)for(var k=0;k<f;++k){var l=2*a[k];g[d]=b[l];g[d+1]=b[l+1];d+=c}else for(k=0;k<f;++k)for(var l=2*a[k],q=0;q<e;++q)g[d]=b[l],g[d+1]=b[l+1],d+=c}function d(a,b,
c,d,e){var g=c.typedBuffer;c=c.typedBufferStride;var f=a.length;d*=c;if(null==e||1===e)for(var k=0;k<f;++k){var l=3*a[k];g[d]=b[l];g[d+1]=b[l+1];g[d+2]=b[l+2];d+=c}else for(k=0;k<f;++k)for(var l=3*a[k],q=0;q<e;++q)g[d]=b[l],g[d+1]=b[l+1],g[d+2]=b[l+2],d+=c}function g(a,b,c,d,e){var g=c.typedBuffer;c=c.typedBufferStride;var f=a.length;d*=c;if(null==e||1===e)for(var k=0;k<f;++k){var l=4*a[k];g[d]=b[l];g[d+1]=b[l+1];g[d+2]=b[l+2];g[d+3]=b[l+3];d+=c}else for(k=0;k<f;++k)for(var l=4*a[k],q=0;q<e;++q)g[d]=
b[l],g[d+1]=b[l+1],g[d+2]=b[l+2],g[d+3]=b[l+3],d+=c}function k(a,b,c,e,g,f){if(c){var k=e.typedBuffer;e=e.typedBufferStride;var l=a.length;g*=e;if(null==f||1===f)for(var q=0;q<l;++q){var m=3*a[q],t=b[m],r=b[m+1],v=b[m+2];k[g]=c[0]*t+c[4]*r+c[8]*v+c[12];k[g+1]=c[1]*t+c[5]*r+c[9]*v+c[13];k[g+2]=c[2]*t+c[6]*r+c[10]*v+c[14];g+=e}else for(q=0;q<l;++q)for(var m=3*a[q],t=b[m],r=b[m+1],v=b[m+2],m=c[0]*t+c[4]*r+c[8]*v+c[12],x=c[1]*t+c[5]*r+c[9]*v+c[13],t=c[2]*t+c[6]*r+c[10]*v+c[14],r=0;r<f;++r)k[g]=m,k[g+
1]=x,k[g+2]=t,g+=e}else d(a,b,e,g,f)}function l(a,b,c,e,g,f){if(c){var k=e.typedBuffer;e=e.typedBufferStride;var l=a.length,q=c[0],m=c[1],t=c[2],r=c[4],v=c[5],x=c[6],u=c[8],R=c[9];c=c[10];var T=1E-5<Math.abs(1-q*q+r*r+u*u)||1E-5<Math.abs(1-m*m+v*v+R*R)||1E-5<Math.abs(1-t*t+x*x+c*c);g*=e;if(null==f||1===f)for(var O=0;O<l;++O){var L=3*a[O],Q=b[L],S=b[L+1],aa=b[L+2];f=q*Q+r*S+u*aa;var L=m*Q+v*S+R*aa,ba=t*Q+x*S+c*aa;T&&(Q=f*f+L*L+ba*ba,.999999>Q&&1E-6<Q&&(Q=Math.sqrt(Q),f/=Q,L/=Q,ba/=Q));k[g+0]=f;k[g+
1]=L;k[g+2]=ba;g+=e}else for(O=0;O<l;++O)for(L=3*a[O],Q=b[L],S=b[L+1],aa=b[L+2],L=q*Q+r*S+u*aa,ba=m*Q+v*S+R*aa,S=t*Q+x*S+c*aa,T&&(Q=L*L+ba*ba+S*S,.999999>Q&&1E-6<Q&&(Q=Math.sqrt(Q),L/=Q,ba/=Q,S/=Q)),Q=0;Q<f;++Q)k[g+0]=L,k[g+1]=ba,k[g+2]=S,g+=e}else d(a,b,e,g,f)}function c(a,b,c,d,e,g){var f=d.typedBuffer;d=d.typedBufferStride;var k=a.length;e*=d;if(null==g||1===g)if(4===c)for(c=0;c<k;++c){var l=4*a[c];f[e]=b[l];f[e+1]=b[l+1];f[e+2]=b[l+2];f[e+3]=b[l+3];e+=d}else{if(3===c)for(c=0;c<k;++c)l=3*a[c],
f[e]=b[l],f[e+1]=b[l+1],f[e+2]=b[l+2],f[e+3]=255,e+=d}else if(4===c)for(c=0;c<k;++c)for(var l=4*a[c],q=0;q<g;++q)f[e]=b[l],f[e+1]=b[l+1],f[e+2]=b[l+2],f[e+3]=b[l+3],e+=d;else if(3===c)for(c=0;c<k;++c)for(l=3*a[c],q=0;q<g;++q)f[e]=b[l],f[e+1]=b[l+1],f[e+2]=b[l+2],f[e+3]=255,e+=d}Object.defineProperty(f,"__esModule",{value:!0});f.writeBufferVec2=m;f.writeBufferVec3=d;f.writeBufferVec4=g;f.writeBufferMat3f=function(a,b,c,d){var e=c.typedBuffer;c=c.typedBufferStride;var g=a.length;d*=c;for(var f=0;f<
g;++f){for(var k=9*a[f],l=0;9>l;++l)e[d+l]=b[k+l];d+=c}};f.writeBufferMat4f=function(a,b,c,d){var e=c.typedBuffer;c=c.typedBufferStride;var g=a.length;d*=c;for(var f=0;f<g;++f){for(var k=16*a[f],l=0;16>l;++l)e[d+l]=b[k+l];d+=c}};f.writePosition=k;f.writeNormal=l;f.writeColor=c;f.writeMultipliedColor=function(a,b,c,d,e,g,f){var k=e.typedBuffer;e=e.typedBufferStride;var l=a.length;g*=e;if(null==f||1===f)if(4===c)for(c=0;c<l;++c){var q=4*a[c];k[g]=b[q]*d[0];k[g+1]=b[q+1]*d[1];k[g+2]=b[q+2]*d[2];k[g+
3]=b[q+3]*d[3];g+=e}else{if(3===c){var m=255*d[3];for(c=0;c<l;++c)q=3*a[c],k[g]=b[q]*d[0],k[g+1]=b[q+1]*d[1],k[g+2]=b[q+2]*d[2],k[g+3]=m,g+=e}}else if(4===c)for(c=0;c<l;++c)for(var q=4*a[c],t=0;t<f;++t)k[g]=b[q]*d[0],k[g+1]=b[q+1]*d[1],k[g+2]=b[q+2]*d[2],k[g+3]=b[q+3]*d[3],g+=e;else if(3===c)for(m=255*d[3],c=0;c<l;++c)for(q=3*a[c],t=0;t<f;++t)k[g]=b[q]*d[0],k[g+1]=b[q+1]*d[1],k[g+2]=b[q+2]*d[2],k[g+3]=m,g+=e};f.writeDefaultAttributes=function(a,b,d,f,t,x){var q=0;for(b=b.fieldNames;q<b.length;q++){var v=
b[q],u=a.vertexAttr[v],H=a.indices[v];if(u&&H)switch(v){case r.VertexAttrConstants.POSITION:r.assert(3===u.size);(v=t.getField(v,e.BufferViewVec3f))&&k(H,u.data,d,v,x);break;case r.VertexAttrConstants.NORMAL:r.assert(3===u.size);(v=t.getField(v,e.BufferViewVec3f))&&l(H,u.data,f,v,x);break;case r.VertexAttrConstants.UV0:r.assert(2===u.size);(v=t.getField(v,e.BufferViewVec2f))&&m(H,u.data,v,x);break;case r.VertexAttrConstants.COLOR:r.assert(3===u.size||4===u.size);(v=t.getField(v,e.BufferViewVec4u8))&&
c(H,u.data,u.size,v,x);break;case r.VertexAttrConstants.SYMBOLCOLOR:r.assert(3===u.size||4===u.size);(v=t.getField(v,e.BufferViewVec4u8))&&c(H,u.data,u.size,v,x);break;case r.VertexAttrConstants.TANGENT:r.assert(4===u.size),(v=t.getField(v,e.BufferViewVec4f))&&g(H,u.data,v,x)}}}})},"esri/views/3d/webgl-engine/shaders/HUDMaterial.glsl":function(){define("require exports tslib ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../core/libs/gl-matrix-2/vec4f64 ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/hud/AlignPixel.glsl ../core/shaderLibrary/hud/HUD.glsl ../core/shaderLibrary/hud/HUDOcclusionPass.glsl ../core/shaderLibrary/output/OutputHighlight.glsl ../core/shaderLibrary/shading/VisualVariables.glsl ../core/shaderLibrary/util/AlphaDiscard.glsl ../core/shaderLibrary/util/ColorConversion.glsl ../core/shaderLibrary/util/RgbaFloatEncoding.glsl ../core/shaderLibrary/util/ScreenSizePerspective.glsl ../core/shaderModules/interfaces ../core/shaderModules/ShaderBuilder".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A){function E(a,b){void 0===b&&(b=H);if(a.textureIsSignedDistanceField){var c=a.anchorPos;a=a.distanceFieldBoundingBox;var d=b;d[0]=c[0]*(a[2]-a[0])+a[0];d[1]=c[1]*(a[3]-a[1])+a[1]}else r.vec2.copy(b,a.anchorPos);return b}Object.defineProperty(f,"__esModule",{value:!0});f.build=function(d){var f=new A.ShaderBuilder,m=d.signedDistanceFieldEnabled;f.include(k.AlignPixel);f.include(l.HUD,d);f.include(g.Slice,d);if(6===d.output)return f.include(c.HUDOcclusionPass,
d),f;f.include(x.ScreenSizePerspective);f.include(t.RgbaFloatEncoding);f.include(v.ColorConversion,{stages:1});f.include(b.VisualVariables,d);f.varyings.add("vcolor","vec4");f.varyings.add("vtc","vec2");f.varyings.add("vsize","vec2");d.binaryHighlightOcclusionEnabled&&f.varyings.add("voccluded","float");f.vertex.uniforms.add("screenOffset","vec2").add("anchorPos","vec2").add("textureCoordinateScaleFactor","vec2").add("materialColor","vec4");m&&f.vertex.uniforms.add("outlineColor","vec4");d.screenSizePerspectiveEnabled&&
f.vertex.uniforms.add("screenSizePerspective","vec4");(d.debugDrawBorder||d.binaryHighlightOcclusionEnabled)&&f.varyings.add("debugBorderCoords","vec4");f.attributes.add("uv0","vec2");f.attributes.add("color","vec4");f.attributes.add("size","vec2");f.attributes.add("auxpos2","vec4");f.vertex.code.add(z.glsl(G||(G=e.__makeTemplateObject(["\n    void main(void) {\n      ProjectHUDAux projectAux;\n      vec4 posProj \x3d projectPositionHUD(projectAux);\n\n      if (rejectBySlice(projectAux.posModel)) {\n        // Project outside of clip plane\n        gl_Position \x3d vec4(1e038, 1e038, 1e038, 1.0);\n        return;\n      }\n      vec2 inputSize;\n      ",
"\n\n      ","\n\n      vec2 combinedSize \x3d inputSize * pixelRatio;\n      vec4 quadOffset \x3d vec4(0.0);\n\n      ","\n\n      ","\n    "],["\n    void main(void) {\n      ProjectHUDAux projectAux;\n      vec4 posProj \x3d projectPositionHUD(projectAux);\n\n      if (rejectBySlice(projectAux.posModel)) {\n        // Project outside of clip plane\n        gl_Position \x3d vec4(1e038, 1e038, 1e038, 1.0);\n        return;\n      }\n      vec2 inputSize;\n      ","\n\n      ","\n\n      vec2 combinedSize \x3d inputSize * pixelRatio;\n      vec4 quadOffset \x3d vec4(0.0);\n\n      ",
"\n\n      ","\n    "])),d.screenSizePerspectiveEnabled?z.glsl(J||(J=e.__makeTemplateObject(["\n      inputSize \x3d screenSizePerspectiveScaleVec2(size, projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspective);\n      vec2 screenOffsetScaled \x3d screenSizePerspectiveScaleVec2(screenOffset, projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspectiveAlignment);\n         "],["\n      inputSize \x3d screenSizePerspectiveScaleVec2(size, projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspective);\n      vec2 screenOffsetScaled \x3d screenSizePerspectiveScaleVec2(screenOffset, projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspectiveAlignment);\n         "]))):
z.glsl(B||(B=e.__makeTemplateObject(["\n      inputSize \x3d size;\n      vec2 screenOffsetScaled \x3d screenOffset;"],["\n      inputSize \x3d size;\n      vec2 screenOffsetScaled \x3d screenOffset;"]))),d.vvSize?"inputSize *\x3d vvScale(auxpos2).xx;":"",d.occlusionTestEnabled||d.binaryHighlightOcclusionEnabled?"bool visible \x3d testVisibilityHUD(posProj);":"",d.binaryHighlightOcclusionEnabled?"voccluded \x3d visible ? 0.0 : 1.0;":""));var r=z.glsl(F||(F=e.__makeTemplateObject(["\n      vec2 uv01 \x3d floor(uv0);\n      vec2 uv \x3d uv0 - uv01;\n      quadOffset.xy \x3d ((uv01 - anchorPos) * 2.0 * combinedSize + screenOffsetScaled) / viewport.zw * posProj.w;\n  "],
["\n      vec2 uv01 \x3d floor(uv0);\n      vec2 uv \x3d uv0 - uv01;\n      quadOffset.xy \x3d ((uv01 - anchorPos) * 2.0 * combinedSize + screenOffsetScaled) / viewport.zw * posProj.w;\n  "]))),u=m?z.glsl(M||(M=e.__makeTemplateObject(["\n  posProj \x3d alignToPixelOrigin(posProj, viewport.zw) + quadOffset;"],["\n  posProj \x3d alignToPixelOrigin(posProj, viewport.zw) + quadOffset;"]))):z.glsl(R||(R=e.__makeTemplateObject(["\n  posProj +\x3d quadOffset;\n  if (inputSize.x \x3d\x3d size.x) {\n    posProj \x3d alignToPixelOrigin(posProj, viewport.zw);\n  }"],
["\n  posProj +\x3d quadOffset;\n  if (inputSize.x \x3d\x3d size.x) {\n    posProj \x3d alignToPixelOrigin(posProj, viewport.zw);\n  }"])));f.vertex.code.add(z.glsl(O||(O=e.__makeTemplateObject(["\n      ","\n      ","\n      ","\n\n      bool alphaDiscard \x3d vcolor.a \x3c ",";\n      ",'\n      if (alphaDiscard) {\n        // "early discard" if both symbol color (\x3d fill) and outline color (if applicable) are transparent\n        gl_Position \x3d vec4(1e38, 1e38, 1e38, 1.0);\n        return;\n      } else {\n        ',
"\n        gl_Position \x3d posProj;\n      }\n\n      vtc \x3d uv * textureCoordinateScaleFactor;\n\n      ","\n      vsize \x3d inputSize;\n      ","\n    }\n    "],["\n      ","\n      ","\n      ","\n\n      bool alphaDiscard \x3d vcolor.a \x3c ",";\n      ",'\n      if (alphaDiscard) {\n        // "early discard" if both symbol color (\x3d fill) and outline color (if applicable) are transparent\n        gl_Position \x3d vec4(1e38, 1e38, 1e38, 1.0);\n        return;\n      } else {\n        ',
"\n        gl_Position \x3d posProj;\n      }\n\n      vtc \x3d uv * textureCoordinateScaleFactor;\n\n      ","\n      vsize \x3d inputSize;\n      ","\n    }\n    "])),d.occlusionTestEnabled?"if (visible) {":"",r,d.vvColor?"vcolor \x3d vvGetColor(auxpos2, vvColorValues, vvColorColors) * materialColor;":"vcolor \x3d color / 255.0 * materialColor;",z.glsl.float(q.symbolAlphaCutoff),m?"alphaDiscard \x3d alphaDiscard \x26\x26 outlineColor.a \x3c "+z.glsl.float(q.symbolAlphaCutoff)+";":"",u,d.debugDrawBorder?
"debugBorderCoords \x3d vec4(uv01, 1.5 / combinedSize);":"",d.occlusionTestEnabled?z.glsl(T||(T=e.__makeTemplateObject(["} else { vtc \x3d vec2(0.0);\n        ",""],["} else { vtc \x3d vec2(0.0);\n        ",""])),d.debugDrawBorder?"debugBorderCoords \x3d vec4(0.5, 0.5, 1.5 / combinedSize);}":"}"):""));f.fragment.uniforms.add("tex","sampler2D");m&&(f.fragment.uniforms.add("outlineColor","vec4"),f.fragment.uniforms.add("outlineSize","float"));r=d.debugDrawBorder?z.glsl(L||(L=e.__makeTemplateObject(["(isBorder \x3e 0.0 ? 0.0 : ",
")"],["(isBorder \x3e 0.0 ? 0.0 : ",")"])),z.glsl.float(q.defaultMaskAlphaCutoff)):z.glsl.float(q.defaultMaskAlphaCutoff);m=z.glsl(V||(V=e.__makeTemplateObject(["\n    ","\n\n    ","\n\n    ","\n  "],["\n    ","\n\n    ","\n\n    ","\n  "])),d.debugDrawBorder?z.glsl(Q||(Q=e.__makeTemplateObject(["\n      float isBorder \x3d float(any(lessThan(debugBorderCoords.xy, debugBorderCoords.zw)) || any(greaterThan(debugBorderCoords.xy, 1.0 - debugBorderCoords.zw)));"],["\n      float isBorder \x3d float(any(lessThan(debugBorderCoords.xy, debugBorderCoords.zw)) || any(greaterThan(debugBorderCoords.xy, 1.0 - debugBorderCoords.zw)));"]))):
"",m?z.glsl(S||(S=e.__makeTemplateObject(["\n      vec4 fillPixelColor \x3d vcolor;\n\n      // Attempt to sample texel centers to avoid that thin cross outlines\n      // disappear with large symbol sizes.\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/7058#issuecomment-603041\n      const float txSize \x3d 128.0;\n      const float texelSize \x3d 1.0 / txSize;\n      // Calculate how much we have to add/subtract to/from each texel to reach the size of an onscreen pixel\n      vec2 scaleFactor \x3d (vsize - txSize) * texelSize;\n      vec2 samplePos \x3d vtc + (vec2(1.0, -1.0) * texelSize) * scaleFactor;\n\n      // Get distance and map it into [-0.5, 0.5]\n      float d \x3d rgba2float(texture2D(tex, samplePos)) - 0.5;\n\n      // Distance in output units (i.e. pixels)\n      float dist \x3d d * vsize.x;\n\n      // Create smooth transition from the icon into its outline\n      float fillAlphaFactor \x3d clamp(0.5 - dist, 0.0, 1.0);\n      fillPixelColor.a *\x3d fillAlphaFactor;\n\n      if (outlineSize \x3e 0.25) {\n        vec4 outlinePixelColor \x3d outlineColor;\n        float clampedOutlineSize \x3d min(outlineSize, 0.5*vsize.x);\n\n        // Create smooth transition around outline\n        float outlineAlphaFactor \x3d clamp(0.5 - (abs(dist) - 0.5*clampedOutlineSize), 0.0, 1.0);\n        outlinePixelColor.a *\x3d outlineAlphaFactor;\n\n        if (\n          outlineAlphaFactor + fillAlphaFactor \x3c ",
" ||\n          fillPixelColor.a + outlinePixelColor.a \x3c ","\n        ) {\n          discard;\n        }\n\n        // perform un-premultiplied over operator (see https://en.wikipedia.org/wiki/Alpha_compositing#Description)\n        float compositeAlpha \x3d outlinePixelColor.a + fillPixelColor.a * (1.0 - outlinePixelColor.a);\n        vec3 compositeColor \x3d vec3(outlinePixelColor) * outlinePixelColor.a +\n          vec3(fillPixelColor) * fillPixelColor.a * (1.0 - outlinePixelColor.a);\n\n        gl_FragColor \x3d vec4(compositeColor, compositeAlpha);\n      } else {\n        if (fillAlphaFactor \x3c ",
") {\n          discard;\n        }\n\n        gl_FragColor \x3d premultiplyAlpha(fillPixelColor);\n      }\n\n      // visualize SDF:\n      // gl_FragColor \x3d vec4(clamp(-dist/vsize.x*2.0, 0.0, 1.0), clamp(dist/vsize.x*2.0, 0.0, 1.0), 0.0, 1.0);\n      "],["\n      vec4 fillPixelColor \x3d vcolor;\n\n      // Attempt to sample texel centers to avoid that thin cross outlines\n      // disappear with large symbol sizes.\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/7058#issuecomment-603041\n      const float txSize \x3d 128.0;\n      const float texelSize \x3d 1.0 / txSize;\n      // Calculate how much we have to add/subtract to/from each texel to reach the size of an onscreen pixel\n      vec2 scaleFactor \x3d (vsize - txSize) * texelSize;\n      vec2 samplePos \x3d vtc + (vec2(1.0, -1.0) * texelSize) * scaleFactor;\n\n      // Get distance and map it into [-0.5, 0.5]\n      float d \x3d rgba2float(texture2D(tex, samplePos)) - 0.5;\n\n      // Distance in output units (i.e. pixels)\n      float dist \x3d d * vsize.x;\n\n      // Create smooth transition from the icon into its outline\n      float fillAlphaFactor \x3d clamp(0.5 - dist, 0.0, 1.0);\n      fillPixelColor.a *\x3d fillAlphaFactor;\n\n      if (outlineSize \x3e 0.25) {\n        vec4 outlinePixelColor \x3d outlineColor;\n        float clampedOutlineSize \x3d min(outlineSize, 0.5*vsize.x);\n\n        // Create smooth transition around outline\n        float outlineAlphaFactor \x3d clamp(0.5 - (abs(dist) - 0.5*clampedOutlineSize), 0.0, 1.0);\n        outlinePixelColor.a *\x3d outlineAlphaFactor;\n\n        if (\n          outlineAlphaFactor + fillAlphaFactor \x3c ",
" ||\n          fillPixelColor.a + outlinePixelColor.a \x3c ","\n        ) {\n          discard;\n        }\n\n        // perform un-premultiplied over operator (see https://en.wikipedia.org/wiki/Alpha_compositing#Description)\n        float compositeAlpha \x3d outlinePixelColor.a + fillPixelColor.a * (1.0 - outlinePixelColor.a);\n        vec3 compositeColor \x3d vec3(outlinePixelColor) * outlinePixelColor.a +\n          vec3(fillPixelColor) * fillPixelColor.a * (1.0 - outlinePixelColor.a);\n\n        gl_FragColor \x3d vec4(compositeColor, compositeAlpha);\n      } else {\n        if (fillAlphaFactor \x3c ",
") {\n          discard;\n        }\n\n        gl_FragColor \x3d premultiplyAlpha(fillPixelColor);\n      }\n\n      // visualize SDF:\n      // gl_FragColor \x3d vec4(clamp(-dist/vsize.x*2.0, 0.0, 1.0), clamp(dist/vsize.x*2.0, 0.0, 1.0), 0.0, 1.0);\n      "])),r,z.glsl.float(q.symbolAlphaCutoff),r):z.glsl(aa||(aa=e.__makeTemplateObject(["\n          vec4 texColor \x3d texture2D(tex, vtc, -0.5);\n          if (texColor.a \x3c ",") {\n            discard;\n          }\n          gl_FragColor \x3d texColor * premultiplyAlpha(vcolor);\n          "],
["\n          vec4 texColor \x3d texture2D(tex, vtc, -0.5);\n          if (texColor.a \x3c ",") {\n            discard;\n          }\n          gl_FragColor \x3d texColor * premultiplyAlpha(vcolor);\n          "])),r),d.debugDrawBorder?z.glsl(ba||(ba=e.__makeTemplateObject(["gl_FragColor \x3d mix(gl_FragColor, vec4(1.0, 0.0, 1.0, 1.0), isBorder);"],["gl_FragColor \x3d mix(gl_FragColor, vec4(1.0, 0.0, 1.0, 1.0), isBorder);"]))):"");0===d.output&&f.fragment.code.add(z.glsl(Z||(Z=e.__makeTemplateObject(["\n    void main() {\n      ",
"\n    }\n    "],["\n    void main() {\n      ","\n    }\n    "])),m));4===d.output&&(f.include(a.OutputHighlight),f.fragment.code.add(z.glsl(X||(X=e.__makeTemplateObject(["\n    void main() {\n      ","\n      ","\n    }\n    "],["\n    void main() {\n      ","\n      ","\n    }\n    "])),m,d.binaryHighlightOcclusionEnabled?z.glsl(ha||(ha=e.__makeTemplateObject(["\n          if (voccluded \x3d\x3d 1.0) {\n            gl_FragColor \x3d vec4(1.0, 1.0, 0.0, 1.0);\n          } else {\n            gl_FragColor \x3d vec4(1.0, 0.0, 1.0, 1.0);\n          }"],
["\n          if (voccluded \x3d\x3d 1.0) {\n            gl_FragColor \x3d vec4(1.0, 1.0, 0.0, 1.0);\n          } else {\n            gl_FragColor \x3d vec4(1.0, 0.0, 1.0, 1.0);\n          }"]))):"outputHighlight();")));return f};(function(a){a.bindUniforms=function(a,b,c){a.setUniform4fv("materialColor",b.color);b.textureIsSignedDistanceField&&(0>=b.outlineColor[3]||0>=b.outlineSize?(a.setUniform4fv("outlineColor",d.vec4f64.ZEROS),a.setUniform1f("outlineSize",0)):(a.setUniform4fv("outlineColor",
b.outlineColor),a.setUniform1f("outlineSize",b.outlineSize)));c=c.pixelRatio||1;a.setUniform2f("screenOffset",2*b.screenOffset[0]*c,2*b.screenOffset[1]*c);a.setUniform2fv("anchorPos",E(b))}})(f.HUDMaterial||(f.HUDMaterial={}));f.calculateAnchorPosForRendering=E;var H=m.vec2f64.create(),J,B,G,F,M,R,T,O,L,Q,S,aa,ba,V,Z,ha,X})},"esri/views/3d/webgl-engine/core/shaderLibrary/hud/AlignPixel.glsl":function(){define(["require","exports","tslib","../../shaderModules/interfaces"],function(u,f,e,r){Object.defineProperty(f,
"__esModule",{value:!0});f.AlignPixel=function(g){var f=r.glsl(m||(m=e.__makeTemplateObject(["\n    vec4 alignToPixelCenter(vec4 clipCoord, vec2 widthHeight) {\n      vec2 xy \x3d vec2(0.500123) + 0.5 * clipCoord.xy / clipCoord.w;\n      vec2 pixelSz \x3d vec2(1.0) / widthHeight;\n      vec2 ij \x3d (floor(xy * widthHeight) + vec2(0.5)) * pixelSz;\n      vec2 result \x3d (ij * 2.0 - vec2(1.0)) * clipCoord.w;\n      return vec4(result, clipCoord.zw);\n    }\n  "],["\n    vec4 alignToPixelCenter(vec4 clipCoord, vec2 widthHeight) {\n      vec2 xy \x3d vec2(0.500123) + 0.5 * clipCoord.xy / clipCoord.w;\n      vec2 pixelSz \x3d vec2(1.0) / widthHeight;\n      vec2 ij \x3d (floor(xy * widthHeight) + vec2(0.5)) * pixelSz;\n      vec2 result \x3d (ij * 2.0 - vec2(1.0)) * clipCoord.w;\n      return vec4(result, clipCoord.zw);\n    }\n  "]))),
l=r.glsl(d||(d=e.__makeTemplateObject(["\n\n    vec4 alignToPixelOrigin(vec4 clipCoord, vec2 widthHeight) {\n      vec2 xy \x3d vec2(0.5) + 0.5 * clipCoord.xy / clipCoord.w;\n      vec2 pixelSz \x3d vec2(1.0) / widthHeight;\n      vec2 ij \x3d floor((xy + 0.5 * pixelSz) * widthHeight) * pixelSz;\n      vec2 result \x3d (ij * 2.0 - vec2(1.0)) * clipCoord.w;\n      return vec4(result, clipCoord.zw);\n    }\n  "],["\n\n    vec4 alignToPixelOrigin(vec4 clipCoord, vec2 widthHeight) {\n      vec2 xy \x3d vec2(0.5) + 0.5 * clipCoord.xy / clipCoord.w;\n      vec2 pixelSz \x3d vec2(1.0) / widthHeight;\n      vec2 ij \x3d floor((xy + 0.5 * pixelSz) * widthHeight) * pixelSz;\n      vec2 result \x3d (ij * 2.0 - vec2(1.0)) * clipCoord.w;\n      return vec4(result, clipCoord.zw);\n    }\n  "])));
g.vertex.code.add(f);g.vertex.code.add(l);g.fragment.code.add(f);g.fragment.code.add(l)};var m,d})},"esri/views/3d/webgl-engine/core/shaderLibrary/hud/HUD.glsl":function(){define(["require","exports","tslib","../util/ScreenSizePerspective.glsl","../../shaderModules/interfaces"],function(u,f,e,r,m){function d(d,f){d.include(r.ScreenSizePerspective);d.attributes.add("position","vec3");d.attributes.add("normal","vec3");d.attributes.add("auxpos1","vec4");d.vertex.uniforms.add("proj","mat4");d.vertex.uniforms.add("view",
"mat4");d.vertex.uniforms.add("viewNormal","mat4");d.vertex.uniforms.add("viewport","vec4");d.vertex.uniforms.add("camPos","vec3");d.vertex.uniforms.add("polygonOffset","float");d.vertex.uniforms.add("cameraGroundRelative","float");d.vertex.uniforms.add("pixelRatio","float");d.vertex.uniforms.add("perDistancePixelRatio","float");d.vertex.uniforms.add("uRenderTransparentlyOccludedHUD","float");f.verticalOffsetEnabled&&d.vertex.uniforms.add("verticalOffset","vec4");f.screenSizePerspectiveEnabled&&d.vertex.uniforms.add("screenSizePerspectiveAlignment",
"vec4");d.vertex.uniforms.add("hudVisibilityTexture","sampler2D");d.vertex.defines.addFloat("SMALL_OFFSET_ANGLE",.984807753012208);d.vertex.code.add(m.glsl(g||(g=e.__makeTemplateObject(["\n    struct ProjectHUDAux {\n      vec3 posModel;\n      vec3 posView;\n      vec3 vnormal;\n\n      float distanceToCamera;\n      float absCosAngle;\n    };\n  "],["\n    struct ProjectHUDAux {\n      vec3 posModel;\n      vec3 posView;\n      vec3 vnormal;\n\n      float distanceToCamera;\n      float absCosAngle;\n    };\n  "]))));
d.vertex.code.add(m.glsl(k||(k=e.__makeTemplateObject(["\n    float applyHUDViewDependentPolygonOffset(float pointGroundDistance, float absCosAngle, inout vec3 posView) {\n      float pointGroundSign \x3d sign(pointGroundDistance);\n\n      if (pointGroundSign \x3d\x3d 0.0) {\n        pointGroundSign \x3d cameraGroundRelative;\n      }\n\n      // cameraGroundRelative is -1 if camera is below ground, 1 if above ground\n      // groundRelative is 1 if both camera and symbol are on the same side of the ground, -1 otherwise\n      float groundRelative \x3d cameraGroundRelative * pointGroundSign;\n\n      // view angle dependent part of polygon offset emulation\n      // we take the absolute value because the sign that is dropped is\n      // instead introduced using the ground-relative position of the symbol and the camera\n      if (polygonOffset \x3e .0) {\n        float cosAlpha \x3d clamp(absCosAngle, 0.01, 1.0);\n\n        float tanAlpha \x3d sqrt(1.0 - cosAlpha * cosAlpha) / cosAlpha;\n        float factor \x3d (1.0 - tanAlpha / viewport[2]);\n\n        // same side of the terrain\n        if (groundRelative \x3e 0.0) {\n          posView *\x3d factor;\n        }\n        // opposite sides of the terrain\n        else {\n          posView /\x3d factor;\n        }\n      }\n\n      return groundRelative;\n    }\n  "],
["\n    float applyHUDViewDependentPolygonOffset(float pointGroundDistance, float absCosAngle, inout vec3 posView) {\n      float pointGroundSign \x3d sign(pointGroundDistance);\n\n      if (pointGroundSign \x3d\x3d 0.0) {\n        pointGroundSign \x3d cameraGroundRelative;\n      }\n\n      // cameraGroundRelative is -1 if camera is below ground, 1 if above ground\n      // groundRelative is 1 if both camera and symbol are on the same side of the ground, -1 otherwise\n      float groundRelative \x3d cameraGroundRelative * pointGroundSign;\n\n      // view angle dependent part of polygon offset emulation\n      // we take the absolute value because the sign that is dropped is\n      // instead introduced using the ground-relative position of the symbol and the camera\n      if (polygonOffset \x3e .0) {\n        float cosAlpha \x3d clamp(absCosAngle, 0.01, 1.0);\n\n        float tanAlpha \x3d sqrt(1.0 - cosAlpha * cosAlpha) / cosAlpha;\n        float factor \x3d (1.0 - tanAlpha / viewport[2]);\n\n        // same side of the terrain\n        if (groundRelative \x3e 0.0) {\n          posView *\x3d factor;\n        }\n        // opposite sides of the terrain\n        else {\n          posView /\x3d factor;\n        }\n      }\n\n      return groundRelative;\n    }\n  "]))));
d.vertex.code.add(m.glsl(l||(l=e.__makeTemplateObject(["\n    void applyHUDVerticalGroundOffset(vec3 normalModel, inout vec3 posModel, inout vec3 posView) {\n      float distanceToCamera \x3d length(posView);\n\n      // Compute offset in world units for a half pixel shift\n      float pixelOffset \x3d distanceToCamera * perDistancePixelRatio * 0.5;\n\n      // Apply offset along normal in the direction away from the ground surface\n      vec3 modelOffset \x3d normalModel * cameraGroundRelative * pixelOffset;\n\n      // Apply the same offset also on the view space position\n      vec3 viewOffset \x3d (viewNormal * vec4(modelOffset, 1.0)).xyz;\n\n      posModel +\x3d modelOffset;\n      posView +\x3d viewOffset;\n    }\n  "],
["\n    void applyHUDVerticalGroundOffset(vec3 normalModel, inout vec3 posModel, inout vec3 posView) {\n      float distanceToCamera \x3d length(posView);\n\n      // Compute offset in world units for a half pixel shift\n      float pixelOffset \x3d distanceToCamera * perDistancePixelRatio * 0.5;\n\n      // Apply offset along normal in the direction away from the ground surface\n      vec3 modelOffset \x3d normalModel * cameraGroundRelative * pixelOffset;\n\n      // Apply the same offset also on the view space position\n      vec3 viewOffset \x3d (viewNormal * vec4(modelOffset, 1.0)).xyz;\n\n      posModel +\x3d modelOffset;\n      posView +\x3d viewOffset;\n    }\n  "]))));
d.vertex.code.add(m.glsl(b||(b=e.__makeTemplateObject(["\n    vec4 projectPositionHUD(out ProjectHUDAux aux) {\n      // centerOffset is in view space and is used to implement world size offsetting\n      // of labels with respect to objects. It also pulls the label towards the viewer\n      // so that the label is visible in front of the object.\n      vec3 centerOffset \x3d auxpos1.xyz;\n\n      // The pointGroundDistance is the distance of the geometry to the ground and is\n      // negative if the point is below the ground, or positive if the point is above\n      // ground.\n      float pointGroundDistance \x3d auxpos1.w;\n\n      aux.posModel \x3d position;\n      aux.posView \x3d (view * vec4(aux.posModel, 1.0)).xyz;\n      aux.vnormal \x3d normal;\n\n      applyHUDVerticalGroundOffset(aux.vnormal, aux.posModel, aux.posView);\n\n      // Screen sized offset in world space, used for example for line callouts\n      // Note: keep this implementation in sync with the CPU implementation, see\n      //   - MaterialUtil.verticalOffsetAtDistance\n      //   - HUDMaterial.applyVerticalOffsetTransformation\n\n      aux.distanceToCamera \x3d length(aux.posView);\n\n      vec3 viewDirObjSpace \x3d normalize(camPos - aux.posModel);\n      float cosAngle \x3d dot(aux.vnormal, viewDirObjSpace);\n\n      aux.absCosAngle \x3d abs(cosAngle);\n\n      ",
"\n\n      ","\n\n      ","\n\n      float groundRelative \x3d applyHUDViewDependentPolygonOffset(pointGroundDistance, aux.absCosAngle, aux.posView);\n\n      ","\n\n      vec4 posProj \x3d proj * vec4(aux.posView, 1.0);\n\n      ","\n\n      ","\n\n      // constant part of polygon offset emulation\n      posProj.z -\x3d groundRelative * polygonOffset * posProj.w;\n      return posProj;\n    }\n  "],["\n    vec4 projectPositionHUD(out ProjectHUDAux aux) {\n      // centerOffset is in view space and is used to implement world size offsetting\n      // of labels with respect to objects. It also pulls the label towards the viewer\n      // so that the label is visible in front of the object.\n      vec3 centerOffset \x3d auxpos1.xyz;\n\n      // The pointGroundDistance is the distance of the geometry to the ground and is\n      // negative if the point is below the ground, or positive if the point is above\n      // ground.\n      float pointGroundDistance \x3d auxpos1.w;\n\n      aux.posModel \x3d position;\n      aux.posView \x3d (view * vec4(aux.posModel, 1.0)).xyz;\n      aux.vnormal \x3d normal;\n\n      applyHUDVerticalGroundOffset(aux.vnormal, aux.posModel, aux.posView);\n\n      // Screen sized offset in world space, used for example for line callouts\n      // Note: keep this implementation in sync with the CPU implementation, see\n      //   - MaterialUtil.verticalOffsetAtDistance\n      //   - HUDMaterial.applyVerticalOffsetTransformation\n\n      aux.distanceToCamera \x3d length(aux.posView);\n\n      vec3 viewDirObjSpace \x3d normalize(camPos - aux.posModel);\n      float cosAngle \x3d dot(aux.vnormal, viewDirObjSpace);\n\n      aux.absCosAngle \x3d abs(cosAngle);\n\n      ",
"\n\n      ","\n\n      ","\n\n      float groundRelative \x3d applyHUDViewDependentPolygonOffset(pointGroundDistance, aux.absCosAngle, aux.posView);\n\n      ","\n\n      vec4 posProj \x3d proj * vec4(aux.posView, 1.0);\n\n      ","\n\n      ","\n\n      // constant part of polygon offset emulation\n      posProj.z -\x3d groundRelative * polygonOffset * posProj.w;\n      return posProj;\n    }\n  "])),f.screenSizePerspectiveEnabled?f.verticalOffsetEnabled||1===f.screenCenterOffsetUnitsEnabled?"vec4 perspectiveFactor \x3d screenSizePerspectiveScaleFactor(aux.absCosAngle, aux.distanceToCamera, screenSizePerspectiveAlignment);":
"":"",f.verticalOffsetEnabled?f.screenSizePerspectiveEnabled?"float verticalOffsetScreenHeight \x3d applyScreenSizePerspectiveScaleFactorFloat(verticalOffset.x, perspectiveFactor);":"float verticalOffsetScreenHeight \x3d verticalOffset.x;":"",f.verticalOffsetEnabled?m.glsl(c||(c=e.__makeTemplateObject(["\n            float worldOffset \x3d clamp(verticalOffsetScreenHeight * verticalOffset.y * aux.distanceToCamera, verticalOffset.z, verticalOffset.w);\n            vec3 modelOffset \x3d aux.vnormal * worldOffset;\n            aux.posModel +\x3d modelOffset;\n            vec3 viewOffset \x3d (viewNormal * vec4(modelOffset, 1.0)).xyz;\n            aux.posView +\x3d viewOffset;\n            // Since we elevate the object, we need to take that into account\n            // in the distance to ground\n            pointGroundDistance +\x3d worldOffset;"],
["\n            float worldOffset \x3d clamp(verticalOffsetScreenHeight * verticalOffset.y * aux.distanceToCamera, verticalOffset.z, verticalOffset.w);\n            vec3 modelOffset \x3d aux.vnormal * worldOffset;\n            aux.posModel +\x3d modelOffset;\n            vec3 viewOffset \x3d (viewNormal * vec4(modelOffset, 1.0)).xyz;\n            aux.posView +\x3d viewOffset;\n            // Since we elevate the object, we need to take that into account\n            // in the distance to ground\n            pointGroundDistance +\x3d worldOffset;"]))):
"",1!==f.screenCenterOffsetUnitsEnabled?m.glsl(a||(a=e.__makeTemplateObject(["\n            // Apply x/y in view space, but z in screen space (i.e. along posView direction)\n            aux.posView +\x3d vec3(centerOffset.x, centerOffset.y, 0.0);\n\n            // Same material all have same z !\x3d 0.0 condition so should not lead to\n            // branch fragmentation and will save a normalization if it's not needed\n            if (centerOffset.z !\x3d 0.0) {\n              aux.posView -\x3d normalize(aux.posView) * centerOffset.z;\n            }\n          "],
["\n            // Apply x/y in view space, but z in screen space (i.e. along posView direction)\n            aux.posView +\x3d vec3(centerOffset.x, centerOffset.y, 0.0);\n\n            // Same material all have same z !\x3d 0.0 condition so should not lead to\n            // branch fragmentation and will save a normalization if it's not needed\n            if (centerOffset.z !\x3d 0.0) {\n              aux.posView -\x3d normalize(aux.posView) * centerOffset.z;\n            }\n          "]))):"",
1===f.screenCenterOffsetUnitsEnabled?f.screenSizePerspectiveEnabled?"float centerOffsetY \x3d applyScreenSizePerspectiveScaleFactorFloat(centerOffset.y, perspectiveFactor);":"float centerOffsetY \x3d centerOffset.y;":"",1===f.screenCenterOffsetUnitsEnabled?"posProj.xy +\x3d vec2(centerOffset.x, centerOffsetY) * pixelRatio * 2.0 / viewport.zw * posProj.w;":""));d.vertex.code.add(m.glsl(q||(q=e.__makeTemplateObject(["\n    bool testVisibilityHUD(vec4 posProj) {\n      // For occlusion testing, use the nearest pixel center to avoid\n      // subpixel filtering messing up the color we use to test for\n      vec4 posProjCenter \x3d alignToPixelCenter(posProj, viewport.zw);\n\n      vec4 occlusionPixel \x3d texture2D(hudVisibilityTexture, .5 + .5 * posProjCenter.xy / posProjCenter.w);\n\n      // the red pixel here indicates that the occlusion pixel passed the depth test against solid geometry and was written\n      // the green pixel stores transparency of transparent geometry (1.0 -\x3e fully transparent)\n      // note that we also check against green \x3d\x3d 0.0, i.e. transparent geometry that has opaque parts\n\n      // thus we render visible pixels that are occluded by semi-transparent (but not fully transparent!) geometry here\n      if (uRenderTransparentlyOccludedHUD \x3e 0.5) {\n        // multiplying by uRenderTransparentlyOccludedHUD allows us to ignore the second condition if\n        // uRenderTransparentlyOccludedHUD \x3d 0.75\n        return occlusionPixel.r * occlusionPixel.g \x3e 0.0 \x26\x26 occlusionPixel.g * uRenderTransparentlyOccludedHUD \x3c 1.0;\n      }\n\n      // and visible pixels that are not occluded by semi-transparent geometry here\n      return occlusionPixel.r * occlusionPixel.g \x3e 0.0 \x26\x26 occlusionPixel.g \x3d\x3d 1.0;\n    }\n  "],
["\n    bool testVisibilityHUD(vec4 posProj) {\n      // For occlusion testing, use the nearest pixel center to avoid\n      // subpixel filtering messing up the color we use to test for\n      vec4 posProjCenter \x3d alignToPixelCenter(posProj, viewport.zw);\n\n      vec4 occlusionPixel \x3d texture2D(hudVisibilityTexture, .5 + .5 * posProjCenter.xy / posProjCenter.w);\n\n      // the red pixel here indicates that the occlusion pixel passed the depth test against solid geometry and was written\n      // the green pixel stores transparency of transparent geometry (1.0 -\x3e fully transparent)\n      // note that we also check against green \x3d\x3d 0.0, i.e. transparent geometry that has opaque parts\n\n      // thus we render visible pixels that are occluded by semi-transparent (but not fully transparent!) geometry here\n      if (uRenderTransparentlyOccludedHUD \x3e 0.5) {\n        // multiplying by uRenderTransparentlyOccludedHUD allows us to ignore the second condition if\n        // uRenderTransparentlyOccludedHUD \x3d 0.75\n        return occlusionPixel.r * occlusionPixel.g \x3e 0.0 \x26\x26 occlusionPixel.g * uRenderTransparentlyOccludedHUD \x3c 1.0;\n      }\n\n      // and visible pixels that are not occluded by semi-transparent geometry here\n      return occlusionPixel.r * occlusionPixel.g \x3e 0.0 \x26\x26 occlusionPixel.g \x3d\x3d 1.0;\n    }\n  "]))))}
Object.defineProperty(f,"__esModule",{value:!0});f.HUD=d;(function(a){(function(a){a[a.OCCLUDED=0]="OCCLUDED";a[a.NOTOCCLUDED=1]="NOTOCCLUDED";a[a.BOTH=2]="BOTH";a[a.COUNT=3]="COUNT"})(a.TransparentRenderStyle||(a.TransparentRenderStyle={}));a.bindUniforms=function(b,c){b.setUniform1f("uRenderTransparentlyOccludedHUD",c.renderTransparentlyOccludedHUD===a.TransparentRenderStyle.OCCLUDED?1:c.renderTransparentlyOccludedHUD===a.TransparentRenderStyle.NOTOCCLUDED?0:.75)};a.bindVisibilityTexture=function(a,
b,c){b.setUniform1i("hudVisibilityTexture",1);a.bindTexture(c.hudVisibilityTexture,1);a.setActiveTexture(0)}})(d=f.HUD||(f.HUD={}));var g,k,l,c,a,b,q})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/ScreenSizePerspective.glsl":function(){define(["require","exports","tslib","../../shaderModules/interfaces","../../../materials/internal/MaterialUtil"],function(u,f,e,r,m){function d(d){d.vertex.code.add(r.glsl(g||(g=e.__makeTemplateObject(["\n    float screenSizePerspectiveMinSize(float size, vec4 factor) {\n      float nonZeroSize \x3d 1.0 - step(size, 0.0);\n\n      return (\n        factor.z * (\n          1.0 +\n          // Multiply by nzs ensures if size is 0, then we ignore proportionally scaled padding\n          nonZeroSize *\n          2.0 * factor.w / (\n            size + (1.0 - nonZeroSize) // Adding 1 - nzs ensures we divide either by size, or by 1\n          )\n        )\n      );\n    }\n  "],
["\n    float screenSizePerspectiveMinSize(float size, vec4 factor) {\n      float nonZeroSize \x3d 1.0 - step(size, 0.0);\n\n      return (\n        factor.z * (\n          1.0 +\n          // Multiply by nzs ensures if size is 0, then we ignore proportionally scaled padding\n          nonZeroSize *\n          2.0 * factor.w / (\n            size + (1.0 - nonZeroSize) // Adding 1 - nzs ensures we divide either by size, or by 1\n          )\n        )\n      );\n    }\n  "]))));d.vertex.code.add(r.glsl(k||
(k=e.__makeTemplateObject(["\n    float screenSizePerspectiveViewAngleDependentFactor(float absCosAngle) {\n      return absCosAngle * absCosAngle * absCosAngle;\n    }\n  "],["\n    float screenSizePerspectiveViewAngleDependentFactor(float absCosAngle) {\n      return absCosAngle * absCosAngle * absCosAngle;\n    }\n  "]))));d.vertex.code.add(r.glsl(l||(l=e.__makeTemplateObject(["\n    vec4 screenSizePerspectiveScaleFactor(float absCosAngle, float distanceToCamera, vec4 params) {\n      return vec4(\n        min(params.x / (distanceToCamera - params.y), 1.0),\n        screenSizePerspectiveViewAngleDependentFactor(absCosAngle),\n        params.z,\n        params.w\n      );\n    }\n  "],
["\n    vec4 screenSizePerspectiveScaleFactor(float absCosAngle, float distanceToCamera, vec4 params) {\n      return vec4(\n        min(params.x / (distanceToCamera - params.y), 1.0),\n        screenSizePerspectiveViewAngleDependentFactor(absCosAngle),\n        params.z,\n        params.w\n      );\n    }\n  "]))));d.vertex.code.add(r.glsl(c||(c=e.__makeTemplateObject(["\n    float applyScreenSizePerspectiveScaleFactorFloat(float size, vec4 factor) {\n      return max(mix(size * factor.x, size, factor.y), screenSizePerspectiveMinSize(size, factor));\n    }\n  "],
["\n    float applyScreenSizePerspectiveScaleFactorFloat(float size, vec4 factor) {\n      return max(mix(size * factor.x, size, factor.y), screenSizePerspectiveMinSize(size, factor));\n    }\n  "]))));d.vertex.code.add(r.glsl(a||(a=e.__makeTemplateObject(["\n    float screenSizePerspectiveScaleFloat(float size, float absCosAngle, float distanceToCamera, vec4 params) {\n      return applyScreenSizePerspectiveScaleFactorFloat(\n        size,\n        screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params)\n      );\n    }\n  "],
["\n    float screenSizePerspectiveScaleFloat(float size, float absCosAngle, float distanceToCamera, vec4 params) {\n      return applyScreenSizePerspectiveScaleFactorFloat(\n        size,\n        screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params)\n      );\n    }\n  "]))));d.vertex.code.add(r.glsl(b||(b=e.__makeTemplateObject(["\n    vec2 applyScreenSizePerspectiveScaleFactorVec2(vec2 size, vec4 factor) {\n      return mix(size * clamp(factor.x, screenSizePerspectiveMinSize(size.y, factor) / size.y, 1.0), size, factor.y);\n    }\n  "],
["\n    vec2 applyScreenSizePerspectiveScaleFactorVec2(vec2 size, vec4 factor) {\n      return mix(size * clamp(factor.x, screenSizePerspectiveMinSize(size.y, factor) / size.y, 1.0), size, factor.y);\n    }\n  "]))));d.vertex.code.add(r.glsl(q||(q=e.__makeTemplateObject(["\n    vec2 screenSizePerspectiveScaleVec2(vec2 size, float absCosAngle, float distanceToCamera, vec4 params) {\n      return applyScreenSizePerspectiveScaleFactorVec2(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params));\n    }\n  "],
["\n    vec2 screenSizePerspectiveScaleVec2(vec2 size, float absCosAngle, float distanceToCamera, vec4 params) {\n      return applyScreenSizePerspectiveScaleFactorVec2(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params));\n    }\n  "]))))}Object.defineProperty(f,"__esModule",{value:!0});f.ScreenSizePerspective=d;(function(a){a.bindUniforms=function(a,b){b.screenSizePerspective&&(m.bindScreenSizePerspective(b.screenSizePerspective,a,"screenSizePerspective"),m.bindScreenSizePerspective(b.screenSizePerspectiveAlignment||
b.screenSizePerspective,a,"screenSizePerspectiveAlignment"))}})(d=f.ScreenSizePerspective||(f.ScreenSizePerspective={}));var g,k,l,c,a,b,q})},"esri/views/3d/webgl-engine/core/shaderLibrary/hud/HUDOcclusionPass.glsl":function(){define(["require","exports","tslib","../../shaderModules/interfaces"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.HUDOcclusionPass=function(g){g.vertex.code.add(r.glsl(m||(m=e.__makeTemplateObject(["\n  void main(void) {\n    vec4 posProjCenter;\n    if (dot(position, position) \x3e 0.0) {\n      // Render single point to center of the pixel to avoid subpixel\n      // filtering to affect the marker color\n      ProjectHUDAux projectAux;\n      vec4 posProj \x3d projectPositionHUD(projectAux);\n      posProjCenter \x3d alignToPixelCenter(posProj, viewport.zw);\n\n      vec3 vpos \x3d projectAux.posModel;\n      if (rejectBySlice(vpos)) {\n        // Project out of clip space\n        posProjCenter \x3d vec4(1e038, 1e038, 1e038, 1.0);\n      }\n    }\n    else {\n      // Project out of clip space\n      posProjCenter \x3d vec4(1e038, 1e038, 1e038, 1.0);\n    }\n\n    gl_Position \x3d posProjCenter;\n    gl_PointSize \x3d 1.0;\n  }\n  "],
["\n  void main(void) {\n    vec4 posProjCenter;\n    if (dot(position, position) \x3e 0.0) {\n      // Render single point to center of the pixel to avoid subpixel\n      // filtering to affect the marker color\n      ProjectHUDAux projectAux;\n      vec4 posProj \x3d projectPositionHUD(projectAux);\n      posProjCenter \x3d alignToPixelCenter(posProj, viewport.zw);\n\n      vec3 vpos \x3d projectAux.posModel;\n      if (rejectBySlice(vpos)) {\n        // Project out of clip space\n        posProjCenter \x3d vec4(1e038, 1e038, 1e038, 1.0);\n      }\n    }\n    else {\n      // Project out of clip space\n      posProjCenter \x3d vec4(1e038, 1e038, 1e038, 1.0);\n    }\n\n    gl_Position \x3d posProjCenter;\n    gl_PointSize \x3d 1.0;\n  }\n  "]))));
g.fragment.uniforms.add("color","vec4");g.fragment.code.add(r.glsl(d||(d=e.__makeTemplateObject(["\n  void main() {\n    gl_FragColor \x3d color;\n  }\n  "],["\n  void main() {\n    gl_FragColor \x3d color;\n  }\n  "]))))};(function(d){d.bindUniforms=function(d){d.setUniform4f("color",1,1,1,1)}})(f.HUDOcclusion||(f.HUDOcclusion={}));var m,d})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl":function(){define(["require","exports","tslib","../../shaderModules/interfaces"],function(u,
f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.defaultMaskAlphaCutoff=.1;f.symbolAlphaCutoff=.001;f.DiscardOrAdjustAlpha=function(f,c){var a=f.fragment;switch(c.alphaDiscardMode){case 0:a.code.add(r.glsl(m||(m=e.__makeTemplateObject(["\n        void discardOrAdjustAlpha(inout vec4 color) {}\n      "],["\n        void discardOrAdjustAlpha(inout vec4 color) {}\n      "]))));break;case 1:a.code.add(r.glsl(d||(d=e.__makeTemplateObject(["\n        void discardOrAdjustAlpha(inout vec4 color) {\n          color.a \x3d 1.0;\n        }\n      "],
["\n        void discardOrAdjustAlpha(inout vec4 color) {\n          color.a \x3d 1.0;\n        }\n      "]))));break;case 2:a.uniforms.add("textureAlphaCutoff","float");a.code.add(r.glsl(g||(g=e.__makeTemplateObject(["\n        #define discardOrAdjustAlpha(color) { if (color.a \x3c textureAlphaCutoff) { discard; } else { color.a \x3d 1.0; } }\n      "],["\n        #define discardOrAdjustAlpha(color) { if (color.a \x3c textureAlphaCutoff) { discard; } else { color.a \x3d 1.0; } }\n      "]))));break;
case 3:f.fragment.uniforms.add("textureAlphaCutoff","float"),f.fragment.code.add(r.glsl(k||(k=e.__makeTemplateObject(["\n        #define discardOrAdjustAlpha(color) { if (color.a \x3c textureAlphaCutoff) { discard; } }\n      "],["\n        #define discardOrAdjustAlpha(color) { if (color.a \x3c textureAlphaCutoff) { discard; } }\n      "]))))}};var m,d,g,k})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl":function(){define(["require","exports","tslib","../../shaderModules/interfaces"],
function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.ColorConversion=function(f,c){var a=[r.glsl(m||(m=e.__makeTemplateObject(["\n      vec4 premultiplyAlpha(vec4 v) {\n        return vec4(v.rgb * v.a, v.a);\n      }\n    "],["\n      vec4 premultiplyAlpha(vec4 v) {\n        return vec4(v.rgb * v.a, v.a);\n      }\n    "]))),r.glsl(d||(d=e.__makeTemplateObject(["\n      vec3 rgb2hsv(vec3 c) {\n        vec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n        vec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n        vec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n        float d \x3d q.x - min(q.w, q.y);\n        float e \x3d 1.0e-10;\n        return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n      }\n    "],
["\n      vec3 rgb2hsv(vec3 c) {\n        vec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n        vec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n        vec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n        float d \x3d q.x - min(q.w, q.y);\n        float e \x3d 1.0e-10;\n        return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n      }\n    "]))),r.glsl(g||(g=e.__makeTemplateObject(["\n      vec3 hsv2rgb(vec3 c) {\n        vec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n        vec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n        return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n      }\n    "],
["\n      vec3 hsv2rgb(vec3 c) {\n        vec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n        vec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n        return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n      }\n    "]))),r.glsl(k||(k=e.__makeTemplateObject(["\n      float rgb2v(vec3 c) {\n        return max(c.x, max(c.y, c.z));\n      }\n    "],["\n      float rgb2v(vec3 c) {\n        return max(c.x, max(c.y, c.z));\n      }\n    "])))];switch(c.stages){case 0:a.forEach(function(a){return f.vertex.code.add(a)});
break;case 1:a.forEach(function(a){return f.fragment.code.add(a)});break;default:a.forEach(function(a){return f.vertex.code.add(a)}),a.forEach(function(a){return f.fragment.code.add(a)})}};var m,d,g,k})},"esri/views/3d/webgl-engine/shaders/HUDMaterialTechnique":function(){define("require exports tslib ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/Transform.glsl ../core/shaderLibrary/attributes/VerticalOffset.glsl ../core/shaderLibrary/hud/HUD.glsl ../core/shaderLibrary/hud/HUDOcclusionPass.glsl ../core/shaderLibrary/output/OutputHighlight.glsl ../core/shaderLibrary/shading/VisualVariables.glsl ../core/shaderLibrary/util/Camera.glsl ../core/shaderLibrary/util/ScreenSizePerspective.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/DefaultVertexAttributeLocations ./HUDMaterial.glsl ./HUDMaterial.glsl ../../../webgl/Program ../../../webgl/renderState ../../../webgl/renderState @dojo/framework/shim/Promise".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A,E,H,J){Object.defineProperty(f,"__esModule",{value:!0});v=function(f){function t(){return null!==f&&f.apply(this,arguments)||this}e.__extends(t,f);t.prototype.initializeProgram=function(a){var b=t.shader.get(),c=this.configuration,b=b.build({output:c.output,viewingMode:a.viewingMode,occlusionTestEnabled:c.occlusionTestEnabled,signedDistanceFieldEnabled:c.sdf,slicePlaneEnabled:c.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!0,
debugDrawBorder:c.debugDrawBorder,binaryHighlightOcclusionEnabled:c.binaryHighlightOcclusion,screenCenterOffsetUnitsEnabled:c.screenCenterOffsetUnitsEnabled,screenSizePerspectiveEnabled:c.screenSizePerspective,verticalOffsetEnabled:c.verticalOffset,vvSize:c.vvSize,vvColor:c.vvColor,vvInstancingEnabled:!1});return new E(a.rctx,b.generateSource("vertex"),b.generateSource("fragment"),x.Default3D)};t.prototype.bindPass=function(e,f,q){this.program.setUniform1f("cameraGroundRelative",q.cameraAboveGround?
1:-1);this.program.setUniform1f("perDistancePixelRatio",Math.tan(q.fovY/2)/(q.viewport[2]/2));this.program.setUniformMatrix4fv("viewNormal",q.viewInvTransp);this.program.setUniform1f("polygonOffset",f.shaderPolygonOffset);d.VerticalOffset.bindUniforms(this.program,f,q);b.ScreenSizePerspective.bindUniforms(this.program,f);a.Viewport.bindUniforms(this.program,q);6===this.configuration.output?k.HUDOcclusion.bindUniforms(this.program):(g.HUD.bindUniforms(this.program,q),A.HUDMaterial.bindUniforms(this.program,
f,q),c.VisualVariables.bindUniforms(this.program,f),this.configuration.occlusionTestEnabled&&g.HUD.bindVisibilityTexture(e,this.program,q));4===this.configuration.output&&l.OutputHighlight.bindOutputHighlight(e,this.program,q)};t.prototype.bindDraw=function(b){m.Transform.bindUniforms(this.program,b);a.Camera.bindUniforms(this.program,b);r.Slice.bindUniformsWithOrigin(this.program,this.configuration,b)};t.prototype.initializePipeline=function(){return 4===this.configuration.output?J.makePipelineState({blending:H.separateBlendingParams(1,
1,771,771),polygonOffset:this.configuration.polygonOffsetEnabled&&{factor:0,units:-4},depthTest:{func:513},colorWrite:J.defaultColorWriteParams}):6===this.configuration.output?J.makePipelineState({depthTest:{func:515},depthWrite:J.defaultDepthWriteParams,colorWrite:J.defaultColorWriteParams}):J.makePipelineState({blending:H.simpleBlendingParams(1,771),polygonOffset:this.configuration.polygonOffsetEnabled&&{factor:0,units:-4},depthTest:{func:this.configuration.depthEnabled?515:519},depthWrite:this.configuration.depthEnabled?
J.defaultDepthWriteParams:void 0,colorWrite:J.defaultColorWriteParams})};Object.defineProperty(t.prototype,"primitiveType",{get:function(){return 6===this.configuration.output?0:4},enumerable:!0,configurable:!0});t.shader=new q.ReloadableShaderModule(z,function(){return new Promise(function(a,b){u(["./HUDMaterial.glsl"],a,b)})});return t}(v.ShaderTechnique);f.HUDMaterialTechnique=v;v=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.output=0;b.occlusionTestEnabled=!0;b.sdf=
!1;b.vvSize=!1;b.vvColor=!1;b.verticalOffset=!1;b.screenSizePerspective=!1;b.screenCenterOffsetUnitsEnabled=0;b.debugDrawBorder=!0;b.binaryHighlightOcclusion=!0;b.slicePlaneEnabled=!1;b.polygonOffsetEnabled=!1;b.depthEnabled=!0;return b}e.__extends(b,a);e.__decorate([t.parameter({count:7})],b.prototype,"output",void 0);e.__decorate([t.parameter()],b.prototype,"occlusionTestEnabled",void 0);e.__decorate([t.parameter()],b.prototype,"sdf",void 0);e.__decorate([t.parameter()],b.prototype,"vvSize",void 0);
e.__decorate([t.parameter()],b.prototype,"vvColor",void 0);e.__decorate([t.parameter()],b.prototype,"verticalOffset",void 0);e.__decorate([t.parameter()],b.prototype,"screenSizePerspective",void 0);e.__decorate([t.parameter({count:2})],b.prototype,"screenCenterOffsetUnitsEnabled",void 0);e.__decorate([t.parameter()],b.prototype,"debugDrawBorder",void 0);e.__decorate([t.parameter()],b.prototype,"binaryHighlightOcclusion",void 0);e.__decorate([t.parameter()],b.prototype,"slicePlaneEnabled",void 0);
e.__decorate([t.parameter()],b.prototype,"polygonOffsetEnabled",void 0);e.__decorate([t.parameter()],b.prototype,"depthEnabled",void 0);return b}(t.ShaderTechniqueConfiguration);f.HUDMaterialTechniqueConfiguration=v})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/VerticalOffset.glsl":function(){define(["require","exports","tslib","../util/ScreenSizePerspective.glsl","../../shaderModules/interfaces"],function(u,f,e,r,m){function d(d,g){var f=d.vertex.code;g.verticalOffsetEnabled?(d.vertex.uniforms.add("verticalOffset",
"vec4"),g.screenSizePerspectiveEnabled&&(d.include(r.ScreenSizePerspective),d.vertex.uniforms.add("screenSizePerspectiveAlignment","vec4")),f.add(m.glsl(q||(q=e.__makeTemplateObject(["\n    vec3 calculateVerticalOffset(vec3 worldPos, vec3 localOrigin) {\n      float viewDistance \x3d length((view * vec4(worldPos, 1.0)).xyz);\n      ","\n      ","\n      // Screen sized offset in world space, used for example for line callouts\n      float worldOffset \x3d clamp(verticalOffsetScreenHeight * verticalOffset.y * viewDistance, verticalOffset.z, verticalOffset.w);\n      return worldNormal * worldOffset;\n    }\n\n    vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) {\n      return worldPos + calculateVerticalOffset(worldPos, localOrigin);\n    }\n    "],
["\n    vec3 calculateVerticalOffset(vec3 worldPos, vec3 localOrigin) {\n      float viewDistance \x3d length((view * vec4(worldPos, 1.0)).xyz);\n      ","\n      ","\n      // Screen sized offset in world space, used for example for line callouts\n      float worldOffset \x3d clamp(verticalOffsetScreenHeight * verticalOffset.y * viewDistance, verticalOffset.z, verticalOffset.w);\n      return worldNormal * worldOffset;\n    }\n\n    vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) {\n      return worldPos + calculateVerticalOffset(worldPos, localOrigin);\n    }\n    "])),
0===g.viewingMode?m.glsl(l||(l=e.__makeTemplateObject(["vec3 worldNormal \x3d normalize(worldPos + localOrigin);"],["vec3 worldNormal \x3d normalize(worldPos + localOrigin);"]))):m.glsl(c||(c=e.__makeTemplateObject(["vec3 worldNormal \x3d vec3(0.0, 0.0, 1.0);"],["vec3 worldNormal \x3d vec3(0.0, 0.0, 1.0);"]))),g.screenSizePerspectiveEnabled?m.glsl(a||(a=e.__makeTemplateObject(["\n          float cosAngle \x3d dot(worldNormal, normalize(worldPos - camPos));\n          float verticalOffsetScreenHeight \x3d screenSizePerspectiveScaleFloat(verticalOffset.x, abs(cosAngle), viewDistance, screenSizePerspectiveAlignment);"],
["\n          float cosAngle \x3d dot(worldNormal, normalize(worldPos - camPos));\n          float verticalOffsetScreenHeight \x3d screenSizePerspectiveScaleFloat(verticalOffset.x, abs(cosAngle), viewDistance, screenSizePerspectiveAlignment);"]))):m.glsl(b||(b=e.__makeTemplateObject(["\n          float verticalOffsetScreenHeight \x3d verticalOffset.x;"],["\n          float verticalOffsetScreenHeight \x3d verticalOffset.x;"])))))):f.add(m.glsl(v||(v=e.__makeTemplateObject(["\n    vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) { return worldPos; }\n    "],
["\n    vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) { return worldPos; }\n    "]))))}function g(a,b,c,d){void 0===d&&(d=k);d.screenLength=a.screenLength;d.perDistance=Math.tan(.5*b)/(.5*c);d.minWorldLength=a.minWorldLength;d.maxWorldLength=a.maxWorldLength;return d}Object.defineProperty(f,"__esModule",{value:!0});f.VerticalOffset=d;(function(a){a.bindUniforms=function(a,b,c){b.verticalOffset&&(b=g(b.verticalOffset,c.fovY,c.viewport[3]),a.setUniform4f("verticalOffset",b.screenLength*(c.pixelRatio||
1),b.perDistance,b.minWorldLength,b.maxWorldLength))}})(d=f.VerticalOffset||(f.VerticalOffset={}));f.calculateVerticalOffsetFactors=g;var k={screenLength:0,perDistance:0,minWorldLength:0,maxWorldLength:0},l,c,a,b,q,v})},"esri/views/3d/layers/graphics/objectResourceUtils":function(){define("require exports tslib ../../../../core/devEnvironmentUtils ../../../../core/maybe ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f64 ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../geometry/support/aaBoundingBox ../../glTF/DefaultLoadingContext ../../glTF/loader ../../glTF/internal/indexUtils ./wosrLoader ../../support/buffer/BufferView ../../support/buffer/math ../../support/buffer/utils ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryData ../../webgl-engine/lib/Texture ../../webgl-engine/materials/DefaultMaterial".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A,E,H,J,B,G){function F(a){var b=a.match(/(.*\.(gltf|glb))(\?lod=([0-9]+))?$/);return b?{fileType:"gltf",url:b[1],specifiedLodIndex:null!=b[4]?Number(b[4]):null}:a.match(/(.*\.(json|json\.gz))$/)?{fileType:"wosr",url:a,specifiedLodIndex:null}:{fileType:"unknown",url:a,specifiedLodIndex:null}}function M(a,c,f,k){var l=a.model,q=g.mat3f64.create(),r=[],v=new Map,x=new Map;l.lods.forEach(function(a,g){if(void 0===k||g===k){var u=0,F={name:a.name,stageResources:{textures:[],
materials:[],geometries:[]},lodThreshold:m.isSome(a.lodThreshold)?a.lodThreshold:null,pivotOffset:[0,0,0],numberOfVertices:0,boundingBox:b.empty()};r.push(F);a.parts.forEach(function(g){var k=g.material+(g.attributes.normal?"_normal":"")+(g.attributes.color?"_color":"")+(g.attributes.texCoord0?"_texCoord0":"")+(g.attributes.tangent?"_tangent":""),r=l.materials.get(g.material),L=m.isSome(g.attributes.texCoord0),M=m.isSome(g.attributes.normal);if(!v.has(k)){if(L){if(m.isSome(r.textureColor)&&!x.has(r.textureColor)){var Q=
l.textures.get(r.textureColor),O=e.__assign(e.__assign({},Q.parameters),{preMultiplyAlpha:!0});x.set(r.textureColor,new B(Q.data,r.textureColor,O))}m.isSome(r.textureNormal)&&!x.has(r.textureNormal)&&(Q=l.textures.get(r.textureNormal),O=e.__assign(e.__assign({},Q.parameters),{preMultiplyAlpha:!0}),x.set(r.textureNormal,new B(Q.data,r.textureNormal,O)));m.isSome(r.textureOcclusion)&&!x.has(r.textureOcclusion)&&(Q=l.textures.get(r.textureOcclusion),O=e.__assign(e.__assign({},Q.parameters),{preMultiplyAlpha:!0}),
x.set(r.textureOcclusion,new B(Q.data,r.textureOcclusion,O)));m.isSome(r.textureEmissive)&&!x.has(r.textureEmissive)&&(Q=l.textures.get(r.textureEmissive),O=e.__assign(e.__assign({},Q.parameters),{preMultiplyAlpha:!0}),x.set(r.textureEmissive,new B(Q.data,r.textureEmissive,O)));m.isSome(r.textureMetallicRoughness)&&!x.has(r.textureMetallicRoughness)&&(Q=l.textures.get(r.textureMetallicRoughness),O=e.__assign(e.__assign({},Q.parameters),{preMultiplyAlpha:!0}),x.set(r.textureMetallicRoughness,new B(Q.data,
r.textureMetallicRoughness,O)))}var T=G.COLOR_GAMMA,Q=Math.pow(r.color[0],1/T),O=Math.pow(r.color[1],1/T),C=Math.pow(r.color[2],1/T),S=Math.pow(r.emissiveFactor[0],1/T),aa=Math.pow(r.emissiveFactor[1],1/T),T=Math.pow(r.emissiveFactor[2],1/T);v.set(k,new G(e.__assign(e.__assign(e.__assign({},c),{transparent:"BLEND"===r.alphaMode,textureAlphaMode:R(r.alphaMode),textureAlphaCutoff:r.alphaCutoff,diffuse:[Q,O,C],ambient:[Q,O,C],opacity:r.opacity,doubleSided:r.doubleSided,doubleSidedType:"winding-order",
cullFace:r.doubleSided?0:2,vertexColors:!!g.attributes.color,vertexTangents:!!g.attributes.tangent,normals:M?"default":"screenDerivative",castShadows:!0,receiveSSAO:!0,textureId:m.isSome(r.textureColor)&&L?x.get(r.textureColor).id:void 0,colorMixMode:r.colorMixMode,normalTextureId:m.isSome(r.textureNormal)&&L?x.get(r.textureNormal).id:void 0,textureAlphaPremultiplied:!0,occlusionTextureId:m.isSome(r.textureOcclusion)&&L?x.get(r.textureOcclusion).id:void 0,emissiveTextureId:m.isSome(r.textureEmissive)&&
L?x.get(r.textureEmissive).id:void 0,metallicRoughnessTextureId:m.isSome(r.textureMetallicRoughness)&&L?x.get(r.textureMetallicRoughness).id:void 0,emissiveFactor:[S,aa,T],mrrFactors:[r.metallicFactor,r.roughnessFactor,c.mrrFactors[2]],isSchematic:!1}),f),k))}a:{M=g.indices||g.attributes.position.count;switch(g.primitiveType){case 4:Q=t.trianglesToTriangles(M);break a;case 5:Q=t.triangleStripToTriangles(M);break a;case 6:Q=t.triangleFanToTriangles(M);break a}Q=void 0}O={};C={};M=g.attributes.position.count;
S=E.createBuffer(z.BufferViewVec3f,M);A.vec3.transformMat4(S,g.attributes.position,g.transform);C.position={data:S.typedBuffer,size:S.elementCount};O.position=Q;m.isSome(g.attributes.normal)&&(S=E.createBuffer(z.BufferViewVec3f,M),d.mat3.normalFromMat4(q,g.transform),A.vec3.transformMat3(S,g.attributes.normal,q),C.normal={data:S.typedBuffer,size:S.elementCount},O.normal=Q);m.isSome(g.attributes.tangent)&&(S=E.createBuffer(z.BufferViewVec4f,M),d.mat3.normalFromMat4(q,g.transform),A.vec4.transformMat3(S,
g.attributes.tangent,q),C.tangent={data:S.typedBuffer,size:S.elementCount},O.tangent=Q);m.isSome(g.attributes.texCoord0)&&(S=E.createBuffer(z.BufferViewVec2f,M),E.vec2.normalizeIntegerBuffer(S,g.attributes.texCoord0),C.uv0={data:S.typedBuffer,size:S.elementCount},O.uv0=Q);m.isSome(g.attributes.color)&&(S=E.createBuffer(z.BufferViewVec4u8,M),4===g.attributes.color.elementCount?g.attributes.color instanceof z.BufferViewVec4f?A.vec4.scale(S,g.attributes.color,255):g.attributes.color instanceof z.BufferViewVec4u8?
E.vec4.copy(S,g.attributes.color):g.attributes.color instanceof z.BufferViewVec4u16&&A.vec4.scale(S,g.attributes.color,1/256):(E.vec4.fill(S,255,255,255,255),aa=new z.BufferViewVec3u8(S.buffer,0,4),g.attributes.color instanceof z.BufferViewVec3f?A.vec3.scale(aa,g.attributes.color,255):g.attributes.color instanceof z.BufferViewVec3u8?E.vec3.copy(aa,g.attributes.color):g.attributes.color instanceof z.BufferViewVec3u16&&A.vec3.scale(aa,g.attributes.color,1/256)),C.color={data:S.typedBuffer,size:S.elementCount},
O.color=Q);g=new H(new J.GeometryData(C,O),"gltf_"+a.name+"_"+u++);F.stageResources.geometries.push(g);F.stageResources.materials.push(v.get(k));L&&(m.isSome(r.textureColor)&&F.stageResources.textures.push(x.get(r.textureColor)),m.isSome(r.textureNormal)&&F.stageResources.textures.push(x.get(r.textureNormal)),m.isSome(r.textureOcclusion)&&F.stageResources.textures.push(x.get(r.textureOcclusion)),m.isSome(r.textureEmissive)&&F.stageResources.textures.push(x.get(r.textureEmissive)),m.isSome(r.textureMetallicRoughness)&&
F.stageResources.textures.push(x.get(r.textureMetallicRoughness)));F.numberOfVertices+=M;k=g.boundingInfo;b.expand(F.boundingBox,k.getBBMin());b.expand(F.boundingBox,k.getBBMax())})}});return r}function R(a){switch(a){case "BLEND":return 0;case "MASK":return 2;case "OPAQUE":return 1;default:return 0}}Object.defineProperty(f,"__esModule",{value:!0});f.fetch=function(b,d){return e.__awaiter(this,void 0,void 0,function(){var g,f,t,u,A,B,G,H,J,R,O,T;return e.__generator(this,function(L){switch(L.label){case 0:return g=
F(r.adjustStaticAGOUrl(b)),"wosr"!==g.fileType?[3,2]:[4,d.cache?d.cache.loadWOSR(g.url,d):x.load(g.url,d)];case 1:return f=L.sent(),t=x.processLoadResult(f,d),[2,{lods:[t],referenceBoundingBox:t.boundingBox,isEsriSymbolResource:!1,isWosr:!0,remove:f.remove}];case 2:return[4,d.cache?d.cache.loadGLTF(g.url,d):v.load(new q.DefaultLoadingContext(d.streamDataRequester),g.url,d)];case 3:u=L.sent();A=m.get(u.model.meta,"ESRI_proxyEllipsoid");if(u.meta.isEsriSymbolResource&&m.isSome(A)&&-1!==u.meta.uri.indexOf("/RealisticTrees/"))a:{L=
u;for(var da=A,Q=0;Q<L.model.lods.length;++Q){var fa=L.model.lods[Q];L.customMeta.esriTreeRendering=!0;for(var S=0,fa=fa.parts;S<fa.length;S++){var ia=fa[S],aa=ia.attributes.normal;if(m.isNone(aa))break a;for(var C=ia.attributes.position,Z=C.count,V=a.vec3f64.create(),ba=a.vec3f64.create(),X=a.vec3f64.create(),W=E.createBuffer(z.BufferViewVec4u8,Z),ja=E.createBuffer(z.BufferViewVec3f,Z),ha=k.mat4.invert(l.mat4f64.create(),ia.transform),ea=0;ea<Z;ea++){C.getVec(ea,ba);aa.getVec(ea,V);c.vec3.transformMat4(ba,
ba,ia.transform);c.vec3.subtract(X,ba,da.center);c.vec3.divide(X,X,da.radius);var Y=X[2],w=c.vec3.length(X),w=Math.min(.45+.55*w*w,1);c.vec3.divide(X,X,da.radius);c.vec3.transformMat4(X,X,ha);c.vec3.normalize(X,X);Q+1!==L.model.lods.length&&1<L.model.lods.length&&(-1<Y?c.vec3.lerp(X,X,V,.2):c.vec3.lerp(X,X,V,Math.min(-4*Y-3.8,1)));ja.setVec(ea,X);W.set(ea,0,255*w);W.set(ea,1,255*w);W.set(ea,2,255*w);W.set(ea,3,255)}ia.attributes.normal=ja;ia.attributes.color=W}}}B=u.meta.isEsriSymbolResource?{usePBR:d.usePBR,
isSchematic:!1,treeRendering:u.customMeta.esriTreeRendering,mrrFactors:[0,1,.2]}:{usePBR:!0,isSchematic:!1,mrrFactors:[0,1,.5]};G=e.__assign(e.__assign({},d.materialParamsMixin),{treeRendering:u.customMeta.esriTreeRendering});if(null!=g.specifiedLodIndex)return H=M(u,B,G,g.specifiedLodIndex),J=H[0].boundingBox,0!==g.specifiedLodIndex&&(R=M(u,B,G,0),J=R[0].boundingBox),[2,{lods:H,referenceBoundingBox:J,isEsriSymbolResource:u.meta.isEsriSymbolResource,isWosr:!1,remove:u.remove}];O=M(u,B,G);T=O[0].boundingBox;
return[2,{lods:O,referenceBoundingBox:T,isEsriSymbolResource:u.meta.isEsriSymbolResource,isWosr:!1,remove:u.remove}]}})})};f.parseUrl=F;f.gltfToEngineResources=M})},"esri/views/3d/glTF/DefaultLoadingContext":function(){define("require exports tslib ../../../request ../../../core/asyncUtils ../../../core/Error ../../../core/maybe ../../../core/promiseUtils ../../../core/urlUtils".split(" "),function(u,f,e,r,m,d,g,k,l){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function a(a){this.streamDataRequester=
a}a.prototype.loadJSON=function(a,c){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(b){return[2,this.load("json",a,c)]})})};a.prototype.loadBinary=function(a,c){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(b){return l.isDataProtocol(a)?(k.throwIfAborted(c),[2,l.dataToArrayBuffer(a)]):[2,this.load("binary",a,c)]})})};a.prototype.loadImage=function(a,c){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,
function(b){return[2,this.load("image",a,c)]})})};a.prototype.load=function(a,f,l){return e.__awaiter(this,void 0,void 0,function(){var b;return e.__generator(this,function(e){switch(e.label){case 0:return g.isNone(this.streamDataRequester)?[4,r(f,{responseType:c[a]})]:[3,2];case 1:return[2,e.sent().data];case 2:return[4,m.result(this.streamDataRequester.request(f,a,l))];case 3:b=e.sent();if(!0===b.ok)return[2,b.value];k.throwIfAbortError(b.error);throw new d("","Request for resource failed: "+b.error);
}})})};return a}();f.DefaultLoadingContext=u;var c={image:"image",binary:"array-buffer",json:"json"}})},"esri/views/3d/glTF/loader":function(){define("require exports tslib ../../../core/maybe ../../../core/promiseUtils ../../../core/libs/gl-matrix-2/mat4f64 ./DefaultErrorContext ./LoaderResult ./internal/Resource".split(" "),function(u,f,e,r,m,d,g,k,l){function c(a){var b=null;a.json.nodes.forEach(function(a){a=a.extras;r.isSome(a)&&(a.ESRI_proxyEllipsoid||a.ESRI_lod)&&(b=a)});return b}function a(a,
b){return e.__awaiter(this,void 0,void 0,function(){function c(g,f){return e.__awaiter(this,void 0,void 0,function(){var k,l,q,m,r,v,x,z,u;return e.__generator(this,function(e){switch(e.label){case 0:k=d.nodes[g];l=a.getNodeTransform(g);t.warnUnsupportedIf(null!=k.weights,"Morph targets are not supported.");if(null==k.mesh)return[3,4];q=d.meshes[k.mesh];m=0;r=q.primitives;e.label=1;case 1:if(!(m<r.length))return[3,4];v=r[m];return[4,b(v,l,f,q.name)];case 2:e.sent(),e.label=3;case 3:return m++,[3,
1];case 4:x=0,z=k.children||[],e.label=5;case 5:if(!(x<z.length))return[3,8];u=z[x];return[4,c(u,f)];case 6:e.sent(),e.label=7;case 7:return x++,[3,5];case 8:return[2]}})})}var d,g,f,k,l,q,r,v,x,z;return e.__generator(this,function(b){switch(b.label){case 0:d=a.json,g=d.scenes[d.scene||0],f=g.nodes,k=1<f.length,l=0,q=f,b.label=1;case 1:if(!(l<q.length))return[3,4];r=q[l];v=d.nodes[r];x=[c(r,0)];v.extensions&&v.extensions.MSFT_lod&&Array.isArray(v.extensions.MSFT_lod.ids)&&!k&&(z=v.extensions.MSFT_lod.ids,
x.push.apply(x,z.map(function(a,b){return c(a,b+1)})));return[4,m.all(x)];case 2:b.sent(),b.label=3;case 3:return l++,[3,1];case 4:return[2]}})})}function b(a,b,c){var d=function(b){var d=c+"_tex_"+(b&&b.id)+(b&&b.name?"_"+b.name:"");if(b&&!a.textures.has(d)){var e=k.makeTextureSource(b.data,{wrap:{s:q(b.wrapS),t:q(b.wrapT)},mipmap:x.some(function(a){return a===b.minFilter}),noUnpackFlip:!0});a.textures.set(d,e)}return d},e=c+"_mat_"+b.id+"_"+b.name;a.materials.has(e)||(b=k.makeMaterialParameters({color:[b.color[0],
b.color[1],b.color[2]],opacity:b.color[3],alphaMode:b.alphaMode,alphaCutoff:b.alphaCutoff,doubleSided:b.doubleSided,colorMixMode:b.ESRI_externalColorMixMode,textureColor:b.colorTexture?d(b.colorTexture):void 0,textureNormal:b.normalTexture?d(b.normalTexture):void 0,textureOcclusion:b.occlusionTexture?d(b.occlusionTexture):void 0,textureEmissive:b.emissiveTexture?d(b.emissiveTexture):void 0,textureMetallicRoughness:b.metallicRoughnessTexture?d(b.metallicRoughnessTexture):void 0,emissiveFactor:[b.emissiveFactor[0],
b.emissiveFactor[1],b.emissiveFactor[2]],metallicFactor:b.metallicFactor,roughnessFactor:b.roughnessFactor}),a.materials.set(e,b));return e}function q(a){if(33071===a||33648===a||10497===a)return a;t.error("Unexpected TextureSampler WrapMode: "+a)}Object.defineProperty(f,"__esModule",{value:!0});var v=0;f.load=function(g,f,k){void 0===k&&(k={});return e.__awaiter(this,void 0,void 0,function(){var q,m,x,u,A=this;return e.__generator(this,function(E){switch(E.label){case 0:return[4,l.Resource.load(g,
t,f,k)];case 1:return q=E.sent(),m="gltf_"+v++,x={lods:[],materials:new Map,textures:new Map,meta:c(q)},u=!(!q.json.asset.extras||"symbolResource"!==q.json.asset.extras.ESRI_type),[4,a(q,function(a,c,g,f){return e.__awaiter(A,void 0,void 0,function(){var l,v,u,A,E,B,G,F,H,J,L;return e.__generator(this,function(e){switch(e.label){case 0:l=void 0!==a.mode?a.mode:4;a:switch(l){case 4:case 5:case 6:v=l;break a;default:v=null}return r.isNone(v)?(t.warnUnsupported("Unsupported primitive mode ("+z[l]+"). Skipping primitive."),
[2]):q.hasPositions(a)?[4,q.getMaterial(a,k)]:(t.warn("Skipping primitive without POSITION vertex attribute."),[2]);case 1:return u=e.sent(),E={transform:d.mat4f64.clone(c)},B={},[4,q.getPositionData(a,k)];case 2:return E.attributes=(B.position=e.sent(),B.normal=null,B.texCoord0=null,B.color=null,B.tangent=null,B),[4,q.getIndexData(a,k)];case 3:A=(E.indices=e.sent(),E.primitiveType=v,E.material=b(x,u,m),E);if(!q.hasNormals(a))return[3,5];G=A.attributes;return[4,q.getNormalData(a,k)];case 4:G.normal=
e.sent(),e.label=5;case 5:if(!q.hasTangents(a))return[3,7];F=A.attributes;return[4,q.getTangentData(a,k)];case 6:F.tangent=e.sent(),e.label=7;case 7:if(!q.hasTextureCoordinates(a))return[3,9];H=A.attributes;return[4,q.getTextureCoordinates(a,k)];case 8:H.texCoord0=e.sent(),e.label=9;case 9:if(!q.hasVertexColors(a))return[3,11];J=A.attributes;return[4,q.getVertexColors(a,k)];case 10:J.color=e.sent(),e.label=11;case 11:return L=null,r.isSome(x.meta)&&r.isSome(x.meta.ESRI_lod)&&"screenSpaceRadius"===
x.meta.ESRI_lod.metric&&(L=x.meta.ESRI_lod.thresholds[g]),x.lods[g]=x.lods[g]||{parts:[],name:f,lodThreshold:L},x.lods[g].parts.push(A),[2]}})})})];case 2:return E.sent(),[2,{model:x,meta:{isEsriSymbolResource:u,uri:q.uri},customMeta:{}}]}})})};var t=new g.DefaultErrorContext,x=[9987,9985],z="POINTS LINES LINE_LOOP LINE_STRIP TRIANGLES TRIANGLE_STRIP TRIANGLE_FAN".split(" ")})},"esri/views/3d/glTF/DefaultErrorContext":function(){define(["require","exports","../../../core/Error","../../../core/Logger"],
function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});var m=r.getLogger("esri.views.3d.glTF");u=function(){function d(){}d.prototype.error=function(d){throw new e("gltf-loader-error",d);};d.prototype.errorUnsupported=function(d){throw new e("gltf-loader-unsupported-feature",d);};d.prototype.errorUnsupportedIf=function(d,e){d&&this.errorUnsupported(e)};d.prototype.assert=function(d,e){d||this.error(e)};d.prototype.warn=function(d){m.warn(d)};d.prototype.warnUnsupported=function(d){this.warn("[Unsupported Feature] "+
d)};d.prototype.warnUnsupportedIf=function(d,e){d&&this.warnUnsupported(e)};return d}();f.DefaultErrorContext=u})},"esri/views/3d/glTF/LoaderResult":function(){define(["require","exports","tslib"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.makeMaterialParameters=function(f){void 0===f&&(f={});return e.__assign({color:[1,1,1],opacity:1,alphaMode:"OPAQUE",alphaCutoff:.5,doubleSided:!1,castShadows:!0,receiveShadows:!0,receiveAmbientOcclustion:!0,textureColor:null,textureNormal:null,
textureOcclusion:null,textureEmissive:null,textureMetallicRoughness:null,emissiveFactor:[0,0,0],metallicFactor:1,roughnessFactor:1,colorMixMode:"multiply"},f)};f.makeTextureSource=function(f,m){void 0===m&&(m={});return{data:f,parameters:e.__assign({wrap:e.__assign({s:10497,t:10497},m.wrap),noUnpackFlip:!0,mipmap:!1},m)}}})},"esri/views/3d/glTF/internal/Resource":function(){define("require exports tslib ../../../../core/compilerUtils ../../../../core/promiseUtils ../../../../core/string ../../../../core/urlUtils ../../../../core/urlUtils ../../../../core/Version ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/quat ../../../../core/libs/gl-matrix-2/quatf64 ./BinaryStreamReader ./fillDefaults ./pathUtils ../../support/buffer/BufferView ../../support/buffer/utils".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A){function E(a){switch(a.componentType){case 5120:return new z.BufferViewVec2i8(a.raw,a.byteOffset,a.byteStride,a.byteOffset+a.byteStride*a.entryCount);case 5121:return new z.BufferViewVec2u8(a.raw,a.byteOffset,a.byteStride,a.byteOffset+a.byteStride*a.entryCount);case 5122:return new z.BufferViewVec2i16(a.raw,a.byteOffset,a.byteStride,a.byteOffset+a.byteStride*a.entryCount);case 5123:return new z.BufferViewVec2u16(a.raw,a.byteOffset,a.byteStride,a.byteOffset+
a.byteStride*a.entryCount);case 5125:return new z.BufferViewVec2u32(a.raw,a.byteOffset,a.byteStride,a.byteOffset+a.byteStride*a.entryCount);case 5126:return new z.BufferViewVec2f(a.raw,a.byteOffset,a.byteStride,a.byteOffset+a.byteStride*a.entryCount);default:r.neverReached(a.componentType)}}function H(a){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(b){return[2,m.create(function(b,c){var d=new Blob([a]),e=new FileReader;e.onload=function(){b(JSON.parse(e.result))};
e.onerror=function(a){c(a)};e.readAsText(d)})]})})}function J(a,b){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(c){return[2,m.create(function(c,d){var e=new Blob([a],{type:b}),g=URL.createObjectURL(e),f=new Image;f.addEventListener("load",function(){URL.revokeObjectURL(g);"decode"in f?f.decode().then(function(){return c(f)},function(){return c(f)}):c(f)});f.addEventListener("error",function(a){URL.revokeObjectURL(g);d(a)});f.src=g})]})})}var B;Object.defineProperty(f,
"__esModule",{value:!0});u=function(){function f(a,b,c,d,e){this.context=a;this.errorContext=b;this.uri=c;this.json=d;this.glbBuffer=e;this.bufferCache=new Map;this.textureCache=new Map;this.materialCache=new Map;this.nodeParentMap=new Map;this.nodeTransformCache=new Map;this.baseUri=x.splitURI(this.uri).dirPart;this.checkVersionSupported();this.checkRequiredExtensionsSupported();b.errorUnsupportedIf(null==d.scenes,"Scenes must be defined.");b.errorUnsupportedIf(null==d.meshes,"Meshes must be defined");
b.errorUnsupportedIf(null==d.nodes,"Nodes must be defined.");this.computeNodeParents()}f.load=function(a,b,c,g){return e.__awaiter(this,void 0,void 0,function(){var l,q,m,t,r,v;return e.__generator(this,function(e){switch(e.label){case 0:if(k.isDataProtocol(c)){l=k.dataComponents(c);if("model/gltf-binary"!==l.mediaType)try{return q=JSON.parse(l.isBase64?atob(l.data):l.data),[2,new f(a,b,c,q)]}catch(ja){}m=k.dataToArrayBuffer(c);if(f.isGLBData(m))return[2,this.fromGLBData(a,b,c,m)]}return d.endsWith(c,
".gltf")?[4,a.loadJSON(c,g)]:[3,2];case 1:return t=e.sent(),[2,new f(a,b,c,t)];case 2:return[4,a.loadBinary(c,g)];case 3:return r=e.sent(),f.isGLBData(r)?[2,this.fromGLBData(a,b,c,r)]:[4,a.loadJSON(c,g)];case 4:return v=e.sent(),[2,new f(a,b,c,v)]}})})};f.isGLBData=function(a){a=new v.BinaryStreamReader(a);return 4<=a.remainingBytes()&&1179937895===a.readUint32()};f.fromGLBData=function(a,b,c,d){return e.__awaiter(this,void 0,void 0,function(){var g;return e.__generator(this,function(e){switch(e.label){case 0:return[4,
f.parseGLBData(b,d)];case 1:return g=e.sent(),[2,new f(a,b,c,g.json,g.binaryData)]}})})};f.parseGLBData=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d,g,f,k,l,q,m,t;return e.__generator(this,function(e){switch(e.label){case 0:c=new v.BinaryStreamReader(b),a.assert(12<=c.remainingBytes(),"GLB binary data is insufficiently large."),d=c.readUint32(),g=c.readUint32(),f=c.readUint32(),a.assert(1179937895===d,"Magic first 4 bytes do not fit to expected GLB value."),a.assert(b.byteLength>=
f,"GLB binary data is smaller than header specifies."),a.errorUnsupportedIf(2!==g,"An unsupported GLB container version was detected. Only version 2 is supported."),k=0,e.label=1;case 1:if(!(8<=c.remainingBytes()))return[3,5];m=c.readUint32();t=c.readUint32();if(0!==k)return[3,3];a.assert(1313821514===t,"First GLB chunk must be JSON.");a.assert(0<=m,"No JSON data found.");return[4,H(c.readUint8Array(m))];case 2:return l=e.sent(),[3,4];case 3:1===k?(a.errorUnsupportedIf(5130562!==t,"Second GLB chunk expected to be BIN."),
q=c.readUint8Array(m)):a.warnUnsupported("More than 2 GLB chunks detected. Skipping."),e.label=4;case 4:return k+=1,[3,1];case 5:return l||a.error("No GLB JSON chunk detected."),[2,{json:l,binaryData:q}]}})})};f.prototype.getBuffer=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d,g,f;return e.__generator(this,function(e){switch(e.label){case 0:return c=this.json.buffers[a],d=this.errorContext,null==c.uri?(d.assert(null!=this.glbBuffer,"GLB buffer not present"),[2,this.glbBuffer]):
(g=this.bufferCache.get(a))?[3,2]:[4,this.context.loadBinary(this.resolveUri(c.uri),b)];case 1:f=e.sent(),g=new Uint8Array(f),this.bufferCache.set(a,g),d.assert(g.byteLength===c.byteLength,"Buffer byte lengths should match."),e.label=2;case 2:return[2,g]}})})};f.prototype.getAccessor=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d,g,f,k,l,q,m;return e.__generator(this,function(e){switch(e.label){case 0:return c=this.json.accessors[a],d=this.errorContext,d.errorUnsupportedIf(null==
c.bufferView,"Some accessor does not specify a bufferView."),d.errorUnsupportedIf(c.type in["MAT2","MAT3","MAT4"],"AttributeType "+c.type+" is not supported"),g=this.json.bufferViews[c.bufferView],[4,this.getBuffer(g.buffer,b)];case 1:return f=e.sent(),k=R[c.type],l=T[c.componentType],q=k*l,m=g.byteStride||q,[2,{raw:f.buffer,byteStride:m,byteOffset:f.byteOffset+(g.byteOffset||0)+(c.byteOffset||0),entryCount:c.count,isDenselyPacked:m===q,componentCount:k,componentByteSize:l,componentType:c.componentType,
min:c.min,max:c.max,normalized:!!c.normalized}]}})})};f.prototype.getIndexData=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c;return e.__generator(this,function(d){switch(d.label){case 0:return null==a.indices?[2,null]:[4,this.getAccessor(a.indices,b)];case 1:c=d.sent();if(c.isDenselyPacked)switch(c.componentType){case 5121:return[2,new Uint8Array(c.raw,c.byteOffset,c.entryCount)];case 5123:return[2,new Uint16Array(c.raw,c.byteOffset,c.entryCount)];case 5125:return[2,new Uint32Array(c.raw,
c.byteOffset,c.entryCount)]}else switch(c.componentType){case 5121:return[2,A.scalar.makeDense(this.wrapAccessor(z.BufferViewUint8,c))];case 5123:return[2,A.scalar.makeDense(this.wrapAccessor(z.BufferViewUint16,c))];case 5125:return[2,A.scalar.makeDense(this.wrapAccessor(z.BufferViewUint32,c))]}return[2,void 0]}})})};f.prototype.getPositionData=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d;return e.__generator(this,function(e){switch(e.label){case 0:return c=this.errorContext,
c.errorUnsupportedIf(null==a.attributes.POSITION,"No POSITION vertex data found."),[4,this.getAccessor(a.attributes.POSITION,b)];case 1:return d=e.sent(),c.errorUnsupportedIf(5126!==d.componentType,"Expected type FLOAT for POSITION vertex attribute, but found "+O[d.componentType]),c.errorUnsupportedIf(3!==d.componentCount,"POSITION vertex attribute must have 3 components, but found "+d.componentCount.toFixed()),[2,this.wrapAccessor(z.BufferViewVec3f,d)]}})})};f.prototype.getNormalData=function(a,
b){return e.__awaiter(this,void 0,void 0,function(){var c,d;return e.__generator(this,function(e){switch(e.label){case 0:return c=this.errorContext,c.assert(null!=a.attributes.NORMAL,"No NORMAL vertex data found."),[4,this.getAccessor(a.attributes.NORMAL,b)];case 1:return d=e.sent(),c.errorUnsupportedIf(5126!==d.componentType,"Expected type FLOAT for NORMAL vertex attribute, but found "+O[d.componentType]),c.errorUnsupportedIf(3!==d.componentCount,"NORMAL vertex attribute must have 3 components, but found "+
d.componentCount.toFixed()),[2,this.wrapAccessor(z.BufferViewVec3f,d)]}})})};f.prototype.getTangentData=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d;return e.__generator(this,function(e){switch(e.label){case 0:return c=this.errorContext,c.assert(null!=a.attributes.TANGENT,"No TANGENT vertex data found."),[4,this.getAccessor(a.attributes.TANGENT,b)];case 1:return d=e.sent(),c.errorUnsupportedIf(5126!==d.componentType,"Expected type FLOAT for TANGENT vertex attribute, but found "+
O[d.componentType]),c.errorUnsupportedIf(4!==d.componentCount,"TANGENT vertex attribute must have 4 components, but found "+d.componentCount.toFixed()),[2,new z.BufferViewVec4f(d.raw,d.byteOffset,d.byteStride,d.byteOffset+d.byteStride*d.entryCount)]}})})};f.prototype.getTextureCoordinates=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d;return e.__generator(this,function(e){switch(e.label){case 0:return c=this.errorContext,c.assert(null!=a.attributes.TEXCOORD_0,"No TEXCOORD_0 vertex data found."),
[4,this.getAccessor(a.attributes.TEXCOORD_0,b)];case 1:d=e.sent();c.errorUnsupportedIf(2!==d.componentCount,"TEXCOORD_0 vertex attribute must have 2 components, but found "+d.componentCount.toFixed());if(5126===d.componentType)return[2,this.wrapAccessor(z.BufferViewVec2f,d)];c.errorUnsupportedIf(!d.normalized,"Integer component types are only supported for a normalized accessor for TEXCOORD_0.");return[2,E(d)]}})})};f.prototype.getVertexColors=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,
d;return e.__generator(this,function(e){switch(e.label){case 0:return c=this.errorContext,c.assert(null!=a.attributes.COLOR_0,"No COLOR_0 vertex data found."),[4,this.getAccessor(a.attributes.COLOR_0,b)];case 1:d=e.sent();c.errorUnsupportedIf(4!==d.componentCount&&3!==d.componentCount,"COLOR_0 attribute must have 3 or 4 components, but found "+d.componentCount.toFixed());if(4===d.componentCount){if(5126===d.componentType)return[2,this.wrapAccessor(z.BufferViewVec4f,d)];if(5121===d.componentType)return[2,
this.wrapAccessor(z.BufferViewVec4u8,d)];if(5123===d.componentType)return[2,this.wrapAccessor(z.BufferViewVec4u16,d)]}else if(3===d.componentCount){if(5126===d.componentType)return[2,this.wrapAccessor(z.BufferViewVec3f,d)];if(5121===d.componentType)return[2,this.wrapAccessor(z.BufferViewVec3u8,d)];if(5123===d.componentType)return[2,this.wrapAccessor(z.BufferViewVec3u16,d)]}c.errorUnsupported("Unsupported component type for COLOR_0 attribute: "+O[d.componentType]);return[2,void 0]}})})};f.prototype.hasPositions=
function(a){return void 0!==a.attributes.POSITION};f.prototype.hasNormals=function(a){return void 0!==a.attributes.NORMAL};f.prototype.hasVertexColors=function(a){return void 0!==a.attributes.COLOR_0};f.prototype.hasTextureCoordinates=function(a){return void 0!==a.attributes.TEXCOORD_0};f.prototype.hasTangents=function(a){return void 0!==a.attributes.TANGENT};f.prototype.getMaterial=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d,g,f,k,l,q,m,r,v,x;return e.__generator(this,
function(e){switch(e.label){case 0:c=this.errorContext;if(d=this.materialCache.get(a.material))return[3,15];g=null!=a.material?t.material(this.json.materials[a.material]):t.material();f=g.pbrMetallicRoughness;k=this.hasVertexColors(a);l=void 0;if(!f.baseColorTexture)return[3,2];c.errorUnsupportedIf(0!==(f.baseColorTexture.texCoord||0),"Only TEXCOORD with index 0 is supported.");return[4,this.getTexture(f.baseColorTexture.index,b)];case 1:l=e.sent(),e.label=2;case 2:q=void 0;if(!g.normalTexture)return[3,
5];if(0===(g.normalTexture.texCoord||0))return[3,3];c.warnUnsupported("Only TEXCOORD with index 0 is supported for the normal map texture.");return[3,5];case 3:return[4,this.getTexture(g.normalTexture.index,b)];case 4:q=e.sent(),e.label=5;case 5:m=void 0;if(!g.occlusionTexture)return[3,8];if(0===(g.occlusionTexture.texCoord||0))return[3,6];c.warnUnsupported("Only TEXCOORD with index 0 is supported for the occlusion texture.");return[3,8];case 6:return[4,this.getTexture(g.occlusionTexture.index,b)];
case 7:m=e.sent(),e.label=8;case 8:r=void 0;if(!g.emissiveTexture)return[3,11];if(0===(g.emissiveTexture.texCoord||0))return[3,9];c.warnUnsupported("Only TEXCOORD with index 0 is supported for the emissive texture.");return[3,11];case 9:return[4,this.getTexture(g.emissiveTexture.index,b)];case 10:r=e.sent(),e.label=11;case 11:v=void 0;if(!f.metallicRoughnessTexture)return[3,14];if(0===(f.metallicRoughnessTexture.texCoord||0))return[3,12];c.warnUnsupported("Only TEXCOORD with index 0 is supported for the metallicRoughness texture.");
return[3,14];case 12:return[4,this.getTexture(f.metallicRoughnessTexture.index,b)];case 13:v=e.sent(),e.label=14;case 14:x=null!=a.material?a.material:-1,d={alphaMode:g.alphaMode,alphaCutoff:g.alphaCutoff,color:f.baseColorFactor,doubleSided:!!g.doubleSided,colorTexture:l,normalTexture:q,name:g.name,id:x,occlusionTexture:m,emissiveTexture:r,emissiveFactor:g.emissiveFactor,metallicFactor:f.metallicFactor,roughnessFactor:f.roughnessFactor,metallicRoughnessTexture:v,vertexColors:k,ESRI_externalColorMixMode:g.extras.ESRI_externalColorMixMode},
e.label=15;case 15:return[2,d]}})})};f.prototype.getTexture=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d,g,f,k,l,q,m;return e.__generator(this,function(e){switch(e.label){case 0:c=this.errorContext;d=this.json.textures[a];g=t.textureSampler(null!=d.sampler?this.json.samplers[d.sampler]:{});c.errorUnsupportedIf(null==d.source,"Source is expected to be defined for a texture.");f=this.json.images[d.source];if(k=this.textureCache.get(a))return[3,6];l=void 0;return f.uri?[4,this.context.loadImage(this.resolveUri(f.uri),
b)]:[3,2];case 1:return l=e.sent(),[3,5];case 2:return c.errorUnsupportedIf(null==f.bufferView,"Image bufferView must be defined."),c.errorUnsupportedIf(null==f.mimeType,"Image mimeType must be defined."),q=this.json.bufferViews[f.bufferView],[4,this.getBuffer(q.buffer,b)];case 3:return m=e.sent(),c.errorUnsupportedIf(null!=q.byteStride,"byteStride not supported for image buffer"),[4,J(new Uint8Array(m.buffer,m.byteOffset+(q.byteOffset||0),q.byteLength),f.mimeType)];case 4:l=e.sent(),e.label=5;case 5:k=
{data:l,wrapS:g.wrapS,wrapT:g.wrapT,minFilter:g.minFilter,name:f.name,id:a},this.textureCache.set(a,k),e.label=6;case 6:return[2,k]}})})};f.prototype.getNodeTransform=function(d){if(void 0===d)return F;var e=this.nodeTransformCache.get(d);if(!e){var e=this.getNodeTransform(this.getNodeParent(d)),g=this.json.nodes[d];if(g.matrix)e=c.mat4.multiply(a.mat4f64.create(),e,g.matrix);else if(g.translation||g.rotation||g.scale)e=a.mat4f64.clone(e),g.translation&&c.mat4.translate(e,e,g.translation),g.rotation&&
(M[3]=b.quat.getAxisAngle(M,g.rotation),c.mat4.rotate(e,e,M[3],M)),g.scale&&c.mat4.scale(e,e,g.scale);this.nodeTransformCache.set(d,e)}return e};f.prototype.wrapAccessor=function(a,b){return new a(b.raw,b.byteOffset,b.byteStride,b.byteOffset+b.byteStride*(b.entryCount-1)+b.componentByteSize*b.componentCount)};f.prototype.resolveUri=function(a){return g.makeAbsolute(a,this.baseUri)};f.prototype.getNodeParent=function(a){return this.nodeParentMap.get(a)};f.prototype.checkVersionSupported=function(){var a=
l.Version.parse(this.json.asset.version,"glTF");G.validate(a)};f.prototype.checkRequiredExtensionsSupported=function(){var a=this.json,b=this.errorContext;a.extensionsRequired&&0!==a.extensionsRequired.length&&b.errorUnsupported("gltf loader was not able to load unsupported feature. Required extensions: "+a.extensionsRequired.join(", "))};f.prototype.computeNodeParents=function(){var a=this;this.json.nodes.forEach(function(b,c){b.children&&b.children.forEach(function(b){a.nodeParentMap.set(b,c)})})};
return f}();f.Resource=u;var G=new l.Version(2,0,"glTF"),F=c.mat4.fromXRotation(a.mat4f64.create(),Math.PI/2),M=q.quatf64.create(),R={SCALAR:1,VEC2:2,VEC3:3,VEC4:4},T=(B={},B[5120]=1,B[5121]=1,B[5122]=2,B[5123]=2,B[5126]=4,B[5125]=4,B),O={5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5125:"UNSIGNED_INT",5126:"FLOAT"}})},"esri/core/Version":function(){define(["require","exports","./Error"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function f(e,
d,g){void 0===g&&(g="");this.major=e;this.minor=d;this._context=g}f.prototype.lessThan=function(e,d){return this.major<e||e===this.major&&this.minor<d};f.prototype.since=function(e,d){return!this.lessThan(e,d)};f.prototype.validate=function(f){if(this.major!==f.major)throw new e((this._context&&this._context+":")+"unsupported-version","Required major "+(this._context&&this._context+" ")+"version is '"+this.major+"', but got '${version.major}.${version.minor}'",{version:f});};f.prototype.clone=function(){return new f(this.major,
this.minor,this._context)};f.parse=function(m,d){void 0===d&&(d="");var g=m.split("."),k=g[0],g=g[1],l=/^\s*\d+\s*$/;if(!k||!k.match||!k.match(l))throw new e((d&&d+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:m});if(!g||!g.match||!g.match(l))throw new e((d&&d+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:m});m=parseInt(k,10);k=parseInt(g,10);return new f(m,k,d)};return f}();f.Version=u})},"esri/views/3d/glTF/internal/BinaryStreamReader":function(){define(["require",
"exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function e(e){this.data=e;this.offset4=0;this.dataUint32=new Uint32Array(this.data,0,Math.floor(this.data.byteLength/4))}e.prototype.readUint32=function(){var e=this.offset4;this.offset4+=1;return this.dataUint32[e]};e.prototype.readUint8Array=function(e){var f=4*this.offset4;this.offset4+=e/4;return new Uint8Array(this.data,f,e)};e.prototype.remainingBytes=function(){return this.data.byteLength-4*this.offset4};
return e}();f.BinaryStreamReader=u})},"esri/views/3d/glTF/internal/fillDefaults":function(){define(["require","exports","tslib","../../../../core/compilerUtils"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});var m={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1},d={pbrMetallicRoughness:m,emissiveFactor:[0,0,0],alphaMode:"OPAQUE",alphaCutoff:.5,doubleSided:!1},g={ESRI_externalColorMixMode:"tint"};f.material=function(f){void 0===f&&(f={});var c=e.__assign(e.__assign({},
m),f.pbrMetallicRoughness),a=e.__assign(e.__assign({},g),f.extras);switch(a.ESRI_externalColorMixMode){case "multiply":case "tint":case "ignore":case "replace":break;default:r.neverReached(a.ESRI_externalColorMixMode),a.ESRI_externalColorMixMode="tint"}return e.__assign(e.__assign(e.__assign({},d),f),{pbrMetallicRoughness:c,extras:a})};var k={magFilter:9729,minFilter:9987,wrapS:10497,wrapT:10497};f.textureSampler=function(d){return e.__assign(e.__assign({},k),d)}})},"esri/views/3d/glTF/internal/pathUtils":function(){define(["require",
"exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});f.splitURI=function(e){var f,m;e.replace(/^(.*\/)?([^/]*)$/,function(d,e,k){f=e||"";m=k||"";return""});return{dirPart:f,filePart:m}}})},"esri/views/3d/support/buffer/utils":function(){define("require exports ./types ./utils/mat3 ./utils/mat4 ./utils/scalar ./utils/vec2 ./utils/vec3 ./utils/vec4".split(" "),function(u,f,e,r,m,d,g,k,l){Object.defineProperty(f,"__esModule",{value:!0});f.mat3=r;f.mat4=m;f.scalar=d;f.vec2=g;f.vec3=
k;f.vec4=l;f.createBuffer=function(c,a){return new c(new ArrayBuffer(a*c.ElementCount*e.elementTypeSize(c.ElementType)))}})},"esri/views/3d/support/buffer/utils/mat3":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});f.copy=function(e,f,m){var d=e.typedBuffer;e=e.typedBufferStride;var g=f.typedBuffer,k=f.typedBufferStride;f=m?m.count:f.count;var l=(m&&m.dstIndex?m.dstIndex:0)*e;m=(m&&m.srcIndex?m.srcIndex:0)*k;for(var c=0;c<f;++c){for(var a=0;9>
a;++a)d[l+a]=g[m+a];l+=e;m+=k}}})},"esri/views/3d/support/buffer/utils/mat4":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});f.copy=function(e,f,m){var d=e.typedBuffer;e=e.typedBufferStride;var g=f.typedBuffer,k=f.typedBufferStride;f=m?m.count:f.count;var l=(m&&m.dstIndex?m.dstIndex:0)*e;m=(m&&m.srcIndex?m.srcIndex:0)*k;for(var c=0;c<f;++c){for(var a=0;16>a;++a)d[l+a]=g[m+a];l+=e;m+=k}}})},"esri/views/3d/support/buffer/utils/scalar":function(){define(["require",
"exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});f.copy=function(e,f,m){var d=e.typedBuffer;e=e.typedBufferStride;var g=f.typedBuffer,k=f.typedBufferStride;f=m?m.count:f.count;var l=(m&&m.dstIndex?m.dstIndex:0)*e;m=(m&&m.srcIndex?m.srcIndex:0)*k;for(var c=0;c<f;++c)d[l]=g[m],l+=e,m+=k};f.makeDense=function(e,f){var m=e.count;f||(f=new e.TypedArrayConstructor(m));for(var d=0;d<m;d++)f[d]=e.get(d);return f}})},"esri/views/3d/support/buffer/utils/vec2":function(){define(["require",
"exports","../types"],function(u,f,e){function r(e,d,g){var f=e.typedBuffer;e=e.typedBufferStride;var l=d.typedBuffer,c=d.typedBufferStride;d=g?g.count:d.count;var a=(g&&g.dstIndex?g.dstIndex:0)*e;g=(g&&g.srcIndex?g.srcIndex:0)*c;for(var b=0;b<d;++b)f[a]=l[g],f[a+1]=l[g+1],a+=e,g+=c}Object.defineProperty(f,"__esModule",{value:!0});f.copy=r;f.normalizeIntegerBuffer=function(f,d,g){var k=f.typedBuffer,l=f.typedBufferStride,c=d.typedBuffer,a=d.typedBufferStride,b=g?g.count:d.count,q=(g&&g.dstIndex?g.dstIndex:
0)*l,m=(g&&g.srcIndex?g.srcIndex:0)*a;if(e.isInteger(d.elementType))if(g=e.maximumValue(d.elementType),e.isSigned(d.elementType))for(d=0;d<b;++d)k[q]=Math.max(c[m]/g,-1),k[q+1]=Math.max(c[m+1]/g,-1),q+=l,m+=a;else for(d=0;d<b;++d)k[q]=c[m]/g,k[q+1]=c[m+1]/g,q+=l,m+=a;else r(f,d,g);return f}})},"esri/views/3d/support/buffer/utils/vec3":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});f.copy=function(e,f,m){var d=e.typedBuffer;e=e.typedBufferStride;
var g=f.typedBuffer,k=f.typedBufferStride;f=m?m.count:f.count;var l=(m&&m.dstIndex?m.dstIndex:0)*e;m=(m&&m.srcIndex?m.srcIndex:0)*k;for(var c=0;c<f;++c)d[l]=g[m],d[l+1]=g[m+1],d[l+2]=g[m+2],l+=e,m+=k}})},"esri/views/3d/support/buffer/utils/vec4":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});f.copy=function(e,f,m){var d=e.typedBuffer;e=e.typedBufferStride;var g=f.typedBuffer,k=f.typedBufferStride;f=m?m.count:f.count;var l=(m&&m.dstIndex?m.dstIndex:
0)*e;m=(m&&m.srcIndex?m.srcIndex:0)*k;for(var c=0;c<f;++c)d[l]=g[m],d[l+1]=g[m+1],d[l+2]=g[m+2],d[l+3]=g[m+3],l+=e,m+=k};f.fill=function(e,f,m,d,g,k){var l=e.typedBuffer,c=e.typedBufferStride;e=k?k.count:e.count;k=(k&&k.dstIndex?k.dstIndex:0)*c;for(var a=0;a<e;++a)l[k]=f,l[k+1]=m,l[k+2]=d,l[k+3]=g,k+=c}})},"esri/views/3d/glTF/internal/indexUtils":function(){define(["require","exports","../../../../core/typedArrayUtil","../../webgl-engine/lib/geometryDataUtils"],function(u,f,e,r){function m(d){return r.generateDefaultIndexArray(d)}
Object.defineProperty(f,"__esModule",{value:!0});f.linearIndexArray=m;f.trianglesToTriangles=function(d){return"number"===typeof d?m(d):e.isUint16Array(d)||e.isUint8Array(d)?new Uint32Array(d):d};f.triangleStripToTriangles=function(d){var e="number"===typeof d?d:d.length;if(3>e)return new Uint32Array(0);var e=e-2,f=new Uint32Array(3*e);if("number"===typeof d)for(var l=0,c=0;c<e;c+=1)0===c%2?(f[l++]=c,f[l++]=c+1):(f[l++]=c+1,f[l++]=c),f[l++]=c+2;else for(c=l=0;c<e;c+=1){if(0===c%2)var a=d[c],b=d[c+
1],q=d[c+2];else a=d[c+1],b=d[c],q=d[c+2];f[l++]=a;f[l++]=b;f[l++]=q}return f};f.triangleFanToTriangles=function(d){var e="number"===typeof d?d:d.length;if(3>e)return new Uint32Array(0);var e=e-2,f=new Uint32Array(3*e);if("number"===typeof d){for(var l=0,c=0;c<e;++c)f[l++]=0,f[l++]=c+1,f[l++]=c+2;return f}for(var a=d[0],b=d[1],c=l=0;c<e;++c){var q=d[c+2];f[l++]=a;f[l++]=b;b=f[l++]=q}return f}})},"esri/views/3d/layers/graphics/wosrLoader":function(){define("require exports tslib ../../../../request ../../../../core/asyncUtils ../../../../core/Error ../../../../core/lang ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/Version ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../geometry/support/aaBoundingBox ../../support/imageUtils ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryData ../../webgl-engine/lib/Texture ../../webgl-engine/materials/DefaultMaterial".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A){function E(a,b){return e.__awaiter(this,void 0,void 0,function(){var d,f;return e.__generator(this,function(e){switch(e.label){case 0:return(d=l.isSome(b)&&b.streamDataRequester)?[2,H(a,d,b)]:[4,m.result(r(a,l.unwrap(b)))];case 1:f=e.sent();if(!0===f.ok)return[2,f.value.data];c.throwIfAbortError(f.error);J(f.error);return[2,void 0]}})})}function H(a,b,d){return e.__awaiter(this,void 0,void 0,function(){var f;return e.__generator(this,function(e){switch(e.label){case 0:return[4,
m.result(b.request(a,"json",d))];case 1:f=e.sent();if(!0===f.ok)return[2,f.value];c.throwIfAbortError(f.error);J(f.error.details.url);return[2,void 0]}})})}function J(a){throw new d("","Request for object resource failed: "+a);}function B(a){var b=q.empty();a.forEach(function(a){a=a.boundingInfo;q.expand(b,a.getBBMin());q.expand(b,a.getBBMax())});return b}function G(a,b){return e.__awaiter(this,void 0,void 0,function(){var d,f,g,k,q,m,t,r;return e.__generator(this,function(e){switch(e.label){case 0:d=
[];f=function(e){var f=a[e],g=f.images[0].data;if(!g)return M.warn("Externally referenced texture data is not yet supported"),"continue";var g=f.encoding+";base64,"+g,k="/textureDefinitions/"+e,q={noUnpackFlip:!0,wrap:{s:10497,t:10497},preMultiplyAlpha:!0};e=l.isSome(b)&&b.disableTextures?c.resolve(null):v.requestImage(g,b);d.push(e.then(function(a){return{refId:k,image:a,params:q,alphaChannelUsage:"rgba"===f.channels?f.alphaChannelUsage||"transparency":"none"}}))};for(g in a)f(g);return[4,c.all(d)];
case 1:k=e.sent();q={};m=0;for(t=k;m<t.length;m++)r=t[m],q[r.refId]=r;return[2,q]}})})}function F(a){switch(a){case "mask":return 2;case "maskAndTransparency":return 3;case "none":return 1;case "transparency":return 0;default:return 0}}Object.defineProperty(f,"__esModule",{value:!0});var M=k.getLogger("esri.views.3d.layers.graphics.objectResourceUtils");f.load=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d;return e.__generator(this,function(e){switch(e.label){case 0:return[4,
E(a,b)];case 1:return c=e.sent(),[4,G(c.textureDefinitions,b)];case 2:return d=e.sent(),[2,{resource:c,textures:d}]}})})};f.processLoadResult=function(c,d){var e,f,k=[],q=[],m=[],r=[],v=c.resource,u=a.Version.parse(v.version||"1.0","wosr");R.validate(u);var u=v.model.name,E=v.model.geometries,G=v.materialDefinitions;c=c.textures;for(var H=0,J=new Map,O=0;O<E.length;O++){var da=E[O];f=da;var T=f.params,fa=T.topology;e=!0;T.vertexAttributes||(M.warn("Geometry must specify vertex attributes"),e=!1);
switch(T.topology){case "PerAttributeArray":break;case "Indexed":case null:case void 0:fa=T.faces;if(!fa)M.warn("Indexed geometries must specify faces"),e=!1;else if(T.vertexAttributes){var la=void 0;for(la in T.vertexAttributes)(T=fa[la])&&T.values?(null!=T.valueType&&"UInt32"!==T.valueType&&(M.warn("Unsupported indexed geometry indices type '"+T.valueType+"', only UInt32 is currently supported"),e=!1),null!=T.valuesPerElement&&1!==T.valuesPerElement&&(M.warn("Unsupported indexed geometry values per element '"+
T.valuesPerElement+"', only 1 is currently supported"),e=!1)):(M.warn("Indexed geometry does not specify face indices for '"+la+"' attribute"),e=!1)}break;default:M.warn("Unsupported topology '"+fa+"'"),e=!1}f.params.material||(M.warn("Geometry requires material"),e=!1);f=f.params.vertexAttributes;T=void 0;for(T in f)f[T].values||(M.warn("Geometries with externally defined attributes are not yet supported"),e=!1);if(e){f=da.params;e=f.material;f=f.texture;var fa=da.params.vertexAttributes,T={},ia;
for(ia in fa)la=fa[ia],T[ia]={data:la.values,size:la.valuesPerElement};fa={};if("PerAttributeArray"===da.params.topology){for(var da=T.position.data.length/T.position.size,la=new Uint32Array(da),ca=0;ca<da;ca++)la[ca]=ca;var da=la,C;for(C in T)fa[C]=da}else{var da=da.params.faces,na;for(na in da)fa[na]=new Uint32Array(da[na].values)}(da=c&&c[f])&&!J.has(f)&&(la=new z(da.image,u,da.params),r.push(la),J.set(f,la));la=(la=J.get(f))?la.id:void 0;ca=m[e]?m[e][f]:null;if(!ca){ca=e.substring(e.lastIndexOf("/")+
1);ca=G[ca].params;1===ca.transparency&&(ca.transparency=0);var pa=da&&da.alphaChannelUsage,pa=0<ca.transparency||"transparency"===pa||"maskAndTransparency"===pa,da={ambient:b.vec3f64.fromArray(ca.diffuse),diffuse:b.vec3f64.fromArray(ca.diffuse),opacity:1-(ca.transparency||0),transparent:pa,textureAlphaMode:da?F(da.alphaChannelUsage):void 0,textureAlphaCutoff:.33,textureId:la,initTextureTransparent:!0,doubleSided:!0,cullFace:0,colorMixMode:ca.externalColorMixMode||"tint",textureAlphaPremultiplied:!0};
l.isSome(d)&&d.materialParamsMixin&&g.mixin(da,d.materialParamsMixin);ca=new A(da,u);m[e]||(m[e]={});m[e][f]=ca}q.push(ca);e=new t(new x.GeometryData(T,fa),u);H+=fa.position?fa.position.length:0;k.push(e)}}return{name:u,stageResources:{textures:r,materials:q,geometries:k},pivotOffset:v.model.pivotOffset,boundingBox:B(k),numberOfVertices:H,lodThreshold:null}};f.createTextureResources=G;var R=new a.Version(1,2,"wosr")})},"esri/views/3d/webgl-engine/materials/DefaultMaterial":function(){define("require exports tslib ../../../../core/libs/gl-matrix-2/mat3f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../support/buffer/InterleavedLayout ../core/shaderLibrary/util/AlphaDiscard.glsl ../lib/GLMaterialTexture ../lib/intersectorUtils ../lib/Material ../lib/StencilUtils ../lib/Util ./internal/bufferWriterUtils ./internal/MaterialUtil ./renderers/MergedRenderer ../shaders/DefaultMaterialTechnique ../shaders/RealisticTreeTechnique ../../../webgl/renderState ../../../webgl/renderState".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A,E,H){var J=q.assert;u=function(a){function b(c,d){d=a.call(this,d)||this;d.supportsEdges=!0;d.techniqueConfig=new z.DefaultMaterialTechniqueConfiguration;d.params=t.copyParameters(c,G);d.vertexBufferLayout=b.getVertexBufferLayout(d.params);d.instanceBufferLayout=c.instanced?b.getInstanceBufferLayout(d.params):null;return d}e.__extends(b,a);b.prototype.isVisibleInPass=function(a){return 3===a?this.params.castShadows:!0};b.prototype.isVisible=function(){var b=
this.params;if(!a.prototype.isVisible.call(this)||0===b.layerOpacity)return!1;var c=b.instanced,d=b.vertexColors,e=b.symbolColors,c=!!c&&-1<c.indexOf("color"),f=b.vvColorEnabled,g="replace"===b.colorMixMode,k=0<b.opacity,b=b.externalColor&&0<b.externalColor[3];return d&&(c||f||e)?g?!0:k:d?g?b:k:c||f||e?g?!0:k:g?b:k};b.prototype.setParameterValues=function(a){var b=this.params,c;for(c in a)"instanced"===c&&J(a.instanced===b.instanced,"Can not change instanced attributes"),"textureId"===c&&J(b.textureId,
"Can only change texture of material that already has a texture"),"vertexColors"===c&&!0===a[c]&&a[c]!==b[c]&&J(b.vertexColors,"Can not enable vertex colors after DefaultMaterial creation"),b[c]=a[c];this.parametersChanged()};b.prototype.getParameters=function(){return this.params};b.prototype.getTechniqueConfig=function(a){this.techniqueConfig.output=a;this.techniqueConfig.hasNormalTexture=!!this.params.normalTextureId;this.techniqueConfig.hasColorTexture=!!this.params.textureId;this.techniqueConfig.vertexTangents=
this.params.vertexTangents;this.techniqueConfig.instanced=!!this.params.instanced;this.techniqueConfig.instancedDoublePrecision=this.params.instancedDoublePrecision;this.techniqueConfig.vvSize=this.params.vvSizeEnabled;this.techniqueConfig.verticalOffset=null!==this.params.verticalOffset;this.techniqueConfig.screenSizePerspective=null!==this.params.screenSizePerspective;this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled;this.techniqueConfig.sliceHighlightDisabled=this.params.sliceHighlightDisabled;
this.techniqueConfig.alphaDiscardMode=this.params.textureAlphaMode;this.techniqueConfig.normalsTypeDerivate="screenDerivative"===this.params.normals?!0:!1;0===a&&(this.techniqueConfig.vertexColors=this.params.vertexColors,this.techniqueConfig.symbolColors=this.params.symbolColors,this.params.treeRendering||(this.techniqueConfig.doubleSidedMode=this.params.doubleSided&&"normal"===this.params.doubleSidedType?1:this.params.doubleSided&&"winding-order"===this.params.doubleSidedType?2:0),this.techniqueConfig.instancedColor=
!!this.params.instanced&&-1<this.params.instanced.indexOf("color"),this.techniqueConfig.receiveShadows=this.params.receiveShadows&&this.params.shadowMappingEnabled,this.techniqueConfig.receiveAmbientOcclusion=this.params.receiveSSAO,this.techniqueConfig.vvColor=this.params.vvColorEnabled,this.techniqueConfig.textureAlphaPremultiplied=!!this.params.textureAlphaPremultiplied,this.techniqueConfig.usePBR=this.params.usePBR,this.techniqueConfig.hasMetalnessAndRoughnessTexture=!!this.params.metallicRoughnessTextureId,
this.techniqueConfig.hasEmissionTexture=!!this.params.emissiveTextureId,this.techniqueConfig.hasOcclusionTexture=!!this.params.occlusionTextureId,this.techniqueConfig.offsetBackfaces=!(!this.params.transparent||!this.params.offsetTransparentBackfaces),this.techniqueConfig.isSchematic=this.params.usePBR&&this.params.isSchematic);return this.techniqueConfig};b.prototype.intersect=function(a,b,d,e,f,g,k){if(null!==this.params.verticalOffset){var l=e.camera;m.vec3.set(S,d[12],d[13],d[14]);d=null;switch(e.viewingMode){case "global":d=
m.vec3.normalize(L,S);break;case "local":d=m.vec3.copy(L,O)}var q=0;if(null!==this.params.verticalOffset){var r=m.vec3.subtract(aa,S,l.eye),v=m.vec3.length(r),r=m.vec3.scale(r,r,1/v),x=null;this.params.screenSizePerspective&&(x=m.vec3.dot(d,r));q+=t.verticalOffsetAtDistance(l,v,this.params.verticalOffset,x,this.params.screenSizePerspective)}m.vec3.scale(d,d,q);m.vec3.transformMat3(Q,d,e.transform.inverseRotation);f=m.vec3.subtract(R,f,Q);g=m.vec3.subtract(T,g,Q)}t.intersectTriangleGeometry(a,b,e,
f,g,c.getVerticalOffsetObject3D(e.verticalOffset),k)};b.prototype.getGLMaterial=function(a){if(0===a.output||1===a.output||2===a.output||3===a.output||4===a.output)return new B(a)};b.prototype.createRenderer=function(a,b){return new x(a,b,this)};b.prototype.createBufferWriter=function(){return new F(this.vertexBufferLayout,this.instanceBufferLayout)};b.getVertexBufferLayout=function(a){var b=a.textureId||a.normalTextureId||a.metallicRoughnessTextureId||a.emissiveTextureId||a.occlusionTextureId,c=
g.newLayout().vec3f("position").vec3f("normal");a.vertexTangents&&c.vec4f("tangent");b&&c.vec2f("uv0");a.vertexColors&&c.vec4u8("color");a.symbolColors&&c.vec4u8("symbolColor");return c};b.getInstanceBufferLayout=function(a){var b=g.newLayout(),b=a.instancedDoublePrecision?b.vec3f("modelOriginHi").vec3f("modelOriginLo").mat3f("model").mat3f("modelNormal"):b.mat4f("model").mat4f("modelNormal");a.instanced&&-1<a.instanced.indexOf("color")&&(b=b.vec4f("instanceColor"));a.instanced&&-1<a.instanced.indexOf("featureAttribute")&&
(b=b.vec4f("instanceFeatureAttribute"));return b};return b}(a.Material);var B=function(a){function c(b){var c=this,c=b.material,c=a.call(this,e.__assign(e.__assign({},b),c.getParameters()))||this;c.updateParameters();return c}e.__extends(c,a);c.prototype.updateParameters=function(){this.selectPipelines();this.selectSlot();var a=this.material.getParameters();this.updateTexture(a.textureId);this.technique=a.treeRendering?this.techniqueRep.acquireAndReleaseExisting(A.RealisticTreeTechnique,this.material.getTechniqueConfig(this.output),
this.technique):this.techniqueRep.acquireAndReleaseExisting(z.DefaultMaterialTechnique,this.material.getTechniqueConfig(this.output),this.technique)};c.prototype.selectSlot=function(){this.slot=this.material.getParameters().transparent?this.material.getParameters().writeDepth?5:8:3};c.prototype.selectPipelines=function(){var a=this.material.getParameters(),c=0===this.output?a.transparent&&E.separateBlendingParams(770,1,771,771):null,d=function(d){return H.makePipelineState({blending:c,culling:M(a),
depthTest:{func:513},depthWrite:a.writeDepth&&H.defaultDepthWriteParams,colorWrite:H.defaultColorWriteParams,stencilWrite:a.sceneHasOcludees?b.stencilWriteMaskOn:null,stencilTest:a.sceneHasOcludees?d?b.stencilToolMaskBaseParams:b.stencilBaseAllZerosParams:null})};this.pipelineState=d(!1);this.occludeePipelineState=d(!0)};c.prototype._updateShadowState=function(a){a.shadowMappingEnabled!==this.material.getParameters().shadowMappingEnabled&&(this.material.setParameterValues({shadowMappingEnabled:a.shadowMappingEnabled}),
this.updateParameters())};c.prototype._updateOccludeeState=function(a){a.hasOccludees!==this.material.getParameters().sceneHasOcludees&&(this.material.setParameterValues({sceneHasOcludees:a.hasOccludees}),this.updateParameters())};c.prototype.ensureParameters=function(a){0===this.output&&(this._updateShadowState(a),this._updateOccludeeState(a))};c.prototype.bind=function(a,b){a.bindProgram(this.technique.program);this.technique.bindPass(a,this.material.getParameters(),b);this.bindTexture(a,this.technique.program)};
c.prototype.beginSlot=function(a){return a===this.slot};c.prototype.getPipelineState=function(a,b){return b?this.occludeePipelineState:this.pipelineState};return c}(l);(u||(u={})).COLOR_GAMMA=2.1;var G={textureId:void 0,initTextureTransparent:!1,isSchematic:!1,usePBR:!1,normalTextureId:void 0,vertexTangents:!1,occlusionTextureId:void 0,emissiveTextureId:void 0,metallicRoughnessTextureId:void 0,emissiveFactor:[0,0,0],mrrFactors:[0,1,.5],ambient:[.2,.2,.2],diffuse:[.8,.8,.8],externalColor:[1,1,1,1],
colorMixMode:"multiply",opacity:1,layerOpacity:1,vertexColors:!1,symbolColors:!1,doubleSided:!1,doubleSidedType:"normal",cullFace:void 0,instanced:void 0,instancedDoublePrecision:!1,normals:"default",receiveSSAO:!0,receiveShadows:!0,castShadows:!0,shadowMappingEnabled:!1,verticalOffset:null,screenSizePerspective:null,slicePlaneEnabled:!1,sliceHighlightDisabled:!1,offsetTransparentBackfaces:!1,vvSizeEnabled:!1,vvSizeMinSize:[1,1,1],vvSizeMaxSize:[100,100,100],vvSizeOffset:[0,0,0],vvSizeFactor:[1,1,
1],vvSizeValue:[1,1,1],vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],vvSymbolAnchor:[0,0,0],vvSymbolRotationMatrix:r.mat3f64.create(),transparent:!1,writeDepth:!0,textureAlphaMode:0,textureAlphaCutoff:k.defaultMaskAlphaCutoff,textureAlphaPremultiplied:!1,sceneHasOcludees:!1},F=function(){function a(a,b){this.vertexBufferLayout=a;this.instanceBufferLayout=b}a.prototype.allocate=function(a){return this.vertexBufferLayout.createBuffer(a)};
a.prototype.elementCount=function(a){return a.indices.position.length};a.prototype.write=function(a,b,c,d){v.writeDefaultAttributes(b,this.vertexBufferLayout,a.transformation,a.invTranspTransformation,c,d)};return a}(),M=function(a){var b;b=a.cullFace?0!==a.cullFace:a.slicePlaneEnabled?!1:!a.transparent&&!a.doubleSided;return b&&{face:1===a.cullFace?1028:1029,mode:2305}},R=d.vec3f64.create(),T=d.vec3f64.create(),O=d.vec3f64.fromValues(0,0,1),L=d.vec3f64.create(),Q=d.vec3f64.create(),S=d.vec3f64.create(),
aa=d.vec3f64.create();return u})},"esri/views/3d/webgl-engine/shaders/DefaultMaterialTechnique":function(){define("require exports tslib ../../../../core/libs/gl-matrix-2/vec3f64 ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/Transform.glsl ../core/shaderLibrary/attributes/InstancedDoublePrecision.glsl ../core/shaderLibrary/attributes/VerticalOffset.glsl ../core/shaderLibrary/output/OutputHighlight.glsl ../core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl ../core/shaderLibrary/shading/ReadShadowMap.glsl ../core/shaderLibrary/shading/VisualVariables.glsl ../core/shaderLibrary/util/Camera.glsl ../core/shaderLibrary/util/DoublePrecision.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/DefaultVertexAttributeLocations ../materials/internal/MaterialUtil ./DefaultMaterial.glsl ../../../webgl/Program @dojo/framework/shim/Promise".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A,E,H,J){Object.defineProperty(f,"__esModule",{value:!0});x=function(f){function x(){return null!==f&&f.apply(this,arguments)||this}e.__extends(x,f);x.prototype.initializeProgram=function(a){var b=x.shader.get(),c=this.configuration,b=b.build({output:c.output,viewingMode:a.viewingMode,receiveShadows:c.receiveShadows,slicePlaneEnabled:c.slicePlaneEnabled,sliceHighlightDisabled:c.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1,symbolColor:c.symbolColors,
vvSize:c.vvSize,vvColor:c.vvColor,vvInstancingEnabled:!0,instanced:c.instanced,instancedColor:c.instancedColor,instancedDoublePrecision:c.instancedDoublePrecision,useOldSceneLightInterface:!1,pbrMode:c.usePBR?c.isSchematic?2:1:0,hasMetalnessAndRoughnessTexture:c.hasMetalnessAndRoughnessTexture,hasEmissionTexture:c.hasEmissionTexture,hasOcclusionTexture:c.hasOcclusionTexture,hasNormalTexture:c.hasNormalTexture,hasColorTexture:c.hasColorTexture,receiveAmbientOcclusion:c.receiveAmbientOcclusion,useCustomDTRExponentForWater:!1,
normalType:c.normalsTypeDerivate?3:0,doubleSidedMode:c.doubleSidedMode,vertexTangets:c.vertexTangents,attributeTextureCoordinates:c.hasMetalnessAndRoughnessTexture||c.hasEmissionTexture||c.hasOcclusionTexture||c.hasNormalTexture||c.hasColorTexture?1:0,textureAlphaPremultiplied:c.textureAlphaPremultiplied,attributeColor:c.vertexColors,screenSizePerspectiveEnabled:c.screenSizePerspective,verticalOffsetEnabled:c.verticalOffset,offsetBackfaces:c.offsetBackfaces,doublePrecisionRequiresObfuscation:v.doublePrecisionRequiresObfuscation(a.rctx),
alphaDiscardMode:c.alphaDiscardMode,supportsTextureAtlas:!1});return new J(a.rctx,b.generateSource("vertex"),b.generateSource("fragment"),A.Default3D)};x.prototype.bindPass=function(a,d,e){var f=this.configuration.output;0===f?(this.program.setUniform3fv("ambient",d.ambient),this.program.setUniform3fv("diffuse",d.diffuse),this.program.setUniform4fv("externalColor",d.externalColor),this.program.setUniform1i("colorMixMode",E.colorMixModes[d.colorMixMode]),this.program.setUniform1f("opacity",d.opacity),
this.program.setUniform1f("layerOpacity",d.layerOpacity),this.configuration.usePBR&&c.PhysicallyBasedRenderingParameters.bindUniforms(this.program,d,this.configuration.isSchematic)):1===f||3===f?this.program.setUniform2fv("nearFar",e.nearFar):4===f&&l.OutputHighlight.bindOutputHighlight(a,this.program,e);b.VisualVariables.bindUniformsForSymbols(this.program,d);k.VerticalOffset.bindUniforms(this.program,d,e);E.bindScreenSizePerspective(d.screenSizePerspective,this.program,"screenSizePerspectiveAlignment");
2!==d.textureAlphaMode&&3!==d.textureAlphaMode||this.program.setUniform1f("textureAlphaCutoff",d.textureAlphaCutoff)};x.prototype.bindDraw=function(b){var c=this.configuration.instancedDoublePrecision?r.vec3f64.fromValues(b.viewInvTransp[3],b.viewInvTransp[7],b.viewInvTransp[11]):b.origin;d.Transform.bindUniformsCustomOrigin(this.program,c,b.view);(0===this.configuration.output||1===this.configuration.output&&this.configuration.screenSizePerspective||2===this.configuration.output&&this.configuration.screenSizePerspective||
4===this.configuration.output&&this.configuration.screenSizePerspective)&&q.Camera.bindUniformsCustomOrigin(this.program,c,b.viewInvTransp);2===this.configuration.output&&this.program.setUniformMatrix4fv("viewNormal",b.viewInvTransp);this.configuration.instancedDoublePrecision&&g.InstancedDoublePrecision.bindCustomOrigin(this.program,c);m.Slice.bindUniforms(this.program,this.configuration,b.slicePlane,c);0===this.configuration.output&&a.ReadShadowMap.bindViewCustomOrigin(this.program,b,c)};x.prototype.initializePipeline=
function(){return null};x.shader=new t.ReloadableShaderModule(H,function(){return new Promise(function(a,b){u(["./DefaultMaterial.glsl"],a,b)})});return x}(x.ShaderTechnique);f.DefaultMaterialTechnique=x;x=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.output=0;b.alphaDiscardMode=1;b.doubleSidedMode=0;b.isSchematic=!1;b.vertexColors=!1;b.offsetBackfaces=!1;b.symbolColors=!1;b.vvSize=!1;b.vvColor=!1;b.verticalOffset=!1;b.receiveShadows=!1;b.slicePlaneEnabled=!1;b.sliceHighlightDisabled=
!1;b.receiveAmbientOcclusion=!1;b.screenSizePerspective=!1;b.textureAlphaPremultiplied=!1;b.hasColorTexture=!1;b.usePBR=!1;b.hasMetalnessAndRoughnessTexture=!1;b.hasEmissionTexture=!1;b.hasOcclusionTexture=!1;b.hasNormalTexture=!1;b.instanced=!1;b.instancedColor=!1;b.instancedDoublePrecision=!1;b.vertexTangents=!1;b.normalsTypeDerivate=!1;return b}e.__extends(b,a);e.__decorate([z.parameter({count:7})],b.prototype,"output",void 0);e.__decorate([z.parameter({count:4})],b.prototype,"alphaDiscardMode",
void 0);e.__decorate([z.parameter({count:3})],b.prototype,"doubleSidedMode",void 0);e.__decorate([z.parameter()],b.prototype,"isSchematic",void 0);e.__decorate([z.parameter()],b.prototype,"vertexColors",void 0);e.__decorate([z.parameter()],b.prototype,"offsetBackfaces",void 0);e.__decorate([z.parameter()],b.prototype,"symbolColors",void 0);e.__decorate([z.parameter()],b.prototype,"vvSize",void 0);e.__decorate([z.parameter()],b.prototype,"vvColor",void 0);e.__decorate([z.parameter()],b.prototype,"verticalOffset",
void 0);e.__decorate([z.parameter()],b.prototype,"receiveShadows",void 0);e.__decorate([z.parameter()],b.prototype,"slicePlaneEnabled",void 0);e.__decorate([z.parameter()],b.prototype,"sliceHighlightDisabled",void 0);e.__decorate([z.parameter()],b.prototype,"receiveAmbientOcclusion",void 0);e.__decorate([z.parameter()],b.prototype,"screenSizePerspective",void 0);e.__decorate([z.parameter()],b.prototype,"textureAlphaPremultiplied",void 0);e.__decorate([z.parameter()],b.prototype,"hasColorTexture",
void 0);e.__decorate([z.parameter()],b.prototype,"usePBR",void 0);e.__decorate([z.parameter()],b.prototype,"hasMetalnessAndRoughnessTexture",void 0);e.__decorate([z.parameter()],b.prototype,"hasEmissionTexture",void 0);e.__decorate([z.parameter()],b.prototype,"hasOcclusionTexture",void 0);e.__decorate([z.parameter()],b.prototype,"hasNormalTexture",void 0);e.__decorate([z.parameter()],b.prototype,"instanced",void 0);e.__decorate([z.parameter()],b.prototype,"instancedColor",void 0);e.__decorate([z.parameter()],
b.prototype,"instancedDoublePrecision",void 0);e.__decorate([z.parameter()],b.prototype,"vertexTangents",void 0);e.__decorate([z.parameter()],b.prototype,"normalsTypeDerivate",void 0);return b}(z.ShaderTechniqueConfiguration);f.DefaultMaterialTechniqueConfiguration=x})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/InstancedDoublePrecision.glsl":function(){define("require exports tslib ../../../../../../core/libs/gl-matrix-2/vec3f64 ../util/DoublePrecision.glsl ../../shaderModules/interfaces ../../../lib/doublePrecisionUtils".split(" "),
function(u,f,e,r,m,d,g){function k(c,f){f.instanced&&f.instancedDoublePrecision&&(c.attributes.add("modelOriginHi","vec3"),c.attributes.add("modelOriginLo","vec3"),c.attributes.add("model","mat3"),c.attributes.add("modelNormal","mat3"));f.instancedDoublePrecision&&(c.include(m.DoublePrecision,f),c.vertex.uniforms.add("viewOriginHi","vec3"),c.vertex.uniforms.add("viewOriginLo","vec3"));var g=[d.glsl(a||(a=e.__makeTemplateObject(["\n    vec3 calculateVPos() {\n      ","\n    }\n    "],["\n    vec3 calculateVPos() {\n      ",
"\n    }\n    "])),f.instancedDoublePrecision?"return model * localPosition().xyz;":"return localPosition().xyz;"),d.glsl(q||(q=e.__makeTemplateObject(["\n    vec3 subtractOrigin(vec3 _pos) {\n      ","\n    }\n    "],["\n    vec3 subtractOrigin(vec3 _pos) {\n      ","\n    }\n    "])),f.instancedDoublePrecision?d.glsl(b||(b=e.__makeTemplateObject(["\n          vec3 originDelta \x3d dpAdd(viewOriginHi, viewOriginLo, -modelOriginHi, -modelOriginLo);\n          return _pos - originDelta;"],["\n          vec3 originDelta \x3d dpAdd(viewOriginHi, viewOriginLo, -modelOriginHi, -modelOriginLo);\n          return _pos - originDelta;"]))):
"return vpos;"),d.glsl(v||(v=e.__makeTemplateObject(["\n    vec3 dpNormal(vec4 _normal) {\n      ","\n    }\n    "],["\n    vec3 dpNormal(vec4 _normal) {\n      ","\n    }\n    "])),f.instancedDoublePrecision?"return normalize(modelNormal * _normal.xyz);":"return normalize(_normal.xyz);"),d.glsl(t||(t=e.__makeTemplateObject(["\n    vec3 dpNormalView(vec4 _normal) {\n      ","\n    }\n    "],["\n    vec3 dpNormalView(vec4 _normal) {\n      ","\n    }\n    "])),f.instancedDoublePrecision?"return normalize((viewNormal * vec4(modelNormal * _normal.xyz, 1.0)).xyz);":
"return normalize((viewNormal * _normal).xyz);"),f.vertexTangets?d.glsl(x||(x=e.__makeTemplateObject(["\n    vec4 dpTransformVertexTangent(vec4 _tangent) {\n      ","\n      \n    }\n    "],["\n    vec4 dpTransformVertexTangent(vec4 _tangent) {\n      ","\n      \n    }\n    "])),f.instancedDoublePrecision?"return vec4(modelNormal * _tangent.xyz, _tangent.w);":"return _tangent;"):d.glsl(z||(z=e.__makeTemplateObject([""],[""])))];c.vertex.code.add(g[0]);c.vertex.code.add(g[1]);c.vertex.code.add(g[2]);
2===f.output&&c.vertex.code.add(g[3]);c.vertex.code.add(g[4])}Object.defineProperty(f,"__esModule",{value:!0});f.InstancedDoublePrecision=k;(function(a){var b=function(){return function(){}}();a.Uniforms=b;a.bindCustomOrigin=function(a,b){g.encodeDoubleArraySplit(b,l,c,3);a.setUniform3fv("viewOriginHi",l);a.setUniform3fv("viewOriginLo",c)}})(k=f.InstancedDoublePrecision||(f.InstancedDoublePrecision={}));var l=r.vec3f64.create(),c=r.vec3f64.create(),a,b,q,v,t,x,z})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/DoublePrecision.glsl":function(){define("require exports tslib ../../../../../../core/has ../../shaderModules/interfaces ../../../lib/WebGLDriverTest".split(" "),
function(u,f,e,r,m,d){Object.defineProperty(f,"__esModule",{value:!0});f.DoublePrecision=function(d,c){c.doublePrecisionRequiresObfuscation?d.vertex.code.add(m.glsl(g||(g=e.__makeTemplateObject(["\n      vec3 dpPlusFrc(vec3 a, vec3 b) {\n        return mix(a, a + b, vec3(notEqual(b, vec3(0))));\n      }\n\n      vec3 dpMinusFrc(vec3 a, vec3 b) {\n        return mix(vec3(0), a - b, vec3(notEqual(a, b)));\n      }\n\n      // based on https://www.thasler.com/blog/blog/glsl-part2-emu\n      vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n        vec3 t1 \x3d dpPlusFrc(hiA, hiB);\n        vec3 e \x3d dpMinusFrc(t1, hiA);\n        vec3 t2 \x3d dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\n        return t1 + t2;\n      }\n    "],
["\n      vec3 dpPlusFrc(vec3 a, vec3 b) {\n        return mix(a, a + b, vec3(notEqual(b, vec3(0))));\n      }\n\n      vec3 dpMinusFrc(vec3 a, vec3 b) {\n        return mix(vec3(0), a - b, vec3(notEqual(a, b)));\n      }\n\n      // based on https://www.thasler.com/blog/blog/glsl-part2-emu\n      vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n        vec3 t1 \x3d dpPlusFrc(hiA, hiB);\n        vec3 e \x3d dpMinusFrc(t1, hiA);\n        vec3 t2 \x3d dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\n        return t1 + t2;\n      }\n    "])))):
d.vertex.code.add(m.glsl(k||(k=e.__makeTemplateObject(["\n      vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n        vec3 t1 \x3d hiA + hiB;\n        vec3 e \x3d t1 - hiA;\n        vec3 t2 \x3d ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\n        return t1 + t2;\n      }\n    "],["\n      vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n        vec3 t1 \x3d hiA + hiB;\n        vec3 e \x3d t1 - hiA;\n        vec3 t2 \x3d ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\n        return t1 + t2;\n      }\n    "]))))};
f.doublePrecisionRequiresObfuscation=function(e){return r("force-double-precision-obfuscation")?!0:d.testWebGLDriver(e).doublePrecisionRequiresObfuscation};var g,k})},"esri/views/3d/webgl-engine/lib/WebGLDriverTest":function(){define("require exports ../../../../core/maybe ../../../../core/libs/gl-matrix-2/vec3f64 ../../../webgl ./doublePrecisionUtils ./Util".split(" "),function(u,f,e,r,m,d,g){function k(a,b){var c=new m.FramebufferObject(a,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,
pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1}),e=m.BufferObject.createVertex(a,35044,new Uint16Array([0,0,1,0,0,1,1,1])),f=new m.VertexArrayObject(a,{a_pos:0},{geometry:[{name:"a_pos",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:e}),k=r.vec3f64.fromValues(5633261.287538229,2626832.878767164,1434988.0495278358),l=r.vec3f64.fromValues(5633271.46742708,2626873.6381334523,1434963.231608387);b=new m.Program(a,"\n\n  precision highp float;\n\n  attribute vec2 a_pos;\n\n  uniform vec3 u_highA;\n  uniform vec3 u_lowA;\n  uniform vec3 u_highB;\n  uniform vec3 u_lowB;\n\n  varying vec4 v_color;\n\n  "+
(b?"#define DOUBLE_PRECISION_REQUIRES_OBFUSCATION":"")+"\n\n  #ifdef DOUBLE_PRECISION_REQUIRES_OBFUSCATION\n\n  vec3 dpPlusFrc(vec3 a, vec3 b) {\n    return mix(a, a + b, vec3(notEqual(b, vec3(0))));\n  }\n\n  vec3 dpMinusFrc(vec3 a, vec3 b) {\n    return mix(vec3(0), a - b, vec3(notEqual(a, b)));\n  }\n\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n    vec3 t1 \x3d dpPlusFrc(hiA, hiB);\n    vec3 e \x3d dpMinusFrc(t1, hiA);\n    vec3 t2 \x3d dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\n    return t1 + t2;\n  }\n\n  #else\n\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n    vec3 t1 \x3d hiA + hiB;\n    vec3 e \x3d t1 - hiA;\n    vec3 t2 \x3d ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\n    return t1 + t2;\n  }\n\n  #endif\n\n  const float MAX_RGBA_FLOAT \x3d\n    255.0 / 256.0 +\n    255.0 / 256.0 / 256.0 +\n    255.0 / 256.0 / 256.0 / 256.0 +\n    255.0 / 256.0 / 256.0 / 256.0 / 256.0;\n\n  const vec4 FIXED_POINT_FACTORS \x3d vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n\n  vec4 float2rgba(const float value) {\n    // Make sure value is in the domain we can represent\n    float valueInValidDomain \x3d clamp(value, 0.0, MAX_RGBA_FLOAT);\n\n    // Decompose value in 32bit fixed point parts represented as\n    // uint8 rgba components. Decomposition uses the fractional part after multiplying\n    // by a power of 256 (this removes the bits that are represented in the previous\n    // component) and then converts the fractional part to 8bits.\n    vec4 fixedPointU8 \x3d floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\n\n    // Convert uint8 values (from 0 to 255) to floating point representation for\n    // the shader\n    const float toU8AsFloat \x3d 1.0 / 255.0;\n\n    return fixedPointU8 * toU8AsFloat;\n  }\n\n  void main() {\n    vec3 val \x3d dpAdd(u_highA, u_lowA, -u_highB, -u_lowB);\n\n    v_color \x3d float2rgba(val.z / 25.0);\n\n    gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n  }\n  ",
"\n  precision highp float;\n\n  varying vec4 v_color;\n\n  void main() {\n    gl_FragColor \x3d v_color;\n  }\n  ",{a_pos:0});var u=new Float32Array(6);d.encodeDoubleArray(k,u,3);var E=new Float32Array(6);d.encodeDoubleArray(l,E,3);a.bindProgram(b);b.setUniform3f("u_highA",u[0],u[2],u[4]);b.setUniform3f("u_lowA",u[1],u[3],u[5]);b.setUniform3f("u_highB",E[0],E[2],E[4]);b.setUniform3f("u_lowB",E[1],E[3],E[5]);var u=a.getBoundFramebufferObject(),H=a.getViewport(),E=H.x,J=H.y,B=H.width,G=H.height;a.bindFramebuffer(c);
a.setViewport(0,0,1,1);a.bindVAO(f);a.drawArrays(5,0,4);H=new Uint8Array(4);c.readPixels(0,0,1,1,6408,5121,H);b.dispose();f.dispose(!1);e.dispose();c.dispose();a.setViewport(E,J,B,G);a.bindFramebuffer(u);a=(k[2]-l[2])/25;c=g.unpackFloatRGBA(H);return Math.abs(a-c)}Object.defineProperty(f,"__esModule",{value:!0});var l=function(){function a(a){this.context=a;this._doublePrecisionRequiresObfuscation=null}Object.defineProperty(a.prototype,"doublePrecisionRequiresObfuscation",{get:function(){if(e.isNone(this._doublePrecisionRequiresObfuscation)){var a=
k(this.context,!1),c=k(this.context,!0);this._doublePrecisionRequiresObfuscation=0!==a&&(0===c||5<a/c)}return this._doublePrecisionRequiresObfuscation},enumerable:!0,configurable:!0});return a}(),c=null;f.testWebGLDriver=function(a){if(e.isNone(c)||c.context!==a)c=new l(a);return c};f.clearTestWebGLDriver=function(a){e.isSome(c)&&c.context===a&&(c=null)}})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl":function(){define("require exports tslib ../../../../../../core/libs/gl-matrix-2/vec3f32 ../attributes/VertexTextureCoordinates.glsl ../../shaderModules/interfaces".split(" "),
function(u,f,e,r,m,d){function g(f,g){var r=f.fragment,x=g.hasMetalnessAndRoughnessTexture||g.hasEmissionTexture||g.hasOcclusionTexture;1===g.pbrMode&&x&&f.include(m.VertexTextureCoordinates,g);2===g.pbrMode?r.code.add(d.glsl(k||(k=e.__makeTemplateObject(["\n      const vec3 mrr \x3d vec3(0.0, 0.6, 0.2);\n      const vec3 emission \x3d vec3(0.0);\n      float occlusion \x3d 1.0;\n\n      void applyPBRFactors() {}\n\n      float getBakedOcclusion() { return 1.0; }\n    "],["\n      const vec3 mrr \x3d vec3(0.0, 0.6, 0.2);\n      const vec3 emission \x3d vec3(0.0);\n      float occlusion \x3d 1.0;\n\n      void applyPBRFactors() {}\n\n      float getBakedOcclusion() { return 1.0; }\n    "])))):
(0===g.pbrMode&&r.code.add(d.glsl(l||(l=e.__makeTemplateObject(["\n      float getBakedOcclusion() { return 1.0; }\n  "],["\n      float getBakedOcclusion() { return 1.0; }\n  "])))),1===g.pbrMode&&(r.uniforms.add("emissionFactor","vec3"),r.uniforms.add("mrrFactors","vec3"),r.code.add(d.glsl(c||(c=e.__makeTemplateObject(["\n      vec3 mrr;\n      vec3 emission;\n      float occlusion;\n    "],["\n      vec3 mrr;\n      vec3 emission;\n      float occlusion;\n    "])))),g.hasMetalnessAndRoughnessTexture&&
(r.uniforms.add("texMetallicRoughness","sampler2D"),g.supportsTextureAtlas&&r.uniforms.add("texMetallicRoughnessSize","vec2"),r.code.add(d.glsl(a||(a=e.__makeTemplateObject(["\n      void applyMetallnessAndRoughness(TextureLookupParameter params) {\n        vec3 metallicRoughness \x3d textureLookup(texMetallicRoughness, params).rgb;\n\n        mrr[0] *\x3d metallicRoughness.b;\n        mrr[1] *\x3d metallicRoughness.g;\n      }"],["\n      void applyMetallnessAndRoughness(TextureLookupParameter params) {\n        vec3 metallicRoughness \x3d textureLookup(texMetallicRoughness, params).rgb;\n\n        mrr[0] *\x3d metallicRoughness.b;\n        mrr[1] *\x3d metallicRoughness.g;\n      }"]))))),
g.hasEmissionTexture&&(r.uniforms.add("texEmission","sampler2D"),g.supportsTextureAtlas&&r.uniforms.add("texEmissionSize","vec2"),r.code.add(d.glsl(b||(b=e.__makeTemplateObject(["\n      void applyEmission(TextureLookupParameter params) {\n        emission *\x3d textureLookup(texEmission, params).rgb;\n      }"],["\n      void applyEmission(TextureLookupParameter params) {\n        emission *\x3d textureLookup(texEmission, params).rgb;\n      }"]))))),g.hasOcclusionTexture?(r.uniforms.add("texOcclusion",
"sampler2D"),g.supportsTextureAtlas&&r.uniforms.add("texOcclusionSize","vec2"),r.code.add(d.glsl(q||(q=e.__makeTemplateObject(["\n      void applyOcclusion(TextureLookupParameter params) {\n        occlusion *\x3d textureLookup(texOcclusion, params).r;\n      }\n\n      float getBakedOcclusion() {\n        return occlusion;\n      }\n      "],["\n      void applyOcclusion(TextureLookupParameter params) {\n        occlusion *\x3d textureLookup(texOcclusion, params).r;\n      }\n\n      float getBakedOcclusion() {\n        return occlusion;\n      }\n      "]))))):
r.code.add(d.glsl(v||(v=e.__makeTemplateObject(["\n      float getBakedOcclusion() { return 1.0; }\n      "],["\n      float getBakedOcclusion() { return 1.0; }\n      "])))),r.code.add(d.glsl(t||(t=e.__makeTemplateObject(["\n    void applyPBRFactors() {\n      mrr \x3d mrrFactors;\n      emission \x3d emissionFactor;\n      occlusion \x3d 1.0;\n      ","\n      ","\n      ","\n      ","\n    }\n  "],["\n    void applyPBRFactors() {\n      mrr \x3d mrrFactors;\n      emission \x3d emissionFactor;\n      occlusion \x3d 1.0;\n      ",
"\n      ","\n      ","\n      ","\n    }\n  "])),x?"vtc.uv \x3d vuv0;":"",g.hasMetalnessAndRoughnessTexture?g.supportsTextureAtlas?"vtc.size \x3d texMetallicRoughnessSize; applyMetallnessAndRoughness(vtc);":"applyMetallnessAndRoughness(vtc);":"",g.hasEmissionTexture?g.supportsTextureAtlas?"vtc.size \x3d texEmissionSize; applyEmission(vtc);":"applyEmission(vtc);":"",g.hasOcclusionTexture?g.supportsTextureAtlas?"vtc.size \x3d texOcclusionSize; applyOcclusion(vtc);":"applyOcclusion(vtc);":""))))}Object.defineProperty(f,
"__esModule",{value:!0});f.PBRSchematicMRRValues=r.vec3f32.fromValues(0,.6,.2);f.PhysicallyBasedRenderingParameters=g;(function(a){a.bindUniforms=function(a,b,c){void 0===c&&(c=!1);c||(a.setUniform3fv("mrrFactors",b.mrrFactors),a.setUniform3fv("emissionFactor",b.emissiveFactor))}})(g=f.PhysicallyBasedRenderingParameters||(f.PhysicallyBasedRenderingParameters={}));var k,l,c,a,b,q,v,t})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/VertexTextureCoordinates.glsl":function(){define("require exports tslib ./TextureCoordinateAttribute.glsl ../util/TextureAtlasLookup.glsl ../../shaderModules/interfaces".split(" "),
function(u,f,e,r,m,d){Object.defineProperty(f,"__esModule",{value:!0});f.VertexTextureCoordinates=function(c,a){c.include(r.TextureCoordinateAttribute,a);c.fragment.code.add(d.glsl(g||(g=e.__makeTemplateObject(["\n  struct TextureLookupParameter {\n    vec2 uv;\n    ","\n  } vtc;\n  "],["\n  struct TextureLookupParameter {\n    vec2 uv;\n    ","\n  } vtc;\n  "])),a.supportsTextureAtlas?"vec2 size;":""));1===a.attributeTextureCoordinates&&c.fragment.code.add(d.glsl(k||(k=e.__makeTemplateObject(["\n      vec4 textureLookup(sampler2D tex, TextureLookupParameter params) {\n        return texture2D(tex, params.uv);\n      }\n    "],
["\n      vec4 textureLookup(sampler2D tex, TextureLookupParameter params) {\n        return texture2D(tex, params.uv);\n      }\n    "]))));2===a.attributeTextureCoordinates&&(c.include(m.TextureAtlasLookup),c.fragment.code.add(d.glsl(l||(l=e.__makeTemplateObject(["\n    vec4 textureLookup(sampler2D tex, TextureLookupParameter params) {\n        return textureAtlasLookup(tex, params.size, params.uv, vuvRegion);\n      }\n    "],["\n    vec4 textureLookup(sampler2D tex, TextureLookupParameter params) {\n        return textureAtlasLookup(tex, params.size, params.uv, vuvRegion);\n      }\n    "])))))};
var g,k,l})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl":function(){define(["require","exports","tslib","../../shaderModules/interfaces"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.TextureCoordinateAttribute=function(f,l){1===l.attributeTextureCoordinates&&(f.attributes.add("uv0","vec2"),f.varyings.add("vuv0","vec2"),f.vertex.code.add(r.glsl(m||(m=e.__makeTemplateObject(["\n      void forwardTextureCoordinates() {\n        vuv0 \x3d uv0;\n      }\n    "],
["\n      void forwardTextureCoordinates() {\n        vuv0 \x3d uv0;\n      }\n    "])))));2===l.attributeTextureCoordinates&&(f.attributes.add("uv0","vec2"),f.varyings.add("vuv0","vec2"),f.attributes.add("uvRegion","vec4"),f.varyings.add("vuvRegion","vec4"),f.vertex.code.add(r.glsl(d||(d=e.__makeTemplateObject(["\n      void forwardTextureCoordinates() {\n        vuv0 \x3d uv0;\n        vuvRegion \x3d uvRegion;\n      }\n    "],["\n      void forwardTextureCoordinates() {\n        vuv0 \x3d uv0;\n        vuvRegion \x3d uvRegion;\n      }\n    "])))));
0===l.attributeTextureCoordinates&&f.vertex.code.add(r.glsl(g||(g=e.__makeTemplateObject(["\n      void forwardTextureCoordinates() {}\n    "],["\n      void forwardTextureCoordinates() {}\n    "]))))};var m,d,g})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/TextureAtlasLookup.glsl":function(){define(["require","exports","tslib","../../shaderModules/interfaces"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.TextureAtlasLookup=function(d){d.extensions.add("GL_EXT_shader_texture_lod");
d.extensions.add("GL_OES_standard_derivatives");d.fragment.code.add(r.glsl(m||(m=e.__makeTemplateObject(["\n    #ifndef GL_EXT_shader_texture_lod\n      float calcMipMapLevel(const vec2 ddx, const vec2 ddy) {\n        float deltaMaxSqr \x3d max(dot(ddx, ddx), dot(ddy, ddy));\n        return max(0.0, 0.5 * log2(deltaMaxSqr));\n      }\n    #endif\n\n    vec4 textureAtlasLookup(sampler2D texture, vec2 textureSize, vec2 textureCoordinates, vec4 atlasRegion) {\n      //[umin, vmin, umax, vmax]\n      vec2 atlasScale \x3d atlasRegion.zw - atlasRegion.xy;\n      vec2 uvAtlas \x3d fract(textureCoordinates) * atlasScale + atlasRegion.xy;\n\n      // calculate derivative of continuous texture coordinate\n      // to avoid mipmapping artifacts caused by manual wrapping in shader\n      vec2 dUVdx \x3d dFdx(textureCoordinates) * atlasScale;\n      vec2 dUVdy \x3d dFdy(textureCoordinates) * atlasScale;\n\n      #ifdef GL_EXT_shader_texture_lod\n        return texture2DGradEXT(texture, uvAtlas, dUVdx, dUVdy);\n      #else\n        // use bias to compensate for difference in automatic vs desired mipmap level\n        vec2 dUVdxAuto \x3d dFdx(uvAtlas);\n        vec2 dUVdyAuto \x3d dFdy(uvAtlas);\n        float mipMapLevel \x3d calcMipMapLevel(dUVdx * textureSize, dUVdy * textureSize);\n        float autoMipMapLevel \x3d calcMipMapLevel(dUVdxAuto * textureSize, dUVdyAuto * textureSize);\n\n        return texture2D(texture, uvAtlas, mipMapLevel - autoMipMapLevel);\n      #endif\n    }\n  "],
["\n    #ifndef GL_EXT_shader_texture_lod\n      float calcMipMapLevel(const vec2 ddx, const vec2 ddy) {\n        float deltaMaxSqr \x3d max(dot(ddx, ddx), dot(ddy, ddy));\n        return max(0.0, 0.5 * log2(deltaMaxSqr));\n      }\n    #endif\n\n    vec4 textureAtlasLookup(sampler2D texture, vec2 textureSize, vec2 textureCoordinates, vec4 atlasRegion) {\n      //[umin, vmin, umax, vmax]\n      vec2 atlasScale \x3d atlasRegion.zw - atlasRegion.xy;\n      vec2 uvAtlas \x3d fract(textureCoordinates) * atlasScale + atlasRegion.xy;\n\n      // calculate derivative of continuous texture coordinate\n      // to avoid mipmapping artifacts caused by manual wrapping in shader\n      vec2 dUVdx \x3d dFdx(textureCoordinates) * atlasScale;\n      vec2 dUVdy \x3d dFdy(textureCoordinates) * atlasScale;\n\n      #ifdef GL_EXT_shader_texture_lod\n        return texture2DGradEXT(texture, uvAtlas, dUVdx, dUVdy);\n      #else\n        // use bias to compensate for difference in automatic vs desired mipmap level\n        vec2 dUVdxAuto \x3d dFdx(uvAtlas);\n        vec2 dUVdyAuto \x3d dFdy(uvAtlas);\n        float mipMapLevel \x3d calcMipMapLevel(dUVdx * textureSize, dUVdy * textureSize);\n        float autoMipMapLevel \x3d calcMipMapLevel(dUVdxAuto * textureSize, dUVdyAuto * textureSize);\n\n        return texture2D(texture, uvAtlas, mipMapLevel - autoMipMapLevel);\n      #endif\n    }\n  "]))))};
var m})},"esri/views/3d/webgl-engine/shaders/DefaultMaterial.glsl":function(){define("require exports tslib ../core/shaderLibrary/ForwardLinearDepth.glsl ../core/shaderLibrary/Offset.glsl ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/Transform.glsl ../core/shaderLibrary/attributes/InstancedDoublePrecision.glsl ../core/shaderLibrary/attributes/NormalAttribute.glsl ../core/shaderLibrary/attributes/PositionAttribute.glsl ../core/shaderLibrary/attributes/SymbolColor.glsl ../core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl ../core/shaderLibrary/attributes/VertexColor.glsl ../core/shaderLibrary/attributes/VertexNormal.glsl ../core/shaderLibrary/attributes/VerticalOffset.glsl ../core/shaderLibrary/default/DefaultMaterialAuxiliaryPasses.glsl ../core/shaderLibrary/shading/ComputeNormalTexture.glsl ../core/shaderLibrary/shading/EvaluateAmbientOcclusion.glsl ../core/shaderLibrary/shading/EvaluateSceneLighting.glsl ../core/shaderLibrary/shading/Normals.glsl ../core/shaderLibrary/shading/PhysicallyBasedRendering.glsl ../core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl ../core/shaderLibrary/shading/ReadShadowMap.glsl ../core/shaderLibrary/shading/VisualVariables.glsl ../core/shaderLibrary/util/AlphaDiscard.glsl ../core/shaderLibrary/util/HeaderComment.glsl ../core/shaderLibrary/util/MixExternalColor.glsl ../core/shaderModules/interfaces ../core/shaderModules/ShaderBuilder".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A,E,H,J,B,G,F,M,R,T,O,L){Object.defineProperty(f,"__esModule",{value:!0});f.build=function(f){var u=new L.ShaderBuilder,fa=u.vertex.code,ca=u.fragment.code;u.include(R.HeaderComment,{name:"Default Material Shader",output:f.output});u.vertex.uniforms.add("proj","mat4").add("view","mat4").add("camPos","vec3").add("localOrigin","vec3");u.include(c.PositionAttribute);u.varyings.add("vpos","vec3");u.include(F.VisualVariables,f);u.include(k.InstancedDoublePrecision,
f);u.include(t.VerticalOffset,f);0===f.output&&(u.include(l.NormalAttribute,f),u.include(g.Transform,{linearDepth:!1}),0===f.normalType&&f.offsetBackfaces&&u.include(m.Offset),u.include(z.ComputeNormalTexture,f),u.include(v.VertexNormal,f),f.instancedColor&&u.attributes.add("instanceColor","vec4"),u.varyings.add("localvpos","vec3"),u.include(b.TextureCoordinateAttribute,f),u.include(r.ForwardLinearDepth,f),u.include(a.SymbolColor,f),u.include(q.VertexColor,f),u.vertex.uniforms.add("externalColor",
"vec4"),u.varyings.add("vcolorExt","vec4"),fa.add(O.glsl(S||(S=e.__makeTemplateObject(["\n      void main(void) {\n        forwardNormalizedVertexColor();\n        vcolorExt \x3d externalColor;\n        ","\n        vcolorExt *\x3d vvColor();\n        vcolorExt *\x3d getSymbolColor();\n        forwardColorMixMode();\n\n        if (vcolorExt.a \x3c ",") {\n          gl_Position \x3d vec4(1e38, 1e38, 1e38, 1.0);\n        }\n        else {\n          vpos \x3d calculateVPos();\n          localvpos \x3d vpos - view[3].xyz;\n          vpos \x3d subtractOrigin(vpos);\n          ",
"\n          vpos \x3d addVerticalOffset(vpos, localOrigin);\n          ","\n          gl_Position \x3d transformPosition(proj, view, vpos);\n          ","\n        }\n        forwardLinearDepth();\n        forwardTextureCoordinates();\n      }\n    "],["\n      void main(void) {\n        forwardNormalizedVertexColor();\n        vcolorExt \x3d externalColor;\n        ","\n        vcolorExt *\x3d vvColor();\n        vcolorExt *\x3d getSymbolColor();\n        forwardColorMixMode();\n\n        if (vcolorExt.a \x3c ",
") {\n          gl_Position \x3d vec4(1e38, 1e38, 1e38, 1.0);\n        }\n        else {\n          vpos \x3d calculateVPos();\n          localvpos \x3d vpos - view[3].xyz;\n          vpos \x3d subtractOrigin(vpos);\n          ","\n          vpos \x3d addVerticalOffset(vpos, localOrigin);\n          ","\n          gl_Position \x3d transformPosition(proj, view, vpos);\n          ","\n        }\n        forwardLinearDepth();\n        forwardTextureCoordinates();\n      }\n    "])),f.instancedColor?
"vcolorExt *\x3d instanceColor;":"",O.glsl.float(M.symbolAlphaCutoff),0===f.normalType?O.glsl(Q||(Q=e.__makeTemplateObject(["\n          vNormalWorld \x3d dpNormal(vvLocalNormal(normalModel()));"],["\n          vNormalWorld \x3d dpNormal(vvLocalNormal(normalModel()));"]))):"",f.vertexTangets?"vTangent \x3d dpTransformVertexTangent(tangent);":"",0===f.normalType&&f.offsetBackfaces?"gl_Position \x3d offsetBackfacingClipPosition(gl_Position, vpos, vNormalWorld, camPos);":"")),u.include(d.Slice,f),u.include(E.EvaluateSceneLighting,
f),u.include(A.EvaluateAmbientOcclusion,f),u.include(M.DiscardOrAdjustAlpha,f),f.receiveShadows&&u.include(G.ReadShadowMap,f),u.fragment.uniforms.add("camPos","vec3").add("localOrigin","vec3").add("ambient","vec3").add("diffuse","vec3").add("opacity","float").add("layerOpacity","float"),f.hasColorTexture&&u.fragment.uniforms.add("tex","sampler2D"),u.include(B.PhysicallyBasedRenderingParameters,f),u.include(J.PhysicallyBasedRendering,f),u.include(T.MixExternalColor,{stages:1}),u.include(H.Normals,
f),ca.add(O.glsl(ma||(ma=e.__makeTemplateObject(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        shadingParams.viewDirection \x3d normalize(vpos - camPos);\n        ","\n        ","\n        float ssao \x3d evaluateAmbientOcclusionInverse();\n        ssao *\x3d getBakedOcclusion();\n\n        float additionalAmbientScale \x3d _oldHeuristicLighting(vpos + localOrigin);\n        vec3 additionalLight \x3d ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n        ",
"\n        vec3 matColor \x3d max(ambient, diffuse);\n        ","\n        ","\n        ","\n        ","\n        gl_FragColor \x3d highlightSlice(vec4(shadedColor, opacity_), vpos);\n      }\n    "],["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        shadingParams.viewDirection \x3d normalize(vpos - camPos);\n        ","\n        ","\n        float ssao \x3d evaluateAmbientOcclusionInverse();\n        ssao *\x3d getBakedOcclusion();\n\n        float additionalAmbientScale \x3d _oldHeuristicLighting(vpos + localOrigin);\n        vec3 additionalLight \x3d ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n        ",
"\n        vec3 matColor \x3d max(ambient, diffuse);\n        ","\n        ","\n        ","\n        ","\n        gl_FragColor \x3d highlightSlice(vec4(shadedColor, opacity_), vpos);\n      }\n    "])),f.hasColorTexture?O.glsl(aa||(aa=e.__makeTemplateObject(["\n        vec4 texColor \x3d texture2D(tex, vuv0);\n        ","\n        discardOrAdjustAlpha(texColor);"],["\n        vec4 texColor \x3d texture2D(tex, vuv0);\n        ","\n        discardOrAdjustAlpha(texColor);"])),f.textureAlphaPremultiplied?
"texColor.rgb /\x3d texColor.a;":""):O.glsl(ba||(ba=e.__makeTemplateObject(["vec4 texColor \x3d vec4(1.0);"],["vec4 texColor \x3d vec4(1.0);"]))),3===f.normalType?O.glsl(V||(V=e.__makeTemplateObject(["\n        vec3 normal \x3d screenDerivativeNormal(localvpos);"],["\n        vec3 normal \x3d screenDerivativeNormal(localvpos);"]))):O.glsl(Z||(Z=e.__makeTemplateObject(["\n        shadingParams.normalView \x3d vNormalWorld;\n        vec3 normal \x3d shadingNormal(shadingParams);"],["\n        shadingParams.normalView \x3d vNormalWorld;\n        vec3 normal \x3d shadingNormal(shadingParams);"]))),
1===f.pbrMode?"applyPBRFactors();":"",f.receiveShadows?"float shadow \x3d readShadowMap(vpos, linearDepth);":0===f.viewingMode?"float shadow \x3d lightingGlobalFactor * (1.0 - additionalAmbientScale);":"float shadow \x3d 0.0;",f.attributeColor?O.glsl(ha||(ha=e.__makeTemplateObject(["\n        vec3 albedo_ \x3d mixExternalColor(vColor.rgb * matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ \x3d layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));"],
["\n        vec3 albedo_ \x3d mixExternalColor(vColor.rgb * matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ \x3d layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));"]))):O.glsl(X||(X=e.__makeTemplateObject(["\n        vec3 albedo_ \x3d mixExternalColor(matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ \x3d layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        "],
["\n        vec3 albedo_ \x3d mixExternalColor(matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ \x3d layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        "]))),f.hasNormalTexture?O.glsl(ea||(ea=e.__makeTemplateObject(["\n              mat3 tangentSpace \x3d ","\n              vec3 shadedNormal \x3d computeTextureNormal(tangentSpace, vuv0);"],["\n              mat3 tangentSpace \x3d ","\n              vec3 shadedNormal \x3d computeTextureNormal(tangentSpace, vuv0);"])),
f.vertexTangets?"computeTangentSpace(normal);":"computeTangentSpace(normal, vpos, vuv0);"):"vec3 shadedNormal \x3d normal;",1===f.pbrMode||2===f.pbrMode?0===f.viewingMode?O.glsl(ga||(ga=e.__makeTemplateObject(["vec3 normalGround \x3d normalize(vpos + localOrigin);"],["vec3 normalGround \x3d normalize(vpos + localOrigin);"]))):O.glsl(oa||(oa=e.__makeTemplateObject(["vec3 normalGround \x3d vec3(0.0, 0.0, 1.0);"],["vec3 normalGround \x3d vec3(0.0, 0.0, 1.0);"]))):O.glsl(ja||(ja=e.__makeTemplateObject([""],
[""]))),1===f.pbrMode||2===f.pbrMode?O.glsl(da||(da=e.__makeTemplateObject(["\n            float additionalAmbientIrradiance \x3d additionalAmbientIrradianceFactor * lightingMainIntensity[2];\n            vec3 shadedColor \x3d evaluateSceneLightingPBR(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight, shadingParams.viewDirection, normalGround, mrr, emission, additionalAmbientIrradiance);"],["\n            float additionalAmbientIrradiance \x3d additionalAmbientIrradianceFactor * lightingMainIntensity[2];\n            vec3 shadedColor \x3d evaluateSceneLightingPBR(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight, shadingParams.viewDirection, normalGround, mrr, emission, additionalAmbientIrradiance);"]))):
"vec3 shadedColor \x3d evaluateSceneLighting(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight);")));u.include(x.DefaultMaterialAuxiliaryPasses,f);return u};var Q,S,aa,ba,V,Z,ha,X,ea,ga,oa,ja,da,ma})},"esri/views/3d/webgl-engine/core/shaderLibrary/Offset.glsl":function(){define(["require","exports","tslib","../shaderModules/interfaces"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.Offset=function(d){d.vertex.code.add(r.glsl(m||(m=e.__makeTemplateObject(["\n    vec4 offsetBackfacingClipPosition(vec4 posClip, vec3 posWorld, vec3 normalWorld, vec3 camPosWorld) {\n      vec3 camToVert \x3d posWorld - camPosWorld;\n\n      bool isBackface \x3d dot(camToVert, normalWorld) \x3e 0.0;\n      if (isBackface) {\n        posClip.z +\x3d 0.0000003 * posClip.w;\n      }\n      return posClip;\n    }\n  "],
["\n    vec4 offsetBackfacingClipPosition(vec4 posClip, vec3 posWorld, vec3 normalWorld, vec3 camPosWorld) {\n      vec3 camToVert \x3d posWorld - camPosWorld;\n\n      bool isBackface \x3d dot(camToVert, normalWorld) \x3e 0.0;\n      if (isBackface) {\n        posClip.z +\x3d 0.0000003 * posClip.w;\n      }\n      return posClip;\n    }\n  "]))))};var m})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/NormalAttribute.glsl":function(){define(["require","exports","tslib","../util/DecodeNormal.glsl",
"../../shaderModules/interfaces"],function(u,f,e,r,m){Object.defineProperty(f,"__esModule",{value:!0});f.NormalAttribute=function(f,c){0===c.normalType&&(f.attributes.add("normal","vec3"),f.vertex.code.add(m.glsl(d||(d=e.__makeTemplateObject(["\n      vec3 normalModel() {\n        return normal;\n      }\n    "],["\n      vec3 normalModel() {\n        return normal;\n      }\n    "])))));1===c.normalType&&(f.include(r.DecodeNormal),f.attributes.add("normalCompressed","vec2"),f.vertex.code.add(m.glsl(g||
(g=e.__makeTemplateObject(["\n      vec3 normalModel() {\n        return decodeNormal(normalCompressed);\n      }\n    "],["\n      vec3 normalModel() {\n        return decodeNormal(normalCompressed);\n      }\n    "])))));3===c.normalType&&(f.extensions.add("GL_OES_standard_derivatives"),f.fragment.code.add(m.glsl(k||(k=e.__makeTemplateObject(["\n      vec3 screenDerivativeNormal(vec3 positionView) {\n        return normalize(cross(dFdx(positionView), dFdy(positionView)));\n      }\n    "],["\n      vec3 screenDerivativeNormal(vec3 positionView) {\n        return normalize(cross(dFdx(positionView), dFdy(positionView)));\n      }\n    "])))))};
var d,g,k})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/DecodeNormal.glsl":function(){define(["require","exports","tslib","../../shaderModules/interfaces"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.DecodeNormal=function(d){var f=r.glsl(m||(m=e.__makeTemplateObject(["\n    vec3 decodeNormal(vec2 f) {\n      float z \x3d 1.0 - abs(f.x) - abs(f.y);\n      return vec3(f + sign(f) * min(z, 0.0), z);\n    }\n  "],["\n    vec3 decodeNormal(vec2 f) {\n      float z \x3d 1.0 - abs(f.x) - abs(f.y);\n      return vec3(f + sign(f) * min(z, 0.0), z);\n    }\n  "])));
d.fragment.code.add(f);d.vertex.code.add(f)};var m})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/PositionAttribute.glsl":function(){define(["require","exports","tslib","../../shaderModules/interfaces"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.PositionAttribute=function(d){d.attributes.add("position","vec3");d.vertex.code.add(r.glsl(m||(m=e.__makeTemplateObject(["\n    vec3 positionModel() { return position; }\n  "],["\n    vec3 positionModel() { return position; }\n  "]))))};
var m})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/SymbolColor.glsl":function(){define(["require","exports","tslib","../../../collections/Component/Material/shader/DecodeSymbolColor.glsl","../../shaderModules/interfaces"],function(u,f,e,r,m){Object.defineProperty(f,"__esModule",{value:!0});f.SymbolColor=function(f,l){l.symbolColor?(f.include(r.DecodeSymbolColor),f.attributes.add("symbolColor","vec4"),f.varyings.add("colorMixMode","mediump float")):f.fragment.uniforms.add("colorMixMode",
"int");l.symbolColor?f.vertex.code.add(m.glsl(d||(d=e.__makeTemplateObject(["\n    int symbolColorMixMode;\n\n    vec4 getSymbolColor() {\n      return decodeSymbolColor(symbolColor, symbolColorMixMode) * 0.003921568627451;\n    }\n\n    void forwardColorMixMode() {\n      colorMixMode \x3d float(symbolColorMixMode) + 0.5;\n    }\n  "],["\n    int symbolColorMixMode;\n\n    vec4 getSymbolColor() {\n      return decodeSymbolColor(symbolColor, symbolColorMixMode) * 0.003921568627451;\n    }\n\n    void forwardColorMixMode() {\n      colorMixMode \x3d float(symbolColorMixMode) + 0.5;\n    }\n  "])))):
f.vertex.code.add(m.glsl(g||(g=e.__makeTemplateObject(["\n    vec4 getSymbolColor() { return vec4(1.0); }\n    void forwardColorMixMode() {}\n    "],["\n    vec4 getSymbolColor() { return vec4(1.0); }\n    void forwardColorMixMode() {}\n    "]))))};var d,g})},"esri/views/3d/webgl-engine/collections/Component/Material/shader/DecodeSymbolColor.glsl":function(){define(["require","exports","tslib","../../../../core/shaderModules/interfaces"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});
f.DecodeSymbolColor=function(d){d.vertex.code.add(r.glsl(m||(m=e.__makeTemplateObject(["\n    vec4 decodeSymbolColor(vec4 symbolColor, out int colorMixMode) {\n      float symbolAlpha \x3d 0.0;\n\n      const float maxTint \x3d 85.0;\n      const float maxReplace \x3d 170.0;\n      const float scaleAlpha \x3d 3.0;\n\n      if (symbolColor.a \x3e maxReplace) {\n        colorMixMode \x3d ",";\n        symbolAlpha \x3d scaleAlpha * (symbolColor.a - maxReplace);\n      } else if (symbolColor.a \x3e maxTint) {\n        colorMixMode \x3d ",
";\n        symbolAlpha \x3d scaleAlpha * (symbolColor.a - maxTint);\n      } else if (symbolColor.a \x3e 0.0) {\n        colorMixMode \x3d ",";\n        symbolAlpha \x3d scaleAlpha * symbolColor.a;\n      } else {\n        colorMixMode \x3d ",";\n        symbolAlpha \x3d 0.0;\n      }\n\n      return vec4(symbolColor.r, symbolColor.g, symbolColor.b, symbolAlpha);\n    }\n  "],["\n    vec4 decodeSymbolColor(vec4 symbolColor, out int colorMixMode) {\n      float symbolAlpha \x3d 0.0;\n\n      const float maxTint \x3d 85.0;\n      const float maxReplace \x3d 170.0;\n      const float scaleAlpha \x3d 3.0;\n\n      if (symbolColor.a \x3e maxReplace) {\n        colorMixMode \x3d ",
";\n        symbolAlpha \x3d scaleAlpha * (symbolColor.a - maxReplace);\n      } else if (symbolColor.a \x3e maxTint) {\n        colorMixMode \x3d ",";\n        symbolAlpha \x3d scaleAlpha * (symbolColor.a - maxTint);\n      } else if (symbolColor.a \x3e 0.0) {\n        colorMixMode \x3d ",";\n        symbolAlpha \x3d scaleAlpha * symbolColor.a;\n      } else {\n        colorMixMode \x3d ",";\n        symbolAlpha \x3d 0.0;\n      }\n\n      return vec4(symbolColor.r, symbolColor.g, symbolColor.b, symbolAlpha);\n    }\n  "])),
r.glsl.int(1),r.glsl.int(3),r.glsl.int(4),r.glsl.int(1)))};var m})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/VertexColor.glsl":function(){define(["require","exports","tslib","../../shaderModules/interfaces"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.VertexColor=function(f,l){l.attributeColor?(f.attributes.add("color","vec4"),f.varyings.add("vColor","vec4"),f.vertex.code.add(r.glsl(m||(m=e.__makeTemplateObject(["\n      void forwardVertexColor() { vColor \x3d color; }\n    "],
["\n      void forwardVertexColor() { vColor \x3d color; }\n    "])))),f.vertex.code.add(r.glsl(d||(d=e.__makeTemplateObject(["\n      void forwardNormalizedVertexColor() { vColor \x3d color * 0.003921568627451; }\n    "],["\n      void forwardNormalizedVertexColor() { vColor \x3d color * 0.003921568627451; }\n    "]))))):f.vertex.code.add(r.glsl(g||(g=e.__makeTemplateObject(["\n      void forwardVertexColor() {}\n      void forwardNormalizedVertexColor() {}\n    "],["\n      void forwardVertexColor() {}\n      void forwardNormalizedVertexColor() {}\n    "]))))};
var m,d,g})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/VertexNormal.glsl":function(){define("require exports tslib ./NormalAttribute.glsl ./VertexPosition.glsl ../../shaderModules/interfaces".split(" "),function(u,f,e,r,m,d){function g(f,g){0===g.normalType||1===g.normalType?(f.include(r.NormalAttribute,g),f.varyings.add("vNormalWorld","vec3"),f.varyings.add("vNormalView","vec3"),f.vertex.uniforms.add("uTransformNormal_GlobalFromModel","mat3"),f.vertex.uniforms.add("uTransformNormal_ViewFromGlobal",
"mat3"),f.vertex.code.add(d.glsl(k||(k=e.__makeTemplateObject(["\n      void forwardNormal() {\n        vNormalWorld \x3d uTransformNormal_GlobalFromModel * normalModel();\n        vNormalView \x3d uTransformNormal_ViewFromGlobal * vNormalWorld;\n      }\n    "],["\n      void forwardNormal() {\n        vNormalWorld \x3d uTransformNormal_GlobalFromModel * normalModel();\n        vNormalView \x3d uTransformNormal_ViewFromGlobal * vNormalWorld;\n      }\n    "]))))):2===g.normalType?(f.include(m.VertexPosition,
g),f.varyings.add("vNormalWorld","vec3"),f.vertex.code.add(d.glsl(a||(a=e.__makeTemplateObject(["\n    void forwardNormal() {\n      vNormalWorld \x3d ","\n    }\n    "],["\n    void forwardNormal() {\n      vNormalWorld \x3d ","\n    }\n    "])),0===g.viewingMode?d.glsl(l||(l=e.__makeTemplateObject(["normalize(vPositionWorldCameraRelative);"],["normalize(vPositionWorldCameraRelative);"]))):d.glsl(c||(c=e.__makeTemplateObject(["vec3(0.0, 0.0, 1.0);"],["vec3(0.0, 0.0, 1.0);"])))))):f.vertex.code.add(d.glsl(b||
(b=e.__makeTemplateObject(["\n      void forwardNormal() {}\n    "],["\n      void forwardNormal() {}\n    "]))))}Object.defineProperty(f,"__esModule",{value:!0});f.VertexNormal=g;(function(a){a.bindUniforms=function(a,b){a.setUniformMatrix4fv("viewNormal",b.viewInvTransp)}})(g=f.VertexNormal||(f.VertexNormal={}));var k,l,c,a,b})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/VertexPosition.glsl":function(){define("require exports tslib ../../../../../../core/libs/gl-matrix-2/mat3f64 ../../../../../../core/libs/gl-matrix-2/mat4f64 ../../../../../../core/libs/gl-matrix-2/vec3f64 ./PositionAttribute.glsl ../util/DoublePrecision.glsl ../../shaderModules/interfaces".split(" "),
function(u,f,e,r,m,d,g,k,l){function c(c,d){c.include(g.PositionAttribute);c.include(k.DoublePrecision,d);c.varyings.add("vPositionWorldCameraRelative","vec3");c.varyings.add("vPosition_view","vec3");c.vertex.uniforms.add("uTransform_WorldFromModel_RS","mat3");c.vertex.uniforms.add("uTransform_WorldFromModel_TH","vec3");c.vertex.uniforms.add("uTransform_WorldFromModel_TL","vec3");c.vertex.uniforms.add("uTransform_WorldFromView_TH","vec3");c.vertex.uniforms.add("uTransform_WorldFromView_TL","vec3");
c.vertex.uniforms.add("uTransform_ViewFromCameraRelative_RS","mat3");c.vertex.uniforms.add("uTransform_ProjFromView","mat4");c.vertex.code.add(l.glsl(a||(a=e.__makeTemplateObject(["\n    // compute position in world space orientation, but relative to the camera position\n    vec3 positionWorldCameraRelative() {\n      vec3 rotatedModelPosition \x3d uTransform_WorldFromModel_RS * positionModel();\n\n      vec3 transform_CameraRelativeFromModel \x3d dpAdd(\n        uTransform_WorldFromModel_TL,\n        uTransform_WorldFromModel_TH,\n        -uTransform_WorldFromView_TL,\n        -uTransform_WorldFromView_TH\n      );\n\n      return transform_CameraRelativeFromModel + rotatedModelPosition;\n    }\n\n    // position in view space, that is relative to the camera position and orientation\n    vec3 position_view() {\n      return uTransform_ViewFromCameraRelative_RS * positionWorldCameraRelative();\n    }\n\n    // compute gl_Position and forward related varyings to fragment shader\n    void forwardPosition() {\n      vPositionWorldCameraRelative \x3d positionWorldCameraRelative();\n      vPosition_view \x3d position_view();\n      gl_Position \x3d uTransform_ProjFromView * vec4(vPosition_view, 1.0);\n    }\n\n    vec3 positionWorld() {\n      return uTransform_WorldFromView_TL + vPositionWorldCameraRelative;\n    }\n  "],
["\n    // compute position in world space orientation, but relative to the camera position\n    vec3 positionWorldCameraRelative() {\n      vec3 rotatedModelPosition \x3d uTransform_WorldFromModel_RS * positionModel();\n\n      vec3 transform_CameraRelativeFromModel \x3d dpAdd(\n        uTransform_WorldFromModel_TL,\n        uTransform_WorldFromModel_TH,\n        -uTransform_WorldFromView_TL,\n        -uTransform_WorldFromView_TH\n      );\n\n      return transform_CameraRelativeFromModel + rotatedModelPosition;\n    }\n\n    // position in view space, that is relative to the camera position and orientation\n    vec3 position_view() {\n      return uTransform_ViewFromCameraRelative_RS * positionWorldCameraRelative();\n    }\n\n    // compute gl_Position and forward related varyings to fragment shader\n    void forwardPosition() {\n      vPositionWorldCameraRelative \x3d positionWorldCameraRelative();\n      vPosition_view \x3d position_view();\n      gl_Position \x3d uTransform_ProjFromView * vec4(vPosition_view, 1.0);\n    }\n\n    vec3 positionWorld() {\n      return uTransform_WorldFromView_TL + vPositionWorldCameraRelative;\n    }\n  "]))));
c.fragment.uniforms.add("uTransform_WorldFromView_TL","vec3");c.fragment.code.add(l.glsl(b||(b=e.__makeTemplateObject(["\n    vec3 positionWorld() {\n      return uTransform_WorldFromView_TL + vPositionWorldCameraRelative;\n    }\n  "],["\n    vec3 positionWorld() {\n      return uTransform_WorldFromView_TL + vPositionWorldCameraRelative;\n    }\n  "]))))}Object.defineProperty(f,"__esModule",{value:!0});f.VertexPosition=c;(function(a){var b=function(){return function(){this.worldFromModel_RS=r.mat3f64.create();
this.worldFromModel_TH=d.vec3f64.create();this.worldFromModel_TL=d.vec3f64.create()}}();a.ModelTransform=b;b=function(){return function(){this.worldFromView_TH=d.vec3f64.create();this.worldFromView_TL=d.vec3f64.create();this.viewFromCameraRelative_RS=r.mat3f64.create();this.projFromView=m.mat4f64.create()}}();a.ViewProjectionTransform=b;a.bindModelTransform=function(a,b){a.setUniformMatrix3fv("uTransform_WorldFromModel_RS",b.worldFromModel_RS);a.setUniform3fv("uTransform_WorldFromModel_TH",b.worldFromModel_TH);
a.setUniform3fv("uTransform_WorldFromModel_TL",b.worldFromModel_TL)};a.bindViewProjTransform=function(a,b){a.setUniform3fv("uTransform_WorldFromView_TH",b.worldFromView_TH);a.setUniform3fv("uTransform_WorldFromView_TL",b.worldFromView_TL);a.setUniformMatrix4fv("uTransform_ProjFromView",b.projFromView);a.setUniformMatrix3fv("uTransform_ViewFromCameraRelative_RS",b.viewFromCameraRelative_RS)}})(c=f.VertexPosition||(f.VertexPosition={}));var a,b})},"esri/views/3d/webgl-engine/core/shaderLibrary/default/DefaultMaterialAuxiliaryPasses.glsl":function(){define("require exports tslib ../Slice.glsl ../Transform.glsl ../attributes/NormalAttribute.glsl ../attributes/TextureCoordinateAttribute.glsl ../attributes/VertexNormal.glsl ../output/OutputDepth.glsl ../output/OutputHighlight.glsl ../shading/VisualVariables.glsl ../util/AlphaDiscard.glsl ../../shaderModules/interfaces".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q){Object.defineProperty(f,"__esModule",{value:!0});f.DefaultMaterialAuxiliaryPasses=function(f,u){var R=f.vertex.code,L=f.fragment.code;if(1===u.output||3===u.output)f.include(m.Transform,{linearDepth:!0}),f.include(g.TextureCoordinateAttribute,u),f.include(a.VisualVariables,u),f.include(l.OutputDepth,u),f.include(r.Slice,u),f.vertex.uniforms.add("nearFar","vec2"),f.varyings.add("depth","float"),u.hasColorTexture&&f.fragment.uniforms.add("tex","sampler2D"),R.add(q.glsl(v||
(v=e.__makeTemplateObject(["\n      void main(void) {\n        vpos \x3d calculateVPos();\n        vpos \x3d subtractOrigin(vpos);\n        vpos \x3d addVerticalOffset(vpos, localOrigin);\n        gl_Position \x3d transformPositionWithDepth(proj, view, vpos, nearFar, depth);\n        forwardTextureCoordinates();\n      }\n    "],["\n      void main(void) {\n        vpos \x3d calculateVPos();\n        vpos \x3d subtractOrigin(vpos);\n        vpos \x3d addVerticalOffset(vpos, localOrigin);\n        gl_Position \x3d transformPositionWithDepth(proj, view, vpos, nearFar, depth);\n        forwardTextureCoordinates();\n      }\n    "])))),
f.include(b.DiscardOrAdjustAlpha,u),L.add(q.glsl(x||(x=e.__makeTemplateObject(["\n      void main(void) {\n        discardBySlice(vpos);\n        ","\n        outputDepth(depth);\n      }\n    "],["\n      void main(void) {\n        discardBySlice(vpos);\n        ","\n        outputDepth(depth);\n      }\n    "])),u.hasColorTexture?q.glsl(t||(t=e.__makeTemplateObject(["\n        vec4 texColor \x3d texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);"],["\n        vec4 texColor \x3d texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);"]))):
""));2===u.output&&(f.include(m.Transform,{linearDepth:!1}),f.include(d.NormalAttribute,u),f.include(k.VertexNormal,u),f.include(g.TextureCoordinateAttribute,u),f.include(a.VisualVariables,u),u.hasColorTexture&&f.fragment.uniforms.add("tex","sampler2D"),f.vertex.uniforms.add("viewNormal","mat4"),f.varyings.add("vPositionView","vec3"),R.add(q.glsl(A||(A=e.__makeTemplateObject(["\n      void main(void) {\n        vpos \x3d calculateVPos();\n        vpos \x3d subtractOrigin(vpos);\n        ","\n        vpos \x3d addVerticalOffset(vpos, localOrigin);\n        gl_Position \x3d transformPosition(proj, view, vpos);\n        forwardTextureCoordinates();\n      }\n    "],
["\n      void main(void) {\n        vpos \x3d calculateVPos();\n        vpos \x3d subtractOrigin(vpos);\n        ","\n        vpos \x3d addVerticalOffset(vpos, localOrigin);\n        gl_Position \x3d transformPosition(proj, view, vpos);\n        forwardTextureCoordinates();\n      }\n    "])),0===u.normalType?q.glsl(z||(z=e.__makeTemplateObject(["\n        vNormalWorld \x3d dpNormalView(vvLocalNormal(normalModel()));"],["\n        vNormalWorld \x3d dpNormalView(vvLocalNormal(normalModel()));"]))):
"")),f.include(r.Slice,u),f.include(b.DiscardOrAdjustAlpha,u),L.add(q.glsl(B||(B=e.__makeTemplateObject(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n\n        ","\n        gl_FragColor \x3d vec4(vec3(0.5) + 0.5 * normal, 1.0);\n      }\n    "],["\n      void main() {\n        discardBySlice(vpos);\n        ","\n\n        ","\n        gl_FragColor \x3d vec4(vec3(0.5) + 0.5 * normal, 1.0);\n      }\n    "])),u.hasColorTexture?q.glsl(E||(E=e.__makeTemplateObject(["\n        vec4 texColor \x3d texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);"],
["\n        vec4 texColor \x3d texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);"]))):"",3===u.normalType?q.glsl(H||(H=e.__makeTemplateObject(["\n            vec3 normal \x3d screenDerivativeNormal(vPositionView);"],["\n            vec3 normal \x3d screenDerivativeNormal(vPositionView);"]))):q.glsl(J||(J=e.__makeTemplateObject(["\n            vec3 normal \x3d normalize(vNormalWorld);\n            if (gl_FrontFacing \x3d\x3d false) normal \x3d -normal;"],["\n            vec3 normal \x3d normalize(vNormalWorld);\n            if (gl_FrontFacing \x3d\x3d false) normal \x3d -normal;"]))))));
4===u.output&&(f.include(m.Transform,{linearDepth:!1}),f.include(g.TextureCoordinateAttribute,u),f.include(a.VisualVariables,u),u.hasColorTexture&&f.fragment.uniforms.add("tex","sampler2D"),R.add(q.glsl(G||(G=e.__makeTemplateObject(["\n      void main(void) {\n        vpos \x3d calculateVPos();\n        vpos \x3d subtractOrigin(vpos);\n        vpos \x3d addVerticalOffset(vpos, localOrigin);\n        gl_Position \x3d transformPosition(proj, view, vpos);\n        forwardTextureCoordinates();\n      }\n    "],
["\n      void main(void) {\n        vpos \x3d calculateVPos();\n        vpos \x3d subtractOrigin(vpos);\n        vpos \x3d addVerticalOffset(vpos, localOrigin);\n        gl_Position \x3d transformPosition(proj, view, vpos);\n        forwardTextureCoordinates();\n      }\n    "])))),f.include(r.Slice,u),f.include(b.DiscardOrAdjustAlpha,u),f.include(c.OutputHighlight),L.add(q.glsl(M||(M=e.__makeTemplateObject(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        outputHighlight();\n      }\n    "],
["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        outputHighlight();\n      }\n    "])),u.hasColorTexture?q.glsl(F||(F=e.__makeTemplateObject(["\n        vec4 texColor \x3d texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);"],["\n        vec4 texColor \x3d texture2D(tex, vuv0);\n        discardOrAdjustAlpha(texColor);"]))):"")))};var v,t,x,z,A,E,H,J,B,G,F,M})},"esri/views/3d/webgl-engine/core/shaderLibrary/output/OutputDepth.glsl":function(){define(["require",
"exports","tslib","../util/RgbaFloatEncoding.glsl","../../shaderModules/interfaces"],function(u,f,e,r,m){Object.defineProperty(f,"__esModule",{value:!0});f.OutputDepth=function(f,l){f.include(r.RgbaFloatEncoding);3===l.output?(f.extensions.add("GL_OES_standard_derivatives"),f.fragment.code.add(m.glsl(d||(d=e.__makeTemplateObject(["\n      float _calculateFragDepth(const in float depth) {\n        // calc polygon offset\n        const float SLOPE_SCALE \x3d 2.0;\n        const float BIAS \x3d 2.0 * .000015259;    // 1 / (2^16 - 1)\n        float m \x3d max(abs(dFdx(depth)), abs(dFdy(depth)));\n        float result \x3d depth + SLOPE_SCALE * m + BIAS;\n        return clamp(result, .0, .999999);\n      }\n\n      void outputDepth(float _linearDepth) {\n        gl_FragColor \x3d float2rgba(_calculateFragDepth(_linearDepth));\n      }\n    "],
["\n      float _calculateFragDepth(const in float depth) {\n        // calc polygon offset\n        const float SLOPE_SCALE \x3d 2.0;\n        const float BIAS \x3d 2.0 * .000015259;    // 1 / (2^16 - 1)\n        float m \x3d max(abs(dFdx(depth)), abs(dFdy(depth)));\n        float result \x3d depth + SLOPE_SCALE * m + BIAS;\n        return clamp(result, .0, .999999);\n      }\n\n      void outputDepth(float _linearDepth) {\n        gl_FragColor \x3d float2rgba(_calculateFragDepth(_linearDepth));\n      }\n    "]))))):
1===l.output&&f.fragment.code.add(m.glsl(g||(g=e.__makeTemplateObject(["\n      void outputDepth(float _linearDepth) {\n        gl_FragColor \x3d float2rgba(_linearDepth);\n      }\n    "],["\n      void outputDepth(float _linearDepth) {\n        gl_FragColor \x3d float2rgba(_linearDepth);\n      }\n    "]))))};var d,g})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/ComputeNormalTexture.glsl":function(){define(["require","exports","tslib","../attributes/VertexTextureCoordinates.glsl","../../shaderModules/interfaces"],
function(u,f,e,r,m){Object.defineProperty(f,"__esModule",{value:!0});f.ComputeNormalTexture=function(c,a){var b=c.fragment;b.uniforms.add("normalTexture","sampler2D");b.uniforms.add("normalTextureSize","vec2");a.vertexTangets?(c.attributes.add("tangent","vec4"),c.varyings.add("vTangent","vec4"),2===a.doubleSidedMode?b.code.add(m.glsl(d||(d=e.__makeTemplateObject(["\n      mat3 computeTangentSpace(vec3 normal) {\n        float tangentHeadedness \x3d gl_FrontFacing ? vTangent.w : -vTangent.w;\n        vec3 tangent \x3d normalize(gl_FrontFacing ? vTangent.xyz : -vTangent.xyz);\n        vec3 bitangent \x3d cross(normal, tangent) * tangentHeadedness;\n        return mat3(tangent, bitangent, normal);\n      }\n    "],
["\n      mat3 computeTangentSpace(vec3 normal) {\n        float tangentHeadedness \x3d gl_FrontFacing ? vTangent.w : -vTangent.w;\n        vec3 tangent \x3d normalize(gl_FrontFacing ? vTangent.xyz : -vTangent.xyz);\n        vec3 bitangent \x3d cross(normal, tangent) * tangentHeadedness;\n        return mat3(tangent, bitangent, normal);\n      }\n    "])))):b.code.add(m.glsl(g||(g=e.__makeTemplateObject(["\n      mat3 computeTangentSpace(vec3 normal) {\n        float tangentHeadedness \x3d vTangent.w;\n        vec3 tangent \x3d normalize(vTangent.xyz);\n        vec3 bitangent \x3d cross(normal, tangent) * tangentHeadedness;\n        return mat3(tangent, bitangent, normal);\n      }\n    "],
["\n      mat3 computeTangentSpace(vec3 normal) {\n        float tangentHeadedness \x3d vTangent.w;\n        vec3 tangent \x3d normalize(vTangent.xyz);\n        vec3 bitangent \x3d cross(normal, tangent) * tangentHeadedness;\n        return mat3(tangent, bitangent, normal);\n      }\n    "]))))):(c.extensions.add("GL_OES_standard_derivatives"),b.code.add(m.glsl(k||(k=e.__makeTemplateObject(['\n    mat3 computeTangentSpace(vec3 normal, vec3 pos, vec2 st) {\n\n      vec3 Q1 \x3d dFdx(pos);\n      vec3 Q2 \x3d dFdy(pos);\n\n      vec2 stx \x3d dFdx(st);\n      vec2 sty \x3d dFdy(st);\n\n      float det \x3d stx.t * sty.s - sty.t * stx.s;\n\n      vec3 T \x3d stx.t * Q2 - sty.t * Q1; // compute tangent\n      T \x3d T - normal * dot(normal, T); // orthogonalize tangent\n      T *\x3d inversesqrt(max(dot(T,T), 1.e-10)); // "soft" normalize - goes to 0 when T goes to 0\n      vec3 B \x3d sign(det) * cross(normal, T); // assume normal is normalized, B has the same lenght as B\n      return mat3(T, B, normal); // T and B go to 0 when the tangent space is not well defined by the uv coordinates\n    }\n  '],
['\n    mat3 computeTangentSpace(vec3 normal, vec3 pos, vec2 st) {\n\n      vec3 Q1 \x3d dFdx(pos);\n      vec3 Q2 \x3d dFdy(pos);\n\n      vec2 stx \x3d dFdx(st);\n      vec2 sty \x3d dFdy(st);\n\n      float det \x3d stx.t * sty.s - sty.t * stx.s;\n\n      vec3 T \x3d stx.t * Q2 - sty.t * Q1; // compute tangent\n      T \x3d T - normal * dot(normal, T); // orthogonalize tangent\n      T *\x3d inversesqrt(max(dot(T,T), 1.e-10)); // "soft" normalize - goes to 0 when T goes to 0\n      vec3 B \x3d sign(det) * cross(normal, T); // assume normal is normalized, B has the same lenght as B\n      return mat3(T, B, normal); // T and B go to 0 when the tangent space is not well defined by the uv coordinates\n    }\n  '])))));
0!==a.attributeTextureCoordinates&&(c.include(r.VertexTextureCoordinates,a),b.code.add(m.glsl(l||(l=e.__makeTemplateObject(["\n    vec3 computeTextureNormal(mat3 tangentSpace, vec2 uv) {\n      vtc.uv \x3d uv;\n      ","\n      vec3 rawNormal \x3d textureLookup(normalTexture, vtc).rgb * 2.0 - 1.0;\n      return tangentSpace * rawNormal;\n    }\n  "],["\n    vec3 computeTextureNormal(mat3 tangentSpace, vec2 uv) {\n      vtc.uv \x3d uv;\n      ","\n      vec3 rawNormal \x3d textureLookup(normalTexture, vtc).rgb * 2.0 - 1.0;\n      return tangentSpace * rawNormal;\n    }\n  "])),
a.supportsTextureAtlas?"vtc.size \x3d normalTextureSize;":"")))};var d,g,k,l})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateAmbientOcclusion.glsl":function(){define(["require","exports","tslib","../../shaderModules/interfaces"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.EvaluateAmbientOcclusion=function(f,k){f=f.fragment;k.receiveAmbientOcclusion?(f.uniforms.add("ssaoTex","sampler2D"),f.uniforms.add("viewportPixelSz","vec4"),f.code.add(r.glsl(m||(m=e.__makeTemplateObject(["\n      float evaluateAmbientOcclusion() {\n        return 1.0 - texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\n      }\n\n      float evaluateAmbientOcclusionInverse() {\n        float ssao \x3d texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\n        return viewportPixelSz.z \x3c 0.0 ? 1.0 : ssao;\n      }\n    "],
["\n      float evaluateAmbientOcclusion() {\n        return 1.0 - texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\n      }\n\n      float evaluateAmbientOcclusionInverse() {\n        float ssao \x3d texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\n        return viewportPixelSz.z \x3c 0.0 ? 1.0 : ssao;\n      }\n    "]))))):f.code.add(r.glsl(d||(d=e.__makeTemplateObject(["\n      float evaluateAmbientOcclusion() { return 0.0; } // no occlusion\n      float evaluateAmbientOcclusionInverse() { return 1.0; }\n    "],
["\n      float evaluateAmbientOcclusion() { return 0.0; } // no occlusion\n      float evaluateAmbientOcclusionInverse() { return 1.0; }\n    "]))))};var m,d})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateSceneLighting.glsl":function(){define("require exports tslib ./EvaluateAmbientLighting.glsl ./EvaluateAmbientOcclusion.glsl ./EvaluateMainLighting.glsl ./PhysicallyBasedRendering.glsl ./PiUtils.glsl ./ReadShadowMap.glsl ../../shaderModules/interfaces".split(" "),function(u,f,
e,r,m,d,g,k,l,c){Object.defineProperty(f,"__esModule",{value:!0});f.EvaluateSceneLighting=function(f,u){var F=f.fragment;f.include(d.EvaluateMainLighting);f.include(m.EvaluateAmbientOcclusion,u);0!==u.pbrMode&&f.include(g.PhysicallyBasedRendering,u);f.include(r.EvaluateAmbientLighting,u);u.receiveShadows&&f.include(l.ReadShadowMap,u);F.uniforms.add("lightingGlobalFactor","float");F.uniforms.add("ambientBoostFactor","float");f.include(k.PiUtils);F.code.add(c.glsl(a||(a=e.__makeTemplateObject(["\n    const float GAMMA_SRGB \x3d 2.1;\n    const float INV_GAMMA_SRGB \x3d 0.4761904;\n    ",
"\n  "],["\n    const float GAMMA_SRGB \x3d 2.1;\n    const float INV_GAMMA_SRGB \x3d 0.4761904;\n    ","\n  "])),0===u.pbrMode?"":"const vec3 GROUND_REFLECTANCE \x3d vec3(0.2);"));if(u.useOldSceneLightInterface)F.code.add(c.glsl(b||(b=e.__makeTemplateObject(["\n    vec3 evaluateSceneLightingExt(vec3 normal, vec3 albedo, float shadow, float ssao, vec3 additionalLight) {\n      // evaluate the main light\n      #if defined(TREE_RENDERING)\n        // Special case for tree rendering:\n        // We shift the Lambert lobe to the back, allowing it to reach part of the hemisphere\n        // facing away from the light. The idea is to get an effect where light is transmitted\n        // through the tree.\n        float minDot \x3d -0.5;\n        float dotRange \x3d 1.0 - minDot;\n        float dotNormalization \x3d 0.66; // guessed \x26 hand tweaked value, for an exact value we could precompute an integral over the sphere\n\n        float dotVal \x3d dotNormalization * (clamp(-dot(normal, lightingMainDirection), 1.0 - dotRange, 1.0) - minDot) * (1.0 / dotRange);\n      #else\n        float dotVal \x3d clamp(-dot(normal, lightingMainDirection), 0.0, 1.0);\n      #endif\n\n      // move lighting towards (1.0, 1.0, 1.0) if requested\n      dotVal \x3d mix(dotVal, 1.0, lightingFixedFactor);\n\n      vec3 mainLight \x3d (1.0 - shadow) * lightingMainIntensity * dotVal;\n      vec3 ambientLight \x3d calculateAmbientIrradiance(normal, ssao);\n\n      // inverse gamma correction on the albedo color\n      vec3 albedoGammaC \x3d pow(albedo, vec3(GAMMA_SRGB));\n\n      // physically correct BRDF normalizes by PI\n      vec3 totalLight \x3d mainLight + ambientLight + additionalLight;\n      totalLight \x3d min(totalLight, vec3(PI));\n      vec3 outColor \x3d vec3((albedoGammaC / PI) * (totalLight));\n\n      // apply gamma correction to the computed color\n      outColor \x3d pow(outColor, vec3(INV_GAMMA_SRGB));\n\n      return outColor;\n    }\n  "],
["\n    vec3 evaluateSceneLightingExt(vec3 normal, vec3 albedo, float shadow, float ssao, vec3 additionalLight) {\n      // evaluate the main light\n      #if defined(TREE_RENDERING)\n        // Special case for tree rendering:\n        // We shift the Lambert lobe to the back, allowing it to reach part of the hemisphere\n        // facing away from the light. The idea is to get an effect where light is transmitted\n        // through the tree.\n        float minDot \x3d -0.5;\n        float dotRange \x3d 1.0 - minDot;\n        float dotNormalization \x3d 0.66; // guessed \x26 hand tweaked value, for an exact value we could precompute an integral over the sphere\n\n        float dotVal \x3d dotNormalization * (clamp(-dot(normal, lightingMainDirection), 1.0 - dotRange, 1.0) - minDot) * (1.0 / dotRange);\n      #else\n        float dotVal \x3d clamp(-dot(normal, lightingMainDirection), 0.0, 1.0);\n      #endif\n\n      // move lighting towards (1.0, 1.0, 1.0) if requested\n      dotVal \x3d mix(dotVal, 1.0, lightingFixedFactor);\n\n      vec3 mainLight \x3d (1.0 - shadow) * lightingMainIntensity * dotVal;\n      vec3 ambientLight \x3d calculateAmbientIrradiance(normal, ssao);\n\n      // inverse gamma correction on the albedo color\n      vec3 albedoGammaC \x3d pow(albedo, vec3(GAMMA_SRGB));\n\n      // physically correct BRDF normalizes by PI\n      vec3 totalLight \x3d mainLight + ambientLight + additionalLight;\n      totalLight \x3d min(totalLight, vec3(PI));\n      vec3 outColor \x3d vec3((albedoGammaC / PI) * (totalLight));\n\n      // apply gamma correction to the computed color\n      outColor \x3d pow(outColor, vec3(INV_GAMMA_SRGB));\n\n      return outColor;\n    }\n  "]))));
else if(0===u.viewingMode?F.code.add(c.glsl(q||(q=e.__makeTemplateObject(["\n      float _oldHeuristicLighting(vec3 vPosWorld) {\n        vec3 shadingNormalWorld \x3d normalize(vPosWorld);\n        float vndl \x3d -dot(shadingNormalWorld, lightingMainDirection);\n\n        return smoothstep(0.0, 1.0, clamp(vndl * 2.5, 0.0, 1.0));\n      }\n    "],["\n      float _oldHeuristicLighting(vec3 vPosWorld) {\n        vec3 shadingNormalWorld \x3d normalize(vPosWorld);\n        float vndl \x3d -dot(shadingNormalWorld, lightingMainDirection);\n\n        return smoothstep(0.0, 1.0, clamp(vndl * 2.5, 0.0, 1.0));\n      }\n    "])))):
F.code.add(c.glsl(v||(v=e.__makeTemplateObject(["\n      float _oldHeuristicLighting(vec3 vPosWorld) {\n        float vndl \x3d -dot(vec3(0.0, 0.0, 1.0), lightingMainDirection);\n        return smoothstep(0.0, 1.0, clamp(vndl * 2.5, 0.0, 1.0));\n      }\n    "],["\n      float _oldHeuristicLighting(vec3 vPosWorld) {\n        float vndl \x3d -dot(vec3(0.0, 0.0, 1.0), lightingMainDirection);\n        return smoothstep(0.0, 1.0, clamp(vndl * 2.5, 0.0, 1.0));\n      }\n    "])))),F.code.add(c.glsl(t||
(t=e.__makeTemplateObject(["\n      vec3 evaluateAdditionalLighting(float ambientOcclusion, vec3 vPosWorld) {\n        float additionalAmbientScale \x3d _oldHeuristicLighting(vPosWorld);\n        return (1.0 - ambientOcclusion) * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor * lightingMainIntensity;\n      }\n    "],["\n      vec3 evaluateAdditionalLighting(float ambientOcclusion, vec3 vPosWorld) {\n        float additionalAmbientScale \x3d _oldHeuristicLighting(vPosWorld);\n        return (1.0 - ambientOcclusion) * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor * lightingMainIntensity;\n      }\n    "])))),
0===u.pbrMode||4===u.pbrMode)F.code.add(c.glsl(x||(x=e.__makeTemplateObject(["\n      vec3 evaluateSceneLighting(vec3 normalWorld, vec3 baseColor, float mainLightShadow, float ambientOcclusion, vec3 additionalLight)\n      {\n        vec3 mainLighting \x3d evaluateMainLighting(normalWorld, mainLightShadow);\n        vec3 ambientLighting \x3d calculateAmbientIrradiance(normalWorld, ambientOcclusion);\n        // inverse gamma correction on the base color\n        vec3 baseColorLinear \x3d pow(baseColor, vec3(GAMMA_SRGB));\n\n        // physically correct BRDF normalizes by PI\n        vec3 totalLight \x3d mainLighting + ambientLighting + additionalLight;\n        totalLight \x3d min(totalLight, vec3(PI));\n        vec3 outColor \x3d vec3((baseColorLinear / PI) * totalLight);\n\n        // apply gamma correction to the computed color\n        outColor \x3d pow(outColor, vec3(INV_GAMMA_SRGB));\n\n        return outColor;\n      }\n      "],
["\n      vec3 evaluateSceneLighting(vec3 normalWorld, vec3 baseColor, float mainLightShadow, float ambientOcclusion, vec3 additionalLight)\n      {\n        vec3 mainLighting \x3d evaluateMainLighting(normalWorld, mainLightShadow);\n        vec3 ambientLighting \x3d calculateAmbientIrradiance(normalWorld, ambientOcclusion);\n        // inverse gamma correction on the base color\n        vec3 baseColorLinear \x3d pow(baseColor, vec3(GAMMA_SRGB));\n\n        // physically correct BRDF normalizes by PI\n        vec3 totalLight \x3d mainLighting + ambientLighting + additionalLight;\n        totalLight \x3d min(totalLight, vec3(PI));\n        vec3 outColor \x3d vec3((baseColorLinear / PI) * totalLight);\n\n        // apply gamma correction to the computed color\n        outColor \x3d pow(outColor, vec3(INV_GAMMA_SRGB));\n\n        return outColor;\n      }\n      "]))));
else if(1===u.pbrMode||2===u.pbrMode)F.code.add(c.glsl(z||(z=e.__makeTemplateObject(["\n      const float fillLightIntensity \x3d 0.25;\n      const float horizonLightDiffusion \x3d 0.4;\n      const float additionalAmbientIrradianceFactor \x3d 0.02;\n\n      vec3 evaluateSceneLightingPBR(vec3 normal, vec3 albedo, float shadow, float ssao, vec3 additionalLight, vec3 viewDir, vec3 normalGround, vec3 mrr, vec3 _emission, float additionalAmbientIrradiance)\n      {\n        // Calculate half vector between view and light direction\n        vec3 viewDirection \x3d -viewDir;\n        vec3 mainLightDirection \x3d -lightingMainDirection;\n        vec3 h \x3d normalize(viewDirection + mainLightDirection);\n\n        PBRShadingInfo inputs;\n        inputs.NdotL \x3d clamp(dot(normal, mainLightDirection), 0.001, 1.0);\n        inputs.NdotV \x3d clamp(abs(dot(normal, viewDirection)), 0.001, 1.0);\n        inputs.NdotH \x3d clamp(dot(normal, h), 0.0, 1.0);\n        inputs.VdotH \x3d clamp(dot(viewDirection, h), 0.0, 1.0);\n        inputs.NdotNG \x3d clamp(dot(normal, normalGround), -1.0, 1.0);\n        vec3 reflectedView \x3d normalize(reflect(viewDirection, normal));\n        inputs.RdotNG \x3d clamp(dot(reflectedView, normalGround), -1.0, 1.0);\n\n        inputs.albedoLinear \x3d pow(albedo, vec3(GAMMA_SRGB));\n        inputs.ssao \x3d ssao;\n\n        inputs.metalness \x3d mrr[0];\n        inputs.roughness \x3d clamp(mrr[1] * mrr[1], 0.001, 0.99);\n      "],
["\n      const float fillLightIntensity \x3d 0.25;\n      const float horizonLightDiffusion \x3d 0.4;\n      const float additionalAmbientIrradianceFactor \x3d 0.02;\n\n      vec3 evaluateSceneLightingPBR(vec3 normal, vec3 albedo, float shadow, float ssao, vec3 additionalLight, vec3 viewDir, vec3 normalGround, vec3 mrr, vec3 _emission, float additionalAmbientIrradiance)\n      {\n        // Calculate half vector between view and light direction\n        vec3 viewDirection \x3d -viewDir;\n        vec3 mainLightDirection \x3d -lightingMainDirection;\n        vec3 h \x3d normalize(viewDirection + mainLightDirection);\n\n        PBRShadingInfo inputs;\n        inputs.NdotL \x3d clamp(dot(normal, mainLightDirection), 0.001, 1.0);\n        inputs.NdotV \x3d clamp(abs(dot(normal, viewDirection)), 0.001, 1.0);\n        inputs.NdotH \x3d clamp(dot(normal, h), 0.0, 1.0);\n        inputs.VdotH \x3d clamp(dot(viewDirection, h), 0.0, 1.0);\n        inputs.NdotNG \x3d clamp(dot(normal, normalGround), -1.0, 1.0);\n        vec3 reflectedView \x3d normalize(reflect(viewDirection, normal));\n        inputs.RdotNG \x3d clamp(dot(reflectedView, normalGround), -1.0, 1.0);\n\n        inputs.albedoLinear \x3d pow(albedo, vec3(GAMMA_SRGB));\n        inputs.ssao \x3d ssao;\n\n        inputs.metalness \x3d mrr[0];\n        inputs.roughness \x3d clamp(mrr[1] * mrr[1], 0.001, 0.99);\n      "])))),
F.code.add(c.glsl(A||(A=e.__makeTemplateObject(["\n        inputs.f0 \x3d (0.16 * mrr[2] * mrr[2]) * (1.0 - inputs.metalness) + inputs.albedoLinear * inputs.metalness;\n        inputs.f90 \x3d vec3(clamp(dot(inputs.f0, vec3(50.0 * 0.33)), 0.0, 1.0)); // more accurate then using  f90 \x3d 1.0\n        inputs.diffuseColor \x3d inputs.albedoLinear * (vec3(1.0) - inputs.f0) * (1.0 - inputs.metalness);\n      "],["\n        inputs.f0 \x3d (0.16 * mrr[2] * mrr[2]) * (1.0 - inputs.metalness) + inputs.albedoLinear * inputs.metalness;\n        inputs.f90 \x3d vec3(clamp(dot(inputs.f0, vec3(50.0 * 0.33)), 0.0, 1.0)); // more accurate then using  f90 \x3d 1.0\n        inputs.diffuseColor \x3d inputs.albedoLinear * (vec3(1.0) - inputs.f0) * (1.0 - inputs.metalness);\n      "])))),
F.code.add(c.glsl(E||(E=e.__makeTemplateObject(["\n        vec3 ambientDir \x3d vec3(5.0 * normalGround[1] - normalGround[0] * normalGround[2], - 5.0 * normalGround[0] - normalGround[2] * normalGround[1], normalGround[1] * normalGround[1] + normalGround[0] * normalGround[0]);\n        ambientDir \x3d ambientDir !\x3d vec3(0.0)? normalize(ambientDir) : normalize(vec3(5.0, -1.0, 0.0));\n\n        inputs.NdotAmbDir \x3d abs(dot(normal, ambientDir));\n\n        // Calculate the irradiance components: sun, fill lights and the sky.\n        vec3 mainLightIrradianceComponent  \x3d inputs.NdotL * (1.0 - shadow) * lightingMainIntensity;\n        vec3 fillLightsIrradianceComponent \x3d inputs.NdotAmbDir * lightingMainIntensity * fillLightIntensity;\n        // calculateAmbientIrradiance for localView and additionalLight for gloabalView\n        vec3 ambientLightIrradianceComponent \x3d calculateAmbientIrradiance(normal, ssao) + additionalLight;\n\n        // Assemble the overall irradiance of the sky that illuminates the surface\n        inputs.skyIrradianceToSurface    \x3d ambientLightIrradianceComponent + mainLightIrradianceComponent + fillLightsIrradianceComponent ;\n        // Assemble the overall irradiance of the ground that illuminates the surface. for this we use the simple model that changes only the sky irradiance by the groundReflectance\n        inputs.groundIrradianceToSurface \x3d GROUND_REFLECTANCE * ambientLightIrradianceComponent + mainLightIrradianceComponent + fillLightsIrradianceComponent ;\n      "],
["\n        vec3 ambientDir \x3d vec3(5.0 * normalGround[1] - normalGround[0] * normalGround[2], - 5.0 * normalGround[0] - normalGround[2] * normalGround[1], normalGround[1] * normalGround[1] + normalGround[0] * normalGround[0]);\n        ambientDir \x3d ambientDir !\x3d vec3(0.0)? normalize(ambientDir) : normalize(vec3(5.0, -1.0, 0.0));\n\n        inputs.NdotAmbDir \x3d abs(dot(normal, ambientDir));\n\n        // Calculate the irradiance components: sun, fill lights and the sky.\n        vec3 mainLightIrradianceComponent  \x3d inputs.NdotL * (1.0 - shadow) * lightingMainIntensity;\n        vec3 fillLightsIrradianceComponent \x3d inputs.NdotAmbDir * lightingMainIntensity * fillLightIntensity;\n        // calculateAmbientIrradiance for localView and additionalLight for gloabalView\n        vec3 ambientLightIrradianceComponent \x3d calculateAmbientIrradiance(normal, ssao) + additionalLight;\n\n        // Assemble the overall irradiance of the sky that illuminates the surface\n        inputs.skyIrradianceToSurface    \x3d ambientLightIrradianceComponent + mainLightIrradianceComponent + fillLightsIrradianceComponent ;\n        // Assemble the overall irradiance of the ground that illuminates the surface. for this we use the simple model that changes only the sky irradiance by the groundReflectance\n        inputs.groundIrradianceToSurface \x3d GROUND_REFLECTANCE * ambientLightIrradianceComponent + mainLightIrradianceComponent + fillLightsIrradianceComponent ;\n      "])))),
F.code.add(c.glsl(H||(H=e.__makeTemplateObject(["\n        vec3 horizonRingDir \x3d inputs.RdotNG * normalGround - reflectedView;\n        vec3 horizonRingH \x3d normalize(viewDirection + horizonRingDir);\n        inputs.NdotH_Horizon \x3d dot(normal, horizonRingH);\n\n        vec3 mainLightRadianceComponent  \x3d normalDistribution(inputs.NdotH, inputs.roughness) * lightingMainIntensity * (1.0 - shadow);\n        vec3 horizonLightRadianceComponent \x3d normalDistribution(inputs.NdotH_Horizon, min(inputs.roughness + horizonLightDiffusion, 1.0)) * lightingMainIntensity * fillLightIntensity;\n        vec3 ambientLightRadianceComponent \x3d calculateAmbientRadiance(ssao) + additionalLight; // calculateAmbientRadiance for localView and additionalLight for gloabalView\n\n        // Assemble the overall radiance of the sky that illuminates the surface\n        inputs.skyRadianceToSurface    \x3d  ambientLightRadianceComponent + mainLightRadianceComponent + horizonLightRadianceComponent;\n        // Assemble the overall radiance of the ground that illuminates the surface. for this we use the simple model that changes only the sky radince by the groundReflectance\n        inputs.groundRadianceToSurface \x3d GROUND_REFLECTANCE * (ambientLightRadianceComponent + horizonLightRadianceComponent) + mainLightRadianceComponent;\n\n        // Calculate average ambient radiance - this is used int the gamut mapping part to deduce the black level that is soft compressed\n        inputs.averageAmbientRadiance \x3d ambientLightIrradianceComponent[1] * (1.0 + GROUND_REFLECTANCE[1]);\n        "],
["\n        vec3 horizonRingDir \x3d inputs.RdotNG * normalGround - reflectedView;\n        vec3 horizonRingH \x3d normalize(viewDirection + horizonRingDir);\n        inputs.NdotH_Horizon \x3d dot(normal, horizonRingH);\n\n        vec3 mainLightRadianceComponent  \x3d normalDistribution(inputs.NdotH, inputs.roughness) * lightingMainIntensity * (1.0 - shadow);\n        vec3 horizonLightRadianceComponent \x3d normalDistribution(inputs.NdotH_Horizon, min(inputs.roughness + horizonLightDiffusion, 1.0)) * lightingMainIntensity * fillLightIntensity;\n        vec3 ambientLightRadianceComponent \x3d calculateAmbientRadiance(ssao) + additionalLight; // calculateAmbientRadiance for localView and additionalLight for gloabalView\n\n        // Assemble the overall radiance of the sky that illuminates the surface\n        inputs.skyRadianceToSurface    \x3d  ambientLightRadianceComponent + mainLightRadianceComponent + horizonLightRadianceComponent;\n        // Assemble the overall radiance of the ground that illuminates the surface. for this we use the simple model that changes only the sky radince by the groundReflectance\n        inputs.groundRadianceToSurface \x3d GROUND_REFLECTANCE * (ambientLightRadianceComponent + horizonLightRadianceComponent) + mainLightRadianceComponent;\n\n        // Calculate average ambient radiance - this is used int the gamut mapping part to deduce the black level that is soft compressed\n        inputs.averageAmbientRadiance \x3d ambientLightIrradianceComponent[1] * (1.0 + GROUND_REFLECTANCE[1]);\n        "])))),
F.code.add(c.glsl(G||(G=e.__makeTemplateObject(["\n        vec3 reflectedColorComponent \x3d evaluateEnvironmentIllumination(inputs);\n        vec3 additionalMaterialReflectanceComponent \x3d inputs.albedoLinear * additionalAmbientIrradiance;\n        vec3 emissionComponent \x3d pow(_emission, vec3(GAMMA_SRGB));\n        vec3 outColorLinear \x3d reflectedColorComponent + additionalMaterialReflectanceComponent + emissionComponent;\n        ","\n        return outColor;\n      }\n    "],["\n        vec3 reflectedColorComponent \x3d evaluateEnvironmentIllumination(inputs);\n        vec3 additionalMaterialReflectanceComponent \x3d inputs.albedoLinear * additionalAmbientIrradiance;\n        vec3 emissionComponent \x3d pow(_emission, vec3(GAMMA_SRGB));\n        vec3 outColorLinear \x3d reflectedColorComponent + additionalMaterialReflectanceComponent + emissionComponent;\n        ",
"\n        return outColor;\n      }\n    "])),2===u.pbrMode?c.glsl(J||(J=e.__makeTemplateObject(["vec3 outColor \x3d pow(outColorLinear - 0.005 * inputs.averageAmbientRadiance, vec3(INV_GAMMA_SRGB));"],["vec3 outColor \x3d pow(outColorLinear - 0.005 * inputs.averageAmbientRadiance, vec3(INV_GAMMA_SRGB));"]))):c.glsl(B||(B=e.__makeTemplateObject(["vec3 outColor \x3d pow(blackLevelSoftCompression(outColorLinear, inputs), vec3(INV_GAMMA_SRGB));"],["vec3 outColor \x3d pow(blackLevelSoftCompression(outColorLinear, inputs), vec3(INV_GAMMA_SRGB));"])))))};
var a,b,q,v,t,x,z,A,E,H,J,B,G})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateAmbientLighting.glsl":function(){define(["require","exports","tslib","../../shaderModules/interfaces"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.EvaluateAmbientLighting=function(f,c){f=f.fragment;var a=void 0!==c.lightingSphericalHarmonicsOrder?c.lightingSphericalHarmonicsOrder:2;0===a?(f.uniforms.add("lightingAmbientSH0","vec3"),f.code.add(r.glsl(m||(m=e.__makeTemplateObject(["\n      vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\n        vec3 ambientLight \x3d 0.282095 * lightingAmbientSH0;\n        return ambientLight * (1.0 - ambientOcclusion);\n      }\n    "],
["\n      vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\n        vec3 ambientLight \x3d 0.282095 * lightingAmbientSH0;\n        return ambientLight * (1.0 - ambientOcclusion);\n      }\n    "]))))):1===a?(f.uniforms.add("lightingAmbientSH_R","vec4"),f.uniforms.add("lightingAmbientSH_G","vec4"),f.uniforms.add("lightingAmbientSH_B","vec4"),f.code.add(r.glsl(d||(d=e.__makeTemplateObject(["\n      vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\n        vec4 sh0 \x3d vec4(\n          0.282095,\n          0.488603 * normal.x,\n          0.488603 * normal.z,\n          0.488603 * normal.y\n        );\n        vec3 ambientLight \x3d vec3(\n          dot(lightingAmbientSH_R, sh0),\n          dot(lightingAmbientSH_G, sh0),\n          dot(lightingAmbientSH_B, sh0)\n        );\n        return ambientLight * (1.0 - ambientOcclusion);\n      }\n    "],
["\n      vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\n        vec4 sh0 \x3d vec4(\n          0.282095,\n          0.488603 * normal.x,\n          0.488603 * normal.z,\n          0.488603 * normal.y\n        );\n        vec3 ambientLight \x3d vec3(\n          dot(lightingAmbientSH_R, sh0),\n          dot(lightingAmbientSH_G, sh0),\n          dot(lightingAmbientSH_B, sh0)\n        );\n        return ambientLight * (1.0 - ambientOcclusion);\n      }\n    "]))))):2===a&&(f.uniforms.add("lightingAmbientSH0",
"vec3"),f.uniforms.add("lightingAmbientSH_R1","vec4"),f.uniforms.add("lightingAmbientSH_G1","vec4"),f.uniforms.add("lightingAmbientSH_B1","vec4"),f.uniforms.add("lightingAmbientSH_R2","vec4"),f.uniforms.add("lightingAmbientSH_G2","vec4"),f.uniforms.add("lightingAmbientSH_B2","vec4"),f.code.add(r.glsl(g||(g=e.__makeTemplateObject(["\n      vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\n        vec3 ambientLight \x3d 0.282095 * lightingAmbientSH0;\n\n        vec4 sh1 \x3d vec4(\n          0.488603 * normal.x,\n          0.488603 * normal.z,\n          0.488603 * normal.y,\n          1.092548 * normal.x * normal.y\n        );\n        vec4 sh2 \x3d vec4(\n          1.092548 * normal.y * normal.z,\n          0.315392 * (3.0 * normal.z * normal.z - 1.0),\n          1.092548 * normal.x * normal.z,\n          0.546274 * (normal.x * normal.x - normal.y * normal.y)\n        );\n        ambientLight +\x3d vec3(\n          dot(lightingAmbientSH_R1, sh1),\n          dot(lightingAmbientSH_G1, sh1),\n          dot(lightingAmbientSH_B1, sh1)\n        );\n        ambientLight +\x3d vec3(\n          dot(lightingAmbientSH_R2, sh2),\n          dot(lightingAmbientSH_G2, sh2),\n          dot(lightingAmbientSH_B2, sh2)\n        );\n        return ambientLight * (1.0 - ambientOcclusion);\n      }\n    "],
["\n      vec3 calculateAmbientIrradiance(vec3 normal, float ambientOcclusion) {\n        vec3 ambientLight \x3d 0.282095 * lightingAmbientSH0;\n\n        vec4 sh1 \x3d vec4(\n          0.488603 * normal.x,\n          0.488603 * normal.z,\n          0.488603 * normal.y,\n          1.092548 * normal.x * normal.y\n        );\n        vec4 sh2 \x3d vec4(\n          1.092548 * normal.y * normal.z,\n          0.315392 * (3.0 * normal.z * normal.z - 1.0),\n          1.092548 * normal.x * normal.z,\n          0.546274 * (normal.x * normal.x - normal.y * normal.y)\n        );\n        ambientLight +\x3d vec3(\n          dot(lightingAmbientSH_R1, sh1),\n          dot(lightingAmbientSH_G1, sh1),\n          dot(lightingAmbientSH_B1, sh1)\n        );\n        ambientLight +\x3d vec3(\n          dot(lightingAmbientSH_R2, sh2),\n          dot(lightingAmbientSH_G2, sh2),\n          dot(lightingAmbientSH_B2, sh2)\n        );\n        return ambientLight * (1.0 - ambientOcclusion);\n      }\n    "])))),
1!==c.pbrMode&&2!==c.pbrMode||f.code.add(r.glsl(k||(k=e.__makeTemplateObject(["\n        const vec3 skyTransmittance \x3d vec3(0.9, 0.9, 1.0);\n\n        vec3 calculateAmbientRadiance(float ambientOcclusion)\n        {\n          vec3 ambientLight \x3d 1.2 * (0.282095 * lightingAmbientSH0) - 0.2;\n          return ambientLight *\x3d (1.0 - ambientOcclusion) * skyTransmittance;\n        }\n      "],["\n        const vec3 skyTransmittance \x3d vec3(0.9, 0.9, 1.0);\n\n        vec3 calculateAmbientRadiance(float ambientOcclusion)\n        {\n          vec3 ambientLight \x3d 1.2 * (0.282095 * lightingAmbientSH0) - 0.2;\n          return ambientLight *\x3d (1.0 - ambientOcclusion) * skyTransmittance;\n        }\n      "])))))};
var m,d,g,k})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateMainLighting.glsl":function(){define(["require","exports","tslib","../../shaderModules/interfaces"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.EvaluateMainLighting=function(d){d=d.fragment;d.uniforms.add("lightingMainDirection","vec3");d.uniforms.add("lightingMainIntensity","vec3");d.uniforms.add("lightingFixedFactor","float");d.code.add(r.glsl(m||(m=e.__makeTemplateObject(["\n    vec3 evaluateMainLighting(vec3 normal_global, float shadowing) {\n      float dotVal \x3d clamp(-dot(normal_global, lightingMainDirection), 0.0, 1.0);\n\n      // move lighting towards (1.0, 1.0, 1.0) if requested\n      dotVal \x3d mix(dotVal, 1.0, lightingFixedFactor);\n\n      return lightingMainIntensity * ((1.0 - shadowing) * dotVal);\n    }\n  "],
["\n    vec3 evaluateMainLighting(vec3 normal_global, float shadowing) {\n      float dotVal \x3d clamp(-dot(normal_global, lightingMainDirection), 0.0, 1.0);\n\n      // move lighting towards (1.0, 1.0, 1.0) if requested\n      dotVal \x3d mix(dotVal, 1.0, lightingFixedFactor);\n\n      return lightingMainIntensity * ((1.0 - shadowing) * dotVal);\n    }\n  "]))))};var m})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/Normals.glsl":function(){define(["require","exports","tslib","../../shaderModules/interfaces"],
function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.Normals=function(f,c){f=f.fragment;f.code.add(r.glsl(m||(m=e.__makeTemplateObject(["\n    struct ShadingNormalParameters {\n      vec3 normalView;\n      vec3 viewDirection;\n    } shadingParams;\n    "],["\n    struct ShadingNormalParameters {\n      vec3 normalView;\n      vec3 viewDirection;\n    } shadingParams;\n    "]))));1===c.doubleSidedMode?f.code.add(r.glsl(d||(d=e.__makeTemplateObject(["\n      vec3 shadingNormal(ShadingNormalParameters params) {\n        return dot(params.normalView, params.viewDirection) \x3e 0.0 ? normalize(-params.normalView) : normalize(params.normalView);\n      }\n    "],
["\n      vec3 shadingNormal(ShadingNormalParameters params) {\n        return dot(params.normalView, params.viewDirection) \x3e 0.0 ? normalize(-params.normalView) : normalize(params.normalView);\n      }\n    "])))):2===c.doubleSidedMode?f.code.add(r.glsl(g||(g=e.__makeTemplateObject(["\n      vec3 shadingNormal(ShadingNormalParameters params) {\n        return gl_FrontFacing ? normalize(params.normalView) : normalize(-params.normalView);\n      }\n    "],["\n      vec3 shadingNormal(ShadingNormalParameters params) {\n        return gl_FrontFacing ? normalize(params.normalView) : normalize(-params.normalView);\n      }\n    "])))):
f.code.add(r.glsl(k||(k=e.__makeTemplateObject(["\n      vec3 shadingNormal(ShadingNormalParameters params) {\n        return normalize(params.normalView);\n      }\n    "],["\n      vec3 shadingNormal(ShadingNormalParameters params) {\n        return normalize(params.normalView);\n      }\n    "]))))};var m,d,g,k})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/HeaderComment.glsl":function(){define(["require","exports","tslib","../../../../../../core/has","../../shaderModules/interfaces"],
function(u,f,e,r,m){Object.defineProperty(f,"__esModule",{value:!0});f.HeaderComment=function(f,k){m.glsl(d||(d=e.__makeTemplateObject(["\n  /*\n  *  ","\n  *  ","\n  */\n  "],["\n  /*\n  *  ","\n  *  ","\n  */\n  "])),k.name,0===k.output?"RenderOutput: Color":1===k.output?"RenderOutput: Depth":3===k.output?"RenderOutput: Shadow":2===k.output?"RenderOutput: Normal":4===k.output?"RenderOutput: Highlight":"")};var d})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/MixExternalColor.glsl":function(){define(["require",
"exports","tslib","./ColorConversion.glsl","../../shaderModules/interfaces"],function(u,f,e,r,m){Object.defineProperty(f,"__esModule",{value:!0});f.MixExternalColor=function(f,k){f.include(r.ColorConversion,k);var g=m.glsl(d||(d=e.__makeTemplateObject(["\n    vec3 mixExternalColor(vec3 internalColor, vec3 textureColor, vec3 externalColor, int mode) {\n      // workaround for artifacts in OSX using Intel Iris Pro\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/10475\n      vec3 internalMixed \x3d internalColor * textureColor;\n      vec3 allMixed \x3d internalMixed * externalColor;\n\n      if (mode \x3d\x3d ",
") {\n        return allMixed;\n      }\n      else if (mode \x3d\x3d ",") {\n        return internalMixed;\n      }\n      else if (mode \x3d\x3d ",") {\n        return externalColor;\n      }\n      else {\n        // tint (or something invalid)\n        float vIn \x3d rgb2v(internalMixed);\n        vec3 hsvTint \x3d rgb2hsv(externalColor);\n        vec3 hsvOut \x3d vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\n        return hsv2rgb(hsvOut);\n      }\n    }\n\n    float mixExternalOpacity(float internalOpacity, float textureOpacity, float externalOpacity, int mode) {\n      // workaround for artifacts in OSX using Intel Iris Pro\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/10475\n      float internalMixed \x3d internalOpacity * textureOpacity;\n      float allMixed \x3d internalMixed * externalOpacity;\n\n      if (mode \x3d\x3d ",
") {\n        return internalMixed;\n      }\n      else if (mode \x3d\x3d ",") {\n        return externalOpacity;\n      }\n      else {\n        // multiply or tint (or something invalid)\n        return allMixed;\n      }\n    }\n  "],["\n    vec3 mixExternalColor(vec3 internalColor, vec3 textureColor, vec3 externalColor, int mode) {\n      // workaround for artifacts in OSX using Intel Iris Pro\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/10475\n      vec3 internalMixed \x3d internalColor * textureColor;\n      vec3 allMixed \x3d internalMixed * externalColor;\n\n      if (mode \x3d\x3d ",
") {\n        return allMixed;\n      }\n      else if (mode \x3d\x3d ",") {\n        return internalMixed;\n      }\n      else if (mode \x3d\x3d ",") {\n        return externalColor;\n      }\n      else {\n        // tint (or something invalid)\n        float vIn \x3d rgb2v(internalMixed);\n        vec3 hsvTint \x3d rgb2hsv(externalColor);\n        vec3 hsvOut \x3d vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\n        return hsv2rgb(hsvOut);\n      }\n    }\n\n    float mixExternalOpacity(float internalOpacity, float textureOpacity, float externalOpacity, int mode) {\n      // workaround for artifacts in OSX using Intel Iris Pro\n      // see: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/10475\n      float internalMixed \x3d internalOpacity * textureOpacity;\n      float allMixed \x3d internalMixed * externalOpacity;\n\n      if (mode \x3d\x3d ",
") {\n        return internalMixed;\n      }\n      else if (mode \x3d\x3d ",") {\n        return externalOpacity;\n      }\n      else {\n        // multiply or tint (or something invalid)\n        return allMixed;\n      }\n    }\n  "])),m.glsl.int(1),m.glsl.int(2),m.glsl.int(3),m.glsl.int(2),m.glsl.int(3));switch(k.stages){case 0:f.vertex.code.add(g);break;case 1:f.fragment.code.add(g);break;default:f.vertex.code.add(g),f.fragment.code.add(g)}};var d})},"esri/views/3d/webgl-engine/shaders/RealisticTreeTechnique":function(){define("require exports tslib ../core/shaderLibrary/default/RealisticTree.glsl ../core/shaderLibrary/util/DoublePrecision.glsl ../core/shaderTechnique/ReloadableShaderModule ../lib/DefaultVertexAttributeLocations ./DefaultMaterialTechnique ../../../webgl/Program @dojo/framework/shim/Promise".split(" "),
function(u,f,e,r,m,d,g,k,l){Object.defineProperty(f,"__esModule",{value:!0});k=function(c){function a(){return null!==c&&c.apply(this,arguments)||this}e.__extends(a,c);a.prototype.initializeProgram=function(b){var c=a.shader.get(),d=this.configuration,c=c.build({output:d.output,viewingMode:b.viewingMode,receiveShadows:d.receiveShadows,slicePlaneEnabled:d.slicePlaneEnabled,sliceHighlightDisabled:d.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1,symbolColor:d.symbolColors,vvSize:d.vvSize,vvColor:d.vvColor,
vvInstancingEnabled:!0,instanced:d.instanced,instancedColor:d.instancedColor,instancedDoublePrecision:d.instancedDoublePrecision,useOldSceneLightInterface:!1,pbrMode:d.usePBR?1:0,hasMetalnessAndRoughnessTexture:!1,hasEmissionTexture:!1,hasOcclusionTexture:!1,hasNormalTexture:!1,hasColorTexture:d.hasColorTexture,receiveAmbientOcclusion:d.receiveAmbientOcclusion,useCustomDTRExponentForWater:!1,normalType:0,doubleSidedMode:2,vertexTangets:!1,attributeTextureCoordinates:d.hasColorTexture?1:0,textureAlphaPremultiplied:d.textureAlphaPremultiplied,
attributeColor:d.vertexColors,screenSizePerspectiveEnabled:d.screenSizePerspective,verticalOffsetEnabled:d.verticalOffset,offsetBackfaces:d.offsetBackfaces,doublePrecisionRequiresObfuscation:m.doublePrecisionRequiresObfuscation(b.rctx),alphaDiscardMode:d.alphaDiscardMode,supportsTextureAtlas:!1});return new l(b.rctx,c.generateSource("vertex"),c.generateSource("fragment"),g.Default3D)};a.shader=new d.ReloadableShaderModule(r,function(){return new Promise(function(a,c){u(["../core/shaderLibrary/default/RealisticTree.glsl"],
a,c)})});return a}(k.DefaultMaterialTechnique);f.RealisticTreeTechnique=k})},"esri/views/3d/webgl-engine/core/shaderLibrary/default/RealisticTree.glsl":function(){define("require exports tslib ../ForwardLinearDepth.glsl ../Offset.glsl ../Slice.glsl ../Transform.glsl ../attributes/InstancedDoublePrecision.glsl ../attributes/NormalAttribute.glsl ../attributes/PositionAttribute.glsl ../attributes/SymbolColor.glsl ../attributes/TextureCoordinateAttribute.glsl ../attributes/VertexColor.glsl ../attributes/VerticalOffset.glsl ./DefaultMaterialAuxiliaryPasses.glsl ../shading/EvaluateAmbientOcclusion.glsl ../shading/EvaluateSceneLighting.glsl ../shading/PhysicallyBasedRendering.glsl ../shading/PhysicallyBasedRenderingParameters.glsl ../shading/ReadShadowMap.glsl ../shading/VisualVariables.glsl ../util/AlphaDiscard.glsl ../util/MixExternalColor.glsl ../../shaderModules/interfaces ../../shaderModules/ShaderBuilder".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A,E,H,J,B,G,F,M){Object.defineProperty(f,"__esModule",{value:!0});f.build=function(f){var u=new M.ShaderBuilder,X=u.vertex.code,oa=u.fragment.code;u.vertex.uniforms.add("proj","mat4").add("view","mat4").add("camPos","vec3").add("localOrigin","vec3");u.include(c.PositionAttribute);u.varyings.add("vpos","vec3");u.include(J.VisualVariables,f);u.include(k.InstancedDoublePrecision,f);u.include(v.VerticalOffset,f);0===f.output&&(u.include(l.NormalAttribute,f),
u.include(g.Transform,{linearDepth:!1}),f.offsetBackfaces&&u.include(m.Offset),f.instancedColor&&u.attributes.add("instanceColor","vec4"),u.varyings.add("vNormalWorld","vec3"),u.varyings.add("localvpos","vec3"),u.include(b.TextureCoordinateAttribute,f),u.include(r.ForwardLinearDepth,f),u.include(a.SymbolColor,f),u.include(q.VertexColor,f),u.vertex.uniforms.add("externalColor","vec4"),u.varyings.add("vcolorExt","vec4"),X.add(F.glsl(R||(R=e.__makeTemplateObject(["\n        void main(void) {\n          forwardNormalizedVertexColor();\n          vcolorExt \x3d externalColor;\n          ",
"\n          vcolorExt *\x3d vvColor();\n          vcolorExt *\x3d getSymbolColor();\n          forwardColorMixMode();\n\n          if (vcolorExt.a \x3c ",") {\n            gl_Position \x3d vec4(1e38, 1e38, 1e38, 1.0);\n          }\n          else {\n            vpos \x3d calculateVPos();\n            localvpos \x3d vpos - view[3].xyz;\n            vpos \x3d subtractOrigin(vpos);\n            vNormalWorld \x3d dpNormal(vvLocalNormal(normalModel()));\n            vpos \x3d addVerticalOffset(vpos, localOrigin);\n            gl_Position \x3d transformPosition(proj, view, vpos);\n            ",
"\n          }\n          forwardLinearDepth();\n          forwardTextureCoordinates();\n        }\n      "],["\n        void main(void) {\n          forwardNormalizedVertexColor();\n          vcolorExt \x3d externalColor;\n          ","\n          vcolorExt *\x3d vvColor();\n          vcolorExt *\x3d getSymbolColor();\n          forwardColorMixMode();\n\n          if (vcolorExt.a \x3c ",") {\n            gl_Position \x3d vec4(1e38, 1e38, 1e38, 1.0);\n          }\n          else {\n            vpos \x3d calculateVPos();\n            localvpos \x3d vpos - view[3].xyz;\n            vpos \x3d subtractOrigin(vpos);\n            vNormalWorld \x3d dpNormal(vvLocalNormal(normalModel()));\n            vpos \x3d addVerticalOffset(vpos, localOrigin);\n            gl_Position \x3d transformPosition(proj, view, vpos);\n            ",
"\n          }\n          forwardLinearDepth();\n          forwardTextureCoordinates();\n        }\n      "])),f.instancedColor?"vcolorExt *\x3d instanceColor;":"",F.glsl.float(B.symbolAlphaCutoff),f.offsetBackfaces?"gl_Position \x3d offsetBackfacingClipPosition(gl_Position, vpos, vNormalWorld, camPos);":"")),u.include(d.Slice,f),u.include(z.EvaluateSceneLighting,f),u.include(x.EvaluateAmbientOcclusion,f),u.include(B.DiscardOrAdjustAlpha,f),f.receiveShadows&&u.include(H.ReadShadowMap,f),u.fragment.uniforms.add("camPos",
"vec3").add("localOrigin","vec3").add("ambient","vec3").add("diffuse","vec3").add("opacity","float").add("layerOpacity","float"),u.fragment.uniforms.add("view","mat4"),f.hasColorTexture&&u.fragment.uniforms.add("tex","sampler2D"),u.include(E.PhysicallyBasedRenderingParameters,f),u.include(A.PhysicallyBasedRendering,f),u.include(G.MixExternalColor,{stages:1}),oa.add(F.glsl(ha||(ha=e.__makeTemplateObject(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        vec3 viewDirection \x3d normalize(vpos - camPos);\n        ",
"\n        float ssao \x3d evaluateAmbientOcclusionInverse();\n        ssao *\x3d getBakedOcclusion();\n\n        float additionalAmbientScale \x3d _oldHeuristicLighting(vpos + localOrigin);\n        vec3 additionalLight \x3d ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n        ","\n        vec3 matColor \x3d max(ambient, diffuse);\n        ","\n        ","\n        ","\n        ","\n        gl_FragColor \x3d highlightSlice(vec4(shadedColor, opacity_), vpos);\n      }\n    "],
["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        vec3 viewDirection \x3d normalize(vpos - camPos);\n        ","\n        float ssao \x3d evaluateAmbientOcclusionInverse();\n        ssao *\x3d getBakedOcclusion();\n\n        float additionalAmbientScale \x3d _oldHeuristicLighting(vpos + localOrigin);\n        vec3 additionalLight \x3d ssao * lightingMainIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n        ","\n        vec3 matColor \x3d max(ambient, diffuse);\n        ",
"\n        ","\n        ","\n        ","\n        gl_FragColor \x3d highlightSlice(vec4(shadedColor, opacity_), vpos);\n      }\n    "])),f.hasColorTexture?F.glsl(T||(T=e.__makeTemplateObject(["\n        vec4 texColor \x3d texture2D(tex, vuv0);\n        ","\n        discardOrAdjustAlpha(texColor);"],["\n        vec4 texColor \x3d texture2D(tex, vuv0);\n        ","\n        discardOrAdjustAlpha(texColor);"])),f.textureAlphaPremultiplied?"texColor.rgb /\x3d texColor.a;":""):F.glsl(O||(O=e.__makeTemplateObject(["vec4 texColor \x3d vec4(1.0);"],
["vec4 texColor \x3d vec4(1.0);"]))),1===f.pbrMode?"applyPBRFactors();":"",f.receiveShadows?"float shadow \x3d readShadowMap(vpos, linearDepth);":0===f.viewingMode?"float shadow \x3d lightingGlobalFactor * (1.0 - additionalAmbientScale);":"float shadow \x3d 0.0;",f.attributeColor?F.glsl(L||(L=e.__makeTemplateObject(["\n        vec3 albedo_ \x3d mixExternalColor(vColor.rgb * matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ \x3d layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));"],
["\n        vec3 albedo_ \x3d mixExternalColor(vColor.rgb * matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ \x3d layerOpacity * mixExternalOpacity(vColor.a * opacity, texColor.a, vcolorExt.a, int(colorMixMode));"]))):F.glsl(Q||(Q=e.__makeTemplateObject(["\n        vec3 albedo_ \x3d mixExternalColor(matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ \x3d layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        "],
["\n        vec3 albedo_ \x3d mixExternalColor(matColor, texColor.rgb, vcolorExt.rgb, int(colorMixMode));\n        float opacity_ \x3d layerOpacity * mixExternalOpacity(opacity, texColor.a, vcolorExt.a, int(colorMixMode));\n        "]))),F.glsl(S||(S=e.__makeTemplateObject(["\n        vec3 shadedNormal \x3d normalize(vNormalWorld);\n        albedo_ *\x3d 1.2;\n        vec3 viewForward \x3d - vec3(view[0][2], view[1][2], view[2][2]);\n        float alignmentLightView \x3d clamp(dot(-viewForward, lightingMainDirection), 0.0, 1.0);\n        float transmittance \x3d 1.0 - clamp(dot(-viewForward, shadedNormal), 0.0, 1.0);\n        float treeRadialFalloff \x3d vColor.r;\n        float backLightFactor \x3d 0.5 * treeRadialFalloff * alignmentLightView * transmittance * (1.0 - shadow);\n        additionalLight +\x3d backLightFactor * lightingMainIntensity;"],
["\n        vec3 shadedNormal \x3d normalize(vNormalWorld);\n        albedo_ *\x3d 1.2;\n        vec3 viewForward \x3d - vec3(view[0][2], view[1][2], view[2][2]);\n        float alignmentLightView \x3d clamp(dot(-viewForward, lightingMainDirection), 0.0, 1.0);\n        float transmittance \x3d 1.0 - clamp(dot(-viewForward, shadedNormal), 0.0, 1.0);\n        float treeRadialFalloff \x3d vColor.r;\n        float backLightFactor \x3d 0.5 * treeRadialFalloff * alignmentLightView * transmittance * (1.0 - shadow);\n        additionalLight +\x3d backLightFactor * lightingMainIntensity;"]))),
1===f.pbrMode||2===f.pbrMode?0===f.viewingMode?F.glsl(aa||(aa=e.__makeTemplateObject(["vec3 normalGround \x3d normalize(vpos + localOrigin);"],["vec3 normalGround \x3d normalize(vpos + localOrigin);"]))):F.glsl(ba||(ba=e.__makeTemplateObject(["vec3 normalGround \x3d vec3(0.0, 0.0, 1.0);"],["vec3 normalGround \x3d vec3(0.0, 0.0, 1.0);"]))):F.glsl(V||(V=e.__makeTemplateObject([""],[""]))),1===f.pbrMode||2===f.pbrMode?F.glsl(Z||(Z=e.__makeTemplateObject(["\n            float additionalAmbientIrradiance \x3d additionalAmbientIrradianceFactor * lightingMainIntensity[2];\n            vec3 shadedColor \x3d evaluateSceneLightingPBR(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight, viewDirection, normalGround, mrr, emission, additionalAmbientIrradiance);"],
["\n            float additionalAmbientIrradiance \x3d additionalAmbientIrradianceFactor * lightingMainIntensity[2];\n            vec3 shadedColor \x3d evaluateSceneLightingPBR(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight, viewDirection, normalGround, mrr, emission, additionalAmbientIrradiance);"]))):"vec3 shadedColor \x3d evaluateSceneLighting(shadedNormal, albedo_, shadow, 1.0 - ssao, additionalLight);")));u.include(t.DefaultMaterialAuxiliaryPasses,f);return u};var R,T,O,L,Q,S,aa,
ba,V,Z,ha})},"esri/views/3d/support/buffer/math":function(){define(["require","exports","./math/vec3","./math/vec4"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});f.vec3=e;f.vec4=r})},"esri/views/3d/support/buffer/math/vec3":function(){define(["require","exports","./common"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.transformMat4=function(f,m,d){if(f.count!==m.count)e.logger.error("source and destination buffers need to have the same number of elements");
else{var g=f.count,k=d[0],l=d[1],c=d[2],a=d[4],b=d[5],q=d[6],r=d[8],t=d[9],x=d[10],u=d[12],A=d[13];d=d[14];var E=f.typedBuffer;f=f.typedBufferStride;var H=m.typedBuffer;m=m.typedBufferStride;for(var J=0;J<g;J++){var B=J*f,G=J*m,F=H[G],M=H[G+1],G=H[G+2];E[B]=k*F+a*M+r*G+u;E[B+1]=l*F+b*M+t*G+A;E[B+2]=c*F+q*M+x*G+d}}};f.transformMat3=function(f,m,d){if(f.count!==m.count)e.logger.error("source and destination buffers need to have the same number of elements");else{var g=f.count,k=d[0],l=d[1],c=d[2],a=
d[3],b=d[4],q=d[5],r=d[6],t=d[7];d=d[8];var x=f.typedBuffer;f=f.typedBufferStride;var u=m.typedBuffer;m=m.typedBufferStride;for(var A=0;A<g;A++){var E=A*f,H=A*m,J=u[H],B=u[H+1],H=u[H+2];x[E]=k*J+a*B+r*H;x[E+1]=l*J+b*B+t*H;x[E+2]=c*J+q*B+d*H}}};f.scale=function(e,f,d){var g=Math.min(e.count,f.count),k=e.typedBuffer;e=e.typedBufferStride;var l=f.typedBuffer;f=f.typedBufferStride;for(var c=0;c<g;c++){var a=c*e,b=c*f;k[a]=d*l[b];k[a+1]=d*l[b+1];k[a+2]=d*l[b+2]}};f.shiftRight=function(e,f,d){var g=Math.min(e.count,
f.count),k=e.typedBuffer;e=e.typedBufferStride;var l=f.typedBuffer;f=f.typedBufferStride;for(var c=0;c<g;c++){var a=c*e,b=c*f;k[a]=l[b]>>d;k[a+1]=l[b+1]>>d;k[a+2]=l[b+2]>>d}}})},"esri/views/3d/support/buffer/math/common":function(){define(["require","exports","../../../../../core/Logger"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.logger=e.getLogger("esri.views.3d.support.buffer.math")})},"esri/views/3d/support/buffer/math/vec4":function(){define(["require","exports","./common"],
function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.transformMat4=function(f,m,d){if(f.count!==m.count)e.logger.error("source and destination buffers need to have the same number of elements");else{var g=f.count,k=d[0],l=d[1],c=d[2],a=d[3],b=d[4],q=d[5],r=d[6],t=d[7],x=d[8],u=d[9],A=d[10],E=d[11],H=d[12],J=d[13],B=d[14];d=d[15];var G=f.typedBuffer;f=f.typedBufferStride;var F=m.typedBuffer;m=m.typedBufferStride;for(var M=0;M<g;M++){var R=M*f,T=M*m,O=F[T],L=F[T+1],Q=F[T+2],T=F[T+3];G[R]=
k*O+b*L+x*Q+H*T;G[R+1]=l*O+q*L+u*Q+J*T;G[R+2]=c*O+r*L+A*Q+B*T;G[R+3]=a*O+t*L+E*Q+d*T}}};f.transformMat3=function(f,m,d){if(f.count!==m.count)e.logger.error("source and destination buffers need to have the same number of elements");else{var g=f.count,k=d[0],l=d[1],c=d[2],a=d[3],b=d[4],q=d[5],r=d[6],t=d[7];d=d[8];var x=f.typedBuffer;f=f.typedBufferStride;var u=m.typedBuffer;m=m.typedBufferStride;for(var A=0;A<g;A++){var E=A*f,H=A*m,J=u[H],B=u[H+1],G=u[H+2],H=u[H+3];x[E]=k*J+a*B+r*G;x[E+1]=l*J+b*B+t*
G;x[E+2]=c*J+q*B+d*G;x[E+3]=H}}};f.scale=function(e,f,d){var g=Math.min(e.count,f.count),k=e.typedBuffer;e=e.typedBufferStride;var l=f.typedBuffer;f=f.typedBufferStride;for(var c=0;c<g;c++){var a=c*e,b=c*f;k[a]=d*l[b];k[a+1]=d*l[b+1];k[a+2]=d*l[b+2];k[a+3]=d*l[b+3]}};f.shiftRight=function(e,f,d){var g=Math.min(e.count,f.count),k=e.typedBuffer;e=e.typedBufferStride;var l=f.typedBuffer;f=f.typedBufferStride;for(var c=0;c<g;c++){var a=c*e,b=c*f;k[a]=l[b]>>d;k[a+1]=l[b+1]>>d;k[a+2]=l[b+2]>>d;k[a+3]=l[b+
3]>>d}}})},"esri/views/support/drapedUtils":function(){define("require exports ../../geometry ../../core/maybe ../../core/unitUtils ../../renderers/support/clickToleranceUtils".split(" "),function(u,f,e,r,m,d){function g(d,c,a,b){void 0===b&&(b=new e.Extent);var f;if("2d"===a.type)f=c*a.resolution;else if("3d"===a.type){var g=a.basemapTerrain,k=g.overlayManager,k=k?k.overlayPixelSizeInMapUnits(d):1;f=g&&!g.spatialReference.equals(a.spatialReference)?m.getMetersPerUnitForSR(g.spatialReference)/m.getMetersPerUnitForSR(a.spatialReference):
c*k}c=d.x-f;g=d.y-f;k=d.x+f;d=d.y+f;a=a.spatialReference;b.xmin=Math.min(c,k);b.ymin=Math.min(g,d);b.xmax=Math.max(c,k);b.ymax=Math.max(g,d);b.spatialReference=a;return b}Object.defineProperty(f,"__esModule",{value:!0});f.createQueryGeometry=g;f.intersectsDrapedGeometry=function(e,c,a){e=a.toMap(e);if(r.isNone(e))return null;var b=d.calculateTolerance();return g(e,b,a,k).intersects(c)?e:null};var k=new e.Extent})},"esri/widgets/Editor/UpdateWorkflow":function(){define("require exports tslib ../../core/arrayUtils ../../core/maybe ../../core/promiseUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../../views/support/layerViewUtils ./Edits ./UpdateWorkflowData ./Workflow ./workflowUtils".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q){return function(b){function f(a){a=b.call(this,a)||this;a.type="update";return a}e.__extends(f,b);v=f;f.create=function(b,d,e){b=new a({edits:new c,viewModel:b});e=new v({data:b,afterCommit:e});e._set("steps",this._createWorkflowSteps(e,d));return e};f.prototype.highlight=function(a){var b=this.data.viewModel.view,b=a&&r.find(b.allLayerViews.items,function(b){return b.layer===a.layer});l.highlightsSupported(b)&&this.handles.add(b.highlight(a),"candidate-highlight")};
f.prototype.unhighlight=function(){this.handles.remove("candidate-highlight")};f._createWorkflowSteps=function(a,b){void 0===b&&(b="awaiting-feature-to-update");var c=a.data,f=a.handles,k={"awaiting-feature-to-update":function(){return{id:"awaiting-feature-to-update",setUp:function(){return e.__awaiter(this,void 0,void 0,function(){var a,b,g,k,l;return e.__generator(this,function(m){a=c.viewModel;b=a.spinnerViewModel;g=a.view;k=null;f.add({remove:function(){k&&(k.abort(),k=null)}},this.id);c.edits.feature=
null;l=g.on("immediate-click",function(a){a.stopPropagation();b.location=a.mapPoint;b.visible=!0;k&&k.abort();var f=c.viewModel.editableItems;k=d.createAbortController();d.create(function(b,c){d.onAbort(k.signal,function(){return c(d.createAbortError())});b(q.fetchCandidates(f,g,a))}).then(function(a){c.viewModel.spinnerViewModel.visible=!1;d.throwIfAborted(k);c.candidates=a.reduce(function(a,b){return b.error?a:e.__spreadArrays(a,b.value)},[]);0!==c.candidates.length&&(1===c.candidates.length?(c.edits.feature=
c.candidates[0],c.viewModel.activeWorkflow.go("editing-existing-feature")):c.viewModel.activeWorkflow.next())})});f.add(l,this.id);return[2]})})},tearDown:function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(a){f.remove(this.id);return[2]})})}}},"awaiting-update-feature-candidate":function(){return{id:"awaiting-update-feature-candidate",setUp:function(){return e.__awaiter(this,void 0,void 0,function(){var b;return e.__generator(this,function(d){b=c.edits;
b.feature=null;f.add(g.watch(b,"feature",function(b){a.unhighlight();a.highlight(b)}),this.id);return[2]})})},tearDown:function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(b){a.unhighlight();f.remove(this.id);return[2]})})}}},"editing-existing-feature":function(){return{id:"editing-existing-feature",setUp:function(){return e.__awaiter(this,void 0,void 0,function(){var b,g,k,l=this;return e.__generator(this,function(t){b=c.edits.feature;g=c.viewModel;c.editableItem=
g.editableItems.find(function(a){return a.layer===b.layer});k=d.createAbortController();f.add({remove:function(){return k.abort()}},this.id);return[2,q.fetchFullFeature(b,g.view,k).then(function(b){return e.__awaiter(l,void 0,void 0,function(){var l,t,r,v,x,u,z,A,B;return e.__generator(this,function(e){switch(e.label){case 0:if(d.isAborted(k))return[2];c.edits.updateGeometry(b.geometry);c.edits.updateAttributes(b.attributes);c.edits.trackChanges();l=b.layer;r=(t=q.findLayerInfo(g.layerInfos,l))&&
t.fieldConfig;g.attachmentsViewModel.set({graphic:b,mode:"view"});g.featureFormViewModel.set({feature:b,fieldConfig:r});v=[g.featureFormViewModel.on("value-change",function(){c.edits.updateAttributes(g.featureFormViewModel.getValues());b.attributes=c.edits.feature.attributes}),g.attachmentsViewModel.watch("mode",function(a){"add"===a&&c.viewModel.activeWorkflow.go("adding-attachment");"edit"===a&&c.viewModel.activeWorkflow.go("editing-attachment")})];x=l.capabilities.editing.supportsGeometryUpdate;
if(!x)return[3,2];u=q.getVisualVariableAttributes(b);return[4,q.setUpGeometryUpdate(b,u,g.sketchViewModel,g.view,function(a){var b=a.geometry;a=a.attributes;if(m.isSome(u.rotation)){var d=u.rotation.field;g.featureFormViewModel.setValue(d,a[d])}m.isSome(u.size)&&(d=u.size.field,g.featureFormViewModel.setValue(d,a[d]));c.edits.updateAttributes(a);c.edits.updateGeometry(b)})];case 1:return z=e.sent(),A=z.interactive,B=z.visual,v.push(A,B),f.add(A,a._handleKeys.beforeCommit),f.add(B,a._handleKeys.afterCommit),
[3,3];case 2:a.highlight(b),e.label=3;case 3:return f.add(v,this.id),[2]}})})})]})})},tearDown:function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(b){c.editableItem=null;c.viewModel.featureFormViewModel.set({feature:null,fieldConfig:null});f.remove(this.id);a.unhighlight();return[2]})})}}},"adding-attachment":function(){return{id:"adding-attachment",parent:"editing-existing-feature",setUp:function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,
function(a){return[2]})})},tearDown:function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(a){return[2]})})}}},"editing-attachment":function(){return{id:"editing-attachment",parent:"editing-existing-feature",setUp:function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(a){return[2]})})},tearDown:function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(a){return[2]})})}}}},l=!1;return["awaiting-feature-to-update",
"awaiting-update-feature-candidate","editing-existing-feature","adding-attachment","editing-attachment"].filter(function(a){return l?!0:l=a===b}).map(function(a){return k[a]()})};var v;return f=v=e.__decorate([k.subclass("esri.widgets.Editor.UpdateWorkflow")],f)}(b)})},"esri/widgets/Editor/UpdateWorkflowData":function(){define(["require","exports","tslib","../../core/Accessor","../../core/accessorSupport/decorators"],function(u,f,e,r,m){return function(d){function f(){var e=null!==d&&d.apply(this,
arguments)||this;e.candidates=null;e.editableItem=null;e.edits=null;e.viewModel=null;return e}e.__extends(f,d);e.__decorate([m.property()],f.prototype,"candidates",void 0);e.__decorate([m.property()],f.prototype,"editableItem",void 0);e.__decorate([m.property()],f.prototype,"edits",void 0);e.__decorate([m.property()],f.prototype,"viewModel",void 0);return f=e.__decorate([m.subclass("esri.widgets.Editor.UpdateWorkflowData")],f)}(r)})},"esri/widgets/Sketch/SketchViewModel":function(){define("require exports tslib ../../geometry ../../Graphic ../../symbols ../../core/Collection ../../core/compilerUtils ../../core/Error ../../core/Evented ../../core/Handles ../../core/Logger ../../core/maybe ../../core/screenUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../../geometry/support/coordsUtils ../../layers/GraphicsLayer ../../symbols/SimpleFillSymbol ../../symbols/SimpleLineSymbol ../../symbols/SimpleMarkerSymbol ../../views/DOMContainer ../../views/3d/interactive/editingTools/isSupportedGraphicUtils ../../views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic ../../views/3d/support/earthUtils ../../views/draw/Draw ../../views/draw/support/createUtils ../../views/draw/support/layerUtils ../../views/input/InputManager ./support/OperationHandle @dojo/framework/shim/Promise".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A,E,H,J,B,G,F,M,R,T,O,L,Q,S,aa){function ba(a,b){var c=a.history.undo.pop().updates,d=[];b.forEach(function(a,b){b=c[b];var e={};null!=b&&(q.isSome(b.geometry)&&(e.geometry=a.geometry,a.geometry=b.geometry),q.isSome(b.symbol)&&(e.symbol=a.symbol,a.symbol=b.symbol),d.push(e))});a.history.redo.push({updates:d})}function V(a,b){var c=a.history.redo.pop().updates,d=[];b.forEach(function(a,b){b=c[b];var e={};null!=b&&(q.isSome(b.geometry)&&(e.geometry=a.geometry,
a.geometry=b.geometry),q.isSome(b.symbol)&&(e.symbol=a.symbol,a.symbol=b.symbol),d.push(e))});a.history.undo.push({updates:d})}function Z(a){return{updates:a.map(function(a){return{geometry:a.geometry}})}}function ha(a){return{updates:a.map(function(a){return{symbol:a.symbol}})}}function X(a){return"requireError"in a&&"aborted"===a.requireError}var ea=b.getLogger("esri.widgets.Sketch.SketchViewModel"),ga=["Backspace","Delete"];return function(b){function c(c){c=b.call(this,c)||this;c._activeFillGraphic=
null;c._activeLineGraphic=null;c._centerIndicatorGraphic=null;c._centerSymbol=new J({style:"cross",size:6,color:[255,255,255]});c._defaultSegmentOffset=48;c._numUpdating=0;c._handles=new a;c._internalGraphicsLayer=new A({listMode:"hide"});c._lineGraphic=null;c._operationHandle=null;c._vertexGraphics=[];c._viewHandles=new a;c._doUnnormalization=!1;c.activeFillSymbol=new E({style:"solid",color:[150,150,150,.2],outline:{color:[0,0,0,0]}});c.activeLineSymbol=new H({color:[12,207,255,1],width:2,style:"dash"});
c.activePointSymbol=new J({style:"circle",size:6,color:[12,207,255],outline:{color:[50,50,50],width:1}});c.activeVertexSymbol=new J({style:"circle",size:6,color:[12,207,255],outline:{color:[50,50,50],width:1}});c.createGraphic=null;c.defaultCreateOptions={mode:"hybrid"};c.defaultUpdateOptions={enableMidpoints:!0,enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,tool:"transform",enableZ:!0};c.layer=null;c.pointSymbol=
new J({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});c.polygonSymbol=new E({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}});c.polylineSymbol=new H({color:[130,130,130,1],width:2});c.updateGraphics=new g;c.updateOnGraphicClick=!0;c.updatePointSymbol=new J({size:10,color:[0,200,255,.5],outline:{color:"black",width:1}});c.updatePolygonSymbol=new E({color:[12,207,255,.2],outline:{join:"round",color:[12,207,255],width:2}});c.updatePolylineSymbol=new H({color:[12,
207,255],width:2});c.vertexSymbol=new J({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});return c}e.__extends(c,b);c.prototype.initialize=function(){var a=this;this._handles.add([t.watch(this,"layer",function(){a.cancel();a._internalGraphicsLayer.elevationInfo=q.isSome(a.layer)?a.layer.elevationInfo:null}),t.on(this,"view.map.layers","change",function(b){0<=b.removed.indexOf(a.layer)&&a.cancel()}),t.on(this,"layer.graphics","change",function(b){if(q.isSome(a._operationHandle)){var c=
0;for(b=b.removed;c<b.length;c++){var d=b[c];a.updateGraphics.includes(d)&&(1<a.updateGraphics.length?a._operationHandle.removeFromSelection(d):a._operationHandle.cancel())}}}),t.init(this,"layer.elevationInfo",function(){a.cancel();a._internalGraphicsLayer.elevationInfo=q.isSome(a.layer)?a.layer.elevationInfo:null},!0)])};c.prototype.destroy=function(){this.cancel();this._handles.removeAll();this._handles=null;this._viewHandles.removeAll();this._viewHandles=null;this._removeDefaultLayer();this._draw&&
this._draw.destroy();this._set("view",null);this.emit("destroy")};Object.defineProperty(c.prototype,"_defaultUpdateTool",{get:function(){return"3d"===this.view.type?"move":"transform"},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_draw",{get:function(){return"ready"===this.state||"active"===this.state?new O({view:this.view}):null},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"updating",{get:function(){return 0<this._numUpdating},enumerable:!0,configurable:!0});
Object.defineProperty(c.prototype,"activeTool",{get:function(){return this._operationHandle&&this._operationHandle.tool?this._operationHandle.tool:null},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"activeComponent",{get:function(){return this._operationHandle?this._operationHandle.activeComponent:null},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"state",{get:function(){var a=!(!this.get("view.ready")||!this.layer),b=this._operationHandle;return a&&b?"active":
a?"ready":"disabled"},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"view",{get:function(){return this._get("view")},set:function(a){var b=this,c=this._get("view");if(c){var d=c.map;c.container&&(c.cursor=null);d&&d.remove(this._internalGraphicsLayer);this._viewHandles.removeAll();this.cancel()}this._doUnnormalization=null!=a&&"3d"===a.type&&"global"===a.viewingMode;this._handles.remove("view-ready");a&&this._handles.add(t.when(a,"ready",function(c){b._viewHandles.removeAll();
c&&b._viewHandles.add(b._generateViewHandles(a))},!0),"view-ready");this._set("view",a)},enumerable:!0,configurable:!0});c.prototype.cancel=function(){this._moduleLoaderAbortController&&(this._moduleLoaderAbortController.abort(),this._moduleLoaderAbortController=null);this._operationHandle&&this._operationHandle.cancel()};c.prototype.complete=function(){this._operationHandle&&this._operationHandle.complete()};c.prototype.delete=function(){var a=this.updateGraphics;if("active"===this.state&&a.length){var b=
this.activeTool,c=this.layer,a=a.toArray();c.removeMany(a);this.cancel();this._emitDeleteEvent({graphics:a,tool:b})}};c.prototype.create=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d,f=this;return e.__generator(this,function(e){switch(e.label){case 0:if("disabled"===this.state)return this.layer||this._logError("sketch:missing-property","Property 'layer' is missing on SketchViewModel."),this.view||this._logError("sketch:missing-property","Property 'view' is missing on SketchViewModel."),
[2];this.cancel();return a?[4,this._setupCreateOperation(a,b)]:(this._logError("sketch:missing-parameter","Missing parameter 'tool'."),[2]);case 1:c=e.sent();if(q.isNone(c))return[2];Q.addUniqueLayer(this.view,this._internalGraphicsLayer);d=function(){if(c===f._operationHandle){var b=f.createGraphic,d=f._operationHandle.cancelled;f._operationHandle.destroy();f._operationHandle=null;f._set("createGraphic",null);f.view&&f.view.map&&f.view.map.remove(f._internalGraphicsLayer);c.cancelled||f.layer.add(b);
f.emit("create",{graphic:b,state:d?"cancel":"complete",tool:a,toolEventInfo:null,type:"create"})}};c.on("complete",d);this._operationHandle=c;this.view.ready&&B.isDOMContainer(this.view)&&this.view.focus();return[2]}})})};c.prototype.update=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d,f,g,k,l,m,t=this;return e.__generator(this,function(e){switch(e.label){case 0:c=this;d=c.layer;f=c.state;g=c.view;if("disabled"===f)return d||this._logError("sketch:missing-property","Property 'layer' is missing on SketchViewModel."),
g||this._logError("sketch:missing-property","Property 'view' is missing on SketchViewModel."),[2];this.cancel();k=Array.isArray(a)?a:[a];return null!=a&&k&&k.length?(l=k.some(function(a){return a.layer!==d?(t._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):q.isNone(a.geometry)?(t._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0):"2d"!==
g.type||g.spatialReference.equals(a.geometry.spatialReference)?!1:(t._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with a spatial reference different from the supplied MapView."),!0)}))?[2]:[4,this._setupUpdateOperation(k,b)]:(this._logError("sketch:missing-parameter","Missing parameter 'graphics'."),[2]);case 1:m=e.sent();if(q.isNone(m)||X(m))return[2];Q.addUniqueLayer(this.view,this._internalGraphicsLayer);this.emit("update",{graphics:k,state:"start",aborted:!1,
tool:m.tool,toolEventInfo:null,type:"update"});this._setUpdateOperationHandle(m);return[2]}})})};c.prototype.undo=function(){this.canUndo()&&this._operationHandle.undo()};c.prototype.redo=function(){this.canRedo()&&this._operationHandle.redo()};c.prototype.canUndo=function(){return!(!this._operationHandle||!this._operationHandle.canUndo())};c.prototype.canRedo=function(){return!(!this._operationHandle||!this._operationHandle.canRedo())};c.prototype.toggleUpdateTool=function(){this._operationHandle&&
this._operationHandle.toggleTool&&this._operationHandle.toggleTool()};Object.defineProperty(c.prototype,"snapToScene",{set:function(a){this._operationHandle&&this._operationHandle.setSnapToScene&&this._operationHandle.setSnapToScene(a);this._set("snapToScene",a)},enumerable:!0,configurable:!0});c.prototype._getFirstHit=function(a){var b,c;return e.__awaiter(this,void 0,void 0,function(){var d,f,g,k,l;return e.__generator(this,function(e){switch(e.label){case 0:d=[];f=this.view.type;switch(f){case "2d":return[3,
1];case "3d":return[3,3]}return[3,5];case 1:return[4,this.view.hitTest(a)];case 2:return g=e.sent(),0<g.results.length&&(k=g.results[0],k.graphic&&(l=k.graphic,"vector-tile"!==(null===(b=l.layer)||void 0===b?void 0:b.type)&&"imagery"!==(null===(c=l.layer)||void 0===c?void 0:c.type)&&d.push(k))),[3,5];case 3:return[4,this.view.hitTest(a,{include:[this.layer]})];case 4:return g=e.sent(),0<g.results.length&&(k=g.results[0],(!g.ground||1>this.view.map.ground.opacity||g.ground.distance-k.distance>-Math.min(3*
g.ground.distance,"global"===this.view.viewingMode?T.earthRadius/this.view.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY))&&d.push(k)),[3,5];case 5:return[2,{screenPoint:a,results:d}]}})})};c.prototype._generateViewHandles=function(a){var b=this;return[a.on("immediate-click",function(c){var d=b._operationHandle,f=b.defaultUpdateOptions,g=b.layer,k=b.state,l=b.updateGraphics,m=b.updateOnGraphicClick,d="active"===k&&"create"===d.type;"disabled"!==k&&!d&&m&&(b._beginAsyncOperation(),b._getFirstHit(v.createScreenPointFromEvent(c)).then(function(d){d=
d.results;if(d.length)for(var e=0;e<d.length;++e){var f=d[e];if(f.graphic){f=f.graphic;if(-1<l.indexOf(f)||f.layer===g)return c.stopPropagation(),f;"2d"!==a.type||b._isComponentGraphic(f)||"active"!==k||b.cancel()}}else"active"===k&&b.cancel();return null}).then(function(a){return q.isSome(a)&&-1===l.indexOf(a)?b.update([a],e.__assign({},f)):null}).then(function(){b._endAsyncOperation()}))},S.ViewEventPriorities.WIDGET)]};c.prototype._setupCreateOperation=function(a,b){return e.__awaiter(this,void 0,
void 0,function(){var c,d,f;return e.__generator(this,function(g){switch(g.label){case 0:if(!a)return[2,null];c=e.__assign(e.__assign({hasZ:"3d"===this.view.type,defaultZ:0},this.defaultCreateOptions),b);if("2d"!==this.view.type)return[3,1];switch(a){case "point":d=this._setupCreatePointOperation(a,c);break;case "multipoint":d=this._setupCreateMultipointOperation(a,null);break;case "polygon":d=this._setupCreatePolyOperation(a,c);break;case "polyline":d=this._setupCreatePolyOperation(a,c);break;case "rectangle":d=
this._setupCreateRectangleOperation(a,c);break;case "circle":d=this._setupCreateCircleOperation(a,c)}return[3,3];case 1:return[4,this._setupCreate3DOperation(a,this.view,c)];case 2:f=g.sent();if(q.isNone(f)||X(f))return[2,null];d=f;g.label=3;case 3:return[2,d]}})})};c.prototype._setupCreate3DOperation=function(a,b,c){return e.__awaiter(this,void 0,void 0,function(){var d,f,g,k,l,m,t,r=this;return e.__generator(this,function(v){switch(v.label){case 0:if(!a||"multipoint"===a)return[2,null];d={point:this.pointSymbol,
multipoint:null,polyline:this.polylineSymbol,polygon:this.polygonSymbol,rectangle:this.polygonSymbol,circle:this.polygonSymbol};f=d[a];this._removeCreateOperationGraphics();g=e.__assign(e.__assign(e.__assign({view:b,hasZ:!0,defaultZ:0,mode:"hybrid",elevationInfo:this.layer.elevationInfo,geometryType:a},this.defaultCreateOptions),c),{createGraphicSymbol:f,snapToScene:this._getDefaultSnapToScene(),forceUniformSize:!1,centered:"rectangle"===a?!1:!0});return[4,this._requireModule(new Promise(function(a,
b){u(["../../views/3d/interactive/editingTools"],a,b)}))];case 1:k=v.sent();if(X(k))return[2,k];l=new k.module.DrawGraphicTool(g);this.view.tools.add(l);this.view.activeTool=l;m=[];t=new aa.OperationHandle({activeComponent:l,tool:a,type:"update",onEnd:function(){m.forEach(function(a){return a.remove()});m.length=0;r.view.tools.remove(l);l.destroy()},undo:function(){l.canUndo&&l.undo()},redo:function(){l.canRedo&&l.redo()},canUndo:function(){return l.canUndo},canRedo:function(){return l.canRedo},setSnapToScene:function(a){l.snapToScene=
a}});m.push(this.view.on("key-down",function(b){" "===b.key?(b.stopPropagation(),b.repeat||(l.enabled=!1)):"c"===b.key?(b.stopPropagation(),l.completeCreateOperation()):"z"===b.key?(b.stopPropagation(),t.undo()):"r"===b.key?(b.stopPropagation(),t.redo()):"Control"===b.key?b.repeat||(l.forceUniformSize=!0,b.stopPropagation()):"Alt"!==b.key||b.repeat||(l.centered="rectangle"===a?!0:!1,b.stopPropagation())},S.ViewEventPriorities.WIDGET),this.view.on("key-up",function(b){" "===b.key?l.enabled=!0:"Control"===
b.key?(l.forceUniformSize=!1,b.stopPropagation()):"Alt"===b.key&&(l.centered="rectangle"===a?!1:!0,b.stopPropagation())},S.ViewEventPriorities.WIDGET),l.on("vertex-add",function(b){switch(b.operation){case "apply":r.emit("create",{graphic:q.unwrap(l.createGraphic),state:"active",tool:r.activeTool,toolEventInfo:b,type:"create"});break;case "undo":r._emitUndoEvent({graphics:[q.unwrap(l.createGraphic)],tool:a});break;case "redo":r._emitRedoEvent({graphics:[q.unwrap(l.createGraphic)],tool:a})}}),l.on("cursor-update",
function(a){r.emit("create",{graphic:q.unwrap(l.createGraphic),state:"active",tool:r.activeTool,toolEventInfo:{coordinates:a.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),l.on("vertex-remove",function(b){switch(b.operation){case "apply":r.emit("create",{graphic:q.unwrap(l.createGraphic),state:"active",tool:r.activeTool,toolEventInfo:b,type:"create"});break;case "undo":r._emitUndoEvent({graphics:[q.unwrap(l.createGraphic)],tool:a});break;case "redo":r._emitRedoEvent({graphics:[q.unwrap(l.createGraphic)],
tool:a})}}),l.on("complete",function(a){r._removeCreateOperationGraphics();var b=q.isSome(a.graphic);q.isSome(a.graphic)&&r._set("createGraphic",a.graphic);b?t&&t.complete():t&&t.cancel()}));return[2,t]}})})};c.prototype._setupCreatePointOperation=function(a,b){var c=this;b=this._draw.create(a,{elevationInfo:this.layer.elevationInfo,hasZ:b.hasZ,defaultZ:b.defaultZ,interactiveUndoDisabled:!0});var d=[b.on("cursor-update",function(a){q.isSome(a.vertexIndex)?c._displayCrosshairCursor():c._displayDefaultCursor()}),
b.on("draw-complete",function(a){a=c.createPointFromVertex(a.vertices[0]);a=new m(a,c.pointSymbol);c._set("createGraphic",a);g&&g.complete()})],f=[this.view.on("key-down",function(a){"Escape"===a.key&&(g&&g.cancel(),a.stopPropagation())},S.ViewEventPriorities.WIDGET)],g=this._operationHandleForCreateAction(b,e.__spreadArrays(d,f),a);return g};c.prototype._setupCreateMultipointOperation=function(a,b){var c=this;b=e.__assign(e.__assign({},b),{undoDisabled:!0});b=this._draw.create(a,b);var d=null,f=
[],g=this._operationHandleForCreateAction(b,f,a);f.push(b.on("vertex-add",function(b){var e=b.type,f=b.vertexIndex,g=b.vertices,k=g[f];d=b;c._drawMultipointGraphic(g,!0);c.emit("create",{graphic:c.createGraphic,state:1===g.length?"start":"active",tool:a,toolEventInfo:{added:k,vertices:[{coordinates:k,componentIndex:0,vertexIndex:f}],type:e},type:"create"})}),b.on("vertex-remove",function(b){var e=b.type,f=b.vertexIndex,g=b.vertices,k=g[f];d=b;c._drawMultipointGraphic(g,!0);c.emit("create",{graphic:c.createGraphic,
state:"active",tool:a,toolEventInfo:{removed:k,vertices:[{coordinates:k,componentIndex:0,vertexIndex:f}],type:e},type:"create"})}),b.on("vertex-update",function(b){var e=b.type,f=b.vertexIndex,g=b.vertices,k=g[f];d=b;c._drawMultipointGraphic(g,!0);c.emit("create",{graphic:c.createGraphic,state:"active",tool:a,toolEventInfo:{type:e,updated:k,vertices:[{coordinates:k,componentIndex:0,vertexIndex:f}]},type:"create"})}),b.on("cursor-update",function(a){d=a}),b.on("draw-complete",function(a){a=a.vertices.slice(0);
(a=L.createMultipoint(a,c.view.spatialReference))&&c.createGraphic&&(c.createGraphic.geometry=a);g&&g.complete()}),b.on("undo",function(a){a=a.vertices;var b=d&&"cursor-update"!==d.type;c._resetCreateOperationGraphics();a.length&&c._drawMultipointGraphic(a,b)}),b.on("redo",function(a){a=a.vertices;var b=d&&"cursor-update"!==d.type;c._resetCreateOperationGraphics();a.length&&c._drawMultipointGraphic(a,b)}));f.push(this.view.on("pointer-move",function(){return c._displayCrosshairCursor()},S.ViewEventPriorities.WIDGET),
this.view.on("key-down",function(a){return c._getCommonUpdateOperationKeyDownHandlers(g,a)},S.ViewEventPriorities.WIDGET));return g};c.prototype._getDefaultSnapToScene=function(){if("2d"===this.view.type)return!1;var a=null;return a=q.isSome(this.snapToScene)?this.snapToScene:q.isSome(this.layer.elevationInfo)?"absolute-height"===this.layer.elevationInfo.mode:!0};c.prototype._setupCreatePolyOperation=function(a,b){var c=this;b=e.__assign(e.__assign({},b),{elevationInfo:this.layer.elevationInfo,interactiveUndoDisabled:!0});
var d=null;"polyline"===a?d=this._draw.create(a,b):"polygon"===a&&(d=this._draw.create(a,b));var f=new r.Point,g=null,k=!1;b=[d.on("vertex-add",function(b){var d=b.type,e=b.vertexIndex,f=b.vertices,l=f[e];c._snap(a,f,k);g=b;c._drawVertexGraphics(a,f,{userClicked:!0});c.emit("create",{graphic:c.createGraphic,state:1===f.length?"start":"active",tool:a,toolEventInfo:{added:l,vertices:[{coordinates:l,componentIndex:0,vertexIndex:e}],type:d},type:"create"})}),d.on("vertex-remove",function(b){var d=b.type,
e=b.vertexIndex,f=b.vertices,l=f[e];c._snap(a,f,k);g=b;c._drawVertexGraphics(a,f,{userClicked:!0});c.emit("create",{graphic:c.createGraphic,state:"active",tool:a,toolEventInfo:{removed:l,vertices:[{coordinates:l,componentIndex:0,vertexIndex:e}],type:d},type:"create"})}),d.on("vertex-update",function(b){var d=b.type,e=b.vertexIndex,f=b.vertices,l=f[e];c._snap(a,f,k);g=b;c._drawVertexGraphics(a,f,{userClicked:!0});c.emit("create",{graphic:c.createGraphic,state:"active",tool:a,toolEventInfo:{type:d,
updated:l,vertices:[{coordinates:l,componentIndex:0,vertexIndex:e}]},type:"create"})}),d.on("cursor-update",function(b){var d=b.type,e=b.vertices;b.mapPoint&&(c._snap(a,e,k),g=b,f=b.mapPoint,c._drawVertexGraphics(a,e,{userClicked:!1}),1<e.length&&c.emit("create",{graphic:c.createGraphic,state:"active",tool:a,toolEventInfo:{coordinates:e[e.length-1],type:d},type:"create"}))}),d.on("draw-complete",function(b){b=b.vertices.slice(0);var d=null;"polyline"===a?d=L.createPolyline([b],c.view.spatialReference,
c._doUnnormalization):"polygon"===a&&(d=L.createPolygon([b],c.view.spatialReference,c._doUnnormalization,!0));d&&(c.createGraphic.geometry=d);t&&t.complete()}),d.on("undo",function(b){b=b.vertices;var d=g&&"cursor-update"!==g.type;c._resetCreateOperationGraphics();c._snap(a,b,k);b.length&&c._drawVertexGraphics(a,b,{userClicked:d})}),d.on("redo",function(b){b=b.vertices;var d=g&&"cursor-update"!==g.type;c._resetCreateOperationGraphics();c._snap(a,b,k);b.length&&c._drawVertexGraphics(a,b,{userClicked:d})})];
var l=[this.view.on("pointer-move",function(a){c.view.toMap(v.createScreenPoint(a.x,a.y))?c._displayCrosshairCursor():c._displayDefaultCursor()},S.ViewEventPriorities.WIDGET),this.view.on("key-down",function(b){var e=d.vertices.slice(0),f=g&&"cursor-update"!==g.type;"Control"===b.key?"2d"!==c.view.type||k||(k=!0,c._snap(a,e,!f),c._drawVertexGraphics(a,e,{userClicked:f})):"z"===b.key&&t&&t.canUndo()?(b.stopPropagation(),t.undo()):"r"===b.key&&t&&t.canRedo()?(b.stopPropagation(),t.redo()):"Escape"===
b.key&&t&&t.cancel()},S.ViewEventPriorities.WIDGET),this.view.on("key-up",function(b){var e=d.vertices.slice(0),l=g&&"cursor-update"!==g.type;"Control"===b.key&&k&&(l||(e.pop(),e.push([f.x,f.y]),c._drawVertexGraphics(a,e,{userClicked:l})),k=!1)},S.ViewEventPriorities.WIDGET)];if("polygon"===a){var q=function(a,b,d){if(!a||!a.layer||!a.visible)return!1;a=c.view.toScreen(a.geometry);return c._isWithinScreenDistance(a,b,d)},m=!1;l.push(this.view.on("pointer-move",function(){m=!1},S.ViewEventPriorities.WIDGET),
this.view.on("pointer-down",function(a){var b;b=2>=c._vertexGraphics.length?void 0:q(c._vertexGraphics[0],a,c._getVertexIntersectDistance());b?(m=!0,a.stopPropagation()):c._vertexGraphics.some(function(b){return q(b,a,c._getVertexIntersectDistance())})&&a.stopPropagation()},S.ViewEventPriorities.WIDGET),this.view.on("pointer-up",function(a){m&&(a.stopPropagation(),d.complete())}))}var t=this._operationHandleForCreateAction(d,e.__spreadArrays(b,l),a);return t};c.prototype._setupCreateCircleOperation=
function(a,b){var c=this;b=e.__assign(e.__assign({},b),{elevationInfo:this.layer.elevationInfo,interactiveUndoDisabled:!0});var d=this._draw.create(a,b),f=!1,g=!0;b=[d.on("vertex-add",function(b){var e=b.type,k=b.vertexIndex;b=b.vertices;var l=b[k];c._drawSegmentGraphic(a,b,{centered:g,constrained:f},d.viewAlignedCoordinateSystem);c.emit("create",{graphic:c.createGraphic,state:1===b.length?"start":"active",tool:a,toolEventInfo:{added:l,vertices:[{coordinates:l,componentIndex:0,vertexIndex:k}],type:e},
type:"create"})}),d.on("cursor-update",function(b){var e=b.type;b=b.vertices;c._drawSegmentGraphic(a,b,{centered:g,constrained:f},d.viewAlignedCoordinateSystem);2===b.length&&c.emit("create",{graphic:c.createGraphic,state:"active",tool:a,toolEventInfo:{coordinates:b[b.length-1],type:e},type:"create"})}),d.on("draw-complete",function(a){a=a.vertices.slice(0);var b=null;1===a.length?(a.push(d.viewAlignedCoordinateSystem.makeMapPoint(a[0][0]+c._defaultSegmentOffset*c.view.resolution,a[0][1])),b=L.createCircle(a,
d.viewAlignedCoordinateSystem,!0,c.view.resolution)):b=f?L.createEllipse(a,d.viewAlignedCoordinateSystem,g):L.createCircle(a,d.viewAlignedCoordinateSystem,g,c.view.resolution);c.createGraphic?c.createGraphic.geometry=b:(c._removeCreateGraphic(),c._set("createGraphic",new m(b,c.polygonSymbol)));l&&l.complete()})];var k=[this.view.on("pointer-move",function(a){q.isSome(d.getCoordsFromScreenPoint(v.createScreenPoint(a.x,a.y)))?c._displayCrosshairCursor():c._displayDefaultCursor()},S.ViewEventPriorities.WIDGET),
this.view.on("key-down",function(b){"Control"===b.key?f||(f=!0,c._drawSegmentGraphic(a,d.vertices,{centered:g,constrained:f},d.viewAlignedCoordinateSystem)):"Alt"===b.key?g&&(g=!1,c._drawSegmentGraphic(a,d.vertices,{centered:g,constrained:f},d.viewAlignedCoordinateSystem)):"Escape"===b.key&&l&&l.cancel()},S.ViewEventPriorities.WIDGET),this.view.on("key-up",function(b){"Control"===b.key?(f=!1,c._drawSegmentGraphic(a,d.vertices,{centered:g,constrained:f},d.viewAlignedCoordinateSystem)):"Alt"===b.key&&
(g=!0,c._drawSegmentGraphic(a,d.vertices,{centered:g,constrained:f},d.viewAlignedCoordinateSystem))},S.ViewEventPriorities.WIDGET)],l=this._operationHandleForCreateAction(d,e.__spreadArrays(b,k),a);return l};c.prototype._setupCreateRectangleOperation=function(a,b){var c=this;b=e.__assign(e.__assign({},b),{elevationInfo:this.layer.elevationInfo,interactiveUndoDisabled:!0});var d=this._draw.create(a,b),f=!1,g=!1;b=[d.on("vertex-add",function(b){var e=b.type,k=b.vertexIndex;b=b.vertices;var l=b[k];c._drawSegmentGraphic(a,
b,{centered:g,constrained:f},d.viewAlignedCoordinateSystem);c.emit("create",{graphic:c.createGraphic,state:1===b.length?"start":"active",tool:a,toolEventInfo:{added:l,vertices:[{coordinates:l,componentIndex:0,vertexIndex:k}],type:e},type:"create"})}),d.on("cursor-update",function(b){var e=b.type;b=b.vertices;c._drawSegmentGraphic(a,b,{centered:g,constrained:f},d.viewAlignedCoordinateSystem);2===b.length&&c.emit("create",{graphic:c.createGraphic,state:"active",tool:a,toolEventInfo:{coordinates:b[b.length-
1],type:e},type:"create"})}),d.on("draw-complete",function(a){a=a.vertices.slice(0);var b=null;1===a.length&&(g=f=!1);b=f?L.createSquare(a,d.viewAlignedCoordinateSystem,g):L.createRectangle(a,d.viewAlignedCoordinateSystem,g);c.createGraphic?c.createGraphic.geometry=b:(c._removeCreateGraphic(),c._set("createGraphic",new m(b,c.polygonSymbol)));l&&l.complete()})];var k=[this.view.on("pointer-move",function(a){q.isSome(d.getCoordsFromScreenPoint(v.createScreenPoint(a.x,a.y)))?c._displayCrosshairCursor():
c._displayDefaultCursor()},S.ViewEventPriorities.WIDGET),this.view.on("key-down",function(b){"Control"===b.key?f||(f=!0,c._drawSegmentGraphic(a,d.vertices,{centered:g,constrained:f},d.viewAlignedCoordinateSystem)):"Alt"===b.key?g||(g=!0,c._drawSegmentGraphic(a,d.vertices,{centered:g,constrained:f},d.viewAlignedCoordinateSystem)):"Escape"===b.key&&l&&l.cancel()},S.ViewEventPriorities.WIDGET),this.view.on("key-up",function(b){"Control"===b.key?(f=!1,c._drawSegmentGraphic(a,d.vertices,{centered:g,constrained:f},
d.viewAlignedCoordinateSystem)):"Alt"===b.key&&(g=!1,c._drawSegmentGraphic(a,d.vertices,{centered:g,constrained:f},d.viewAlignedCoordinateSystem))},S.ViewEventPriorities.WIDGET)],l=this._operationHandleForCreateAction(d,e.__spreadArrays(b,k),a);return l};c.prototype._setupUpdateOperation=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d,f,g,k,l,m,t,r,v,x,u;return e.__generator(this,function(z){c=this;d=c._defaultUpdateTool;f=c.defaultUpdateOptions;g=c.layer;k=c.view;l=e.__assign(e.__assign({},
f),b);m=l.tool||d;t=0;for(r=a;t<r.length;t++)v=r[t],g.remove(v),g.add(v);if("3d"===k.type){if(0===a.length)return[2,null];switch(m){case "move":return[2,this._setupMove3DOperation(a,l,k,m)];case "reshape":if(1<a.length)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),[2,null];x=M.isSupportedGraphic(a[0]);if(0===x)return[2,this._setupReshape3DOperation(a[0],l,k)];this._logError("sketch:reshape","Reshape operation not supported for provided graphic(s) ("+
G.isSupportedGraphicResultMessage(x)+").");return[2,null];case "transform":return 1===a.length&&0===R.isSupportedGraphic(a[0])?[2,this._setupPointTransform3DOperation(a[0],l,k)]:[2,this._setupMove3DOperation(a,l,k,m)]}}if("move"===m)return[2,this._setupMoveOperation(a,l,k)];if(1<a.length)return"reshape"===m?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),[2,null]):[2,this._setupTransformOrReshapeOperation(a,m,l,k)];if(1===a.length){v=a[0];u=q.get(v.geometry,
"type");if("point"===u||"multipoint"===u)return[2,this._setupMoveOperation(a,l,k)];if("transform"===m||"reshape"===m)return[2,this._setupTransformOrReshapeOperation(a,m,l,k)]}return[2,null]})})};c.prototype._setupMove3DOperation=function(a,b,c,d,f){void 0===f&&(f=!1);return e.__awaiter(this,void 0,void 0,function(){var g,k,l,m,q,t,r,v,x=this;return e.__generator(this,function(z){switch(z.label){case 0:g=0;for(k=a;g<k.length;g++)if(l=k[g],m=F.isSupportedGraphic(l),0!==m)return this._logError("sketch:move",
"Move operation not supported for provided graphic(s) ("+G.isSupportedGraphicResultMessage(m)+")."),[2,null];return[4,this._requireModule(new Promise(function(a,b){u(["../../views/3d/interactive/editingTools"],a,b)}))];case 1:q=z.sent();if(X(q))return[2,q];t=new q.module.GraphicMoveTool({view:c,enableZ:b.enableZ});this.view.tools.add(t);t.graphics.addMany(a);f||this.updateGraphics.addMany(a);r=[];v=new aa.OperationHandle({activeComponent:t,tool:d,type:"update",onEnd:function(){r.forEach(function(a){return a.remove()});
r.length=0;x.view.tools.remove(t);t.destroyed||t.destroy()},undo:function(){ba(v,x.updateGraphics.toArray());x._emitUndoEvent({graphics:x.updateGraphics.toArray(),tool:d})},redo:function(){V(v,x.updateGraphics.toArray());x._emitRedoEvent({graphics:x.updateGraphics.toArray(),tool:d})},addToSelection:function(a){x.updateGraphics.push(a);t.graphics.push(a);x.emit("update",{graphics:x.updateGraphics.toArray(),state:"active",aborted:!1,tool:x.activeTool,toolEventInfo:{added:[a],type:"selection-change"},
type:"update"})},removeFromSelection:function(a){var b=x.updateGraphics.indexOf(a);v.history.undo.forEach(function(a){return a.updates.splice(b,1)});v.history.redo.forEach(function(a){return a.updates.splice(b,1)});x.updateGraphics.remove(a);0===x.updateGraphics.length?v.complete():t.graphics.remove(a)},toggleTool:function(){return e.__awaiter(x,void 0,void 0,function(){var a,f;return e.__generator(this,function(e){switch(e.label){case 0:if(1!==this.updateGraphics.length||!1===b.toggleToolOnClick||
"transform"!==d)return[2];a=this.updateGraphics.getItemAt(0);return 0!==M.isSupportedGraphic(a)?[2]:[4,this._setupReshape3DOperation(a,b,c,!0)];case 1:f=e.sent();if(X(f))return[2];v.onEnd();v.destroy();this._setUpdateOperationHandle(f);return[2]}})})}});r.push.apply(r,e.__spreadArrays(this._getHandlesForComponent(v,b),[this.view.on("immediate-click",function(a){return x._getCommonUpdateOperationClickHandlers(v,a)},S.ViewEventPriorities.WIDGET),this.view.on("key-down",function(a){return x._getCommonUpdateOperationKeyDownHandlers(v,
a)},S.ViewEventPriorities.WIDGET)]));return[2,v]}})})};c.prototype._setupPointTransform3DOperation=function(a,b,c){return e.__awaiter(this,void 0,void 0,function(){var d,f,g,k,l,m,q,t,r=this;return e.__generator(this,function(v){switch(v.label){case 0:return d="transform",f=b.enableRotation,g=b.enableScaling,k=b.enableZ,[4,this._requireModule(new Promise(function(a,b){u(["../../views/3d/interactive/editingTools"],a,b)}))];case 1:l=v.sent();if(X(l))return[2,l];m=new l.module.GraphicTransformTool({graphic:a,
view:c,enableRotation:f,enableScaling:g,enableZ:k,snapToScene:this.snapToScene});this.view.tools.add(m);this.updateGraphics.add(a);q=[];t=new aa.OperationHandle({activeComponent:m,tool:d,type:"update",onEnd:function(){q.forEach(function(a){return a.remove()});q.length=0;r.view.tools.remove(m);m.destroyed||m.destroy()},undo:function(){ba(t,r.updateGraphics.toArray());r._emitUndoEvent({graphics:r.updateGraphics.toArray(),tool:d})},redo:function(){V(t,r.updateGraphics.toArray());r._emitRedoEvent({graphics:r.updateGraphics.toArray(),
tool:d})},addToSelection:function(a){return e.__awaiter(r,void 0,void 0,function(){var d;return e.__generator(this,function(e){switch(e.label){case 0:return this.updateGraphics.add(a),[4,this._setupMove3DOperation(this.updateGraphics.toArray(),b,c,"transform",!0)];case 1:d=e.sent();if(X(d))return[2];t.onEnd();t.destroy();this._setUpdateOperationHandle(d);return[2]}})})},setSnapToScene:function(a){m.snapToScene=a}});q.push.apply(q,e.__spreadArrays(this._getHandlesForComponent(t,b),[this.view.on("immediate-click",
function(a){return r._getCommonUpdateOperationClickHandlers(t,a)},S.ViewEventPriorities.WIDGET),this.view.on("key-down",function(a){return r._getCommonUpdateOperationKeyDownHandlers(t,a)},S.ViewEventPriorities.WIDGET)]));return[2,t]}})})};c.prototype._setupMoveOperation=function(a,b,c){return e.__awaiter(this,void 0,void 0,function(){var d,f,g,k,l,q,t=this;return e.__generator(this,function(e){switch(e.label){case 0:return d=[],f="move",a.forEach(function(a){d.push(new m(a.geometry,a.symbol,a.attributes));
a.symbol=t._getUpdateSymbol(a.geometry)}),this.updateGraphics.addMany(a),[4,this._getGraphicMover(a,b,c)];case 1:g=e.sent();if(X(g))return[2,g];k=new aa.OperationHandle({activeComponent:g,tool:f,type:"update",onEnd:function(){q.forEach(function(a){return a.remove()});l.forEach(function(a){return a.remove()});q=[];l=[];g.destroy();t._internalGraphicsLayer&&t._internalGraphicsLayer.removeMany(t.updateGraphics.toArray());t.updateGraphics.forEach(function(a,b){a.symbol=d[b].symbol})},undo:function(){ba(k,
t.updateGraphics.toArray());t._emitUndoEvent({graphics:t.updateGraphics.toArray(),tool:f})},redo:function(){V(k,t.updateGraphics.toArray());t._emitRedoEvent({graphics:t.updateGraphics.toArray(),tool:f})},addToSelection:function(a){d.push(new m(a.geometry,a.symbol,a.attributes));a.symbol=t._getUpdateSymbol(a.geometry);t.updateGraphics.push(a);g.graphics=t.updateGraphics.toArray();t.emit("update",{graphics:t.updateGraphics.toArray(),state:"active",aborted:!1,tool:t.activeTool,toolEventInfo:{added:[a],
type:"selection-change"},type:"update"})},removeFromSelection:function(a){var b=t.updateGraphics.indexOf(a);k.history.undo.forEach(function(a){return a.updates.splice(b,1)});k.history.redo.forEach(function(a){return a.updates.splice(b,1)});var c=d.splice(b,1)[0];a.symbol=c.symbol;t.updateGraphics.remove(a);0===t.updateGraphics.length?k.complete():g.graphics=t.updateGraphics.toArray()}});l=[c.on("immediate-click",function(a){return t._getCommonUpdateOperationClickHandlers(k,a,b)},S.ViewEventPriorities.WIDGET),
c.on("key-down",function(a){t._getCommonUpdateOperationKeyDownHandlers(k,a);"Control"!==a.key||a.repeat||(g.enableMoveAllGraphics=!g.enableMoveAllGraphics)},S.ViewEventPriorities.WIDGET),c.on("key-up",function(a){"Control"===a.key&&(g.enableMoveAllGraphics=!g.enableMoveAllGraphics)},S.ViewEventPriorities.WIDGET)];q=this._getHandlesForComponent(k,b);return[2,k]}})})};c.prototype._setupReshape3DOperation=function(a,b,c,d){void 0===d&&(d=!1);return e.__awaiter(this,void 0,void 0,function(){var f,g,k,
l,m,q=this;return e.__generator(this,function(t){switch(t.label){case 0:return f="reshape",[4,this._requireModule(new Promise(function(a,b){u(["../../views/3d/interactive/editingTools"],a,b)}))];case 1:g=t.sent();if(X(g))return[2,g];k=new g.module.GraphicReshapeTool({view:c,graphic:a,enableZ:b.enableZ});c.tools.add(k);d||this.updateGraphics.add(a);l=[];m=new aa.OperationHandle({activeComponent:k,tool:f,type:"update",onEnd:function(){l.forEach(function(a){return a.remove()});l.length=0;c.tools.remove(k);
k.destroyed||k.destroy()},undo:function(){ba(m,q.updateGraphics.toArray());q._emitUndoEvent({graphics:q.updateGraphics.toArray(),tool:f})},redo:function(){V(m,q.updateGraphics.toArray());q._emitRedoEvent({graphics:q.updateGraphics.toArray(),tool:f})},addToSelection:function(a){return e.__awaiter(q,void 0,void 0,function(){var d;return e.__generator(this,function(e){switch(e.label){case 0:return this.updateGraphics.add(a),[4,this._setupMove3DOperation(this.updateGraphics.toArray(),b,c,"transform",
!0)];case 1:d=e.sent();if(X(d))return[2];m.onEnd();m.destroy();this._setUpdateOperationHandle(d);return[2]}})})},toggleTool:function(){return e.__awaiter(q,void 0,void 0,function(){var a;return e.__generator(this,function(d){switch(d.label){case 0:return!1===b.toggleToolOnClick?[2]:[4,this._setupMove3DOperation(this.updateGraphics.toArray(),b,c,"transform",!0)];case 1:a=d.sent();if(X(a))return[2];m.onEnd();m.destroy();this._setUpdateOperationHandle(a);return[2]}})})}});l.push.apply(l,e.__spreadArrays(this._getHandlesForComponent(m,
b),[c.on("immediate-click",function(a){return q._getCommonUpdateOperationClickHandlers(m,a)},S.ViewEventPriorities.WIDGET),c.on("key-down",function(a){return q._getCommonUpdateOperationKeyDownHandlers(m,a)},S.ViewEventPriorities.WIDGET)]));return[2,m]}})})};c.prototype._setupTransformOrReshapeOperation=function(a,b,c,d){return e.__awaiter(this,void 0,void 0,function(){var f,g,k,l,t,r,x,u,z,A,B=this;return e.__generator(this,function(E){switch(E.label){case 0:return f=c.multipleSelectionEnabled,g=
void 0===f?!0:f,k=c.toggleToolOnClick,l=void 0===k?!0:k,t=[],a.forEach(function(a){t.push(new m(a.geometry,a.symbol,a.attributes));a.symbol=B._getUpdateSymbol(a.geometry)}),this.updateGraphics.addMany(a),"transform"!==b?[3,2]:[4,this._getBox(a,c,d)];case 1:return x=E.sent(),[3,4];case 2:return[4,this._getReshape(a,c,d)];case 3:x=E.sent(),E.label=4;case 4:r=x;if(X(r))return[2,r];u=new aa.OperationHandle({activeComponent:r,type:"update",onEnd:function(){A.forEach(function(a){return a.remove()});z.forEach(function(a){return a.remove()});
A=[];z=[];u.activeComponent&&!u.activeComponent.destroyed&&u.activeComponent.destroy();B._internalGraphicsLayer.removeMany(B.updateGraphics.toArray());B.updateGraphics.forEach(function(a,b){t[b]&&t[b].symbol&&(a.symbol=t[b].symbol)})},undo:function(){ba(u,B.updateGraphics.toArray());u.refreshComponent();B._emitUndoEvent({graphics:B.updateGraphics.toArray(),tool:u.tool})},redo:function(){V(u,B.updateGraphics.toArray());u.refreshComponent();B._emitRedoEvent({graphics:B.updateGraphics.toArray(),tool:u.tool})},
addToSelection:function(a){var b=u.activeComponent;t.push(new m(a.geometry,a.symbol,a.attributes));a.symbol=B._getUpdateSymbol(a.geometry);B.updateGraphics.add(a);b.graphics=B.updateGraphics.toArray();b.refresh();u.resetHistory();B.emit("update",{graphics:B.updateGraphics.toArray(),state:"active",aborted:!1,tool:B.activeTool,toolEventInfo:{added:[a],type:"selection-change"},type:"update"})},removeFromSelection:function(a){var b=u.activeComponent,c=B.updateGraphics.indexOf(a);u.history.undo.forEach(function(a){return a.updates.splice(c,
1)});u.history.redo.forEach(function(a){return a.updates.splice(c,1)});var d=t.splice(c,1)[0];a.symbol=d.symbol;B.updateGraphics.remove(a);0===B.updateGraphics.length?u.complete():b.graphics=B.updateGraphics.toArray()},toggleTool:function(){return e.__awaiter(B,void 0,void 0,function(){var b;return e.__generator(this,function(e){switch(e.label){case 0:if(1<this.updateGraphics.length)return[2];b=null;return"transform"!==u.tool?[3,2]:[4,this._getReshape(a,c,d)];case 1:return b=e.sent(),[3,4];case 2:return"reshape"!==
u.tool?[3,4]:[4,this._getBox(a,c,d)];case 3:b=e.sent(),e.label=4;case 4:if(X(b))return[2];u.activeComponent.destroy();u.activeComponent=b;u.activeComponent&&(A.forEach(function(a){return a.remove()}),A=this._getHandlesForComponent(u,c));return[2]}})})}});z=[d.on("immediate-click",function(a){B._getFirstHit(v.createScreenPointFromEvent(a)).then(function(b){if(u)if(b=b.results,b.length){var c=u.activeComponent,d=a.native&&a.native.shiftKey;b.some(function(a){if(a.graphic){a=a.graphic;if(g&&d&&c&&"box"===
c.type&&!c.isUIGraphic(a))return u.addToSelection(a),!0;if(c&&"box"===c.type&&c.isUIGraphic(a))return!1!==l&&1===B.updateGraphics.length&&(a=B.updateGraphics.getItemAt(0).geometry,"extent"===q.get(a,"type")?B._logError("sketch:reshape-extent","Reshape operation does not support graphics with geometry of type 'extent'."):u.toggleTool()),!0;if(c&&"reshape"===c.type){if(a===c.graphic)return!1!==l&&u.toggleTool(),!0;if(c.isUIGraphic(a)||a.layer===B._internalGraphicsLayer)return!0}else a.layer===B.layer&&
u.complete()}return!1})&&a.stopPropagation()}else u.complete()})},S.ViewEventPriorities.WIDGET),d.on("key-down",function(a){B._getCommonUpdateOperationKeyDownHandlers(u,a);"Control"===a.key&&!a.repeat&&u&&(a=u.activeComponent)&&"box"===a.type&&(a.preserveAspectRatio=!a.preserveAspectRatio)},S.ViewEventPriorities.WIDGET),d.on("key-up",function(a){"Control"===a.key&&u&&(a=u.activeComponent)&&"box"===a.type&&(a.preserveAspectRatio=!a.preserveAspectRatio)},S.ViewEventPriorities.WIDGET)];A=this._getHandlesForComponent(u,
c);return[2,u]}})})};c.prototype._getGraphicMover=function(a,b,c){return e.__awaiter(this,void 0,void 0,function(){var d,f,g,k=this;return e.__generator(this,function(e){switch(e.label){case 0:return d=b.enableMoveAllGraphics,f=void 0===d?!0:d,[4,this._requireModule(new Promise(function(a,b){u(["../../views/draw/support/GraphicMover"],a,b)}))];case 1:return g=e.sent(),X(g)?[2,g]:[2,new g.module({enableMoveAllGraphics:f,graphics:a,view:c,callbacks:{onGraphicMoveStart:function(a){var b=a.dx,c=a.dy;
a=a.graphic;return k.emit("update",{graphics:k.updateGraphics.toArray(),state:"active",aborted:!1,tool:k.activeTool,toolEventInfo:{dx:b,dy:c,mover:a,type:"move-start"},type:"update"})},onGraphicMove:function(a){var b=a.dx,c=a.dy;a=a.graphic;return k.emit("update",{graphics:k.updateGraphics.toArray(),state:"active",aborted:!1,tool:k.activeTool,toolEventInfo:{dx:b,dy:c,mover:a,type:"move"},type:"update"})},onGraphicMoveStop:function(a){var b=a.dx,c=a.dy;a=a.graphic;return k.emit("update",{graphics:k.updateGraphics.toArray(),
state:"active",aborted:!1,tool:k.activeTool,toolEventInfo:{dx:b,dy:c,mover:a,type:"move-stop"},type:"update"})},onGraphicPointerOver:function(){return k._displayDefaultCursor()},onGraphicPointerOut:function(){return k._displayDefaultCursor()}}})]}})})};c.prototype._getBox=function(a,b,c){return e.__awaiter(this,void 0,void 0,function(){var d,f,g,k,l,m,q,t=this;return e.__generator(this,function(r){switch(r.label){case 0:return d=b.enableRotation,f=void 0===d?!0:d,g=b.enableScaling,k=void 0===g?!0:
g,l=b.preserveAspectRatio,m=void 0===l?!1:l,[4,this._requireModule(new Promise(function(a,b){u(["../../views/draw/support/Box"],a,b)}))];case 1:return q=r.sent(),X(q)?[2,q]:[2,new q.module({graphics:a,enableRotation:f,enableScaling:k,preserveAspectRatio:m,layer:this._internalGraphicsLayer,view:c,callbacks:{onMoveStart:function(a){return t.emit("update",{graphics:t.updateGraphics.toArray(),state:"active",aborted:!1,tool:t.activeTool,toolEventInfo:e.__assign({},a),type:"update"})},onMove:function(a){return t.emit("update",
{graphics:t.updateGraphics.toArray(),state:"active",aborted:!1,tool:t.activeTool,toolEventInfo:e.__assign({},a),type:"update"})},onMoveStop:function(a){return t.emit("update",{graphics:t.updateGraphics.toArray(),state:"active",aborted:!1,tool:t.activeTool,toolEventInfo:e.__assign({},a),type:"update"})},onScaleStart:function(a){return t.emit("update",{graphics:t.updateGraphics.toArray(),state:"active",aborted:!1,tool:t.activeTool,toolEventInfo:e.__assign({},a),type:"update"})},onScale:function(a){return t.emit("update",
{graphics:t.updateGraphics.toArray(),state:"active",aborted:!1,tool:t.activeTool,toolEventInfo:e.__assign({},a),type:"update"})},onScaleStop:function(a){return t.emit("update",{graphics:t.updateGraphics.toArray(),state:"active",aborted:!1,tool:t.activeTool,toolEventInfo:e.__assign({},a),type:"update"})},onRotateStart:function(a){return t.emit("update",{graphics:t.updateGraphics.toArray(),state:"active",aborted:!1,tool:t.activeTool,toolEventInfo:e.__assign({},a),type:"update"})},onRotate:function(a){return t.emit("update",
{graphics:t.updateGraphics.toArray(),state:"active",aborted:!1,tool:t.activeTool,toolEventInfo:e.__assign({},a),type:"update"})},onRotateStop:function(a){return t.emit("update",{graphics:t.updateGraphics.toArray(),state:"active",aborted:!1,tool:t.activeTool,toolEventInfo:e.__assign({},a),type:"update"})}}})]}})})};c.prototype._getReshape=function(a,b,c){return e.__awaiter(this,void 0,void 0,function(){var d,f,g,k=this;return e.__generator(this,function(l){switch(l.label){case 0:return d=b.enableMidpoints,
f=void 0===d?!0:d,[4,this._requireModule(new Promise(function(a,b){u(["../../views/draw/support/Reshape"],a,b)}))];case 1:return g=l.sent(),X(g)?[2,g]:[2,new g.module({enableMidpoints:f,graphic:a[0],layer:this._internalGraphicsLayer,view:c,callbacks:{onReshapeStart:function(a){return k.emit("update",{graphics:k.updateGraphics.toArray(),state:"active",aborted:!1,tool:k.activeTool,toolEventInfo:e.__assign({},a),type:"update"})},onReshape:function(a){return k.emit("update",{graphics:k.updateGraphics.toArray(),
state:"active",aborted:!1,tool:k.activeTool,toolEventInfo:e.__assign({},a),type:"update"})},onReshapeStop:function(a){var b=a.mover;a=a.type;return k.emit("update",{graphics:k.updateGraphics.toArray(),state:"active",aborted:!1,tool:k.activeTool,toolEventInfo:{mover:b,type:a},type:"update"})},onMoveStart:function(a){var b=a.dx,c=a.dy,d=a.mover;a=a.type;return k.emit("update",{graphics:k.updateGraphics.toArray(),state:"active",aborted:!1,tool:k.activeTool,toolEventInfo:{dx:b,dy:c,mover:d,type:a},type:"update"})},
onMove:function(a){var b=a.dx,c=a.dy,d=a.mover;a=a.type;return k.emit("update",{graphics:k.updateGraphics.toArray(),state:"active",aborted:!1,tool:k.activeTool,toolEventInfo:{dx:b,dy:c,mover:d,type:a},type:"update"})},onMoveStop:function(a){var b=a.dx,c=a.dy,d=a.mover;a=a.type;return k.emit("update",{graphics:k.updateGraphics.toArray(),state:"active",aborted:!1,tool:k.activeTool,toolEventInfo:{dx:b,dy:c,mover:d,type:a},type:"update"})},onVertexAdd:function(a){var b=a.type,c=a.vertices;a=a.added.map(function(a){return z.geometryToCoordinates(a.geometry)});
k.emit("update",{graphics:k.updateGraphics.toArray(),state:"active",aborted:!1,tool:k.activeTool,toolEventInfo:{added:a,vertices:c,type:b},type:"update"})},onVertexRemove:function(a){var b=a.type,c=a.vertices;a=a.removed.map(function(a){return z.geometryToCoordinates(a.geometry)});k.emit("update",{graphics:k.updateGraphics.toArray(),state:"active",aborted:!1,tool:k.activeTool,toolEventInfo:{removed:a,vertices:c,type:b},type:"update"})}}})]}})})};c.prototype._getHandlesForComponent=function(a,b){var c=
this,d=a.activeComponent;switch(d.type){case "graphic-mover":return[d.on("graphic-move-start",function(b){return a.addToHistory(Z(b.allGraphics))})];case "box":return[d.on("move-start",function(b){return a.addToHistory(Z(b.graphics))}),d.on("rotate-start",function(b){return a.addToHistory(Z(b.graphics))}),d.on("scale-start",function(b){return a.addToHistory(Z(b.graphics))})];case "reshape":return[d.on("move-start",function(b){return a.addToHistory(Z([b.mover]))}),d.on("reshape-start",function(b){return a.addToHistory(Z([b.graphic]))}),
d.on("vertex-add",function(b){return a.addToHistory(Z([b.oldGraphic]))}),d.on("vertex-remove",function(b){return a.addToHistory(Z([b.oldGraphic]))})];case "move-3d":return[d.on("graphic-move-start",function(b){a.addToHistory(Z(b.allGraphics));c.emit("update",{graphics:c.updateGraphics.toArray(),state:"active",aborted:!1,tool:c.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<b.allGraphics.length?b.allGraphics[0]:null,type:"move-start"},type:"update"})}),d.on("graphic-move",function(a){c.emit("update",
{graphics:c.updateGraphics.toArray(),state:"active",aborted:!1,tool:c.activeTool,toolEventInfo:{dx:a.dx,dy:a.dy,mover:0<a.allGraphics.length?a.allGraphics[0]:null,type:"move"},type:"update"})}),d.on("graphic-move-stop",function(a){c.emit("update",{graphics:c.updateGraphics.toArray(),state:"active",aborted:!1,tool:c.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<a.allGraphics.length?a.allGraphics[0]:null,type:"move-stop"},type:"update"})}),d.on("immediate-click",function(d){d.shiftKey?c._toggleSelection([d.graphic],
a,b):a.toggleTool()})];case "transform-3d":return[d.on("graphic-translate-start",function(b){a.addToHistory(Z([b.graphic]));c.emit("update",{graphics:c.updateGraphics.toArray(),state:"active",aborted:!1,tool:c.activeTool,toolEventInfo:{mover:b.graphic,dx:b.dxScreen,dy:b.dyScreen,type:"move-start"},type:"update"})}),d.on("graphic-translate-stop",function(a){c.emit("update",{graphics:c.updateGraphics.toArray(),state:"active",aborted:!1,tool:c.activeTool,toolEventInfo:{mover:a.graphic,dx:a.dxScreen,
dy:a.dyScreen,type:"move-stop"},type:"update"})}),d.on("graphic-rotate-start",function(b){a.addToHistory(ha([b.graphic]));c.emit("update",{graphics:c.updateGraphics.toArray(),state:"active",aborted:!1,tool:c.activeTool,toolEventInfo:{mover:b.graphic,angle:b.angle,type:"rotate-start"},type:"update"})}),d.on("graphic-rotate-stop",function(a){c.emit("update",{graphics:c.updateGraphics.toArray(),state:"active",aborted:!1,tool:c.activeTool,toolEventInfo:{mover:a.graphic,angle:a.angle,type:"rotate-stop"},
type:"update"})}),d.on("graphic-scale-start",function(b){a.addToHistory(ha([b.graphic]));c.emit("update",{graphics:c.updateGraphics.toArray(),state:"active",aborted:!1,tool:c.activeTool,toolEventInfo:{mover:b.graphic,xScale:b.scale,yScale:b.scale,type:"scale-start"},type:"update"})}),d.on("graphic-scale-stop",function(a){c.emit("update",{graphics:c.updateGraphics.toArray(),state:"active",aborted:!1,tool:c.activeTool,toolEventInfo:{mover:a.graphic,xScale:a.scale,yScale:a.scale,type:"scale-stop"},type:"update"})}),
d.on("graphic-translate",function(a){c.emit("update",{graphics:c.updateGraphics.toArray(),state:"active",aborted:!1,tool:c.activeTool,toolEventInfo:{mover:a.graphic,dx:a.dxScreen,dy:a.dyScreen,type:"move"},type:"update"})}),d.on("graphic-rotate",function(a){c.emit("update",{graphics:c.updateGraphics.toArray(),state:"active",aborted:!1,tool:c.activeTool,toolEventInfo:{mover:a.graphic,angle:a.angle,type:"rotate"},type:"update"})}),d.on("graphic-scale",function(a){c.emit("update",{graphics:c.updateGraphics.toArray(),
state:"active",aborted:!1,tool:c.activeTool,toolEventInfo:{mover:a.graphic,xScale:a.scale,yScale:a.scale,type:"scale"},type:"update"})})];case "reshape-3d":return[d.on("reshape",function(b){"reshape-start"===b.type&&a.addToHistory(Z([b.mover]));c.emit("update",{graphics:c.updateGraphics.toArray(),state:"active",aborted:!1,tool:c.activeTool,toolEventInfo:b,type:"update"})}),d.on("move",function(b){"move-start"===b.type&&a.addToHistory(Z([b.mover]));c.emit("update",{graphics:c.updateGraphics.toArray(),
state:"active",aborted:!1,tool:c.activeTool,toolEventInfo:b,type:"update"})}),d.on("vertex-add",function(a){c.emit("update",{graphics:c.updateGraphics.toArray(),state:"active",aborted:!1,tool:c.activeTool,toolEventInfo:a,type:"update"})}),d.on("vertex-remove",function(a){c.emit("update",{graphics:c.updateGraphics.toArray(),state:"active",aborted:!1,tool:c.activeTool,toolEventInfo:a,type:"update"})}),d.on("immediate-click",function(){return a.toggleTool()})];case "draw":return null;default:k.neverReached(d)}};
c.prototype._setUpdateOperationHandle=function(a){var b=this;this._operationHandle=a;var c=this.view,d=c.map,e=c.popup,f=!0;e&&(f=e.autoOpenEnabled,e.autoOpenEnabled=!1);a.on("complete",function(){if(a===b._operationHandle){var c=b.updateGraphics.toArray(),g=b._operationHandle.tool;b._operationHandle.destroy();b._operationHandle=null;b._internalGraphicsLayer.removeMany(b.updateGraphics.toArray());b.updateGraphics.removeAll();d&&d.remove(b._internalGraphicsLayer);e&&(e.autoOpenEnabled=f);b.emit("update",
{graphics:c,state:"complete",aborted:a.cancelled,tool:g,toolEventInfo:null,type:"update"})}})};c.prototype._getCommonUpdateOperationClickHandlers=function(a,b,c){var d=this,e=v.createScreenPointFromEvent(b);this._getFirstHit(e).then(function(e){e=e.results;e.length?b.native.shiftKey&&d._toggleSelection(e.map(function(a){return a.graphic}),a,c)?b.stopPropagation():e.some(function(a){return a.graphic&&-1<d.updateGraphics.indexOf(a.graphic)})?b.stopPropagation():a.complete():a.complete()})};c.prototype._toggleSelection=
function(a,b,c){var d=this,e=c?!!c.multipleSelectionEnabled:!0;return a.some(function(a){return null==a?!1:e&&a.layer===d.layer?(-1===d.updateGraphics.indexOf(a)?b.addToSelection(a):b.removeFromSelection(a),!0):!1})};c.prototype._getCommonUpdateOperationKeyDownHandlers=function(a,b){if(a){var c=b.key;"z"===c&&a.canUndo()?(b.stopPropagation(),a.undo()):"r"===c&&a.canRedo()?(b.stopPropagation(),a.redo()):"Escape"===c?(b.stopPropagation(),a.cancel()):0<=ga.indexOf(c)&&this._onDeleteKey(b)}};c.prototype._onDeleteKey=
function(a){if(this._operationHandle&&"update"===this._operationHandle.type){var b=this.activeComponent;b&&"reshape"!==b.type&&"reshape-3d"!==b.type&&(a.stopPropagation(),a=this.updateGraphics.toArray(),this.layer.removeMany(a),this._emitDeleteEvent({graphics:a,tool:this.activeTool}))}};c.prototype._getCreateSymbol=function(a,b){void 0===b&&(b=!1);b="3d"!==this.view.type&&b;switch(a.type){case "point":case "multipoint":return b?this.activePointSymbol:this.pointSymbol;case "polyline":return b?this.activeLineSymbol:
this.polylineSymbol;case "polygon":return b?this.activeFillSymbol:this.polygonSymbol}return null};c.prototype._getUpdateSymbol=function(a){if(q.isNone(a))return null;switch(a.type){case "point":case "multipoint":return this.updatePointSymbol;case "polyline":return this.updatePolylineSymbol;case "polygon":case "extent":return this.updatePolygonSymbol}return null};c.prototype._drawMultipointGraphic=function(a,b){var c=null;!b&&1<a.length?(c=a.slice(0),c.pop(),c=L.createMultipoint(c,this.view.spatialReference)):
c=L.createMultipoint(a,this.view.spatialReference);this.createGraphic?this.createGraphic.geometry=c:this._set("createGraphic",new m(c,this.pointSymbol));b&&1===a.length&&this._internalGraphicsLayer.add(this.createGraphic)};c.prototype._drawVertexGraphics=function(a,b,c){c=!(!c||!c.userClicked);var d="polygon"===a,e=d?this.polygonSymbol:this.polylineSymbol;if(1===b.length){this._removeLineGraphic();this._removeActiveLineGraphic();var f=this.createPointFromVertex(b[0]),d=d?L.createPolygon([b],this.view.spatialReference,
this._doUnnormalization,!0):L.createPolyline([b],this.view.spatialReference,this._doUnnormalization);this._vertexGraphics.length?this._vertexGraphics[0].geometry=f:this._vertexGraphics.push(new m(f,this.activeVertexSymbol));this.createGraphic?this.createGraphic.geometry=d:this._set("createGraphic",new m(d,e));c&&this._internalGraphicsLayer.add(this._vertexGraphics[0])}else if(2===b.length){a=this.createPointFromVertex(b[1]);var g=this.vertexSymbol,e=L.createPolyline([b],this.view.spatialReference,
this._doUnnormalization),d=d?L.createPolygon([b],this.view.spatialReference,this._doUnnormalization,!0):L.createPolyline([b],this.view.spatialReference,this._doUnnormalization);this._vertexGraphics.length||(f=this.createPointFromVertex(b[0]),b=new m(f,g),this._vertexGraphics.push(b));1===this._vertexGraphics.length?(b=this._vertexGraphics[0],a=new m(a,g),this._removeLineGraphic(),this._removeActiveFillGraphic(),this._vertexGraphics.push(a),this._internalGraphicsLayer.remove(b),this._internalGraphicsLayer.add(b)):
this._vertexGraphics[1].geometry=a;this._showActiveLineGraphic(e);b=this._vertexGraphics[0];c&&(this._activeLineGraphic.symbol=this.polylineSymbol,b.symbol=this.vertexSymbol,this._internalGraphicsLayer.add(this._vertexGraphics[1]));this.createGraphic?this.createGraphic.geometry=d:this._set("createGraphic",new m(d,this.polygonSymbol));this._internalGraphicsLayer.remove(b);this._internalGraphicsLayer.add(b)}else if(2<b.length){d=d?L.createPolygon([b],this.view.spatialReference,this._doUnnormalization,
!0):L.createPolyline([b],this.view.spatialReference,this._doUnnormalization);"polygon"===a&&this._showFillGraphic(d);a=b.map(function(a){return a.slice()});g=a.pop();f=[a[a.length-1],g];g=L.createPolyline([a],this.view.spatialReference,this._doUnnormalization);f=L.createPolyline([f],this.view.spatialReference,this._doUnnormalization);this._showLineGraphic(g);this._showActiveLineGraphic(f);for(g=0;g<a.length;g++)(f=this._vertexGraphics[g])?f.symbol=c||g!==this._vertexGraphics.length-1?this.vertexSymbol:
this.activeVertexSymbol:(f=this.createPointFromVertex(b[g]),this._showVertexGraphic(f));c?(this._activeLineGraphic.symbol=this.polylineSymbol,g=b.length-1,f=this.createPointFromVertex(b[g]),this._showVertexGraphic(f)):this._activeLineGraphic.symbol=this.activeLineSymbol;this.createGraphic?this.createGraphic.geometry=d:(this._removeCreateGraphic(),this._set("createGraphic",new m(d,e)));c=0;for(d=this._vertexGraphics;c<d.length;c++)b=d[c],this._internalGraphicsLayer.remove(b),this._internalGraphicsLayer.add(b)}};
c.prototype._drawSegmentGraphic=function(a,b,c,d){if(b.length){var e=!(!c||!c.centered);c=!(!c||!c.constrained);var f=null;1===b.length?this._removeCenterIndicatorGraphic():("rectangle"===a?f=c?L.createSquare(b,d,e):L.createRectangle(b,d,e):"circle"===a&&(f=c?L.createEllipse(b,d,e):L.createCircle(b,d,e,this.view.resolution)),f.extent&&f.extent.center&&this._showCenterIndicatorGraphic(f.extent.center));f?this.createGraphic?this.createGraphic.geometry=f:(this._removeCreateGraphic(),this._set("createGraphic",
new m(f,this.polygonSymbol)),this._internalGraphicsLayer.add(this.createGraphic)):this._removeCreateGraphic()}};c.prototype._showCenterIndicatorGraphic=function(a){this._centerIndicatorGraphic?this._centerIndicatorGraphic.geometry=a:(this._centerIndicatorGraphic=new m(a,this._centerSymbol),this._internalGraphicsLayer.add(this._centerIndicatorGraphic))};c.prototype._removeCenterIndicatorGraphic=function(){this._centerIndicatorGraphic&&(this._internalGraphicsLayer.remove(this._centerIndicatorGraphic),
this._centerIndicatorGraphic.destroy(),this._centerIndicatorGraphic=null)};c.prototype._showActiveLineGraphic=function(a){this._activeLineGraphic?this._activeLineGraphic.geometry=a:(this._activeLineGraphic=new m(a,this.activeLineSymbol),this._internalGraphicsLayer.graphics.add(this._activeLineGraphic,0))};c.prototype._showFillGraphic=function(a){this._activeFillGraphic?this._activeFillGraphic.geometry=a:(this._activeFillGraphic=new m(a,this._getCreateSymbol(a,!0)),this._internalGraphicsLayer.add(this._activeFillGraphic))};
c.prototype._showLineGraphic=function(a){this._lineGraphic?this._lineGraphic.geometry=a:(this._lineGraphic=new m(a,this.polylineSymbol),this._internalGraphicsLayer.graphics.add(this._lineGraphic,0))};c.prototype._showVertexGraphic=function(a,b){a=new m(a,b?this.activeVertexSymbol:this.vertexSymbol);this._vertexGraphics.push(a);this._internalGraphicsLayer.add(a)};c.prototype._resetCreateOperationGraphics=function(){this._removeActiveFillGraphic();this._removeLineGraphic();this._removeActiveLineGraphic();
this._removeVertexGraphics()};c.prototype._removeCreateGraphic=function(){this.createGraphic&&(this._internalGraphicsLayer.remove(this.createGraphic),this._set("createGraphic",null))};c.prototype._removeCreateOperationGraphics=function(){this._removeCenterIndicatorGraphic();this._removeActiveLineGraphic();this._removeActiveFillGraphic();this._removeLineGraphic();this._removeVertexGraphics()};c.prototype._removeActiveLineGraphic=function(){this._activeLineGraphic&&(this._internalGraphicsLayer.remove(this._activeLineGraphic),
this._activeLineGraphic.destroy(),this._activeLineGraphic=null)};c.prototype._removeActiveFillGraphic=function(){this._activeFillGraphic&&(this._internalGraphicsLayer.remove(this._activeFillGraphic),this._activeFillGraphic.destroy(),this._activeFillGraphic=null)};c.prototype._removeLineGraphic=function(){this._lineGraphic&&(this._internalGraphicsLayer.remove(this._lineGraphic),this._lineGraphic.destroy(),this._lineGraphic=null)};c.prototype._removeVertexGraphics=function(){this._vertexGraphics.length&&
(this._internalGraphicsLayer.removeMany(this._vertexGraphics),this._vertexGraphics.forEach(function(a){return a.destroy()}),this._vertexGraphics=[])};c.prototype._removeDefaultLayer=function(){this._internalGraphicsLayer&&(this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer),this._internalGraphicsLayer.destroy(),this._internalGraphicsLayer=null)};c.prototype._operationHandleForCreateAction=function(a,b,c){var d=this;return new aa.OperationHandle({activeComponent:this._draw,
tool:c,type:"create",onEnd:function(){b.forEach(function(a){return a.remove()});b.length=0;d._removeCreateOperationGraphics();d._internalGraphicsLayer&&d._internalGraphicsLayer.remove(d.createGraphic);d._displayDefaultCursor()},undo:function(){a.undo();d._emitUndoEvent({graphics:[d.createGraphic],tool:c})},redo:function(){a.redo();d._emitRedoEvent({graphics:[d.createGraphic],tool:c})},canUndo:function(){return a&&a.canUndo()},canRedo:function(){return a&&a.canRedo()},setSnapToScene:function(b){a.snapToScene=
b}})};c.prototype._isComponentGraphic=function(a){var b=this.activeComponent;return a&&b?a.attributes&&a.attributes.esriSketchTool?!0:("box"===b.type||"reshape"===b.type)&&b.isUIGraphic(a):!1};c.prototype._snap=function(a,b,c){c&&this._snapLastVertexToAxis(b);"polygon"===a&&this._snapLastPolygonVertexToFirst(b)};c.prototype._snapLastPolygonVertexToFirst=function(a){if(!(2>=a.length)){var b=a[0];a=a[a.length-1];var c=this.view.toScreen(new r.Point(b[0],b[1],this.view.spatialReference)),d=this.view.toScreen(new r.Point(a[0],
a[1],this.view.spatialReference));this._isWithinScreenDistance(c,d,this._getVertexIntersectDistance())&&(a[0]=b[0],a[1]=b[1])}};c.prototype._getVertexIntersectDistance=function(){return this.vertexSymbol&&"simple-marker"===this.vertexSymbol.type?v.pt2px(this.vertexSymbol.size)/2+3:3};c.prototype._isWithinScreenDistance=function(a,b,c){var d=a.x-b.x;a=a.y-b.y;return Math.sqrt(d*d+a*a)<=c};c.prototype._snapLastVertexToAxis=function(a){if(!(2>a.length)){var b=a.pop(),c=a[a.length-1],d=L.createViewAlignedCoordinateSystem(this.view,
c),c=d.mapToLocal(c),b=d.mapToLocal(b),e=Math.abs(b.x-c.x),f=Math.abs(b.y-c.y),d=d.localToMap(L.makeSurfacePoint(e>f?b.x:c.x,e>f?c.y:b.y));a.push(d)}};c.prototype._displayCrosshairCursor=function(){this.view&&this.view.container&&"crosshair"!==this.view.cursor&&(this.view.cursor="crosshair")};c.prototype._displayDefaultCursor=function(){this.view&&this.view.container&&null!==this.view.cursor&&(this.view.cursor=null)};c.prototype._logError=function(a,b,c){ea.error(new l(a,b,c))};c.prototype._requireModule=
function(a){return e.__awaiter(this,void 0,void 0,function(){var b,c;return e.__generator(this,function(d){switch(d.label){case 0:return this._moduleLoaderAbortController=b=new AbortController,[4,a];case 1:return c=d.sent(),this._moduleLoaderAbortController!==b||b.signal.aborted?[2,{requireError:"aborted"}]:[2,{module:c}]}})})};c.prototype._emitUndoEvent=function(a){this.emit("undo",e.__assign(e.__assign({},a),{type:"undo"}))};c.prototype._emitRedoEvent=function(a){this.emit("redo",e.__assign(e.__assign({},
a),{type:"redo"}))};c.prototype._emitDeleteEvent=function(a){this.emit("delete",e.__assign(e.__assign({},a),{type:"delete"}))};c.prototype.createPointFromVertex=function(a){return 2<a.length?new r.Point(a[0],a[1],a[2],this.view.spatialReference):new r.Point(a[0],a[1],this.view.spatialReference)};c.prototype.test=function(){return this._operationHandle};c.prototype.wait=function(){return t.whenNotOnce(this,"updating")};c.prototype._beginAsyncOperation=function(){this._numUpdating+=1;this.notifyChange("updating")};
c.prototype._endAsyncOperation=function(){--this._numUpdating;this.notifyChange("updating")};e.__decorate([x.property({dependsOn:["state"],readOnly:!0})],c.prototype,"_draw",null);e.__decorate([x.property()],c.prototype,"updating",null);e.__decorate([x.property()],c.prototype,"_operationHandle",void 0);e.__decorate([x.property({dependsOn:["_operationHandle","_operationHandle.tool"],readOnly:!0})],c.prototype,"activeTool",null);e.__decorate([x.property()],c.prototype,"activeFillSymbol",void 0);e.__decorate([x.property()],
c.prototype,"activeLineSymbol",void 0);e.__decorate([x.property()],c.prototype,"activePointSymbol",void 0);e.__decorate([x.property()],c.prototype,"activeVertexSymbol",void 0);e.__decorate([x.property({readOnly:!0})],c.prototype,"createGraphic",void 0);e.__decorate([x.property()],c.prototype,"defaultCreateOptions",void 0);e.__decorate([x.property()],c.prototype,"defaultUpdateOptions",void 0);e.__decorate([x.property()],c.prototype,"layer",void 0);e.__decorate([x.property({types:d.symbolTypes})],c.prototype,
"pointSymbol",void 0);e.__decorate([x.property({types:d.symbolTypes})],c.prototype,"polygonSymbol",void 0);e.__decorate([x.property({types:d.symbolTypes})],c.prototype,"polylineSymbol",void 0);e.__decorate([x.property({dependsOn:["view.ready","layer","_operationHandle"],readOnly:!0})],c.prototype,"state",null);e.__decorate([x.property({readOnly:!0})],c.prototype,"updateGraphics",void 0);e.__decorate([x.property()],c.prototype,"updateOnGraphicClick",void 0);e.__decorate([x.property({types:d.symbolTypes})],
c.prototype,"updatePointSymbol",void 0);e.__decorate([x.property({types:d.symbolTypes})],c.prototype,"updatePolygonSymbol",void 0);e.__decorate([x.property({types:d.symbolTypes})],c.prototype,"updatePolylineSymbol",void 0);e.__decorate([x.property({types:d.symbolTypes})],c.prototype,"vertexSymbol",void 0);e.__decorate([x.property({value:null})],c.prototype,"view",null);e.__decorate([x.property()],c.prototype,"cancel",null);e.__decorate([x.property()],c.prototype,"complete",null);e.__decorate([x.property()],
c.prototype,"delete",null);e.__decorate([x.property()],c.prototype,"create",null);e.__decorate([x.property()],c.prototype,"update",null);e.__decorate([x.property()],c.prototype,"undo",null);e.__decorate([x.property()],c.prototype,"redo",null);e.__decorate([x.property()],c.prototype,"canUndo",null);e.__decorate([x.property()],c.prototype,"canRedo",null);e.__decorate([x.property()],c.prototype,"toggleUpdateTool",null);e.__decorate([x.property({value:null})],c.prototype,"snapToScene",null);return c=
e.__decorate([x.subclass("esri.widgets.Sketch.SketchViewModel")],c)}(c.EventedAccessor)})},"esri/views/3d/interactive/editingTools/isSupportedGraphicUtils":function(){define(["require","exports","../../../../core/compilerUtils"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.isSupportedGraphicResultMessage=function(f){switch(f){case 0:break;case 1:return"not owned by a graphics layer";case 2:return"no geometry";case 3:return"the geometry type is not supported";case 4:return"the elevation mode is not supported";
case 5:return"the symbol type is not supported";default:e.neverReached(f)}return""}})},"esri/views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic":function(){define(["require","exports","../../../../../core/compilerUtils","../../../../../core/maybe","../../../../../support/elevationInfoUtils"],function(u,f,e,r,m){Object.defineProperty(f,"__esModule",{value:!0});f.isSupportedGraphic=function(d){if("graphics"!==d.layer.type)return 1;if(r.isNone(d.geometry))return 2;var f=d.geometry.type;
switch(f){case "polygon":case "point":case "polyline":break;case "multipoint":case "extent":case "mesh":return 3;default:return e.neverReached(f),3}return"on-the-ground"!==m.getGraphicEffectiveElevationMode(d)&&m.hasGraphicFeatureExpressionInfo(d)?4:0}})},"esri/support/elevationInfoUtils":function(){define(["require","exports","../core/compilerUtils","../core/maybe","../symbols/support/unitConversionUtils"],function(u,f,e,r,m){function d(c,a){return r.isNone(a)||!a.mode?c?"absolute-height":"on-the-ground":
a.mode}function g(c,a){return d(r.isSome(c)?c.hasZ:!1,a)}function k(c){var a=l(c);return g(c.geometry,a)}function l(c){return c.layer&&"elevationInfo"in c.layer?c.layer.elevationInfo:null}Object.defineProperty(f,"__esModule",{value:!0});f.getEffectiveElevationMode=d;f.getGeometryEffectiveElevationMode=g;f.getGraphicEffectiveElevationMode=k;f.getGraphicEffectiveElevationInfo=function(c){var a=l(c);c=g(c.geometry,a);a=r.isSome(a)&&"on-the-ground"!==c?r.unwrapOr(a.offset,0)*m.getMetersPerUnit(r.unwrapOr(a.unit,
"meters")):0;return{mode:c,offset:a}};f.hasGraphicFeatureExpressionInfo=function(c){if("on-the-ground"===k(c))return!1;c=l(c);c=r.isSome(c)&&c.featureExpressionInfo?c.featureExpressionInfo.expression:null;return!(!c||"0"===c)};f.getZForElevationMode=function(c,a,b){if(!r.isNone(b)&&b.mode){var d=c.hasZ?c.z:0,e=r.isSome(b.offset)?b.offset:0;switch(b.mode){case "absolute-height":return d-e;case "on-the-ground":return 0;case "relative-to-ground":return c=(a.elevationProvider.getElevation(c.x,c.y,c.z,
c.spatialReference,"ground")||0)+e,d-c;case "relative-to-scene":return c=(a.elevationProvider.getElevation(c.x,c.y,c.z,c.spatialReference,"scene")||0)+e,d-c}}};f.getConvertedElevation=function(c,a,b,d){void 0===d&&(d=null);if(!r.isNone(b)){var f=r.isSome(d)?d.mode:"absolute-height";if("on-the-ground"===f)return 0;var g=a.hasZ?a.z:0,k=r.isSome(b.offset)?b.offset:0;switch(b.mode){case "absolute-height":g+=k;break;case "on-the-ground":g=c.elevationProvider.getElevation(a.x,a.y,0,a.spatialReference,"ground")||
0;break;case "relative-to-ground":b=(c.elevationProvider.getElevation(a.x,a.y,a.z,a.spatialReference,"ground")||0)+k;g+=b;break;case "relative-to-scene":b=(c.elevationProvider.getElevation(a.x,a.y,a.z,a.spatialReference,"scene")||0)+k,g+=b}d=r.isSome(d)&&r.isSome(d.offset)?d.offset:0;switch(f){case "absolute-height":return g-d;case "relative-to-ground":return c=(c.elevationProvider.getElevation(a.x,a.y,a.z,a.spatialReference,"ground")||0)+d,g-c;case "relative-to-scene":return b=(c.elevationProvider.getElevation(a.x,
a.y,a.z,a.spatialReference,"scene")||0)+d,g-b;default:return e.neverReached(f),null}}}})},"esri/views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic":function(){define("require exports ../../../../../core/compilerUtils ../../../../../core/maybe ../../../../../geometry/Circle ../../../../../support/elevationInfoUtils".split(" "),function(u,f,e,r,m,d){Object.defineProperty(f,"__esModule",{value:!0});f.isSupportedGraphic=function(f){if("graphics"!==f.layer.type)return 1;var g=f.geometry;
if(r.isNone(g))return 2;var l=g.type;switch(l){case "polygon":if(g instanceof m)return 3;break;case "polyline":break;case "point":case "multipoint":case "extent":case "mesh":return 3;default:return e.neverReached(l),3}return"on-the-ground"!==d.getGraphicEffectiveElevationMode(f)&&d.hasGraphicFeatureExpressionInfo(f)?4:0}})},"esri/geometry/Circle":function(){define("require exports tslib ../core/unitUtils ../core/accessorSupport/decorators ./Point ./Polygon ./support/geodesicUtils ./support/webMercatorUtils ./support/WKIDUnitConversion".split(" "),
function(u,f,e,r,m,d,g,k,l,c){return function(a){function b(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;b.center=null;b.geodesic=!1;b.numberOfPoints=60;b.radius=1E3;b.radiusUnit="meters";return b}e.__extends(b,a);f=b;b.prototype.normalizeCtorArgs=function(b,c){if(!b||!b.center){if(b&&b.rings)return a.prototype.normalizeCtorArgs.call(this,b,c);b={center:b}}return e.__assign(e.__assign(e.__assign({},a.prototype.normalizeCtorArgs.call(this)),b),c)};b.prototype.initialize=
function(){var a=this.center,b=this.numberOfPoints;this.hasZ=a&&a.hasZ;if(0===this.rings.length&&a){var d=r.convertUnit(this.radius,this.radiusUnit,"meters"),e=a.spatialReference,f="geographic";if(e.isWebMercator)f="webMercator";else if(null!=c[e.wkid]||e.wkt&&0===e.wkt.indexOf("PROJCS"))f="projected";if(this.geodesic){e=void 0;switch(f){case "webMercator":e=l.webMercatorToGeographic(a);break;case "projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");
break;case "geographic":e=a}a=this._createGeodesicCircle(e,d,b);"webMercator"===f&&(a=l.geographicToWebMercator(a))}else e=void 0,"webMercator"===f||"projected"===f?e=d/this._convert2Meters(1,a.spatialReference):"geographic"===f&&(e=r.lengthToDegrees(d,"meters")),a=this._createPlanarCircle(a,e,b);this.spatialReference=a.spatialReference;this.addRing(a.rings[0])}};b.prototype.clone=function(){var a=this.numberOfPoints,b=this.radius,c=this.radiusUnit,d=this.geodesic;return new f({center:this.center.clone(),
numberOfPoints:a,radius:b,radiusUnit:c,geodesic:d})};b.prototype._createGeodesicCircle=function(a,b,c){for(var d=0,e=[];360>d;){var f=[0,0];k.directGeodeticSolver(f,[a.x,a.y],d,b);this.hasZ&&f.push(a.z);e.push(f);d+=360/c}e.push(e[0]);return new g(e)};b.prototype._createPlanarCircle=function(a,b,c){for(var d=0,e=[];d<2*Math.PI;){var f=[a.x+Math.cos(-d)*b,a.y+Math.sin(-d)*b];this.hasZ&&f.push(a.z);e.push(f);d+=Math.PI/(c/2)}e.push(e[0]);return new g({spatialReference:a.spatialReference,rings:[e]})};
b.prototype._convert2Meters=function(a,b){if(null!=c[b.wkid])b=c.values[c[b.wkid]];else{b=b.wkt;var d=b.lastIndexOf(",")+1,e=b.lastIndexOf("]]");b=parseFloat(b.substring(d,e))}return a*b};var f;e.__decorate([m.property({type:d})],b.prototype,"center",void 0);e.__decorate([m.property()],b.prototype,"geodesic",void 0);e.__decorate([m.property()],b.prototype,"numberOfPoints",void 0);e.__decorate([m.property()],b.prototype,"radius",void 0);e.__decorate([m.property()],b.prototype,"radiusUnit",void 0);
return b=f=e.__decorate([m.subclass("esri.geometry.Circle")],b)}(g)})},"esri/geometry/support/geodesicUtils":function(){define("require exports @dojo/framework/shim/object ../. ../../core/Error ../../core/unitUtils".split(" "),function(u,f,e,r,m,d){function g(a){if(!a||!a.isGeographic)return null;if(a.wkid){var b=z[a.wkid];if(b)return b}if(a.wkt){a=x.exec(a.wkt);if(!a||2!==a.length)return null;b=a[1].split(",");if(!b||3!==b.length)return null;a=parseFloat(b[1]);b=parseFloat(b[2]);return isNaN(a)||
isNaN(b)?null:{a:a,f:0===b?0:1/b}}return null}function k(a){a=g(a||t);if("b"in a&&"eSq"in a&&"radius"in a)return a;var b=a.a*(1-a.f);return e.assign(a,{b:b,eSq:1-Math.pow(b/a.a,2),radius:(2*a.a+b)/3})}function l(a,b,c){var d=k(c);c=d.a;var d=d.eSq,e=Math.sqrt(d),f=Math.sin(b[1]*v);b=c*b[0]*v;c=0<d?c*(1-d)*(f/(1-d*f*f)-1/(2*e)*Math.log((1-e*f)/(1+e*f)))*.5:c*f;a[0]=b;a[1]=c;return a}function c(a){return null!==g(a)}function a(a,d){if("polyline"!==a.type&&"polygon"!==a.type)throw new m("geodesic-densify:invalid-geometry",
"the input geometry is neither polyline nor polygon");var e=a.spatialReference;if(!c(e))throw new m("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");var f=k(e).radius/1E4;d<f&&(d=f);for(var f=[],g=[0,0],l={distance:null},t=0,v="polyline"===a.type?a.paths:a.rings;t<v.length;t++){var x=v[t],u=[];f.push(u);u.push([x[0][0],x[0][1]]);for(var z=x[0][0],A=x[0][1],E=void 0,S=void 0,aa=0;aa<x.length-1;aa++)if(E=x[aa+1][0],S=x[aa+1][1],z!==E||A!==S){var ba=
[z,A];q(l,[z,A],[E,S],e);z=l.azimuth;A=l.distance;E=A/d;if(1<E){for(S=1;S<=E-1;S++)b(g,ba,z,S*d,e),u.push(g.slice(0));b(g,ba,z,(A+Math.floor(E-1)*d)/2,e);u.push(g.slice(0))}b(g,ba,z,A,e);u.push(g.slice(0));z=g[0];A=g[1]}}return"polyline"===a.type?new r.Polyline({paths:f,spatialReference:e}):new r.Polygon({rings:f,spatialReference:e})}function b(a,b,c,d,e){var f=b[0]*v,g=b[1]*v;b=c*v;e=k(e);var l=e.a,m=e.b;e=e.f;c=Math.sin(b);b=Math.cos(b);for(var q=(1-e)*Math.tan(g),g=1/Math.sqrt(1+q*q),t=q*g,r=Math.atan2(q,
b),q=g*c,x=q*q,u=1-x,l=u*(l*l-m*m)/(m*m),z=1+l/16384*(4096+l*(-768+l*(320-175*l))),A=l/1024*(256+l*(-128+l*(74-47*l))),l=d/(m*z),B=2*Math.PI,E,H,J,ea;1E-12<Math.abs(l-B);)J=Math.cos(2*r+l),E=Math.sin(l),H=Math.cos(l),ea=A*E*(J+A/4*(H*(-1+2*J*J)-A/6*J*(-3+4*E*E)*(-3+4*J*J))),B=l,l=d/(m*z)+ea;d=t*E-g*H*b;m=e/16*u*(4+e*(4-3*u));d=Math.atan2(t*H+g*E*b,(1-e)*Math.sqrt(x+d*d))/v;f=(f+(Math.atan2(E*c,g*H-t*E*b)-(1-m)*e*q*(l+m*E*(J+m*H*(-1+2*J*J)))))/v;a.splice(0,a.length);a.push(f,d);return a}function q(a,
b,c,d){var e=b[0]*v;b=b[1]*v;var f=c[0]*v;c=c[1]*v;var g=k(d),l=g.a;d=g.b;var m=g.f,q=g.radius,t=f-e,r=Math.atan((1-m)*Math.tan(b)),x=Math.atan((1-m)*Math.tan(c)),g=Math.sin(r),r=Math.cos(r),u=Math.sin(x),x=Math.cos(x),z=1E3,A=t,E,H,J,X,ea,ga,oa,ja;do{X=Math.sin(A);ea=Math.cos(A);J=Math.sqrt(x*X*x*X+(r*u-g*x*ea)*(r*u-g*x*ea));if(0===J)return{distance:0};ea=g*u+r*x*ea;ga=Math.atan2(J,ea);oa=r*x*X/J;H=1-oa*oa;X=ea-2*g*u/H;isNaN(X)&&(X=0);ja=m/16*H*(4+m*(4-3*H));E=A;A=t+(1-ja)*m*oa*(ga+ja*J*(X+ja*ea*
(-1+2*X*X)))}while(1E-12<Math.abs(A-E)&&0<--z);if(0===z)return a=f-e,{azimuth:Math.atan2(Math.sin(a)*Math.cos(c),Math.cos(b)*Math.sin(c)-Math.sin(b)*Math.cos(c)*Math.cos(a))/v,distance:Math.acos(Math.sin(b)*Math.sin(c)+Math.cos(b)*Math.cos(c)*Math.cos(f-e))*q};e=H*(l*l-d*d)/(d*d);b=e/1024*(256+e*(-128+e*(74-47*e)));f=Math.atan2(r*Math.sin(A),r*u*Math.cos(A)-g*x);a.azimuth=Math.atan2(x*Math.sin(A),r*u-g*x*Math.cos(A))/v;a.distance=d*(1+e/16384*(4096+e*(-768+e*(320-175*e))))*(ga-b*J*(X+b/4*(ea*(-1+
2*X*X)-b/6*X*(-3+4*J*J)*(-3+4*X*X))));a.reverseAzimuth=f/v;return a}Object.defineProperty(f,"__esModule",{value:!0});var v=Math.PI/180,t=r.SpatialReference.WGS84,x=/SPHEROID\[([^\]]+)]/i,z={4326:{a:6378137,f:1/298.257223563},104900:{a:2439700,f:0},104901:{a:6051E3,f:0},104902:{a:6051800,f:0},104903:{a:1737400,f:0},104904:{a:3393400,f:.005207166853303471},104905:{a:3396190,f:.005886007555525457},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492E3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,
f:0},104911:{a:1E4,f:0},104912:{a:2409300,f:0},104913:{a:15E3,f:0},104914:{a:4E4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85E3,f:0},104918:{a:1821460,f:0},104919:{a:5E3,f:0},104920:{a:12E3,f:0},104921:{a:3E4,f:3},104922:{a:18E3,f:0},104923:{a:14E3,f:0},104924:{a:49300,f:0},104925:{a:60268E3,f:.09796243445941462},104926:{a:16E3,f:0},104927:{a:9500,f:0},104928:{a:56E4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16E3,f:0},104932:{a:133E3,f:0},104933:{a:718E3,f:0},104934:{a:888E3,
f:0},104935:{a:1986300,f:0},104936:{a:1E4,f:0},104937:{a:41900,f:0},104938:{a:11E4,f:0},104939:{a:50100,f:0},104940:{a:764E3,f:0},104941:{a:11E3,f:0},104942:{a:529800,f:0},104943:{a:2575E3,f:0},104944:{a:25559E3,f:.022927344575296365},104945:{a:578900,f:0},104946:{a:33E3,f:0},104947:{a:21E3,f:0},104948:{a:13E3,f:0},104949:{a:31E3,f:0},104950:{a:27E3,f:0},104951:{a:42E3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15E3,f:0},104955:{a:54E3,f:0},104956:{a:77E3,f:0},104957:{a:27E3,f:0},
104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764E3,f:.01708124697141011},104961:{a:74E3,f:0},104962:{a:79E3,f:0},104963:{a:104E3,f:.14423076923076922},104964:{a:29E3,f:0},104965:{a:17E4,f:0},104966:{a:208E3,f:0},104967:{a:4E4,f:0},104968:{a:1352600,f:0},104969:{a:1195E3,f:0},104970:{a:593E3,f:0},104971:{a:3396190,f:0},104972:{a:47E4,f:0},104973:{a:255E3,f:0},104974:{a:2439400,f:0}};f.isSupported=c;f.geodesicAreas=function(b,e){void 0===e&&(e="square-meters");if(b.some(function(a){return!c(a.spatialReference)}))throw new m("geodesic-areas:invalid-spatial-reference",
"the input geometries spatial reference is not supported");for(var f=[],g=0;g<b.length;g++){var q=b[g],t=q.spatialReference,t=.0015696101447650193*k(t).radius;f.push(a(q,t))}b=[];for(var g=[0,0],q=[0,0],r=0;r<f.length;r++){for(var t=f[r],x=t.rings,t=t.spatialReference,v=0,u=0;u<x.length;u++){var z=x[u];l(g,z[0],t);l(q,z[z.length-1],t);for(var A=q[0]*g[1]-g[0]*q[1],E=0;E<z.length-1;E++)l(g,z[E+1],t),l(q,z[E],t),A+=q[0]*g[1]-g[0]*q[1];v+=A}v=d.convertUnit(v,"square-meters",e);b.push(v/-2)}return b};
f.geodesicLengths=function(a,b){void 0===b&&(b="meters");if(!a&&!a)throw new m("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(a.some(function(a){return!c(a.spatialReference)}))throw new m("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");for(var e=[],f=0;f<a.length;f++){for(var g=a[f],k=g.spatialReference,g="polyline"===g.type?g.paths:g.rings,l=0,t=0;t<g.length;t++){for(var r=g[t],x=0,v=1;v<r.length;v++){var u=
r[v-1][0],z=r[v][0],A=r[v-1][1],E=r[v][1];if(A!==E||u!==z){var ba={distance:null};q(ba,[u,A],[z,E],k);x+=ba.distance}}l+=x}l=d.convertUnit(l,"meters",b);e.push(l)}return e};f.geodesicDensify=a;f.directGeodeticSolver=b;f.inverseGeodeticSolver=q;f.geodesicDistance=function(a,b,e){void 0===e&&(e="meters");if(!a||!b)throw new m("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!a.spatialReference||!b.spatialReference)throw new m("geodesic-distance:invalid-parameters",
"one or both input points do not have a spatial reference");if(!a.spatialReference.equals(b.spatialReference))throw new m("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");var f=a.spatialReference;if(!c(f))throw new m("geodesic-distance:not-supported","input geometry spatial reference is not supported");if(a.equals(b))return{distance:0,azimuth:0,reverseAzimuth:0};var g={distance:null};q(g,[a.x,a.y],[b.x,b.y],f);g.distance=d.convertUnit(g.distance,"meters",
e);return g};f.pointFromDistance=function(a,d,e){if(!a||null==d||null==e)throw new m("point-from-distance:missing-parameters","one or more input parameters are missing or undefined");if(0>e||360<e)throw new m("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees");if(!a.spatialReference)throw new m("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");var f=a.spatialReference;if(!c(f))throw new m("geodesic-distance:not-supported",
"input geometry spatial reference is not supported");var g=[0,0];b(g,[a.x,a.y],e,d,f);return new r.Point({x:g[0],y:g[1],spatialReference:f})}})},"esri/views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic":function(){define(["require","exports","../../../../../core/compilerUtils","../../../../../core/maybe","../../../../../support/elevationInfoUtils"],function(u,f,e,r,m){Object.defineProperty(f,"__esModule",{value:!0});f.isSupportedGraphic=function(d){if("graphics"!==d.layer.type)return 1;
if(r.isNone(d.geometry))return 2;var f=d.geometry.type;switch(f){case "point":break;case "polygon":case "polyline":case "multipoint":case "extent":case "mesh":return 3;default:return e.neverReached(f),3}return(f=r.isSome(d.symbol)&&"point-3d"===d.symbol.type&&d.symbol.symbolLayers)&&0<f.length&&f.some(function(d){return"object"===d.type})?"on-the-ground"!==m.getGraphicEffectiveElevationMode(d)&&m.hasGraphicFeatureExpressionInfo(d)?4:0:5}})},"esri/views/draw/Draw":function(){define("require exports tslib ../../core/Accessor ../../core/accessorSupport/decorators ./MultipointDrawAction ./PointDrawAction ./PolygonDrawAction ./PolylineDrawAction ./SegmentDrawAction".split(" "),
function(u,f,e,r,m,d,g,k,l,c){return function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.activeAction=null;b.type="draw";b.view=null;return b}e.__extends(b,a);b.prototype.destroy=function(){this.activeAction&&(this.activeAction.destroy(),this.activeAction=null)};b.prototype.create=function(a,b){this.reset();b=e.__assign({view:this.view},b);switch(a){case "point":this.activeAction=new g.PointDrawAction(b);break;case "polygon":this.activeAction=new k.PolygonDrawAction(b);break;
case "polyline":this.activeAction=new l.PolylineDrawAction(b);break;case "multipoint":this.activeAction=new d.MultipointDrawAction(b);break;case "rectangle":case "circle":case "ellipse":case "triangle":this.activeAction=new c.SegmentDrawAction(b)}return this.activeAction};b.prototype.complete=function(){this.activeAction&&this.activeAction.complete();this.activeAction=null};b.prototype.reset=function(){this.activeAction&&this.activeAction.destroy();this.activeAction=null};e.__decorate([m.property()],
b.prototype,"activeAction",void 0);e.__decorate([m.property({readOnly:!0})],b.prototype,"type",void 0);e.__decorate([m.property()],b.prototype,"view",void 0);return b=e.__decorate([m.subclass("esri.views.draw.Draw")],b)}(r)})},"esri/views/draw/MultipointDrawAction":function(){define("require exports tslib ../../core/Handles ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ./DrawAction ./input/DrawEvents ./input/Keys ../input/InputManager".split(" "),function(u,f,e,r,m,
d,g,k,l,c,a){Object.defineProperty(f,"__esModule",{value:!0});u=function(b){function f(a){a=b.call(this,a)||this;a._cursorMoved=!1;a._cursorScreenPoint=null;a._dragEnabled=!0;a._pointerDownEvent=null;a._viewHandles=new r;a.vertices=[];a.view=null;return a}e.__extends(f,b);f.prototype.initialize=function(){this._addViewHandles()};f.prototype.destroy=function(){this._removeViewHandles();this._viewHandles.destroy();this.emit("destroy")};f.prototype.addVertex=function(a,b){var c=this;isNaN(b)?(b=this.vertices.length,
this.vertices.push(a)):this.vertices.splice(b,0,a);this.history.push({vertex:a,vertexIndex:b,undo:function(){return c._undoVertexAdd(null,b)},redo:function(){return c._redoVertexAdd(null,a,b)}});this._set("redoHistory",[]);var d=new l.VertexAddEvent(this.view,null,b,this.vertices);this.emit("vertex-add",d);d.defaultPrevented&&(this._cursorMoved=!0,this.history.pop())};f.prototype.removeVertex=function(a){var b=this,c=this.vertices.splice(a,1)[0];this.history.push({vertex:c,vertexIndex:a,undo:function(){return b._undoVertexRemove(null,
c,a)},redo:function(){return b._redoVertexRemove(null,a)}});this._set("redoHistory",[]);this.emit("vertex-remove",new l.VertexRemoveEvent(this.view,null,a,this.vertices))};f.prototype.updateVertex=function(a,b){var c=this,d=this.vertices[b];this.vertices[b]=a;this.history.push({vertex:a,vertexIndex:b,undo:function(){return c._undoVertexUpdate(null,d,b)},redo:function(){return c._redoVertexUpdate(null,a,b)}});this._set("redoHistory",[]);this.emit("vertex-update",new l.VertexUpdateEvent(this.view,null,
b,this.vertices))};f.prototype.complete=function(){this._completeDrawing()};f.prototype._addViewHandles=function(){var b=this;this._removeViewHandles();this._viewHandles.add([this.view.on("click",function(a){a.stopPropagation()},a.ViewEventPriorities.TOOL),this.view.on("pointer-down",function(a){b._cursorMoved&&b.vertices.pop();b._pointerDownEvent=a;b._cursorMoved=!1;b._cursorScreenPoint=d.createScreenPointFromEvent(a)},a.ViewEventPriorities.TOOL),this.view.on("pointer-move",function(a){b._cursorMoved&&
b.vertices.pop();b._cursorMoved=!0;b._cursorScreenPoint=d.createScreenPointFromEvent(a);b._cursorUpdateHandler(a)},a.ViewEventPriorities.TOOL),this.view.on("pointer-up",function(a){b._pointerDownEvent&&(b._cursorMoved?(b.vertices.pop(),b._cursorMoved=!1):(b._pointerDownEvent=null,b._vertexAddHandler(a)))},a.ViewEventPriorities.TOOL),this.view.on("drag",function(a){b._dragEnabled&&b._pointerDownEvent&&a.stopPropagation()},a.ViewEventPriorities.TOOL),this.view.on("drag",["Shift"],function(a){a.stopPropagation()},
a.ViewEventPriorities.TOOL),this.view.on("double-click",function(a){a.stopPropagation();b._drawCompleteHandler(a)},a.ViewEventPriorities.TOOL),this.view.on("double-click",["Control"],function(a){a.stopPropagation();b._drawCompleteHandler(a)},a.ViewEventPriorities.TOOL),this.view.on("key-down",function(a){a.key===c.KEYS.vertexAddKey&&!a.repeat&&b._cursorScreenPoint?(b._cursorMoved&&(b.vertices.pop(),b._cursorMoved=!1),b._vertexAddHandler(a)):a.key===c.KEYS.drawCompleteKey&&!a.repeat&&b._cursorScreenPoint?
(b._cursorMoved&&(b.vertices.pop(),b._cursorMoved=!1),b._vertexAddHandler(a),b._drawCompleteHandler(a)):a.key!==c.KEYS.undoKey||b.interactiveUndoDisabled||a.repeat?a.key!==c.KEYS.redoKey||b.interactiveUndoDisabled||a.repeat||(a.stopPropagation(),b.redo()):(a.stopPropagation(),b.undo())},a.ViewEventPriorities.TOOL)])};f.prototype._removeViewHandles=function(){this._viewHandles.removeAll()};f.prototype._addVertex=function(a,b){var c=this;this.vertices.push(a);var d=this.vertices.indexOf(a);this.history.push({vertex:a,
vertexIndex:d,undo:function(){return c._undoVertexAdd(b,d)},redo:function(){return c._redoVertexAdd(b,a,d)}});this._set("redoHistory",[]);var e=new l.VertexAddEvent(this.view,b,d,this.vertices);this.emit("vertex-add",e);e.defaultPrevented&&(this._cursorMoved=!0,this.history.pop())};f.prototype._updateCursor=function(a,b){this.vertices.push(a);a=this.vertices.indexOf(a);b=new l.CursorUpdateEvent(this.view,b,a,this.vertices);this.emit("cursor-update",b)};f.prototype._completeDrawing=function(a){this._cursorMoved=
!1;this._pointerDownEvent=null;1>this.vertices.length||(a=new l.DrawCompleteEvent(a,this.vertices),this.emit("draw-complete",a),a.defaultPrevented?this._cursorMoved=!0:this._removeViewHandles())};f.prototype._undoVertexAdd=function(a,b){this.vertices.splice(b,1);this.emit("undo",new l.VertexRemoveEvent(this.view,a,b,this.vertices))};f.prototype._redoVertexAdd=function(a,b,c){this.vertices.splice(c,0,b);this.emit("redo",new l.VertexAddEvent(this.view,a,c,this.vertices))};f.prototype._undoVertexRemove=
function(a,b,c){this.vertices.splice(c,0,b);this.emit("undo",new l.VertexAddEvent(this.view,a,c,this.vertices))};f.prototype._redoVertexRemove=function(a,b){this.vertices.splice(b,1);this.emit("redo",new l.VertexRemoveEvent(this.view,a,b,this.vertices))};f.prototype._undoVertexUpdate=function(a,b,c){this.vertices[c]=b;this.emit("undo",new l.VertexUpdateEvent(this.view,a,c,this.vertices))};f.prototype._redoVertexUpdate=function(a,b,c){this.vertices[c]=b;this.emit("redo",new l.VertexUpdateEvent(this.view,
a,c,this.vertices))};f.prototype._vertexAddHandler=function(a){var b=this.getCoordsFromScreenPoint(this._cursorScreenPoint);m.isSome(b)&&this._addVertex(b,a.native)};f.prototype._cursorUpdateHandler=function(a){var b=this.getCoordsFromScreenPoint(this._cursorScreenPoint);m.isSome(b)&&this._updateCursor(b,a.native)};f.prototype._drawCompleteHandler=function(a){this._completeDrawing(a.native)};e.__decorate([g.property({readOnly:!0})],f.prototype,"vertices",void 0);e.__decorate([g.property()],f.prototype,
"view",void 0);return f=e.__decorate([g.subclass("esri.views.draw.MultipointDrawAction")],f)}(k);f.MultipointDrawAction=u})},"esri/views/draw/DrawAction":function(){define("require exports tslib ../../core/Evented ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators".split(" "),function(u,f,e,r,m,d,g){var k={mode:"absolute-height",offset:0},l={mode:"on-the-ground",offset:0};return function(c){function a(){var a=null!==c&&c.apply(this,arguments)||this;a._hasZ=null;a.interactiveUndoDisabled=
!1;a.history=[];a.redoHistory=[];a.snapToScene=!1;a.view=null;a.elevationInfo=null;a.defaultZ=0;return a}e.__extends(a,c);Object.defineProperty(a.prototype,"hasZ",{get:function(){return m.isSome(this._hasZ)?this._hasZ:"3d"===this.view.type},set:function(a){this._hasZ=a;this.notifyChange("hasZ")},enumerable:!0,configurable:!0});a.prototype.canUndo=function(){return 0<this.history.length};a.prototype.canRedo=function(){return 0<this.redoHistory.length};a.prototype.undo=function(){if(this.canUndo()){var a=
this.history.pop();a.undo();this.redoHistory.push(a)}};a.prototype.redo=function(){if(this.canRedo()){var a=this.redoHistory.pop();a.redo();this.history.push(a)}};a.prototype.getCoordsFromScreenPoint=function(a){a=this.screenToMap(a);return m.isSome(a)?a.hasZ?[a.x,a.y,a.z]:[a.x,a.y]:null};a.prototype.getCoordsAndPointFromScreenPoint=function(a){a=this.screenToMap(a);return m.isSome(a)?a.hasZ?{vertex:[a.x,a.y,a.z],mapPoint:a}:{vertex:[a.x,a.y],mapPoint:a}:null};a.prototype.isDuplicateVertex=function(a,
c){if(a.length){a=a[a.length-1];var b=a[1];return a[0]===c[0]&&b===c[1]}return!1};a.prototype.getGeometryZValue=function(){return this.defaultZ};a.prototype.screenToMap=function(a){var b=null;"3d"===this.view.type?this.hasZ?(b=m.unwrapOr(this.elevationInfo,k),b=this.view.sceneIntersectionHelper.intersectElevationFromScreen(d.createScreenPointArray(a.x,a.y),b,this.getGeometryZValue())):(b=m.unwrapOr(this.elevationInfo,l),b=this.view.sceneIntersectionHelper.intersectElevationFromScreen(d.createScreenPointArray(a.x,
a.y),b,0),m.isSome(b)&&(b.z=void 0)):(b=this.view.toMap(a),m.isSome(b)&&(b.z=this.hasZ?this.getGeometryZValue():void 0));return b};e.__decorate([g.property({type:Boolean,nonNullable:!0})],a.prototype,"interactiveUndoDisabled",void 0);e.__decorate([g.property({readOnly:!0})],a.prototype,"history",void 0);e.__decorate([g.property({readOnly:!0})],a.prototype,"redoHistory",void 0);e.__decorate([g.property()],a.prototype,"snapToScene",void 0);e.__decorate([g.property()],a.prototype,"view",void 0);e.__decorate([g.property()],
a.prototype,"elevationInfo",void 0);e.__decorate([g.property({nonNullable:!0})],a.prototype,"defaultZ",void 0);e.__decorate([g.property({dependsOn:["view"]})],a.prototype,"hasZ",null);return a=e.__decorate([g.subclass("esri.views.draw.DrawAction")],a)}(r.EventedAccessor)})},"esri/views/draw/input/DrawEvents":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function e(e,f,d,g){this.view=e;this.native=f;this.vertexIndex=d;this.vertices=
g;this.defaultPrevented=!1;this.type="vertex-add"}e.prototype.preventDefault=function(){this.defaultPrevented=!0};return e}();f.VertexAddEvent=u;u=function(){function e(e,f,d,g){this.view=e;this.native=f;this.vertexIndex=d;this.vertices=g;this.defaultPrevented=!1;this.type="vertex-update"}e.prototype.preventDefault=function(){this.defaultPrevented=!0};return e}();f.VertexUpdateEvent=u;u=function(){function e(e,f,d,g){this.view=e;this.native=f;this.vertexIndex=d;this.vertices=g;this.defaultPrevented=
!1;this.type="vertex-remove"}e.prototype.preventDefault=function(){this.defaultPrevented=!0};return e}();f.VertexRemoveEvent=u;u=function(){function e(e,f,d,g,k){void 0===k&&(k=null);this.view=e;this.native=f;this.vertexIndex=d;this.vertices=g;this.mapPoint=k;this.defaultPrevented=!1;this.type="cursor-update"}e.prototype.preventDefault=function(){this.defaultPrevented=!0};return e}();f.CursorUpdateEvent=u;u=function(){function e(e,f){this.native=e;this.vertices=f;this.defaultPrevented=!1;this.type=
"draw-complete"}e.prototype.preventDefault=function(){this.defaultPrevented=!0};return e}();f.DrawCompleteEvent=u})},"esri/views/draw/input/Keys":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});f.KEYS={drawCompleteKey:"c",redoKey:"r",undoKey:"z",vertexAddKey:"f",panKey:" "}})},"esri/views/draw/PointDrawAction":function(){define("require exports tslib ../../core/Handles ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ../3d/interactive/editingTools/draw/DrawTool ./DrawAction ./input/DrawEvents ./input/Keys ../input/InputManager ../input/recognizers/PointerClickHoldAndDrag".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q){Object.defineProperty(f,"__esModule",{value:!0});u=function(f){function l(a){a=f.call(this,a)||this;a._clickDelay=q.DefaultParameters.maximumClickDelay;a._cursorMoved=!1;a._cursorScreenPoint=null;a._pointerDownEvent=null;a._viewHandles=new r;a.coordinates=[];a.view=null;return a}e.__extends(l,f);l.prototype.initialize=function(){"2d"===this.view.type?this._addViewHandles():this._addDrawTool(this.view)};l.prototype.destroy=function(){"2d"===this.view.type?(this._removeViewHandles(),
this._viewHandles.destroy()):this._removeDrawTool();this.emit("destroy")};l.prototype.complete=function(){if("2d"===this.view.type){if(this._cursorScreenPoint){var a=this.getCoordsFromScreenPoint(this._cursorScreenPoint);m.isSome(a)&&(this._set("coordinates",a),this._completeDrawing())}}else this._drawTool.completeCreateOperation()};l.prototype._addViewHandles=function(){var c=this;this._removeViewHandles();this._viewHandles.add([this.view.on("click",function(a){a.stopPropagation();var b=c.getCoordsFromScreenPoint(a.screenPoint);
m.isSome(b)&&(c._set("coordinates",b),c._drawCompleteHandler(a))},b.ViewEventPriorities.TOOL),this.view.on("pointer-down",function(a){c._pointerDownEvent=a;c._cursorMoved=!1},b.ViewEventPriorities.TOOL),this.view.on("pointer-move",function(a){c._cursorMoved=!0;c._cursorScreenPoint=d.createScreenPointFromEvent(a);c._cursorUpdateHandler(a)},b.ViewEventPriorities.TOOL),this.view.on("pointer-up",function(a){if(c._pointerDownEvent&&!c._cursorMoved&&a.timestamp-c._pointerDownEvent.timestamp>c._clickDelay){c._cursorScreenPoint=
d.createScreenPointFromEvent(a);var b=c.getCoordsFromScreenPoint(c._cursorScreenPoint);m.isSome(b)&&(c._set("coordinates",b),c._drawCompleteHandler(a))}},b.ViewEventPriorities.TOOL),this.view.on("key-down",function(b){if(b.key===a.KEYS.drawCompleteKey&&c._cursorScreenPoint){var d=c.getCoordsFromScreenPoint(c._cursorScreenPoint);m.isSome(d)&&(c._set("coordinates",d),c._drawCompleteHandler(b))}},b.ViewEventPriorities.TOOL)])};l.prototype._removeViewHandles=function(){this._viewHandles.removeAll()};
l.prototype._addDrawTool=function(a){var b=this;this._drawTool=new k.DrawTool({view:a,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"point"});this.view.toolViewManager.tools.push(this._drawTool);this.view.activeTool=this._drawTool;this._drawTool.on("cursor-update",function(a){1===a.vertices.length&&b.emit("cursor-update",new c.CursorUpdateEvent(b.view,null,a.vertices[0].vertexIndex,b._drawTool.getVertexCoords()))});this._drawTool.on("complete",function(a){b.emit("draw-complete",new c.DrawCompleteEvent(null,
b._drawTool.getVertexCoords()));b._removeDrawTool()})};l.prototype._removeDrawTool=function(){m.isSome(this._drawTool)&&(this.view.tools.remove(this._drawTool),this._drawTool.destroy(),this._drawTool=null)};l.prototype._updateCursor=function(a,b){m.isSome(a)?this.emit("cursor-update",new c.CursorUpdateEvent(this.view,b,0,[a])):this.emit("cursor-update",new c.CursorUpdateEvent(this.view,b,null,null))};l.prototype._completeDrawing=function(a){this._cursorMoved=!1;this._pointerDownEvent=null;a=new c.DrawCompleteEvent(a,
[this.coordinates]);this.emit("draw-complete",a);a.defaultPrevented||this._removeViewHandles()};l.prototype._cursorUpdateHandler=function(a){this._updateCursor(this.getCoordsFromScreenPoint(this._cursorScreenPoint),a.native)};l.prototype._drawCompleteHandler=function(a){this._completeDrawing(a.native)};e.__decorate([g.property({readOnly:!0})],l.prototype,"coordinates",void 0);e.__decorate([g.property()],l.prototype,"view",void 0);return l=e.__decorate([g.subclass("esri.views.draw.PointDrawAction")],
l)}(l);f.PointDrawAction=u})},"esri/views/3d/interactive/editingTools/draw/DrawTool":function(){define("require exports tslib ../../../../../core/Evented ../../../../../core/maybe ../../../../../core/accessorSupport/decorators ./DrawOperation ./drawSurfaces ../../../../interactive/InteractiveToolBase".split(" "),function(u,f,e,r,m,d,g,k,l){Object.defineProperty(f,"__esModule",{value:!0});u=function(c){function a(a){a=c.call(this,a)||this;a.drawOperation=null;a.hasZ=!0;a.defaultZ=0;a.elevationInfo=
null;a.snapToScene=null;a.mode="hybrid";a.geometryType=null;a.type="draw-3d";return a}e.__extends(a,c);a.prototype.initialize=function(){var a=this,c=m.unwrapOr(this.elevationInfo,{mode:this.hasZ?"absolute-height":"on-the-ground",offset:0});this.drawOperation=new g.DrawOperation({view:this.view,manipulators:this.manipulators,geometryType:this.geometryType,drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snappingEnabled:this.snapToScene,snappingDrawSurface:new k.SceneDrawSurface(this.view,
this.elevationInfo),hasM:!1,elevationInfo:c});this.drawOperation.on("vertex-add",function(b){return a.onVertexAdd(b)});this.drawOperation.on("vertex-remove",function(b){return a.onVertexRemove(b)});this.drawOperation.on("vertex-update",function(b){return a.onVertexUpdate(b)});this.drawOperation.on("cursor-update",function(b){return a.onCursorUpdate(b)});this.drawOperation.on("complete",function(b){return a.onComplete(b)})};a.prototype.destroy=function(){this.drawOperation.destroy();this.drawOperation=
null;this._set("view",null)};a.prototype.onInputEvent=function(a){this.drawOperation.onInputEvent(a)};Object.defineProperty(a.prototype,"enabled",{set:function(a){this.drawOperation.interactive=a;this._set("enabled",a)},enumerable:!0,configurable:!0});a.prototype.reset=function(){};Object.defineProperty(a.prototype,"canRedo",{get:function(){return this.drawOperation.canRedo},enumerable:!0,configurable:!0});a.prototype.redo=function(){this.drawOperation.redo()};Object.defineProperty(a.prototype,"canUndo",
{get:function(){return this.drawOperation.canUndo},enumerable:!0,configurable:!0});a.prototype.undo=function(){this.drawOperation.undo()};a.prototype.completeCreateOperation=function(){this.drawOperation.complete()};a.prototype.activate=function(){};a.prototype.deactivate=function(){this.drawOperation.isCompleted||this.emit("complete",{type:"complete"})};a.prototype.getVertexCoords=function(){return this.drawOperation.vertices};a.prototype.onVertexAdd=function(a){this.emit("vertex-add",a)};a.prototype.onVertexRemove=
function(a){this.emit("vertex-remove",a)};a.prototype.onVertexUpdate=function(a){this.emit("vertex-update",a)};a.prototype.onCursorUpdate=function(a){this.emit("cursor-update",a)};a.prototype.onComplete=function(a){this.emit("complete",a)};e.__decorate([d.property({constructOnly:!0,nonNullable:!0})],a.prototype,"view",void 0);e.__decorate([d.property({value:!0})],a.prototype,"enabled",null);e.__decorate([d.property({constructOnly:!0})],a.prototype,"hasZ",void 0);e.__decorate([d.property({constructOnly:!0,
nonNullable:!0})],a.prototype,"defaultZ",void 0);e.__decorate([d.property({constructOnly:!0})],a.prototype,"elevationInfo",void 0);e.__decorate([d.property()],a.prototype,"snapToScene",void 0);e.__decorate([d.property({constructOnly:!0})],a.prototype,"mode",void 0);e.__decorate([d.property({constructOnly:!0})],a.prototype,"geometryType",void 0);e.__decorate([d.property({readOnly:!0})],a.prototype,"type",void 0);return a=e.__decorate([d.subclass("esri.views.3d.interactive.editingTools.draw.DrawTool")],
a)}(r.EventedMixin(l.InteractiveToolBase));f.DrawTool=u})},"esri/views/3d/interactive/editingTools/draw/DrawOperation":function(){define("require exports tslib ../../../../../geometry ../../../../../core/Evented ../../../../../core/Handles ../../../../../core/maybe ../../../../../core/screenUtils ../../../../../core/accessorSupport/decorators ../coordinateHelper ./DrawManipulator ./drawSurfaces ../editGeometry/EditGeometryHelper ../../../../interactive/dragEventPipeline".split(" "),function(u,f,e,
r,m,d,g,k,l,c,a,b,q,v){Object.defineProperty(f,"__esModule",{value:!0});u=function(f){function m(k){var l=f.call(this)||this;l._manipulator=null;l._stagedVertex=null;l.drawingMode="hybrid";l.geometryType=null;l.elevationInfo=null;l.snappingEnabled=null;l._handles=new d;l._defaultZ=0;l._elevationDrawSurface=null;l._snappingDrawSurface=null;l._createOperationCompleted=!1;l.view=k.view;l.drawingMode=k.drawingMode;l.geometryType=k.geometryType;l.elevationInfo=k.elevationInfo;l.coordinateHelper=c.createCoordinateHelper(k.hasZ,
k.hasM,l.view.spatialReference,l.view.viewingMode);l._defaultZ=k.defaultZ;l.snappingEnabled=k.snappingEnabled;l._snappingDrawSurface=g.unwrap(k.snappingDrawSurface);l._elevationDrawSurface=new b.ElevationDrawSurface(l.elevationInfo,l._defaultZ,l.view);l._editGeometry=new q.EditGeometryHelper(new q.EditGeometry(l.coordinateHelper),"segment"===l.geometryType?"polyline":l.geometryType);l._activeComponent=new q.Component(l._editGeometry.data);l._editGeometry.data.components.push(l._activeComponent);l._editGeometry.on(["vertex-add",
"vertex-update","vertex-remove"],function(a){var b=a.vertices.map(function(a){return{componentIndex:0,vertexIndex:a.index,coordinates:l.coordinateHelper.toArray(a.pos)}}),c=b.map(function(a){return a.coordinates});switch(a.type){case "vertex-add":l.emit(a.type,e.__assign(e.__assign({},a),{added:c,vertices:b}));break;case "vertex-update":l.emit(a.type,e.__assign(e.__assign({},a),{updated:c,vertices:b}));break;case "vertex-remove":l.emit(a.type,e.__assign(e.__assign({},a),{removed:c,vertices:b}))}});
l._manipulator=new a.DrawManipulator;k.manipulators.add(l._manipulator);l._manipulator.grabbable="point"!==l.geometryType;k=v.createManipulatorDragEventPipeline(l._manipulator,function(a,b,c,d){"click"===l.drawingMode||l.isCompleted||(b.next(l._screenToMapDragEventStep()).next(function(a){"start"===a.action&&(l.stagedVertex=a.mapStart,"segment"!==l.geometryType&&"hybrid"!==l.drawingMode||l.commitStagedVertex());return a}).next(function(a){switch(a.action){case "start":case "update":switch(l.drawingMode){case "freehand":case "hybrid":l.stagedVertex=
a.mapEnd,"polygon"!==l.geometryType&&"polyline"!==l.geometryType||l.commitStagedVertex()}break;case "end":"freehand"!==l.drawingMode&&"segment"!==l.geometryType&&"point"!==l.geometryType||l.complete()}return a}),c.next(function(a){}))});var m=l._manipulator.events.on("immediate-double-click",function(a){l.complete();a.stopPropagation()}),t=l._manipulator.events.on("immediate-click",function(a){var b=l._activeComponent,c=l._closeOnClickVertexIndex(a.screenPoint);if(g.isSome(c))l.discardStagedVertex(),
l.complete();else if(c=l._screenToMap(a.screenPoint),g.isSome(c))switch(l.drawingMode){case "click":case "hybrid":l.discardStagedVertex(),l._editGeometry.appendVertex(l.coordinateHelper.fromPoint(c)),("point"===l.geometryType||"segment"===l.geometryType&&2===b.vertices.length||"segment"===l.geometryType&&"hybrid"===l.drawingMode&&1===b.vertices.length)&&l.complete()}a.stopPropagation()});l._handles.add([k,t,m]);return l}e.__extends(m,f);Object.defineProperty(m.prototype,"isCompleted",{get:function(){return this._createOperationCompleted},
enumerable:!0,configurable:!0});m.prototype.destroy=function(){this._handles.destroy();this._handles=null};m.prototype.onInputEvent=function(a){if(!(this._manipulator.dragging||this._manipulator.grabbing&&"pointer-move"===a.type))switch(a.type){case "pointer-move":var b=k.createScreenPoint(a.x,a.y),c=this._closeOnClickVertexIndex(b);g.isSome(c)?(this.discardStagedVertex(),b={componentIndex:0,vertexIndex:c,coordinates:this.coordinateHelper.toArray(this._activeComponent.vertices[c].pos)},this.emit("cursor-update",
{updated:null,vertices:[b],operation:"apply",type:"vertex-update"})):(b=this._screenToMap(b),g.isSome(b)?(this.stagedVertex=b,this._manipulator.cursor="crosshair"):this._manipulator.cursor=null);a.stopPropagation()}};Object.defineProperty(m.prototype,"canRedo",{get:function(){return this._editGeometry.canRedo},enumerable:!0,configurable:!0});m.prototype.redo=function(){this._editGeometry.redo()};Object.defineProperty(m.prototype,"canUndo",{get:function(){return this._editGeometry.canUndo},enumerable:!0,
configurable:!0});m.prototype.undo=function(){this._editGeometry.undo()};m.prototype.complete=function(){this.commitStagedVertex();this._createOperationCompleted=!0;this.emit("complete",{vertices:this.vertices.map(function(a,b){return{componentIndex:0,vertexIndex:b,coordinates:a}}),aborted:!1,type:"complete"})};Object.defineProperty(m.prototype,"interactive",{get:function(){return this._manipulator.interactive},set:function(a){this._manipulator.interactive=a},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,
"numVertices",{get:function(){return g.isSome(this._stagedVertex)?this._activeComponent.vertices.length+1:this._activeComponent.vertices.length},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"vertices",{get:function(){var a=this,b=this._activeComponent.vertices.map(function(b){return a.coordinateHelper.toArray(b.pos)});g.isSome(this._stagedVertex)&&b.push(this.coordinateHelper.pointToArray(this._stagedVertex));return b},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,
"spatialReference",{get:function(){return this.view.spatialReference},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"hasStagedVertex",{get:function(){return g.isSome(this._stagedVertex)},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"stagedVertex",{get:function(){return this._stagedVertex},set:function(a){g.isNone(a)?this.discardStagedVertex():(this._stagedVertex=a,a={componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(a)},
this.emit("cursor-update",{updated:null,vertices:[a],operation:"apply",type:"vertex-update"}))},enumerable:!0,configurable:!0});m.prototype.commitStagedVertex=function(){if(g.isSome(this._stagedVertex)){var a=this._stagedVertex;this._stagedVertex=null;this._editGeometry.appendVertex(this.coordinateHelper.fromPoint(a))}};m.prototype.discardStagedVertex=function(){this._stagedVertex=null};m.prototype._screenToMapDragEventStep=function(){var a=this,b=null;return function(c){"start"===c.action&&(b=a._screenToMap(c.screenStart));
if(g.isNone(b))return null;var d=a._screenToMap(c.screenEnd);return g.isSome(d)?e.__assign(e.__assign({},c),{mapStart:b,mapEnd:d}):null}};m.prototype._screenToMap=function(a){return this._getDrawSurface().screenToMap(a)};m.prototype._mapToScreen=function(a){return this._getDrawSurface().mapToScreen(a)};m.prototype._getDrawSurface=function(){var a=null;if(this.coordinateHelper.hasZ){var a=this._defaultZ,b=!1;g.isSome(this.elevationInfo)&&"absolute-height"===this.elevationInfo.mode&&(b=!0);g.isSome(this.snappingEnabled)&&
(b=this.snappingEnabled);g.isSome(this.elevationInfo)&&"on-the-ground"===this.elevationInfo.mode&&(b=!1);var c=this.vertices,d=this.hasStagedVertex?c.length-1:c.length;("segment"===this.geometryType||"polygon"===this.geometryType)&&0<d&&(a=this.coordinateHelper.zFromArray(c[0]),b=!1);b?a=this._snappingDrawSurface:(this._elevationDrawSurface.defaultZ=a,a=this._elevationDrawSurface)}else this._elevationDrawSurface.defaultZ=null,a=this._elevationDrawSurface;return a};m.prototype._vertexWithinPointerDistance=
function(a,b){var c=this._mapToScreen(a);g.isSome(c)?(a=c.x-b.x,b=c.y-b.y,b=5>=Math.sqrt(a*a+b*b)):b=!1;return b};m.prototype._closeOnClickVertexIndex=function(a){var b=this._activeComponent;if("polygon"===this.geometryType&&2<b.vertices.length){if(this._vertexWithinPointerDistance(this.coordinateHelper.toPoint(b.vertices[0].pos,t),a))return 0;if(this._vertexWithinPointerDistance(this.coordinateHelper.toPoint(b.vertices[b.vertices.length-1].pos,t),a))return b.vertices.length-1}return null};return m=
e.__decorate([l.subclass("esri.views.3d.interactive.editingTools.draw3D.DrawOperation")],m)}(m);f.DrawOperation=u;var t=new r.Point({x:0,y:0,z:0})})},"esri/views/3d/interactive/editingTools/coordinateHelper":function(){define("require exports ../../../../geometry ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/vec4 ../../../../core/libs/gl-matrix-2/vec4f64 ../../../../geometry/support/spatialReferenceUtils".split(" "),
function(u,f,e,r,m,d,g,k,l,c){function a(a,b){if(b.supported){var c=Infinity,d=-Infinity,e=b.upperBoundX-b.lowerBoundX;a.forEach(function(a){for(var f=a.pos[0];f<b.lowerBoundX;)f+=e;for(;f>b.upperBoundX;)f-=e;c=Math.min(c,f);d=Math.max(d,f);a.pos[0]=f});var f=d-c;e-f<f&&a.forEach(function(a){0>a.pos[0]&&(a.pos[0]+=e)})}}function b(a,b){a=c.getInfo(a);return"global"===b&&a?{supported:!0,lowerBoundX:a.valid[0],upperBoundX:a.valid[1]}:{supported:!1,lowerBoundX:null,upperBoundX:null}}Object.defineProperty(f,
"__esModule",{value:!0});var q=function(){function c(a,c){this.spatialReference=a;this.viewingMode=c;this._unnormalizationInfo=b(a,c)}c.prototype.createNew=function(){return m.vec2f64.create()};c.prototype.fromPoint=function(a){return m.vec2f64.fromValues(a.x,a.y)};c.prototype.fromArray=function(a){return m.vec2f64.fromValues(a[0],a[1])};c.prototype.toArray=function(a){return[a[0],a[1]]};c.prototype.toPoint=function(a,b){b.x=a[0];b.y=a[1];b.hasZ=!1;b.hasM=!1;b.spatialReference=this.spatialReference;
return b};c.prototype.createPoint=function(a){return new e.Point({x:a[0],y:a[1],z:void 0,m:void 0,spatialReference:this.spatialReference})};c.prototype.createPointFromArray=function(a){return new e.Point({x:a[0],y:a[1],z:void 0,m:void 0,spatialReference:this.spatialReference})};c.prototype.lerp=function(a,b,c,d){return r.vec2.lerp(d,a,b,c)};c.prototype.addDelta=function(a,b,c){a[0]+=b;a[1]+=c};c.prototype.pointToArray=function(a){return[a.x,a.y]};c.prototype.zFromArray=function(a){};c.prototype.hasZ=
function(){return!1};c.prototype.unnormalize=function(b){a(b,this._unnormalizationInfo)};return c}();f.CoordinateHelper2D=q;var v=function(){function c(a,c,d){this.valueType=a;this.spatialReference=c;this._unnormalizationInfo=b(c,d)}c.prototype.createNew=function(){return g.vec3f64.create()};c.prototype.fromPoint=function(a){return g.vec3f64.fromValues(a.x,a.y,0===this.valueType?a.z:a.m)};c.prototype.fromArray=function(a){return g.vec3f64.fromValues(a[0],a[1],a[2]||0)};c.prototype.toArray=function(a){return[a[0],
a[1],a[2]]};c.prototype.toPoint=function(a,b){b.x=a[0];b.y=a[1];0===this.valueType?(b.z=a[2],b.hasZ=!0,b.hasM=!1):(b.m=a[2],b.hasZ=!1,b.hasM=!0);b.spatialReference=this.spatialReference;return b};c.prototype.createPoint=function(a){return new e.Point({x:a[0],y:a[1],z:0===this.valueType?a[2]:void 0,m:1===this.valueType?a[2]:void 0,spatialReference:this.spatialReference})};c.prototype.createPointFromArray=function(a){return new e.Point({x:a[0],y:a[1],z:0===this.valueType?a[2]:void 0,m:1===this.valueType?
a[2]:void 0,spatialReference:this.spatialReference})};c.prototype.lerp=function(a,b,c,e){return d.vec3.lerp(e,a,b,c)};c.prototype.addDelta=function(a,b,c,d){a[0]+=b;a[1]+=c;0===this.valueType&&(a[2]+=d)};c.prototype.pointToArray=function(a){return 0===this.valueType?[a.x,a.y,a.z]:[a.x,a.y,a.m]};c.prototype.zFromArray=function(a){return 0===this.valueType?a[2]:void 0};c.prototype.hasZ=function(){return 0===this.valueType};c.prototype.unnormalize=function(b){a(b,this._unnormalizationInfo)};return c}();
f.CoordinateHelper3D=v;var t=function(){function c(a,c){this.spatialReference=a;this._unnormalizationInfo=b(a,c)}c.prototype.createNew=function(){return l.vec4f64.create()};c.prototype.fromPoint=function(a){return l.vec4f64.fromValues(a.x,a.y,a.z,a.m)};c.prototype.fromArray=function(a){return l.vec4f64.fromValues(a[0],a[1],a[2]||0,a[3]||0)};c.prototype.toArray=function(a){return[a[0],a[1],a[2],a[3]]};c.prototype.toPoint=function(a,b){b.x=a[0];b.y=a[1];b.z=a[2];b.m=a[3];b.hasZ=!0;b.hasM=!0;b.spatialReference=
this.spatialReference;return b};c.prototype.createPoint=function(a){return new e.Point({x:a[0],y:a[1],z:a[2],m:a[3],spatialReference:this.spatialReference})};c.prototype.createPointFromArray=function(a){return new e.Point({x:a[0],y:a[1],z:a[2],m:a[3],spatialReference:this.spatialReference})};c.prototype.lerp=function(a,b,c,d){return k.vec4.lerp(d,a,b,c)};c.prototype.addDelta=function(a,b,c,d){a[0]+=b;a[1]+=c;a[2]+=d};c.prototype.pointToArray=function(a){return[a.x,a.y,a.z,a.m]};c.prototype.zFromArray=
function(a){return a[2]};c.prototype.hasZ=function(){return!0};c.prototype.unnormalize=function(b){a(b,this._unnormalizationInfo)};return c}();f.CoordinateHelper4D=t;f.createCoordinateHelper=function(a,b,c,d){return a&&b?new t(c,d):b?new v(1,c,d):a?new v(0,c,d):new q(c,d)}})},"esri/views/3d/interactive/editingTools/draw/DrawManipulator":function(){define(["require","exports","../../../../../core/Evented"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function f(){this.events=
new e;this.interactive=!0;this.selectable=!1;this.cursor=null;this.grabbable=!0}f.prototype.intersectionDistance=function(e,d){return 0};f.prototype.attach=function(){};f.prototype.detach=function(){};return f}();f.DrawManipulator=u})},"esri/views/3d/interactive/editingTools/draw/drawSurfaces":function(){define("require exports ../../../../../core/maybe ../../../../../core/screenUtils ../../../../../layers/graphics/dehydratedFeatures ../../../../../support/elevationInfoUtils".split(" "),function(u,
f,e,r,m,d){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function f(d,e,c){this.elevationInfo=d;this.defaultZ=e;this.view=c}f.prototype.screenToMap=function(d){if(e.isSome(this.defaultZ))return this.view.sceneIntersectionHelper.intersectElevationFromScreen(r.createScreenPointArray(d.x,d.y),this.elevationInfo,this.defaultZ);d=this.view.sceneIntersectionHelper.intersectElevationFromScreen(r.createScreenPointArray(d.x,d.y),this.elevationInfo,0);e.isSome(d)&&(d.z=void 0);return d};f.prototype.mapToScreen=
function(e){e=m.makeDehydratedPoint(e.x,e.y,d.getConvertedElevation(this.view,e,this.elevationInfo),e.spatialReference);return this.view.toScreen(e)};return f}();f.ElevationDrawSurface=u;u=function(){function f(d,e,c){void 0===c&&(c=[]);this.view=d;this.elevationInfo=e;this.exclude=c}f.prototype.screenToMap=function(f){f=this.view.toMap(f,{exclude:this.exclude});e.isSome(f)&&(f.z=d.getZForElevationMode(f,this.view,this.elevationInfo));return f};f.prototype.mapToScreen=function(f){var g=f;e.isSome(this.elevationInfo)&&
(g=m.makeDehydratedPoint(f.x,f.y,d.getConvertedElevation(this.view,f,this.elevationInfo),f.spatialReference));return this.view.toScreen(g)};return f}();f.SceneDrawSurface=u})},"esri/views/3d/interactive/editingTools/editGeometry/EditGeometryHelper":function(){define("require exports tslib ../../../../../core/Evented ../../../../../core/maybe ./EditGeometry ./EditGeometry".split(" "),function(u,f,e,r,m,d,g){Object.defineProperty(f,"__esModule",{value:!0});f.EditGeometry=g.EditGeometry;f.Vertex=g.Vertex;
f.Edge=g.Edge;f.Component=g.Component;u=function(b){function d(a,c){var d=b.call(this)||this;d.data=a;d.type=c;d._dirty=!0;d._geometry=null;return d}e.__extends(d,b);d.prototype.splitEdge=function(a,b){a=new k(this,a,b);this.data.apply(a);this._dirty=!0;return a};d.prototype.moveVertices=function(a,b,c,d){var e=null;this.data.lastOperation instanceof l&&this.data.lastOperation.canAccumulate(a)?(e=this.data.lastOperation,e.accumulate(b,c,d)):(e=new l(this,a,b,c,d),this.data.apply(e));this._dirty=!0;
return e};d.prototype.removeVertices=function(a){var b=0;switch(this.type){case "point":b=1;break;case "polyline":b=2;break;case "polygon":b=3}a=new c(this,a,b);this.data.apply(a);this._dirty=!0;return a};d.prototype.appendVertex=function(b){if(0===this.data.components.length)return null;b=new a(this,this.data.components[0],b);this.data.apply(b);this._dirty=!0;return b};d.prototype.canRemoveVertex=function(){var a=0;switch(this.type){case "point":a=1;break;case "polyline":a=2;break;case "polygon":a=
3}return this.data.components[0].vertices.length>a};d.prototype.undo=function(){this.data.undo();this._dirty=!0};Object.defineProperty(d.prototype,"canUndo",{get:function(){return this.data.canUndo},enumerable:!0,configurable:!0});d.prototype.redo=function(){this.data.redo();this._dirty=!0};Object.defineProperty(d.prototype,"canRedo",{get:function(){return this.data.canRedo},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"geometry",{get:function(){if(this._dirty){switch(this.type){case "point":this._geometry=
this.data.toPoint();break;case "polyline":this._geometry=this.data.toPolyline();break;case "polygon":this._geometry=this.data.toPolygon()}this._dirty=!1}return this._geometry},enumerable:!0,configurable:!0});return d}(r);f.EditGeometryHelper=u;var k=function(){function a(a,b,c){this.helper=a;this.edge=b;this.t=c;this.right=this.left=this.createdVertex=null}a.prototype.apply=function(){var a="redo",b=this.edge,c=b.component,e=b.component.data,f=b.left,g=b.right;c.edges.splice(c.edges.indexOf(b),1);
m.isNone(this.createdVertex)&&(a="apply",this.createdVertex=new d.Vertex(b.component));c.vertices.push(this.createdVertex);this.createdVertex.pos=e.coordinateHelper.lerp(b.left.pos,b.right.pos,this.t,e.coordinateHelper.createNew());m.isNone(this.left)&&(this.left=new d.Edge(c,f,this.createdVertex));c.edges.push(this.left);f.right=this.left;m.isNone(this.right)&&(this.right=new d.Edge(c,this.createdVertex,g));c.edges.push(this.right);g.left=this.right;c.updateVertexIndex(this.createdVertex,f.index+
1);this.helper.emit("vertex-add",{type:"vertex-add",vertices:[this.createdVertex],operation:a})};a.prototype.undo=function(){if(m.isNone(this.createdVertex)||m.isNone(this.left)||m.isNone(this.right))return null;var a=this.edge,b=a.component,c=this.createdVertex.left.left,d=this.createdVertex.right.right;b.vertices.splice(b.vertices.indexOf(this.createdVertex),1);b.edges.splice(b.edges.indexOf(this.left),1);b.edges.splice(b.edges.indexOf(this.right),1);b.edges.push(this.edge);c.right=a;d.left=a;b.updateVertexIndex(c,
c.index);this.helper.emit("vertex-remove",{type:"vertex-remove",vertices:[this.createdVertex],operation:"undo"})};return a}();f.SplitEdgeOperation=k;var l=function(){function a(a,b,c,d,e){this.helper=a;this.applied=!1;this.vertices=b;this.dx=c;this.dy=d;this.dz=e}a.prototype.apply=function(){var a=this;this.vertices.forEach(function(b){a.helper.data.coordinateHelper.addDelta(b.pos,a.dx,a.dy,a.dz)});this.helper.data.components.forEach(function(a){a.unnormalizeVertexPositions()});this.helper.emit("vertex-update",
{type:"vertex-update",vertices:this.vertices,operation:this.applied?"redo":"apply"});this.applied=!0};a.prototype.undo=function(){var a=this;this.vertices.forEach(function(b){a.helper.data.coordinateHelper.addDelta(b.pos,-a.dx,-a.dy,-a.dz)});this.helper.emit("vertex-update",{type:"vertex-update",vertices:this.vertices,operation:"undo"})};a.prototype.canAccumulate=function(a){if(a.length!==this.vertices.length)return!1;for(var b=0;b<a.length;++b)if(a[b]!==this.vertices[b])return!1;return!0};a.prototype.accumulate=
function(a,b,c){var d=this;this.vertices.forEach(function(e){d.helper.data.coordinateHelper.addDelta(e.pos,a,b,c)});this.dx+=a;this.dy+=b;this.dz+=c;this.helper.emit("vertex-update",{type:"vertex-update",vertices:this.vertices,operation:"apply"})};return a}();f.UpdateVerticesOperation=l;var c=function(){function a(a,b,c){void 0===c&&(c=0);this.helper=a;this.removedVertices=null;this._minNumberOfVertices=0;this.vertices=b;this._minNumberOfVertices=c}a.prototype.apply=function(){var a=this,b="redo";
null==this.removedVertices?(this.removedVertices=[],this.vertices.forEach(function(b){b=a._removeVertex(b);m.isSome(b)&&a.removedVertices.push(b)}),b="apply"):this.removedVertices.forEach(function(b){a._redoRemoveVertex(b)});this.helper.emit("vertex-remove",{type:"vertex-remove",vertices:this.vertices,operation:b})};a.prototype.undo=function(){var a=this;this.removedVertices.forEach(function(b){a._undoRemoveVertex(b)});this.helper.emit("vertex-add",{type:"vertex-add",vertices:this.vertices,operation:"undo"})};
a.prototype._removeVertex=function(a){var b=a.component;if(b.vertices.length<=this._minNumberOfVertices)return null;var c={removedVertex:a,createdEdge:null},e=a.left,f=a.right;b.vertices.splice(b.vertices.indexOf(a),1);e&&(b.edges.splice(b.edges.indexOf(e),1),e.left.right=null);f&&(b.edges.splice(b.edges.indexOf(f),1),f.right.left=null);0===a.index&&f&&0<this.vertices.length&&b.swapVertices(b.vertices.indexOf(f.right),0);e&&f&&(c.createdEdge=new d.Edge(b,e.left,f.right),b.edges.push(c.createdEdge));
f&&b.updateVertexIndex(f.right,f.right.index-1);return c};a.prototype._redoRemoveVertex=function(a){console.warn("redo remove vertex not implemented yet")};a.prototype._undoRemoveVertex=function(a){var b=a.removedVertex,c=a.removedVertex.component,d=b.left,e=b.right;a.createdEdge&&c.edges.splice(c.edges.indexOf(a.createdEdge),1);c.vertices.push(b);d&&(c.edges.push(d),d.left.right=d);e&&(c.edges.push(e),e.right.left=e);c.updateVertexIndex(b,b.index)};return a}();f.RemoveVerticesOperation=c;var a=function(){function a(a,
b,c){this.helper=a;this.component=b;this.pos=c;this.right=this.left=this.originalEdge=this.addedVertex=null}a.prototype.apply=function(){var a="redo";m.isNone(this.addedVertex)&&(a="apply",this.addedVertex=new d.Vertex(this.component));if(0===this.component.vertices.length)this.component.vertices.push(this.addedVertex),this.addedVertex.pos=this.pos,this.addedVertex.index=0;else{var b=m.unwrap(this.component.findEndVertex()),c=null;b.right&&(this.originalEdge=b.right,c=this.originalEdge.right,this.component.edges.splice(this.component.edges.indexOf(this.originalEdge),
1));this.component.vertices.push(this.addedVertex);this.addedVertex.pos=this.pos;m.isNone(this.left)&&(this.left=new d.Edge(this.component,b,this.addedVertex));this.component.edges.push(this.left);b.right=this.left;m.isSome(this.originalEdge)&&m.isSome(c)&&(m.isNone(this.right)&&(this.right=new d.Edge(this.component,this.addedVertex,c)),this.component.edges.push(this.right),c.left=this.right);this.component.updateVertexIndex(this.addedVertex,b.index+1)}this.helper.emit("vertex-add",{type:"vertex-add",
vertices:[this.addedVertex],operation:a})};a.prototype.undo=function(){if(m.isNone(this.addedVertex))return null;this.component.vertices.splice(this.component.vertices.indexOf(this.addedVertex),1);m.isSome(this.left)&&(this.component.edges.splice(this.component.edges.indexOf(this.left),1),this.left.left.right=null);m.isSome(this.right)&&(this.component.edges.splice(this.component.edges.indexOf(this.right),1),this.right.right.left=null);m.isSome(this.originalEdge)&&(this.component.edges.push(this.originalEdge),
this.originalEdge.left.right=this.originalEdge,this.originalEdge.right.left=this.originalEdge);m.isSome(this.left)?this.component.updateVertexIndex(this.left.left,this.left.left.index):this.component.updateVertexIndex(this.addedVertex,0);this.helper.emit("vertex-remove",{type:"vertex-remove",vertices:[this.addedVertex],operation:"undo"})};return a}();f.AppendVertexOperation=a})},"esri/views/3d/interactive/editingTools/editGeometry/EditGeometry":function(){define(["require","exports","../../../../../geometry",
"../../../../../core/arrayUtils","../coordinateHelper"],function(u,f,e,r,m){Object.defineProperty(f,"__esModule",{value:!0});var d=function(){function d(c){this.right=this.left=null;this.type="vertex";this.index=null;this.component=c}Object.defineProperty(d.prototype,"pos",{get:function(){return this._pos},set:function(c){this._pos=c;this.component.unnormalizeVertexPositions()},enumerable:!0,configurable:!0});return d}();f.Vertex=d;var g=function(){return function(d,c,a){this.type="edge";this.component=
d;this.left=c;this.right=a;c.right=this;a.left=this}}();f.Edge=g;var k=function(){function d(c){this.vertices=[];this.edges=[];this.data=c}d.prototype.unnormalizeVertexPositions=function(){1>=this.vertices.length||this.data.coordinateHelper.unnormalize(this.vertices)};d.prototype.updateVertexIndex=function(c,a){if(0!==this.vertices.length){var b=this.vertices[0],d=null;do d=c,d.index=a++,c=d.right?d.right.right:null;while(null!=c&&c!==b);d.left&&d!==this.vertices[this.vertices.length-1]&&this.swapVertices(this.vertices.indexOf(d),
this.vertices.length-1)}};d.prototype.findEndVertex=function(){return 0===this.vertices.length?null:this.vertices[this.vertices.length-1]};d.prototype.swapVertices=function(c,a){var b=this.vertices[c];this.vertices[c]=this.vertices[a];this.vertices[a]=b};return d}();f.Component=k;u=function(){function f(c){this.coordinateHelper=c;this.undoStack=[];this.redoStack=[];this.components=[]}f.prototype.apply=function(c){c.apply();this.undoStack.push(c);this.redoStack=[]};f.prototype.undo=function(){if(0<
this.undoStack.length){var c=this.undoStack.pop();c.undo();this.redoStack.push(c)}};Object.defineProperty(f.prototype,"canUndo",{get:function(){return 0<this.undoStack.length},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"lastOperation",{get:function(){return 0<this.undoStack.length?this.undoStack[this.undoStack.length-1]:null},enumerable:!0,configurable:!0});f.prototype.redo=function(){if(0<this.redoStack.length){var c=this.redoStack.pop();c.apply();this.undoStack.push(c)}};
Object.defineProperty(f.prototype,"canRedo",{get:function(){return 0<this.redoStack.length},enumerable:!0,configurable:!0});f.prototype.toPoint=function(){return 0===this.components.length||0===this.components[0].vertices.length?null:this.coordinateHelper.createPoint(this.components[0].vertices[0].pos)};f.prototype.toPolyline=function(){var c=[],a=this.coordinateHelper.toArray;this.components.forEach(function(b,d){d=[];var e=b=r.find(b.vertices,function(a){return null==a.left});do d.push(a(b.pos)),
b=b.right?b.right.right:null;while(b&&b!==e);c.push(d)});return new e.Polyline({paths:c,spatialReference:this.coordinateHelper.spatialReference})};f.prototype.toPolygon=function(){var c=[],a=this.coordinateHelper.toArray;this.components.forEach(function(b,d){d=[];var e=b=b.vertices[0],f=e;do d.push(a(e.pos)),e=e.right.right;while(e&&e!==f);d.push(a(b.pos));c.push(d)});return new e.Polygon({rings:c,spatialReference:this.coordinateHelper.spatialReference})};f.fromGeometry=function(c,a){a=m.createCoordinateHelper(c.hasZ,
c.hasM,c.spatialReference,a);var b=new f(a);switch(c.type){case "polygon":for(var e=c.rings,l=0;l<e.length;++l){var t=e[l];c=new k(b);for(var r=t.length-1,u=0;u<r;++u){var A=a.fromArray(t[u]),E=new d(c);c.vertices.push(E);E.pos=A;E.index=u}r=c.vertices.length-1;for(u=0;u<r;++u)A=c.vertices[u],E=c.vertices[u+1],A=new g(c,A,E),c.edges.push(A);r=new g(c,c.vertices[c.vertices.length-1],c.vertices[0]);c.edges.push(r);b.components.push(c)}break;case "polyline":for(e=c.paths,l=0;l<e.length;++l){t=e[l];c=
new k(b);r=t.length;for(u=0;u<r;++u)A=a.fromArray(t[u]),E=new d(c),c.vertices.push(E),E.pos=A,E.index=u;r=c.vertices.length-1;for(u=0;u<r;++u)A=c.vertices[u],E=c.vertices[u+1],A=new g(c,A,E),c.edges.push(A);b.components.push(c)}}return b};return f}();f.EditGeometry=u})},"esri/views/interactive/dragEventPipeline":function(){define("require exports tslib ../../core/handleUtils ../../core/lang ../../core/mathUtils ../../core/maybe ../../core/screenUtils ../../geometry/support/webMercatorUtils ../draw/support/drawUtils".split(" "),
function(u,f,e,r,m,d,g,k,l,c){function a(a,b){var c=null,d=null;return function(e){if("cancel"===e.action)g.isSome(d)&&(d.execute({action:"cancel"}),d=c=null);else{var f={action:e.action,screenStart:e.start,screenEnd:e.screenPoint};"start"===e.action&&g.isNone(c)&&(c=new z,d=new z,b(a,c,d,f));g.isSome(c)&&c.execute(f);"end"===e.action&&g.isSome(c)&&(d=c=null)}}}function b(b,c){return b.events.on("drag",a(b,c))}function q(a,b){var d=null,f=g.isSome(a[b])?a[b].spatialReference:null;return function(k){if("start"===
k.action&&g.isSome(a[b])){var m=a[b],q=k.mapStart.spatialReference;d=g.isNone(m)||"mesh"===m.type?null:m.spatialReference.equals(q)?m.clone():l.canProject(m,q)?l.project(m,q):null}if(g.isNone(d))return null;var m=k.mapEnd.x-k.mapStart.x,q=k.mapEnd.y-k.mapStart.y,t=k.mapEnd.z-k.mapStart.z,r=c.move(d.clone(),m,q,t);r.spatialReference.equals(f)?a[b]=r:a[b]=l.project(r,f);return e.__assign(e.__assign({},k),{translationX:m,translationY:q,translationZ:t})}}function v(a){return q(a,"geometry")}function t(a,
b){for(var c=new Map,d=0;d<b.length;d++){var e=b[d];c.set(e,m.clone(a[e]))}return function(b){c.forEach(function(b,c){a[c]=b});return b}}function x(a){return t(a,["geometry"])}Object.defineProperty(f,"__esModule",{value:!0});f.createDragEventPipelineCallback=a;f.createManipulatorDragEventPipeline=b;f.createManipulatorDragEventPipelineMany=function(a,c){for(var d=[],e=0;e<a.length;e++)d.push(b(a[e],c));return r.handlesGroup(d)};f.constrainToMapAxis=function(a,b){var c=[a.x,a.y,a.z],d=[Math.cos(b),
Math.sin(b)];a=Math.sqrt(d[0]*d[0]+d[1]*d[1]);if(0===a)return null;d[0]/=a;d[1]/=a;var e=function(a){var b=(a.x-c[0])*d[0]+(a.y-c[1])*d[1];a.x=c[0]+b*d[0];a.y=c[1]+b*d[1]};return function(a){e(a.mapStart);e(a.mapEnd);return a}};f.dragGeometry=q;f.dragGraphic=v;f.screenToMap=function(a,b,c){void 0===b&&(b=null);var d=null,f=g.isSome(b)&&!a.spatialReference.equals(b)?function(a){return g.isSome(a)?l.project(a,b):a}:function(a){return a},k=e.__assign({exclude:[]},c);return function(b){"start"===b.action&&
(d=f(a.toMap(b.screenStart,k)));if(g.isNone(d))return null;var c=f(a.toMap(b.screenEnd,k));return g.isSome(c)?e.__assign(e.__assign({},b),{mapStart:d,mapEnd:c}):null}};f.dragGraphicMany=function(a){var b=a.map(function(a){return g.unwrap(v(a))}).filter(function(a){return g.isSome(a)});return function(a){var c=a.mapEnd.x-a.mapStart.x,d=a.mapEnd.y-a.mapStart.y,f=a.mapEnd.z-a.mapStart.z;b.forEach(function(b){return b(a)});return e.__assign(e.__assign({},a),{translationX:c,translationY:d,translationZ:f})}};
f.resetProperties=t;f.resetGraphic=x;f.resetGraphicMany=function(a){var b=a.map(function(a){return g.unwrap(x(a))}).filter(function(a){return g.isSome(a)});return function(a){b.forEach(function(b){return b(a)});return a}};f.resetSymbol=function(a){var b=g.isSome(a.symbol)?a.symbol.clone():null;return function(c){a.symbol=b;return c}};f.horizontalDegreesOfFreedom=3;f.verticalDegreesOfFreedom=4;f.allDegreesOfFreedom=7;f.addMapDelta=function(a){void 0===a&&(a=f.allDegreesOfFreedom);var b=0,c=0,d=0;return function(f){"start"===
f.action&&(b=f.mapStart.x,c=f.mapStart.y,d=f.mapStart.z);var g=a&1?f.mapEnd.x-b:0,k=a&2?f.mapEnd.y-c:0,l=a&4?f.mapEnd.z-d:0;b=f.mapEnd.x;c=f.mapEnd.y;d=f.mapEnd.z;return e.__assign(e.__assign({},f),{mapDeltaX:g,mapDeltaY:k,mapDeltaZ:l,mapDeltaSpatialReference:f.mapStart.spatialReference})}};f.addScreenDelta=function(a){void 0===a&&(a=f.allDegreesOfFreedom);var b=0,c=0;return function(d){"start"===d.action&&(b=d.screenStart.x,c=d.screenStart.y);var f=a&1?d.screenEnd.x-b:0,g=a&2?d.screenEnd.y-c:0;b=
d.screenEnd.x;c=d.screenEnd.y;return e.__assign(e.__assign({},d),{screenDeltaX:f,screenDeltaY:g})}};f.dragAtLocation=function(a,b){var c=null,e=0,f=0;return function(g){"start"===g.action&&(c=a.toScreen(b),0>c.x||c.x>a.width||0>c.y||c.y>a.height?c=null:(e=g.screenStart.x-c.x,f=g.screenStart.y-c.y));if(null==c)return null;var l=d.clamp(g.screenEnd.x-e,0,a.width),m=d.clamp(g.screenEnd.y-f,0,a.height),l=k.createScreenPoint(l,m);g.screenStart=c;g.screenEnd=l;return g}};var z=function(){function a(){this.execute=
function(){}}a.prototype.next=function(b,c){void 0===c&&(c=new a);g.isSome(b)&&(this.execute=function(a){a=b(a);g.isSome(a)&&c.execute(a)});return c};return a}();f.EventPipeline=z})},"esri/views/draw/support/drawUtils":function(){define(["require","exports","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/coordsUtils"],function(u,f,e,r,m){function d(d,c,a,b){null==b||d.hasZ||(b=void 0);if("point"===d.type)return d.x+=c,d.y+=a,d.hasZ&&null!=
b&&(d.z+=b),d;if("multipoint"===d.type){for(var e=d.points,f=0;f<e.length;f++)e[f]=g(e[f],c,a,b);return d}if("extent"===d.type)return d.xmin+=c,d.xmax+=c,d.ymin+=a,d.ymax+=a,null!=b&&(d.zmin+=b,d.zmax+=b),d;for(var e=m.geometryToCoordinates(d),k="polyline"===d.type?d.paths:d.rings,l=0;l<e.length;l++)for(var r=e[l],f=0;f<r.length;f++)r[f]=g(r[f],c,a,b);"paths"in d?d.paths=k:d.rings=k;return d}function g(d,c,a,b){return k(d,d[0]+c,d[1]+a,null!=d[2]&&null!=b?d[2]+b:void 0)}function k(d,c,a,b){c=[c,a];
2<d.length&&c.push(null!=b?b:d[2]);3<d.length&&c.push(d[3]);return c}Object.defineProperty(f,"__esModule",{value:!0});f.move=d;f.cloneMove=function(e,c,a,b,f){e=e.clone();var g=b.resolution;if("point"===e.type){if(f)d(e,c*g,-a*g);else{f=b.state.transform;b=b.state.inverseTransform;var l=f[0]*e.x+f[2]*e.y+f[4],q=f[1]*e.x+f[3]*e.y+f[5];e.x=b[0]*(l+c)+b[2]*(q+a)+b[4];e.y=b[1]*(l+c)+b[3]*(q+a)+b[5]}return e}if("multipoint"===e.type){if(f)d(e,c*g,-a*g);else{g=e.points;f=b.state.transform;b=b.state.inverseTransform;
for(var r=0;r<g.length;r++){var u=g[r],q=f[0]*u[0]+f[2]*u[1]+f[4],E=f[1]*u[0]+f[3]*u[1]+f[5],l=b[0]*(q+c)+b[2]*(E+a)+b[4],q=b[1]*(q+c)+b[3]*(E+a)+b[5];g[r]=k(u,l,q,void 0)}}return e}if("extent"===e.type){if(f)d(e,c*g,-a*g);else{f=b.state.transform;b=b.state.inverseTransform;var g=f[0]*e.xmin+f[2]*e.ymin+f[4],H=f[1]*e.xmin+f[3]*e.ymin+f[5],l=f[0]*e.xmax+f[2]*e.ymax+f[4];f=f[1]*e.xmax+f[3]*e.ymax+f[5];e.xmin=b[0]*(g+c)+b[2]*(H+a)+b[4];e.ymin=b[1]*(g+c)+b[3]*(H+a)+b[5];e.xmax=b[0]*(l+c)+b[2]*(f+a)+b[4];
e.ymax=b[1]*(l+c)+b[3]*(f+a)+b[5]}return e}if(f)d(e,c*g,-a*g);else{H=m.geometryToCoordinates(e);g="polyline"===e.type?e.paths:e.rings;f=b.state.transform;b=b.state.inverseTransform;for(var J=0;J<H.length;J++)for(var B=H[J],r=0;r<B.length;r++)u=B[r],q=f[0]*u[0]+f[2]*u[1]+f[4],E=f[1]*u[0]+f[3]*u[1]+f[5],l=b[0]*(q+c)+b[2]*(E+a)+b[4],q=b[1]*(q+c)+b[3]*(E+a)+b[5],B[r]=k(u,l,q,void 0);"paths"in e?e.paths=g:e.rings=g}return e};f.scale=function(d,c,a,b){if("point"===d.type){var f=d.x,g=d.y,l=b?b[0]:f;b=b?
b[1]:g;d=d.clone();d.x=(f-l)*c+l;d.y=(g-b)*a+b;return d}if("multipoint"===d.type){var g=m.geometryToCoordinates(d),l=e.create(),u=r.getRingsOrPathsBounds(l,[g]),l=u[0],g=u[1],f=u[2],u=u[3],l=b?b[0]:(l+f)/2,u=b?b[1]:(u+g)/2,z=d.clone(),A=z.points;for(d=0;d<A.length;d++)b=A[d],f=b[0],g=b[1],f=(f-l)*c+l,g=(g-u)*a+u,A[d]=k(b,f,g,void 0);return z}if("extent"===d.type)return g=d.xmin,l=d.xmax,f=d.ymin,u=d.ymax,z=b?b[0]:(g+l)/2,b=b?b[1]:(u+f)/2,d=d.clone(),d.xmin=(g-z)*c+z,d.ymax=(u-b)*a+b,d.xmax=(l-z)*
c+z,d.ymin=(f-b)*a+b,d.xmin>d.xmax&&(c=d.xmin,d.xmin=d.xmax,d.xmax=c),d.ymin>d.ymax&&(c=d.ymin,d.ymin=d.ymax,d.ymax=c),d;for(var l=m.geometryToCoordinates(d),g=e.create(),z=r.getRingsOrPathsBounds(g,l),f=z[0],g=z[1],u=z[2],z=z[3],u=b?b[0]:(f+u)/2,z=b?b[1]:(z+g)/2,A=d.clone(),E="polyline"===A.type?A.paths:A.rings,H=0;H<l.length;H++){var J=l[H];for(d=0;d<J.length;d++)b=J[d],f=b[0],g=b[1],f=(f-u)*c+u,g=(g-z)*a+z,E[H][d]=k(b,f,g,void 0)}"paths"in A?A.paths=E:A.rings=E;return A};f.getScaleRatio=function(d,
c,a,b,e,f){return Math.sqrt((e-d)*(e-d)+(f-c)*(f-c))/Math.sqrt((a-d)*(a-d)+(b-c)*(b-c))};f.getRotationAngle=function(d,c,a,b,e,f){return 180*Math.atan2(c-f,d-e)/Math.PI-180*Math.atan2(c-b,d-a)/Math.PI}})},"esri/views/interactive/InteractiveToolBase":function(){define("require exports tslib ../../core/Accessor ../../core/promiseUtils ../../core/accessorSupport/decorators ./interactiveToolUtils ./ManipulatorCollection".split(" "),function(u,f,e,r,m,d,g,k){Object.defineProperty(f,"__esModule",{value:!0});
u=function(f){function c(a){a=f.call(this,a)||this;a.attached=!1;a.created=!1;a.completed=!1;a.manipulators=new k.ManipulatorCollection;a.deferCreation=!1;a._editableFlags=[];a._creationResolver=m.createResolver();return a}e.__extends(c,f);Object.defineProperty(c.prototype,"active",{get:function(){return null!=this.view&&this.view.activeTool===this},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isSupported",{get:function(){return!0},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"visible",{set:function(a){this._set("visible",a);a||g.setActive(this,!1);this.attached&&(a?this._show():this._hide())},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"editable",{get:function(){return this.hasEditableFlag(0)},set:function(a){this.setEditableFlag(0,a)},enumerable:!0,configurable:!0});c.prototype.attach=function(){if(!this.attached&&this.isSupported){this.manipulators.attach();this.onAttach();if(this.visible)this.onShow();this._set("attached",!0)}};c.prototype.detach=
function(){this.attached&&(this.onHide(),this.onDetach(),this.manipulators.detach(),this._set("attached",!1))};c.prototype.handleInputEvent=function(a){if(this.attached)this.onInputEvent(a)};c.prototype.handleInputEventAfter=function(a){if(this.attached)this.onInputEventAfter(a)};c.prototype.destroy=function(){this.manipulators.destroy();this._set("view",null)};c.prototype.setEditableFlag=function(a,b){this._editableFlags[a]=b;this.manipulators.isToolEditable=this._editableFlags.every(function(a){return null==
a||a});this._updateManipulatorAttachment();0===a&&this.notifyChange("editable");this.onEditableChange()};c.prototype.hasEditableFlag=function(a){a=this._editableFlags[a];return null==a?!0:a};c.prototype.when=function(){return this._creationResolver.promise};c.prototype.rejectCreation=function(a){this._creationResolver.reject(a)};c.prototype.initialize=function(){this.deferCreation||this.complete()};c.prototype.onAttach=function(){};c.prototype.onDetach=function(){};c.prototype.onShow=function(){};
c.prototype.onHide=function(){};c.prototype.onEditableChange=function(){};c.prototype.onInputEvent=function(a){};c.prototype.onInputEventAfter=function(a){};Object.defineProperty(c.prototype,"internallyEditable",{get:function(){return this.hasEditableFlag(0)&&this.hasEditableFlag(1)},enumerable:!0,configurable:!0});c.prototype.create=function(){this.created||(this._set("created",!0),this._creationResolver(this))};c.prototype.complete=function(){this.create();this._set("completed",!0)};c.prototype._show=
function(){this._updateManipulatorAttachment();this.onShow()};c.prototype._hide=function(){this._updateManipulatorAttachment();this.onHide()};c.prototype._updateManipulatorAttachment=function(){this.attached&&this.visible?this.manipulators.attach():this.manipulators.detach()};e.__decorate([d.property({constructOnly:!0})],c.prototype,"view",void 0);e.__decorate([d.property({dependsOn:["view.activeTool"],readOnly:!0})],c.prototype,"active",null);e.__decorate([d.property({value:!0})],c.prototype,"visible",
null);e.__decorate([d.property({value:!0})],c.prototype,"editable",null);e.__decorate([d.property({readOnly:!0})],c.prototype,"attached",void 0);e.__decorate([d.property({readOnly:!0})],c.prototype,"created",void 0);e.__decorate([d.property({readOnly:!0})],c.prototype,"completed",void 0);e.__decorate([d.property({readOnly:!0})],c.prototype,"manipulators",void 0);e.__decorate([d.property({constructOnly:!0})],c.prototype,"deferCreation",void 0);return c=e.__decorate([d.subclass("esri.views.interactive.InteractiveToolBase")],
c)}(r);f.InteractiveToolBase=u})},"esri/views/interactive/ManipulatorCollection":function(){define(["require","exports","../../core/Collection","../../core/maybe"],function(u,f,e,r){Object.defineProperty(f,"__esModule",{value:!0});u=function(){function f(){this._isToolEditable=!0;this._manipulators=new e;this._nextManipulatorId=0;this._resourceContexts={manipulator3D:{}};this._attached=!1}Object.defineProperty(f.prototype,"isToolEditable",{set:function(d){this._isToolEditable=d},enumerable:!0,configurable:!0});
Object.defineProperty(f.prototype,"length",{get:function(){return this._manipulators.length},enumerable:!0,configurable:!0});f.prototype.add=function(d,e){void 0===e&&(e=0);return this.addMany([d],e)[0]};f.prototype.addMany=function(d,e){var f=this;void 0===e&&(e=0);return d.map(function(d){var c=f._nextManipulatorId++;d={id:c,manipulator:d,visibilityPredicate:e,attached:!1};f._manipulators.add(d);f._attached&&f._updateManipulatorAttachment(d);return c})};f.prototype.remove=function(d){if("number"===
typeof d){for(var e=0;e<this._manipulators.length;e++)if(this._manipulators.getItemAt(e).id===d)return d=this._manipulators.splice(e,1)[0],this._detachManipulator(d),d.id;return null}for(e=0;e<this._manipulators.length;e++)if(this._manipulators.getItemAt(e).manipulator===d)return d=this._manipulators.splice(e,1)[0],this._detachManipulator(d),d.id;return null};f.prototype.removeAll=function(){var d=this;this._manipulators.forEach(function(e){d._detachManipulator(e)});this._manipulators.removeAll()};
f.prototype.attach=function(){var d=this;this._manipulators.forEach(function(e){d._updateManipulatorAttachment(e)});this._attached=!0};f.prototype.detach=function(){var d=this;this._manipulators.forEach(function(e){d._detachManipulator(e)});this._attached=!1};f.prototype.destroy=function(){this._manipulators.forEach(function(d){d=d.manipulator;d.destroy&&d.destroy()});this._manipulators.destroy();this._resourceContexts=null};f.prototype.on=function(d,e){return this._manipulators.on(d,function(d){e(d)})};
f.prototype.forEach=function(d){for(var e=0,f=this._manipulators.items;e<f.length;e++)d(f[e])};f.prototype.some=function(d){return this._manipulators.items.some(d)};f.prototype.toArray=function(){var d=[];this.forEach(function(e){return d.push(e.manipulator)});return d};f.prototype.intersect=function(d,e){var f=null,g=Number.MAX_VALUE;this._manipulators.forEach(function(c){var a=c.id,b=c.manipulator;c.attached&&b.interactive&&(c=b.intersectionDistance(d,e),r.isSome(c)&&c<g&&(g=c,f=a))});return f};
f.prototype.findById=function(d){if(r.isNone(d))return null;for(var e=0,f=this._manipulators.items;e<f.length;e++){var l=f[e];if(d===l.id)return l.manipulator}return null};f.prototype._updateManipulatorAttachment=function(d){this._isManipulatorItemVisible(d)?this._attachManipulator(d):this._detachManipulator(d)};f.prototype._attachManipulator=function(d){d.attached||(d.manipulator.attach&&d.manipulator.attach(this._resourceContexts),d.attached=!0)};f.prototype._detachManipulator=function(d){if(d.attached){var e=
d.manipulator;e.grabbing=!1;e.dragging=!1;e.hovering=!1;e.selected=!1;e.detach&&e.detach(this._resourceContexts);d.attached=!1}};f.prototype._isManipulatorItemVisible=function(d){return 2===d.visibilityPredicate?!0:this._isToolEditable?0===d.visibilityPredicate:1===d.visibilityPredicate};return f}();f.ManipulatorCollection=u})},"esri/views/input/recognizers/PointerClickHoldAndDrag":function(){define("require exports tslib ../../../core/clock ../InputHandler ./support".split(" "),function(u,f,e,r,
m,d){Object.defineProperty(f,"__esModule",{value:!0});f.DefaultParameters={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500};u=function(g){function k(d,c,a,b,e,k){void 0===d&&(d=f.DefaultParameters.maximumClickDelay);void 0===c&&(c=f.DefaultParameters.movementUntilMouseDrag);void 0===a&&(a=f.DefaultParameters.movementUntilPenDrag);void 0===b&&(b=f.DefaultParameters.movementUntilTouchDrag);void 0===e&&(e=f.DefaultParameters.holdDelay);void 0===
k&&(k=r.default);var l=g.call(this,!1)||this;l.maximumClickDelay=d;l.movementUntilMouseDrag=c;l.movementUntilPenDrag=a;l.movementUntilTouchDrag=b;l.holdDelay=e;l._clock=k;l._pointerState=new Map;l._pointerDrag=l.registerOutgoing("pointer-drag");l._immediateClick=l.registerOutgoing("immediate-click");l._pointerHold=l.registerOutgoing("hold");l.registerIncoming("pointer-down",l._handlePointerDown.bind(l));l.registerIncoming("pointer-up",function(a){l._handlePointerLoss(a,"pointer-up")});l.registerIncoming("pointer-capture-lost",
function(a){l._handlePointerLoss(a,"pointer-capture-lost")});l.registerIncoming("pointer-cancel",function(a){l._handlePointerLoss(a,"pointer-cancel")});l._moveHandle=l.registerIncoming("pointer-move",l._handlePointerMove.bind(l));l._moveHandle.pause();return l}e.__extends(k,g);k.prototype.onUninstall=function(){this._pointerState.forEach(function(d){null!=d.holdTimeout&&(d.holdTimeout.remove(),d.holdTimeout=null)});g.prototype.onUninstall.call(this)};k.prototype._handlePointerDown=function(d){var c=
this,a=d.data,b=a.native.pointerId,e=null;0===this._pointerState.size&&(e=this._clock.setTimeout(function(){var a=c._pointerState.get(b);a&&(a.isDragging||(c._pointerHold.emit(a.previousEvent,void 0,d.modifiers),a.holdEmitted=!0),a.holdTimeout=null)},this.holdDelay));e={startEvent:a,previousEvent:a,startTimestamp:d.timestamp,isDragging:!1,downButton:a.native.button,holdTimeout:e,modifiers:new Set};this._pointerState.set(b,e);this.startCapturingPointer(a.native);this._moveHandle.resume();1<this._pointerState.size&&
this.startDragging(d)};k.prototype._createPointerDragData=function(d,c,a){return{action:d,startEvent:c.startEvent,previousEvent:c.previousEvent,currentEvent:a}};k.prototype._handlePointerMove=function(e){var c=e.data,a=this._pointerState.get(c.native.pointerId);if(a){if(a.isDragging)this._pointerDrag.emit(this._createPointerDragData("update",a,c),void 0,a.modifiers);else{var b=d.euclideanDistance(c,a.startEvent),f=this._getDragThreshold(c.native.pointerType);b>f&&this.startDragging(e)}a.previousEvent=
c}};k.prototype._getDragThreshold=function(d){switch(d){case "touch":return this.movementUntilTouchDrag;case "pen":return this.movementUntilPenDrag;default:return this.movementUntilMouseDrag}};k.prototype.startDragging=function(d){var c=this,a=d.data,b=a.native.pointerId;this._pointerState.forEach(function(e){null!=e.holdTimeout&&(e.holdTimeout.remove(),e.holdTimeout=null);e.isDragging||(e.modifiers=d.modifiers,e.isDragging=!0,b===e.startEvent.native.pointerId?c._pointerDrag.emit(c._createPointerDragData("start",
e,a)):c._pointerDrag.emit(c._createPointerDragData("start",e,e.previousEvent),d.timestamp))})};k.prototype._handlePointerLoss=function(d,c){var a=d.data,b=a.native.pointerId,e=this._pointerState.get(b);e&&(null!=e.holdTimeout&&(e.holdTimeout.remove(),e.holdTimeout=null),e.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",e,"pointer-up"===c?a:e.previousEvent),void 0,e.modifiers):"pointer-up"===c&&e.downButton===a.native.button&&d.timestamp-e.startTimestamp<=this.maximumClickDelay&&
!e.holdEmitted&&this._immediateClick.emit(a),this._pointerState.delete(b),this.stopCapturingPointer(a.native),0===this._pointerState.size&&this._moveHandle.pause())};return k}(m.InputHandler);f.PointerClickHoldAndDrag=u})},"esri/views/input/recognizers/support":function(){define(["require","exports","../../../core/screenUtils"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.manhattanDistance=function(e,f){return Math.abs(f.x-e.x)+Math.abs(f.y-e.y)};f.euclideanDistance=function(e,
f){var d=f.x-e.x;e=f.y-e.y;return Math.sqrt(d*d+e*e)};f.fitCircleLSQ=function(f,m){m?(m.radius=0,m.center.x=0,m.center.y=0):m={radius:0,center:e.createScreenPoint()};if(0===f.length)return m;if(1===f.length)return m.center.x=f[0].x,m.center.y=f[0].y,m;if(2===f.length){var d=f[0];f=f[1];var g=[f.x-d.x,f.y-d.y],k=g[0],g=g[1];m.radius=Math.sqrt(k*k+g*g)/2;m.center.x=(d.x+f.x)/2;m.center.y=(d.y+f.y)/2;return m}for(var l=0,c=0,a=0;a<f.length;a++)l+=f[a].x,c+=f[a].y;for(var l=l/f.length,c=c/f.length,b=
f.map(function(a){return a.x-l}),q=f.map(function(a){return a.y-c}),r=d=m=0,t=0,u=k=0,a=g=0;a<b.length;a++){var z=b[a],A=q[a],E=z*z,H=A*A;m+=E;d+=H;r+=z*A;t+=E*z;k+=H*A;u+=z*H;g+=A*E}a=m;b=r;q=d;t=.5*(t+u);k=.5*(k+g);g=a*q-r*b;u=(t*q-k*b)/g;k=(a*k-r*t)/g;g=e.createScreenPoint(u+l,k+c);return{radius:Math.sqrt(u*u+k*k+(m+d)/f.length),center:g}}})},"esri/views/draw/PolygonDrawAction":function(){define("require exports tslib ../../core/Handles ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ../3d/interactive/editingTools/draw/DrawTool ./DrawAction ./input/DrawEvents ./input/Keys ../input/InputManager".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b){Object.defineProperty(f,"__esModule",{value:!0});u=function(f){function l(a){a=f.call(this,a)||this;a._cursorScreenPoint=null;a._panEnabled=!1;a._cursorVertexAdded=!1;a._popVertexOnPointerMove=!1;a._addVertexOnPointerUp=!1;a._activePointerId=null;a._viewHandles=new r;a.mode="hybrid";a.vertices=[];a.view=null;return a}e.__extends(l,f);l.prototype.initialize=function(){"2d"===this.view.type?this._addViewHandles():this._addDrawTool(this.view)};l.prototype.destroy=function(){"2d"===
this.view.type?(this._removeViewHandles(),this._viewHandles.destroy()):this._removeDrawTool();this.emit("destroy")};Object.defineProperty(l.prototype,"_clickEnabled",{get:function(){return-1!==["hybrid","click"].indexOf(this.mode)},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"_dragEnabled",{get:function(){return-1!==["hybrid","freehand"].indexOf(this.mode)},enumerable:!0,configurable:!0});l.prototype.addVertex=function(a,b){var d=this;this.vertices.splice(b,0,a);this.history.push({vertex:a,
vertexIndex:b,undo:function(){return d._undoVertexAdd(null,b)},redo:function(){return d._redoVertexAdd(null,a,b)}});this._set("redoHistory",[]);var e=new c.VertexAddEvent(this.view,null,b,this.vertices);this.emit("vertex-add",e);e.defaultPrevented&&(this._popVertexOnPointerMove=!0,this.history.pop())};l.prototype.removeVertex=function(a){var b=this,d=this.vertices.splice(a,1)[0];this.history.push({vertex:d,vertexIndex:a,undo:function(){return b._undoVertexRemove(null,d,a)},redo:function(){return b._redoVertexRemove(null,
a)}});this._set("redoHistory",[]);this.emit("vertex-remove",new c.VertexRemoveEvent(this.view,null,a,this.vertices))};l.prototype.updateVertex=function(a,b){var d=this,e=this.vertices[b];this.vertices[b]=a;this.history.push({vertex:a,vertexIndex:b,undo:function(){return d._undoVertexUpdate(null,e,b)},redo:function(){return d._redoVertexUpdate(null,a,b)}});this._set("redoHistory",[]);this.emit("vertex-update",new c.VertexUpdateEvent(this.view,null,b,this.vertices))};l.prototype.complete=function(){"2d"===
this.view.type?this._completeDrawing():this._drawTool.completeCreateOperation()};l.prototype.getGeometryZValue=function(){return 0<this.vertices.length&&2<this.vertices[0].length?this.vertices[0][2]:this._get("defaultZ")};l.prototype._addViewHandles=function(){var c=this;this._removeViewHandles();this._viewHandles.add([this.view.on("click",function(a){a.stopPropagation()},b.ViewEventPriorities.TOOL),this.view.on("pointer-down",function(a){c._shouldHandlePointerEvent(a)&&!c._panEnabled&&(c._activePointerId=
a.pointerId,c._addVertexOnPointerUp=!0,c._cursorScreenPoint=d.createScreenPointFromEvent(a),"touch"===a.pointerType&&c._updateCursor(a.native))},b.ViewEventPriorities.TOOL),this.view.on("pointer-move",function(a){c._popVertexOnPointerMove&&(c.vertices.pop(),c._popVertexOnPointerMove=!1);c._cursorScreenPoint=d.createScreenPointFromEvent(a);"touch"!==a.pointerType&&c._updateCursor(a.native)},b.ViewEventPriorities.TOOL),this.view.on("pointer-drag",function(a){c._shouldHandlePointerEvent(a)&&(c._cursorScreenPoint=
d.createScreenPointFromEvent(a),c._dragEnabled&&!c._panEnabled?c._vertexAddHandler(a):c._addVertexOnPointerUp=!1)},b.ViewEventPriorities.TOOL),this.view.on("pointer-up",function(a){c._shouldHandlePointerEvent(a)&&(c._activePointerId=null,c._addVertexOnPointerUp?c._clickEnabled?c._vertexAddHandler(a):(1===c.vertices.length&&c.vertices.pop(),c._drawCompleteHandler(a)):c._updateCursor(a.native,"touch"===a.pointerType))},b.ViewEventPriorities.TOOL),this.view.on("drag",function(a){c._dragEnabled&&m.isSome(c._activePointerId)&&
!c._panEnabled&&a.stopPropagation()},b.ViewEventPriorities.TOOL),this.view.on("drag",["Shift"],function(a){a.stopPropagation()},b.ViewEventPriorities.TOOL),this.view.on("double-click",function(a){a.stopPropagation();c._drawCompleteHandler(a)},b.ViewEventPriorities.TOOL),this.view.on("double-click",["Control"],function(a){a.stopPropagation();c._drawCompleteHandler(a)},b.ViewEventPriorities.TOOL),this.view.on("key-down",function(b){var d=b.key,e=b.repeat;d===a.KEYS.vertexAddKey&&!e&&c._cursorScreenPoint?
(b.stopPropagation(),c._vertexAddHandler(b)):d===a.KEYS.drawCompleteKey&&!e&&c._cursorScreenPoint&&2<c.vertices.length?(b.stopPropagation(),c._vertexAddHandler(b),c._drawCompleteHandler(b)):d!==a.KEYS.undoKey||c.interactiveUndoDisabled||e?d!==a.KEYS.redoKey||c.interactiveUndoDisabled||e?d!==a.KEYS.panKey||e||(b.stopPropagation(),c._panEnabled=!0):(b.stopPropagation(),c.redo()):(b.stopPropagation(),c.undo())},b.ViewEventPriorities.TOOL),this.view.on("key-up",function(b){b.key===a.KEYS.panKey&&(b.stopPropagation(),
c._panEnabled=!1)},b.ViewEventPriorities.TOOL)])};l.prototype._removeViewHandles=function(){this._viewHandles.removeAll()};l.prototype._addDrawTool=function(a){var b=this;this._drawTool=new k.DrawTool({view:a,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"polygon"});this.view.toolViewManager.tools.push(this._drawTool);this.view.activeTool=this._drawTool;this._drawTool.on("vertex-add",function(a){1===a.vertices.length&&b.emit("vertex-add",new c.VertexAddEvent(b.view,null,a.vertices[0].vertexIndex,
b._drawTool.getVertexCoords()))});this._drawTool.on("cursor-update",function(a){1===a.vertices.length&&b.emit("cursor-update",new c.CursorUpdateEvent(b.view,null,a.vertices[0].vertexIndex,b._drawTool.getVertexCoords()))});this._drawTool.on("complete",function(a){b.emit("draw-complete",new c.DrawCompleteEvent(null,b._drawTool.getVertexCoords()));b._removeDrawTool()})};l.prototype._removeDrawTool=function(){m.isSome(this._drawTool)&&(this.view.tools.remove(this._drawTool),this._drawTool.destroy(),this._drawTool=
null)};l.prototype._addVertex=function(a,b){var d=this;this._popCursorVertex();if(!this.isDuplicateVertex(this.vertices,a)){var e=this.vertices.length;this.vertices.push(a);this.history.push({vertex:a,vertexIndex:e,undo:function(){return d._undoVertexAdd(b,e)},redo:function(){return d._redoVertexAdd(b,a,e)}});this._set("redoHistory",[]);var f=new c.VertexAddEvent(this.view,b,e,this.vertices);this.emit("vertex-add",f);f.defaultPrevented&&(this._popVertexOnPointerMove=!0,this.history.pop())}};l.prototype._updateCursor=
function(a,b){void 0===b&&(b=!1);this._popCursorVertex();if(this._cursorScreenPoint){var d=null,e=null,f=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);m.isSome(f)&&(d=f.mapPoint,b||(e=this._pushCursorVertex(f.vertex)));a=new c.CursorUpdateEvent(this.view,a,e,this.vertices,d);this.emit("cursor-update",a)}};l.prototype._completeDrawing=function(a){this._activePointerId=null;this._popCursorVertex();3>this.vertices.length||(a=new c.DrawCompleteEvent(a,this.vertices),this.emit("draw-complete",
a),a.defaultPrevented||this._removeViewHandles())};l.prototype._undoVertexAdd=function(a,b){this.vertices.splice(b,1);this.emit("undo",new c.VertexRemoveEvent(this.view,a,b,this.vertices))};l.prototype._redoVertexAdd=function(a,b,d){this.vertices.splice(d,0,b);this.emit("redo",new c.VertexAddEvent(this.view,a,d,this.vertices))};l.prototype._undoVertexRemove=function(a,b,d){this.vertices.splice(d,0,b);this.emit("undo",new c.VertexAddEvent(this.view,a,d,this.vertices))};l.prototype._redoVertexRemove=
function(a,b){this.vertices.splice(b,1);this.emit("redo",new c.VertexRemoveEvent(this.view,a,b,this.vertices))};l.prototype._undoVertexUpdate=function(a,b,d){this.vertices[d]=b;this.emit("undo",new c.VertexUpdateEvent(this.view,a,d,this.vertices))};l.prototype._redoVertexUpdate=function(a,b,d){this.vertices[d]=b;this.emit("redo",new c.VertexUpdateEvent(this.view,a,d,this.vertices))};l.prototype._pushCursorVertex=function(a){this._popCursorVertex();this.vertices.push(a);this._cursorVertexAdded=!0;
return this.vertices.length-1};l.prototype._popCursorVertex=function(){this._cursorVertexAdded&&(this.vertices.pop(),this._cursorVertexAdded=!1)};l.prototype._shouldHandlePointerEvent=function(a){return("mouse"!==a.pointerType||0===a.button)&&(m.isNone(this._activePointerId)||this._activePointerId===a.pointerId)};l.prototype._vertexAddHandler=function(a){if(this._cursorVertexAdded)this._addVertex(this.vertices[this.vertices.length-1],a.native);else{var b=this.getCoordsFromScreenPoint(this._cursorScreenPoint);
m.isSome(b)&&this._addVertex(b,a.native)}};l.prototype._drawCompleteHandler=function(a){this._completeDrawing(a.native)};e.__decorate([g.property({dependsOn:["mode"]})],l.prototype,"_clickEnabled",null);e.__decorate([g.property({dependsOn:["mode"]})],l.prototype,"_dragEnabled",null);e.__decorate([g.property({cast:function(a){return-1===["hybrid","freehand","click"].indexOf(a)?"hybrid":a}})],l.prototype,"mode",void 0);e.__decorate([g.property({readOnly:!0})],l.prototype,"vertices",void 0);e.__decorate([g.property()],
l.prototype,"view",void 0);return l=e.__decorate([g.subclass("esri.views.draw.PolygonDrawAction")],l)}(l);f.PolygonDrawAction=u})},"esri/views/draw/PolylineDrawAction":function(){define("require exports tslib ../../core/Handles ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ../3d/interactive/editingTools/draw/DrawTool ./DrawAction ./input/DrawEvents ./input/Keys ../input/InputManager".split(" "),function(u,f,e,r,m,d,g,k,l,c,a,b){Object.defineProperty(f,"__esModule",
{value:!0});u=function(f){function l(a){a=f.call(this,a)||this;a._cursorScreenPoint=null;a._panEnabled=!1;a._cursorVertexAdded=!1;a._popVertexOnPointerMove=!1;a._addVertexOnPointerUp=!1;a._activePointerId=null;a._viewHandles=new r;a.mode="hybrid";a.vertices=[];a.view=null;return a}e.__extends(l,f);l.prototype.initialize=function(){"2d"===this.view.type?this._addViewHandles():this._addDrawTool(this.view)};l.prototype.destroy=function(){"2d"===this.view.type?(this._removeViewHandles(),this._viewHandles.destroy()):
this._removeDrawTool();this.emit("destroy")};Object.defineProperty(l.prototype,"_clickEnabled",{get:function(){return-1!==["hybrid","click"].indexOf(this.mode)},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"_dragEnabled",{get:function(){return-1!==["hybrid","freehand"].indexOf(this.mode)},enumerable:!0,configurable:!0});l.prototype.addVertex=function(a,b){var d=this;this.vertices.splice(b,0,a);this.history.push({vertex:a,vertexIndex:b,undo:function(){return d._undoVertexAdd(null,
b)},redo:function(){return d._redoVertexAdd(null,a,b)}});this._set("redoHistory",[]);var e=new c.VertexAddEvent(this.view,null,b,this.vertices);this.emit("vertex-add",e);e.defaultPrevented&&(this._popVertexOnPointerMove=!0,this.history.pop())};l.prototype.removeVertex=function(a){var b=this,d=this.vertices.splice(a,1)[0];this.history.push({vertex:d,vertexIndex:a,undo:function(){return b._undoVertexRemove(null,d,a)},redo:function(){return b._redoVertexRemove(null,a)}});this._set("redoHistory",[]);
this.emit("vertex-remove",new c.VertexRemoveEvent(this.view,null,a,this.vertices))};l.prototype.updateVertex=function(a,b){var d=this,e=this.vertices[b];this.vertices[b]=a;this.history.push({vertex:a,vertexIndex:b,undo:function(){return d._undoVertexUpdate(null,e,b)},redo:function(){return d._redoVertexUpdate(null,a,b)}});this._set("redoHistory",[]);this.emit("vertex-update",new c.VertexUpdateEvent(this.view,null,b,this.vertices))};l.prototype.complete=function(){"2d"===this.view.type?this._completeDrawing():
this._drawTool.completeCreateOperation()};l.prototype._addViewHandles=function(){var c=this;this._removeViewHandles();this._viewHandles.add([this.view.on("click",function(a){a.stopPropagation()},b.ViewEventPriorities.TOOL),this.view.on("pointer-down",function(a){c._shouldHandlePointerEvent(a)&&!c._panEnabled&&(c._activePointerId=a.pointerId,c._addVertexOnPointerUp=!0,c._cursorScreenPoint=d.createScreenPointFromEvent(a),"touch"===a.pointerType&&c._updateCursor(a.native))},b.ViewEventPriorities.TOOL),
this.view.on("pointer-move",function(a){c._popVertexOnPointerMove&&(c.vertices.pop(),c._popVertexOnPointerMove=!1);c._cursorScreenPoint=d.createScreenPointFromEvent(a);"touch"!==a.pointerType&&c._updateCursor(a.native)},b.ViewEventPriorities.TOOL),this.view.on("pointer-drag",function(a){c._shouldHandlePointerEvent(a)&&(c._cursorScreenPoint=d.createScreenPointFromEvent(a),c._dragEnabled&&!c._panEnabled?c._vertexAddHandler(a):c._addVertexOnPointerUp=!1)},b.ViewEventPriorities.TOOL),this.view.on("pointer-up",
function(a){c._shouldHandlePointerEvent(a)&&(c._activePointerId=null,c._addVertexOnPointerUp?c._clickEnabled?c._vertexAddHandler(a):(1===c.vertices.length&&c.vertices.pop(),c._drawCompleteHandler(a)):c._updateCursor(a.native,"touch"===a.pointerType))},b.ViewEventPriorities.TOOL),this.view.on("drag",function(a){c._dragEnabled&&m.isSome(c._activePointerId)&&!c._panEnabled&&a.stopPropagation()},b.ViewEventPriorities.TOOL),this.view.on("drag",["Shift"],function(a){a.stopPropagation()},b.ViewEventPriorities.TOOL),
this.view.on("double-click",function(a){a.stopPropagation();c._drawCompleteHandler(a)},b.ViewEventPriorities.TOOL),this.view.on("double-click",["Control"],function(a){a.stopPropagation();c._drawCompleteHandler(a)},b.ViewEventPriorities.TOOL),this.view.on("key-down",function(b){var d=b.key,e=b.repeat;d===a.KEYS.vertexAddKey&&!e&&c._cursorScreenPoint?(b.stopPropagation(),c._vertexAddHandler(b)):d===a.KEYS.drawCompleteKey&&!e&&c._cursorScreenPoint&&1<c.vertices.length?(b.stopPropagation(),c._vertexAddHandler(b),
c._drawCompleteHandler(b)):d!==a.KEYS.undoKey||c.interactiveUndoDisabled||e?d!==a.KEYS.redoKey||c.interactiveUndoDisabled||e?d!==a.KEYS.panKey||e||(b.stopPropagation(),c._panEnabled=!0):(b.stopPropagation(),c.redo()):(b.stopPropagation(),c.undo())},b.ViewEventPriorities.TOOL),this.view.on("key-up",function(b){b.key===a.KEYS.panKey&&(b.stopPropagation(),c._panEnabled=!1)},b.ViewEventPriorities.TOOL)])};l.prototype._removeViewHandles=function(){this._viewHandles.removeAll()};l.prototype._addDrawTool=
function(a){var b=this;this._drawTool=new k.DrawTool({view:a,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"polyline"});this.view.toolViewManager.tools.push(this._drawTool);this.view.activeTool=this._drawTool;this._drawTool.on("vertex-add",function(a){1===a.vertices.length&&b.emit("vertex-add",new c.VertexAddEvent(b.view,null,a.vertices[0].vertexIndex,b._drawTool.getVertexCoords()))});this._drawTool.on("cursor-update",function(a){1===a.vertices.length&&b.emit("cursor-update",new c.CursorUpdateEvent(b.view,
null,a.vertices[0].vertexIndex,b._drawTool.getVertexCoords()))});this._drawTool.on("complete",function(a){b.emit("draw-complete",new c.DrawCompleteEvent(null,b._drawTool.getVertexCoords()));b._removeDrawTool()})};l.prototype._removeDrawTool=function(){m.isSome(this._drawTool)&&(this.view.tools.remove(this._drawTool),this._drawTool.destroy(),this._drawTool=null)};l.prototype._addVertex=function(a,b){var d=this;this._popCursorVertex();if(!this.isDuplicateVertex(this.vertices,a)){this.vertices.push(a);
var e=this.vertices.length-1;this.history.push({vertex:a,vertexIndex:e,undo:function(){return d._undoVertexAdd(b,e)},redo:function(){return d._redoVertexAdd(b,a,e)}});this._set("redoHistory",[]);var f=new c.VertexAddEvent(this.view,b,e,this.vertices);this.emit("vertex-add",f);f.defaultPrevented&&(this._popVertexOnPointerMove=!0,this.history.pop())}};l.prototype._updateCursor=function(a,b){void 0===b&&(b=!1);this._popCursorVertex();if(this._cursorScreenPoint){var d=null,e=null,f=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);
m.isSome(f)&&(d=f.mapPoint,b||(e=this._pushCursorVertex(f.vertex)));a=new c.CursorUpdateEvent(this.view,a,e,this.vertices,d);this.emit("cursor-update",a)}};l.prototype._completeDrawing=function(a){this._activePointerId=null;this._popCursorVertex();2>this.vertices.length||(a=new c.DrawCompleteEvent(a,this.vertices),this.emit("draw-complete",a),a.defaultPrevented||this._removeViewHandles())};l.prototype._undoVertexAdd=function(a,b){this.vertices.splice(b,1);this.emit("undo",new c.VertexRemoveEvent(this.view,
a,b,this.vertices))};l.prototype._redoVertexAdd=function(a,b,d){this.vertices.splice(d,0,b);this.emit("redo",new c.VertexAddEvent(this.view,a,d,this.vertices))};l.prototype._undoVertexRemove=function(a,b,d){this.vertices.splice(d,0,b);this.emit("undo",new c.VertexAddEvent(this.view,a,d,this.vertices))};l.prototype._redoVertexRemove=function(a,b){this.vertices.splice(b,1);this.emit("redo",new c.VertexRemoveEvent(this.view,a,b,this.vertices))};l.prototype._undoVertexUpdate=function(a,b,d){this.vertices[d]=
b;this.emit("undo",new c.VertexUpdateEvent(this.view,a,d,this.vertices))};l.prototype._redoVertexUpdate=function(a,b,d){this.vertices[d]=b;this.emit("redo",new c.VertexUpdateEvent(this.view,a,d,this.vertices))};l.prototype._pushCursorVertex=function(a){this._popCursorVertex();this.vertices.push(a);this._cursorVertexAdded=!0;return this.vertices.length-1};l.prototype._popCursorVertex=function(){this._cursorVertexAdded&&(this.vertices.pop(),this._cursorVertexAdded=!1)};l.prototype._shouldHandlePointerEvent=
function(a){return("mouse"!==a.pointerType||0===a.button)&&(m.isNone(this._activePointerId)||this._activePointerId===a.pointerId)};l.prototype._vertexAddHandler=function(a){if(this._cursorVertexAdded)this._addVertex(this.vertices[this.vertices.length-1],a.native);else{var b=this.getCoordsFromScreenPoint(this._cursorScreenPoint);m.isSome(b)&&this._addVertex(b,a.native)}};l.prototype._drawCompleteHandler=function(a){this._completeDrawing(a.native)};e.__decorate([g.property({dependsOn:["mode"]})],l.prototype,
"_clickEnabled",null);e.__decorate([g.property({dependsOn:["mode"]})],l.prototype,"_dragEnabled",null);e.__decorate([g.property({cast:function(a){return-1===["hybrid","freehand","click"].indexOf(a)?"hybrid":a}})],l.prototype,"mode",void 0);e.__decorate([g.property({readOnly:!0})],l.prototype,"vertices",void 0);e.__decorate([g.property()],l.prototype,"view",void 0);return l=e.__decorate([g.subclass("esri.views.draw.PolylineDrawAction")],l)}(l);f.PolylineDrawAction=u})},"esri/views/draw/SegmentDrawAction":function(){define("require exports tslib ../../core/Handles ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ../3d/interactive/editingTools/draw/DrawTool ./DrawAction ./input/DrawEvents ./input/Keys ./support/createUtils ../input/InputManager".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q){Object.defineProperty(f,"__esModule",{value:!0});u=function(f){function l(a){a=f.call(this,a)||this;a._isDragging=!1;a._panEnabled=!1;a._cursorScreenPoint=null;a._viewHandles=new r;a._cursorVertexAdded=!1;a._activePointerId=null;a.viewAlignedCoordinateSystem=null;a.mode="freehand";a.vertices=[];a.view=null;return a}e.__extends(l,f);l.prototype.initialize=function(){"2d"===this.view.type?this._addViewHandles():this._addDrawTool(this.view)};l.prototype.destroy=function(){"2d"===
this.view.type?(this._removeViewHandles(),this._viewHandles.destroy()):this._removeDrawTool();this.emit("destroy")};l.prototype.complete=function(){"2d"===this.view.type?this._completeDrawing():this._drawTool.completeCreateOperation()};l.prototype.getGeometryZValue=function(){return 0<this.vertices.length&&2<this.vertices[0].length?this.vertices[0][2]:this._get("defaultZ")};l.prototype._addViewHandles=function(){this._removeViewHandles();"click"===this.mode?this._viewHandles.add(this._getClickModeViewHandles()):
this._viewHandles.add(this._getDragModeViewHandles())};l.prototype._getDragModeViewHandles=function(){var b=this;return[this.view.on("click",function(a){a.stopPropagation();if(a.mapPoint&&!b._panEnabled){var c=b.getCoordsFromScreenPoint(a.screenPoint);m.isSome(c)&&(b._set("vertices",[c]),b._drawCompleteHandler(a))}},q.ViewEventPriorities.TOOL),this.view.on("pointer-down",function(a){b._shouldHandlePointerEvent(a)&&!b._panEnabled&&(b._cursorScreenPoint=d.createScreenPointFromEvent(a),b._set("vertices",
[]),b._activePointerId=a.pointerId,b._vertexAddHandler(a),b._isDragging=!1,"touch"===a.pointerType&&b._cursorUpdateHandler(a))},q.ViewEventPriorities.TOOL),this.view.on("pointer-move",function(a){b._cursorScreenPoint=d.createScreenPointFromEvent(a);m.isNone(b._activePointerId)&&"touch"!==a.pointerType&&0===b.vertices.length&&b._cursorUpdateHandler(a)},q.ViewEventPriorities.TOOL),this.view.on("pointer-drag",function(a){b._shouldHandlePointerEvent(a)&&(b._isDragging=!0,b._cursorScreenPoint=d.createScreenPointFromEvent(a),
b._cursorUpdateHandler(a))},q.ViewEventPriorities.TOOL),this.view.on("pointer-up",function(a){b._shouldHandlePointerEvent(a)&&(b._activePointerId=null,b._popCursorVertex(),b._isDragging&&!b._panEnabled&&(b._vertexAddHandler(a),b._drawCompleteHandler(a)),b._isDragging=!1)},q.ViewEventPriorities.TOOL),this.view.on("key-down",function(c){c.key===a.KEYS.drawCompleteKey&&b._cursorScreenPoint?b._drawCompleteHandler(c):c.key===a.KEYS.panKey&&(b._panEnabled=!0)},q.ViewEventPriorities.TOOL),this.view.on("key-up",
function(c){c.key===a.KEYS.panKey&&(b._panEnabled=!1)},q.ViewEventPriorities.TOOL),this.view.on("drag",function(a){m.isSome(b._activePointerId)&&a.stopPropagation()},q.ViewEventPriorities.TOOL),this.view.on("drag",["Shift"],function(a){a.stopPropagation()},q.ViewEventPriorities.TOOL)]};l.prototype._getClickModeViewHandles=function(){var b=this;return[this.view.on("click",function(a){a.stopPropagation()},q.ViewEventPriorities.TOOL),this.view.on("pointer-down",function(a){b._cursorScreenPoint=d.createScreenPointFromEvent(a);
b._activePointerId=a.pointerId;b._isDragging=!1;"touch"===a.pointerType&&b._cursorUpdateHandler(a)},q.ViewEventPriorities.TOOL),this.view.on("pointer-move",function(a){b._cursorScreenPoint=d.createScreenPointFromEvent(a);m.isNone(b._activePointerId)&&"touch"!==a.pointerType&&b._cursorUpdateHandler(a)},q.ViewEventPriorities.TOOL),this.view.on("pointer-drag",function(a){b._shouldHandlePointerEvent(a)&&(b._isDragging=!0)},q.ViewEventPriorities.TOOL),this.view.on("pointer-up",function(a){b._shouldHandlePointerEvent(a)&&
(b._activePointerId=null,b._isDragging||b._vertexAddHandler(a),2!==b.vertices.length||b._isDragging||b._drawCompleteHandler(a),b._isDragging=!1)},q.ViewEventPriorities.TOOL),this.view.on("key-down",function(c){c.key===a.KEYS.vertexAddKey&&b._cursorScreenPoint&&(b._vertexAddHandler(c),2===b.vertices.length&&b._drawCompleteHandler(c));c.key===a.KEYS.drawCompleteKey&&b._cursorScreenPoint&&2===b.vertices.length&&b._drawCompleteHandler(c)},q.ViewEventPriorities.TOOL)]};l.prototype._removeViewHandles=function(){this._viewHandles.removeAll()};
l.prototype._addDrawTool=function(a){var b=this;this._drawTool=new k.DrawTool({view:a,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"segment"});this.view.toolViewManager.tools.push(this._drawTool);this.view.activeTool=this._drawTool;this._drawTool.on("vertex-add",function(a){1===a.vertices.length&&b.emit("vertex-add",new c.VertexAddEvent(b.view,null,a.vertices[0].vertexIndex,b._drawTool.getVertexCoords()))});this._drawTool.on("cursor-update",function(a){1===a.vertices.length&&b.emit("cursor-update",
new c.CursorUpdateEvent(b.view,null,a.vertices[0].vertexIndex,b._drawTool.getVertexCoords()))});this._drawTool.on("complete",function(a){b.emit("draw-complete",new c.DrawCompleteEvent(null,b._drawTool.getVertexCoords()));b._removeDrawTool()})};l.prototype._removeDrawTool=function(){m.isSome(this._drawTool)&&(this.view.tools.remove(this._drawTool),this._drawTool.destroy(),this._drawTool=null)};l.prototype._addVertex=function(a,d){this._popCursorVertex();this.isDuplicateVertex(this.vertices,a)||(this.vertices.push(a),
1===this.vertices.length&&(this.viewAlignedCoordinateSystem=b.createViewAlignedCoordinateSystem(this.view,this.vertices[0])),a=this.vertices.indexOf(a),d=new c.VertexAddEvent(this.view,d,a,this.vertices),this.emit("vertex-add",d))};l.prototype._updateCursor=function(a,b){var d=null;m.isSome(a)&&(d=this._pushCursorVertex(a));a=new c.CursorUpdateEvent(this.view,b,d,this.vertices);this.emit("cursor-update",a)};l.prototype._completeDrawing=function(a){this._activePointerId=null;this._popCursorVertex();
this._isDragging=!1;this._cursorScreenPoint=null;1>this.vertices.length||(a=new c.DrawCompleteEvent(a,this.vertices),this.emit("draw-complete",a),a.defaultPrevented||this._removeViewHandles())};l.prototype._pushCursorVertex=function(a){this._popCursorVertex();this.vertices.push(a);this._cursorVertexAdded=!0;return this.vertices.length-1};l.prototype._popCursorVertex=function(){this._cursorVertexAdded&&(this.vertices.pop(),this._cursorVertexAdded=!1)};l.prototype._shouldHandlePointerEvent=function(a){return("mouse"!==
a.pointerType||0===a.button)&&(m.isNone(this._activePointerId)||this._activePointerId===a.pointerId)};l.prototype._vertexAddHandler=function(a){var b=this.getCoordsFromScreenPoint(this._cursorScreenPoint);m.isSome(b)&&this._addVertex(b,a.native)};l.prototype._cursorUpdateHandler=function(a){var b=this.getCoordsFromScreenPoint(this._cursorScreenPoint);this._updateCursor(b,a.native)};l.prototype._drawCompleteHandler=function(a){this._completeDrawing(a.native)};e.__decorate([g.property({cast:function(a){return-1===
["freehand","click"].indexOf(a)?"freehand":a}})],l.prototype,"mode",void 0);e.__decorate([g.property({readOnly:!0})],l.prototype,"vertices",void 0);e.__decorate([g.property()],l.prototype,"view",void 0);return l=e.__decorate([g.subclass("esri/views/2d/engine/markup/SegmentDrawAction")],l)}(l);f.SegmentDrawAction=u})},"esri/views/draw/support/createUtils":function(){define("require exports tslib ../../../geometry ../../../core/arrayUtils ../../../core/lang ../../../core/maybe ../../../core/unitUtils ../../../core/libs/gl-matrix-2/mat2d ../../../core/libs/gl-matrix-2/mat2df64 ../../../core/libs/gl-matrix-2/quat ../../../core/libs/gl-matrix-2/quatf64 ../../../core/libs/gl-matrix-2/vec3 ../../../core/libs/gl-matrix-2/vec3f64 ../../../geometry/Circle ../../../geometry/geometryEngine ../../../geometry/support/coordsUtils ../../../geometry/support/spatialReferenceUtils".split(" "),
function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A){function E(a,b,c){void 0===c&&(c=null);return g.isSome(c)?[a,b,c]:[a,b]}function H(a,b,c){void 0===c&&(c=null);return g.isSome(c)?{x:a,y:b,z:c}:{x:a,y:b}}function J(a,b){b=new r.Point({x:a[0],y:a[1],spatialReference:b});2<a.length&&(b.z=a[2]);return b}function B(a,b,c,e){void 0===e&&(e=!0);a=d.clone(a);a.forEach(function(a){m.equals(a[0],a[a.length-1])||a.push(a[0])});a=new r.Polygon({rings:a,spatialReference:b});a.rings.forEach(function(a){z.isClockwise(a,
!1,!1)||a.reverse()});c&&z.unnormalizeGeometryOnDatelineCrossing(a);e&&a.isSelfIntersecting&&A.isValid(b)&&(a=x.simplify(a));return a}Object.defineProperty(f,"__esModule",{value:!0});f.makeMapPoint=E;f.makeSurfacePoint=H;u=function(){function a(a){this.spatialReference=a}a.prototype.mapToLocalMultiple=function(a){var b=this;return a.map(function(a){return b.mapToLocal(a)})};Object.defineProperty(a.prototype,"doUnnormalization",{get:function(){return!1},enumerable:!0,configurable:!0});return a}();
f.SurfaceCoordinateSystem=u;var G=function(a){function b(b,d,e){void 0===e&&(e=null);d=a.call(this,d)||this;d.defaultZ=e;d.transform=c.mat2df64.create();d.transformInv=c.mat2df64.create();d.transform=c.mat2df64.clone(b);l.mat2d.invert(d.transformInv,d.transform);return d}e.__extends(b,a);b.prototype.makeMapPoint=function(a,b){return E(a,b,this.defaultZ)};b.prototype.mapToLocal=function(a){return H(this.transform[0]*a[0]+this.transform[2]*a[1]+this.transform[4],this.transform[1]*a[0]+this.transform[3]*
a[1]+this.transform[5])};b.prototype.localToMap=function(a){return E(this.transformInv[0]*a.x+this.transformInv[2]*a.y+this.transformInv[4],this.transformInv[1]*a.x+this.transformInv[3]*a.y+this.transformInv[5],this.defaultZ)};return b}(u);f.AffineCoordinateSystem=G;var F=function(c){function d(d,e){var f=c.call(this,d.spatialReference)||this;f.view=d;f.defaultZ=null;f.pWS=v.vec3f64.create();f.tangentFrameUpWS=v.vec3f64.create();f.tangentFrameRightWS=v.vec3f64.create();f.tangentFrameForwardWS=v.vec3f64.create();
f.localFrameRightWS=v.vec3f64.create();f.localFrameUpWS=v.vec3f64.create();f.worldToLocalTransform=b.quatf64.create();f.localToWorldTransform=b.quatf64.create();f.scale=1;f.scale=d.resolution;f.referenceMapPoint=e;f.defaultZ=e.hasZ?e.z:null;d=d.state.camera.viewRight;f.view.renderCoordsHelper.toRenderCoords(f.referenceMapPoint,f.pWS);f.view.renderCoordsHelper.worldBasisAtPosition(f.pWS,0,f.tangentFrameRightWS);f.view.renderCoordsHelper.worldBasisAtPosition(f.pWS,1,f.tangentFrameUpWS);f.view.renderCoordsHelper.worldBasisAtPosition(f.pWS,
2,f.tangentFrameForwardWS);e=v.vec3f64.create();q.vec3.scale(e,f.tangentFrameForwardWS,q.vec3.dot(d,f.tangentFrameForwardWS));q.vec3.subtract(f.localFrameRightWS,d,e);q.vec3.normalize(f.localFrameRightWS,f.localFrameRightWS);q.vec3.cross(f.localFrameUpWS,f.tangentFrameForwardWS,f.localFrameRightWS);a.quat.rotationTo(f.worldToLocalTransform,f.localFrameRightWS,f.tangentFrameRightWS);a.quat.invert(f.localToWorldTransform,f.worldToLocalTransform);return f}e.__extends(d,c);Object.defineProperty(d.prototype,
"doUnnormalization",{get:function(){return"global"===this.view.viewingMode},enumerable:!0,configurable:!0});d.prototype.makeMapPoint=function(a,b){return E(a,b,this.defaultZ)};d.prototype.mapToLocal=function(a){var b=v.vec3f64.create();this.view.renderCoordsHelper.toRenderCoords(new r.Point({x:a[0],y:a[1],spatialReference:this.spatialReference}),b);q.vec3.transformQuat(b,b,this.worldToLocalTransform);a=this.view.renderCoordsHelper.fromRenderCoords(b,this.view.spatialReference);return H(a.x/this.scale,
a.y/this.scale)};d.prototype.localToMap=function(a){var b=v.vec3f64.create();this.view.renderCoordsHelper.toRenderCoords(new r.Point({x:a.x*this.scale,y:a.y*this.scale,spatialReference:this.spatialReference}),b);q.vec3.transformQuat(b,b,this.localToWorldTransform);a=this.view.renderCoordsHelper.fromRenderCoords(b,this.view.spatialReference);return E(a.x,a.y,this.defaultZ)};return d}(u);f.SceneViewCoordinateSystem=F;f.createViewAlignedCoordinateSystem=function(a,b){return"2d"===a.type?new G(a.state.transform,
a.spatialReference,2<b.length?b[2]:null):"3d"===a.type?(b=2<b.length?new r.Point({x:b[0],y:b[1],z:b[2],spatialReference:a.spatialReference}):new r.Point({x:b[0],y:b[1],spatialReference:a.spatialReference}),new F(a,b)):null};f.createPoint=J;f.createMultipoint=function(a,b){return new r.Multipoint({points:a,spatialReference:b})};f.createPolyline=function(a,b,c){a=new r.Polyline({paths:a,spatialReference:b});c&&z.unnormalizeGeometryOnDatelineCrossing(a);return a};f.createPolygon=B;f.createSquare=function(a,
b,c){var d=b.mapToLocalMultiple(a);a=[];var e=d[0].x,f=d[0].y,g=Math.round(d[1].x-e),k=Math.round(d[1].y-f),d=Math.max(Math.abs(g),Math.abs(k));c?(c=e+d,g=f+d,e-=d,f-=d,a.push(H(c,f),H(e,f),H(e,g),H(c,g))):(c=0<g?e+d:e-d,d=0<k?f+d:f-d,a.push(H(e,f),H(c,f),H(c,d),H(e,d)));return B([a.map(function(a){return b.localToMap(a)})],b.spatialReference,b.doUnnormalization,!0)};f.createRectangle=function(a,b,c){var d=b.mapToLocalMultiple(a);1===d.length&&(a=d[0],d=[H(a.x-48,a.y+48),H(a.x+48,a.y-48),H(a.x+48,
a.y-48),H(a.x-48,a.y+48)]);a=[];var e=d[0].x,f=d[0].y,g=d[1].x,d=d[1].y;if(c){c=Math.round(g-e);var k=Math.round(d-f);a.push(H(e-c,f-k),H(g,f-k),H(g,d),H(e-c,d))}else a.push(H(e,f),H(g,f),H(g,d),H(e,d));return B([a.map(function(a){return b.localToMap(a)})],b.spatialReference,b.doUnnormalization,!0)};f.createCircle=function(a,b,c,d){var e=b.mapToLocalMultiple(a),f=a=null;c?(a=e[0],f=e[1]):(a=e[0],f=e[1],c=Math.round(f.x-a.x),f=Math.round(f.y-a.y),e=Math.max(Math.abs(c),Math.abs(f)),a=H(0<c?a.x+e/2:
a.x-e/2,0<f?a.y+e/2:a.y-e/2),f=H(Math.abs(c)>Math.abs(f)?a.x-e/2:a.x,Math.abs(c)>Math.abs(f)?a.y:a.y-e/2));e=b.localToMap(a);c=b.localToMap(f);b.doUnnormalization&&z.unnormalizeVerticesOnDatelineCrossing([[e,c]],b.spatialReference);e=J(e,b.spatialReference);c=J(c,b.spatialReference);var g=k.getMetersPerUnitForSR(b.spatialReference),l=0;A.isValid(b.spatialReference)?l=g*x.distance(e,c,null):(c=a.x-f.x,f=a.y-f.y,l=g*Math.sqrt(c*c+f*f)*(d||1));b=new t({center:e,radius:l,radiusUnit:"meters",spatialReference:b.spatialReference});
return B(b.rings,b.spatialReference,!1)};f.createEllipse=function(a,b,c){var d=b.mapToLocalMultiple(a);a=d[0];var e=d[1],d=Math.round(e.x-a.x),e=Math.round(e.y-a.y);a=H(c?a.x:a.x+d/2,c?a.y:a.y+e/2);d=c?d:d/2;c=c?e:e/2;for(var e=[],f=2*Math.PI/60,g=0;60>g;g++){var k=H(d*Math.cos(g*f)+a.x,c*Math.sin(g*f)+a.y);e.push(k)}e.push(e[0]);return B([e.map(function(a){return b.localToMap(a)})],b.spatialReference,b.doUnnormalization,!1)}})},"esri/core/libs/gl-matrix-2/mat2d":function(){define(["require","exports",
"./math/mat2d"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.mat2d=e})},"esri/core/libs/gl-matrix-2/mat2df64":function(){define(["require","exports","./factories/mat2df64"],function(u,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.mat2df64=e})},"esri/core/libs/gl-matrix-2/factories/mat2df64":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});f.create=function(){return[1,0,0,1,0,0]};f.clone=function(e){return[e[0],e[1],
e[2],e[3],e[4],e[5]]};f.fromValues=function(e,f,m,d,g,k){return[e,f,m,d,g,k]};f.createView=function(e,f){return new Float64Array(e,f,6)}})},"esri/geometry/geometryEngine":function(){define(["require","exports","./geometryEngineBase","./geometryAdapters/hydrated"],function(u,f,e,r){function m(d){return Array.isArray(d)?d[0].spatialReference:d&&d.spatialReference}function d(d){return"xmin"in d?"center"in d?d.center:null:"x"in d?d:"extent"in d?d.extent.center:null}Object.defineProperty(f,"__esModule",
{value:!0});f.extendedSpatialReferenceInfo=function(d){return e.extendedSpatialReferenceInfo(d)};f.clip=function(d,f){return e.clip(r.hydratedAdapter,m(d),d,f)};f.cut=function(d,f){return e.cut(r.hydratedAdapter,m(d),d,f)};f.contains=function(d,f){return e.contains(r.hydratedAdapter,m(d),d,f)};f.crosses=function(d,f){return e.crosses(r.hydratedAdapter,m(d),d,f)};f.distance=function(d,f,l){return e.distance(r.hydratedAdapter,m(d),d,f,l)};f.equals=function(d,f){return e.equals(r.hydratedAdapter,m(d),
d,f)};f.intersects=function(d,f){return e.intersects(r.hydratedAdapter,m(d),d,f)};f.touches=function(d,f){return e.touches(r.hydratedAdapter,m(d),d,f)};f.within=function(d,f){return e.within(r.hydratedAdapter,m(d),d,f)};f.disjoint=function(d,f){return e.disjoint(r.hydratedAdapter,m(d),d,f)};f.overlaps=function(d,f){return e.overlaps(r.hydratedAdapter,m(d),d,f)};f.relate=function(d,f,l){return e.relate(r.hydratedAdapter,m(d),d,f,l)};f.isSimple=function(d){return e.isSimple(r.hydratedAdapter,m(d),d)};
f.simplify=function(d){return e.simplify(r.hydratedAdapter,m(d),d)};f.convexHull=function(d,f){void 0===f&&(f=!1);return e.convexHull(r.hydratedAdapter,m(d),d,f)};f.difference=function(d,f){return e.difference(r.hydratedAdapter,m(d),d,f)};f.symmetricDifference=function(d,f){return e.symmetricDifference(r.hydratedAdapter,m(d),d,f)};f.intersect=function(d,f){return e.intersect(r.hydratedAdapter,m(d),d,f)};f.union=function(d,f){void 0===f&&(f=null);return e.union(r.hydratedAdapter,m(d),d,f)};f.offset=
function(d,f,l,c,a,b){return e.offset(r.hydratedAdapter,m(d),d,f,l,c,a,b)};f.buffer=function(d,f,l,c){void 0===c&&(c=!1);return e.buffer(r.hydratedAdapter,m(d),d,f,l,c)};f.geodesicBuffer=function(d,f,l,c,a,b){return e.geodesicBuffer(r.hydratedAdapter,m(d),d,f,l,c,a,b)};f.nearestCoordinate=function(d,f,l){void 0===l&&(l=!0);return e.nearestCoordinate(r.hydratedAdapter,m(d),d,f,l)};f.nearestVertex=function(d,f){return e.nearestVertex(r.hydratedAdapter,m(d),d,f)};f.nearestVertices=function(d,f,l,c){return e.nearestVertices(r.hydratedAdapter,
m(d),d,f,l,c)};f.rotate=function(f,k,l){if(null==f)throw Error("Illegal Argument Exception");var c=f.spatialReference;l=null!==l&&void 0!==l?l:d(f);if(null==l)throw Error("Illegal Argument Exception");f=f.constructor.fromJSON(e.rotate(f,k,l));f.spatialReference=c;return f};f.flipHorizontal=function(f,k){if(null==f)throw Error("Illegal Argument Exception");var g=f.spatialReference;k=null!==k&&void 0!==k?k:d(f);if(null==k)throw Error("Illegal Argument Exception");f=f.constructor.fromJSON(e.flipHorizontal(f,
k));f.spatialReference=g;return f};f.flipVertical=function(f,k){if(null==f)throw Error("Illegal Argument Exception");var g=f.spatialReference;k=null!==k&&void 0!==k?k:d(f);if(null==k)throw Error("Illegal Argument Exception");f=f.constructor.fromJSON(e.flipVertical(f,k));f.spatialReference=g;return f};f.generalize=function(d,f,l,c){return e.generalize(r.hydratedAdapter,m(d),d,f,l,c)};f.densify=function(d,f,l){return e.densify(r.hydratedAdapter,m(d),d,f,l)};f.geodesicDensify=function(d,f,l,c){void 0===
c&&(c=0);return e.geodesicDensify(r.hydratedAdapter,m(d),d,f,l,c)};f.planarArea=function(d,f){return e.planarArea(r.hydratedAdapter,m(d),d,f)};f.planarLength=function(d,f){return e.planarLength(r.hydratedAdapter,m(d),d,f)};f.geodesicArea=function(d,f,l){return e.geodesicArea(r.hydratedAdapter,m(d),d,f,l)};f.geodesicLength=function(d,f,l){return e.geodesicLength(r.hydratedAdapter,m(d),d,f,l)}})},"esri/geometry/geometryEngineBase":function(){define(["require","exports"],function(){function u(a){if("number"===
typeof a)return C.$c.vh(a);if(null==a)return null;if(null!=qa[a])return C.$c.vh(qa[a]);throw Error("Unrecognised Unit Type");}function f(a){if("number"===typeof a)return C.$c.vh(a);if(null==a)return null;if(null!=ra[a])return C.$c.vh(ra[a]);throw Error("Unrecognised Unit Type");}function e(a){if(a)switch(a){case "loxodrome":return 1;case "great-elliptic":return 2;case "normal-section":return 3;case "shape-preserving":return 4}return 0}function r(a,b,c,d){if(null==c||c.u())return null;switch(c.G()){case C.po.Point:return a.exportPoint(b,
c,d);case C.po.Polygon:return a.exportPolygon(b,c,d);case C.po.Polyline:return a.exportPolyline(b,c,d);case C.po.MultiPoint:return a.exportMultipoint(b,c,d);case C.po.Envelope:return a.exportExtent(b,c,d)}return null}function m(a,b,c,d){if(c.G()!==C.po.Point)throw Error("Geometry not Point");return a.exportPoint(b,c,d)}function d(a){var b=a.wkid;a=a.wkt;var c=va.get(b||a);null==c&&(-1!==b&&null!=b?(c=C.ve.create(b),va.set(b,c)):a&&(c=C.ve.MQ(a),va.set(a,c)));return c}function g(a){var b;if(null==
a)return null;var c=d(a);a=c.Td();c=c.Ho();return b={},b.tolerance=c,b.unitType=null==a?-1:a.sd,b.unitID=null==a?-1:a.Bc(),b.unitBaseFactor=null==a?0:a.Bi,b.unitSquareDerivative=null==a?0:C.$c.cH(a).Bc(),b}function k(a,b,c,n){if(null==c)return null;c=C.gc.clip(a.convertToGEGeometry(Y,c),a.convertToGEGeometry(Y,n),d(b));return r(a,Y,c,b)}function l(a,b,c,n){c=C.gc.Ml(a.convertToGEGeometry(Y,c),a.convertToGEGeometry(Y,n),d(b));n=[];for(var h=0;h<c.length;h++)n.push(r(a,Y,c[h],b));return n}function c(a,
b,c,n){if(null==c||null==n)throw Error("Illegal Argument Exception");return C.gc.contains(a.convertToGEGeometry(Y,c),a.convertToGEGeometry(Y,n),d(b))}function a(a,b,c,n){if(null==c||null==n)throw Error("Illegal Argument Exception");return C.gc.VQ(a.convertToGEGeometry(Y,c),a.convertToGEGeometry(Y,n),d(b))}function b(a,b,c,n,h){if(null==c||null==n)throw Error("Illegal Argument Exception");return C.gc.Cb(a.convertToGEGeometry(Y,c),a.convertToGEGeometry(Y,n),d(b),u(h))}function q(a,b,c,n){return null==
c&&null!=n||null==n&&null!=c?!1:C.gc.Eb(a.convertToGEGeometry(Y,c),a.convertToGEGeometry(Y,n),d(b))}function v(a,b,c,n){if(null==c||null==n)throw Error("Illegal Argument Exception");return C.gc.pU(a.convertToGEGeometry(Y,c),a.convertToGEGeometry(Y,n),d(b))}function t(a,b,c,n){if(null==c||null==n)throw Error("Illegal Argument Exception");return C.gc.touches(a.convertToGEGeometry(Y,c),a.convertToGEGeometry(Y,n),d(b))}function x(a,b,c,n){if(null==c||null==n)throw Error("Illegal Argument Exception");
return C.gc.WY(a.convertToGEGeometry(Y,c),a.convertToGEGeometry(Y,n),d(b))}function z(a,b,c,n){if(null==c||null==n)throw Error("Illegal Argument Exception");return C.gc.mR(a.convertToGEGeometry(Y,c),a.convertToGEGeometry(Y,n),d(b))}function A(a,b,c,n){if(null==c||null==n)throw Error("Illegal Argument Exception");return C.gc.TV(a.convertToGEGeometry(Y,c),a.convertToGEGeometry(Y,n),d(b))}function E(a,b,c,n,h){if(null==c||null==n)throw Error("Illegal Argument Exception");return C.gc.aC(a.convertToGEGeometry(Y,
c),a.convertToGEGeometry(Y,n),d(b),h)}function H(a,b,c){if(null==c)throw Error("Illegal Argument Exception");return C.gc.AU(a.convertToGEGeometry(Y,c),d(b))}function J(a,b,c){if(null==c)throw Error("Illegal Argument Exception");c=C.gc.FC(a.convertToGEGeometry(Y,c),d(b));return r(a,Y,c,b)}function B(a,b,c,n){void 0===n&&(n=!1);if(null==c)throw Error("Illegal Argument Exception");if(Array.isArray(c)){var h=n,p=[];for(n=0;n<c.length;n++)p.push(a.convertToGEGeometry(Y,c[n]));c=C.gc.GQ(p,h);h=Array(c.length);
for(n=0;n<c.length;n++)h[n]=r(a,Y,c[n],b);return h}n=C.gc.FQ(a.convertToGEGeometry(Y,c),d(b));return r(a,Y,n,b)}function G(a,b,c,n){if(null==c||null==n)throw Error("Illegal Argument Exception");if(Array.isArray(c)){for(var h=[],p=0;p<c.length;p++)h.push(a.convertToGEGeometry(Y,c[p]));c=C.gc.jR(h,a.convertToGEGeometry(Y,n),d(b));n=Array(c.length);for(p=0;p<c.length;p++)n[p]=r(a,Y,c[p],b);return n}p=C.gc.an(a.convertToGEGeometry(Y,c),a.convertToGEGeometry(Y,n),d(b));return r(a,Y,p,b)}function F(a,b,
c,n){if(null==c||null==n)throw Error("Illegal Argument Exception");if(Array.isArray(c)){for(var h=[],p=0;p<c.length;p++)h.push(a.convertToGEGeometry(Y,c[p]));c=C.gc.sY(h,a.convertToGEGeometry(Y,n),d(b));n=Array(c.length);for(p=0;p<c.length;p++)n[p]=r(a,Y,c[p],b);return n}p=C.gc.Wp(a.convertToGEGeometry(Y,c),a.convertToGEGeometry(Y,n),d(b));return r(a,Y,p,b)}function M(a,b,c,n){if(null==c||null==n)throw Error("Illegal Argument Exception");if(Array.isArray(c)){for(var h=[],p=0;p<c.length;p++)h.push(a.convertToGEGeometry(Y,
c[p]));c=C.gc.nU(h,a.convertToGEGeometry(Y,n),d(b));n=Array(c.length);for(p=0;p<c.length;p++)n[p]=r(a,Y,c[p],b);return n}p=C.gc.Ma(a.convertToGEGeometry(Y,c),a.convertToGEGeometry(Y,n),d(b));return r(a,Y,p,b)}function R(a,b,c,n){if(null==c)return null;var h=[];if(Array.isArray(c)){if(0===c.length)return null;for(n=0;n<c.length;n++)h.push(a.convertToGEGeometry(Y,c[n]))}else h.push(a.convertToGEGeometry(Y,c)),null!=n&&h.push(a.convertToGEGeometry(Y,n));return r(a,Y,C.gc.LY(h,d(b)),b)}function T(a,b,
c,n,h,p,y,e){var D=0;if(null!=p)switch(p){case "round":D=0;break;case "bevel":D=1;break;case "miter":D=2;break;case "square":D=3}if(Array.isArray(c)){if(null==c)a=null;else if(0===c.length)a=[];else{var f=[];for(p=0;p<c.length;p++)f.push(a.convertToGEGeometry(Y,c[p]));c=C.gc.RV(f,d(b),n,D,y,e,u(h));n=Array(c.length);for(p=0;p<c.length;p++)n[p]=r(a,Y,c[p],b);a=n}return a}c=C.gc.offset(a.convertToGEGeometry(Y,c),d(b),n,D,y,e,u(h));return r(a,Y,c,b)}function O(a,b,c,n,h,p){void 0===p&&(p=!1);if(Array.isArray(c)){if(!Array.isArray(n)){for(var y=
[],e=0;e<c.length;e++)y.push(n);n=y}if(n.length!=c.length){if(0==n.length)throw Error("Illegal Argument Exception");for(var y=[],f=0,e=0;e<c.length;e++)void 0===n[e]?y.push(f):(y.push(n[e]),f=n[e]);n=y}return Q(a,b,c,n,h,!1,p,"geodesic",NaN)}c=C.gc.buffer(a.convertToGEGeometry(Y,c),d(b),n,u(h),!1,0,NaN);return r(a,Y,c,b)}function L(a,b,c,n,h,p,y,D){if(Array.isArray(c)){if(!Array.isArray(n)){for(var f=[],g=0;g<c.length;g++)f.push(n);n=f}if(n.length!==c.length){if(0===n.length)throw Error("Illegal Argument Exception");
for(var f=[],w=0,g=0;g<c.length;g++)void 0===n[g]?f.push(w):(f.push(n[g]),w=n[g]);n=f}return Q(a,b,c,n,h,!0,p,y,D)}void 0===y&&(y=NaN);c=C.gc.buffer(a.convertToGEGeometry(Y,c),d(b),n,u(h),!0,e(p),y);return r(a,Y,c,b)}function Q(a,b,c,n,h,p,y,D,f){void 0===f&&(f=NaN);if(null==c)return null;if(0===c.length)return[];for(var K=[],g=0;g<c.length;g++)K.push(a.convertToGEGeometry(Y,c[g]));c=C.gc.mP(K,d(b),n,u(h),p,y,e(D),f);n=Array(c.length);for(g=0;g<c.length;g++)n[g]=r(a,Y,c[g],b);return n}function S(a,
b,c,d,h){var p;void 0===h&&(h=!0);c=C.gc.bA(a.convertToGEGeometry(Y,c),a.convertToGEGeometry(Y,d),h);return p={},p.coordinate=m(a,Y,c.Qz(),b),p.distance=c.Tz(),p.isRightSide=c.CA(),p.vertexIndex=c.Za(),p.isEmpty=c.u(),p}function aa(a,b,c,d){var h;c=C.gc.cA(a.convertToGEGeometry(Y,c),a.convertToGEGeometry(Y,d));return h={},h.coordinate=m(a,Y,c.Qz(),b),h.distance=c.Tz(),h.isRightSide=c.CA(),h.vertexIndex=c.Za(),h.isEmpty=c.u(),h}function ba(a,b,c,d,h,p){var y;c=C.gc.dA(a.convertToGEGeometry(Y,c),a.convertToGEGeometry(Y,
d),h,p);d=[];for(h=0;h<c.length;h++)!1===c[h].u()&&d.push((y={},y.coordinate=m(a,Y,c[h].Qz(),b),y.distance=c[h].Tz(),y.isRightSide=c[h].CA(),y.vertexIndex=c[h].Za(),y.isEmpty=c[h].u(),y));return d}function V(a,b,c,n,h,p){c=C.gc.gS(a.convertToGEGeometry(Y,c),d(b),n,h,u(p));return r(a,Y,c,b)}function Z(a,b,c,n,h){c=C.gc.Js(a.convertToGEGeometry(Y,c),d(b),n,u(h));return r(a,Y,c,b)}function ha(a,b,c,n,h,p){void 0===p&&(p=0);c=C.gc.Hz(a.convertToGEGeometry(Y,c),d(b),n,u(h),p);return r(a,Y,c,b)}function X(a,
b,c,n){if(null==c)throw Error("Illegal Argument Exception");return C.gc.aW(a.convertToGEGeometry(Y,c),d(b),f(n))}function ea(a,b,c,n){if(null==c)throw Error("Illegal Argument Exception");return C.gc.bW(a.convertToGEGeometry(Y,c),d(b),u(n))}function ga(a,b,c,n,h){if(null==c)throw Error("Illegal Argument Exception");return C.gc.mS(a.convertToGEGeometry(Y,c),d(b),f(n),e(h))}function oa(a,b,c,n,h){if(null==c)throw Error("Illegal Argument Exception");return C.gc.qS(a.convertToGEGeometry(Y,c),d(b),u(n),
e(h))}function ja(a){C.dN.bind(a)}function da(a,b,c,n,h){var p=null,y=null;if(n){if(!h)throw C.g.F("AOI missing Spatial Reference");p=a.convertToGEGeometry(Y,n);y=d(h).Bh()}a=C.Su.rT(d(b).Bh(),d(c).Bh(),p,y);return null!==a?a:null}function ma(a,b,c,n,h){var p=null,y=null;if(n){if(!h)throw C.g.F("AOI missing Spatial Reference");p=a.convertToGEGeometry(Y,n);y=d(h).Bh()}return C.Su.sT(d(b).Bh(),d(c).Bh(),p,y)}function fa(a,b,c,n,h){void 0===h&&(h=null);if(!1===this.VZ)throw Error("Projection Engine must be enabled using enableProjection");
if(0===b.length)return[];if(h){var p=h.getCachedGeTransformation(c,n);if(!p)a:{p=h;h=null;if(p){var y=p.getGTListEntry();if(null!==y){h=new C.ky(null);for(var e=0,f=y.steps;e<f.length;e++){var y=f[e],g=new C.oo(y.geogtran);y.isInverse&&g.mt();h.add(g)}h=C.rs.Gs(d(c).Bh(),d(n).Bh(),h);p.assignCachedGe(c,n,h);p=h;break a}}if(null===h&&p&&p.steps&&0<p.steps.length){h=new C.ky(null);e=0;for(f=p.steps;e<f.length;e++)y=f[e],-1!=y.wkid&&null!=y.wkid?h.add(C.oo.create(y.wkid,y.isInverse)):h.add(C.oo.eG(y.wkt,
y.isInverse));h=C.rs.Gs(d(c).Bh(),d(n).Bh(),h);p.assignCachedGe(c,n,h);p=h}else p=C.rs.Gs(d(c).Bh(),d(n).Bh(),h)}}else p=C.rs.Gs(d(c).Bh(),d(n).Bh(),null);c=[];for(y=0;y<b.length;y++)h=b[y],c.push(la(a,h,n,p));return c}function la(a,b,c,d){b=C.gc.Vg(a.convertToGEGeometry(Y,b),d);return r(a,Y,b,c)}var ia,ca=this&&this.__extends||function(){function a(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,h){a.__proto__=h}||function(a,h){for(var b in h)h.hasOwnProperty(b)&&(a[b]=h[b])};
return a(b,c)}return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),C;(function(a){var b=function(){function a(){}a.Gm=!1;a.jw=!1;a.yz="";return a}();a.Yh=b;if("undefined"!==typeof window)a.Yh.yz="browser","Float64Array"in window&&(a.Yh.jw=!0),"ArrayBuffer"in window&&(a.Yh.Gm=!0);else if("undefined"!==typeof process)b.yz="node",a.Yh.Gm=!0,a.Yh.jw=!0;else{b.yz="browser";try{var c=new ArrayBuffer(0);new Uint8Array(c);a.Yh.Gm=
!0;a.Yh.jw=!0}catch(n){a.Yh.Gm=!1}}})(C||(C={}));(function(a){(function(a){a[a.Unknown=0]="Unknown";a[a.Point=33]="Point";a[a.Line=322]="Line";a[a.Envelope=197]="Envelope";a[a.MultiPoint=550]="MultiPoint";a[a.Polyline=1607]="Polyline";a[a.Polygon=1736]="Polygon"})(a.po||(a.po={}));(function(a){a[a.enumMild=0]="enumMild";a[a.enumMedium=1]="enumMedium";a[a.enumHot=2]="enumHot"})(a.eM||(a.eM={}));var b=function(){function b(){this.description=null;this.EB=0}b.prototype.G=function(){return 0};b.prototype.ub=
function(){return-1};b.prototype.Eg=function(a){this.zc();a!=this.description&&this.to(a)};b.prototype.to=function(){};b.prototype.tm=function(b){this.zc();b!=this.description&&(b=a.we.WS(this.description,b),b!=this.description&&this.to(b))};b.prototype.hasAttribute=function(a){return this.description.hasAttribute(a)};b.prototype.Rd=function(b){this.zc();this.description.hasAttribute(b)||(b=a.we.VS(this.description,b),this.to(b))};b.prototype.hg=function(){return null};b.prototype.Wn=function(){};
b.prototype.s=function(){};b.prototype.Jp=function(){};b.prototype.ac=function(a){this.s(a)};b.prototype.u=function(){return!0};b.prototype.Oa=function(){};b.prototype.Vc=function(){};b.prototype.Ka=function(){return null};b.prototype.copyTo=function(){};b.prototype.ef=function(){return 0};b.prototype.Rb=function(){return 0};b.prototype.kH=function(){return this.hasAttribute(1)};b.hf=function(a){return((a&192)>>6)+1>>1};b.Po=function(a){return 0!=(a&32)};b.g_=function(a){return 0!=(a&64)};b.qU=function(a){return 0!=
(a&128)};b.Nc=function(a){return 0!=(a&256)};b.fh=function(a){return 0!=(a&512)};b.Hc=function(a){return 0!=(a&1024)};b.prototype.Sf=function(){var a=this.Ka();this.copyTo(a);return a};b.prototype.Fg=function(){return null};b.me=function(a){var h=a.Ka();a.copyTo(h);return h};b.prototype.zc=function(){0<=this.EB&&(this.EB+=2147483649)};b.gy=function(c){var h=c.G();if(b.fh(h))return c.D();if(c.u())return 0;if(197==h)return 4;if(33==h)return 1;if(b.Nc(h))return 2;throw a.g.X("missing type");};return b}();
a.T=b})(C||(C={}));(function(a){var b=function(){function b(){this.y=this.x=0}b.pa=function(a,h){var p=new b;p.x=a;p.y=h;return p};b.Jl=function(a){var h=new b;h.x=a.x;h.y=a.y;return h};b.prototype.ja=function(a,h){this.x=a;this.y=h};b.prototype.L=function(a){this.x=a.x;this.y=a.y};b.prototype.Uq=function(a,h){return this.x===a&&this.y===h};b.prototype.zA=function(a){return 2.220446049250313E-16>=Math.abs(this.x-a.x)&&2.220446049250313E-16>=Math.abs(this.y-a.y)};b.prototype.vb=function(a){return this.x===
a.x&&this.y===a.y};b.prototype.Eb=function(a){return a==this?!0:a instanceof b?this.x==a.x&&this.y==a.y:!1};b.prototype.sub=function(a){this.x-=a.x;this.y-=a.y};b.prototype.xc=function(a,h){this.x=a.x-h.x;this.y=a.y-h.y};b.prototype.add=function(a,h){void 0!==h?(this.x=a.x+h.x,this.y=a.y+h.y):(this.x+=a.x,this.y+=a.y)};b.prototype.Kr=function(){this.x=-this.x;this.y=-this.y};b.prototype.du=function(a){this.x=-a.x;this.y=-a.y};b.prototype.kU=function(a,h,b){this.x=a.x*(1-b)+h.x*b;this.y=a.y*(1-b)+
h.y*b};b.prototype.tu=function(a,h){this.x=this.x*a+h.x;this.y=this.y*a+h.y};b.prototype.iX=function(a,h,b){this.x=h.x*a+b.x;this.y=h.y*a+b.y};b.prototype.scale=function(a){this.x*=a;this.y*=a};b.prototype.compare=function(a){return this.y<a.y?-1:this.y>a.y?1:this.x<a.x?-1:this.x>a.x?1:0};b.prototype.normalize=function(){var a=this.length();0==a&&(this.x=1,this.y=0);this.x/=a;this.y/=a};b.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};b.prototype.uk=function(){return this.x*
this.x+this.y*this.y};b.Cb=function(a,h){return Math.sqrt(this.sc(a,h))};b.wz=function(a,h,b,c){a-=b;h-=c;return Math.sqrt(a*a+h*h)};b.prototype.pi=function(a){return this.x*a.x+this.y*a.y};b.prototype.CE=function(a){return Math.abs(this.x*a.x)+Math.abs(this.y*a.y)};b.prototype.Vi=function(a){return this.x*a.y-this.y*a.x};b.prototype.su=function(a,h){var b=-this.x*h+this.y*a;this.x=this.x*a+this.y*h;this.y=b};b.prototype.uw=function(){var a=this.x;this.x=-this.y;this.y=a};b.prototype.OH=function(a){this.x=
-a.y;this.y=a.x};b.prototype.Tr=function(){var a=this.x;this.x=this.y;this.y=-a};b.prototype.iv=function(){this.y=this.x=NaN};b.prototype.Dy=function(){return isNaN(this.x)};b.prototype.ev=function(){return 0<this.x?0<=this.y?1:4:0<this.y?2:0==this.x?4:3};b.ts=function(a,h){var b=a.ev(),c=h.ev();return c==b?(b=a.Vi(h),0>b?1:0<b?-1:0):b<c?-1:1};b.LZ=function(a,h){return b.ts(a,h)};b.sc=function(a,h){var b=a.x-h.x;a=a.y-h.y;return b*b+a*a};b.prototype.toString=function(){return"("+this.x+" , "+this.y+
")"};b.prototype.Yc=function(){this.y=this.x=NaN};b.prototype.isNaN=function(){return isNaN(this.x)||isNaN(this.y)};b.prototype.nO=function(){return this.Dy()?NaN:Math.abs(this.x)>=Math.abs(this.y)?Math.abs(this.x):Math.abs(this.y)};b.prototype.offset=function(a,h){var p=b.Cb(a,h),c=b.pa(this.x,this.y);if(0==p)return b.Cb(c,a);var d=new b;d.L(h);d.sub(a);c.sub(a);return c.Vi(d)/p};b.Gp=function(b,h,p){var c=new a.Xb;c.set(h.x);c.sub(b.x);var d=new a.Xb;d.set(p.y);d.sub(b.y);var n=new a.Xb;n.set(h.y);
n.sub(b.y);var e=new a.Xb;e.set(p.x);e.sub(b.x);c.Tg(d);n.Tg(e);c.sub(n);if(!c.nt())return p=c.value(),0>p?-1:0<p?1:0;c=new a.$p(h.x);d=new a.$p(b.x);n=new a.$p(b.y);c=c.au(d);b=new a.$p(p.y);b=b.au(n);h=new a.$p(h.y);h=h.au(n);p=new a.$p(p.x);p=p.au(d);c=c.cs(b);h=h.cs(p);c=c.cs(h);return c.SU()?-1:c.BT()?1:0};b.prototype.kc=function(){return a.J.$i(a.J.$i())};return b}();a.b=b})(C||(C={}));(function(a){var b=function(){function a(a){this.iz=this.Cu=0;this.lY=a}a.prototype.reset=function(){this.iz=
this.Cu=0};a.prototype.add=function(a){a-=this.iz;var h=this.Cu+a;this.iz=h-this.Cu-a;this.Cu=h};a.prototype.sub=function(a){this.add(-a)};a.prototype.ln=function(){return this.lY+this.Cu};return a}();a.ny=b;b=function(){function a(){}a.Kl=function(a,h){return 0<=h?Math.abs(a):-Math.abs(a)};a.sign=function(a){return 0>a?-1:0<a?1:0};a.TL=function(a){return a-360*Math.floor(a/360)};a.round=function(a){return Math.floor(a+.5)};a.Yx=function(a){return a*a};a.Xq=function(a,h,b){var p;.5>=b?p=a+(h-a)*b:
p=h-(h-a)*(1-b);return p};a.QH=function(a,h,b,c){.5>=b?(c.x=a.x+(h.x-a.x)*b,c.y=a.y+(h.y-a.y)*b):(c.x=h.x-(h.x-a.x)*(1-b),c.y=h.y-(h.y-a.y)*(1-b))};a.QU=function(a,h,b,c,d,e){.5>=d?(e.x=a+(b-a)*d,e.y=h+(c-h)*d):(e.x=b-(b-a)*(1-d),e.y=c-(c-h)*(1-d))};return a}();a.Ub=b})(C||(C={}));(function(a){var b=function(b){function c(){var a=b.call(this)||this;a.ua=0;a.ra=0;a.sa=0;a.oa=0;a.ka=null;return a}ca(c,b);c.prototype.ec=function(){return a.b.pa(this.ua,this.ra)};c.prototype.Oq=function(a){a.x=this.ua;
a.y=this.ra};c.prototype.Lc=function(a){this.Wm(0,a)};c.prototype.zC=function(h,b){this.Wm(0,a.b.pa(h,b))};c.prototype.Kp=function(a){this.EE(0,a)};c.prototype.setStart=function(a){this.NE(0,a)};c.prototype.bt=function(a,b){return this.Zd(0,a,b)};c.prototype.Tx=function(a,b,c){this.vo(0,a,b,c)};c.prototype.Ac=function(){return a.b.pa(this.sa,this.oa)};c.prototype.Ns=function(a){a.x=this.sa;a.y=this.oa};c.prototype.Xc=function(a){this.Wm(1,a)};c.prototype.Am=function(h,b){this.Wm(1,a.b.pa(h,b))};c.prototype.Ip=
function(a){this.EE(1,a)};c.prototype.setEnd=function(a){this.NE(1,a)};c.prototype.Ms=function(a,b){return this.Zd(1,a,b)};c.prototype.Lx=function(a,b,c){this.vo(1,a,b,c)};c.prototype.ub=function(){return 1};c.prototype.u=function(){return this.Gc()};c.prototype.Oa=function(){};c.prototype.ef=function(){return 0};c.prototype.Ma=function(a,b,c,d,n){return this.kO(a,b,c,d,n)};c.prototype.Yb=function(a,b){return 0!=this.ws(a,b,!1)};c.prototype.ot=function(a,b){return this.fv(a,b,!1)};c.prototype.fv=
function(){return null};c.prototype.Gc=function(){return!1};c.prototype.Fy=function(h){this.zc();if(null==this.ka&&0<h)this.ka=a.J.df(2*h);else if(null!=this.ka&&this.ka.length<2*h){for(var b=this.ka.slice(0),c=this.ka.length;c<2*h;c++)b[c]=0;this.ka=b}};c.Dj=function(a,b,c){if(0<c)var h=0;for(var p=0;p<c;p++)b[0+h]=a[0],h++};c.prototype.Wm=function(a,b){0!=a?(this.sa=b.x,this.oa=b.y):(this.ua=b.x,this.ra=b.y)};c.prototype.to=function(h){if(null!=this.ka){for(var b=a.we.vx(h,this.description),d=[],
n=c.tb(this.description,0),e=c.tb(this.description,1),f=c.tb(h,0),g=c.tb(h,1),w=0,k=1,l=h.Ga;k<l;k++){var m=h.pd(k),I=a.ma.Xa(m);if(-1==b[k])for(var q=a.ma.be(m),m=0;m<I;m++)d[f+w]=q,d[g+w]=q,w++;else for(q=this.description.zk(b[k])-2,m=0;m<I;m++)d[f+w]=this.ka[n+q],d[g+w]=this.ka[e+q],w++,q++}this.ka=d}this.description=h};c.prototype.EE=function(h,b){if(this.Gc())throw a.g.X("empty geometry");b.Eg(this.description);b.Gc()&&b.nq();for(var c=0;c<this.description.Ga;c++)for(var p=this.description.Qd(c),
d=0,n=a.ma.Xa(p);d<n;d++){var e=this.Zd(h,p,d);b.setAttribute(p,d,e)}};c.prototype.NE=function(h,b){this.zc();if(b.Gc())throw a.g.X("empty geometry");for(var c=b.description,p=0,d=c.Ga;p<d;p++)for(var n=c.Qd(p),e=a.ma.Xa(n),f=0;f<e;f++){var g=b.Wc(n,f);this.vo(h,n,f,g)}};c.prototype.Zd=function(h,b,d){if(this.Gc())throw a.g.X("This operation was performed on an Empty Geometry.");if(0==b)return 0!=h?0!=d?this.oa:this.sa:0!=d?this.ra:this.ua;if(d>=a.ma.Xa(b))throw a.g.vd();var p=this.description.lg(b);
return 0<=p?(null!=this.ka&&this.Fy(this.description.Ye.length-2),this.ka[c.tb(this.description,h)+this.description.zk(p)-2+d]):a.ma.be(b)};c.prototype.vo=function(h,b,d,n){this.zc();if(d>=a.ma.Xa(b))throw a.g.vd();var p=this.description.lg(b);0>p&&(this.Rd(b),p=this.description.lg(b));0==b?0!=h?0!=d?this.oa=n:this.sa=n:0!=d?this.ra=n:this.ua=n:(null==this.ka&&this.Fy(this.description.Ye.length-2),this.ka[c.tb(this.description,h)+this.description.zk(p)-2+d]=n)};c.prototype.copyTo=function(h){if(h.G()!=
this.G())throw a.g.F();h.description=this.description;h.Fy(this.description.Ye.length-2);c.Dj(this.ka,h.ka,2*(this.description.Ye.length-2));h.ua=this.ua;h.ra=this.ra;h.sa=this.sa;h.oa=this.oa;h.zc();this.iq(h)};c.prototype.hg=function(h,b){var c=new a.yc;if(this.Gc())return c.Oa(),c;c.ga=this.Zd(0,h,b);c.la=c.ga;c.ol(this.Zd(1,h,b));return c};c.prototype.GJ=function(a){this.Gc()?a.Oa():(a.ga=this.Zd(0,0,0),a.la=a.ga,a.ol(this.Zd(1,0,0)))};c.prototype.Fx=function(b,c){c.Eg(this.description);c.rb(this.hc(b));
for(var h=1,p=this.description.Ga;h<p;h++)for(var d=this.description.Qd(h),n=a.ma.Xa(d),e=0;e<n;e++){var f=this.Wc(b,d,e);c.setAttribute(d,e,f)}};c.prototype.hO=function(a){if(this.description!=a.description||this.ua!=a.ua||this.sa!=a.sa||this.ra!=a.ra||this.oa!=a.oa)return!1;for(var b=0;b<2*(this.description.Ye.length-2);b++)if(this.ka[b]!=a.ka[b])return!1;return!0};c.prototype.CH=function(){return this.ua==this.sa&&this.ra==this.oa};c.prototype.reverse=function(){var b=this.ua;this.ua=this.sa;this.sa=
b;b=this.ra;this.ra=this.oa;this.oa=b;for(var b=1,c=this.description.Ga;b<c;b++)for(var d=this.description.pd(b),n=0,e=a.ma.Xa(d);n<e;n++){var f=this.Zd(0,d,n),g=this.Zd(1,d,n);this.vo(0,d,n,g);this.vo(1,d,n,f)}};c.prototype.ws=function(b,c,d){var h=b.G();switch(this.G()){case 322:if(322==h)return a.Hb.lO(this,b,c,d);throw a.g.za();default:throw a.g.za();}};c.prototype.kO=function(b,c,d,n,e){var h=b.G();switch(this.G()){case 322:if(322==h)return a.Hb.Cy(this,b,c,d,n,e);throw a.g.za();default:throw a.g.za();
}};c.prototype.yy=function(){return null};c.tb=function(a,b){return b*(a.Ye.length-2)};c.prototype.hc=function(b,c){if(void 0===c)return c=new a.b,this.hc(b,c),c;a.Ub.QU(this.ua,this.ra,this.sa,this.oa,b,c)};c.prototype.ne=function(){return null};c.prototype.hH=function(){return null};c.prototype.Tq=function(){return null};c.prototype.eh=function(){return null};c.prototype.Mo=function(){return null};c.prototype.Dg=function(){return null};c.prototype.zy=function(a,b){return void 0!==b?this.cy(b)-this.cy(a):
this.cy(a)};c.prototype.iq=function(){};c.prototype.Ml=function(){return null};c.prototype.yh=function(){};c.prototype.Wc=function(){return null};c.prototype.kf=function(){return null};c.prototype.cy=function(){return null};c.prototype.PH=function(){return null};c.prototype.Cb=function(a,b){if(!b&&0!=this.ws(a,0,!1))return 0;b=1.7976931348623157E308;var h,c;h=this.ec();c=a.ne(h,!1);h.sub(a.hc(c));h=h.length();h<b&&(b=h);h=this.Ac();c=a.ne(h,!1);h.sub(a.hc(c));h=h.length();h<b&&(b=h);h=a.ec();c=this.ne(h,
!1);h.sub(this.hc(c));h=h.length();h<b&&(b=h);h=a.Ac();c=this.ne(h,!1);h.sub(this.hc(c));h=h.length();h<b&&(b=h);return b};c.prototype.Fg=function(){return a.Pi.Xm(this,null)};return c}(a.T);a.iE=b})(C||(C={}));new C.b;(function(a){(function(a){a[a.Unknown=-1]="Unknown";a[a.Not=0]="Not";a[a.Weak=1]="Weak";a[a.Strong=2]="Strong"})(a.gM||(a.gM={}));(function(a){a[a.DirtyIsKnownSimple=1]="DirtyIsKnownSimple";a[a.IsWeakSimple=2]="IsWeakSimple";a[a.IsStrongSimple=4]="IsStrongSimple";a[a.DirtyOGCFlags=
8]="DirtyOGCFlags";a[a.DirtyVerifiedStreams=32]="DirtyVerifiedStreams";a[a.DirtyExactIntervals=64]="DirtyExactIntervals";a[a.DirtyLooseIntervals=128]="DirtyLooseIntervals";a[a.DirtyIntervals=192]="DirtyIntervals";a[a.DirtyIsEnvelope=256]="DirtyIsEnvelope";a[a.DirtyLength2D=512]="DirtyLength2D";a[a.DirtyRingAreas2D=1024]="DirtyRingAreas2D";a[a.DirtyCoordinates=1993]="DirtyCoordinates";a[a.DirtyAllInternal=65535]="DirtyAllInternal";a[a.DirtyAll=16777215]="DirtyAll"})(a.NL||(a.NL={}));var b=function(b){function c(){var a=
b.call(this)||this;a.zn=65535;a.qa=0;a.kh=-1;a.ob=null;return a}ca(c,b);c.prototype.iq=function(){};c.prototype.Ey=function(){};c.prototype.My=function(){};c.prototype.D=function(){return this.qa};c.prototype.u=function(){return this.Gc()};c.prototype.Gc=function(){return 0==this.qa};c.prototype.Ak=function(a){return 0!=(this.zn&a)};c.prototype.kg=function(a,b){this.zn=b?this.zn|a:this.zn&~a};c.prototype.vc=function(){this.Ak(32)&&this.vO()};c.prototype.Eu=function(){if(this.Gc())throw a.g.X("This operation was performed on an Empty Geometry.");
};c.prototype.xe=function(b,c){if(0>b||b>=this.qa)throw a.g.X("index out of bounds");this.vc();c.Eg(this.description);c.u()&&c.nq();for(var h=0;h<this.description.Ga;h++)for(var p=this.description.Qd(h),d=0,n=a.ma.Xa(p);d<n;d++){var e=this.ya[h].Lf(n*b+d);c.setAttribute(p,d,e)}};c.prototype.xu=function(b,c){this.vc();for(var h=c.description,p=0;p<h.Ga;p++)for(var d=h.Qd(p),n=a.ma.Xa(d),e=0;e<n;e++){var f=c.Wc(d,e);this.setAttribute(d,b,e,f)}};c.prototype.w=function(b,c){if(0>b||b>=this.D())throw a.g.vd();
this.vc();this.ya[0].fc(2*b,c)};c.prototype.Ba=function(b){var h=new a.b;this.w(b,h);return h};c.prototype.Mc=function(a,b){this.ya[0].fc(2*a,b)};c.prototype.rb=function(b,c,d){if(0>b||b>=this.qa)throw a.g.vd();this.vc();var h=this.ya[0];void 0!==d?(h.write(2*b,c),h.write(2*b+1,d)):h.mo(2*b,c);this.Cc(1993)};c.prototype.oA=function(b){if(0>b||b>=this.D())throw a.g.vd();this.vc();var h=this.ya[0],c=new a.od;c.x=h.read(2*b);c.y=h.read(2*b+1);c.z=this.hasAttribute(1)?this.ya[1].Lf(b):a.ma.be(1);return c};
c.prototype.EC=function(b,c){if(0>b||b>=this.D())throw a.g.vd();this.Rd(1);this.vc();this.Cc(1993);var h=this.ya[0];h.write(2*b,c.x);h.write(2*b+1,c.y);this.ya[1].Im(b,c.z)};c.prototype.Wc=function(b,c,d){if(0>c||c>=this.qa)throw a.g.vd();var h=a.ma.Xa(b);if(d>=h)throw a.g.vd();this.vc();var p=this.description.lg(b);return 0<=p?this.ya[p].Lf(c*h+d):a.ma.be(b)};c.prototype.CG=function(a,b,c){return this.Wc(a,b,c)};c.prototype.setAttribute=function(b,c,d,n){if(0>c||c>=this.qa)throw a.g.vd();var h=a.ma.Xa(b);
if(d>=h)throw a.g.vd();this.Rd(b);this.vc();b=this.description.lg(b);this.Cc(1993);this.ya[b].Im(c*h+d,n)};c.prototype.Qa=function(a){this.Eu();this.Rd(a);this.vc();return this.ya[this.description.lg(a)]};c.prototype.eo=function(b,c){if(null!=c&&a.ma.ti(b)!=c.ti())throw a.g.F();this.Rd(b);b=this.description.lg(b);null==this.ya&&(this.ya=a.Tc.LB(this.description.Ga));this.ya[b]=c;this.Cc(16777215)};c.prototype.to=function(b){var h=null;if(null!=this.ya)for(var c=a.we.vx(b,this.description),h=[],d=
0,n=b.Ga;d<n;d++)-1!=c[d]&&(h[d]=this.ya[c[d]]);this.description=b;this.ya=h;this.kh=-1;this.Cc(16777215)};c.prototype.SE=function(b){this.kv(!0);b instanceof a.h?this.$.s(b):this.$.Jp(b)};c.prototype.uO=function(b){this.kv(!1);b instanceof a.h?this.$.s(b):this.$.Jp(b)};c.prototype.Wn=function(a){this.kv(!0);this.$.copyTo(a)};c.prototype.s=function(a){this.SE(a)};c.prototype.Jp=function(a){this.SE(a)};c.prototype.ac=function(a){this.uO(a)};c.prototype.hg=function(b,c){var h=new a.yc;if(this.Gc())return h.Oa(),
h;this.kv(!0);return this.$.hg(b,c)};c.prototype.kc=function(){var b=this.description.kc();if(!this.Gc())for(var c=this.D(),d=0,n=this.description.Ga;d<n;d++)b=this.ya[d].Ck(b,0,c*a.ma.Xa(this.description.Qd(d)));return b};c.prototype.Eb=function(b){if(b==this)return!0;if(!(b instanceof c&&this.description.Eb(b.description))||this.Gc()!=b.Gc())return!1;if(this.Gc())return!0;var h=this.D();if(h!=b.D())return!1;for(var d=0;d<this.description.Ga;d++){var n=this.description.pd(d),e=this.Qa(n),f=b.Qa(n);
if(!e.Eb(f,0,h*a.ma.Xa(n)))return!1}return!0};c.prototype.copyTo=function(b){if(b.G()!=this.G())throw a.g.F();this.BE(b)};c.prototype.BE=function(b){this.vc();b.description=this.description;b.ya=null;var h=this.description.Ga,c=null;if(null!=this.ya)for(var c=[],d=0;d<h;d++)null!=this.ya[d]&&(c[d]=this.ya[d].Sr(this.D()*a.ma.Xa(this.description.Qd(d))));null!=this.$?(b.$=this.$.Ka(),this.$.copyTo(b.$)):b.$=null;b.qa=this.qa;b.zn=this.zn;b.ya=c;try{this.iq(b)}catch(K){throw b.Oa(),a.g.tN();}};c.prototype.PE=
function(){this.qa=0;this.kh=-1;this.ya=null;this.Cc(16777215)};c.prototype.Cc=function(a){16777215==a&&(this.kh=-1,this.Ey());this.zn|=a;this.YN();this.zc()};c.prototype.kv=function(b){this.vc();if(this.Ak(192))if(null==this.$?this.$=new a.di(this.description):this.$.Eg(this.description),this.u())this.$.Oa();else{this.Ly(b);for(var h=1;h<this.description.Ga;h++)for(var c=this.description.Qd(h),d=a.ma.Xa(c),n=this.ya[h],e=0;e<d;e++){var f=new a.yc;f.Oa();for(var g=0;g<this.qa;g++){var w=n.Lf(g*d+
e);f.Nb(w)}this.$.setInterval(c,e,f)}b&&this.kg(192,!1)}};c.prototype.Ly=function(){this.$.Oa();for(var b=this.ya[0],c=new a.b,d=0;d<this.qa;d++)b.fc(2*d,c),this.$.Nb(c)};c.prototype.Bo=function(b){b.Oa();for(var h=this.ya[0],c=new a.b,d=0;d<this.qa;d++)h.fc(2*d,c),b.Nb(c)};c.prototype.vO=function(){if(this.kh<this.qa){null==this.ya&&(this.ya=a.Tc.LB(this.description.Ga));this.kh=2147483647;for(var b=0;b<this.description.Ga;b++){var c=this.description.Qd(b);if(null!=this.ya[b]){var d=a.ma.Xa(c),n=
a.J.truncate(this.ya[b].size/d);n<this.qa&&(n=a.J.truncate(this.kh>this.qa+5?(5*this.qa+3)/4:this.qa),this.ya[b].resize(n*d,a.ma.be(c)));n<this.kh&&(this.kh=n)}else this.ya[b]=a.Tc.oz(c,this.qa),this.kh=this.qa}}this.My();this.kg(32,!1)};c.prototype.El=function(b){if(0>b)throw a.g.F();b!=this.qa&&(this.qa=b,this.Cc(65535))};c.prototype.Nk=function(a){if(!this.Ak(1)){if(!this.Ak(2))return 0;if(this.rV>=a)return this.Ak(8)?1:2}return-1};c.prototype.Xg=function(b,c){this.rV=c;if(-1==b)this.kg(1,!0),
this.kg(8,!0);else if(this.kg(1,!1),this.kg(8,!0),0==b)this.kg(2,!1),this.kg(4,!1);else if(1==b)this.kg(2,!0),this.kg(4,!1);else if(2==b)this.kg(2,!0),this.kg(4,!0);else throw a.g.X("internal error.");};c.prototype.YN=function(){null!=this.ob&&(this.ob=null)};c.prototype.HE=function(b,c,d,n){if(0>b||b>=this.qa)throw a.g.X("index out of bounds");if(0>c||c>=this.qa)throw a.g.X("index out of bounds");this.vc();n.Eg(this.description);n.u()&&n.nq();for(var h=0;h<this.description.Ga;h++)for(var p=this.description.Qd(h),
y=0,e=a.ma.Xa(p);y<e;y++){var f=this.ya[h].Lf(e*b+y),D=this.ya[h].Lf(e*c+y);n.setAttribute(p,y,a.Ub.Xq(f,D,d))}};c.prototype.vs=function(a,b){var h=this.ya[0].f,c=h[2*a]-h[2*b],h=h[2*a+1]-h[2*b+1];return Math.sqrt(c*c+h*h)};c.prototype.Zh=function(b,c){if(0>b||b>=this.qa)throw a.g.vd();if(c.u())throw a.g.F();this.vc();for(var h=c.description,p=0;p<h.Ga;p++)for(var d=h.pd(p),n=a.ma.Xa(d),e=0;e<n;e++){var f=c.Wc(d,e);this.setAttribute(d,b,e,f)}};c.prototype.bv=function(){return null};c.prototype.Kj=
function(){return null};return c}(a.T);a.Ou=b})(C||(C={}));(function(a){var b=function(){function b(){this.pb=this.Uo=null;this.Mn=124234251;this.Dw=!0;this.mf=-1;this.pb=new a.Zc(7);this.Uo=null}b.prototype.Lp=function(a){this.Uo=a};b.prototype.kR=function(){this.Dw=!1};b.prototype.Ne=function(a){this.pb.Ne(a)};b.prototype.Is=function(a){var b=this.pb.Me();this.RX(b);this.UX(a,b);return b};b.prototype.fR=function(a){this.pb.jd(a)};b.prototype.addElement=function(a,b){var h;-1==b?(-1==this.mf&&(this.mf=
this.Is(-1)),h=this.mf):h=b;return this.YE(a,0,h)};b.prototype.bF=function(a){-1==this.mf&&(this.mf=this.Is(-1));return this.YE(a,1,this.mf)};b.prototype.yo=function(a){var b;-1==this.mf&&(this.mf=this.Is(-1));b=this.mf;var c=this.pb.f;if(-1==b||-1==c[7*b])return a=this.pb.pl([-1,-1,-1,a,this.Ql(),-1,-1]),c=this.pb.f,c[7*b]=a,this.pq(-1,a,b,c),a;var d=-1==b?-1:c[7*b+2];a=this.pb.pl([-1,-1,d,a,this.Ql(),-1,-1]);c=this.pb.f;c[7*d+1]=a;this.Sy(a,c);-1===c[7*a+2]&&(c[7*b]=a);this.pq(-1,a,b,c);return a};
b.prototype.ov=function(b,h,c,d){var p=-1;-1==p&&(-1==this.mf&&(this.mf=this.Is(-1)),p=this.mf);var y=this.pb.f;if(-1==p||-1==y[7*p])return c=this.pb.pl([-1,-1,-1,c,this.Ql(),-1,-1]),y=this.pb.f,y[7*p]=c,this.pq(-1,c,p,y),c;var n;d?(d=-1!=h?this.Uo.compare(this,c,h):-1,n=-1!=b?this.Uo.compare(this,c,b):1):(d=-1,n=1);if(0==d||0==n)return y[7*p+3]=0==d?h:b,-1;(-1!=h&&-1!=b?this.Mn>a.J.KB(this.Mn)>>1:-1!=h)?b=h:d=n;for(h=!0;;){if(0>d)if(n=y[7*b],-1!=n)b=n;else{d=b;c=this.pb.pl([-1,-1,b,c,this.Ql(),-1,
-1]);y=this.pb.f;y[7*b]=c;break}else if(n=y[7*b+1],-1!=n)b=n;else{d=y[7*b+6];c=this.pb.pl([-1,-1,b,c,this.Ql(),-1,-1]);y=this.pb.f;y[7*b+1]=c;break}h&&(d*=-1,h=!1)}this.Sy(c,y);-1===y[7*c+2]&&(y[7*p]=c);this.pq(d,c,p,y);return c};b.prototype.IG=function(){return this.AS(this.mf)};b.prototype.Jd=function(a,b){b=-1==b?this.mf:b;this.Dw?this.eR(a,b):this.KY(a,b)};b.prototype.search=function(a,b){for(b=this.fw(b);-1!=b;){var h=this.Uo.compare(this,a,b);if(0==h)return b;b=0>h?this.Ul(b):this.Nq(b)}return-1};
b.prototype.lX=function(a){for(var b=this.fw(-1),c=-1;-1!=b;){var d=a.compare(this,b);if(0==d)return b;0>d?b=this.Ul(b):(c=b,b=this.Nq(b))}return c};b.prototype.$J=function(a){for(var b=this.fw(-1),c=-1;-1!=b;){var d=a.compare(this,b);if(0==d)return b;0>d?(c=b,b=this.Ul(b)):b=this.Nq(b)}return c};b.prototype.ia=function(a){return this.pb.S(a,3)};b.prototype.Ul=function(a){return this.pb.S(a,0)};b.prototype.Nq=function(a){return this.pb.S(a,1)};b.prototype.getParent=function(a){return this.pb.S(a,
2)};b.prototype.nb=function(a){return this.pb.S(a,6)};b.prototype.Se=function(a){return this.pb.S(a,5)};b.prototype.wc=function(a){return-1==a?this.Tl(this.mf):this.Tl(a)};b.prototype.Ec=function(a){return-1==a?this.Xs(this.mf):this.Xs(a)};b.prototype.tT=function(a){return-1==a?this.eH(this.mf):this.eH(a)};b.prototype.pk=function(a,b){this.qC(a,b)};b.prototype.fw=function(a){return-1==a?this.$G(this.mf):this.$G(a)};b.prototype.clear=function(){this.pb.Wi(!1);this.mf=-1};b.prototype.size=function(a){return-1==
a?this.bH(this.mf):this.bH(a)};b.prototype.kP=function(a,b){for(var h=b[7*a],c=b[7*a+1],d=b[7*a+4];-1!=h||-1!=c;){var n=-1!=h?b[7*h+4]:2147483647,c=-1!=c?b[7*c+4]:2147483647;if(d<=Math.min(n,c))break;n<=c?this.XJ(h,b):this.WJ(a,b);h=b[7*a];c=b[7*a+1]}};b.prototype.Sy=function(a,b){if(this.Dw)for(var h=b[7*a+4],c=b[7*a+2];-1!=c&&b[7*c+4]>h;)b[7*c]==a?this.XJ(a,b):this.WJ(c,b),c=b[7*a+2]};b.prototype.WJ=function(a,b){var h=b[7*a+1],c;b[7*h+2]=b[7*a+2];b[7*a+2]=h;c=b[7*h];b[7*a+1]=c;-1!=c&&(b[7*c+2]=
a);b[7*h]=a;c=b[7*h+2];-1!=c&&(b[7*c]==a?b[7*c]=h:b[7*c+1]=h)};b.prototype.XJ=function(a,b){var h=b[7*a+2],c;b[7*a+2]=b[7*h+2];b[7*h+2]=a;c=b[7*a+1];b[7*h]=c;-1!=c&&(b[7*c+2]=h);b[7*a+1]=h;c=b[7*a+2];-1!=c&&(b[7*c]===h?b[7*c]=a:b[7*c+1]=a)};b.prototype.ul=function(a,b){this.pb.R(a,2,b)};b.prototype.uC=function(a,b){this.pb.R(a,0,b)};b.prototype.yC=function(a,b){this.pb.R(a,1,b)};b.prototype.xC=function(a,b){this.pb.R(a,5,b)};b.prototype.Qx=function(a,b){this.pb.R(a,6,b)};b.prototype.CK=function(a,
b){this.pb.R(b,0,a)};b.prototype.RX=function(a){this.pb.R(a,4,0)};b.prototype.UX=function(a,b){this.pb.R(b,5,a)};b.prototype.$G=function(a){return-1==a?-1:this.pb.S(a,0)};b.prototype.Tl=function(a){return-1==a?-1:this.pb.S(a,1)};b.prototype.Xs=function(a){return-1==a?-1:this.pb.S(a,2)};b.prototype.AS=function(a){return-1==a?-1:this.pb.S(a,3)};b.prototype.bH=function(a){return-1==a?0:this.pb.S(a,4)};b.prototype.eH=function(a){return this.pb.S(a,5)};b.prototype.Bx=function(a){return this.pb.pl([-1,
-1,-1,a,this.Ql(),-1,-1])};b.prototype.Pl=function(a){-1!=a&&this.pb.jd(a)};b.prototype.Ql=function(){this.Mn=a.J.KB(this.Mn);return this.Mn&1073741823};b.prototype.YE=function(a,b,c){var h=this.pb.f;if(-1==c||-1==h[7*c])return a=this.pb.pl([-1,-1,-1,a,this.Ql(),-1,-1]),h=this.pb.f,h[7*c]=a,this.pq(-1,a,c,h),a;for(var p=-1==c?-1:h[7*c];;){var d=-1==b?1:this.Uo.compare(this,a,p);if(0>d)if(d=this.Ul(p),-1!=d)p=d;else{b=p;a=this.pb.pl([-1,-1,p,a,this.Ql(),-1,-1]);h=this.pb.f;h[7*p]=a;break}else{if(1==
b&&0==d)return h[7*c+3]=p,-1;d=h[7*p+1];if(-1!=d)p=d;else{b=h[7*p+6];a=this.pb.pl([-1,-1,p,a,this.Ql(),-1,-1]);h=this.pb.f;h[7*p+1]=a;break}}}this.Sy(a,h);-1===h[7*a+2]&&(h[7*c]=a);this.pq(b,a,c,h);return a};b.prototype.pq=function(a,b,c,d){var h;-1!=a?(h=d[7*a+5],d[7*a+5]=b):h=-1==c?-1:d[7*c+2];d[7*b+5]=h;-1!=h&&(d[7*h+6]=b);d[7*b+6]=a;a==(-1==c?-1:d[7*c+1])&&(d[7*c+1]=b);-1==a&&(d[7*c+2]=b);d[7*c+4]=(-1==c?0:d[7*c+4])+1};b.prototype.cC=function(a,b){var h=this.pb.f,c=h[7*a+5];a=h[7*a+6];-1!=c?h[7*
c+6]=a:h[7*b+1]=a;-1!=a?h[7*a+5]=c:h[7*b+2]=c;h[7*b+4]=-1===b?-1:h[7*b+4]-1};b.prototype.KY=function(b,h){this.cC(b,h);var c=this.Ul(b),d=this.Nq(b),n=this.getParent(b),e=b;if(-1!=c&&-1!=d){this.Mn=a.J.KB(this.Mn);var f;f=1073741823<this.Mn?this.nb(b):this.Se(b);var g=this.getParent(f)==b;this.pb.ay(b,f,0);this.pb.ay(b,f,1);this.pb.ay(b,f,2);-1!=n?this.Ul(n)==b?this.uC(n,f):this.yC(n,f):this.CK(f,h);g?(c==f?(this.uC(f,b),this.ul(d,f)):d==f&&(this.yC(f,b),this.ul(c,f)),this.ul(b,f),n=f):(this.ul(c,
f),this.ul(d,f),n=this.getParent(b),e=f);c=this.Ul(b);d=this.Nq(b);-1!=c&&this.ul(c,b);-1!=d&&this.ul(d,b)}c=-1!=c?c:d;-1==n?this.CK(c,h):this.Ul(n)==e?this.uC(n,c):this.yC(n,c);-1!=c&&this.ul(c,n);this.Pl(b,h)};b.prototype.eR=function(a,b){var h=this.pb.f;h[7*a+4]=2147483647;var c=-1,d=-1,n=-1===b?-1:h[7*b],e=n==a;e&&(c=h[7*n],d=h[7*n+1],-1==c&&-1==d)?(this.cC(n,b),this.Pl(n,b),h[7*b]=-1):(this.kP(a,h),n=h[7*a+2],-1!=n&&(h[7*n]==a?h[7*n]=-1:h[7*n+1]=-1),this.cC(a,b),this.Pl(a,b),e&&(h[7*b]=-1==c||
-1!=h[7*c+2]?d:c))};b.prototype.qC=function(a,b){this.pb.R(a,3,b)};return b}();a.xk=b})(C||(C={}));(function(a){var b=function(){function b(a,b){void 0!==a&&this.I(a,b)}b.prototype.I=function(a,b){this.ga=a;this.la=b;this.normalize()};b.prototype.Yb=function(a){return this.ga<=a.ga?this.la>=a.ga:a.la>=this.ga};b.prototype.move=function(a){this.u()||(this.ga+=a,this.la+=a)};b.prototype.normalize=function(){if(!isNaN(this.ga)){if(this.ga>this.la){var a=this.ga;this.ga=this.la;this.la=a}isNaN(this.la)&&
this.Oa()}};b.prototype.Oa=function(){this.la=this.ga=NaN};b.prototype.u=function(){return isNaN(this.ga)};b.prototype.Nb=function(a){"number"===typeof a?this.u()?this.la=this.ga=a:this.ol(a):a.u()||(this.u()?(this.ga=a.ga,this.la=a.la):(this.ga>a.ga&&(this.ga=a.ga),this.la<a.la&&(this.la=a.la),this.ga>this.la&&this.Oa()))};b.prototype.ol=function(a){a<this.ga?this.ga=a:a>this.la&&(this.la=a)};b.prototype.contains=function(a){return"number"===typeof a?a>=this.ga&&a<=this.la:a.ga>=this.ga&&a.la<=this.la};
b.prototype.Ma=function(a){this.u()||a.u()?this.Oa():(this.ga<a.ga&&(this.ga=a.ga),this.la>a.la&&(this.la=a.la),this.ga>this.la&&this.Oa())};b.prototype.P=function(a){this.u()||(this.ga-=a,this.la+=a,this.la<this.ga&&this.Oa())};b.prototype.uo=function(){return this.u()?2.220446049250313E-14:2.220446049250313E-14*(Math.abs(this.ga)+Math.abs(this.la)+1)};b.prototype.nC=function(a,b){a>b?(this.ga=b,this.la=a):(this.ga=a,this.la=b)};b.prototype.yu=function(b){return a.J.tk(b,this.ga,this.la)};b.prototype.O=
function(){return this.la-this.ga};b.prototype.Tf=function(){return.5*(this.ga+this.la)};b.prototype.Eb=function(a){return a==this?!0:a instanceof b?this.u()&&a.u()?!0:this.ga!=a.ga||this.la!=a.la?!1:!0:!1};b.prototype.kc=function(){return a.J.$i(a.J.$i())};return b}();a.yc=b})(C||(C={}));(function(a){var b=new a.yc,c=new a.yc,d=function(){return function(){this.Ie=null;this.qb=-1;this.xb=new a.Hb;this.aB=55555555;this.Fw=this.Iw=!1;this.qg=new a.yc;this.qg.nC(0,0)}}();a.MZ=d;var h=function(){function h(b,
h,c){this.a=b;this.kl=NaN;this.OI=this.Ar=0;this.QI=NaN;this.ta=h;this.Dr=10*h;this.RI=this.SI=NaN;this.Lg=!1;this.xn=this.$t=this.Cp=this.Ut=this.Tt=-1;this.SA=c;this.CB=new d;this.ZI=new d;a.J.truncate(3*b.ud/2)}h.prototype.oH=function(a,b,h,c){a.Ie=null===c?null:c[h[5*b]];a.Fw=null!=a.Ie;a.Fw||(c=h[5*b+2],-1!==c&&this.a.LW(h[5*b],h[5*c],a.xb),a.Ie=a.xb,a.qg.nC(a.xb.ua,a.xb.sa),a.qg.la+=this.ta,a.xb.pJ(),a.Iw=a.xb.oa==a.xb.ra,a.Iw||(a.aB=(a.xb.sa-a.xb.ua)/(a.xb.oa-a.xb.ra)))};h.prototype.nQ=function(a,
b){var h=a.ws(b,this.ta,!0);if(0!=h)return 2==h?this.Az():this.Xi();a.Oq(pa);a.Ns(sa);b.Oq(ta);b.Ns(W);na.ja(this.Ar,this.kl);pa.vb(ta)&&this.kl==pa.y?0>sa.compare(W)?na.L(sa):na.L(W):pa.vb(W)&&this.kl==pa.y?0>sa.compare(ta)?na.L(sa):na.L(ta):ta.vb(sa)&&this.kl==ta.y?0>pa.compare(W)?na.L(pa):na.L(W):sa.vb(W)&&this.kl==sa.y&&(0>pa.compare(ta)?na.L(pa):na.L(ta));return a.kf(na.y,na.x)<b.kf(na.y,na.x)?-1:1};h.prototype.lQ=function(a,b){if(a.xb.ra==b.xb.ra&&a.xb.ua==b.xb.ua)return a.xb.oa==b.xb.oa&&a.xb.sa==
b.xb.sa?this.SA?this.Az():0:this.VF(a,b);if(a.xb.oa==b.xb.oa&&a.xb.sa==b.xb.sa)return this.UF(a,b);var h=this.UF(a,b);a=this.VF(a,b);return 0>h&&0>a?-1:0<h&&0<a?1:this.Xi()};h.prototype.hQ=function(a,b){if(a.sa>b.sa){if(b.sa>b.ua&&b.oa-b.ra<2*this.ta&&a.Ti(b.sa,b.oa,this.ta))return this.Xi()}else if((b.oa-b.ra)/(b.sa-b.ua)*(a.sa-a.ua)<this.Dr&&b.Ti(a.sa,a.oa,this.ta))return this.Xi();return 1};h.prototype.iQ=function(a,b){if(a.ua<b.ua){if(b.sa>b.ua&&b.oa-b.ra<2*this.ta&&a.Ti(b.sa,b.oa,this.ta))return this.Xi()}else if((b.oa-
b.ra)/(b.sa-b.ua)*(a.ua-a.sa)<this.Dr&&b.Ti(a.ua,a.ra,this.ta))return this.Xi();return-1};h.prototype.jQ=function(b,h){var c=new a.b;c.xc(h.Ac(),h.ec());c.Tr();c.normalize();var p=new a.b;p.xc(b.ec(),h.ec());var d=new a.b;d.xc(b.Ac(),h.ec());var p=p.pi(c),c=d.pi(c),d=Math.abs(p),y=Math.abs(c);if(d<y){if(d<this.Dr&&h.Ti(b.ua,b.ra,this.ta))return this.Xi()}else if(y<this.Dr&&h.Ti(b.sa,b.oa,this.ta))return this.Xi();return 0>p&&0>c?-1:0<p&&0<c?1:this.Xi()};h.prototype.TF=function(a,b){return a.ra==b.ra&&
a.ua==b.ua?this.hQ(a,b):a.oa==b.oa&&a.sa==b.sa?this.iQ(a,b):this.jQ(a,b)};h.prototype.kQ=function(a,b){return a.oa==b.oa&&a.sa==b.sa&&a.ra==b.ra&&a.ua==b.ua?this.SA?this.Az():0:this.Xi()};h.prototype.UF=function(a,b){var h=1;if(a.xb.ra<b.xb.ra){var h=-1,c=a;a=b;b=c}c=a.xb;a=b.xb;var p=c.ua-a.ua;b=b.aB*(c.ra-a.ra);var d=this.Dr;return p<b-d?-h:p>b+d?h:a.Ti(c.ua,c.ra,this.ta)?this.Xi():p<b?-h:h};h.prototype.VF=function(a,b){var h=1;if(b.xb.oa<a.xb.oa){var h=-1,c=a;a=b;b=c}c=a.xb;a=b.xb;var p=c.sa-a.ua;
b=b.aB*(c.oa-a.ra);var d=this.Dr;return p<b-d?-h:p>b+d?h:a.Ti(c.sa,c.oa,this.ta)?this.Xi():p<b?-h:h};h.prototype.Az=function(){this.Lg=!0;this.nj=new a.Yd(5,this.Cp,this.$t);return-1};h.prototype.Xi=function(){this.Lg=!0;this.SA?this.nj=new a.Yd(4,this.Cp,this.$t):this.$t=this.Cp=this.Ut=this.Tt=-1;return-1};h.prototype.mQ=function(a,h,p,d){if(this.Lg)return-1;var y=this.QI==this.kl&&this.OI==this.Ar,n;y&&a==this.Tt?n=this.RI:(n=NaN,this.Tt=-1);y&&h==this.Ut?y=this.SI:(y=NaN,this.Ut=-1);p.Ie.GJ(b);
d.Ie.GJ(c);if(b.la<c.ga)return-1;if(c.la<b.ga)return 1;this.QI=this.kl;this.OI=this.Ar;isNaN(n)&&(this.Tt=a,this.RI=n=a=p.Ie.kf(this.kl,this.Ar));isNaN(y)&&(this.Ut=h,this.SI=y=a=d.Ie.kf(this.kl,this.Ar));return Math.abs(n-y)<=this.ta?this.nQ(p.Ie,d.Ie):n<y?-1:n>y?1:0};h.prototype.Es=function(){this.Lg=!1};h.prototype.ln=function(){return this.nj};h.prototype.EK=function(a,b){this.kl=a;this.Ar=b;this.$t=this.Cp=this.Ut=this.Tt=-1};h.prototype.compare=function(a,b,h){if(this.Lg)return-1;a=a.ia(h);
this.xn=h;return this.XF(b,b,a,a)};h.prototype.XF=function(a,b,h,c){var p;this.Cp==b?p=this.CB:(this.Cp=b,p=this.CB,this.CB.qb=a,this.oH(p,b,this.a.Cd.f,this.a.tf));var d;null==d&&(this.$t=c,d=this.ZI,this.ZI.qb=h,this.oH(d,c,this.a.Cd.f,this.a.tf));if(p.Fw||d.Fw)return this.mQ(b,c,p,d);if(p.qg.la<d.qg.ga)return-1;if(d.qg.la<p.qg.ga)return 1;a=p.Iw?1:0;a|=d.Iw?2:0;return 0==a?this.lQ(p,d):1==a?this.TF(p.xb,d.xb):2==a?-1*this.TF(d.xb,p.xb):this.kQ(p.xb,d.xb)};return h}();a.lE=h})(C||(C={}));(function(a){var b=
function(){function b(b,h){this.a=b;this.ta=h;this.Lg=!1;this.Cp=-1;this.qg=new a.yc;this.wr=new a.b;this.wr.Yc();this.Ce=new a.Hb;this.xn=-1;this.kB=1.7976931348623157E308}b.prototype.Es=function(){this.Lg=!1;this.kB=1.7976931348623157E308};b.prototype.Zh=function(a){this.wr.L(a)};b.prototype.compare=function(a,b){return this.YF(b,a.ia(b))};b.prototype.YF=function(b,h){var c=null!=this.a.jc(h);c||(this.a.nd(h,this.Ce),this.qg.nC(this.Ce.ua,this.Ce.sa));if(c)throw a.g.X("not implemented");if(this.wr.x+
this.ta<this.qg.ga)return-1;if(this.wr.x-this.ta>this.qg.la)return 1;if(this.Ce.ra==this.Ce.oa)return this.xn=b,this.Lg=!0,0;this.Ce.pJ();h=this.Ce.ec();c=new a.b;c.xc(this.Ce.Ac(),h);c.Tr();var d=new a.b;d.xc(this.wr,h);h=c.pi(d);h/=c.length();return h<10*-this.ta?-1:h>10*this.ta?1:this.Ce.ot(this.wr,this.ta)&&(c=Math.abs(h),c<this.kB&&(this.xn=b,this.kB=c),this.Lg=!0,c<.25*this.ta)?0:0>h?-1:1};return b}();a.AN=b})(C||(C={}));(function(a){function b(a,b,c,d){c=new Float64Array(a.subarray(c,d));a.set(c,
b)}var c=function(){function b(h){this.xa=this.ze=!1;this.f=[];var c=h;2>c&&(c=2);this.f=a.J.df(c,b.tb);this.size=h}b.prototype.rotate=function(b,c,d){if(this.xa)throw a.g.X("invalid_call");if(c<b||c>d||b>d)throw a.g.F();b!=c&&d!=c&&(this.Xd(b,c-b,1),this.Xd(c,d-c,1),this.Xd(b,d-b,1))};b.yd=function(a,c){b.tb=c;a=new b(a);b.tb=0;return a};b.Dk=function(a){var h=new b(0);h.f=a.f.slice(0);h.size=a.size;return h};b.N=function(a,c){var h=new b(0);h.size=a.size;h.size>c&&(h.size=c);h.f=a.f.slice(0,h.size);
return h};b.prototype.zb=function(){};b.prototype.read=function(a){return this.f[a]};b.prototype.fc=function(a,b){b.x=this.f[a];b.y=this.f[a+1]};b.prototype.TW=function(a,b){b.x=this.f[a];b.y=this.f[a+1]};b.prototype.get=function(a){return this.f[a]};b.prototype.write=function(b,c){if(this.xa)throw a.g.Da();this.f[b]=c};b.prototype.set=function(b,c){if(this.xa)throw a.g.Da();this.f[b]=c};b.prototype.mo=function(b,c){if(this.xa)throw a.g.Da();this.f[b]=c.x;this.f[b+1]=c.y};b.prototype.add=function(a){this.resize(this.size+
1);this.f[this.size-1]=a};b.prototype.Sr=function(a){return b.N(this,a)};b.prototype.Lf=function(a){return this.read(a)};b.prototype.resize=function(b,c){void 0===c&&(c=0);if(this.ze)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");if(b<=this.size){if(a.J.truncate(5*b/4)<this.f.length){var h=this.f.slice(0,b);this.f=h}}else if(b>this.f.length){a.J.truncate(64>b?Math.max(2*b,4):5*b/4);for(var h=this.f.slice(0),p=this.f.length;p<b;p++)h[p]=c;this.f=h}this.size=b};b.prototype.uf=
function(b){(null==this.f||b>this.f.length)&&this.resize(b);if(this.ze)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=b};b.prototype.Im=function(a,b){this.write(a,b)};b.prototype.Ck=function(b,c,d){for(var h=this.size;c<h&&c<d;c++)b=a.J.$i(this.read(c));return b};b.prototype.Eb=function(a,c,d){if(null==a||!(a instanceof b))return!1;var h=this.size,p=a.size;if(d>h||d>p&&h!=p)return!1;for(d>h&&(d=h);c<d;c++)if(this.read(c)!=a.read(c))return!1;return!0};b.prototype.Sq=
function(b,c,d,n,e,f){if(this.xa)throw a.g.Da();0>f&&(f=this.size);this.size+2*n>this.f.length?this.resize(this.size+2*n):this.size+=2*n;f-=b;for(var h=this.f.slice(b,b+f),p=0;p<f;p++)this.f[b+2*n+p]=h[p];if(e)for(e=0;e<n;e++)f=c[d++],this.f[b++]=f.x,this.f[b++]=f.y;else for(e=0,h=n-1;e<n;++e)f=c[d+h],this.f[b++]=f.x,this.f[b++]=f.y,h--};b.prototype.Tk=function(b,c,d,n,e,f,g){if(this.xa)throw a.g.Da();if(!e&&(1>f||0!=n%f))throw a.g.F();var h=this.size-g;h<n&&this.resize(this.size+n-h);for(h=0;h<g-
b;h++)this.f[b+n+h]=this.f[b+h];this.f==c.f&&b<d&&(d+=n);if(e)for(h=0;h<n;h++)this.f[h+b]=c.f[d+h];else for(e=n,g=0;g<n;g+=f)for(e-=f,h=0;h<f;h++)this.f[b+g+h]=c.f[d+e+h]};b.prototype.Zj=function(b,c,d,n){if(this.xa)throw a.g.Da();n-=b;for(var h=this.f.slice(b,b+n),p=0;p<n;p++)this.f[b+d+p]=h[p];for(n=0;n<d;n++)this.f[b+n]=c};b.prototype.dh=function(b,c,d){if(this.xa)throw a.g.Da();for(var h=this.f.slice(b,b+(d-b)),p=0;p<d-b;p++)this.f[p+b+2]=h[p];this.f[b]=c.x;this.f[b+1]=c.y};b.prototype.hs=function(b,
c,d,n,e){if(0>b||0>c||0>n)throw a.g.F();if(d.length<n+c)throw a.g.F();if(0!=c)if(this.size<c+b&&this.resize(c+b),e)for(e=0;e<c;e++)this.f[b+e]=d[n+e];else for(e||(b+=c-1),c=n+c;n<c;n++)this.f[b]=d[n],b--};b.prototype.no=function(b,c,d,n,e,f){if(0>b||0>c||0>n)throw a.g.F();if(!e&&(0>=f||0!=c%f))throw a.g.F();if(d.size<n+c)throw a.g.F();if(0!=c)if(this.size<c+b&&this.resize(c+b),d==this)this.Mj(b,c,n,e,f);else if(e)for(e=0;e<c;e++)this.f[b]=d.f[n],b++,n++;else if(n=n+c-f,1==f)for(e=0;e<c;e++)this.f[b]=
d.f[n],b++,n--;else for(e=0,c=a.J.truncate(c/f);e<c;e++){for(var h=0;h<f;h++)this.f[b+h]=d.f[n+h];b+=f;n-=f}};b.prototype.Hk=function(b,c,d){if(this.xa)throw a.g.Da();if(b+c>this.size)throw a.g.Da();if(0<d-(b+c)){d-=b+c;for(var h=this.f.slice(b+c,b+d+c),p=0;p<d;p++)this.f[b+p]=h[p]}this.size-=c};b.prototype.Xd=function(b,c,d){if(this.xa)throw a.g.Da();if(1>d||0!=c%d)throw a.g.Da();for(var h=c>>1,p=0;p<h;p+=d){c-=d;for(var y=0;y<d;y++){var n=this.f[b+p+y];this.f[b+p+y]=this.f[b+c+y];this.f[b+c+y]=
n}}};b.prototype.$h=function(b,c,d){if(0>c||0>d||0>c||d+c>this.size)throw a.g.F();for(var h=c;h<c+d;h++)this.f[h]=b};b.prototype.Mj=function(b,c,d,n,e){if(!n||b!=d){for(var h=0;h<c;h++)this.f[b+h]=this.f[d+h];if(!n)for(d=b,b=b+c-e,n=0,c=a.J.truncate(c/2);n<c;n++){for(h=0;h<e;h++){var p=this.f[d+h];this.f[d+h]=this.f[b+h];this.f[b+h]=p}d+=e;b-=e}}};b.prototype.js=function(b,c,d,n,e){if(0>b||0>c||0>n)throw a.g.F();if(0!=c)for(this.size<(c<<1)+b&&this.resize((c<<1)+b),e||(b+=c-1<<1),e=e?2:-2,c+=n;n<
c;n++)this.f[b]=d[n].x,this.f[b+1]=d[n].y,b+=e};b.prototype.hy=function(b,c,d,n,e){if(0>b||0>c||0>n)throw a.g.F();if(0!=c)for(this.size<(c<<1)+b&&this.resize((c<<1)+b),e||(b+=c-1<<1),e=e?2:-2,c+=n;n<c;n++)this.f[b]=d[n][0],this.f[b+1]=d[n][1],b+=e};b.prototype.rl=function(b,c,d,n,e){if(0>b||0>c||0>n||this.size<c+b)throw a.g.F();if(e)for(e=0;e<c;e++)d[n+e]=this.f[b+e];else for(n=n+c-1;b<c;b++)d[n]=this.f[b],n--};b.prototype.Hx=function(b,c,d,n,e){if(0>b||0>c||0>n||this.size<(c>>1)+b)throw a.g.F();
if(0!=c)for(e||(b+=c-1),e=e?2:-2,c=n+c;n<c;n++)d[n][0]=this.f[b],d[n][1]=this.f[b+1],b+=e};b.prototype.clear=function(a){a?this.resize(0):this.uf(0)};b.prototype.Tp=function(){this.ze=this.xa=!0};b.prototype.Fd=function(a,b,c){var h=this.f.slice(0,a),d=this.f.slice(b);a=this.f.slice(a,b).sort(c);this.f.length=0;this.f.push.apply(this.f,h.concat(a).concat(d))};b.prototype.ti=function(){return 1};b.tb=0;return b}();a.Pd=c;c=function(){function c(a){this.xa=this.ze=!1;this.f=null;var b=a;2>b&&(b=2);
this.f=new Float64Array(b);this.size=a}c.prototype.rotate=function(b,c,d){if(this.xa)throw a.g.X("invalid_call");if(c<b||c>d||b>d)throw a.g.F();b!=c&&d!=c&&(this.Xd(b,c-b,1),this.Xd(c,d-c,1),this.Xd(b,d-b,1))};c.yd=function(a,b){var h=new c(a),d=h.f;2>a&&(a=2);if(0!==b)for(var p=0;p<a;p++)d[p]=b;return h};c.Dk=function(a){var b=new c(0);b.f=new Float64Array(a.f);b.size=a.size;return b};c.N=function(a,b){var h=new c(0);h.size=a.size;h.size>b&&(h.size=b);b=h.size;2>b&&(b=2);h.f=new Float64Array(b);
h.f.set(a.f.length<=b?a.f:a.f.subarray(0,b),0);return h};c.prototype.zb=function(a){0>=a||(null==this.f?this.f=new Float64Array(a):a<=this.f.length||(0<this.f.length?(a=new Float64Array(a),a.set(this.f),this.f=a):this.f=new Float64Array(a)))};c.prototype.read=function(a){return this.f[a]};c.prototype.fc=function(a,b){b.x=this.f[a];b.y=this.f[a+1]};c.prototype.get=function(a){return this.f[a]};c.prototype.write=function(b,c){if(this.xa)throw a.g.Da();this.f[b]=c};c.prototype.set=function(b,c){if(this.xa)throw a.g.Da();
this.f[b]=c};c.prototype.mo=function(b,c){if(this.xa)throw a.g.Da();this.f[b]=c.x;this.f[b+1]=c.y};c.prototype.add=function(a){this.resize(this.size+1);this.f[this.size-1]=a};c.prototype.Sr=function(a){return c.N(this,a)};c.prototype.Lf=function(a){return this.read(a)};c.prototype.resize=function(b,c){void 0===c&&(c=0);if(this.ze)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");if(b<=this.size){if(30<this.f.length&&5*b/4<this.f.length){var h=new Float64Array(this.f,0,
b);this.f=h}}else{b>this.f.length&&(h=a.J.truncate(64>b?Math.max(2*b,4):5*b/4),h=new Float64Array(h),h.set(this.f),this.f=h);for(var h=this.f,d=this.size;d<b;d++)h[d]=c}this.size=b};c.prototype.uf=function(b){(null==this.f||b>this.f.length)&&this.resize(b);if(this.ze)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=b};c.prototype.Im=function(a,b){this.write(a,b)};c.prototype.Ck=function(b,c,d){for(var h=this.size;c<h&&c<d;c++)b=a.J.$i(this.read(c));return b};
c.prototype.Eb=function(a,b,d){if(null==a||!(a instanceof c))return!1;var h=this.size,p=a.size;if(d>h||d>p&&h!=p)return!1;for(d>h&&(d=h);b<d;b++)if(this.read(b)!=a.read(b))return!1;return!0};c.prototype.Tk=function(c,d,y,n,e,f,g){if(this.xa)throw a.g.Da();if(!e&&(1>f||0!=n%f))throw a.g.F();var h=this.size-g;h<n&&this.resize(this.size+n-h);b(this.f,c+n,c,c+(g-c));this.f==d.f&&c<y&&(y+=n);if(e)this.f.set(d.f.subarray(y,y+n),c);else for(e=n,g=0;g<n;g+=f)for(e-=f,h=0;h<f;h++)this.f[c+g+h]=d.f[y+e+h]};
c.prototype.Sq=function(c,d,y,n,e,f){if(this.xa)throw a.g.Da();0>f&&(f=this.size);this.size+2*n>this.f.length?this.resize(this.size+2*n):this.size+=2*n;b(this.f,c+2*n,c,c+(f-c));if(e)for(e=0;e<n;e++)f=d[y++],this.f[c++]=f.x,this.f[c++]=f.y;else{e=0;for(var h=n-1;e<n;++e)f=d[y+h],this.f[c++]=f.x,this.f[c++]=f.y,h--}};c.prototype.Zj=function(c,d,y,n){if(this.xa)throw a.g.Da();n-=c;b(this.f,c+n,c,c+n);for(n=0;n<y;n++)this.f[c+n]=d};c.prototype.dh=function(c,d,y){if(this.xa)throw a.g.Da();b(this.f,c+
2,c,c+(y-c));this.f[c]=d.x;this.f[c+1]=d.y};c.prototype.hs=function(b,c,d,n,e){if(0>b||0>c||0>n)throw a.g.F();if(d.length<n+c)throw a.g.F();if(0!=c)if(this.size<c+b&&this.resize(c+b),e)this.f.set(d.subarray(n,c),b);else for(e||(b+=c-1),c=n+c;n<c;n++)this.f[b]=d[n],b--};c.prototype.no=function(b,c,d,n,e,f){if(0>b||0>c||0>n)throw a.g.F();if(!e&&(0>=f||0!=c%f))throw a.g.F();if(d.size<n+c)throw a.g.F();if(0!=c)if(this.size<c+b&&this.resize(c+b),d==this)this.Mj(b,c,n,e,f);else if(e)for(e=0;e<c;e++)this.f[b]=
d.f[n],b++,n++;else if(n=n+c-f,1==f)for(e=0;e<c;e++)this.f[b]=d.f[n],b++,n--;else for(e=0,c=a.J.truncate(c/f);e<c;e++){for(var h=0;h<f;h++)this.f[b+h]=d.f[n+h];b+=f;n-=f}};c.prototype.Hk=function(c,d,y){if(this.xa)throw a.g.Da();if(c+d>this.size)throw a.g.Da();0<y-(c+d)&&b(this.f,c,c+d,c+(y-(c+d))+d);this.size-=d};c.prototype.Xd=function(b,c,d){if(this.xa)throw a.g.Da();if(1>d||0!=c%d)throw a.g.Da();for(var h=c>>1,p=0;p<h;p+=d){c-=d;for(var y=0;y<d;y++){var n=this.f[b+p+y];this.f[b+p+y]=this.f[b+
c+y];this.f[b+c+y]=n}}};c.prototype.$h=function(b,c,d){if(0>c||0>d||0>c||d+c>this.size)throw a.g.F();for(var h=c;h<c+d;h++)this.f[h]=b};c.prototype.Mj=function(b,c,d,n,e){if(!n||b!=d)if(this.f.set(this.f.subarray(d,d+c),b),!n)for(d=b,b=b+c-e,n=0,c=a.J.truncate(c/2);n<c;n++){for(var h=0;h<e;h++){var p=this.f[d+h];this.f[d+h]=this.f[b+h];this.f[b+h]=p}d+=e;b-=e}};c.prototype.js=function(b,c,d,n,e){if(0>b||0>c||0>n)throw a.g.F();if(0!=c)for(this.size<(c<<1)+b&&this.resize((c<<1)+b),e||(b+=c-1<<1),e=
e?2:-2,c+=n;n<c;n++)this.f[b]=d[n].x,this.f[b+1]=d[n].y,b+=e};c.prototype.hy=function(b,c,d,n,e){if(0>b||0>c||0>n)throw a.g.F();if(0!=c)for(this.size<(c<<1)+b&&this.resize((c<<1)+b),e||(b+=c-1<<1),e=e?2:-2,c+=n;n<c;n++)this.f[b]=d[n][0],this.f[b+1]=d[n][1],b+=e};c.prototype.rl=function(b,c,d,n,e){if(0>b||0>c||0>n||this.size<c+b)throw a.g.F();if(e)for(e=0;e<c;e++)d[n+e]=this.f[b+e];else for(n=n+c-1;b<c;b++)d[n]=this.f[b],n--};c.prototype.Hx=function(b,c,d,n,e){if(0>b||0>c||0>n||this.size<(c>>1)+b)throw a.g.F();
if(0!=c)for(e||(b+=c-1),e=e?2:-2,c=n+c;n<c;n++)d[n][0]=this.f[b],d[n][1]=this.f[b+1],b+=e};c.prototype.clear=function(a){a?this.resize(0):this.uf(0)};c.prototype.Tp=function(){this.ze=this.xa=!0};c.prototype.Fd=function(a,b,c){Array.prototype.sort.call(this.f.subarray(a,b),c)};c.prototype.ti=function(){return 1};return c}();a.zL=c})(C||(C={}));!0===C.Yh.Gm&&!0===C.Yh.jw&&(C.Pd=C.zL);(function(a){function b(a,b,c,d){c=new Int32Array(a.subarray(c,d));a.set(c,b)}a.dZ=function(){return function(){this.random=
1973}}();var c=function(){function b(c){this.xa=this.ze=!1;this.f=[];var h=c;2>h&&(h=2);this.f=this.f=a.J.df(h,b.tb);this.size=c}b.prototype.rotate=function(b,c,d){if(this.xa)throw a.g.X("invalid_call");if(c<b||c>d||b>d)throw a.g.F();b!=c&&d!=c&&(this.Xd(b,c-b,1),this.Xd(c,d-c,1),this.Xd(b,d-b,1))};b.yd=function(a,c){b.tb=c;a=new b(a);b.tb=0;return a};b.Dk=function(a){var c=new b(0);c.f=a.f.slice(0);c.size=a.size;return c};b.N=function(a,c){var h=new b(0);h.size=a.size;h.size>c&&(h.size=c);h.f=a.f.slice(0,
h.size);return h};b.prototype.zb=function(){};b.prototype.read=function(a){return this.f[a]};b.prototype.fc=function(a,b){b.x=this.f[a];b.y=this.f[a+1]};b.prototype.get=function(a){return this.f[a]};b.prototype.write=function(b,c){if(this.xa)throw a.g.Da();this.f[b]=c};b.prototype.set=function(b,c){if(this.xa)throw a.g.Da();this.f[b]=c};b.prototype.mo=function(b,c){if(this.xa)throw a.g.Da();this.f[b]=c.x;this.f[b+1]=c.y};b.prototype.add=function(a){this.resize(this.size+1);this.f[this.size-1]=a};
b.prototype.Sr=function(a){return b.N(this,a)};b.prototype.Lf=function(a){return this.read(a)};b.prototype.resize=function(b,c){void 0===c&&(c=0);if(this.ze)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");if(b<=this.size){if(a.J.truncate(5*b/4)<this.f.length){var h=this.f.slice(0,b);this.f=h}}else if(b>this.f.length){a.J.truncate(64>b?Math.max(2*b,4):5*b/4);for(var h=this.f.slice(0),d=this.f.length;d<b;d++)h[d]=c;this.f=h}this.size=b};b.prototype.uf=function(b){(null==
this.f||b>this.f.length)&&this.resize(b);if(this.ze)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=b};b.prototype.Im=function(a,b){this.write(a,b)};b.prototype.Ck=function(b,c,d){for(var h=this.size;c<h&&c<d;c++)b=a.J.bh(this.read(c),b);return b};b.prototype.Eb=function(a,c,d){if(null==a||!(a instanceof b))return!1;var h=this.size,p=a.size;if(d>h||d>p&&h!=p)return!1;for(d>h&&(d=h);c<d;c++)if(this.read(c)!=a.read(c))return!1;return!0};b.prototype.Tk=function(b,
c,d,n,e,f,g){if(this.xa)throw a.g.Da();if(!e&&(1>f||0!=n%f))throw a.g.F();for(var h=0;h<g-b;h++)this.f[b+n+h]=this.f[b+h];this.f==c.f&&b<d&&(d+=n);if(e)for(h=0;h<n;h++)this.f[h+b]=c.f[d+h];else for(e=n,g=0;g<n;g+=f)for(e-=f,h=0;h<f;h++)this.f[b+g+h]=c.f[d+e+h]};b.prototype.Sq=function(b,c,d,n,e,f){if(this.xa)throw a.g.Da();0>f&&(f=this.size);this.size+2*n>this.f.length?this.resize(this.size+2*n):this.size+=2*n;f-=b;for(var h=this.f.slice(b,b+f),p=0;p<f;p++)this.f[b+2*n+p]=h[p];if(e)for(e=0;e<n;e++)f=
c[d++],this.f[b++]=f.x,this.f[b++]=f.y;else for(e=0,h=n-1;e<n;++e)f=c[d+h],this.f[b++]=f.x,this.f[b++]=f.y,h--};b.prototype.Zj=function(b,c,d,n){if(this.xa)throw a.g.Da();n-=b;for(var h=this.f.slice(b,b+n),p=0;p<n;p++)this.f[b+d+p]=h[p];for(n=0;n<d;n++)this.f[b+n]=c};b.prototype.dh=function(b,c,d){if(this.xa)throw a.g.Da();for(var h=this.f.slice(b,b+(d-b)),p=0;p<d-b;p++)this.f[p+b+2]=h[p];this.f[b]=c.x;this.f[b+1]=c.y};b.prototype.hs=function(b,c,d,n,e){if(0>b||0>c||0>n)throw a.g.F();if(d.length<
n+c)throw a.g.F();if(0!=c)if(this.size<c+b&&this.resize(c+b),e)for(e=0;e<c;e++)this.f[b+e]=d[n+e];else for(e||(b+=c-1),c=n+c;n<c;n++)this.f[b]=d[n],b--};b.prototype.no=function(b,c,d,n,e,f){if(0>b||0>c||0>n)throw a.g.F();if(!e&&(0>=f||0!=c%f))throw a.g.F();if(d.size<n+c)throw a.g.F();if(0!=c)if(this.size<c+b&&this.resize(c+b),d==this)this.Mj(b,c,n,e,f);else if(e)for(e=0;e<c;e++)this.f[b]=d.f[n],b++,n++;else if(n=n+c-f,1==f)for(e=0;e<c;e++)this.f[b]=d.f[n],b++,n--;else for(e=0,c=a.J.truncate(c/f);e<
c;e++){for(var h=0;h<f;h++)this.f[b+h]=d.f[n+h];b+=f;n-=f}};b.prototype.Hk=function(b,c,d){if(this.xa)throw a.g.Da();if(b+c>this.size)throw a.g.Da();if(0<d-(b+c)){d-=b+c;for(var h=this.f.slice(b+c,b+d+c),p=0;p<d;p++)this.f[b+p]=h[p]}this.size-=c};b.prototype.Xd=function(b,c,d){if(this.xa)throw a.g.Da();if(1>d||0!=c%d)throw a.g.Da();for(var h=c>>1,p=0;p<h;p+=d){c-=d;for(var y=0;y<d;y++){var n=this.f[b+p+y];this.f[b+p+y]=this.f[b+c+y];this.f[b+c+y]=n}}};b.prototype.$h=function(b,c,d){if(0>c||0>d||0>
c||d+c>this.size)throw a.g.F();for(var h=c;h<c+d;h++)this.f[h]=b};b.prototype.Mj=function(b,c,d,n,e){if(!n||b!=d){for(var h=0;h<c;h++)this.f[b+h]=this.f[d+h];if(!n)for(d=b,b=b+c-e,n=0,c=a.J.truncate(c/2);n<c;n++){for(h=0;h<e;h++){var p=this.f[d+h];this.f[d+h]=this.f[b+h];this.f[b+h]=p}d+=e;b-=e}}};b.prototype.js=function(b,c,d,n,e){if(0>b||0>c||0>n)throw a.g.F();if(0!=c)for(this.size<(c<<1)+b&&this.resize((c<<1)+b),e||(b+=c-1<<1),e=e?2:-2,c+=n;n<c;n++)this.f[b]=d[n].x,this.f[b+1]=d[n].y,b+=e};b.prototype.rl=
function(b,c,d,n,e){if(0>b||0>c||0>n||this.size<c+b)throw a.g.F();if(e)for(e=0;e<c;e++)d[n+e]=this.f[b+e];else for(n=n+c-1;b<c;b++)d[n]=this.f[b],n--};b.prototype.clear=function(a){a?this.resize(0):this.uf(0)};b.prototype.Tp=function(){this.ze=this.xa=!0};b.prototype.Fd=function(a,b,c){var h=this.f.slice(0,a),d=this.f.slice(b);a=this.f.slice(a,b).sort(c);this.f.length=0;this.f.push.apply(this.f,h.concat(a).concat(d))};b.prototype.ti=function(){return 2};b.prototype.Ec=function(){return this.f[this.size-
1]};b.prototype.Mf=function(){this.resize(this.size-1)};b.prototype.qK=function(a){this.f[this.size-1]=a};b.prototype.vJ=function(a){a<this.size-1&&(this.f[a]=this.f[this.size-1]);this.resize(this.size-1)};b.prototype.Pv=function(a){for(var b=0,c=this.size;b<c;b++)if(this.f[b]==a)return b;return-1};b.prototype.qA=function(a){return 0<=this.Pv(a)};b.tb=0;return b}();a.ha=c;c=function(){function c(a){this.xa=this.ze=!1;this.f=null;var b=a;2>b&&(b=2);this.f=new Int32Array(b);this.size=a}c.prototype.rotate=
function(b,c,d){if(this.xa)throw a.g.X("invalid_call");if(c<b||c>d||b>d)throw a.g.F();b!=c&&d!=c&&(this.Xd(b,c-b,1),this.Xd(c,d-c,1),this.Xd(b,d-b,1))};c.yd=function(a,b){var h=new c(a),d=h.f;2>a&&(a=2);if(0!==b)for(var p=0;p<a;p++)d[p]=b;return h};c.Dk=function(a){var b=new c(0);b.f=new Int32Array(a.f);b.size=a.size;return b};c.N=function(a,b){var h=new c(0);h.size=a.size;h.size>b&&(h.size=b);b=h.size;2>b&&(b=2);h.f=new Int32Array(b);h.f.set(a.f.length<=b?a.f:a.f.subarray(0,b),0);return h};c.prototype.zb=
function(a){0>=a||(null==this.f?this.f=new Int32Array(a):a<=this.f.length||(0<this.f.length?(a=new Int32Array(a),a.set(this.f),this.f=a):this.f=new Int32Array(a)))};c.prototype.read=function(a){return this.f[a]};c.prototype.fc=function(a,b){b.x=this.f[a];b.y=this.f[a+1]};c.prototype.get=function(a){return this.f[a]};c.prototype.write=function(b,c){if(this.xa)throw a.g.Da();this.f[b]=c};c.prototype.set=function(b,c){if(this.xa)throw a.g.Da();this.f[b]=c};c.prototype.mo=function(b,c){if(this.xa)throw a.g.Da();
this.f[b]=c.x;this.f[b+1]=c.y};c.prototype.add=function(a){this.resize(this.size+1);this.f[this.size-1]=a};c.prototype.Sr=function(a){return c.N(this,a)};c.prototype.Lf=function(a){return this.read(a)};c.prototype.resize=function(b,c){void 0===c&&(c=0);if(this.ze)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");if(b<=this.size){if(30<this.f.length&&5*b/4<this.f.length){var h=new Int32Array(this.f,0,b);this.f=h}}else{b>this.f.length&&(h=a.J.truncate(64>b?Math.max(2*b,
4):5*b/4),h=new Int32Array(h),h.set(this.f),this.f=h);for(var h=this.f,d=this.size;d<b;d++)h[d]=c}this.size=b};c.prototype.uf=function(b){(null==this.f||b>this.f.length)&&this.resize(b);if(this.ze)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=b};c.prototype.Im=function(a,b){this.write(a,b)};c.prototype.Ck=function(b,c,d){for(var h=this.size;c<h&&c<d;c++)b=a.J.bh(this.read(c),b);return b};c.prototype.Eb=function(a,b,d){if(null==a||!(a instanceof c))return!1;
var h=this.size,p=a.size;if(d>h||d>p&&h!=p)return!1;for(d>h&&(d=h);b<d;b++)if(this.read(b)!=a.read(b))return!1;return!0};c.prototype.Tk=function(c,d,y,n,e,f,g){if(this.xa)throw a.g.Da();if(!e&&(1>f||0!=n%f))throw a.g.F();b(this.f,c+n,c,c+(g-c));this.f==d.f&&c<y&&(y+=n);if(e)this.f.set(d.f.subarray(y,y+n),c);else for(e=n,g=0;g<n;g+=f){e-=f;for(var h=0;h<f;h++)this.f[c+g+h]=d.f[y+e+h]}};c.prototype.Sq=function(c,d,y,n,e,f){if(this.xa)throw a.g.Da();0>f&&(f=this.size);this.size+2*n>this.f.length?this.resize(this.size+
2*n):this.size+=2*n;b(this.f,c+2*n,c,c+(f-c));if(e)for(e=0;e<n;e++)f=d[y++],this.f[c++]=f.x,this.f[c++]=f.y;else{e=0;for(var h=n-1;e<n;++e)f=d[y+h],this.f[c++]=f.x,this.f[c++]=f.y,h--}};c.prototype.Zj=function(c,d,y,n){if(this.xa)throw a.g.Da();n-=c;b(this.f,c+n,c,c+n);for(n=0;n<y;n++)this.f[c+n]=d};c.prototype.dh=function(c,d,y){if(this.xa)throw a.g.Da();b(this.f,c+2,c,c+(y-c));this.f[c]=d.x;this.f[c+1]=d.y};c.prototype.hs=function(b,c,d,n,e){if(0>b||0>c||0>n)throw a.g.F();if(d.length<n+c)throw a.g.F();
if(0!=c)if(this.size<c+b&&this.resize(c+b),e)this.f.set(d.subarray(n,c),b);else for(e||(b+=c-1),c=n+c;n<c;n++)this.f[b]=d[n],b--};c.prototype.no=function(b,c,d,n,e,f){if(0>b||0>c||0>n)throw a.g.F();if(!e&&(0>=f||0!=c%f))throw a.g.F();if(d.size<n+c)throw a.g.F();if(0!=c)if(this.size<c+b&&this.resize(c+b),d==this)this.Mj(b,c,n,e,f);else if(e)for(e=0;e<c;e++)this.f[b]=d.f[n],b++,n++;else if(n=n+c-f,1==f)for(e=0;e<c;e++)this.f[b]=d.f[n],b++,n--;else for(e=0,c=a.J.truncate(c/f);e<c;e++){for(var h=0;h<
f;h++)this.f[b+h]=d.f[n+h];b+=f;n-=f}};c.prototype.Hk=function(c,d,y){if(this.xa)throw a.g.Da();if(c+d>this.size)throw a.g.Da();0<y-(c+d)&&b(this.f,c,c+d,c+(y-(c+d))+d);this.size-=d};c.prototype.Xd=function(b,c,d){if(this.xa)throw a.g.Da();if(1>d||0!=c%d)throw a.g.Da();for(var h=c>>1,p=0;p<h;p+=d){c-=d;for(var y=0;y<d;y++){var n=this.f[b+p+y];this.f[b+p+y]=this.f[b+c+y];this.f[b+c+y]=n}}};c.prototype.$h=function(b,c,d){if(0>c||0>d||0>c||d+c>this.size)throw a.g.F();for(var h=c;h<c+d;h++)this.f[h]=
b};c.prototype.Mj=function(b,c,d,n,e){if(!n||b!=d)if(this.f.set(this.f.subarray(d,d+c),b),!n)for(d=b,b=b+c-e,n=0,c=a.J.truncate(c/2);n<c;n++){for(var h=0;h<e;h++){var p=this.f[d+h];this.f[d+h]=this.f[b+h];this.f[b+h]=p}d+=e;b-=e}};c.prototype.js=function(b,c,d,n,e){if(0>b||0>c||0>n)throw a.g.F();if(0!=c)for(this.size<(c<<1)+b&&this.resize((c<<1)+b),e||(b+=c-1<<1),e=e?2:-2,c+=n;n<c;n++)this.f[b]=d[n].x,this.f[b+1]=d[n].y,b+=e};c.prototype.rl=function(b,c,d,n,e){if(0>b||0>c||0>n||this.size<c+b)throw a.g.F();
if(e)for(e=0;e<c;e++)d[n+e]=this.f[b+e];else for(n=n+c-1;b<c;b++)d[n]=this.f[b],n--};c.prototype.clear=function(a){a?this.resize(0):this.uf(0)};c.prototype.Tp=function(){this.ze=this.xa=!0};c.prototype.Fd=function(a,b,d){10>b-a?c.Gj(this.f,a,b,d):c.Yg(this.f,a,b-1,d)};c.prototype.ti=function(){return 2};c.prototype.Ec=function(){return this.f[this.size-1]};c.prototype.Mf=function(){this.resize(this.size-1)};c.prototype.qK=function(a){this.f[this.size-1]=a};c.prototype.vJ=function(a){a<this.size-1&&
(this.f[a]=this.f[this.size-1]);this.resize(this.size-1)};c.prototype.Pv=function(a){for(var b=0,c=this.size;b<c;b++)if(this.f[b]==a)return b;return-1};c.prototype.qA=function(a){return 0<=this.Pv(a)};c.Gj=function(a,b,c,d){for(var h=b;h<c;h++){for(var p=a[h],n=h-1;n>=b&&0<d(a[n],p);)a[n+1]=a[n],n--;a[n+1]=p}};c.Ug=function(a,b,c){var h=a[c];a[c]=a[b];a[b]=h};c.Yg=function(a,b,d,n){if(!(b>=d))for(;;){if(9>d-b){c.Gj(a,b,d+1,n);break}var h=a[b];c.Ug(a,b,d);for(var p=b,y=b;y<d;y++)0>=n(a[y],h)&&(c.Ug(a,
p,y),p+=1);c.Ug(a,p,d);p-b<d-p?(c.Yg(a,b,p-1,n),b=p+1):(c.Yg(a,p+1,d,n),d=p-1)}};return c}();a.iy=c})(C||(C={}));!0===C.Yh.Gm&&(C.ha=C.iy);(function(a){function b(a,b,c,d){c=new Int8Array(a.subarray(c,d));a.set(c,b)}var c=function(){function b(c){this.xa=this.ze=!1;this.f=[];var h=c;2>h&&(h=2);this.f=a.J.df(h,b.tb);this.size=c}b.prototype.rotate=function(b,c,d){if(this.xa)throw a.g.X("invalid_call");if(c<b||c>d||b>d)throw a.g.F();b!=c&&d!=c&&(this.Xd(b,c-b,1),this.Xd(c,d-c,1),this.Xd(b,d-b,1))};b.yd=
function(a,c){b.tb=c;a=new b(a);b.tb=0;return a};b.Dk=function(a){var c=new b(0);c.f=a.f.slice(0);c.size=a.size;return c};b.N=function(a,c){var h=new b(0);h.size=a.size;h.size>c&&(h.size=c);h.f=a.f.slice(0,h.size);return h};b.prototype.zb=function(){};b.prototype.read=function(a){return this.f[a]};b.prototype.fc=function(a,b){b.x=this.f[a];b.y=this.f[a+1]};b.prototype.get=function(a){return this.f[a]};b.prototype.write=function(b,c){if(this.xa)throw a.g.Da();this.f[b]=c};b.prototype.set=function(b,
c){if(this.xa)throw a.g.Da();this.f[b]=c};b.prototype.mo=function(b,c){if(this.xa)throw a.g.Da();this.f[b]=c.x;this.f[b+1]=c.y};b.prototype.add=function(a){this.resize(this.size+1);this.f[this.size-1]=a};b.prototype.Sr=function(a){return b.N(this,a)};b.prototype.Lf=function(a){return this.read(a)};b.prototype.resize=function(b,c){void 0===c&&(c=0);if(this.ze)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");if(b<=this.size){if(a.J.truncate(5*b/4)<this.f.length){var h=
this.f.slice(0,b);this.f=h}}else if(b>this.f.length){a.J.truncate(64>b?Math.max(2*b,4):5*b/4);for(var h=this.f.slice(0),d=this.f.length;d<b;d++)h[d]=c;this.f=h}this.size=b};b.prototype.uf=function(b){(null==this.f||b>this.f.length)&&this.resize(b);if(this.ze)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=b};b.prototype.Im=function(a,b){this.write(a,b)};b.prototype.Ck=function(b,c,d){for(var h=this.size;c<h&&c<d;c++)b=a.J.bh(this.read(c),b);return b};b.prototype.Eb=
function(a,c,d){if(null==a||!(a instanceof b))return!1;var h=this.size,p=a.size;if(d>h||d>p&&h!=p)return!1;for(d>h&&(d=h);c<d;c++)if(this.read(c)!=a.read(c))return!1;return!0};b.prototype.Tk=function(b,c,d,n,e,f,g){if(this.xa)throw a.g.Da();if(!e&&(1>f||0!=n%f))throw a.g.F();for(var h=0;h<g-b;h++)this.f[b+n+h]=this.f[b+h];this.f==c.f&&b<d&&(d+=n);if(e)for(h=0;h<n;h++)this.f[h+b]=c.f[d+h];else for(e=n,g=0;g<n;g+=f)for(e-=f,h=0;h<f;h++)this.f[b+g+h]=c.f[d+e+h]};b.prototype.Sq=function(b,c,d,n,e,f){if(this.xa)throw a.g.Da();
0>f&&(f=this.size);this.size+2*n>this.f.length?this.resize(this.size+2*n):this.size+=2*n;f-=b;for(var h=this.f.slice(b,b+f),p=0;p<f;p++)this.f[b+2*n+p]=h[p];if(e)for(e=0;e<n;e++)f=c[d++],this.f[b++]=f.x,this.f[b++]=f.y;else for(e=0,h=n-1;e<n;++e)f=c[d+h],this.f[b++]=f.x,this.f[b++]=f.y,h--};b.prototype.Zj=function(b,c,d,n){if(this.xa)throw a.g.Da();n-=b;for(var h=this.f.slice(b,b+n),p=0;p<n;p++)this.f[b+d+p]=h[p];for(n=0;n<d;n++)this.f[b+n]=c};b.prototype.dh=function(b,c,d){if(this.xa)throw a.g.Da();
for(var h=this.f.slice(b,b+(d-b)),p=0;p<d-b;p++)this.f[p+b+2]=h[p];this.f[b]=c.x;this.f[b+1]=c.y};b.prototype.hs=function(b,c,d,n,e){if(0>b||0>c||0>n)throw a.g.F();if(d.length<n+c)throw a.g.F();if(0!=c)if(this.size<c+b&&this.resize(c+b),e)for(e=0;e<c;e++)this.f[b+e]=d[n+e];else for(e||(b+=c-1),c=n+c;n<c;n++)this.f[b]=d[n],b--};b.prototype.no=function(b,c,d,n,e,f){if(0>b||0>c||0>n)throw a.g.F();if(!e&&(0>=f||0!=c%f))throw a.g.F();if(d.size<n+c)throw a.g.F();if(0!=c)if(this.size<c+b&&this.resize(c+
b),d==this)this.Mj(b,c,n,e,f);else if(e)for(e=0;e<c;e++)this.f[b]=d.f[n],b++,n++;else if(n=n+c-f,1==f)for(e=0;e<c;e++)this.f[b]=d.f[n],b++,n--;else for(e=0,c=a.J.truncate(c/f);e<c;e++){for(var h=0;h<f;h++)this.f[b+h]=d.f[n+h];b+=f;n-=f}};b.prototype.Hk=function(b,c,d){if(this.xa)throw a.g.Da();if(b+c>this.size)throw a.g.Da();if(0<d-(b+c)){d-=b+c;for(var h=this.f.slice(b+c,b+d+c),p=0;p<d;p++)this.f[b+p]=h[p]}this.size-=c};b.prototype.Xd=function(b,c,d){if(this.xa)throw a.g.Da();if(1>d||0!=c%d)throw a.g.Da();
for(var h=c>>1,p=0;p<h;p+=d){c-=d;for(var n=0;n<d;n++){var e=this.f[b+p+n];this.f[b+p+n]=this.f[b+c+n];this.f[b+c+n]=e}}};b.prototype.$h=function(b,c,d){if(0>c||0>d||0>c||d+c>this.size)throw a.g.F();for(var h=c;h<c+d;h++)this.f[h]=b};b.prototype.Mj=function(b,c,d,n,e){if(!n||b!=d){for(var h=0;h<c;h++)this.f[b+h]=this.f[d+h];if(!n)for(d=b,b=b+c-e,n=0,c=a.J.truncate(c/2);n<c;n++){for(h=0;h<e;h++){var p=this.f[d+h];this.f[d+h]=this.f[b+h];this.f[b+h]=p}d+=e;b-=e}}};b.prototype.js=function(b,c,d,n,e){if(0>
b||0>c||0>n)throw a.g.F();if(0!=c)for(this.size<(c<<1)+b&&this.resize((c<<1)+b),e||(b+=c-1<<1),e=e?2:-2,c+=n;n<c;n++)this.f[b]=d[n].x,this.f[b+1]=d[n].y,b+=e};b.prototype.rl=function(b,c,d,n,e){if(0>b||0>c||0>n||this.size<c+b)throw a.g.F();if(e)for(e=0;e<c;e++)d[n+e]=this.f[b+e];else for(n=n+c-1;b<c;b++)d[n]=this.f[b],n--};b.prototype.clear=function(a){a?this.resize(0):this.uf(0)};b.prototype.Tp=function(){this.ze=this.xa=!0};b.prototype.Fd=function(a,b,c){var h=this.f.slice(0,a),d=this.f.slice(b);
a=this.f.slice(a,b).sort(c);this.f.length=0;this.f.push.apply(this.f,h.concat(a).concat(d))};b.prototype.ti=function(){return 1};b.prototype.lC=function(b,c){if(this.xa)throw a.g.X("invalid call. Attribute Stream is read only.");this.f[b]|=c};b.prototype.dz=function(b,c){if(this.xa)throw a.g.X("invalid call. Attribute Stream is read only.");this.f[b]&=~c};b.tb=0;return b}();a.Km=c;c=function(){function c(a){this.f=null;var b=a;2>b&&(b=2);this.f=new Int8Array(b);this.size=a}c.prototype.rotate=function(b,
c,d){if(this.xa)throw a.g.X("invalid_call");if(c<b||c>d||b>d)throw a.g.F();b!=c&&d!=c&&(this.Xd(b,c-b,1),this.Xd(c,d-c,1),this.Xd(b,d-b,1))};c.yd=function(a,b){var h=new c(a),d=h.f;2>a&&(a=2);if(0!==b)for(var p=0;p<a;p++)d[p]=b;return h};c.Dk=function(a){var b=new c(0);b.f=new Int8Array(a.f);b.size=a.size;return b};c.N=function(a,b){var h=new c(0);h.size=a.size;h.size>b&&(h.size=b);b=h.size;2>b&&(b=2);h.f=new Int8Array(b);h.f.set(a.f.length<=b?a.f:a.f.subarray(0,b),0);return h};c.prototype.zb=function(a){0>=
a||(null==this.f?this.f=new Int8Array(a):a<=this.f.length||(0<this.f.length?(a=new Int8Array(a),a.set(this.f),this.f=a):this.f=new Int8Array(a)))};c.prototype.read=function(a){return this.f[a]};c.prototype.fc=function(a,b){b.x=this.f[a];b.y=this.f[a+1]};c.prototype.get=function(a){return this.f[a]};c.prototype.write=function(b,c){if(this.xa)throw a.g.Da();this.f[b]=c};c.prototype.set=function(b,c){if(this.xa)throw a.g.Da();this.f[b]=c};c.prototype.mo=function(b,c){if(this.xa)throw a.g.Da();this.f[b]=
c.x;this.f[b+1]=c.y};c.prototype.add=function(a){this.resize(this.size+1);this.f[this.size-1]=a};c.prototype.Sr=function(a){return c.N(this,a)};c.prototype.Lf=function(a){return this.read(a)};c.prototype.resize=function(b,c){void 0===c&&(c=0);if(this.ze)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");if(b<=this.size){if(30<this.f.length&&5*b/4<this.f.length){var h=new Int8Array(this.f,0,b);this.f=h}}else{b>this.f.length&&(h=a.J.truncate(64>b?Math.max(2*b,4):5*b/4),h=
new Int8Array(h),h.set(this.f),this.f=h);for(var h=this.f,d=this.size;d<b;d++)h[d]=c}this.size=b};c.prototype.uf=function(b){(null==this.f||b>this.f.length)&&this.resize(b);if(this.ze)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=b};c.prototype.Im=function(a,b){this.write(a,b)};c.prototype.Ck=function(b,c,d){for(var h=this.size;c<h&&c<d;c++)b=a.J.bh(this.read(c),b);return b};c.prototype.Eb=function(a,b,d){if(null==a||!(a instanceof c))return!1;var h=this.size,
p=a.size;if(d>h||d>p&&h!=p)return!1;for(d>h&&(d=h);b<d;b++)if(this.read(b)!=a.read(b))return!1;return!0};c.prototype.Tk=function(c,d,n,e,f,g,w){if(this.xa)throw a.g.Da();if(!f&&(1>g||0!=e%g))throw a.g.F();b(this.f,c+e,c,c+(w-c));this.f==d.f&&c<n&&(n+=e);if(f)this.f.set(d.f.subarray(n,n+e),c);else for(f=e,w=0;w<e;w+=g){f-=g;for(var h=0;h<g;h++)this.f[c+w+h]=d.f[n+f+h]}};c.prototype.Zj=function(c,d,n,e){if(this.xa)throw a.g.Da();e-=c;b(this.f,c+e,c,c+e);for(e=0;e<n;e++)this.f[c+e]=d};c.prototype.Sq=
function(c,d,n,e,f,g){if(this.xa)throw a.g.Da();0>g&&(g=this.size);this.size+2*e>this.f.length?this.resize(this.size+2*e):this.size+=2*e;b(this.f,c+2*e,c,c+(g-c));if(f)for(f=0;f<e;f++)g=d[n++],this.f[c++]=g.x,this.f[c++]=g.y;else{f=0;for(var h=e-1;f<e;++f)g=d[n+h],this.f[c++]=g.x,this.f[c++]=g.y,h--}};c.prototype.dh=function(c,d,e){if(this.xa)throw a.g.Da();b(this.f,c+2,c,c+(e-c));this.f[c]=d.x;this.f[c+1]=d.y};c.prototype.hs=function(b,c,d,e,n){if(0>b||0>c||0>e)throw a.g.F();if(d.length<e+c)throw a.g.F();
if(0!=c)if(this.size<c+b&&this.resize(c+b),n)this.f.set(d.subarray(e,c),b);else for(n||(b+=c-1),c=e+c;e<c;e++)this.f[b]=d[e],b--};c.prototype.no=function(b,c,d,e,n,f){if(0>b||0>c||0>e)throw a.g.F();if(!n&&(0>=f||0!=c%f))throw a.g.F();if(d.size<e+c)throw a.g.F();if(0!=c)if(this.size<c+b&&this.resize(c+b),d==this)this.Mj(b,c,e,n,f);else if(n)for(n=0;n<c;n++)this.f[b]=d.f[e],b++,e++;else if(e=e+c-f,1==f)for(n=0;n<c;n++)this.f[b]=d.f[e],b++,e--;else for(n=0,c=a.J.truncate(c/f);n<c;n++){for(var h=0;h<
f;h++)this.f[b+h]=d.f[e+h];b+=f;e-=f}};c.prototype.Hk=function(c,d,e){if(this.xa)throw a.g.Da();if(c+d>this.size)throw a.g.Da();0<e-(c+d)&&b(this.f,c,c+d,c+(e-(c+d))+d);this.size-=d};c.prototype.Xd=function(b,c,d){if(this.xa)throw a.g.Da();if(1>d||0!=c%d)throw a.g.Da();for(var h=c>>1,p=0;p<h;p+=d){c-=d;for(var e=0;e<d;e++){var n=this.f[b+p+e];this.f[b+p+e]=this.f[b+c+e];this.f[b+c+e]=n}}};c.prototype.$h=function(b,c,d){if(0>c||0>d||0>c||d+c>this.size)throw a.g.F();for(var h=c;h<c+d;h++)this.f[h]=
b};c.prototype.Mj=function(b,c,d,e,n){if(!e||b!=d)if(this.f.set(this.f.subarray(d,d+c),b),!e)for(d=b,b=b+c-n,e=0,c=a.J.truncate(c/2);e<c;e++){for(var h=0;h<n;h++){var p=this.f[d+h];this.f[d+h]=this.f[b+h];this.f[b+h]=p}d+=n;b-=n}};c.prototype.js=function(b,c,d,e,n){if(0>b||0>c||0>e)throw a.g.F();if(0!=c)for(this.size<(c<<1)+b&&this.resize((c<<1)+b),n||(b+=c-1<<1),n=n?2:-2,c+=e;e<c;e++)this.f[b]=d[e].x,this.f[b+1]=d[e].y,b+=n};c.prototype.rl=function(b,c,d,e,n){if(0>b||0>c||0>e||this.size<c+b)throw a.g.F();
if(n)for(n=0;n<c;n++)d[e+n]=this.f[b+n];else for(e=e+c-1;b<c;b++)d[e]=this.f[b],e--};c.prototype.clear=function(a){a?this.resize(0):this.uf(0)};c.prototype.Tp=function(){this.ze=this.xa=!0};c.prototype.Fd=function(a,b,c){b=this.f.subarray(a,b);Array.prototype.sort.call(b,c);this.f.set(b,a)};c.prototype.lC=function(b,c){if(this.xa)throw a.g.X("invalid call. Attribute Stream is read only.");this.f[b]|=c};c.prototype.dz=function(b,c){if(this.xa)throw a.g.X("invalid call. Attribute Stream is read only.");
this.f[b]&=~c};c.prototype.ti=function(){return 1};return c}();a.jy=c})(C||(C={}));!0===C.Yh.Gm&&(C.Km=C.jy);(function(a){var b=function(){function b(){}b.vq=function(b,c){return a.Km.yd(b,c)};b.$m=function(b,c){return a.Pd.yd(b,c)};b.nz=function(b,c,d){switch(b){case 1:b=a.Pd.yd(c,d);break;case 2:b=a.ha.yd(c,d);break;case 4:b=a.Km.yd(c,d);break;default:throw a.g.za();}return b};b.oz=function(c,d){return b.nz(a.ma.ti(c),d*a.ma.Xa(c),a.ma.be(c))};b.wh=function(b,c){return a.ha.yd(b,c)};b.LB=function(a){var b,
c=[];for(b=0;b<a;b++)c.push(null);return c};return b}();a.Tc=b})(C||(C={}));(function(a){var b=function(){function b(){}b.vq=function(b,c){return a.jy.yd(b,c)};b.$m=function(b,c){return a.Pd.yd(b,c)};b.nz=function(b,c,d){switch(b){case 1:b=a.Pd.yd(c,d);break;case 2:b=a.iy.yd(c,d);break;case 4:b=a.jy.yd(c,d);break;default:throw a.g.za();}return b};b.oz=function(b,c){return a.Tc.nz(a.ma.ti(b),c*a.ma.Xa(b),a.ma.be(b))};b.wh=function(b,c){return a.iy.yd(b,c)};b.LB=function(a){var b,c=[];for(b=0;b<a;b++)c.push(null);
return c};return b}();a.AL=b})(C||(C={}));!0===C.Yh.Gm&&(C.Tc=C.AL);(function(a){a.da=function(){return function(a){void 0===a&&(a=0);this.j=a}}()})(C||(C={}));(function(a){var b=function(){function b(){}b.bind=function(c){a.Uc=c.PeDefs;a.Qf=c.PeFactory;a.WD=c.PeVertcs;a.TD=c.PeCoordsys;a.fi=c.PeCSTransformations;a.VD=c.PeGTTransformations;a.bN=c.PeGeogtran;a.aN=c.PeFactoryCodechange;a.UD=c.PeGCSExtent;a.Ag=c.PePCSInfo;a.cN=c.PeHorizon;a.TD=c.PeCoordsys;a.fq=c.PeGTlistExtended;a.fq.PE_GTLIST_OPTS_USE_DEFAULT=
128;a.Qf.initialize(null);a.sy=c.PeGTlistExtendedEntry;b.JN=a.Qf.fromString(a.Uc.PE_TYPE_UNIT,'UNIT["Meter",1.0]')};b.D_=function(){};b.JN=null;return b}();a.dN=b;a.Qf=null;a.WD=null;a.TD=null;a.cN=null;a.Ag=null;a.fq=null;a.sy=null;a.UD=null;a.aN=null;a.bN=null;a.Uc=null;a.VD=null;a.fi=null})(C||(C={}));(function(a){var b=function(){function a(){}a.Bb=function(b,c){return 0<=c?a.K(b):-a.K(b)};a.K=function(a){return 0>a?-a:a};a.Ri=function(a){return 3.552713678800501E-15>a};a.SD=function(b,c,d){return a.K(b-
c)<=d*(1+(a.K(b)+a.K(c))/2)};a.W=function(b,c){return a.SD(b,c,3.552713678800501E-15)};a.wO=function(b){return 3.552713678800501E-15>=a.K(b)};a.wd=function(b){return a.wO(b)};return a}();a.l=b;var c=function(){function c(){}c.Zp=function(a,c){a=b.K(a);c=b.K(c);var d=0;0!=a+c&&(a>c?(d=c/a,d=a*Math.sqrt(1+d*d)):(d=a/c,d=c*Math.sqrt(1+d*d)));return d};c.Nr=function(a,d,e,n,f){for(var h=[0,0,0],p=[0,0,0],y=0;2>=y;y++)d[y]-=a[y],e[y]-=d[y];e=h[1]*p[2]-h[2]*p[1];d=h[2]*p[0]-h[0]*p[2];h=h[0]*p[1]-h[1]*p[0];
a=-1*(e*a[0]+d*a[1]+h*a[2]);n[0]=e;n[1]=d;n[2]=h;n[3]=a;p=c.lo(n);n[0]/=p;n[1]/=p;n[2]/=p;n[3]/=p;0!=f&&(p=b.wd(h)?b.wd(a)?b.Bb(1,d):-b.Bb(1,a):b.Bb(1,h),p*=b.Bb(1,f),n[0]*=p,n[1]*=p,n[2]*=p,n[3]*=p)};c.fy=function(a,b,c){c[0]=a[1]*b[2]-b[1]*a[2];c[1]=a[2]*b[0]-b[2]*a[0];c[2]=a[0]*b[1]-b[0]*a[1]};c.Gu=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};c.lo=function(a){return c.Zp(c.Zp(a[0],a[1]),a[2])};c.Fk=function(a,b,d,e,n,f,g,w){a=c.n(a,b,d);var h=Math.cos(d);f.j=(a+n)*h*Math.cos(e);g.j=(a+n)*
h*Math.sin(e);w.j=(a*(1-b)+n)*Math.sin(d)};c.GP=function(a,d,e,n,f,g,w){var h=c.Zp(d,e),p=1*Math.sqrt(1-a),y=p/1;if(b.W(h,0))g.j=0,f.j=b.Bb(1.570796326794897,n),w.j=b.K(n)-p;else{g.j=Math.atan2(e,d);e=Math.atan2(1*n,p*h);g=Math.cos(e);var D=Math.sin(e);d=p*a/(1-a);a*=1;e=Math.atan2(n+d*D*D*D,h-a*g*g*g);3.141592653589793<b.K(e)&&(e=b.Bb(3.141592653589793,e)-e);e=Math.atan(y*Math.tan(e));D=Math.sin(e);g=Math.cos(e);f.j=Math.atan2(n+d*D*D*D,h-a*g*g*g);1.570796326794897<b.K(f.j)&&(f.j=b.Bb(3.141592653589793,
f.j)-f.j);e=Math.atan(y*Math.tan(f.j));D=Math.sin(e);g=Math.cos(e);w.j=(n-p*D)*Math.sin(f.j)+(h-1*g)*Math.cos(f.j)}};c.n=function(a,b,c){c=Math.sin(c);return a/Math.sqrt(1-b*c*c)};c.fu=function(a,b){return Math.atan2(Math.sin(b)*(1-a),Math.cos(b))};c.mk=function(a,b){return Math.atan2(Math.sin(b),Math.cos(b)*(1-a))};c.Ep=function(a,d){if(b.Ri(a)||0==d||b.W(b.K(d),1.570796326794897))return d;var h,p,e,n,f,g,w,k,l;if(.006884661117170036>a){n=Math.sqrt(1-a);f=(1-n)/(1+n);g=f*f;w=f*g;k=f*w;h=f*k;l=f*
h;p=f*l;e=1.572916666666667*w-3.2578125*h+4.295068359375*p;n=2.142578125*k-6.071484375*l;a=3.129296875*h-11.249837239583334*p;var m=4.775276692708333*l,I=7.958636765252976*p,q=Math.cos(2*d);return d+Math.sin(2*d)*(1.5*f-.84375*w+.525390625*h-.2688395182291667*p-e+a-I+q*(2*(1.3125*g-1.71875*k+1.650146484375*l)-4*n+6*m+q*(4*e-12*a+24*I+q*(8*n-32*m+q*(16*a-80*I+q*(32*m+64*q*I))))))}n=1-a;f=a/2;g=b.K(d);w=g*c.Ru(a)/(1.570796326794897*n);k=9999;l=g;for(g=0;1E-16<k&&50>g;g++)p=c.Hm(a,l),h=(c.xE(l,a)-f*
Math.sin(2*l)/p)/n-w,p=1/(p*p*p),e=h/p,h=l-e,k=b.K(e),l=h;return 0<=d?l:-l};c.UW=function(a,d){return b.Ri(d)?a:a*c.Ru(d)/1.570796326794897};c.ca=function(a){a=c.sE(a,6.283185307179586);return 0>a?a+6.283185307179586:3.141592653589793>b.K(a)||b.W(b.K(a),3.141592653589793)?a:a-6.283185307179586};c.sE=function(a,b){return a-Math.floor(a/b)*b};c.Wg=function(a,b){if(.006884661117170036>b){b=Math.sqrt(1-b);b=(1-b)/(1+b);var d=b*b,h=d*d;return a/(1+b)*(1+.25*d+.015625*h+.00390625*d*h)*1.570796326794897}return a*
c.Ru(b)};c.Mr=function(a,d){var h=b.Bb(1,Math.sin(d));d=b.K(c.sE(d,3.141592653589793));d=1.570796326794897>=d?d:3.141592653589793-d;var p;b.W(d,1.570796326794897)?p=d:p=Math.atan(Math.sqrt(1-a)*Math.tan(d));return p*h};c.q=function(a,b,d){if(.006884661117170036>b){b=Math.sqrt(1-b);b=(1-b)/(1+b);var h=b*b,p=b*h,e=b*p,n=b*e,f=b*n,y=b*f,g=-.7291666666666666*p+.2278645833333333*n+.03987630208333334*y,w=.615234375*e-.21533203125*f,k=-.54140625*n+.20302734375*y,l=.48876953125*f,m=-.4488699776785715*y,I=
Math.cos(2*d);return a/(1+b)*((1+.25*h+.015625*e+.00390625*f)*d+Math.sin(2*d)*(-1.5*b+.1875*p+.0234375*n+.00732421875*y-g+k-m+I*(2*(.9375*h-.234375*e-.03662109375*f)-4*w+6*l+I*(4*g-12*k+24*m+I*(8*w-32*l+I*(16*k-80*m+I*(32*l+64*I*m)))))))}return a*(c.xE(d,b)-.5*b*Math.sin(2*d)/c.Hm(b,d))};c.Hm=function(a,b){b=Math.sin(b);return Math.sqrt(1-a*b*b)};c.Ru=function(a){return b.SD(a,1,2.220446049250313E-16)?1:1>a?c.mv(0,1-a)-a/3*c.Hu(0,1-a):NaN};c.xE=function(d,p){var h=b.Bb(1,d);d=b.K(d);var e=Math.floor(d/
1.570796326794897),n;if(1<p)n=0==d?0:NaN;else if(b.wd(e))n=c.sin(d),n=n*c.mv(1-n*n,1-p*n*n)-p/3*n*n*n*c.Hu(1-n*n,1-p*n*n);else{n=a.J.truncate(e%2);var f=c.Ru(p);0<n?(n=Math.sin(1.570796326794897*(e+1)-d),n=n*c.mv(1-n*n,1-p*n*n)-p/3*n*n*n*c.Hu(1-n*n,1-p*n*n),n=f*(e+1)-n):(n=Math.sin(d-1.570796326794897*e),n=n*c.mv(1-n*n,1-p*n*n)-p/3*n*n*n*c.Hu(1-n*n,1-p*n*n),n=f*e+n)}return n*h};c.sin=function(a){a=c.ca(a);var d=b.Bb(1,a);a=b.K(a);return b.W(a,3.141592653589793)?0:b.W(a,1.570796326794897)?1*d:Math.sin(a)*
d};c.Hu=function(a,c){for(var d=1,h=0,p=1,e,n,f,g;;){e=.2*(a+c+3*d);n=(e-a)/e;f=(e-c)/e;g=(e-d)/e;if(1E-4>b.K(n)&&1E-4>b.K(f)&&1E-4>b.K(g))break;g=Math.sqrt(c);e=Math.sqrt(d);g=Math.sqrt(a)*(g+e)+g*e;h+=p/(e*(d+g));p*=.25;a=.25*(a+g);c=.25*(c+g);d=.25*(d+g)}a=n*f;d=g*g;c=a-d;d=a-6*d;n=d+c+c;return 3*h+p*(1+d*(-.2142857142857143+.10227272727272728*d-.1730769230769231*g*n)+g*(.1666666666666667*n+g*(-.4090909090909091*c+.1153846153846154*g*a)))/(e*Math.sqrt(e))};c.mv=function(a,c){for(var d,h,p,e,n=
1;;n=.25*(n+d)){d=(a+c+n)/3;h=2-(d+a)/d;p=2-(d+c)/d;e=2-(d+n)/d;if(1E-4>b.K(h)&&1E-4>b.K(p)&&1E-4>b.K(e))break;d=Math.sqrt(c);h=Math.sqrt(n);d=Math.sqrt(a)*(d+h)+d*h;a=.25*(a+d);c=.25*(c+d)}a=h*p-e*e;c=h*p*e;return(1+(.04166666666666666*a-.1-.06818181818181818*c)*a+.07142857142857142*c)/Math.sqrt(d)};c.Cx=function(a,c){if(b.Ri(a)||0==c||b.W(b.K(c),1.570796326794897))return c;var d,h,p;if(.006884661117170036>a){d=a*a;h=a*d;p=a*h;var e=a*p,n=a*e,f=a*n,g=-(.02708333333333333*h+.03430059523809524*p+.03149181547619048*
e+.02634359154541446*n+.02156896735835538*f),w=.007669890873015873*p+.01299603174603175*e+.0148051353064374*n+.01454454953803912*f,k=-(.002275545634920635*e+.004830845032667949*n+.006558395368616723*f),l=6.957236677288761E-4*n+.001775193002406544*f,m=-(2.17324089394402E-4*f),I=Math.cos(2*c);return c+Math.sin(2*c)*(-(.5*a+.2083333333333333*d+.09375*h+.04878472222222222*p+.02916666666666667*e+.01938905423280423*n+.01388255931712963*f)-g+k-m+I*(2*(.1041666666666667*d+.0875*h+.06050347222222222*p+.04151785714285714*
e+.02958958540013228*n+.02203667534722222*f)-4*w+6*l+I*(4*g-12*k+24*m+I*(8*w-32*l+I*(16*k-80*m+I*(32*l+64*I*m))))))}0==c||b.W(b.K(c),1.570796326794897)?d=c:(h=Math.sqrt(a),p=h*Math.sin(c),d=Math.tan(.7853981633974483+c/2)*Math.pow((1-p)/(1+p),h/2),d=2*Math.atan(d)-1.570796326794897);return d};c.YP=function(a,c){if(b.Ri(a)||0==c||b.W(b.K(c),1.570796326794897))return c;var d,h;if(.006884661117170036>a){I=a*a;k=a*I;l=a*k;d=a*l;m=a*d;h=a*m;var p=.05833333333333333*k+.07232142857142858*l+.05634300595238095*
d+.0355325796406526*m+.020235546186067*h,e=.02653149801587302*l+.04379960317460317*d+.0429211791776896*m+.03255384637546096*h,n=.01294022817460318*d+.02668104344536636*m+.03155651254609588*h,f=.00659454790965208*m+.0163075268674227*h,g=.003463473736911237*h,w=Math.cos(2*c);return c+Math.sin(2*c)*(.5*a+.2083333333333333*I+.08333333333333333*k+.03611111111111111*l+.01875*d+.01195601851851852*m+.008863673941798942*h-p+n-g+w*(2*(.1458333333333333*I+.1208333333333333*k+.07039930555555556*l+.03616071428571429*
d+.01839451058201058*m+.01017113095238095*h)-4*e+6*f+w*(4*p-12*n+24*g+w*(8*e-32*f+w*(16*n-80*g+w*(32*f+64*w*g))))))}for(var k=Math.sqrt(a),l=k/2,m=Math.tan(.7853981633974483+c/2),p=0,e=1,I=c;0!=e;I=h)if(d=k*Math.sin(I),h=m*Math.pow((1+d)/(1-d),l),h=2*Math.atan(h)-1.570796326794897,p++,b.W(h,I)||3E4<p)e=0;return I};return c}();a.C=c})(C||(C={}));(function(a){var b=function(){function b(b){this.dm=this.Rt=null;this.vw=!1;this.pB=this.qB=0;this.nB=new a.b;this.AB=new a.b;this.ix=!1;this.kr=new a.h;this.vI=
this.fx=0;this.gx=null;this.cl=!1;this.yp=null;this.NA=0;this.rf=b;this.yt=a.Ib.iw(this.rf,0,!0);this.nB.Yc();this.AB.Yc();this.TI=NaN;var c=b.getCode();0<c?(this.nl=c,a.Qf.getCode(b)):this.nl=a.Qf.getCode(b);0>this.nl&&(this.nl=0);var d=this.rf.getType();this.iI=d==a.Uc.PE_TYPE_PROJCS?2:1;if(d==a.Uc.PE_TYPE_PROJCS&&!b.loadConstants())throw a.g.F("PeProjcs.loadConstants failed");c=d==a.Uc.PE_TYPE_GEOGCS?this.rf:this.rf.getGeogcs();d!=a.Uc.PE_TYPE_GEOGCS&&a.Qf.getCode(c);this.yp=b.getUnit();this.TI=
c.getPrimem().getLongitude();this.vI=b=c.getUnit().getUnitFactor();b=Math.PI/(180*b);1E-10>Math.abs(b-1)&&(b=1);this.pB=b;0!=(d&a.Uc.PE_TYPE_PROJCS)?(c=this.rf,this.qB=1/c.getUnit().getUnitFactor(),this.fx=.001/this.rf.getUnit().getUnitFactor(),this.gx=a.Ag.generate(c,a.Ag.PE_PCSINFO_OPTION_NONE),this.cl=this.gx.isPannableRectangle(),this.NA=a.Ib.OO(this.gx.getCentralMeridian(),this.pB)):(this.ix=this.cl=!0,this.qB=0,d=1/c.getUnit().getUnitFactor(),this.fx=.001/c.getDatum().getSpheroid().getAxis()*
d,this.NA=0);this.cl&&(this.dy(),this.hL(),this.iL(),this.gL(),this.NY(),this.OY())}b.prototype.Ys=function(){return this.nl};b.prototype.Wj=function(){return this.gx};b.zz=function(a,b){return a==b?!0:null!=a&&null!=b&&0==a.nl&&0==b.nl?a.yt===b.yt:!1};b.prototype.Ic=function(){return this.cl};b.prototype.Ch=function(a){a.I(this.mp)};b.prototype.bw=function(){return this.mp.o};b.prototype.aw=function(){return this.mp.v};b.prototype.$S=function(a){a.I(this.hx)};b.prototype.NY=function(){var b=this.rf.getType();
if(b==a.Uc.PE_TYPE_PROJCS){var b=this.rf,c=this.Wj().getCentralMeridian(),d=b.getGeogcs();if(null==d)throw a.g.X("internal error");d=1/d.getUnit().getUnitFactor()*Math.PI;c=[[c+d,0]];a.fi.geogToProj(b,1,c);var c=c[0][0],d=b.getParameters()[a.Uc.PE_PARM_X0].getValue(),e=this.Ok(),b=new a.h;e.s(b);var e=Math.abs(c-d),c=e+d,d=-1*e+d,e=b.B,b=b.A,f=new a.h;f.I(d,b,c,e);null==this.mp&&(this.mp=f)}else if(b==a.Uc.PE_TYPE_GEOGCS)d=1/this.rf.getUnit().getUnitFactor()*Math.PI,b=new a.h,b.I(-d,-d/2,d,d/2),null==
this.mp&&(this.mp=b);else throw a.g.X("internal error");};b.prototype.OY=function(){var b=this.rf.getType();if(b==a.Uc.PE_TYPE_PROJCS){var c=this.rf,b=this.Wj().getCentralMeridian(),c=c.getGeogcs();if(null==c)throw a.g.X("internal error");var c=1/c.getUnit().getUnitFactor()*Math.PI,d=this.Ts(),e=new a.h;d.s(e);d=new a.h;d.I(b-c,e.A,b+c,e.B);null==this.hx&&(this.hx=d)}else if(b==a.Uc.PE_TYPE_GEOGCS)c=1/this.rf.getUnit().getUnitFactor()*Math.PI,b=new a.h,b.I(-c,-c/2,c,c/2),null==this.hx&&(this.hx=b);
else throw a.g.X("internal error");};b.prototype.ce=function(){return this.pB};b.prototype.hn=function(){return this.qB};b.prototype.Ts=function(){if(this.cl)return this.dm;var a=this.dm;if(null!=a)return a;this.dy();return this.dm};b.prototype.Us=function(){if(this.cl)return null;if(null!=this.dm)return this.VH;this.dy();return this.VH};b.prototype.dy=function(){if(this.rf.getType()==a.Uc.PE_TYPE_PROJCS){var b;b=this.rf;var c=b.getGeogcs(),d=b.horizonGcsGenerate();if(null!=d){var e=d[0].getNump(),
f=d[0].getKind();b=0<d[0].getInclusive();var g=this.ce(),w=90*g,N=360*g,U=370*g,k=180*g*a.Uc.PE_HORIZON_DELTA/Math.PI,l=new a.h,m=null;if(1<e)for(var I=1;I<e;I++)if(d[I].getKind()==a.Uc.PE_HORIZON_LINE){null==m&&(m=new a.Ua);var q=d[I].getCoord();m.$x(q[0][0],q[0][1]);m.ak(q[1][0],q[1][1])}if(f==a.Uc.PE_HORIZON_RECT)d=d[0].getCoord(),l.I(d[0][0],d[0][1]),l.Nb(d[1][0],d[1][1]),Math.abs(l.B-w)<1E-7*k&&(l.B=w),Math.abs(l.A+w)<1E-7*k&&(l.A=-w),l.O()>U&&(d=-400*g,l.I(d,l.A,d+5*N,l.B)),d=new a.di(l),null==
this.dm&&(this.dm=d,this.vw=b);else{U=new a.Ja;N=this.Wj().isGcsHorizonMultiOverlap();l=a.Su.hG(c,a.Tu.Integer64);if(N){U=new a.wM;k=a.ei.local().V(U,l,null);for(I=0;I<e;I++)if(d[I].getKind()==a.Uc.PE_HORIZON_POLY){c=d[I].getSize();g=d[I].getCoord();f=[];for(w=0;w<c;w++)f[w]=a.b.pa(g[w][0],g[w][1]);d[I].getInclusive();N&&(g=new a.Ja,g.Gl(f,c-1),U.wY(g),k.Oe())}U=k.next()}else for(I=0;I<e;I++)if(d[I].getKind()==a.Uc.PE_HORIZON_POLY){c=d[I].getSize();g=d[I].getCoord();N=[];for(w=0;w<c;w++)N[w]=a.b.pa(g[w][0],
g[w][1]);d[I].getInclusive();U.Gl(N,c-1)}b?a.wk.local().xo(U,l,1):a.eq.local().xo(U,l,1);a.Jj.local().xo(U,l,1);null==this.dm&&(this.dm=U,this.vw=b,this.VH=m)}}}};b.prototype.Uv=function(){if(this.cl)return this.vw;null==this.dm&&this.dy();return this.vw};b.prototype.hL=function(){if(2==this.iI){var b=this.rf.horizonPcsGenerate();if(null!=b){var c=b[0].getKind();b[0].getInclusive();var d=b[0].getNump(),e=!1;if(c==a.Uc.PE_HORIZON_RECT)b=b[0].getCoord(),d=new a.h,d.I(b[0][0],b[0][1]),d.Nb(b[1][0],b[1][1]),
b=new a.di(d);else{c=-1;for(e=0;e<d;e++)b[e].getKind()==a.Uc.PE_HORIZON_POLY&&(c=e);e=b[c].getSize()-1;b=b[c].getCoord();d=[];for(c=0;c<e;c++)d[c]=a.b.pa(b[c][0],b[c][1]);b=c=new a.Ja;c.Gl(d,e);e=!0}this.Wj().isDensificationNeeded()&&(d=1E5*this.hn(),b=a.Pm.local().V(b,d,null));e&&(e=new a.di,b.Wn(e),b.ef(),b.Rb(),b.HS(),a.wk.local().xo(b,null,1));null==this.Rt&&(this.Rt=b)}}};b.prototype.Ok=function(){if(this.cl)return this.Rt;var a=this.Rt;if(null!=a)return a;this.hL();return this.Rt};b.prototype.iL=
function(){if(this.rf.getType()==a.Uc.PE_TYPE_PROJCS){var b=90*this.ce(),b=[[0,b],[0,-b]];a.fi.geogToProj(this.rf,2,b);var c=this.Wj(),d=c.getNorthPoleLocation()!=a.Ag.PE_POLE_OUTSIDE_BOUNDARY,c=c.getSouthPoleLocation()!=a.Ag.PE_POLE_OUTSIDE_BOUNDARY;this.ix||(d&&this.nB.ja(b[0][0],b[0][1]),c&&this.AB.ja(b[1][0],b[1][1]))}this.ix=!0};b.prototype.gA=function(a,b){this.cl||this.ix||this.iL();a?b.L(this.AB):b.L(this.nB)};b.prototype.gL=function(){if(1==this.iI){var b=400*this.ce();this.kr.I(-b,-b,b,
b)}else b=a.Ag.generate(this.rf,a.Ag.PE_PCSINFO_OPTION_DOMAIN),b=a.h.pa(b.getDomainMinx(),b.getDomainMiny(),b.getDomainMaxx(),b.getDomainMaxy()),this.kr.u()&&this.kr.I(b)};b.prototype.zS=function(a){this.cl&&a.I(this.kr);this.kr.u()&&this.gL();a.I(this.kr)};b.prototype.kn=function(){return this.TI};b.prototype.ri=function(){return this.NA};b.prototype.Td=function(){return this.yp};b.prototype.Vs=function(){return this.vI};return b}();a.ZD=b})(C||(C={}));(function(a){var b=function(){function b(b){this.lV=
b;this.yt=a.Ib.iw(b,0,!0);var c=b.getCode();this.pt=0<c?c:a.Qf.getCode(b);0>this.pt&&(this.pt=0);this.yp=c=this.lV.getUnit();this.JI=1/c.getUnitFactor();a.Qf.getCode(b)}b.zz=function(a,b){return a==b?!0:null!=a&&null!=b&&0==a.pt&&0==b.pt?a.yt===b.yt:!1};b.prototype.Ys=function(){return this.pt};return b}();a.hN=b})(C||(C={}));(function(a){var b=function(){function b(){}b.Cb=function(b,c,d,e,f,g,w,N){if(null!=g||null!=w||null!=N){e=a.C.ca(e);c=a.C.ca(c);d=a.C.ca(d);f=a.C.ca(f);1.570796326794897<a.l.K(d)&&
(d=a.l.Bb(3.141592653589793,d)-d,c=a.C.ca(c+3.141592653589793));1.570796326794897<a.l.K(f)&&(f=a.l.Bb(3.141592653589793,f)-f,e=a.C.ca(e+3.141592653589793));var h=a.C.ca(e-c);if(a.l.W(d,f)&&(a.l.W(c,e)||a.l.W(a.l.K(d),1.570796326794897)))null!=g&&(g.j=0),null!=w&&(w.j=0),null!=N&&(N.j=0);else{if(a.l.W(d,-f)){if(a.l.W(a.l.K(d),1.570796326794897)){null!=g&&(g.j=3.141592653589793*b);null!=w&&(w.j=0<d?a.C.ca(3.141592653589793-a.C.ca(e)):a.C.ca(e));null!=N&&(N.j=0<d?a.C.ca(e):a.C.ca(3.141592653589793-a.C.ca(e)));
return}if(a.l.W(a.l.K(h),3.141592653589793)){null!=g&&(g.j=3.141592653589793*b);null!=w&&(w.j=0);null!=N&&(N.j=0);return}}var p=1.570796326794897==a.l.K(d)?0:Math.cos(d),n=Math.sin(d),y=1.570796326794897==a.l.K(f)?0:Math.cos(f),D=Math.sin(f),K=1.570796326794897==a.l.K(h)?0:Math.cos(h),P=3.141592653589793==a.l.K(h)?0:Math.sin(h);if(null!=g){var k=Math.sin((f-d)/2),h=Math.sin(h/2);g.j=2*Math.asin(Math.sqrt(k*k+p*y*h*h))*b}null!=w&&(a.l.W(a.l.K(d),1.570796326794897)?w.j=0>d?e:a.C.ca(3.141592653589793-
e):w.j=Math.atan2(y*P,p*D-n*y*K));null!=N&&(a.l.W(a.l.K(f),1.570796326794897)?N.j=0>f?c:a.C.ca(3.141592653589793-c):(N.j=Math.atan2(p*P,D*p*K-y*n),N.j=a.C.ca(N.j+3.141592653589793)))}}};b.Rf=function(b,c,d,e,f,g,w){if(null!=g||null!=w){c=a.C.ca(c);d=a.C.ca(d);1.570796326794897<a.l.K(d)&&(d=a.l.Bb(3.141592653589793,d)-d,c=a.C.ca(c+3.141592653589793));a.l.W(a.l.K(d),1.570796326794897)&&(c=0);f=a.C.ca(f);var h=a.l.W(a.l.K(f),1.570796326794897)?0:Math.cos(f),p=a.l.W(a.l.K(f),3.141592653589793)?0:Math.sin(f),
n=a.l.W(a.l.K(d),1.570796326794897)?0:Math.cos(d),y=Math.sin(d);b=e/b;e=a.l.W(a.l.K(b),1.570796326794897)?0:Math.cos(b);var D=a.l.W(a.l.K(b),3.141592653589793)?0:Math.sin(b),K=Math.asin(y*e+n*D*h);null!=w&&(w.j=K);null!=g&&(g.j=a.l.W(a.l.K(K),1.570796326794897)?a.l.W(d,-K)?0>K?f:a.C.ca(3.141592653589793-f):c:a.l.W(a.l.K(d),1.570796326794897)&&a.l.W(b,3.141592653589793)?0>d?f:a.C.ca(3.141592653589793-f):a.C.ca(c+Math.atan2(D*p,n*e-y*D*h)))}};return b}();a.uh=b})(C||(C={}));(function(a){var b=function(){function b(){}
b.Cb=function(b,c,d,e,f,g,w,N,U){var h=new a.da(0),p=new a.da(0),n=[0,0,0],y=[0,0,0],D=[0,0,0],K=new a.da(0),P=new a.da(0),k=new a.da(0),l=new a.da(0),m=new a.da(0);if(null!=w||null!=N||null!=U)if(a.l.Ri(c))a.uh.Cb(b,d,e,f,g,w,N,U);else{f=a.C.ca(f);d=a.C.ca(d);var I=a.C.ca(f-d);if(a.l.W(e,g)&&(a.l.W(d,f)||a.l.W(a.l.K(e),1.570796326794897)))null!=w&&(w.j=0),null!=N&&(N.j=0),null!=U&&(U.j=0);else{if(a.l.W(e,-g)){if(a.l.W(a.l.K(e),1.570796326794897)){null!=w&&(w.j=2*a.C.Wg(b,c));null!=N&&(N.j=0<e?a.C.ca(3.141592653589793-
a.C.ca(f)):a.C.ca(f));null!=U&&(U.j=0<e?a.C.ca(f):a.C.ca(3.141592653589793-a.C.ca(f)));return}a.l.W(a.l.K(I),3.141592653589793)&&(null!=w&&(w.j=2*a.C.Wg(b,c)),null!=N&&(N.j=0),null!=U&&(U.j=0))}else if(a.l.W(a.l.K(e),1.570796326794897)||a.l.W(a.l.K(g),1.570796326794897))a.l.W(a.l.K(e),1.570796326794897)?d=f:f=d;var q=0,r;0>I&&(q=1,r=d,d=f,f=r,r=e,e=g,g=r);var I=a.C.fu(c,e),t=a.C.fu(c,g);if(null!=N||null!=U)a.uh.Cb(b,d,I,f,t,null,h,p),h=Math.atan2(Math.sin(h.j)*Math.cos(e-I),Math.cos(h.j)),p=Math.atan2(Math.sin(p.j)*
Math.cos(g-t),Math.cos(p.j)),0!=q&&(r=h,h=p,p=r),null!=N&&(N.j=h),null!=U&&(U.j=p);null!=w&&(a.C.Fk(1,c,e,d,0,k,l,m),n[0]=k.j,n[1]=l.j,n[2]=m.j,a.C.Fk(1,c,g,f,0,k,l,m),y[0]=k.j,y[1]=l.j,y[2]=m.j,D[0]=n[1]*y[2]-y[1]*n[2],D[1]=-(n[0]*y[2]-y[0]*n[2]),D[2]=n[0]*y[1]-y[0]*n[1],c=1-a.C.Hm(c,a.C.Mr(c,a.C.mk(c,Math.acos(D[2]/Math.sqrt(D[0]*D[0]+D[1]*D[1]+D[2]*D[2]))))),c*=2-c,N=Math.atan2(-D[1],-D[0]),D=a.C.ca(N-1.570796326794897),N=a.C.ca(N+1.570796326794897),D=a.l.K(a.C.ca(d-D))<=a.l.K(a.C.ca(d-N))?D:N,
a.uh.Cb(1,D,0,d,I,K,null,null),a.uh.Cb(1,D,0,f,t,P,null,null),3.141592653589793<K.j+P.j&&(D=a.C.ca(D+3.141592653589793),a.uh.Cb(1,D,0,d,I,K,null,null),a.uh.Cb(1,D,0,f,t,P,null,null)),K.j*=a.l.Bb(1,e),P.j*=a.l.Bb(1,g),K.j=a.C.mk(c,K.j),P.j=a.C.mk(c,P.j),d=a.C.q(b,c,K.j),b=a.C.q(b,c,P.j),w.j=a.l.K(b-d))}}};b.Rf=function(b,c,d,e,f,g,w,N){var h=0,p=new a.da(0),n=new a.da(0),y=[0,0,0],D=[0,0,0],K=new a.da(0),P=new a.da(0),k=new a.da(0);if(null!=w||null!=N)if(a.l.Ri(c))a.uh.Rf(b,d,e,f,g,w,N);else if(a.l.wd(f))null!=
w&&(w.j=d),null!=N&&(N.j=e);else{g=a.C.ca(g);0>f&&(f=a.l.K(f),g=a.C.ca(g+3.141592653589793));d=a.C.ca(d);e=a.C.ca(e);1.570796326794897<a.l.K(e)&&(d=a.C.ca(d+3.141592653589793),e=a.l.Bb(3.141592653589793,e)-e);a.l.W(a.l.K(e),1.570796326794897)&&(d=0);var l;if(a.l.wd(e))l=a.l.K(1.570796326794897-a.l.K(g)),l=a.C.mk(c,l),l=1-a.C.Hm(c,a.C.Mr(c,l)),l*=2-l,b=f/a.C.Wg(b,l)*1.570796326794897,b=a.C.Ep(l,b),b=a.C.fu(l,b),a.uh.Rf(1,d,e,b,g,w,p),null!=N&&(h=p.j),null!=N&&(N.j=a.C.mk(c,h));else if(a.l.W(a.l.K(e),
1.570796326794897))h=a.C.Wg(b,c),p=2*h,b=a.l.Bb(1.570796326794897,e),g=0<b?a.C.ca(3.141592653589793-g):g,e=h-f,a.l.K(e)<=h?null!=w&&(w.j=g):(e=Math.floor(f/p),0==a.J.truncate(e%2)?(null!=w&&(w.j=g),e=h-(f-e*p)):(null!=w&&(w.j=a.C.ca(g+3.141592653589793)),e=h-((e+1)*p-f))),null!=N&&(N.j=a.C.Ep(c,e/h*b));else{l=a.C.fu(c,e);g=Math.atan2(Math.sin(g),Math.cos(g)*Math.cos(e-l));var m=a.J.truncate(a.l.Bb(1,l))*(1.570796326794897>=a.l.K(g)?1:-1);g=a.C.ca(d+Math.atan(Math.tan(g)*-Math.sin(l)));a.uh.Cb(b,g,
0,d,l,null,n,null);l=a.l.K(1.570796326794897-a.l.K(n.j));l=a.C.mk(c,l);l=1-a.C.Hm(c,a.C.Mr(c,l));l*=2-l;a.C.Fk(1,c,0,g,0,K,P,k);y[0]=K.j;y[1]=P.j;y[2]=k.j;a.C.Fk(1,c,e,d,0,K,P,k);D[0]=K.j;D[1]=P.j;D[2]=k.j;e=Math.acos((y[0]*D[0]+y[1]*D[1]+y[2]*D[2])/Math.sqrt(D[0]*D[0]+D[1]*D[1]+D[2]*D[2]));e=a.C.mk(l,e);e=a.C.q(b,l,e)+f*m;f=0<e?n.j:a.C.ca(n.j+3.141592653589793);b=a.l.K(e)/a.C.Wg(b,l)*1.570796326794897;b=a.C.Ep(l,b);b=a.C.fu(l,b);a.uh.Rf(1,g,0,b,f,w,p);null!=N&&(h=p.j);null!=N&&(N.j=a.C.mk(c,h))}}};
return b}();a.Cl=b})(C||(C={}));(function(a){var b=function(){function b(){}b.Cb=function(b,c,d,e,f,g,w,N,U){var h=0,p=0,n=0;if(null!=w||null!=N||null!=U)if(a.l.Ri(c))a.uh.Cb(b,d,e,f,g,w,N,U);else{var y=a.C.ca(f-d);if(a.l.W(e,g)&&(a.l.wd(y)||a.l.W(a.l.K(e),1.570796326794897)))null!=w&&(w.j=0),null!=N&&(N.j=0),null!=U&&(U.j=0);else{if(a.l.W(e,-g)){if(a.l.W(a.l.K(e),1.570796326794897)){null!=w&&(w.j=2*a.C.Wg(b,c));null!=N&&(N.j=0<e?a.C.ca(3.141592653589793-a.C.ca(f)):a.C.ca(f));null!=U&&(U.j=0<e?a.C.ca(f):
a.C.ca(3.141592653589793-a.C.ca(f)));return}a.l.W(a.l.K(y),3.141592653589793)&&(null!=w&&(w.j=2*a.C.Wg(b,c)),null!=N&&(N.j=0),null!=U&&(U.j=0))}else{if(a.l.W(a.l.K(e),1.570796326794897)||a.l.W(a.l.K(g),1.570796326794897)){a.Cl.Cb(b,c,d,e,f,g,w,N,U);return}if(a.l.wd(y)||a.l.W(a.l.K(y),3.141592653589793)){a.Cl.Cb(b,c,d,e,f,g,w,N,U);return}}var D=1-Math.sqrt(1-c),K=c/(1-c),P=b*(1-D);b=a.C.Mr(c,e);var k=a.C.Mr(c,g);c=1.570796326794897==a.l.K(b)?0:Math.cos(b);var l=Math.sin(b),m=1.570796326794897==a.l.K(k)?
0:Math.cos(k),I=Math.sin(k),q=y,r=Math.cos(q),t=Math.sin(q),u=1,v=0,x,z,B,A,F;do{x=q;z=Math.sqrt(Math.pow(m*t,2)+Math.pow(c*I-l*m*r,2));B=l*I+c*m*r;A=Math.atan2(z,B);if(0==z){u=0;break}F=c*m*t/z;h=Math.cos(Math.asin(F));h*=h;p=B-2*l*I/h;1<a.l.K(p)&&(p=a.l.Bb(1,p));n=p*p;q=D/16*h*(4+D*(4-3*h));q=y+(1-q)*D*F*(A+q*z*(p+q*B*(2*n-1)));r=Math.cos(q);t=Math.sin(q);v++;if(3.141592653589793<a.l.K(q)&&30<v){u=0;break}}while(5E3>=v&&!a.l.W(x,q));if(0!=u)K*=h,D=K*(256+K*(-128+K*(74-47*K)))/1024,null!=w&&(w.j=
P*(1+K*(4096+K*(-768+K*(320-175*K)))/16384)*(A-D*z*(p+D/4*(B*(2*n-1)-D/6*p*(4*z*z-3)*(4*n-3))))),null!=N&&(a.l.W(a.l.K(e),1.570796326794897)?N.j=0>e?f:a.C.ca(3.141592653589793-f):N.j=Math.atan2(m*t,c*I-l*m*r)),null!=U&&(a.l.W(a.l.K(g),1.570796326794897)?U.j=0>g?d:a.C.ca(3.141592653589793-d):(U.j=Math.atan2(c*t,c*I*r-l*m),U.j=a.C.ca(U.j+3.141592653589793)));else{q=a.l.Bb(3.141592653589793,y);B=l*I-c*m;A=Math.acos(B);z=Math.sin(A);h=1;v=F=0;do n=F,h*=h,r=h*h,F=D*h*(1+D+D*D),p=D*D*r*(1+2.25*D),u=D*D*
D*r*h,r=1-.25*F+.1875*p-.1953125*u,F=.25*F-.25*p+.29296875*u,t=.03125*p-.05859375*u,u*=.00651041666666667,p=B-2*l*I/h,1<a.l.K(p)&&(p=a.l.Bb(1,p)),h=Math.acos(p),B=Math.cos(2*h),x=Math.cos(3*h),F=a.l.W(e,-g)?a.C.ca(3.141592653589793-y)/(3.141592653589793*D*r):a.C.ca(q-y)/(D*(r*A+F*z*p+t*Math.sin(2*A)*B+u*Math.sin(3*A)*x)),t=F*z/(c*m),q=1.570796326794897<a.l.K(y)?a.l.Bb(3.141592653589793,t)-Math.asin(t):Math.asin(t),r=Math.cos(q),z=Math.sqrt(Math.pow(m*t,2)+Math.pow(c*I-l*m*r,2)),A=3.141592653589793-
Math.asin(a.l.K(z)),B=Math.cos(A),h=Math.cos(Math.asin(F)),v++;while(70>=v&&!a.l.W(n,F));null!=w&&(h*=h,K*=h,r=1+K*(4096+K*(-768+K*(320-175*K)))/16384,a.l.W(e,-g)?w.j=3.141592653589793*P*r:(p=B-2*l*I/h,h=Math.acos(p),B=Math.cos(2*h),x=Math.cos(3*h),w.j=P*(r*A+K*(-512+K*(128+K*(-60+35*K)))/2048*z*p+K*(-4+5*K)/6144*K*K*Math.sin(2*A)*B+u*Math.sin(3*A)*x+-7.62939453125E-5*K*K*K*K*Math.sin(4*A)*Math.cos(4*h))));null!=N&&(a.l.wd(e)&&a.l.wd(g)?(h=Math.sqrt(1-F*F),N.j=Math.acos(h),0>y&&(N.j*=-1)):a.l.W(a.l.K(e),
1.570796326794897)?N.j=0>e?f:a.C.ca(3.141592653589793-f):(w=F/c,P=Math.sqrt(1-w*w),0>c*I-l*m*Math.cos(q)&&(P*=-1),N.j=Math.atan2(w,P),a.l.W(e,-g)&&a.l.K(a.C.ca(d-f))>3.141592653589793*(1-D*Math.cos(e))&&(0<e&&1.570796326794897>a.l.K(N.j)||0>e&&1.570796326794897<a.l.K(N.j))&&(N.j=a.l.Bb(3.141592653589793,N.j)-N.j)));if(null!=U)if(a.l.wd(e)&&a.l.wd(g))h=Math.sqrt(1-F*F),U.j=Math.acos(h),0<=y&&(U.j*=-1);else if(a.l.W(a.l.K(g),1.570796326794897))U.j=0>g?d:a.C.ca(3.141592653589793-d);else if(y=F/m,w=Math.sqrt(1-
y*y),P=Math.sin(q/2),0>Math.sin(k-b)-2*c*I*P*P&&(w*=-1),U.j=Math.atan2(y,w),U.j=a.C.ca(U.j+3.141592653589793),a.l.W(e,-g)&&!a.l.wd(e)&&!a.l.W(a.l.K(e),1.570796326794897)&&a.l.K(a.C.ca(d-f))>3.141592653589793*(1-D*Math.cos(e))&&(null!=N?P=N.j:(w=F/c,P=Math.sqrt(1-w*w),0>c*I-l*m*Math.cos(q)&&(P*=-1),P=Math.atan2(w,P),a.l.W(e,-g)&&a.l.K(a.C.ca(d-f))>3.141592653589793*(1-D*Math.cos(e))&&(0<e&&1.570796326794897>a.l.K(P)||0>e&&1.570796326794897<a.l.K(P))&&(P=a.l.Bb(3.141592653589793,P)-P)),1.570796326794897>=
a.l.K(P)&&1.570796326794897<a.l.K(U.j)||1.570796326794897<=a.l.K(P)&&1.570796326794897>a.l.K(U.j)))U.j=-1*a.C.ca(U.j+3.141592653589793)}}}};b.Rf=function(b,c,d,e,f,g,w,N){if(null!=w||null!=N)if(a.l.Ri(c))a.uh.Rf(b,d,e,f,g,w,N);else if(g=a.C.ca(g),a.l.W(a.l.K(e),1.570796326794897)||a.l.wd(g)||a.l.W(a.l.K(g),3.141592653589793))a.Cl.Rf(b,c,d,e,f,g,w,N);else{var h=1.570796326794897==a.l.K(g)?0:Math.cos(g),p=3.141592653589793==a.l.K(g)?0:Math.sin(g);a.l.W(a.l.K(e),1.570796326794897)&&(d=0);g=1-Math.sqrt(1-
c);var n=a.C.Mr(c,e);e=1.570796326794897==a.l.K(n)?0:Math.cos(n);var y=Math.sin(n),n=Math.atan2(Math.tan(n),h),D=e*p,K=D*D,P=1-K,k=c/(1-c)*P;c=k*(256+k*(-128+k*(74-47*k)))/1024;var l=c/4,m=c/6,q=f/(b*(1-g)*(1+k*(4096+k*(-768+k*(320-175*k)))/16384)),I=q,r;do{r=I;f=1.570796326794897==a.l.K(I)?0:Math.cos(I);var k=3.141592653589793==a.l.K(I)?0:Math.sin(I),t=k*k;b=Math.cos(2*n+I);I=b*b;I=c*k*(b+l*(f*(2*I-1)-m*b*(4*t-3)*(4*I-3)))+q}while(!a.l.W(r,I));f=1.570796326794897==a.l.K(I)?0:Math.cos(I);k=3.141592653589793==
a.l.K(I)?0:Math.sin(I);null!=w&&(p=Math.atan2(k*p,e*f-y*k*h),P=g/16*P*(4+g*(4-3*P)),b=Math.cos(2*n+I),w.j=a.C.ca(d+(p-(1-P)*g*D*(I+P*k*(b+P*f*(2*b*b-1))))));null!=N&&(P=y*k-e*f*h,P=(1-g)*Math.sqrt(K+P*P),N.j=Math.atan2(y*f+e*k*h,P))}};return b}();a.Pu=b})(C||(C={}));(function(a){var b=function(){function b(){}b.Cb=function(b,c,d,e,f,g,w,N,k){var h=a.C.ca(f-d),p=a.l.W(a.l.K(e),1.570796326794897),n=a.l.W(a.l.K(g),1.570796326794897);if(a.l.W(e,g)&&(a.l.wd(h)||p))null!=w&&(w.j=0),null!=N&&(N.j=0),null!=
k&&(k.j=0);else{var y,D;a.l.Ri(c)?(y=Math.sin(e),D=Math.sin(g),y=Math.sqrt((1+y)/(1-y)),D=Math.sqrt((1+D)/(1-D)),y=Math.log(D)-Math.log(y),y=Math.atan2(h,y),null!=w&&(w.j=a.l.W(e,g)?a.l.K(b*Math.cos(e)*h):a.l.K((b*g-b*e)/Math.cos(y)))):(D=a.C.Cx(c,g),y=Math.sin(a.C.Cx(c,e)),D=Math.sin(D),y=Math.sqrt((1+y)/(1-y)),D=Math.sqrt((1+D)/(1-D)),y=Math.log(D)-Math.log(y),y=Math.atan2(h,y),null!=w&&(a.l.W(e,g)?w.j=a.l.K(b*h*Math.cos(e)/a.C.Hm(c,e)):(h=a.C.q(b,c,e),b=a.C.q(b,c,g),w.j=a.l.K((b-h)/Math.cos(y)))));
if(null!=N||null!=k)w=a.C.ca(y+3.141592653589793),p&&n||!p&&!n||(p?y=0>e?f:a.C.ca(3.141592653589793-f):n&&(w=0>g?d:a.C.ca(3.141592653589793-d))),null!=N&&(N.j=y),null!=k&&(k.j=w)}};b.Rf=function(b,c,d,e,f,g,w,N){g=a.C.ca(g);0>f&&(f=a.l.K(f),g=a.C.ca(g+3.141592653589793));a.l.Ri(c)?a.l.W(a.l.K(e),1.570796326794897)?(d=0>e?g:a.C.ca(3.141592653589793-g),g=f/b%6.283185307179586,3.141592653589793>=g?b=e-a.l.Bb(g,e):(d=a.C.ca(d+3.141592653589793),b=-e+a.l.Bb(g-3.141592653589793,e))):a.l.W(a.l.K(g),1.570796326794897)?
(d=a.C.ca(d+a.l.Bb(f,g)/(b*Math.cos(e))),b=e):(b=e+f*Math.cos(g)/b,1.570796326794897<a.l.K(b)&&(b=1.570796326794897),a.l.W(a.l.K(b),1.570796326794897)&&(a.l.wd(g)||a.l.W(a.l.K(g),3.141592653589793))||(1.570796316258184<a.l.K(b)&&(b=a.l.Bb(1.570796316258184,b)),c=Math.sin(e),e=Math.sin(b),c=Math.sqrt((1+c)/(1-c)),e=Math.sqrt((1+e)/(1-e)),c=Math.log(e)-Math.log(c),d=a.C.ca(d+Math.tan(g)*c))):a.l.W(a.l.K(e),1.570796326794897)?(d=0>e?g:a.C.ca(3.141592653589793-g),g=f/a.C.UW(b,c),g%=6.283185307179586,
3.141592653589793>=g?(b=e-a.l.Bb(g,e),b=a.C.Ep(c,b)):(d=a.C.ca(d+3.141592653589793),b=-e+a.l.Bb(g-3.141592653589793,e),b=a.C.Ep(c,b))):a.l.W(a.l.K(g),1.570796326794897)?(d=a.C.ca(d+a.l.Bb(f,g)*a.C.Hm(c,e)/(b*Math.cos(e))),b=e):(b=1.570796326794897*(f*Math.cos(g)+a.C.q(b,c,e))/a.C.Wg(b,c),1.570796326794897<a.l.K(b)&&(b=a.l.Bb(1.570796326794897,b)),b=a.C.Ep(c,b),a.l.W(a.l.K(b),1.570796326794897)&&(a.l.wd(g)||a.l.W(a.l.K(g),3.141592653589793))||(f=a.C.Cx(c,e),e=a.C.Cx(c,b),1.570796316258184<a.l.K(e)&&
(e=a.l.Bb(1.570796316258184,b),b=a.C.YP(c,e)),c=Math.sin(f),e=Math.sin(e),c=Math.sqrt((1+c)/(1-c)),e=Math.sqrt((1+e)/(1-e)),c=Math.log(e)-Math.log(c),d=a.C.ca(d+Math.tan(g)*c)));null!=w&&(w.j=d);null!=N&&(N.j=b)};return b}();a.$D=b})(C||(C={}));(function(a){var b=function(){function b(){}b.Iz=function(b,c,d,e,f,g,w){a.Pu.Cb(b,c,d,e,f,g,null,w,null)};b.Yi=function(b,c,d,e,f,g,w,N){a.Pu.Rf(b,c,d,e,f,g,w,N)};b.Kd=function(b,c,d,e,f,g,w,N,k,l){switch(l){case 2:a.Cl.Cb(b,c,d,e,f,g,w,N,k);break;case 3:a.aE.Cb(b,
c,d,e,f,g,w,N,k);break;case 1:a.$D.Cb(b,c,d,e,f,g,w,N,k);break;default:a.Pu.Cb(b,c,d,e,f,g,w,N,k)}};b.Sj=function(b,c,d,e,f,g,w,N,k){switch(k){case 2:a.Cl.Rf(b,c,d,e,f,g,w,N);break;case 3:a.aE.Rf(b,c,d,e,f,g,w,N);break;case 1:a.$D.Rf(b,c,d,e,f,g,w,N);break;default:a.Pu.Rf(b,c,d,e,f,g,w,N)}};return b}();a.mb=b})(C||(C={}));(function(a){var b=function(){function b(){this.y=this.x=null}b.pa=function(c){var d=new b;d.x=new a.Xb;d.x.set(c.x);d.y=new a.Xb;d.y.set(c.y);return d};b.aG=function(c,d){var h=
new b;h.x=new a.Xb;h.x.set(c);h.y=new a.Xb;h.y.set(d);return h};b.prototype.Kg=function(){return this.x.Kg()&&this.y.Kg()};b.prototype.value=function(){return a.b.pa(this.x.value(),this.y.value())};return b}();a.jZ=b;var c=function(){function b(){this.z=this.y=this.x=null}b.pa=function(c){var d=new b;d.x=new a.Xb;d.x.set(c.x);d.y=new a.Xb;d.y.set(c.y);d.z=new a.Xb;d.z.set(c.z);return d};b.aG=function(c,d,h){var p=new b;p.x=new a.Xb;p.x.set(c);p.y=new a.Xb;p.y.set(d);p.z=new a.Xb;p.z.set(h);return p};
b.prototype.Kg=function(){return this.x.Kg()&&this.y.Kg()&&this.z.Kg()};b.prototype.value=function(){return new a.od(this.x.value(),this.y.value(),this.z.value())};b.prototype.pi=function(b){var c=new a.Xb,d=new a.Xb,h=new a.Xb;c.um(this.x,b.x);d.um(this.y,b.y);h.um(this.z,b.z);b=new a.Xb;b.zO(c,d);b.add(h);return b};b.prototype.iG=function(c){var d=new b;d.x.um(this.y,c.z);d.y.um(this.z,c.x);d.z.um(this.x,c.y);var h=new a.Xb,p=new a.Xb,e=new a.Xb;h.um(this.z,c.y);p.um(this.x,c.z);e.um(this.y,c.x);
d.x.sub(h);d.y.sub(p);d.z.sub(e);return d};return b}();a.kZ=c;var d=function(){function d(){}d.vL=function(a,b,c){var h=b.x;b=b.y;d.Fk(1,a,Math.cos(h),Math.sin(h),Math.cos(b),Math.sin(b),c)};d.aZ=function(b,c){var h=new a.od;d.vL(b,c,h);return h};d.QZ=function(b,c,h,e,f,n){var p=new a.od;d.Fk(b,c,h,e,f,n,p);return p};d.Fk=function(a,b,c,d,h,e,f){a/=Math.sqrt(1-b*e*e);f.I(a*h*c,a*h*d,a*(1-b)*e)};d.Qu=function(b,d){var h=new a.Xb,p=new a.Xb,e=new a.Xb,f=new a.Xb;h.cos(d.x);p.sin(d.x);e.cos(d.y);f.sin(d.y);
d=new a.Xb;d.set(f);d.Tg(f);d.Fp(b);d.Fp(-1);d.GO();d.sqrt();var n=new a.Xb;n.set(1);n.bn(d);d=new a.Xb;d.set(n);d.Tg(e);d.Tg(h);h=new a.Xb;h.set(n);h.Tg(e);h.Tg(p);p=new a.Xb;p.set(n);p.Fp(1-b);p.Tg(f);return c.aG(d,h,p)};d.tY=function(a,b,c){var d=b.x,h=b.y;c.ja(Math.atan2(h,d),Math.atan2(b.z,(1-a)*Math.sqrt(d*d+h*h)))};d.EZ=function(b,c,h){b=new a.b;d.tY(c,h,b);return b};d.oU=function(c,h,e,f){if(Math.abs(h.x-e.x)>Math.PI||Math.abs(h.y)>.5*Math.PI||Math.abs(e.y)>.5*Math.PI||(Math.abs(h.y)==.5*
Math.PI||Math.abs(e.y)==.5*Math.PI)&&h.x!=e.x)return NaN;f=d.UB(f,Math.min(h.x,e.x),Math.max(h.x,e.x));if(!(new a.yc(h.x,e.x)).contains(f))return NaN;var p=b.pa(h);e=b.pa(e);p=d.Qu(c,p);e=d.Qu(c,e);e=p.iG(e);if(e.z.Kg())return h=h.y;var n=new a.Xb;n.set(e.x);n.bn(e.z);n.Fp(-1);var y=new a.Xb;y.set(e.y);y.bn(e.z);y.Fp(-1);var g=new a.Xb;g.set(y);g.Tg(y);p=new a.Xb;p.set(n);p.Tg(n);p.add(g);p.sqrt();if(p.Kg()||n.Kg()&&y.Kg())return h=h.y;h=Math.atan2(y.value(),n.value());h=Math.atan2(p.value()*Math.cos(h-
f),1-c);f=d.aZ(c,a.b.pa(f,h));c=new a.od(f.x,f.y,-f.z);f=e.value().pi(f);c=e.value().pi(c);Math.abs(c)<Math.abs(f)&&(h=-h);return h};d.xA=function(c,h,e,f,n,g){g[0]=NaN;g[1]=NaN;if(Math.abs(e.x-f.x)>Math.PI||Math.abs(e.y)>.5*Math.PI||Math.abs(f.y)>.5*Math.PI||(Math.abs(e.y)==.5*Math.PI||Math.abs(f.y)==.5*Math.PI)&&e.x!=f.x||Math.abs(n)>=.5*Math.PI||0<e.y&&0<f.y&&e.y>n&&f.y>n||0>e.y&&0>f.y&&e.y<n&&f.y<n)return 0;var p=b.pa(e);c=b.pa(f);p=d.Qu(h,p);c=d.Qu(h,c);var y=p.iG(c);if(y.z.Kg())return(new a.yc(e.y,
f.y)).contains(n)?(g[0]=e.x,1):0;c=new a.Xb;c.set(y.x);c.bn(y.z);c.Fp(-1);p=new a.Xb;p.set(y.y);p.bn(y.z);p.Fp(-1);y=new a.Xb;y.set(p);y.Tg(p);var D=new a.Xb;D.set(c);D.Tg(c);D.add(y);D.sqrt();if(D.Kg()||c.Kg()&&p.Kg())return 0==n?(g[0]=e.x,g[1]=f.x,2):0;h=(1-h)*Math.tan(n)/D.value();if(1<Math.abs(h))return 0;h=Math.acos(h);y=Math.atan2(p.value(),c.value());c=Math.min(e.x,f.x);p=Math.max(e.x,f.x);f=d.UB(y-h,c,p);h=0!=n?d.UB(y+h,c,p):f;n=0;c<=f&&f<=p&&(g[n]=f,n++);h!=f&&c<=h&&h<=p&&(g[n]=h,n++,2==
n&&Math.abs(g[0]-e.x)>Math.abs(g[1]-e.x)&&(e=g[0],g[0]=g[1],g[1]=e));return n};d.UB=function(a,b,c){a>c?(b=Math.ceil((a-c)/(2*Math.PI)),a-=2*b*Math.PI):a<b&&(b=Math.ceil((b-a)/(2*Math.PI)),a+=2*b*Math.PI);return a};d.HA=function(a,b){b[0]>.5*Math.PI?(a[0]+=Math.PI,b[0]=Math.PI-b[0]):b[0]<-.5*Math.PI&&(a[0]-=Math.PI,b[0]=-Math.PI-b[0])};return d}();a.uy=d})(C||(C={}));(function(a){var b=function(){function b(){}b.xY=function(c,d){var h=8;0>h&&(h=8);var e=[0,0,0,0],f=new a.b;f.L(d);f.scale(9102==a.fb.lc(c).Td().Bc()?
1:a.fb.lc(c).Td().Bi/3.141592653589793*180);-180>f.x?(f.x-=f.x%360,-180>f.x&&(f.x+=360)):180<f.x&&(f.x-=f.x%360,180<f.x&&(f.x-=360));90<f.y&&(f.y=90);-90>f.y&&(f.y=-90);c=5*h;d=(c+31)/32;for(var n=-180,g=180,w=c-1,k=d-1;0<=k;k--)for(var l=w-32*k,m=Math.min(32,c-32*k),q=1;q<m;q+=2){var I=.5*(g+n);f.x>=I?(e[k]|=1<<l,n=I):g=I;l-=2;w-=2}n=-90;g=90;w=c-2;for(k=d-1;0<=k;k--)for(l=w-32*k,m=Math.min(32,c-32*k),q=0;q<m;q+=2)I=.5*(g+n),f.y>=I?(e[k]|=1<<l,n=I):g=I,l-=2,w-=2;return b.FL(e,h,h)};b.FL=function(a,
b,c){for(var d=[],h=0;h<b;h++)d[h]="";for(var p=h=0,e=0;e<b;e++){var f=a[h]>>p&31,p=p+5;if(31<p){var n=37-p,f=f&(1<<n)-1,p=p-32;h++;f|=(a[h]&(1<<p)-1)<<n}d[b-1-e]="0123456789bcdefghjkmnpqrstuvwxyz".split("")[f]}if(c>b)for(e=0;e<c-b;e++)d.push("0");else c<b&&(d.length=c);return d.join("")};return b}();a.dM=b})(C||(C={}));(function(a){var b={gcstol:[0,2E-9,1,2.241706620489156E-9,2,2.313672246530541E-9,3,8.98240164660333E-9,4,8.982433838020134E-9,5,8.982439417325895E-9,6,8.982466029667677E-9,7,8.982476760268133E-9,
8,8.982492642167149E-9,9,8.98251968292634E-9,10,8.98253685210448E-9,11,8.982546725256576E-9,12,8.982557456049832E-9,13,8.98257333682596E-9,14,8.982575482995276E-9,15,8.982578488197342E-9,16,8.982579775336987E-9,17,8.9825840676828E-9,18,8.982599090925448E-9,19,8.982605529473397E-9,20,8.982609220517402E-9,21,8.982611968030573E-9,22,8.982616260407152E-9,23,8.982620552787834E-9,24,8.982633429954492E-9,25,8.982637722351582E-9,26,8.98264416095491E-9,27,8.982646307158072E-9,28,8.982654891980968E-9,29,8.982667769246082E-9,
30,8.982674207892485E-9,31,8.982680646548117E-9,32,8.982682792768713E-9,33,8.982685798042582E-9,34,8.982689231436652E-9,35,8.98269137766135E-9,36,8.98269266624163E-9,37,8.982705114087017E-9,38,8.982706830791106E-9,39,8.982711958374661E-9,40,8.982712839964735E-9,41,8.982717991496125E-9,42,8.982721424914803E-9,43,8.982723571154887E-9,44,8.982727863638127E-9,45,8.982730868942154E-9,46,8.982734302370678E-9,47,8.982745033612112E-9,48,8.982751472369276E-9,49,8.982755764879183E-9,50,8.982762203651733E-9,
51,8.982764776628385E-9,52,8.982766496171896E-9,53,8.98277722749025E-9,54,8.98278152002477E-9,55,8.98279933943848E-9,56,8.9829143024805E-9,57,8.982922161948598E-9,58,8.98292327314211E-9,59,8.982925667349601E-9,60,8.982932222965576E-9,61,8.982961298941316E-9,62,8.982965524049989E-9,63,8.982994818246099E-9,64,8.982994895706967E-9,65,8.98299489597736E-9,66,8.983000733443498E-9,67,8.983055097289157E-9,68,8.983064111047368E-9,69,8.983111996941178E-9,70,8.983120447446023E-9,71,8.98312748954554E-9,72,8.983134531656096E-9,
73,8.983141573777694E-9,74,8.983148615910332E-9,75,8.983152841195215E-9,76,8.983153545409748E-9,77,8.983153827095593E-9,78,8.98315396793852E-9,79,8.983154249624393E-9,80,8.983155658054012E-9,81,8.983960794340072E-9,82,8.984061344391998E-9,83,8.984072829255685E-9,84,8.984194981201908E-9,85,8.984275233099427E-9,86,8.984326127007554E-9,87,8.984330099816539E-9,88,8.98433275258421E-9,89,8.984333047023206E-9,90,8.984333885258723E-9,91,8.984337959508212E-9,92,8.984365176209457E-9,93,8.984727360418079E-9,
94,8.984901041679577E-9,95,8.98542662091587E-9,96,8.98610024130669E-9,97,8.992894229037531E-9,98,8.993203677616635E-9,99,8.993206178094346E-9,100,8.993216059187305E-9,101,8.99322029394808E-9,102,8.994627867045891E-9,103,9.467559984315793E-9,104,9.46881168618118E-9,105,9.980888154931644E-9,106,9.981105353606775E-9,107,9.983807356573187E-9,108,1.687060485811522E-8,109,1.688447560354875E-8,110,2.176606011487185E-8,111,2.225078816042032E-8,112,2.348476432064694E-8,113,2.348765250187846E-8,114,2.378108974103778E-8,
115,3.14559636297708E-8,116,3.297788621680806E-8,117,3.667892343788279E-8,118,4.235973644320739E-8,119,4.794625900676345E-8,120,7.262742998235812E-8,121,7.499447580246377E-8,122,7.525056410964318E-8,123,7.979913581209237E-8,124,9.662020153976783E-8,125,9.799175562353741E-8,126,9.897353517547472E-8,127,1.02313891987647E-7,128,1.081460541960784E-7,129,1.21905913857622E-7,130,2.246893314238523E-7,131,2.297344808062643E-7,132,2.42984645941825E-7,133,2.754604784282804E-7,134,2.884548130346993E-7,135,3.370339971357784E-7,
136,4.307953346848296E-7,137,5.208707228462029E-7,138,5.509209568565608E-7,139,6.452227422644406E-7,140,6.740679942715567E-7,141,6.861770001566745E-7,142,7.252630318111686E-7,143,7.441010326374328E-7,144,7.742672907173287E-7,145,9.629542775307953E-7,146,1.061032953945969E-6,147,1.143628333594458E-6,148,1.162186197019925E-6,149,1.36418522650196E-6,150,1.367441038498385E-6,151,1.432394487827058E-6,152,1.736235742820677E-6,153,1.848250952034914E-6,154,1.909859317102744E-6,155,1.975716534933873E-6,156,
2.122065907891938E-6,157,2.72837045300392E-6,158,3.183098861837907E-6,159,3.580986219567645E-6,160,3.819718634205488E-6,161,4.09255567950588E-6,162,4.407367654852486E-6,163,4.774648292756861E-6,164,5.161781938115525E-6,165,5.20870722846203E-6,166,5.729577951308232E-6,167,6.031134685587613E-6,168,6.987290184522236E-6,169,9.241254760174569E-6,170,1.145915590261646E-5],pcstol:[0,6.666666666666667E-9,1,2E-8,2,4.970973863636364E-5,3,4.970978156565657E-5,4,4.970980410559237E-5,5,.001,6,.001093615055555556,
7,.001093615194444445,8,.001093619003239988,9,.001093623110088878,10,.003280833333333333,11,.003280839895013123,12,.003280843014596366,13,.003280845583333334,14,.003280869330266636,15,.00497101413676763],newtoold:[2154,102110,2195,102200,2204,32036,2205,26979,2225,102641,2226,102642,2227,102643,2228,102644,2229,102645,2230,102646,2231,102653,2232,102654,2233,102655,2234,102656,2235,102657,2236,102658,2237,102659,2238,102660,2239,102666,2240,102667,2241,102668,2242,102669,2243,102670,2246,102679,2247,
102680,2248,102685,2249,102686,2250,102687,2254,102694,2255,102695,2257,102712,2258,102713,2259,102714,2260,102715,2261,102716,2262,102717,2263,102718,2264,102719,2267,102724,2268,102725,2271,102728,2272,102729,2274,102736,2275,102737,2276,102738,2277,102739,2278,102740,2279,102741,2283,102746,2284,102747,2285,102748,2286,102749,2287,102752,2288,102753,2289,102754,2312,23433,2326,102140,2395,2091,2396,2092,2397,2166,2398,2167,2399,2168,2759,102229,2760,102230,2761,102248,2762,102249,2763,102250,2764,
102251,2765,102252,2766,102241,2767,102242,2768,102243,2769,102244,2770,102245,2771,102246,2772,102253,2773,102254,2774,102255,2775,102256,2776,102257,2777,102258,2778,102259,2779,102260,2780,102266,2781,102267,2782,102261,2783,102262,2784,102263,2785,102264,2786,102265,2787,102268,2788,102269,2789,102270,2790,102271,2791,102272,2792,102273,2793,102274,2794,102275,2795,102276,2796,102277,2797,102278,2798,102279,2799,102280,2800,102281,2801,102282,2802,102283,2803,102284,2804,102285,2805,102286,2806,
102287,2807,102288,2808,102289,2809,102290,2810,102291,2811,102292,2812,102293,2813,102294,2814,102295,2815,102296,2816,102297,2817,102298,2818,102300,2819,102304,2820,102307,2821,102308,2822,102309,2823,102310,2824,102311,2825,102312,2826,102313,2827,102314,2828,102315,2829,102316,2830,102317,2831,102318,2832,102320,2833,102321,2834,102322,2835,102323,2836,102324,2837,102325,2838,102326,2839,102327,2840,102330,2841,102334,2842,102335,2843,102336,2844,102337,2845,102338,2846,102339,2847,102340,2848,
102341,2849,102342,2850,102343,2851,102344,2852,102345,2853,102346,2854,102347,2855,102348,2856,102349,2857,102350,2858,102351,2859,102352,2860,102353,2861,102354,2862,102355,2863,102356,2864,102357,2865,102358,2866,102361,2942,102167,2943,102169,2944,2139,2945,2140,2946,2141,2947,2142,2948,2143,2949,2144,2950,2145,2951,2146,2952,2147,2953,2036,2954,2291,2955,2153,2956,2152,2957,2151,2958,2150,2959,2149,2960,2037,2961,2038,2962,2148,2965,2244,2966,2245,3003,102091,3004,102092,3005,102190,3060,2982,
3067,102139,3072,102606,3074,102608,3075,102208,3077,102210,3078,102123,3080,102119,3081,102603,3082,102602,3083,102601,3088,65163,3089,102763,3090,102363,3092,102151,3093,102152,3094,102153,3095,102154,3096,102155,3097,102145,3098,102146,3099,102147,3100,102148,3101,102149,3102,2155,3107,102172,3110,102170,3111,102171,3119,2214,3158,102234,3159,102235,3160,102236,3336,2979,3338,102006,3346,2600,3370,102126,3371,102127,3372,102130,3373,102131,3389,2577,3390,2694,3400,102184,3401,102185,3404,3359,
3407,3366,3417,102675,3418,102676,3419,102677,3420,102678,3421,102707,3422,102708,3423,102709,3424,102711,3433,102651,3434,102652,3435,102671,3436,102672,3437,102710,3438,102730,3448,102095,3451,102681,3452,102682,3455,102735,3461,2063,3462,2064,3463,3073,3464,3076,3560,102742,3566,102743,3567,102744,3734,102722,3735,102723,3736,102755,3737,102756,3738,102757,3739,102758,3741,102205,3742,102206,3743,102207,3748,102211,3750,102202,3751,102203,3759,102663,3760,102463,3764,102112,3770,102090,3771,102180,
3772,102181,3773,102182,3775,102186,3776,102187,3777,102188,3800,102183,3801,102189,3812,102199,3814,102609,3815,102469,3819,104990,3821,104136,3824,104137,3825,102444,3826,102443,3827,102442,3828,102441,3857,102100,3889,104991,3906,104992,4048,103201,4049,103202,4050,103203,4051,103204,4056,103205,4057,103206,4058,103207,4059,103208,4060,103209,4061,103210,4062,103211,4063,103212,4071,103213,4082,103214,4083,103215,4093,103216,4094,103217,4095,103218,4096,103219,4167,104108,4169,37252,4171,104107,
4189,104110,4197,4234,4223,37223,4304,104304,4414,102201,4415,102762,4417,102764,4434,102765,4437,102647,4455,32029,4456,32018,4457,3454,4462,102439,4463,4466,4470,4469,4484,103794,4485,103795,4486,103796,4487,103797,4488,103798,4489,103799,4611,104104,4612,104111,4613,37255,4615,37247,4616,37250,4617,4140,4618,4291,4620,37211,4626,37235,4647,102362,4658,37204,4668,37201,4669,4126,4672,37217,4673,104125,4675,37220,4684,37232,4698,4631,4707,37213,4708,37231,4709,37212,4710,37238,4711,37214,4712,37237,
4713,37208,4714,37215,4715,37253,4716,37216,4717,37239,4719,37219,4722,37242,4724,37233,4725,37222,4727,37224,4728,37246,4729,37226,4730,37227,4731,37228,4732,37229,4733,37230,4734,37251,4735,37259,4736,37254,4739,37205,4758,104133,4760,37001,4762,104114,4826,102214,5013,104142,5014,102331,5015,102332,5016,102333,5173,102085,5174,102086,5175,102087,5176,102088,5177,102089,5178,102040,5179,102080,5185,102081,5186,102082,5187,102083,5188,102084,5221,102066,5246,104100,5247,102490,5324,104144,5325,102420,
5329,2934,5365,104143,5367,102305,5451,104132,5513,102065,5514,102067,5519,102111,5520,31461,5646,102745,5839,5388,5858,5532,5879,4474,6207,104256,6244,102769,6245,102790,6246,102770,6247,102771,6248,102793,6249,102796,6250,102772,6251,102788,6252,102775,6253,102795,6254,102781,6255,102767,6256,102774,6257,102768,6258,102797,6259,102789,6260,102780,6261,102783,6262,102787,6263,102791,6264,102777,6265,102798,6266,102779,6267,102784,6268,102792,6269,102782,6270,102785,6271,102794,6272,102773,6273,102778,
6274,102786,6275,102776,6311,104141,6318,104145,6322,104287,6325,104286,6328,102046,6329,102047,6330,102048,6331,102049,6332,102050,6333,102051,6334,102052,6335,102053,6336,102054,6337,102055,6338,102056,6339,102057,6340,102058,6341,102059,6342,102382,6343,102383,6344,102384,6345,102385,6346,102386,6347,102387,6348,102388,6350,102965,6355,102975,6356,102976,6391,6141,6393,102966,6394,102977,6395,102978,6396,102979,6397,102980,6398,102981,6399,102982,6400,102983,6401,102984,6402,102985,6403,102986,
6404,102988,6405,102991,6406,102987,6407,102990,6408,102989,6409,102992,6410,102993,6411,102995,6412,102994,6413,102996,6414,102962,6415,102997,6416,103003,6417,102998,6418,103004,6419,102999,6420,103005,6421,103E3,6422,103006,6423,103001,6424,103007,6425,103002,6426,103008,6427,103010,6428,103013,6429,103009,6430,103012,6431,103011,6432,103014,6433,103015,6434,103016,6435,103017,6436,103018,6437,103019,6438,103022,6439,102967,6440,103021,6441,103024,6442,103020,6443,103023,6444,103025,6445,103027,
6446,103026,6447,103028,6448,103030,6449,103033,6450,103029,6451,103032,6452,103031,6453,103034,6454,103035,6455,103037,6456,103036,6457,103038,6458,103039,6459,103041,6460,103040,6461,103042,6462,103043,6463,103045,6464,103044,6465,103046,6466,103047,6467,103049,6468,103048,6469,103050,6470,103051,6471,103052,6472,103053,6473,103054,6474,103055,6475,103056,6476,103057,6477,103059,6478,103058,6479,103060,6480,103066,6481,103065,6482,103067,6483,103061,6484,103063,6485,103062,6486,103064,6487,103068,
6488,103069,6489,103071,6490,103073,6491,103070,6492,103072,6493,103075,6494,103078,6495,103074,6496,103077,6497,102968,6498,103076,6499,103079,6500,103081,6501,103084,6502,103080,6503,103083,6504,103082,6505,103085,6506,103086,6507,103088,6508,102963,6509,103087,6510,103089,6511,103091,6512,103090,6513,103092,6514,103093,6515,103094,6516,103095,6518,103098,6519,103101,6520,103097,6521,103100,6522,103099,6523,103102,6524,103103,6525,103104,6526,103105,6527,103106,6528,103108,6529,103111,6530,103107,
6531,103110,6532,103109,6533,103112,6534,103114,6535,103118,6536,103113,6537,103117,6538,103116,6539,103120,6540,103115,6541,103119,6542,103121,6543,103122,6544,103123,6545,103125,6546,103124,6547,103126,6548,103127,6549,103129,6550,103128,6551,103130,6552,103131,6553,103133,6554,103132,6555,103134,6556,102969,6557,102970,6558,103135,6559,103137,6560,103136,6561,103138,6562,103139,6563,103140,6564,103141,6565,103142,6566,103200,6567,103143,6568,103144,6569,103145,6570,103146,6571,103147,6572,103149,
6573,103148,6574,103150,6575,103151,6576,103152,6577,103155,6578,103160,6579,102971,6580,102972,6581,103153,6582,103158,6583,103154,6584,103159,6585,103157,6586,103162,6587,103156,6588,103161,6589,103172,6590,103173,6592,103174,6593,103176,6594,103175,6595,103177,6596,103178,6597,103180,6598,103179,6599,103181,6600,103182,6601,103184,6602,103183,6603,103185,6605,103190,6606,103186,6607,103189,6608,103188,6609,103191,6610,102973,6611,103192,6612,103196,6613,103193,6614,103197,6615,103195,6616,103199,
6617,103194,6618,103198,6619,103164,6620,103163,6621,103165,6625,103170,6626,103169,6627,103171,6628,102520,6629,102521,6630,102522,6631,102523,6632,102524,6633,102527,6634,102493,6635,102494,6636,102496,6637,102495,6668,104020,6669,102610,6670,102611,6671,102612,6672,102613,6673,102614,6674,102615,6675,102616,6676,102617,6677,102618,6678,102619,6679,102620,6680,102621,6681,102622,6682,102623,6683,102624,6684,102625,6685,102626,6686,102627,6687,102628,6688,102593,6689,102594,6690,102595,6691,102596,
6692,102597,6783,104223,6784,102530,6785,102500,6788,102532,6789,102502,6792,102533,6793,102503,6796,102531,6797,102501,6800,102534,6801,102504,6804,102535,6805,102505,6808,102536,6809,102506,6812,102537,6813,102507,6816,102538,6817,102508,6820,102539,6821,102509,6824,102540,6825,102510,6828,102541,6829,102511,6832,102542,6833,102512,6836,102543,6837,102513,6840,102544,6841,102514,6844,102546,6845,102516,6848,102545,6849,102515,6852,102547,6853,102517,6856,102548,6857,102518,6860,102549,6861,102519,
6867,102380,6868,102381,6879,103187,6880,103096,6884,102376,6885,102378,6886,102377,6887,102379,7136,6980,7139,6987,7142,102706,7692,102557,7693,102558,7694,102559,7695,102560,7696,102561,8090,103318,8091,103418,8092,103317,8093,103417,8095,103371,8096,103471,8097,103369,8098,103469,8099,103368,8100,103468,8101,103367,8102,103467,8103,103366,8104,103466,8105,103365,8106,103465,8107,103364,8108,103464,8109,103363,8110,103463,8111,103362,8112,103462,8113,103361,8114,103461,8115,103360,8116,103460,8117,
103359,8118,103459,8119,103357,8120,103457,8121,103356,8122,103456,8123,103355,8124,103455,8125,103354,8126,103454,8127,103353,8128,103453,8129,103352,8130,103452,8131,103350,8132,103450,8133,103349,8134,103449,8135,103348,8136,103448,8139,103343,8140,103443,8141,103342,8142,103442,8143,103341,8144,103441,8145,103339,8146,103439,8147,103337,8148,103437,8149,103336,8150,103436,8151,103334,8152,103434,8153,103333,8154,103433,8155,103331,8156,103431,8161,103326,8162,103426,8163,103325,8164,103425,8165,
103324,8166,103424,8171,103321,8172,103421,8173,103320,8177,103420,8179,103316,8180,103416,8181,103315,8182,103415,8184,103314,8185,103414,8191,103312,8193,103412,8196,103311,8197,103411,8198,103310,8200,103410,8201,103309,8202,103409,8203,103308,8204,103408,8207,103306,8208,103406,8209,103305,8210,103405,8212,103304,8213,103404,8214,103303,8216,103403,8218,103302,8220,103402,8222,103301,8224,103401,8431,104248,8441,102590,8693,102449,8826,102605,8857,54035,8858,54036,8859,54037,8860,8449,8988,104115,
8989,104116,8990,104117,8991,104118,8992,104119,8993,104120,8994,104121,8995,104122,8996,104123,8997,104124,8998,104896,8999,104257,9E3,104019,9014,104010,9019,104021,9053,104011,9054,104012,9055,104013,9056,104014,9057,104015,9059,104258,9060,104179,9061,104180,9062,104181,9063,104182,9064,104183,9065,104184,9066,104185,9067,104186,21896,21891,21897,21892,21898,21893,21899,21894,26701,102124,26702,102125,26799,26747,26847,102683,26848,102684,26849,102691,26850,102692,26851,102693,26852,102704,26853,
102750,26854,102751,26857,102466,26858,102467,26859,102468,26901,102128,26902,102129,27493,27492,29101,29100,29168,29118,29169,29119,29170,29120,29171,29121,29172,29122,29187,29177,29188,29178,29189,29179,29190,29180,29191,29181,29192,29182,29193,29183,29194,29184,29195,29185,29902,29900,31279,31278,31281,31291,31282,31292,31283,31293,31284,31294,31285,31295,31286,31296,31287,31297,31466,31462,31467,31463,31468,31464,31469,31465,31986,31917,31987,31918,31988,31919,31989,31920,31990,31921,31991,31922,
32064,32074,32065,32075,32066,32076,32067,32077,102550,2181,102551,2182,102552,2183,102553,2184,102554,2185,102555,2186,102556,2187],pcsid:[2066,15,2136,12,2155,10,2157,5,2158,5,2159,12,2160,12,2219,5,2220,5,2244,10,2245,10,2256,11,2265,11,2266,11,2269,11,2270,11,2273,11,2290,5,2291,5,2294,5,2295,5,2313,5,2314,14,2899,10,2900,10,2901,11,2909,11,2910,11,2911,10,2912,10,2913,11,2914,11,2964,10,2967,10,2968,10,2991,5,2992,11,2993,5,2994,11,3073,5,3076,5,3079,5,3091,10,3106,5,3108,5,3109,5,3141,5,3142,
5,3167,4,3337,5,3347,5,3348,5,3359,10,3360,5,3361,11,3362,5,3363,10,3364,5,3365,10,3366,14,3402,5,3403,5,3405,5,3406,5,3439,5,3440,5,3447,5,3449,5,3450,5,3453,10,3454,10,3460,5,3479,11,3480,5,3481,11,3482,5,3483,11,3484,5,3485,10,3486,5,3487,10,3488,5,3489,5,3490,10,3491,5,3492,10,3493,5,3494,10,3495,5,3496,10,3497,5,3498,10,3499,5,3500,10,3501,5,3502,10,3503,5,3504,10,3505,5,3506,10,3507,5,3508,10,3509,5,3510,10,3511,5,3512,10,3513,5,3514,5,3515,10,3516,5,3517,10,3518,5,3519,10,3520,5,3521,10,3522,
5,3523,10,3524,5,3525,10,3526,5,3527,10,3528,5,3529,10,3530,5,3531,10,3532,5,3533,10,3534,5,3535,10,3536,5,3537,10,3538,5,3539,10,3540,5,3541,10,3542,5,3543,10,3544,5,3545,10,3546,5,3547,10,3548,5,3549,10,3550,5,3551,10,3552,5,3553,10,3582,10,3583,5,3584,10,3585,5,3586,10,3587,5,3588,11,3589,5,3590,11,3591,5,3592,5,3593,11,3598,10,3599,5,3600,10,3605,11,3606,5,3607,5,3608,10,3609,5,3610,10,3611,5,3612,10,3613,5,3614,10,3615,5,3616,10,3617,5,3618,10,3619,5,3620,10,3621,5,3622,10,3623,5,3624,10,3625,
5,3626,10,3627,5,3628,10,3629,5,3630,10,3631,5,3632,10,3633,5,3634,11,3635,5,3636,11,3640,10,3641,5,3642,10,3643,5,3644,11,3645,5,3646,11,3647,5,3648,11,3649,5,3650,10,3651,5,3652,10,3653,5,3654,10,3655,5,3656,11,3657,5,3658,10,3659,5,3660,10,3661,5,3662,10,3663,5,3664,10,3668,10,3669,5,3670,10,3671,5,3672,10,3673,5,3674,10,3675,5,3676,11,3677,10,3678,5,3679,11,3680,10,3681,5,3682,11,3683,10,3684,5,3685,5,3686,10,3687,5,3688,10,3689,5,3690,10,3691,5,3692,10,3696,10,3697,5,3698,10,3699,5,3700,10,3740,
5,3749,5,3783,5,3784,5,3793,5,3794,5,3802,5,3816,5,3829,5,3854,5,3911,5,3912,5,3920,5,3978,5,3979,5,3991,10,3992,10,4026,5,4037,5,4038,5,4087,5,4088,5,4217,10,4438,10,4439,10,4467,5,4471,5,4474,5,4559,5,4822,5,4839,5,5018,5,5048,5,5167,5,5168,5,5223,5,5234,5,5235,5,5243,5,5266,5,5316,5,5320,5,5321,5,5330,5,5331,5,5337,5,5361,5,5362,5,5382,5,5383,5,5396,5,5456,5,5457,5,5469,5,5472,9,5490,5,5518,5,5523,5,5559,5,5588,11,5589,14,5596,5,5627,5,5629,5,5641,5,5643,5,5644,5,5654,10,5655,10,5659,5,5700,5,
5825,5,5836,5,5837,5,5842,5,5844,5,5880,5,5887,5,5890,5,6128,11,6129,11,6141,11,6204,5,6210,5,6211,5,6307,5,6312,5,6316,5,6362,5,6591,5,6646,5,6703,5,6786,5,6787,11,6790,5,6791,11,6794,5,6795,11,6798,5,6799,11,6802,5,6803,11,6806,5,6807,11,6810,5,6811,11,6814,5,6815,11,6818,5,6819,11,6822,5,6823,11,6826,5,6827,11,6830,5,6831,11,6834,5,6835,11,6838,5,6839,11,6842,5,6843,11,6846,5,6847,11,6850,5,6851,11,6854,5,6855,11,6858,5,6859,11,6862,5,6863,11,6870,5,6875,5,6876,5,6915,5,6922,5,6923,10,6924,5,6925,
10,6962,5,6984,5,6991,5,7128,10,7131,5,7132,10,7257,5,7258,10,7259,5,7260,10,7261,5,7262,10,7263,5,7264,10,7265,5,7266,10,7267,5,7268,10,7269,5,7270,10,7271,5,7272,10,7273,5,7274,10,7275,5,7276,10,7277,5,7278,10,7279,5,7280,10,7281,5,7282,10,7283,5,7284,10,7285,5,7286,10,7287,5,7288,10,7289,5,7290,10,7291,5,7292,10,7293,5,7294,10,7295,5,7296,10,7297,5,7298,10,7299,5,7300,10,7301,5,7302,10,7303,5,7304,10,7305,5,7306,10,7307,5,7308,10,7309,5,7310,10,7311,5,7312,10,7313,5,7314,10,7315,5,7316,10,7317,
5,7318,10,7319,5,7320,10,7321,5,7322,10,7323,5,7324,10,7325,5,7326,10,7327,5,7328,10,7329,5,7330,10,7331,5,7332,10,7333,5,7334,10,7335,5,7336,10,7337,5,7338,10,7339,5,7340,10,7341,5,7342,10,7343,5,7344,10,7345,5,7346,10,7347,5,7348,10,7349,5,7350,10,7351,5,7352,10,7353,5,7354,10,7355,5,7356,10,7357,5,7358,10,7359,5,7360,10,7361,5,7362,10,7363,5,7364,10,7365,5,7366,10,7367,5,7368,10,7369,5,7370,10,7877,5,7878,5,7882,5,7883,5,7887,5,7899,5,7991,5,7992,5,8035,10,8036,10,8058,5,8059,5,8082,5,8083,5,8088,
5,8137,5,8138,10,8157,5,8158,10,8159,5,8160,10,8167,5,8168,10,8169,5,8170,10,8187,5,8189,10,8205,5,8206,10,8225,5,8226,10,8311,5,8312,11,8313,5,8314,11,8315,5,8316,11,8317,5,8318,11,8319,5,8320,11,8321,5,8322,11,8323,5,8324,11,8325,5,8326,11,8327,5,8328,11,8329,5,8330,11,8331,5,8332,11,8333,5,8334,11,8335,5,8336,11,8337,5,8338,11,8339,5,8340,11,8341,5,8342,11,8343,5,8344,11,8345,5,8346,11,8347,5,8348,11,8352,5,8353,5,8379,5,8380,10,8381,5,8382,10,8383,5,8384,10,8385,5,8387,10,8391,5,8395,5,8433,5,
8455,5,8456,5,8531,10,8682,5,8687,5,8692,5,8903,5,8950,5,8951,5,9039,5,9040,5,9141,5,9149,5,9150,5,9191,5,9221,5,9222,5,20499,5,20538,5,20539,5,20790,5,20791,5,21291,5,21292,5,21500,5,21817,5,21818,5,22032,5,22033,5,22091,5,22092,5,22332,5,22391,5,22392,5,22700,5,22770,5,22780,5,22832,5,23090,5,23095,5,23239,5,23240,5,23433,5,23700,5,24047,5,24048,5,24100,14,24200,5,24305,5,24306,5,24382,6,24383,5,24500,5,24547,5,24548,5,24571,2,24600,5,25E3,5,25231,5,25884,5,25932,5,26237,5,26331,5,26332,5,26591,
5,26592,5,26632,5,26692,5,26855,10,26856,10,27120,5,27200,5,27291,7,27292,7,27429,5,27492,5,27500,5,27700,5,28232,5,28600,5,28991,5,28992,5,29100,5,29220,5,29221,5,29333,5,29635,5,29636,5,29701,5,29738,5,29739,5,29849,5,29850,5,29871,3,29872,13,29873,5,29900,5,29901,5,29903,5,30200,15,30339,5,30340,5,30791,5,30792,5,31028,5,31121,5,31154,5,31170,5,31171,5,31370,5,31528,5,31529,5,31600,5,31700,5,31838,5,31839,5,31901,5,32061,5,32062,5,32098,5,32099,10,32100,5,32104,5,32161,5,32766,5,53048,5,53049,
5,54090,5,54091,5,65061,10,65062,10,65161,5,65163,5,102041,10,102064,8,102068,1,102069,0,102118,10,102119,11,102120,10,102121,10,102217,10,102218,5,102219,10,102220,10,102378,11,102379,11,102380,5,102381,11,102498,5,102499,5,102589,10,102590,5,102599,10,102600,10,102604,10,102605,5,102606,5,102647,5,102704,10,102705,10,102706,5,102733,10,102761,10,102762,5,102763,10,102764,5,102765,5,102766,10,102962,5,102963,5,102970,11,102974,10,102993,5,102994,5,102995,10,102996,10,103015,5,103016,10,103017,5,
103018,10,103025,5,103026,5,103027,10,103028,10,103035,5,103036,5,103037,10,103038,10,103039,5,103040,5,103041,10,103042,10,103043,5,103044,5,103045,10,103046,10,103047,5,103048,5,103049,10,103050,10,103051,5,103052,10,103053,5,103054,10,103055,5,103056,10,103057,5,103058,5,103059,10,103060,10,103061,5,103062,5,103063,10,103064,10,103069,10,103070,5,103071,5,103072,10,103073,10,103086,5,103087,5,103088,10,103089,10,103094,11,103095,5,103096,10,103103,5,103104,10,103105,5,103106,10,103121,5,103122,
10,103123,5,103124,5,103125,11,103126,11,103127,5,103128,5,103129,10,103130,10,103131,5,103132,5,103133,10,103134,10,103135,5,103136,5,103137,11,103138,11,103139,5,103140,10,103141,5,103142,10,103143,5,103144,10,103145,5,103146,11,103147,5,103148,5,103149,10,103150,10,103151,5,103152,10,103172,5,103173,10,103174,5,103175,5,103176,10,103177,10,103178,5,103179,5,103180,10,103181,10,103182,5,103183,5,103184,10,103185,10,103228,5,103229,5,103230,10,103231,10,103250,5,103251,10,103252,5,103253,10,103260,
5,103261,5,103262,10,103263,10,103270,5,103271,5,103272,10,103273,10,103274,5,103275,5,103276,10,103277,10,103278,5,103279,5,103280,10,103281,10,103282,5,103283,5,103284,10,103285,10,103286,5,103287,10,103288,5,103289,10,103290,5,103291,10,103292,5,103293,5,103294,10,103295,10,103296,5,103297,5,103298,10,103299,10,103376,10,103377,5,103378,5,103379,10,103380,10,103393,5,103394,5,103395,10,103396,10,103472,5,103473,11,103474,5,103475,10,103482,5,103483,10,103484,5,103485,10,103500,5,103501,10,103502,
5,103503,5,103504,11,103505,11,103506,5,103507,5,103508,10,103509,10,103510,5,103511,5,103512,10,103513,10,103514,5,103515,10,103516,5,103517,10,103518,5,103519,10,103520,5,103521,11,103522,5,103523,5,103524,10,103525,10,103526,5,103527,10,103561,10,103562,10,103563,5,103564,5,103565,10,103566,10,103567,5,103568,5,103569,10,103570,10,103585,10,103586,5,103587,10,103588,11,103589,5,103590,10,103591,11,103592,5,103593,10,103594,11,103695,10,103846,5,103946,10],pcsidc:[[2E3,2045,5],[2056,2065,5],[2067,
2135,5],[2137,2153,5],[2161,2170,5],[2172,2193,5],[2196,2198,5],[2200,2203,5],[2206,2217,5],[2222,2224,11],[2251,2253,11],[2280,2282,11],[2308,2311,5],[2315,2325,5],[2327,2394,5],[2400,2491,5],[2494,2758,5],[2867,2869,11],[2870,2888,10],[2891,2895,10],[2896,2898,11],[2902,2908,10],[2915,2920,10],[2921,2923,11],[2924,2930,10],[2931,2941,5],[2969,2973,5],[2975,2982,5],[2984,2988,5],[2995,3002,5],[3006,3051,5],[3054,3059,5],[3061,3066,5],[3068,3071,5],[3084,3087,5],[3112,3118,5],[3120,3138,5],[3146,
3151,5],[3153,3157,5],[3161,3166,5],[3168,3172,5],[3174,3203,5],[3294,3313,5],[3315,3335,5],[3339,3345,5],[3350,3358,5],[3367,3369,5],[3374,3388,5],[3391,3399,5],[3408,3416,5],[3425,3432,10],[3441,3446,10],[3456,3459,10],[3465,3478,5],[3554,3559,5],[3561,3565,10],[3568,3570,10],[3571,3581,5],[3594,3597,5],[3601,3604,5],[3637,3639,5],[3665,3667,5],[3693,3695,5],[3701,3727,5],[3728,3733,10],[3744,3747,5],[3753,3758,10],[3761,3763,5],[3765,3769,5],[3779,3781,5],[3788,3791,5],[3797,3799,5],[3832,3841,
5],[3844,3852,5],[3873,3885,5],[3890,3893,5],[3942,3950,5],[3968,3970,5],[3973,3976,5],[3986,3989,5],[3994,3997,5],[4390,4398,5],[4399,4413,10],[4418,4433,10],[4491,4554,5],[4568,4589,5],[4652,4656,5],[4766,4800,5],[5069,5072,5],[5105,5130,5],[5180,5184,5],[5253,5259,5],[5269,5275,5],[5292,5311,5],[5343,5349,5],[5355,5357,5],[5387,5389,5],[5459,5463,5],[5479,5482,5],[5530,5539,5],[5550,5552,5],[5562,5583,5],[5623,5625,10],[5631,5639,5],[5649,5653,5],[5663,5680,5],[5682,5685,5],[5875,5877,5],[5896,
5899,5],[5921,5940,5],[6050,6125,5],[6351,6354,5],[6366,6372,5],[6381,6387,5],[6622,6624,5],[6707,6709,5],[6720,6723,5],[6732,6738,5],[6931,6933,5],[7005,7007,5],[7057,7070,10],[7074,7082,5],[7109,7118,5],[7119,7127,11],[7374,7376,5],[7528,7586,5],[7587,7645,10],[7755,7787,5],[7791,7795,5],[7799,7801,5],[7803,7805,5],[7825,7831,5],[7845,7859,5],[8013,8032,5],[8065,8068,11],[8518,8529,10],[8533,8536,10],[8538,8540,10],[8677,8679,5],[8836,8840,5],[8908,8910,5],[9154,9159,5],[9205,9218,5],[20002,20032,
5],[20062,20092,5],[20135,20138,5],[20248,20258,5],[20348,20358,5],[20436,20440,5],[20822,20824,5],[20934,20936,5],[21035,21037,5],[21095,21097,5],[21148,21150,5],[21413,21423,5],[21473,21483,5],[21780,21782,5],[21891,21894,5],[22171,22177,5],[22181,22187,5],[22191,22197,5],[22234,22236,5],[22521,22525,5],[22991,22994,5],[23028,23038,5],[23830,23853,5],[23866,23872,5],[23877,23884,5],[23886,23894,5],[23946,23948,5],[24311,24313,5],[24342,24347,5],[24370,24374,6],[24375,24381,5],[24718,24721,5],[24817,
24821,5],[24877,24882,5],[24891,24893,5],[25391,25395,5],[25828,25838,5],[26191,26195,5],[26391,26393,5],[26703,26722,5],[26729,26760,10],[26766,26798,10],[26860,26870,10],[26891,26899,5],[26903,26923,5],[26929,26946,5],[26948,26998,5],[27037,27040,5],[27205,27232,5],[27258,27260,5],[27391,27398,5],[27561,27564,5],[27571,27574,5],[27581,27584,5],[27591,27594,5],[28191,28193,5],[28348,28358,5],[28402,28432,5],[28462,28492,5],[29118,29122,5],[29177,29185,5],[30161,30179,5],[30491,30494,5],[30729,30732,
5],[31251,31259,5],[31265,31268,5],[31275,31278,5],[31288,31297,5],[31461,31465,5],[31491,31495,5],[31917,31922,5],[31965,31985,5],[31992,32E3,5],[32001,32003,10],[32005,32031,10],[32033,32060,10],[32074,32077,10],[32081,32086,5],[32107,32130,5],[32133,32158,5],[32164,32167,10],[32180,32199,5],[32201,32260,5],[32301,32360,5],[32601,32662,5],[32664,32667,10],[32701,32761,5],[53001,53004,5],[53008,53019,5],[53021,53032,5],[53034,53037,5],[53042,53046,5],[53074,53080,5],[54001,54004,5],[54008,54019,
5],[54021,54032,5],[54034,54037,5],[54042,54046,5],[54048,54053,5],[54074,54080,5],[54098,54101,5],[102001,102040,5],[102042,102063,5],[102065,102067,5],[102070,102112,5],[102114,102117,5],[102122,102208,5],[102210,102216,5],[102221,102300,5],[102304,102377,5],[102382,102388,5],[102389,102398,10],[102399,102444,5],[102445,102447,10],[102448,102458,5],[102459,102468,10],[102469,102496,5],[102500,102519,11],[102520,102524,5],[102525,102529,10],[102530,102549,5],[102557,102588,5],[102593,102598,5],[102601,
102603,5],[102608,102628,5],[102629,102646,10],[102648,102672,10],[102675,102700,10],[102701,102703,5],[102707,102730,10],[102735,102758,10],[102767,102900,5],[102965,102969,5],[102971,102973,5],[102975,102989,5],[102990,102992,11],[102997,103002,5],[103003,103008,10],[103009,103011,5],[103012,103014,10],[103019,103021,5],[103022,103024,10],[103029,103031,5],[103032,103034,10],[103065,103068,5],[103074,103076,5],[103077,103079,11],[103080,103082,5],[103083,103085,10],[103090,103093,5],[103097,103099,
5],[103100,103102,10],[103107,103109,5],[103110,103112,10],[103113,103116,5],[103117,103120,10],[103153,103157,5],[103158,103162,10],[103163,103165,5],[103166,103168,11],[103169,103171,10],[103186,103188,5],[103189,103191,10],[103192,103195,5],[103196,103199,10],[103200,103224,5],[103225,103227,11],[103232,103237,5],[103238,103243,10],[103244,103246,5],[103247,103249,10],[103254,103256,5],[103257,103259,10],[103264,103266,5],[103267,103269,10],[103300,103375,5],[103381,103383,5],[103384,103386,11],
[103387,103389,5],[103390,103392,10],[103397,103399,5],[103400,103471,10],[103476,103478,5],[103479,103481,10],[103486,103488,5],[103489,103491,10],[103492,103495,5],[103496,103499,10],[103539,103543,5],[103544,103548,10],[103549,103551,5],[103552,103554,11],[103555,103557,10],[103558,103560,5],[103571,103573,5],[103574,103576,10],[103577,103580,5],[103581,103583,10],[103595,103597,5],[103600,103694,5],[103696,103698,5],[103700,103793,10],[103794,103799,5]],gcsid:[4001,81,4002,85,4003,70,4004,84,
4005,82,4006,83,4007,60,4008,67,4009,39,4010,57,4011,63,4012,64,4013,64,4014,63,4015,92,4016,90,4018,86,4019,75,4020,68,4021,70,4022,55,4023,75,4024,66,4025,73,4027,95,4028,59,4029,58,4031,75,4032,78,4033,77,4034,65,4035,100,4036,70,4042,88,4044,87,4045,89,4046,75,4047,99,4052,101,4053,97,4054,61,4075,75,4081,75,4120,84,4121,75,4122,80,4123,55,4124,84,4126,75,4130,75,4131,92,4132,64,4133,75,4134,64,4140,75,4141,75,4142,64,4143,64,4144,92,4145,87,4146,89,4147,66,4148,75,4149,84,4150,84,4151,75,4152,
75,4153,55,4154,55,4155,63,4156,84,4157,60,4162,84,4163,75,4164,66,4165,55,4166,75,4168,58,4170,75,4172,75,4173,75,4174,58,4175,64,4176,75,4178,66,4179,66,4180,75,4188,81,4190,75,4191,66,4192,55,4193,63,4198,64,4199,55,4200,66,4201,64,4202,70,4203,70,4204,55,4205,66,4206,63,4207,55,4208,55,4209,64,4210,64,4211,84,4212,64,4213,63,4214,66,4215,55,4216,67,4218,55,4219,84,4220,64,4221,55,4222,64,4224,55,4225,55,4229,68,4230,55,4231,55,4232,64,4234,64,4235,55,4236,55,4237,70,4238,70,4239,92,4240,92,4241,
65,4242,67,4243,88,4244,92,4245,86,4246,64,4250,64,4251,64,4252,63,4253,67,4254,55,4255,55,4256,64,4257,84,4258,75,4259,55,4260,64,4261,106,4262,84,4263,64,4265,55,4266,63,4267,67,4269,75,4270,64,4271,55,4272,55,4273,82,4274,55,4275,63,4276,73,4280,84,4281,57,4282,63,4283,75,4284,66,4285,55,4286,68,4288,55,4289,84,4291,70,4292,55,4293,83,4294,84,4295,84,4296,63,4297,55,4298,90,4299,85,4300,85,4301,84,4302,60,4303,68,4306,84,4307,64,4308,84,4309,55,4310,63,4311,55,4312,84,4313,55,4314,84,4315,63,4316,
55,4317,66,4318,75,4319,75,4322,80,4324,80,4326,75,4466,75,4469,75,4475,55,4483,75,4490,75,4555,66,4558,75,4608,67,4609,67,4610,74,4614,55,4619,75,4624,75,4625,55,4627,75,4636,55,4637,55,4638,67,4639,55,4657,93,4659,75,4660,55,4661,75,4666,84,4667,75,4670,75,4671,63,4674,75,4679,64,4680,64,4682,92,4683,67,4686,75,4687,75,4693,75,4694,75,4695,67,4696,64,4697,64,4702,75,4703,64,4704,55,4705,55,4706,68,4718,55,4720,80,4721,55,4723,67,4726,67,4737,75,4738,60,4740,79,4741,55,4742,75,4743,64,4744,64,4745,
84,4746,84,4747,75,4748,56,4749,75,4750,75,4751,91,4752,56,4753,55,4754,55,4759,75,4761,75,4801,84,4802,55,4803,55,4804,84,4805,84,4806,55,4807,106,4808,84,4809,55,4810,105,4811,106,4816,106,4817,82,4818,84,4820,84,4821,106,4823,55,4824,55,4901,107,4902,107,4903,59,4904,84,5228,84,5229,84,5233,92,5252,75,5264,75,5340,75,5354,75,5360,75,5371,75,5373,75,5381,75,5393,75,5464,60,5467,67,5489,75,5524,55,5527,70,5546,75,5561,66,5593,75,5681,84,5886,75,6135,75,6365,75,6706,75,6881,64,6882,64,6883,55,6892,
64,6894,64,6980,75,6983,75,6987,75,6990,75,7035,75,7037,75,7039,75,7041,75,7073,75,7084,75,7086,75,7133,75,7373,75,7683,76,7798,75,7844,75,7881,75,7886,75,8042,96,8043,96,8086,75,8232,75,8237,75,8240,75,8246,75,8249,75,8252,75,8255,75,8351,84,8427,75,8428,55,8449,75,8545,75,8685,75,8694,64,8699,75,8818,75,8888,75,8900,75,8902,75,8907,75,8949,75,9003,75,9006,75,9009,75,9012,75,9017,75,9068,75,9069,75,9140,75,9148,75,9153,75,37001,73,37002,69,37003,72,37004,71,37005,62,37006,91,37007,94,37008,101,37201,
55,37202,92,37203,87,37204,55,37205,55,37206,64,37207,71,37208,64,37211,64,37220,67,37221,55,37222,55,37223,63,37224,55,37225,106,37226,55,37227,55,37228,64,37229,62,37230,55,37231,70,37232,55,37233,55,37235,55,37237,55,37238,55,37239,67,37240,64,37241,55,37242,55,37243,67,37252,67,37253,55,37254,64,37255,84,37257,66,37259,55,37260,67,104017,79,104018,79,104024,75,104027,75,104047,98,104050,75,104100,75,104101,84,104102,84,104103,64,104104,55,104105,84,104106,55,104107,75,104108,75,104109,67,104110,
75,104111,75,104112,67,104113,67,104128,102,104129,75,104130,55,104131,84,104132,67,104133,75,104134,75,104135,66,104136,70,104137,75,104138,55,104139,106,104140,106,104223,75,104248,55,104256,92,104261,63,104286,75,104287,75,104304,63,104700,49,104701,9,104702,24,104703,15,104704,28,104705,32,104706,53,104707,46,104708,37,104709,54,104710,11,104711,14,104712,30,104713,52,104714,4,104715,4,104716,23,104717,14,104718,48,104719,29,104720,22,104721,21,104722,35,104723,21,104724,46,104725,22,104726,49,
104727,45,104728,52,104729,10,104730,10,104731,21,104732,31,104733,26,104734,40,104735,19,104736,30,104737,34,104738,27,104739,46,104740,5,104741,12,104742,50,104743,9,104744,43,104745,21,104746,26,104747,25,104748,21,104749,7,104750,53,104751,6,104752,33,104753,29,104754,19,104755,41,104756,31,104757,3,104758,41,104759,25,104760,49,104761,41,104762,44,104763,50,104764,46,104765,6,104766,40,104767,16,104768,8,104769,17,104770,48,104771,42,104772,50,104773,25,104774,29,104775,25,104776,32,104777,13,
104778,36,104779,47,104780,14,104781,29,104782,23,104783,38,104784,42,104785,18,104786,20,104808,51,104896,75,104900,112,104901,104,104902,103,104903,116,104904,109,104905,108,104906,169,104907,164,104908,0,104909,168,104910,141,104911,166,104912,114,104913,160,104914,151,104915,117,104916,110,104917,140,104918,115,104919,170,104920,163,104921,154,104922,158,104923,161,104924,148,104925,0,104926,159,104927,167,104928,127,104929,131,104930,145,104931,159,104932,136,104933,123,104934,139,104935,134,
104936,166,104937,150,104938,137,104939,147,104940,121,104941,165,104942,128,104943,111,104944,1,104945,126,104946,152,104947,157,104948,162,104949,153,104950,156,104951,149,104952,132,104953,122,104954,160,104955,146,104956,143,104957,156,104958,120,104959,125,104960,2,104961,144,104962,142,104963,138,104964,155,104965,135,104966,133,104967,151,104968,118,104969,119,104970,124,104971,108,104972,129,104973,130,104974,113,104975,0,104990,84,104991,75,104992,84],gcsidc:[[4127,4129,67],[4135,4139,67],
[4158,4161,55],[4181,4185,55],[4194,4196,55],[4226,4228,63],[4247,4249,55],[4277,4279,81],[4600,4607,64],[4621,4623,55],[4628,4633,55],[4641,4646,55],[4662,4665,55],[4676,4678,66],[4688,4692,55],[4699,4701,64],[4755,4757,75],[4763,4765,75],[4813,4815,84],[8972,8987,75],[37212,37219,55],[37245,37247,55],[37249,37251,55],[104009,104015,75],[104019,104022,75],[104114,104124,75],[104125,104127,55],[104141,104145,75],[104179,104186,75],[104257,104260,75]]},c={c:[[2E3,2035,9001],[2039,2045,9001],[2056,
2062,9001],[2067,2090,9001],[2093,2135,9001],[2161,2165,9001],[2172,2180,9001],[2188,2193,9001],[2195,2198,9001],[2200,2203,9001],[2205,2213,9001],[2215,2217,9001],[2222,2224,9002],[2225,2243,9003],[2246,2250,9003],[2251,2253,9002],[2257,2264,9003],[2274,2279,9003],[2280,2282,9002],[2283,2289,9003],[2308,2313,9001],[2315,2491,9001],[2494,2576,9001],[2578,2599,9001],[2601,2693,9001],[2695,2866,9001],[2867,2869,9002],[2870,2888,9003],[2891,2895,9003],[2896,2898,9002],[2902,2908,9003],[2915,2920,9003],
[2921,2923,9002],[2924,2930,9003],[2931,2933,9001],[2935,2962,9001],[2964,2968,9003],[2969,2973,9001],[2975,2978,9001],[2984,2988,9001],[2995,3051,9001],[3054,3072,9001],[3077,3079,9001],[3081,3088,9001],[3092,3101,9001],[3106,3138,9001],[3146,3151,9001],[3153,3166,9001],[3168,3172,9001],[3174,3203,9001],[3294,3313,9001],[3315,3348,9001],[3350,3358,9001],[3367,3403,9001],[3408,3416,9001],[3417,3438,9003],[3441,3446,9003],[3447,3450,9001],[3451,3453,9003],[3455,3459,9003],[3460,3478,9001],[3554,3559,
9001],[3560,3570,9003],[3571,3581,9001],[3594,3597,9001],[3601,3604,9001],[3637,3639,9001],[3665,3667,9001],[3693,3695,9001],[3701,3727,9001],[3728,3739,9003],[3740,3751,9001],[3753,3760,9003],[3761,3773,9001],[3775,3777,9001],[3779,3781,9001],[3788,3791,9001],[3797,3802,9001],[3814,3816,9001],[3825,3829,9001],[3832,3841,9001],[3844,3852,9001],[3873,3885,9001],[3890,3893,9001],[3942,3950,9001],[3968,3970,9001],[3973,3976,9001],[3986,3989,9001],[3994,3997,9001],[4001,4016,9102],[4018,4025,9102],[4027,
4029,9102],[4031,4036,9102],[4044,4047,9102],[4048,4051,9001],[4052,4054,9102],[4056,4063,9001],[4093,4096,9001],[4120,4124,9102],[4127,4139,9102],[4141,4176,9102],[4178,4185,9102],[4188,4216,9102],[4218,4232,9102],[4235,4260,9102],[4265,4267,9102],[4269,4286,9102],[4292,4304,9102],[4306,4319,9102],[4390,4398,9001],[4399,4413,9003],[4418,4433,9003],[4455,4457,9003],[4484,4489,9001],[4491,4554,9001],[4568,4589,9001],[4600,4630,9102],[4636,4639,9102],[4641,4646,9102],[4652,4656,9001],[4657,4680,9102],
[4682,4684,9102],[4686,4765,9102],[4766,4800,9001],[4801,4806,9102],[4813,4815,9102],[5014,5016,9001],[5069,5072,9001],[5105,5130,9001],[5173,5188,9001],[5253,5259,9001],[5269,5275,9001],[5292,5311,9001],[5329,5331,9001],[5343,5349,9001],[5355,5357,9001],[5459,5463,9001],[5479,5482,9001],[5518,5520,9001],[5533,5539,9001],[5550,5552,9001],[5562,5583,9001],[5623,5625,9003],[5631,5639,9001],[5649,5653,9001],[5663,5680,9001],[5682,5685,9001],[5875,5877,9001],[5896,5899,9001],[5921,5940,9001],[6050,6125,
9001],[6244,6275,9001],[6328,6348,9001],[6350,6356,9001],[6366,6372,9001],[6381,6387,9001],[6393,6404,9001],[6480,6483,9001],[6511,6514,9001],[6579,6581,9001],[6619,6624,9001],[6625,6627,9003],[6628,6632,9001],[6634,6637,9001],[6669,6692,9001],[6707,6709,9001],[6720,6723,9001],[6732,6738,9001],[6881,6883,9102],[6931,6933,9001],[7005,7007,9001],[7057,7070,9003],[7074,7082,9001],[7109,7118,9001],[7119,7127,9002],[7374,7376,9001],[7528,7586,9001],[7587,7645,9003],[7692,7696,9001],[7755,7787,9001],[7791,
7795,9001],[7799,7801,9001],[7803,7805,9001],[7825,7831,9001],[7845,7859,9001],[8013,8032,9001],[8065,8068,9002],[8518,8529,9003],[8533,8536,9003],[8538,8540,9003],[8677,8679,9001],[8836,8840,9001],[8857,8859,9001],[8908,8910,9001],[8972,9E3,9102],[9053,9057,9102],[9059,9069,9102],[9154,9159,9001],[9205,9218,9001],[20002,20032,9001],[20062,20092,9001],[20135,20138,9001],[20248,20258,9001],[20348,20358,9001],[20436,20440,9001],[20822,20824,9001],[20934,20936,9001],[21035,21037,9001],[21095,21097,9001],
[21148,21150,9001],[21413,21423,9001],[21473,21483,9001],[21780,21782,9001],[21896,21899,9001],[22171,22177,9001],[22181,22187,9001],[22191,22197,9001],[22234,22236,9001],[22521,22525,9001],[22991,22994,9001],[23028,23038,9001],[23830,23853,9001],[23866,23872,9001],[23877,23884,9001],[23886,23894,9001],[23946,23948,9001],[24311,24313,9001],[24342,24347,9001],[24370,24374,9084],[24375,24381,9001],[24718,24721,9001],[24817,24821,9001],[24877,24882,9001],[24891,24893,9001],[25391,25395,9001],[25828,
25838,9001],[26191,26195,9001],[26391,26393,9001],[26701,26722,9001],[26729,26746,9003],[26748,26760,9003],[26766,26799,9003],[26847,26870,9003],[26891,26899,9001],[26901,26923,9001],[26929,26946,9001],[26948,26978,9001],[26980,26998,9001],[27037,27040,9001],[27205,27232,9001],[27258,27260,9001],[27391,27398,9001],[27561,27564,9001],[27571,27574,9001],[27581,27584,9001],[27591,27594,9001],[28191,28193,9001],[28348,28358,9001],[28402,28432,9001],[28462,28492,9001],[29168,29172,9001],[29187,29195,9001],
[29901,29903,9001],[30161,30179,9001],[30491,30494,9001],[30729,30732,9001],[31251,31259,9001],[31265,31268,9001],[31275,31277,9001],[31281,31290,9001],[31466,31469,9001],[31491,31495,9001],[31965,32E3,9001],[32001,32003,9003],[32005,32017,9003],[32019,32028,9003],[32033,32035,9003],[32037,32060,9003],[32064,32067,9003],[32081,32086,9001],[32107,32130,9001],[32133,32158,9001],[32164,32167,9003],[32180,32199,9001],[32201,32260,9001],[32301,32360,9001],[32601,32662,9001],[32664,32667,9003],[32701,32761,
9001],[37002,37008,9102],[53001,53004,9001],[53008,53019,9001],[53021,53032,9001],[53034,53037,9001],[53042,53046,9001],[53074,53080,9001],[54001,54004,9001],[54008,54019,9001],[54021,54032,9001],[54042,54046,9001],[54048,54053,9001],[54074,54080,9001],[54098,54101,9001],[102001,102005,9001],[102007,102039,9001],[102042,102045,9001],[102060,102063,9001],[102070,102079,9001],[102096,102099,9001],[102101,102109,9001],[102114,102117,9001],[102132,102138,9001],[102141,102144,9001],[102156,102166,9001],
[102173,102179,9001],[102191,102198,9001],[102221,102228,9001],[102231,102233,9001],[102237,102240,9001],[102364,102375,9001],[102389,102398,9003],[102399,102419,9001],[102421,102438,9001],[102445,102447,9003],[102450,102458,9001],[102459,102462,9003],[102470,102489,9001],[102550,102556,9001],[102562,102588,9001],[102629,102640,9003],[102648,102650,9003],[102688,102690,9003],[102696,102700,9003],[102701,102703,9001],[102799,102900,9001],[103166,103168,9002],[103220,103224,9001],[103225,103227,9002],
[103232,103237,9001],[103238,103243,9003],[103244,103246,9001],[103247,103249,9003],[103254,103256,9001],[103257,103259,9003],[103264,103266,9001],[103267,103269,9003],[103327,103330,9001],[103344,103347,9001],[103372,103375,9001],[103381,103383,9001],[103384,103386,9002],[103387,103389,9001],[103390,103392,9003],[103397,103399,9001],[103427,103430,9003],[103444,103447,9003],[103476,103478,9001],[103479,103481,9003],[103486,103488,9001],[103489,103491,9003],[103492,103495,9001],[103496,103499,9003],
[103539,103543,9001],[103544,103548,9003],[103549,103551,9001],[103552,103554,9002],[103555,103557,9003],[103558,103560,9001],[103571,103573,9001],[103574,103576,9003],[103577,103580,9001],[103581,103583,9003],[103595,103597,9001],[103600,103694,9001],[103696,103698,9001],[103700,103793,9003],[104101,104103,9102],[104126,104131,9102],[104259,104261,9102],[104700,104786,9102],[104900,104975,9102]],nc:[2065,9001,2066,9039,2136,9094,2137,9001,2138,9001,2154,9001,2157,9001,2158,9001,2159,9094,2160,9094,
2169,9001,2170,9001,2204,9003,2219,9001,2220,9001,2254,9003,2255,9003,2256,9002,2265,9002,2266,9002,2267,9003,2268,9003,2269,9002,2270,9002,2271,9003,2272,9003,2273,9002,2290,9001,2294,9001,2295,9001,2314,9005,2899,9003,2900,9003,2901,9002,2909,9002,2910,9002,2911,9003,2912,9003,2913,9002,2914,9002,2980,9001,2981,9001,2991,9001,2992,9002,2993,9001,2994,9002,3074,9001,3075,9001,3080,9002,3089,9003,3090,9001,3091,9003,3102,9003,3141,9001,3142,9001,3167,9301,3360,9001,3361,9002,3362,9001,3363,9003,3364,
9001,3365,9003,3404,9003,3405,9001,3406,9001,3407,9005,3439,9001,3440,9001,3479,9002,3480,9001,3481,9002,3482,9001,3483,9002,3484,9001,3485,9003,3486,9001,3487,9003,3488,9001,3489,9001,3490,9003,3491,9001,3492,9003,3493,9001,3494,9003,3495,9001,3496,9003,3497,9001,3498,9003,3499,9001,3500,9003,3501,9001,3502,9003,3503,9001,3504,9003,3505,9001,3506,9003,3507,9001,3508,9003,3509,9001,3510,9003,3511,9001,3512,9003,3513,9001,3514,9001,3515,9003,3516,9001,3517,9003,3518,9001,3519,9003,3520,9001,3521,9003,
3522,9001,3523,9003,3524,9001,3525,9003,3526,9001,3527,9003,3528,9001,3529,9003,3530,9001,3531,9003,3532,9001,3533,9003,3534,9001,3535,9003,3536,9001,3537,9003,3538,9001,3539,9003,3540,9001,3541,9003,3542,9001,3543,9003,3544,9001,3545,9003,3546,9001,3547,9003,3548,9001,3549,9003,3550,9001,3551,9003,3552,9001,3553,9003,3582,9003,3583,9001,3584,9003,3585,9001,3586,9003,3587,9001,3588,9002,3589,9001,3590,9002,3591,9001,3592,9001,3593,9002,3598,9003,3599,9001,3600,9003,3605,9002,3606,9001,3607,9001,3608,
9003,3609,9001,3610,9003,3611,9001,3612,9003,3613,9001,3614,9003,3615,9001,3616,9003,3617,9001,3618,9003,3619,9001,3620,9003,3621,9001,3622,9003,3623,9001,3624,9003,3625,9001,3626,9003,3627,9001,3628,9003,3629,9001,3630,9003,3631,9001,3632,9003,3633,9001,3634,9002,3635,9001,3636,9002,3640,9003,3641,9001,3642,9003,3643,9001,3644,9002,3645,9001,3646,9002,3647,9001,3648,9002,3649,9001,3650,9003,3651,9001,3652,9003,3653,9001,3654,9003,3655,9001,3656,9002,3657,9001,3658,9003,3659,9001,3660,9003,3661,9001,
3662,9003,3663,9001,3664,9003,3668,9003,3669,9001,3670,9003,3671,9001,3672,9003,3673,9001,3674,9003,3675,9001,3676,9002,3677,9003,3678,9001,3679,9002,3680,9003,3681,9001,3682,9002,3683,9003,3684,9001,3685,9001,3686,9003,3687,9001,3688,9003,3689,9001,3690,9003,3691,9001,3692,9003,3696,9003,3697,9001,3698,9003,3699,9001,3700,9003,3783,9001,3784,9001,3793,9001,3794,9001,3812,9001,3819,9102,3821,9102,3824,9102,3854,9001,3857,9001,3889,9102,3906,9102,3911,9001,3912,9001,3920,9001,3978,9001,3979,9001,3991,
9003,3992,9003,4026,9001,4037,9001,4038,9001,4042,9102,4071,9001,4075,9102,4081,9102,4082,9001,4083,9001,4087,9001,4088,9001,4217,9003,4261,9105,4262,9102,4263,9102,4288,9102,4289,9102,4322,9102,4324,9102,4326,9102,4414,9001,4415,9001,4417,9001,4434,9001,4437,9001,4438,9003,4439,9003,4462,9001,4463,9102,4467,9001,4470,9102,4471,9001,4475,9102,4483,9102,4490,9102,4555,9102,4558,9102,4559,9001,4632,9102,4633,9102,4647,9001,4807,9105,4808,9102,4809,9102,4810,9105,4811,9105,4816,9105,4817,9102,4818,9102,
4820,9102,4821,9105,4822,9001,4823,9102,4824,9102,4826,9001,4839,9001,4901,9105,4902,9105,4903,9102,4904,9102,5013,9102,5018,9001,5048,9001,5167,9001,5168,9001,5221,9001,5223,9001,5228,9102,5229,9102,5233,9102,5234,9001,5235,9001,5243,9001,5246,9102,5247,9001,5252,9102,5264,9102,5266,9001,5316,9001,5320,9001,5321,9001,5324,9102,5325,9001,5337,9001,5340,9102,5354,9102,5360,9102,5361,9001,5362,9001,5365,9102,5367,9001,5371,9102,5373,9102,5381,9102,5382,9001,5383,9001,5387,9001,5389,9001,5393,9102,5396,
9001,5451,9102,5456,9001,5457,9001,5464,9102,5467,9102,5469,9001,5472,9037,5489,9102,5490,9001,5513,9001,5514,9001,5523,9001,5524,9102,5527,9102,5530,9001,5531,9001,5546,9102,5559,9001,5561,9102,5588,9002,5589,9005,5593,9102,5596,9001,5627,9001,5629,9001,5641,9001,5643,9001,5644,9001,5646,9003,5654,9003,5655,9003,5659,9001,5681,9102,5700,9001,5825,9001,5836,9001,5837,9001,5839,9001,5842,9001,5844,9001,5858,9001,5879,9001,5880,9001,5886,9102,5887,9001,5890,9001,6128,9002,6129,9002,6135,9102,6204,9001,
6207,9102,6210,9001,6211,9001,6307,9001,6311,9102,6312,9001,6316,9001,6318,9102,6322,9102,6325,9102,6362,9001,6365,9102,6391,9002,6405,9002,6406,9001,6407,9002,6408,9001,6409,9002,6410,9001,6411,9003,6412,9001,6413,9003,6414,9001,6415,9001,6416,9003,6417,9001,6418,9003,6419,9001,6420,9003,6421,9001,6422,9003,6423,9001,6424,9003,6425,9001,6426,9003,6427,9001,6428,9003,6429,9001,6430,9003,6431,9001,6432,9003,6433,9001,6434,9003,6435,9001,6436,9003,6437,9001,6438,9003,6439,9001,6440,9001,6441,9003,6442,
9001,6443,9003,6444,9001,6445,9003,6446,9001,6447,9003,6448,9001,6449,9003,6450,9001,6451,9003,6452,9001,6453,9003,6454,9001,6455,9003,6456,9001,6457,9003,6458,9001,6459,9003,6460,9001,6461,9003,6462,9001,6463,9003,6464,9001,6465,9003,6466,9001,6467,9003,6468,9001,6469,9003,6470,9001,6471,9003,6472,9001,6473,9003,6474,9001,6475,9003,6476,9001,6477,9003,6478,9001,6479,9003,6484,9003,6485,9001,6486,9003,6487,9001,6488,9003,6489,9001,6490,9003,6491,9001,6492,9003,6493,9001,6494,9002,6495,9001,6496,9002,
6497,9001,6498,9001,6499,9002,6500,9001,6501,9003,6502,9001,6503,9003,6504,9001,6505,9003,6506,9001,6507,9003,6508,9001,6509,9001,6510,9003,6515,9002,6516,9001,6518,9001,6519,9003,6520,9001,6521,9003,6522,9001,6523,9003,6524,9001,6525,9003,6526,9001,6527,9003,6528,9001,6529,9003,6530,9001,6531,9003,6532,9001,6533,9003,6534,9001,6535,9003,6536,9001,6537,9003,6538,9001,6539,9003,6540,9001,6541,9003,6542,9001,6543,9003,6544,9001,6545,9002,6546,9001,6547,9002,6548,9001,6549,9003,6550,9001,6551,9003,6552,
9001,6553,9003,6554,9001,6555,9003,6556,9001,6557,9002,6558,9001,6559,9002,6560,9001,6561,9002,6562,9001,6563,9003,6564,9001,6565,9003,6566,9001,6567,9001,6568,9003,6569,9001,6570,9002,6571,9001,6572,9003,6573,9001,6574,9003,6575,9001,6576,9003,6577,9001,6578,9003,6582,9003,6583,9001,6584,9003,6585,9001,6586,9003,6587,9001,6588,9003,6589,9001,6590,9003,6591,9001,6592,9001,6593,9003,6594,9001,6595,9003,6596,9001,6597,9003,6598,9001,6599,9003,6600,9001,6601,9003,6602,9001,6603,9003,6605,9003,6606,9001,
6607,9003,6608,9001,6609,9003,6610,9001,6611,9001,6612,9003,6613,9001,6614,9003,6615,9001,6616,9003,6617,9001,6618,9003,6633,9003,6646,9001,6668,9102,6703,9001,6706,9102,6783,9102,6784,9001,6785,9002,6786,9001,6787,9002,6788,9001,6789,9002,6790,9001,6791,9002,6792,9001,6793,9002,6794,9001,6795,9002,6796,9001,6797,9002,6798,9001,6799,9002,6800,9001,6801,9002,6802,9001,6803,9002,6804,9001,6805,9002,6806,9001,6807,9002,6808,9001,6809,9002,6810,9001,6811,9002,6812,9001,6813,9002,6814,9001,6815,9002,6816,
9001,6817,9002,6818,9001,6819,9002,6820,9001,6821,9002,6822,9001,6823,9002,6824,9001,6825,9002,6826,9001,6827,9002,6828,9001,6829,9002,6830,9001,6831,9002,6832,9001,6833,9002,6834,9001,6835,9002,6836,9001,6837,9002,6838,9001,6839,9002,6840,9001,6841,9002,6842,9001,6843,9002,6844,9001,6845,9002,6846,9001,6847,9002,6848,9001,6849,9002,6850,9001,6851,9002,6852,9001,6853,9002,6854,9001,6855,9002,6856,9001,6857,9002,6858,9001,6859,9002,6860,9001,6861,9002,6862,9001,6863,9002,6867,9001,6868,9002,6870,9001,
6875,9001,6876,9001,6879,9001,6880,9003,6884,9001,6885,9002,6886,9001,6887,9002,6892,9102,6894,9102,6915,9001,6922,9001,6923,9003,6924,9001,6925,9003,6962,9001,6983,9102,6984,9001,6990,9102,6991,9001,7035,9102,7037,9102,7039,9102,7041,9102,7073,9102,7084,9102,7086,9102,7128,9003,7131,9001,7132,9003,7133,9102,7136,9102,7139,9102,7142,9001,7257,9001,7258,9003,7259,9001,7260,9003,7261,9001,7262,9003,7263,9001,7264,9003,7265,9001,7266,9003,7267,9001,7268,9003,7269,9001,7270,9003,7271,9001,7272,9003,7273,
9001,7274,9003,7275,9001,7276,9003,7277,9001,7278,9003,7279,9001,7280,9003,7281,9001,7282,9003,7283,9001,7284,9003,7285,9001,7286,9003,7287,9001,7288,9003,7289,9001,7290,9003,7291,9001,7292,9003,7293,9001,7294,9003,7295,9001,7296,9003,7297,9001,7298,9003,7299,9001,7300,9003,7301,9001,7302,9003,7303,9001,7304,9003,7305,9001,7306,9003,7307,9001,7308,9003,7309,9001,7310,9003,7311,9001,7312,9003,7313,9001,7314,9003,7315,9001,7316,9003,7317,9001,7318,9003,7319,9001,7320,9003,7321,9001,7322,9003,7323,9001,
7324,9003,7325,9001,7326,9003,7327,9001,7328,9003,7329,9001,7330,9003,7331,9001,7332,9003,7333,9001,7334,9003,7335,9001,7336,9003,7337,9001,7338,9003,7339,9001,7340,9003,7341,9001,7342,9003,7343,9001,7344,9003,7345,9001,7346,9003,7347,9001,7348,9003,7349,9001,7350,9003,7351,9001,7352,9003,7353,9001,7354,9003,7355,9001,7356,9003,7357,9001,7358,9003,7359,9001,7360,9003,7361,9001,7362,9003,7363,9001,7364,9003,7365,9001,7366,9003,7367,9001,7368,9003,7369,9001,7370,9003,7373,9102,7683,9102,7798,9102,7844,
9102,7877,9001,7878,9001,7881,9102,7882,9001,7883,9001,7886,9102,7887,9001,7899,9001,7991,9001,7992,9001,8035,9003,8036,9003,8042,9102,8043,9102,8058,9001,8059,9001,8082,9001,8083,9001,8086,9102,8088,9001,8090,9001,8091,9003,8092,9001,8093,9003,8095,9001,8096,9003,8097,9001,8098,9003,8099,9001,8100,9003,8101,9001,8102,9003,8103,9001,8104,9003,8105,9001,8106,9003,8107,9001,8108,9003,8109,9001,8110,9003,8111,9001,8112,9003,8113,9001,8114,9003,8115,9001,8116,9003,8117,9001,8118,9003,8119,9001,8120,9003,
8121,9001,8122,9003,8123,9001,8124,9003,8125,9001,8126,9003,8127,9001,8128,9003,8129,9001,8130,9003,8131,9001,8132,9003,8133,9001,8134,9003,8135,9001,8136,9003,8137,9001,8138,9003,8139,9001,8140,9003,8141,9001,8142,9003,8143,9001,8144,9003,8145,9001,8146,9003,8147,9001,8148,9003,8149,9001,8150,9003,8151,9001,8152,9003,8153,9001,8154,9003,8155,9001,8156,9003,8157,9001,8158,9003,8159,9001,8160,9003,8161,9001,8162,9003,8163,9001,8164,9003,8165,9001,8166,9003,8167,9001,8168,9003,8169,9001,8170,9003,8171,
9001,8172,9003,8173,9001,8177,9003,8179,9001,8180,9003,8181,9001,8182,9003,8184,9001,8185,9003,8187,9001,8189,9003,8191,9001,8193,9003,8196,9001,8197,9003,8198,9001,8200,9003,8201,9001,8202,9003,8203,9001,8204,9003,8205,9001,8206,9003,8207,9001,8208,9003,8209,9001,8210,9003,8212,9001,8213,9003,8214,9001,8216,9003,8218,9001,8220,9003,8222,9001,8224,9003,8225,9001,8226,9003,8232,9102,8237,9102,8240,9102,8246,9102,8249,9102,8252,9102,8255,9102,8311,9001,8312,9002,8313,9001,8314,9002,8315,9001,8316,9002,
8317,9001,8318,9002,8319,9001,8320,9002,8321,9001,8322,9002,8323,9001,8324,9002,8325,9001,8326,9002,8327,9001,8328,9002,8329,9001,8330,9002,8331,9001,8332,9002,8333,9001,8334,9002,8335,9001,8336,9002,8337,9001,8338,9002,8339,9001,8340,9002,8341,9001,8342,9002,8343,9001,8344,9002,8345,9001,8346,9002,8347,9001,8348,9002,8351,9102,8352,9001,8353,9001,8379,9001,8380,9003,8381,9001,8382,9003,8383,9001,8384,9003,8385,9001,8387,9003,8391,9001,8395,9001,8427,9102,8428,9102,8431,9102,8433,9001,8441,9001,8455,
9001,8456,9001,8531,9003,8545,9102,8682,9001,8685,9102,8687,9001,8692,9001,8693,9001,8694,9102,8699,9102,8818,9102,8826,9001,8860,9102,8888,9102,8900,9102,8902,9102,8903,9001,8907,9102,8949,9102,8950,9001,8951,9001,9003,9102,9006,9102,9009,9102,9012,9102,9014,9102,9017,9102,9019,9102,9039,9001,9040,9001,9140,9102,9141,9001,9148,9102,9149,9001,9150,9001,9153,9102,9191,9001,9221,9001,9222,9001,20499,9001,20538,9001,20539,9001,20790,9001,20791,9001,21291,9001,21292,9001,21500,9001,21817,9001,21818,9001,
22032,9001,22033,9001,22091,9001,22092,9001,22332,9001,22391,9001,22392,9001,22700,9001,22770,9001,22780,9001,22832,9001,23090,9001,23095,9001,23239,9001,23240,9001,23700,9001,24047,9001,24048,9001,24100,9005,24200,9001,24305,9001,24306,9001,24382,9084,24383,9001,24500,9001,24547,9001,24548,9001,24571,9062,24600,9001,25E3,9001,25231,9001,25884,9001,25932,9001,26237,9001,26331,9001,26332,9001,26591,9001,26592,9001,26632,9001,26692,9001,27120,9001,27200,9001,27291,9040,27292,9040,27429,9001,27493,9001,
27500,9001,27700,9001,28232,9001,28600,9001,28991,9001,28992,9001,29101,9001,29220,9001,29221,9001,29333,9001,29635,9001,29636,9001,29701,9001,29738,9001,29739,9001,29849,9001,29850,9001,29871,9042,29872,9041,29873,9001,30200,9039,30339,9001,30340,9001,30791,9001,30792,9001,31028,9001,31121,9001,31154,9001,31170,9001,31171,9001,31279,9001,31370,9001,31528,9001,31529,9001,31600,9001,31700,9001,31838,9001,31839,9001,31901,9001,32030,9003,32031,9003,32061,9001,32062,9001,32098,9001,32099,9003,32100,
9001,32104,9001,32161,9001,32766,9001,37202,9102,37203,9102,37206,9102,37207,9102,37218,9102,37221,9102,37225,9105,37240,9102,37241,9102,37243,9102,37245,9102,37249,9102,37257,9102,37260,9102,53048,9001,53049,9001,54034,9001,54090,9001,54091,9001,65061,9003,65062,9003,65161,9001,102041,9003,102064,9085,102068,109030,102069,109031,102093,9001,102094,9001,102118,9003,102120,9003,102121,9003,102122,9001,102150,9001,102168,9001,102204,9001,102212,9001,102213,9001,102215,9001,102216,9001,102217,9003,102218,
9001,102219,9003,102220,9003,102247,9001,102299,9001,102306,9001,102319,9001,102328,9001,102329,9001,102359,9001,102360,9001,102440,9001,102448,9001,102464,9003,102465,9003,102491,9001,102492,9001,102498,9001,102499,9001,102525,9003,102526,9003,102528,9003,102529,9003,102589,9003,102598,9001,102599,9003,102600,9003,102604,9003,102661,9003,102662,9003,102664,9003,102665,9003,102705,9003,102720,9003,102721,9003,102726,9003,102727,9003,102733,9003,102761,9003,102766,9003,102974,9003,103228,9001,103229,
9001,103230,9003,103231,9003,103250,9001,103251,9003,103252,9001,103253,9003,103260,9001,103261,9001,103262,9003,103263,9003,103270,9001,103271,9001,103272,9003,103273,9003,103274,9001,103275,9001,103276,9003,103277,9003,103278,9001,103279,9001,103280,9003,103281,9003,103282,9001,103283,9001,103284,9003,103285,9003,103286,9001,103287,9003,103288,9001,103289,9003,103290,9001,103291,9003,103292,9001,103293,9001,103294,9003,103295,9003,103296,9001,103297,9001,103298,9003,103299,9003,103300,9001,103307,
9001,103313,9001,103319,9001,103322,9001,103323,9001,103332,9001,103335,9001,103338,9001,103340,9001,103351,9001,103358,9001,103370,9001,103376,9003,103377,9001,103378,9001,103379,9003,103380,9003,103393,9001,103394,9001,103395,9003,103396,9003,103400,9003,103407,9003,103413,9003,103419,9003,103422,9003,103423,9003,103432,9003,103435,9003,103438,9003,103440,9003,103451,9003,103458,9003,103470,9003,103472,9001,103473,9002,103474,9001,103475,9003,103482,9001,103483,9003,103484,9001,103485,9003,103500,
9001,103501,9003,103502,9001,103503,9001,103504,9002,103505,9002,103506,9001,103507,9001,103508,9003,103509,9003,103510,9001,103511,9001,103512,9003,103513,9003,103514,9001,103515,9003,103516,9001,103517,9003,103518,9001,103519,9003,103520,9001,103521,9002,103522,9001,103523,9001,103524,9003,103525,9003,103526,9001,103527,9003,103561,9003,103562,9003,103563,9001,103564,9001,103565,9003,103566,9003,103567,9001,103568,9001,103569,9003,103570,9003,103585,9003,103586,9001,103587,9003,103588,9002,103589,
9001,103590,9003,103591,9002,103592,9001,103593,9003,103594,9002,103695,9003,103846,9001,103946,9003,104009,9102,104017,9102,104018,9102,104022,9102,104024,9102,104027,9102,104047,9102,104050,9102,104105,9102,104106,9102,104109,9102,104112,9102,104113,9102,104134,9102,104135,9102,104138,9102,104139,9105,104140,9105,104808,9102]},d=function(){function a(){}a.Dz=function(b){!1===a.Ej&&a.Om();var c=a.uM(b);if(-1==c){var d=a.uv(b);d!=b&&(c=a.Dz(d))}-1==c&&(d=a.nL(b),d!=b&&(c=a.Dz(d)));return c};a.uM=
function(b){return void 0!==a.Yu[b]?a.Yu[b]:-1};a.SR=function(b){!1===a.Ej&&a.Om();var c=a.qE(b);if(1E38==c){var d=a.uv(b);d!=b&&(c=a.qE(d));if(1E38==c)return 1E-10}return c};a.uU=function(b){if(void 0!==a.Al[b])return!0;var c=a.uv(b);return c!=b&&void 0!==a.Al[c]?!0:!1};a.wU=function(b){if(void 0!==a.Yg[b])return!0;var c=a.uv(b);return c!=b&&void 0!==a.Yg[c]?!0:!1};a.qE=function(b){!1===a.Ej&&a.Om();return void 0!==a.Al[b]?a.Al[b]:void 0!==a.Yg[b]?a.Yg[b]:1E38};a.nL=function(b){!1===a.Ej&&a.Om();
return void 0!==a.MB[b]?a.MB[b]:b};a.uv=function(b){!1===a.Ej&&a.Om();return void 0!==a.NB[b]?a.NB[b]:b};a.Om=function(){for(var d=b,h,e=0;e<d.pcsid.length;e+=2)a.Yg[d.pcsid[e]]=d.pcstol[2*d.pcsid[e+1]+1];for(e=0;e<d.pcsidc.length;e+=1){h=d.pcsidc[e];for(var f=h[0];f<=h[1];f++)a.Yg[f]=d.pcstol[2*h[2]+1]}for(e=0;e<d.gcsid.length;e+=2)a.Al[d.gcsid[e]]=d.gcstol[2*d.gcsid[e+1]+1];for(e=0;e<d.gcsidc.length;e+=1)for(h=d.gcsidc[e],f=h[0];f<=h[1];f++)a.Yg[f]=d.gcstol[2*h[2]+1];for(e=0;e<c.c.length;e+=1)for(h=
c.c[e],f=h[0];f<=h[1];f++)a.Yu[f]=h[2];for(e=0;e<c.nc.length;e+=2)a.Yu[c.nc[e]]=c.nc[e+1];c=null;for(e=0;e<d.newtoold.length;e+=2)a.MB[d.newtoold[e+1]]=d.newtoold[e],a.NB[d.newtoold[e]]=d.newtoold[e+1];b=null;a.Ej=!0};a.Ej=!1;a.Al=[];a.Yg=[];a.MB=[];a.NB=[];a.Yu=[];return a}();a.ss=d})(C||(C={}));(function(a){function b(a){return 0===a.length?'""':'"'==a[0]||"."==a[0]||"0"<=a[0]&&"9">=a[0]?a:'"'+a.trim()+'"'}var c=[],d=function(){function d(){}d.UR=function(h){try{for(var p=0;p<c.length;p++)if(c[p].wkttext===
h)return c[p].unit;for(var e,f=p="",n=!1,g=0;g<h.length;g++){var w=h[g];!0===n?'"'==w?'"'==h[g+1]?p+=w:n=!1:p+=w:/[\s]/.test(w)||(","==w?(f=""!==p?f+(b(p)+","):f+",",p=""):")"==w||"]"==w?(f=""!==p?f+(b(p)+"]}"):f+"]}",p=""):"("==w||"["==w?(f+='{ "entity": "'+p.toUpperCase().trim()+'", "values":[',p=""):'"'==w?(n=!0,p=""):p+=w)}e=JSON.parse(f);var k=d.oE(e);if(null===k)return null;e=null;for(w=0;w<k.values.length;w++)if("object"===typeof k.values[w]&&"UNIT"===k.values[w].entity){e=k.values[w];break}if(null===
e)return null;var l=a.$c.yQ("GEOGCS"===k.entity?1:0,e.values[1],e.values[2]);c.push({wkttext:h,unit:l});10<c.length&&c.shift();return l}catch(ya){return null}};d.oE=function(a){if(null===a)return null;if("GEOGCS"===a.entity||"PROJCS"===a.entity)return a;for(var b=[],c=0;c<a.values.length;c++)if("object"===typeof a.values[c]&&void 0!==a.values[c].entity){if("GEOGCS"===a.values[c].entity||"PROJCS"==a.values[c].entity)return a.values[c];b.push(a.values[c])}for(a=0;a<b.length;a++)if(c=d.oE(b[a]),null!==
c)return c;return null};d.TR=function(a){var b=-1;if(null!=a&&0<a.length){var c,d;c=a.indexOf("PROJCS");if(0<=c){var h=0;c=a.lastIndexOf("UNIT");if(0<=c&&(c=a.indexOf(",",c+4),0<c&&(c++,d=a.indexOf("]",c+1),0<d)))try{h=parseFloat(a.substring(c,d))}catch(U){h=0}0<h&&(b=.001/h)}else if(c=a.indexOf("GEOGCS"),0<=c){var p=0,h=0;c=a.indexOf("SPHEROID",c+6);if(0<c&&(c=a.indexOf(",",c+8),0<c)){c++;d=a.indexOf(",",c+1);if(0<d)try{p=parseFloat(a.substring(c,d))}catch(U){p=0}if(0<p&&(c=a.indexOf("UNIT",d+1),
0<=c&&(c=a.indexOf(",",c+4),0<c&&(c++,d=a.indexOf("]",c+1),0<d))))try{h=parseFloat(a.substring(c,d))}catch(U){h=0}}0<p&&0<h&&(b=.001/(p*h))}}return b};return d}();a.uE=d})(C||(C={}));(function(a){(function(a){a[a.NONE=0]="NONE";a[a.LINEAR=1]="LINEAR";a[a.ANGULAR=2]="ANGULAR"})(a.oM||(a.oM={}));(function(a){a[a.enumFloat=0]="enumFloat";a[a.enumDouble=1]="enumDouble";a[a.enumInt32=2]="enumInt32";a[a.enumInt64=3]="enumInt64";a[a.enumInt8=4]="enumInt8";a[a.enumInt16=5]="enumInt16"})(a.iN||(a.iN={}));
(function(a){a[a.POSITION=0]="POSITION";a[a.Z=1]="Z";a[a.M=2]="M";a[a.ID=3]="ID";a[a.NORMAL=4]="NORMAL";a[a.TEXTURE1D=5]="TEXTURE1D";a[a.TEXTURE2D=6]="TEXTURE2D";a[a.TEXTURE3D=7]="TEXTURE3D";a[a.ID2=8]="ID2";a[a.MAXSEMANTICS=10]="MAXSEMANTICS"})(a.hi||(a.hi={}));var b=function(){function b(a,c){this.St=this.Ye=null;this.Er=this.Ga=0;this.Th=this.vg=null;this.gm=0;if(void 0!==c){this.Ga=c.Ga;this.Er=c.Er;this.vg=c.vg.slice(0);this.Th=c.Th.slice(0);this.gm=c.gm;this.St=[];for(c=a=0;c<this.Ga;c++)this.St[c]=
a,a+=b.Xa(this.vg[c]);this.Er=a;this.Ye=[];for(c=0;c<this.Ga;c++){a=b.Xa(this.pd(c));for(var d=b.be(this.pd(c)),h=0;h<a;h++)this.Ye[this.St[c]+h]=d}}else this.Er=this.Ga=0}b.prototype.pd=function(b){if(0>b||b>this.Ga)throw a.g.F();return this.vg[b]};b.prototype.lg=function(a){return this.Th[a]};b.Zz=function(a){return b.dc[a]};b.ti=function(a){return b.ad[a]};b.lf=function(a){return b.de[a]};b.Yg=function(a){return b.lf(b.ti(a))*b.Xa(a)};b.Xa=function(a){return b.tb[a]};b.Xf=function(a){return 2>
a};b.Dj=function(a){return b.Xf(b.ti(a))};b.prototype.hasAttribute=function(a){return 0<=this.Th[a]};b.prototype.kH=function(){return this.hasAttribute(1)};b.be=function(a){return b.N[a]};b.prototype.eT=function(a){return this.St[a]};b.DH=function(a,c){return b.N[a]===c};b.Ug=function(b){if(4==b)return 2;if(8==b)return 3;throw a.g.F();};b.prototype.Eb=function(a){return this===a};b.prototype.Ck=function(){for(var b=a.J.bh(this.vg[0]),c=1;c<this.Ga;c++)b=a.J.bh(this.vg[c],b);return b};b.prototype.zk=
function(a){return this.St[a]};b.prototype.kc=function(){return this.gm};b.prototype.Qd=function(a){return this.vg[a]};b.N=[0,0,NaN,0,0,0,0,0,0];b.dc=[1,1,1,0,2,1,1,1,0];b.ad=[1,1,1,2,0,0,0,0,2];b.de=[4,8,4,8,1,2];b.tb=[2,1,1,1,3,1,2,3,2];return b}();a.ma=b})(C||(C={}));(function(a){function b(a,b,d,h){var p=a.Id,e=a.e+b+1;1===d?h=5<=p[e]:2===d?h=5<p[e]||5==p[e]&&(h||0>e||void 0!==p[e+1]||p[e-1]&1):3===d?h=h||void 0!==p[e]||0>e:(h=!1,0!==d&&c("!Big.RM!"));if(1>e||!p[0])h?(a.e=-b,a.Id=[1]):a.Id=[a.e=
0];else{p.length=e--;if(h)for(;9<++p[e];)p[e]=0,e--||(++a.e,p.unshift(1));for(e=p.length;!p[--e];p.pop());}}function c(a){a=Error(a);a.name="BigError";throw a;}var d=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,h=function(){function a(b){if(b instanceof a)this.ke=b.ke,this.e=b.e,this.Id=b.Id.slice();else{var h,p,e;0===b&&0>1/b?b="-0":d.test(b+="")||c(NaN);this.ke="-"==b.charAt(0)?(b=b.slice(1),-1):1;-1<(h=b.indexOf("."))&&(b=b.replace(".",""));0<(p=b.search(/e/i))?(0>h&&(h=p),h+=+b.slice(p+1),b=b.substring(0,
p)):0>h&&(h=b.length);for(p=0;"0"==b.charAt(p);p++);if(p==(e=b.length))this.Id=[this.e=0];else{for(;"0"==b.charAt(--e););this.e=h-p-1;this.Id=[];for(h=0;p<=e;this.Id[h++]=+b.charAt(p++));}}}a.prototype.abs=function(){var b=new a(this);b.ke=1;return b};a.prototype.RF=function(){var b=0,c=this.Id,d=(b=new a(b)).Id,h=this.ke,p=b.ke,e=this.e,f=b.e;if(!c[0]||!d[0])return c[0]?h:d[0]?-p:0;if(h!=p)return h;b=0>h;if(e!=f)return e>(f^b)?1:-1;h=-1;for(p=(e=c.length)<(f=d.length)?e:f;++h<p;)if(c[h]!=d[h])return c[h]>
(d[h]^b)?1:-1;return e==f?0:e>(f^b)?1:-1};a.prototype.bn=function(d){var h=this.Id,p=(d=new a(d)).Id,e=this.ke==d.ke?1:-1,f=a.ad;(f!==~~f||0>f||1E6<f)&&c("!Big.DP!");if(!h[0]||!p[0])return h[0]==p[0]&&c(NaN),p[0]||c(e/0),new a(0*e);var n,y,g,w,k=p.slice(),l=n=p.length,m=h.length,q=h.slice(0,n),r=q.length,I=d,t=I.Id=[],u=0,v=f+(I.e=this.e-d.e)+1;I.ke=e;e=0>v?0:v;for(k.unshift(0);r++<n;q.push(0));do{for(y=0;10>y;y++){if(n!=(r=q.length))g=n>r?1:-1;else for(w=-1,g=0;++w<n;)if(p[w]!=q[w]){g=p[w]>q[w]?
1:-1;break}if(0>g){for(d=r==n?p:k;r;){if(q[--r]<d[r]){for(w=r;w&&!q[--w];q[w]=9);--q[w];q[r]+=10}q[r]-=d[r]}for(;!q[0];q.shift());}else break}t[u++]=g?y:++y;q[0]&&g?q[r]=h[l]||0:q=[h[l]]}while((l++<m||void 0!==q[0])&&e--);t[0]||1==u||(t.shift(),I.e--);u>v&&b(I,f,a.Xf,void 0!==q[0]);return I};a.prototype.BT=function(){return 0<this.RF()};a.prototype.SU=function(){return 0>this.RF()};a.prototype.au=function(b){var c,d,h=this.ke,p=(b=new a(b)).ke;if(h!=p)return b.ke=-p,this.sJ(b);var e=this.Id.slice();
d=this.e;var f=b.Id,n=b.e;if(!e[0]||!f[0])return f[0]?(b.ke=-p,b):new a(e[0]?this:0);if(h=d-n){(c=0>h)?(h=-h,d=e):(n=d,d=f);d.reverse();for(p=h;p--;d.push(0));d.reverse()}else for(d=((c=e.length<f.length)?e:f).length,h=p=0;p<d;p++)if(e[p]!=f[p]){c=e[p]<f[p];break}c&&(d=e,e=f,f=d,b.ke=-b.ke);if(0<(p=(d=f.length)-(c=e.length)))for(;p--;e[c++]=0);for(p=c;d>h;){if(e[--d]<f[d]){for(c=d;c&&!e[--c];e[c]=9);--e[c];e[d]+=10}e[d]-=f[d]}for(;0==e[--p];e.pop());for(;0==e[0];)e.shift(),--n;e[0]||(b.ke=1,e=[n=
0]);b.Id=e;b.e=n;return b};a.prototype.sJ=function(b){var c,d=this.ke;c=(b=new a(b)).ke;if(d!=c)return b.ke=-c,this.au(b);c=this.e;var h=this.Id,p=b.e,e=b.Id;if(!h[0]||!e[0])return e[0]?b:new a(h[0]?this:0*d);h=h.slice();if(d=c-p){0<d?(p=c,c=e):(d=-d,c=h);for(c.reverse();d--;c.push(0));c.reverse()}0>h.length-e.length&&(c=e,e=h,h=c);d=e.length;for(c=0;d;)c=(h[--d]=h[d]+e[d]+c)/10|0,h[d]%=10;c&&(h.unshift(c),++p);for(d=h.length;0==h[--d];h.pop());b.Id=h;b.e=p;return b};a.prototype.pow=function(b){var d=
this,h=new a(1),p=h,e=0>b;(b!==~~b||-1E6>b||1E6<b)&&c("!pow!");for(b=e?-b:b;;){b&1&&(p=p.cs(d));b>>=1;if(!b)break;d=d.cs(d)}return e?h.bn(p):p};a.prototype.round=function(d,h){var p=this;null==d?d=0:(d!==~~d||0>d||1E6<d)&&c("!round!");b(p=new a(p),d,null==h?a.Xf:h);return p};a.prototype.sqrt=function(){var d,h,p;h=this.Id;d=this.ke;p=this.e;var e=new a("0.5");if(!h[0])return new a(this);0>d&&c(NaN);d=Math.sqrt(this.toString());0==d||d==1/0?(d=h.join(""),d.length+p&1||(d+="0"),h=new a(Math.sqrt(d).toString()),
h.e=((p+1)/2|0)-(0>p||p&1)):h=new a(d.toString());d=h.e+(a.ad+=4);do p=h,h=e.cs(p.sJ(this.bn(p)));while(p.Id.slice(0,d).join("")!==h.Id.slice(0,d).join(""));b(h,a.ad-=4,a.Xf);return h};a.prototype.cs=function(b){var c,d=this.Id,h=(b=new a(b)).Id,p=d.length,e=h.length,f=this.e,n=b.e;b.ke=this.ke==b.ke?1:-1;if(!d[0]||!h[0])return new a(0*b.ke);b.e=f+n;p<e&&(c=d,d=h,h=c,n=p,p=e,e=n);for(c=Array(n=p+e);n--;c[n]=0);for(f=e;f--;){e=0;for(n=p+f;n>f;)e=c[n]+h[f]*d[n-f-1]+e,c[n--]=e%10,e=e/10|0;c[n]=(c[n]+
e)%10}e&&++b.e;c[0]||c.shift();for(f=c.length;!c[--f];c.pop());b.Id=c;return b};a.prototype.toString=function(){var a=this.e,b=this.Id.join(""),c=b.length;if(-7>=a||21<=a)b=b.charAt(0)+(1<c?"."+b.slice(1):"")+(0>a?"e":"e+")+a;else if(0>a){for(;++a;b="0"+b);b="0."+b}else if(0<a)if(++a>c)for(a-=c;a--;b+="0");else a<c&&(b=b.slice(0,a)+"."+b.slice(a));else 1<c&&(b=b.charAt(0)+"."+b.slice(1));return 0>this.ke&&this.Id[0]?"-"+b:b};a.ad=20;a.Xf=1;return a}();a.$p=h})(C||(C={}));(function(a){var b=function(){function b(a){this.Kf=
a}b.prototype.gs=function(b,c,d){var h=new a.b,p=new a.b,e=this.Kf;d.Fd(b,c,function(a,b){e.fc(2*a,h);e.fc(2*b,p);return h.compare(p)})};b.prototype.Qq=function(a){return this.Kf.read(2*a+1)};return b}(),c=function(){function c(){}c.Rq=function(b){if(b.u())return!1;var d=b.G();return 1736==d?0==b.ef()?!1:!0:1607==d?(d=[!1],c.GD(b,!0,d),d[0]):197==d||a.T.Nc(d)&&!b.CH()?!0:!1};c.Xm=function(b){var d=b.G();if(1736==d)return d=new a.Ua(b.description),b.u()||b.BE(d),d;if(1607==d)return c.GD(b,!1,null);
if(197==d)return d=new a.Ua(b.description),b.u()||d.hd(b,!1),d;if(a.T.Nc(d)){d=new a.Dd(b.description);if(!b.u()&&!b.CH()){var h=new a.Wa;b.Kp(h);d.add(h);b.Ip(h);d.add(h)}return d}if(a.T.Po(d))return null;throw a.g.F();};c.GD=function(c,d,e){null!=e&&(e[0]=!1);var h=null;d||(h=new a.Dd(c.description));if(!c.u()){var p=new a.ha(0);p.zb(2*c.aa());for(var f=0,n=c.aa();f<n;f++)if(0<c.La(f)&&!c.Ko(f)){var y=c.wa(f);p.add(y);y=c.Fc(f)-1;p.add(y)}if(0<p.size){n=new a.Ju;f=c.Qa(0);n.sort(p,0,p.size,new b(f));
n=new a.b;f.fc(2*p.get(0),n);for(var y=0,g=1,w=new a.Wa,k=new a.b,l=1,m=p.size;l<m;l++)if(f.fc(2*p.get(l),k),k.vb(n))p.get(y)>p.get(l)?(p.set(y,2147483647),y=l):p.set(l,2147483647),g++;else{if(0==(g&1))p.set(y,2147483647);else if(d)return null!=e&&(e[0]=!0),null;n.L(k);y=l;g=1}if(0==(g&1))p.set(y,2147483647);else if(d)return null!=e&&(e[0]=!0),null;if(!d)for(p.Fd(0,p.size,function(a,b){return a-b}),l=0,m=p.size;l<m&&2147483647!=p.get(l);l++)c.xe(p.get(l),w),h.add(w)}}return d?null:h};return c}();
a.Pi=c})(C||(C={}));(function(a){var b=function(){function b(){this.Zf=new a.ha(0);this.wt=new a.ha(0);this.GI=1;this.Ct=NaN}b.prototype.sort=function(a,b,c,d){if(32>c-b)d.gs(b,c,a);else{var h=!0;try{for(var p=Infinity,e=-Infinity,f=b;f<c;f++){var n=d.Qq(a.get(f));n<p&&(p=n);n>e&&(e=n)}if(this.reset(c-b,p,e,c-b)){for(f=b;f<c;f++){var y=a.get(f),n=d.Qq(y),g=this.DG(n);this.Zf.set(g,this.Zf.get(g)+1);this.wt.write(f-b,y)}var w=this.Zf.get(0);this.Zf.set(0,0);for(var f=1,k=this.Zf.size;f<k;f++){var l=
this.Zf.get(f);this.Zf.set(f,w);w+=l}for(f=b;f<c;f++){var y=this.wt.read(f-b),n=d.Qq(y),g=this.DG(n),m=this.Zf.get(g);a.set(m+b,y);this.Zf.set(g,m+1)}h=!1}}catch(za){this.Zf.resize(0),this.wt.resize(0)}if(h)d.gs(b,c,a);else{f=c=0;for(k=this.Zf.size;f<k;f++)h=c,c=this.Zf.get(f),c>h&&d.gs(b+h,b+c,a);100<this.Zf.size&&(this.Zf.resize(0),this.wt.resize(0))}}};b.prototype.reset=function(a,c,d,e){if(2>a||d==c)return!1;a=Math.min(b.sL,a);this.Zf.zb(a);this.Zf.resize(a);this.Zf.$h(0,0,this.Zf.size);this.GI=
c;this.wt.resize(e);this.Ct=(d-c)/(a-1);return!0};b.prototype.DG=function(b){return a.J.truncate((b-this.GI)/this.Ct)};b.sL=65536;return b}();a.Ju=b})(C||(C={}));(function(a){var b;(function(a){a[a.enum_line=1]="enum_line";a[a.enum_arc=2]="enum_arc";a[a.enum_dummy=4]="enum_dummy";a[a.enum_concave_dip=8]="enum_concave_dip";a[a.enum_connection=3]="enum_connection"})(b||(b={}));var c=function(){function b(){}b.Iv=function(c,d,h,p,e,f){var n=new b;n.An=new a.b;n.On=new a.b;n.Ow=new a.b;n.An.L(c);n.On.L(d);
n.Ow.L(h);n.wp=p;n.Oh=e;n.Rh=f;return n};b.pa=function(c,d,h,p){var e=new b;e.An=new a.b;e.On=new a.b;e.Ow=new a.b;e.An.L(c);e.On.L(d);e.Ow.Yc();e.wp=4;e.Oh=h;e.Rh=p;return e};return b}(),d=function(){function b(a,b,c,d,h,p){this.Lw=null;this.Ca=0;this.mB=a;this.cJ=this.aJ=0;this.Pa=b;this.jk=c;this.Zk=d;this.tr=h;this.mc=p}b.prototype.next=function(){for(var b=new a.Wa;;){if(this.Ca==this.mB.D())return null;this.mB.xe(this.Ca,b);this.Ca++;if(!b.u())break}var c=!1;null==this.Lw&&(this.aJ=b.Te(),this.cJ=
b.Cf(),this.Lw=e.buffer(b,this.Pa,this.jk,this.Zk,this.tr,this.mc),c=!0);var d;this.Ca<this.mB.D()?(d=new a.Ja,this.Lw.copyTo(d)):d=this.Lw;if(!c){var c=new a.Gd,h=b.Te()-this.aJ,b=b.Cf()-this.cJ;c.zg(h,b);d.Vc(c)}return d};b.prototype.Ia=function(){return 0};b.prototype.Oe=function(){return!0};return b}(),h=function(){function b(a,b){this.$a=a;this.Ca=0;this.dr=b}b.prototype.next=function(){var b=this.$a.Y;if(this.Ca<b.aa()){var c=this.Ca;this.Ca++;if(!b.Ko(c))for(var d=b.Ba(b.Fc(c)-1);this.Ca<b.aa();){var h=
b.Ba(b.wa(this.Ca));if(b.Ko(this.Ca))break;if(h!=d)break;d=b.Ba(b.Fc(this.Ca)-1);this.Ca++}if(1==this.Ca-c)return this.$a.yF(this.$a.Y,c,this.dr);d=new a.Ua(this.$a.Y.description);d.Ui(this.$a.Y,c,!0);for(c+=1;c<this.Ca;c++)d.zs(this.$a.Y,c,0,b.ew(c),!1);return this.$a.yF(d,0,this.dr)}return null};b.prototype.Ia=function(){return 0};b.prototype.Oe=function(){return!0};return b}(),p=function(){function a(a){this.$a=a;this.Ca=0}a.prototype.next=function(){var a=this.$a.Y;if(this.Ca<a.aa()){var b=this.Ca;
a.Ym(this.Ca);for(this.Ca++;this.Ca<a.aa()&&!(0<a.Ym(this.Ca));)this.Ca++;return 0==b&&this.Ca==a.aa()?this.$a.Ty(a,0,a.aa()):this.$a.Ty(a,b,this.Ca)}return null};a.prototype.Ia=function(){return 0};a.prototype.Oe=function(){return!0};return a}(),e=function(){function b(a){this.Ht=this.Zw=this.It=this.Ud=null;this.qe=[];this.mc=a;this.wb=this.xw=this.kV=this.Pa=this.bB=this.Xt=this.ta=0;this.ZA=this.Zk=-1;this.dr=!0}b.buffer=function(c,d,h,p,e,f){if(null==c)throw a.g.F();if(0>p)throw a.g.F();if(c.u())return new a.Ja(c.description);
var n=new a.h;c.ac(n);0<d&&n.P(d,d);f=new b(f);f.jk=h;f.Y=c;f.ta=a.na.$d(h,n,!0);f.Xt=a.na.$d(null,n,!0);f.Pa=d;f.kV=c.G();0>=e&&(e=96);f.wb=Math.abs(f.Pa);f.xw=0!=f.wb?1/f.wb:0;isNaN(p)||0==p?p=1E-5*f.wb:p>.5*f.wb&&(p=.5*f.wb);12>e&&(e=12);c=Math.abs(d)*(1-Math.cos(Math.PI/e));c>p?p=c:(c=Math.PI/Math.acos(1-p/Math.abs(d)),c<e-1&&(e=a.J.truncate(c),12>e&&(e=12,p=Math.abs(d)*(1-Math.cos(Math.PI/e)))));f.Zk=p;f.tr=e;f.bB=Math.min(f.Xt,.25*p);return f.zF()};b.prototype.Rv=function(){if(null==this.Ud)this.Ud=
[];else if(0!==this.Ud.length)return;var b=this.DF(),b=a.J.truncate((b+3)/4),c=.5*Math.PI/b;this.ZA=c;for(var d=0;d<4*b;d++)this.Ud.push(null);for(var h=Math.cos(c),c=Math.sin(c),p=a.b.pa(0,1),d=0;d<b;d++)this.Ud[d+0*b]=a.b.pa(p.y,-p.x),this.Ud[d+1*b]=a.b.pa(-p.x,-p.y),this.Ud[d+2*b]=a.b.pa(-p.y,p.x),this.Ud[d+3*b]=p,p=a.b.pa(p.x,p.y),p.su(h,c)};b.prototype.zF=function(){var b=this.Y.G();if(a.T.Nc(b))return b=new a.Ua(this.Y.description),b.cc(this.Y,!0),this.Y=b,this.zF();if(this.Pa<=this.ta)if(a.T.qU(b)){if(0>=
this.Pa&&(b=new a.h,this.Y.s(b),b.O()<=2*-this.Pa||b.ea()<=2*this.Pa))return new a.Ja(this.Y.description)}else return new a.Ja(this.Y.description);switch(this.Y.G()){case 33:return this.oP();case 550:return this.nP();case 1607:return this.qP();case 1736:return this.pP();case 197:return this.lP();default:throw a.g.za();}};b.prototype.qP=function(){if(this.EH(this.Y)){var b=new a.Wa;this.Y.xe(0,b);var c=new a.h;this.Y.s(c);b.rb(c.Tf());return this.wv(b)}this.Y=this.rW(this.Y);b=new h(this,this.dr);
return a.ei.local().V(b,this.jk,this.mc).next()};b.prototype.pP=function(){if(0==this.Pa)return this.Y;var b=a.Qm.local();this.Rv();this.Y=b.V(this.Y,null,!1,this.mc);if(0>this.Pa){var c=this.Y,c=this.Ty(c,0,c.aa());return b.V(c,this.jk,!1,this.mc)}if(this.EH(this.Y))return b=new a.Wa,this.Y.xe(0,b),c=new a.h,this.Y.s(c),b.rb(c.Tf()),this.wv(b);b=new p(this);return a.ei.local().V(b,this.jk,this.mc).next()};b.prototype.Ty=function(c,d,h){for(var p=new a.Ja(c.description);d<h;d++)if(!(1>c.La(d))){var e=
c.Ym(d),f=new a.h;c.nk(d,f);if(0<this.Pa)if(0<e)if(this.FH(c,d))e=new a.Wa,c.xe(c.wa(d),e),e.rb(f.Tf()),this.nv(p,e);else{var n=e=new a.Ua(c.description),n=a.Lu.JH(this.Y,d)||2==this.Ao(this.Y,d,n,!0,1)?this.xF(c,d):this.zo(e);p.add(n,!1)}else{if(!(f.O()+this.ta<=2*this.wb||f.ea()+this.ta<=2*this.wb||(n=e=new a.Ua(c.description),this.Ao(this.Y,d,n,!0,1),e.u()))){var y=new a.h;y.I(f);y.P(this.wb,this.wb);n.oq(y);n=this.zo(e);f=1;for(e=n.aa();f<e;f++)p.Ui(n,f,!0)}}else if(0<e){if(!(f.O()+this.ta<=2*
this.wb||f.ea()+this.ta<=2*this.wb||(n=e=new a.Ua(c.description),this.Ao(this.Y,d,n,!0,-1),e.u())))for(y=new a.h,n.ac(y),y.P(this.wb,this.wb),n.oq(y),n=this.zo(e),f=1,e=n.aa();f<e;f++)p.Ui(n,f,!0)}else for(n=e=new a.Ua(c.description),this.Ao(this.Y,d,n,!0,-1),n=this.zo(e),f=0,e=n.aa();f<e;f++)p.Ui(n,f,!0)}if(0<this.Pa)return 1<p.aa()?p=this.zo(p):b.lf(p);c=new a.h;p.ac(c);if(p.u())return b.lf(p);c.P(this.wb,this.wb);p.oq(c);p=this.zo(p);c=new a.Ja(p.description);f=1;for(e=p.aa();f<e;f++)c.Ui(p,f,
!1);return b.lf(c)};b.prototype.oP=function(){return this.wv(this.Y)};b.prototype.wv=function(b){var c=new a.Ja(this.Y.description);this.nv(c,b);return this.SX(c)};b.prototype.nP=function(){var b=new d(this.Y,this.Pa,this.jk,this.Zk,this.tr,this.mc);return a.ei.local().V(b,this.jk,this.mc).next()};b.prototype.lP=function(){var b=new a.Ja(this.Y.description);if(0>=this.Pa){if(0==this.Pa)b.hd(this.Y,!1);else{var c=new a.di;this.Y.Wn(c);c.P(this.Pa,this.Pa);b.hd(c,!1)}return b}b.hd(this.Y,!1);this.Y=
b;return this.xF(b,0)};b.prototype.xF=function(c,d){this.Rv();var h=new a.Ja(c.description),p=new a.b,e=new a.b,f=new a.b,n=new a.b,y=new a.b,g=new a.b,D=new a.b,K=new a.b,w=c.La(d),P=c.wa(d),k=0;for(d=c.La(d);k<d;k++){c.w(P+k,e);c.w(P+(k+1)%w,n);c.w(P+(k+2)%w,g);D.xc(n,e);if(0==D.length())throw a.g.za();D.uw();D.normalize();D.scale(this.wb);p.add(D,e);f.add(D,n);0==k?h.Bu(p):h.bj(p);h.bj(f);K.xc(g,n);if(0==K.length())throw a.g.za();K.uw();K.normalize();K.scale(this.wb);y.add(K,n);this.ZE(h,n,f,y,
!1)}return b.lf(h)};b.prototype.yF=function(b,c,d){this.Rv();if(1>b.La(c))return null;if(this.FH(b,c)&&0<this.Pa){d=new a.Wa;b.xe(b.wa(c),d);var h=new a.h;b.nk(c,h);d.rb(h.Tf());return this.wv(d)}h=new a.Ua(b.description);if(b.Ko(c))this.Ao(b,c,h,d,1),this.Ao(b,c,h,d,-1);else{var p=new a.Ua(b.description);p.Ui(b,c,!1);p.zs(b,c,0,b.ew(c),!1);this.Ao(p,0,h,d,1)}return this.zo(h)};b.prototype.Or=function(){this.kx++};b.prototype.zo=function(b){return a.Cg.ql(b,this.Xt,!0,!0,this.mc)};b.prototype.DF=
function(){if(0==this.Zk)return this.tr;var b=1-this.Zk*Math.abs(this.xw),c;-1>b?c=4:c=2*Math.PI/Math.acos(b)+.5;4>c?c=4:c>this.tr&&(c=this.tr);return a.J.truncate(c)};b.prototype.ZE=function(b,c,d,h,p){this.Rv();var e=new a.b;e.xc(d,c);e.scale(this.xw);var f=new a.b;f.xc(h,c);f.scale(this.xw);e=Math.atan2(e.y,e.x)/this.ZA;0>e&&(e=this.Ud.length+e);e=this.Ud.length-e;f=Math.atan2(f.y,f.x)/this.ZA;0>f&&(f=this.Ud.length+f);f=this.Ud.length-f;f<e&&(f+=this.Ud.length);var n=a.J.truncate(f),f=a.J.truncate(Math.ceil(e)),
e=new a.b;e.L(this.Ud[f%this.Ud.length]);e.tu(this.wb,c);var y=10*this.ta;e.sub(d);e.length()<y&&(f+=1);e.L(this.Ud[n%this.Ud.length]);e.tu(this.wb,c);e.sub(h);e.length()<y&&--n;d=n-f;d++;n=0;for(f%=this.Ud.length;n<d;n++,f=(f+1)%this.Ud.length)e.L(this.Ud[f]),e.tu(this.wb,c),b.bj(e),this.Or();p&&b.bj(h)};b.prototype.Ao=function(b,d,h,p,e){var f=new a.ed,n=f.IO(b,d);f.zq(this.bB,!1,!1);if(2>f.D(n)){if(0>e)return 1;e=b;f=new a.Wa;e.xe(e.wa(d),f);this.nv(h,f);return 1}var y=f.Ba(f.cb(f.Pb(n))),g=new a.Gd;
g.zg(-y.x,-y.y);f.Vc(g);if(p&&(this.MR(f,n,e),2>f.D(n))){if(0>e)return 1;e=b;f=new a.Wa;e.xe(e.wa(d),f);this.nv(h,f);return 1}this.qe.length=0;var D=f.Pb(n);d=f.cb(D);var K=1==e?f.Ra(d):f.U(d);b=1==e?f.U(d):f.Ra(d);var w=!0;p=new a.b;for(var n=new a.b,P=new a.b,N=new a.b,k=new a.b,U=new a.b,l=new a.b,m=new a.b,q=new a.b,ka=new a.b,r=this.wb,D=f.La(D),I=0;I<D;I++)f.w(b,n),w&&(f.w(d,p),f.w(K,P),m.xc(p,P),m.normalize(),ka.OH(m),ka.scale(r),N.add(ka,p)),l.xc(n,p),l.normalize(),q.OH(l),q.scale(r),k.add(p,
q),K=m.Vi(l),w=m.pi(l),0>K||0>w&&0==K?this.qe.push(c.Iv(N,k,p,2,this.qe.length+1,this.qe.length-1)):N.vb(k)||(this.qe.push(c.pa(N,p,this.qe.length+1,this.qe.length-1,"dummy")),this.qe.push(c.pa(p,k,this.qe.length+1,this.qe.length-1,"dummy"))),U.add(n,q),this.qe.push(c.Iv(k,U,p,1,this.qe.length+1,this.qe.length-1)),N.L(U),ka.L(q),P.L(p),p.L(n),m.L(l),K=d,d=b,w=!1,b=1==e?f.U(d):f.Ra(d);this.qe[this.qe.length-1].Oh=0;this.qe[0].Rh=this.qe.length-1;this.tW(h);g.zg(y.x,y.y);h.mF(g,h.aa()-1);return 1};
b.prototype.tW=function(a){for(var b=this.ZP(),c=!0,d=b+1,h=b;d!=b;h=d){var p=this.qe[h],d=-1!=p.Oh?p.Oh:(h+1)%this.qe.length;0!=p.wp&&(c&&a.Bu(p.An),2==p.wp?this.ZE(a,p.Ow,p.An,p.On,!0):a.bj(p.On),c=!1)}};b.prototype.ZP=function(){null==this.Ht&&(this.Ht=[null,null,null,null,null,null,null,null,null]);for(var b=0,c=0,d=this.qe.length;c<d;){var h=this.qe[c];if(0!=(h.wp&3)){b=c;break}c=h.Oh}d=b+1;for(c=b;d!=b;c=d){for(var h=this.qe[c],d=h.Oh,p=1,e=null;d!=c;){e=this.qe[d];if(0!=(e.wp&3))break;d=e.Oh;
p++}1!=p&&1==(h.wp&e.wp)&&(null==this.It&&(this.It=new a.Hb,this.Zw=new a.Hb),this.It.Lc(h.An),this.It.Xc(h.On),this.Zw.Lc(e.An),this.Zw.Xc(e.On),1==this.It.Ma(this.Zw,this.Ht,null,null,this.Xt)&&(h.On.L(this.Ht[0]),e.An.L(this.Ht[0]),h.Oh=d,e.Rh=c))}return b};b.prototype.sw=function(b,c,d){var h=new a.b;h.xc(d,b);d=h.length();d=this.wb*this.wb-d*d*.25;if(0<d){d=Math.sqrt(d);h.normalize();h.Tr();var p=new a.b;p.xc(c,b);if(p.pi(h)+d>=this.wb)return!0}return!1};b.prototype.MR=function(b,c,d){for(var h=
0;1>h;h++){var p=!1,e=b.Pb(c),f=b.La(e);if(0==f)break;var n=f;if(3>f)break;!b.Qb(e)&&(n=f-1);for(var e=b.cb(e),f=0<d?b.Ra(e):b.U(e),y=0<d?b.U(e):b.Ra(e),g=f,D=!0,K=new a.b,w=new a.b,P=new a.b,N=new a.b,k=new a.b,l=a.b.pa(0,0),m=new a.b,q=new a.b,r=new a.b,I=new a.b,t=this.wb,u=0,v=0;v<n;){b.w(y,w);D&&(b.w(e,K),b.w(f,P),g=f);q.xc(K,P);q.normalize();m.xc(w,K);m.normalize();if(g==y)break;var x=q.Vi(m),z=q.pi(m),B=!0;0>x||0>z&&0==x||!this.sw(P,K,w)||(l.L(w),B=!1,++u,p=!0);if(B){if(0<u)for(;;){x=0<d?b.Ra(g):
b.U(g);if(x==e)break;b.w(x,N);if(this.sw(N,P,l))P.L(N),g=x,B=!1,++u;else{x!=y&&this.sw(N,P,w)&&this.sw(N,K,w)&&(P.L(N),g=x,B=!1,++u);break}}if(!B)continue;if(0<u){g=0<d?b.Ra(f):b.U(f);for(D=1;D<u;D++)B=0<d?b.Ra(g):b.U(g),b.td(g,!0),g=B;r.xc(K,P);u=r.length();u=t*t-u*u*.25;u=Math.sqrt(u);t-u>.5*this.Zk?(k.add(P,K),k.scale(.5),r.normalize(),r.Tr(),I.L(r),I.scale(t-u),k.add(I),b.Nf(f,k)):b.td(f,!0);u=0}P.L(K);g=e}K.L(w);f=e;e=y;y=0<d?b.U(e):b.Ra(e);v++;D=!1}if(0<u){g=0<d?b.Ra(f):b.U(f);for(D=1;D<u;D++)B=
0<d?b.Ra(g):b.U(g),b.td(g,!0),g=B;k.add(P,K);k.scale(.5);r.xc(K,P);u=r.length();u=t*t-u*u*.25;u=Math.sqrt(u);r.normalize();r.Tr();I.L(r);I.scale(t-u);k.add(I);b.Nf(f,k)}b.zq(this.bB,!1,!1);if(!p)break}};b.prototype.FH=function(b,c){if(1==b.La(c))return!0;var d=new a.h;b.nk(c,d);return Math.max(d.O(),d.ea())<.5*this.Zk?!0:!1};b.prototype.EH=function(b){var c=new a.h;b.s(c);return Math.max(c.O(),c.ea())<.5*this.Zk?!0:!1};b.prototype.rW=function(b){b=a.ND.local().V(b,.25*this.Zk,!1,this.mc);for(var c=
0,d=0,h=b.aa();d<h;d++)c=Math.max(b.La(d),c);if(32>c)return this.dr=!1,b;this.dr=!0;return a.Cg.ql(b,this.Xt,!1,!0,this.mc)};b.prototype.nv=function(b,c){c=c.w();if(null!=this.Ud&&0!==this.Ud.length){var d=new a.b;d.L(this.Ud[0]);d.tu(this.wb,c);b.Bu(d);for(var h=1,p=this.Ud.length;h<p;h++)d.L(this.Ud[h]),d.tu(this.wb,c),b.bj(d)}else for(var h=this.DF(),d=a.J.truncate((h+3)/4),h=.5*Math.PI/d,p=Math.cos(h),e=Math.sin(h),f=new a.b,n=3;0<=n;n--){f.ja(0,this.wb);switch(n){case 0:for(h=0;h<d;h++)b.ak(f.x+
c.x,f.y+c.y),f.su(p,e);break;case 1:for(h=0;h<d;h++)b.ak(-f.y+c.x,f.x+c.y),f.su(p,e);break;case 2:for(h=0;h<d;h++)b.ak(-f.x+c.x,-f.y+c.y),f.su(p,e);break;default:for(b.$x(f.y+c.x,-f.x+c.y),h=1;h<d;h++)f.su(p,e),b.ak(f.y+c.x,-f.x+c.y)}this.Or()}};b.lf=function(a){a.Xg(1,0);return a};b.prototype.SX=function(a){a.Xg(2,this.ta);a.Fl();return a};return b}();a.EL=e})(C||(C={}));(function(a){var b=function(){function b(b){this.Ha=b;this.a=new a.ed;this.md=new a.ha(0)}b.prototype.ki=function(a,b,c){switch(b){case 0:if(a.o<
c&&a.v<=c)break;else return a.o>=c?1:-1;case 1:if(a.A<c&&a.B<=c)break;else return a.A>=c?1:-1;case 2:if(a.o>=c&&a.v>c)break;else return a.v<=c?1:-1;case 3:if(!(a.A>=c&&a.B>c))return a.B<=c?1:-1}return 0};b.prototype.fz=function(a,b,c){return 1736==a.G()?this.gz(a,b,c):this.hz(a,b)};b.prototype.gz=function(b,c,d){if(0==this.Ha.O()||0==this.Ha.ea())return b.Ka();c=new a.h;b.ac(c);this.Y=this.a.Jb(b);var h=new a.h,p=new a.h,e=new a.b,f=new a.b,n=[0,0,0,0,0,0,0,0,0],g=[0,0,0,0,0,0,0,0,0];new a.Bg;var w=
new a.Hb,k=new a.ha(0);k.zb(Math.min(100,b.D()));for(var l=!1,m=0;!l&&4>m;m++){var q=!1,r=0!=(m&1),I=0;switch(m){case 0:I=this.Ha.o;q=c.o<=I&&c.v>=I;break;case 1:I=this.Ha.A;q=c.A<=I&&c.B>=I;break;case 2:I=this.Ha.v;q=c.o<=I&&c.v>=I;break;case 3:I=this.Ha.B,q=c.A<=I&&c.B>=I}if(q)for(l=!0,q=this.a.Pb(this.Y);-1!=q;){var t=-1,u=-1,v=this.a.cb(q),x=v;do{var z=this.a.jc(x);null==z&&(z=w,this.a.w(x,e),z.Lc(e),this.a.w(this.a.U(x),f),z.Xc(f));z.s(h);var B=this.ki(h,m,I),A=0,F=-1;if(-1==B){z=z.Tq(r,I,n,
g);0<z?A=this.a.Em(x,g,z):A=0;for(var A=A+1,C=x,G=this.a.U(C),z=0;z<A;z++){this.a.w(C,e);this.a.w(G,f);F=this.a.jc(C);null==F&&(F=w,F.Lc(e),F.Xc(f));F.s(p);F=this.ki(p,m,I);if(-1==F){if(r)F=Math.abs(e.y-I),E=Math.abs(f.y-I),F<E?(e.y=I,this.a.Nf(C,e)):(f.y=I,this.a.Nf(G,f));else{var F=Math.abs(e.x-I),E=Math.abs(f.x-I);F<E?(e.x=I,this.a.Nf(C,e)):(f.x=I,this.a.Nf(G,f))}F=this.a.jc(C);null==F&&(F=w,F.Lc(e),F.Xc(f));F.s(p);F=this.ki(p,m,I)}E=t;t=F;-1==u&&(u=t);if(0!=E||1!=t)1==E&&0==t||0!=E||0!=t||k.add(C);
1==t&&(l=!1);F=C=G;G=this.a.U(G)}}if(0==A){E=t;t=B;-1==u&&(u=t);if(0!=E||1!=t)1==E&&0==t||0!=E||0!=t||k.add(x);1==t&&(l=!1);F=this.a.U(x)}x=F}while(x!=v);0==u&&0==t&&k.add(v);z=0;for(t=k.size;z<t;z++)u=k.get(z),this.a.td(u,!1);k.clear(!1);q=3>this.a.La(q)?this.a.Qr(q):this.a.Sb(q)}}if(l)return b.Ka();this.iC();0<d&&this.uz(d);return this.a.Pe(this.Y)};b.prototype.hz=function(b){var c=new a.h,d=new a.h,e=[0,0,0,0,0,0,0,0,0],f=[0,0,0,0,0,0,0,0,0],n=new a.Bg,g=b,w=new a.h;b.ac(w);for(var k=0;4>k;k++){var l=
!1,m=0!=(k&1),q=0;switch(k){case 0:q=this.Ha.o;l=w.o<=q&&w.v>=q;break;case 1:q=this.Ha.A;l=w.A<=q&&w.B>=q;break;case 2:q=this.Ha.v;l=w.o<=q&&w.v>=q;break;case 3:q=this.Ha.B,l=w.A<=q&&w.B>=q}if(l){l=g;g=b.Ka();l=l.Fa();l.zj();for(var r,I=new a.b;l.Ya();)for(var t,u=!0;l.Ea();){var v=l.ba();v.s(c);var x=this.ki(c,k,q);if(-1==x){if(x=v.Tq(m,q,e,f),0<x){var z=0;r=v.ec();for(var B=0;B<=x;B++)if(t=B<x?f[B]:1,z!=t){v.yh(z,t,n);var A=n.get();A.Lc(r);B<x&&(m?(I.x=e[B],I.y=q):(I.x=q,I.y=e[B]),A.Xc(I));A.s(d);
var F=this.ki(d,k,q);if(-1==F){r=A.ec();z=A.Ac();if(m)F=Math.abs(r.y-q),C=Math.abs(z.y-q),F<C?(r.y=q,A.Lc(r)):(z.y=q,A.Xc(z));else{var F=Math.abs(r.x-q),C=Math.abs(z.x-q);F<C?(r.x=q,A.Lc(r)):(z.x=q,A.Xc(z))}A.s(d);F=this.ki(d,k,q)}r=A.Ac();z=t;t=F;1==t?(g.cc(A,u),u=!1):u=!0}}}else t=x,1==t?(g.cc(v,u),u=!1):u=!0}}}return g};b.prototype.iC=function(){this.Li=-1;this.Fm(!1,this.Ha.o);this.Fm(!1,this.Ha.v);this.Fm(!0,this.Ha.A);this.Fm(!0,this.Ha.B);this.md.resize(0);this.md.zb(100);this.Li=this.a.Sd();
for(var b=new a.b,c=this.a.Pb(this.Y);-1!=c;c=this.a.Sb(c))for(var d=this.a.cb(c),e=0,f=this.a.La(c);e<f;e++,d=this.a.U(d))if(this.a.w(d,b),this.Ha.o==b.x||this.Ha.v==b.x||this.Ha.A==b.y||this.Ha.B==b.y)this.a.Va(d,this.Li,this.md.size),this.md.add(d);this.xm(!1,this.Ha.o);this.xm(!1,this.Ha.v);this.xm(!0,this.Ha.A);this.xm(!0,this.Ha.B);this.Ez()};b.prototype.uz=function(b){for(var c=new a.b,d=new a.b,e=a.J.df(2048,0),f=this.a.Pb(this.Y);-1!=f;f=this.a.Sb(f)){var n=this.a.cb(f),g=n;do{var w=this.a.U(g);
this.a.w(g,c);var k=-1;c.x==this.Ha.o?(this.a.w(w,d),d.x==this.Ha.o&&(k=1)):c.x==this.Ha.v&&(this.a.w(w,d),d.x==this.Ha.v&&(k=1));c.y==this.Ha.A?(this.a.w(w,d),d.y==this.Ha.A&&(k=0)):c.y==this.Ha.B&&(this.a.w(w,d),d.y==this.Ha.B&&(k=0));if(-1!=k&&(k=a.b.Cb(c,d),k=a.J.truncate(Math.min(Math.ceil(k/b),2048)),!(1>=k))){for(var l=1;l<k;l++)e[l-1]=1*l/k;this.a.Em(g,e,k-1)}g=w}while(g!=n)}};b.prototype.Fm=function(b,c){var d=this.a.Sd(),h=new a.b,e=new a.ha(0);e.zb(100);for(var f=this.a.Pb(this.Y);-1!=
f;f=this.a.Sb(f))for(var n=this.a.cb(f),g=0,w=this.a.La(f);g<w;g++){var k=this.a.U(n);this.a.w(n,h);if(b?h.y==c:h.x==c)if(this.a.w(k,h),b?h.y==c:h.x==c)1!=this.a.Sa(n,d)&&(e.add(n),this.a.Va(n,d,1)),1!=this.a.Sa(k,d)&&(e.add(k),this.a.Va(k,d,1));n=k}this.a.je(d);if(!(3>e.size)){var l=this;e.Fd(0,e.size,function(a,b){return l.li(a,b)});d=new a.b;f=new a.b;n=new a.b;f.Yc();for(var m=-1,g=new a.ha(0),w=new a.ha(0),k=this.a.Sd(),q=this.a.Sd(),r=0,I=e.size;r<I;r++){var t=e.get(r);this.a.w(t,h);if(!h.vb(f)){if(-1!=
m){for(var u=m;u<r;u++){var m=e.get(u),v=this.a.U(m),t=this.a.Ra(m),x=!1;0>this.li(m,v)&&(this.a.w(v,d),b?d.y==c:d.x==c)&&(g.add(m),x=!0,this.a.Va(m,q,1));0>this.li(m,t)&&(this.a.w(t,d),b?d.y==c:d.x==c)&&(x||g.add(m),this.a.Va(m,k,1))}u=0;for(x=g.size;u<x;u++){m=g.get(u);t=this.a.Sa(m,k);v=this.a.Sa(m,q);if(1==t){t=this.a.Ra(m);this.a.w(t,n);var z=[0];z[0]=0;if(!n.vb(h)){var B=a.b.Cb(f,n);z[0]=a.b.Cb(n,h)/B;0==z[0]?z[0]=2.220446049250313E-16:1==z[0]&&(z[0]=.9999999999999998);this.a.Em(t,z,1);t=this.a.Ra(m);
this.a.Nf(t,h);w.add(t);this.a.Va(t,k,1);this.a.Va(t,q,-1)}}1==v&&(v=this.a.U(m),this.a.w(v,n),z=[0],z[0]=0,n.vb(h)||(B=a.b.Cb(f,n),z[0]=a.b.Cb(f,h)/B,0==z[0]?z[0]=2.220446049250313E-16:1==z[0]&&(z[0]=.9999999999999998),this.a.Em(m,z,1),t=this.a.U(m),this.a.Nf(t,h),w.add(t),this.a.Va(t,k,-1),this.a.Va(t,q,1)))}m=g;g=w;w=m;w.clear(!1)}m=r;f.L(h)}}this.a.je(k);this.a.je(q)}};b.prototype.xm=function(b,c){var d=new a.b,h=new a.ha(0);h.zb(100);for(var e=this.a.Sd(),f=0,n=this.md.size;f<n;f++){var g=this.md.get(f);
if(-1!=g){var w=this.a.U(g);this.a.w(g,d);if(b?d.y==c:d.x==c)if(this.a.w(w,d),b?d.y==c:d.x==c)-2!=this.a.Sa(g,e)&&(h.add(g),this.a.Va(g,e,-2)),-2!=this.a.Sa(w,e)&&(h.add(w),this.a.Va(w,e,-2))}}if(0!=h.size){var k=this;h.Fd(0,h.size,function(a,b){return k.li(a,b)});f=0;for(n=h.size;f<n;f++){var l=h.get(f);this.a.Va(l,e,f)}g=new a.b;w=new a.b;w.Yc();for(var m=-1,f=0,n=h.size;f<n;f++)if(l=h.get(f),-1!=l&&(this.a.w(l,d),!d.vb(w))){if(-1!=m)for(;;){for(var l=!1,q=1<f-m?f-1:f,r=m;r<q;r++){var I=h.get(r);
if(-1!=I){var t=-1,u=this.a.U(I);0>this.li(I,u)&&(this.a.w(u,g),b?g.y==c:g.x==c)&&(t=u);var u=-1,v=this.a.Ra(I);0>this.li(I,v)&&(this.a.w(v,g),b?g.y==c:g.x==c)&&(u=v);if(-1!=t&&-1!=u)this.ji(I,h,e),this.a.td(I,!1),this.ji(t,h,e),this.a.td(t,!1),l=!0;else if(-1!=t||-1!=u){for(v=r+1;v<f;v++){var x=h.get(v);if(-1!=x){var z=this.a.U(x),B=-1;0>this.li(x,z)&&(this.a.w(z,g),b?g.y==c:g.x==c)&&(B=z);var z=this.a.Ra(x),A=-1;0>this.li(x,z)&&(this.a.w(z,g),b?g.y==c:g.x==c)&&(A=z);if(-1!=B&&-1!=A){this.ji(x,h,
e);this.a.td(x,!1);this.ji(B,h,e);this.a.td(B,!1);l=!0;break}if(-1!=t&&-1!=A){this.qu(h,I,t,x,A,e);l=!0;break}else if(-1!=u&&-1!=B){this.qu(h,x,B,I,u,e);l=!0;break}}}if(l)break}}}if(!l)break}m=f;w.L(d)}}this.a.je(e)};b.prototype.ji=function(a,b,c){c=this.a.Sa(a,c);b.set(c,-1);c=this.a.Sa(a,this.Li);this.md.set(c,-1);b=this.a.kd(a);-1!=b&&this.a.cb(b)==a&&(this.a.ig(b,-1),this.a.rh(b,-1))};b.prototype.qu=function(a,b,c,d,e,f){this.a.Jc(b,d);this.a.Kc(d,b);this.a.Kc(c,e);this.a.Jc(e,c);this.ji(d,a,
f);this.a.Ni(d,!1);this.ji(e,a,f);this.a.Ni(e,!0)};b.prototype.Ez=function(){for(var a=0,b=this.md.size;a<b;a++){var c=this.md.get(a);-1!=c&&this.a.Bj(c,-1)}for(var d=0,e=0,f=this.a.Pb(this.Y);-1!=f;){var g=this.a.cb(f);if(-1==g||f!=this.a.kd(g)){var w=f,f=this.a.Sb(f);this.a.ig(w,-1);this.a.Rr(w)}else{c=g;w=0;do this.a.Bj(c,f),w++,c=this.a.U(c);while(c!=g);2>=w?(c=this.a.Sa(g,this.Li),this.md.set(c,-1),g=this.a.td(g,!1),2==w&&(c=this.a.Sa(g,this.Li),this.md.set(c,-1),this.a.td(g,!1)),w=f,f=this.a.Sb(f),
this.a.ig(w,-1),this.a.Rr(w)):(this.a.Up(f,!1),this.a.rh(f,this.a.Ra(g)),this.a.sk(f,w),e+=w,d++,f=this.a.Sb(f))}}a=0;for(b=this.md.size;a<b;a++)if(c=this.md.get(a),-1!=c&&(f=this.a.kd(c),-1==f)){f=this.a.Vf(this.Y,-1);w=0;g=c;do this.a.Bj(c,f),w++,c=this.a.U(c);while(c!=g);2>=w?(c=this.a.Sa(g,this.Li),this.md.set(c,-1),g=this.a.td(g,!1),2==w&&(c=this.a.Sa(g,this.Li),0<=c&&this.md.set(c,-1),this.a.td(g,!1)),w=f,this.a.ig(w,-1),this.a.Rr(w)):(this.a.ho(f,!0),this.a.sk(f,w),this.a.ig(f,g),this.a.rh(f,
this.a.Ra(g)),this.a.Up(f,!1),e+=w,d++)}this.a.Bm(this.Y,d);this.a.qk(this.Y,e);a=0;for(b=this.a.qd;-1!=b;b=this.a.Re(b))a+=this.a.D(b);this.a.CC(a)};b.xl=function(a,c,d,e){return(new b(c)).fz(a,d,e)};b.clip=function(c,d,p,e){if(c.u())return c;if(d.u())return c.Ka();var h=c.G();if(33==h)return p=c.w(),d.contains(p)?c:c.Ka();if(197==h)return p=new a.h,c.s(p),p.Ma(d)?(d=new a.di,c.copyTo(d),d.Np(p),d):c.Ka();var f=new a.h;c.ac(f);if(d.contains(f))return c;if(!d.Yb(f))return c.Ka();f=c.ob;if(null!=f&&
(f=f.Ii,null!=f)){f=f.Xn(d);if(1==f){if(1736!=h)throw a.g.za();c=new a.Ja(c.description);c.oq(d);return c}if(0==f)return c.Ka()}switch(h){case 550:e=null;for(var h=c.D(),f=c.Qa(0),n=0,y=0;y<h;y++)p=new a.b,f.fc(2*y,p),d.contains(p)||(0==n&&(e=c.Ka()),n<y&&e.Hd(c,n,y),n=y+1);0<n&&e.Hd(c,n,h);return 0==n?c:e;case 1736:case 1607:return b.xl(c,d,p,e);default:throw a.g.za();}};b.prototype.li=function(b,c){var d=new a.b;this.a.w(b,d);b=new a.b;this.a.w(c,b);return d.compare(b)};return b}();a.le=b})(C||
(C={}));(function(a){var b=function(){function b(b,c){this.Ha=b;this.a=new a.ed;this.md=new a.ha(0);this.ie=c}b.prototype.ki=function(a,b,c){switch(b){case 0:if(a.o<c&&a.v<=c)break;else return a.o>=c?1:-1;case 1:if(a.A<c&&a.B<=c)break;else return a.A>=c?1:-1;case 2:if(a.o>=c&&a.v>c)break;else return a.v<=c?1:-1;case 3:if(!(a.A>=c&&a.B>c))return a.B<=c?1:-1}return 0};b.prototype.fz=function(a,b,c){return 1736==a.G()?this.gz(a,b,c):this.hz(a,b)};b.prototype.gz=function(b,c,d){if(0==this.Ha.O()||0==
this.Ha.ea())return b.Ka();c=new a.h;b.ac(c);this.Y=this.a.Jb(b);var h=new a.h,p=new a.h,e=new a.b,f=new a.b,n=[0,0,0,0,0,0,0,0,0],g=[0,0,0,0,0,0,0,0,0],w=new a.Hb,k=new a.ha(0);k.zb(256);for(var l=!1,m=0;!l&&4>m;m++){var q=!1,r=0!=(m&1),I=0;switch(m){case 0:I=this.Ha.o;q=c.o<=I&&c.v>=I;break;case 1:I=this.Ha.A;q=c.A<=I&&c.B>=I;break;case 2:I=this.Ha.v;q=c.o<=I&&c.v>=I;break;case 3:I=this.Ha.B,q=c.A<=I&&c.B>=I}if(q)for(l=!0,q=this.a.Pb(this.Y);-1!=q;){var t=!0,u=-1,v=-1,x=this.a.cb(q),z=x;do{var B=
this.a.jc(z);null==B&&(B=w,this.a.w(z,e),B.Lc(e),this.a.w(this.a.U(z),f),B.Xc(f));B.s(h);var A=this.ki(h,m,I),F=0,C=-1;if(-1==A){B=B.Tq(r,I,n,g);0<B?F=this.a.iY(z,g,B):F=0;for(var F=F+1,G=z,E=this.a.U(G),B=0;B<F;B++){this.a.w(G,e);this.a.w(E,f);C=this.a.jc(G);null==C&&(C=w,C.Lc(e),C.Xc(f));C.s(p);C=this.ki(p,m,I);if(-1==C){if(r)C=Math.abs(e.y-I),J=Math.abs(f.y-I),C<J?(e.y=I,this.a.Nf(G,e)):(f.y=I,this.a.Nf(E,f));else{var C=Math.abs(e.x-I),J=Math.abs(f.x-I);C<J?(e.x=I,this.a.Nf(G,e)):(f.x=I,this.a.Nf(E,
f))}C=this.a.jc(G);null==C&&(C=w,C.Lc(e),C.Xc(f));C.s(p);C=this.ki(p,m,I)}J=u;u=C;-1==v&&(v=u);if(0!=J||1!=u)1==J&&0==u||0!=J||0!=u||k.add(G);1==u&&(t=l=!1);C=G=E;E=this.a.U(E)}}if(0==F){J=u;u=A;-1==v&&(v=u);if(0!=J||1!=u)1==J&&0==u||0!=J||0!=u||k.add(z);1==u&&(t=l=!1);C=this.a.U(z)}z=C;if(256<=k.size){B=1;for(A=k.size-1;B<A;B++)F=k.get(B),this.a.td(F,!1);k.set(1,k.Ec());k.uf(2)}}while(z!=x);if(!t)for(0==v&&0==u&&k.add(x),B=0,A=k.size;B<A;B++)F=k.get(B),this.a.td(F,!1);k.clear(!1);q=t||0==this.a.La(q)?
this.a.Qr(q):this.a.Sb(q)}}if(l)return b.Ka();this.iC();0<d&&this.uz(d);return this.a.Pe(this.Y)};b.prototype.hz=function(b){var c=new a.h,d=new a.h,e=[0,0,0,0,0,0,0,0,0],f=[0,0,0,0,0,0,0,0,0],n=new a.Bg,g=b,w=new a.h;b.ac(w);for(var k=new a.b,l=new a.b,m=null,q=null,r=0;4>r;r++){var I=!1,t=0!=(r&1),u=0;switch(r){case 0:u=this.Ha.o;I=w.o<=u&&w.v>=u;break;case 1:u=this.Ha.A;I=w.A<=u&&w.B>=u;break;case 2:u=this.Ha.v;I=w.o<=u&&w.v>=u;break;case 3:u=this.Ha.B,I=w.A<=u&&w.B>=u}if(I)for(I=g,g=b.Ka(),I=
I.Fa(),I.zj();I.Ya();)for(var v,x=!0;I.Ea();){var z=I.ba();z.s(c);var B=this.ki(c,r,u);if(-1==B){if(B=z.Tq(t,u,e,f),0<B){var A=0;z.Oq(k);for(var F=0;F<=B;F++)if(v=F<B?f[F]:1,A!=v){z.yh(A,v,n);var C=n.get();C.Lc(k);F<B&&(t?(l.x=e[F],l.y=u):(l.x=u,l.y=e[F]),C.Xc(l));C.s(d);var G=this.ki(d,r,u);-1==G&&(null==m&&(m=new a.b),null==q&&(q=new a.b),C.Oq(m),C.Ns(q),t?(A=Math.abs(m.y-u),G=Math.abs(q.y-u),A<G?(m.y=u,C.Lc(m)):(q.y=u,C.Xc(q))):(A=Math.abs(m.x-u),G=Math.abs(q.x-u),A<G?(m.x=u,C.Lc(m)):(q.x=u,C.Xc(q))),
C.s(d),G=this.ki(d,r,u));C.Ns(k);A=v;v=G;1==v?(g.cc(C,x),x=!1):x=!0}}}else v=B,1==v?(g.cc(z,x),x=!1):x=!0}}return g};b.prototype.iC=function(){this.Li=-1;this.Fm(!1,this.Ha.o);this.Fm(!1,this.Ha.v);this.Fm(!0,this.Ha.A);this.Fm(!0,this.Ha.B);this.md.resize(0);this.md.zb(100);this.Li=this.a.Sd();for(var b=new a.b,c=this.a.Pb(this.Y);-1!=c;c=this.a.Sb(c))for(var d=this.a.cb(c),e=0,f=this.a.La(c);e<f;e++,d=this.a.U(d))if(this.a.w(d,b),this.Ha.o==b.x||this.Ha.v==b.x||this.Ha.A==b.y||this.Ha.B==b.y)this.a.Va(d,
this.Li,this.md.size),this.md.add(d);this.xm(!1,this.Ha.o);this.xm(!1,this.Ha.v);this.xm(!0,this.Ha.A);this.xm(!0,this.Ha.B);this.Ez()};b.prototype.uz=function(b){for(var c=new a.b,d=new a.b,e=null,f=null,n=a.J.df(2048,0),g=this.a.Pb(this.Y);-1!=g;g=this.a.Sb(g)){var w=this.a.cb(g),k=w;do{var l=this.a.U(k);this.a.w(k,c);var m=-1;c.x==this.Ha.o?(this.a.w(l,d),d.x==this.Ha.o&&(m=1)):c.x==this.Ha.v&&(this.a.w(l,d),d.x==this.Ha.v&&(m=1));c.y==this.Ha.A?(this.a.w(l,d),d.y==this.Ha.A&&(m=0)):c.y==this.Ha.B&&
(this.a.w(l,d),d.y==this.Ha.B&&(m=0));if(-1!=m){null==e&&(e=new a.b);null==f&&(f=new a.b);e.L(c);f.ja(0,0);if(0==m){var q=c.x-this.Ha.o;f.x=a.Ub.sign(d.x-c.x);e.x=b*a.Ub.Kl(Math.floor(Math.abs(q/b)),q)+this.Ha.o;0>e.x&&(e.x+=b)}else q=c.y-this.Ha.A,f.y=a.Ub.sign(d.y-c.y),e.y=b*a.Ub.Kl(Math.floor(Math.abs(q/b)),q)+this.Ha.A,0>e.y&&(e.y+=b);var q=0!=m?d.y-c.y:d.x-c.x,r=Math.abs(q);if(65536<r/b)throw a.g.X("internal error");if(0<r){r=a.J.truncate(r/b)+2;n.length<r&&(n=a.J.df(r));for(var I=r=0;;I++){var t=
new a.b;t.x=e.x+f.x*I*b;t.y=e.y+f.y*I*b;t=(0!=m?t.y-c.y:t.x-c.x)/q;if(1<=t)break;0>=t||(n[r]=t,r++)}0!=r&&this.a.Em(k,n,r)}}k=l}while(k!=w)}};b.prototype.Fm=function(b,c){for(var d=-1,h=new a.b,e=null,f=this.a.Pb(this.Y);-1!=f;f=this.a.Sb(f))for(var n=this.a.cb(f),g=0,w=this.a.La(f);g<w;g++){var k=this.a.U(n);this.a.w(n,h);if(b?h.y==c:h.x==c)if(this.a.w(k,h),b?h.y==c:h.x==c)-1==d&&(d=this.a.Sd()),null==e&&(e=new a.ha(0),e.zb(100)),1!=this.a.Sa(n,d)&&(e.add(n),this.a.Va(n,d,1)),1!=this.a.Sa(k,d)&&
(e.add(k),this.a.Va(k,d,1));n=k}-1!=d&&this.a.je(d);if(!(null==e||3>e.size)){var l=this;e.Fd(0,e.size,function(a,b){return l.li(a,b)});d=new a.b;f=new a.b;n=new a.b;f.Yc();for(var m=-1,g=new a.ha(0),w=new a.ha(0),k=null,q=this.a.Sd(),r=this.a.Sd(),I=0,t=e.size;I<t;I++){var u=e.get(I);this.a.w(u,h);if(!h.vb(f)){if(-1!=m){for(var v=m;v<I;v++){var m=e.get(v),x=this.a.U(m),u=this.a.Ra(m),z=!1;this.a.w(x,d);0>f.compare(d)&&(b?d.y==c:d.x==c)&&(g.add(m),z=!0,this.a.Va(m,r,1));this.a.w(u,d);0>f.compare(d)&&
(b?d.y==c:d.x==c)&&(z||g.add(m),this.a.Va(m,q,1))}v=0;for(z=g.size;v<z;v++){m=g.get(v);u=this.a.Sa(m,q);x=this.a.Sa(m,r);if(1==u&&(u=this.a.Ra(m),this.a.w(u,n),!n.vb(h))){null==k&&(k=[]);var B=a.b.Cb(f,n);k[0]=a.b.Cb(n,h)/B;0==k[0]?k[0]=2.220446049250313E-16:1==k[0]&&(k[0]=.9999999999999998);this.a.Em(u,k,1);u=this.a.Ra(m);this.a.Nf(u,h);w.add(u);this.a.Va(u,q,1);this.a.Va(u,r,-1)}1==x&&(x=this.a.U(m),this.a.w(x,n),n.vb(h)||(null==k&&(k=[]),B=a.b.Cb(f,n),k[0]=a.b.Cb(f,h)/B,0==k[0]?k[0]=2.220446049250313E-16:
1==k[0]&&(k[0]=.9999999999999998),this.a.Em(m,k,1),u=this.a.U(m),this.a.Nf(u,h),w.add(u),this.a.Va(u,q,-1),this.a.Va(u,r,1)))}m=g;g=w;w=m;w.clear(!1)}m=I;f.L(h)}}this.a.je(q);this.a.je(r)}};b.prototype.xm=function(b,c){for(var d=new a.b,h=null,e=-1,f=0,n=this.md.size;f<n;f++){var g=this.md.get(f);if(-1!=g){var w=this.a.U(g);this.a.w(g,d);if(b?d.y==c:d.x==c)if(this.a.w(w,d),b?d.y==c:d.x==c)-1==e&&(e=this.a.Sd()),null==h&&(h=new a.ha(0),h.zb(100)),-2!=this.a.Sa(g,e)&&(h.add(g),this.a.Va(g,e,-2)),-2!=
this.a.Sa(w,e)&&(h.add(w),this.a.Va(w,e,-2))}}if(null==h)-1!=e&&this.a.je(e);else{var k=this;h.Fd(0,h.size,function(a,b){return k.li(a,b)});f=0;for(n=h.size;f<n;f++){var l=h.get(f);this.a.Va(l,e,f)}g=new a.b;w=new a.b;w.Yc();for(var m=-1,f=0,n=h.size;f<n;f++)if(l=h.get(f),-1!=l&&(this.a.w(l,d),!d.vb(w))){if(-1!=m)for(;;){for(var l=!1,q=1<f-m?f-1:f,r=m;r<q;r++){var I=h.get(r);if(-1!=I){var t=-1,u=this.a.U(I);this.a.w(u,g);0>w.compare(g)&&(b?g.y==c:g.x==c)&&(t=u);var u=-1,v=this.a.Ra(I);this.a.w(v,
g);0>w.compare(g)&&(b?g.y==c:g.x==c)&&(u=v);if(-1!=t&&-1!=u)this.ji(I,h,e),this.a.td(I,!1),this.ji(t,h,e),this.a.td(t,!1),l=!0;else if(-1!=t||-1!=u){for(v=r+1;v<f;v++){var x=h.get(v);if(-1!=x){var z=this.a.U(x),B=-1;this.a.w(z,g);0>w.compare(g)&&(b?g.y==c:g.x==c)&&(B=z);var z=this.a.Ra(x),A=-1;this.a.w(z,g);0>w.compare(g)&&(b?g.y==c:g.x==c)&&(A=z);if(-1!=B&&-1!=A){this.ji(x,h,e);this.a.td(x,!1);this.ji(B,h,e);this.a.td(B,!1);l=!0;break}if(-1!=t&&-1!=A){this.qu(h,I,t,x,A,e);l=!0;break}else if(-1!=
u&&-1!=B){this.qu(h,x,B,I,u,e);l=!0;break}}}if(l)break}}}if(!l)break}m=f;w.L(d)}this.a.je(e)}};b.prototype.ji=function(a,b,c){c=this.a.Sa(a,c);b.set(c,-1);c=this.a.Sa(a,this.Li);this.md.set(c,-1);b=this.a.kd(a);-1!=b&&this.a.cb(b)==a&&(this.a.ig(b,-1),this.a.rh(b,-1))};b.prototype.qu=function(a,b,c,d,e,f){this.a.Jc(b,d);this.a.Kc(d,b);this.a.Kc(c,e);this.a.Jc(e,c);this.ji(d,a,f);this.a.Ni(d,!1);this.ji(e,a,f);this.a.Ni(e,!0)};b.prototype.Ez=function(){for(var a=0,b=this.md.size;a<b;a++){var c=this.md.get(a);
-1!=c&&this.a.Bj(c,-1)}for(var d=0,e=0,f=this.a.Pb(this.Y);-1!=f;){var g=this.a.cb(f);if(-1==g||f!=this.a.kd(g)){var w=f,f=this.a.Sb(f);this.a.ig(w,-1);this.a.Rr(w)}else{c=g;w=0;do this.a.Bj(c,f),w++,c=this.a.U(c);while(c!=g);this.a.Up(f,!1);this.a.rh(f,this.a.Ra(g));this.a.sk(f,w);e+=w;d++;f=this.a.Sb(f)}}a=0;for(b=this.md.size;a<b;a++)if(c=this.md.get(a),-1!=c&&(f=this.a.kd(c),-1==f)){f=this.a.Vf(this.Y,-1);w=0;g=c;do this.a.Bj(c,f),w++,c=this.a.U(c);while(c!=g);2>=w?(c=this.a.Sa(g,this.Li),this.md.set(c,
-1),g=this.a.td(g,!1),2==w&&(c=this.a.Sa(g,this.Li),0<=c&&this.md.set(c,-1),this.a.td(g,!1)),w=f,this.a.ig(w,-1),this.a.Rr(w)):(this.a.ho(f,!0),this.a.sk(f,w),this.a.ig(f,g),this.a.rh(f,this.a.Ra(g)),this.a.Up(f,!1),e+=w,d++)}this.a.Bm(this.Y,d);this.a.qk(this.Y,e);a=0;for(b=this.a.qd;-1!=b;b=this.a.Re(b))a+=this.a.D(b);this.a.CC(a)};b.ye=function(a,c,d,e,f){return(new b(c,f)).fz(a,d,e)};b.clip=function(a,c,d,e,f){return b.rq(a,c,null,d,e,f)};b.rq=function(c,d,e,f,g,K){var h=c.G();if(33==h)return g=
c.w(),d.contains(g)?c:c.Ka();if(197==h)return g=new a.h,c.s(g),g.Ma(d)?(d=new a.di,c.copyTo(d),d.Np(g),d):c.Ka();if(c.u())return c;if(d.u())return c.Ka();var p=new a.h;c.ac(p);if(d.contains(p))return c;if(!d.Yb(p))return c.Ka();if(null!=e||isNaN(f))f=a.na.Xy(e,d,!1);if(!a.T.fh(h))throw a.g.F();e=c.ob;if(null!=e&&(e=e.Ii,null!=e)){e=e.Xn(d);if(1==e){if(1736!=h)throw a.g.X("internal error");c=new a.Ja(c.description);c.oq(d);return c}if(0==e)return c.Ka()}switch(h){case 550:K=null;h=c.D();f=c.Qa(0);
e=0;g=new a.b;for(p=0;p<h;p++)f.fc(2*p,g),d.contains(g)||(0==e&&(K=c.Ka()),e<p&&K.Hd(c,e,p),e=p+1);0<e&&K.Hd(c,e,h);return 0==e?c:K;case 1736:case 1607:return b.ye(c,d,f,g,K);default:throw a.g.X("internal error");}};b.prototype.li=function(b,c){var d=new a.b;this.a.w(b,d);b=new a.b;this.a.w(c,b);return d.compare(b)};return b}();a.th=b})(C||(C={}));(function(a){var b=new a.b,c=function(){function b(b,c,d,h,e){this.In=new a.b;this.hl=new a.b;this.pj=new a.b;this.a=b;this.px=d;this.hp=h;this.In=c;this.im=
e;this.hl.Yc();this.pj.Yc()}b.prototype.HF=function(b){this.a.w(b,this.hl);b=a.J.truncate((this.hl.x-this.In.x)*this.hp+.5);var c=a.J.truncate((this.hl.y-this.In.y)*this.hp+.5);return d.lH(b,c)};b.prototype.Yz=function(a){return this.a.Sa(a,this.im)};b.prototype.zz=function(a,b){this.a.w(a,this.hl);this.a.w(b,this.pj);return d.pw(this.hl.x,this.hl.y,this.pj.x,this.pj.y,this.px)};return b}();a.fZ=function(){return function(){}}();var d=function(){function d(){this.In=new a.b;this.er=[0,0,0,0];this.vt=
[0,0,0,0];this.kp=this.im=-1}d.zR=function(a,b){var c=new d;c.a=a;c.ta=b;c.px=b*b;c.Nw=2*b;c.hp=1/c.Nw;return c.aQ()};d.pw=function(a,b,c,d,h){a-=c;b-=d;return a*a+b*b<=h};d.lH=function(b,c){return a.J.bh(c,a.J.bh(b))};d.prototype.cQ=function(c,h){this.a.Mc(c,b);for(var e=(b.y-this.In.y)*this.hp,p=a.J.truncate((b.x-this.In.x)*this.hp),f=a.J.truncate(e),n=e=0;1>=n;n+=1)for(var y=0;1>=y;y+=1){var g=d.lH(p+n,f+y),w=this.hm.IS(g);-1!=w&&(this.er[e]=w,this.vt[e]=g,e++)}for(p=e-1;1<=p;p--)for(w=this.er[p],
f=p-1;0<=f;f--)if(w==this.er[f]){this.vt[f]=-1;e--;p!=e&&(this.vt[p]=this.vt[e],this.er[p]=this.er[e]);break}for(f=0;f<e;f++)this.dQ(c,this.vt[f],b,this.er[f],h)};d.prototype.dQ=function(b,c,h,e,f){for(var p=new a.b;-1!=e;e=this.hm.YS(e)){var n=this.hm.ia(e);b==n||-1!=c&&this.a.Sa(n,this.im)!=c||(this.a.Mc(n,p),d.pw(h.x,h.y,p.x,p.y,this.px)&&f.add(e))}};d.prototype.Rn=function(a,b,c){var d=this.a.Sa(a,this.kp),h=this.a.Sa(b,this.kp);-1==d&&(d=this.Md.ni(),this.Md.addElement(d,a),this.a.Va(a,this.kp,
d));-1==h?this.Md.addElement(d,b):this.Md.kz(d,h);this.a.Va(b,this.kp,-2);b=this.AV(a,b);c&&(c=this.Yw.HF(a),this.a.Va(a,this.im,c));return b};d.zV=function(b,c,h){b.Eb(c);h=b;var e=new a.b;d.HN(b.w(),c.w(),e);h.rb(e)};d.HN=function(a,b,c){var d=a.x;a.x!=b.x&&(d=(1*a.x+1*b.x)/2);var h=a.y;a.y!=b.y&&(h=(1*a.y+1*b.y)/2);c.ja(d,h)};d.prototype.AV=function(b,c){var d=new a.b;this.a.w(b,d);var h=new a.b;this.a.w(c,h);var e=this.a.fH(b);c=this.a.fH(c);var p=e+c,f=0,n=d.x;d.x!=h.x&&(n=(d.x*e+h.x*c)/p,f++);
var g=d.y;d.y!=h.y&&(g=(d.y*e+h.y*c)/p,f++);0<f&&this.a.rb(b,n,g);this.a.VX(b,p);return 0!=f};d.prototype.aQ=function(){var b=this.a.ud,d=this.a.LG();this.In=d.aA();d=Math.max(d.ea(),d.O())/2147483646;this.Nw<d&&(this.Nw=d,this.hp=1/this.Nw);this.Md=new a.Nu;this.Md.ru(a.J.truncate(this.a.ud/3+1));this.Md.ao(a.J.truncate(this.a.ud/3+1));this.im=this.a.Sd();this.kp=this.a.Sd();this.Yw=new c(this.a,this.In,this.px,this.hp,this.im);this.hm=new a.nM(a.J.truncate(4*b/3),this.Yw);this.hm.bX(this.a.ud);
b=!1;for(d=this.a.qd;-1!=d;d=this.a.Re(d))for(var h=this.a.Pb(d);-1!=h;h=this.a.Sb(h))for(var e=this.a.cb(h),f=0,n=this.a.La(h);f<n;f++){var g=this.Yw.HF(e);this.a.Va(e,this.im,g);this.hm.addElement(e,g);e=this.a.U(e)}var w=new a.ha(0);w.zb(10);for(d=this.a.qd;-1!=d;d=this.a.Re(d))for(h=this.a.Pb(d);-1!=h;h=this.a.Sb(h))for(e=this.a.cb(h),f=0,n=this.a.La(h);f<n;f++){if(-2!=this.a.Sa(e,this.kp))for(g=this.a.Sa(e,this.im),this.hm.jd(e,g);;){this.cQ(e,w);if(0==w.size)break;for(var g=!1,k=0,l=w.size;k<
l;k++){var m=w.get(k),q=this.hm.ia(m);this.hm.Jd(m);g=this.Rn(e,q,k+1==l)||g}b=b||g;w.clear(!1);if(!g)break}e=this.a.U(e)}b&&this.UO();this.Yw=this.hm=null;this.a.je(this.im);this.a.je(this.kp);return b};d.prototype.UO=function(){for(var b=new a.b,c=this.Md.De;-1!=c;c=this.Md.eA(c)){var d=this.Md.wc(c);this.a.w(this.Md.ia(d),b);for(d=this.Md.nb(d);-1!=d;d=this.Md.nb(d))this.a.Nf(this.Md.ia(d),b)}};return d}();a.Ku=d})(C||(C={}));(function(a){var b=function(){function b(a){void 0===a&&(a=null);this.Le=
null;this.xa=!1;null===a?this.Le=[]:this.Le=a}b.prototype.copyTo=function(b){if(b.xa)throw a.g.X("CompositeGeographicTransformation is read-only");for(var c=0;c<this.Le.length;c++)b.Le.push(this.Le[c].Sf())};b.prototype.count=function(){return this.Le.length};b.prototype.KS=function(a){return this.Le[a]};b.prototype.add=function(b){if(this.xa)throw a.g.X("CompositeGeographicTransformation is read-only");this.Le.push(b.Sf())};b.prototype.clear=function(){if(this.xa)throw a.g.X("CompositeGeographicTransformation is read-only");
this.Le.length=0};b.prototype.remove=function(b){if(this.xa)throw a.g.X("CompositeGeographicTransformation is read-only");this.Le.splice(b,1)};b.prototype.Wv=function(){for(var a=this.me(),b=0;b<a.count();b++)a.KS(b).mt();a.Le=a.Le.reverse();return a};b.prototype.me=function(){var a=new b;this.copyTo(a);return a};b.prototype.Sf=function(){return this.me()};b.prototype.transform=function(b,c,d,e){if(b.length<c)throw a.g.X("invalid Argument");var h=d;for(d=0;d<this.Le.length;d++){var p=this.Le[d];if(null!=
p.jn()){var f=p.tn,n=f?1:0,g=f?p.jn().getGeogcs2():p.jn().getGeogcs1(),g=g.getUnit().getUnitFactor(),g=h/g;if(3.552713678800501E-15<Math.abs(g-1))for(h=0;h<c;h++)b[h][0]*=g,b[h][1]*=g;a.VD.geogToGeog(p.jn(),c,b,null,n);h=(f?p.jn().getGeogcs1():p.jn().getGeogcs2()).getUnit().getUnitFactor()}}g=h/e;if(3.552713678800501E-15<Math.abs(g-1))for(h=0;h<c;h++)b[h][0]*=g,b[h][1]*=g;return c};b.prototype.getName=function(){if(0==this.Le.length)return"";for(var a="",b=0,c=this.Le.length;b<c;++b)""!==a&&(a+=" + "),
a+=this.Le[b].getName();return a};b.prototype.Eb=function(a){if(a==this)return!0;if(!(a instanceof b)||this.Le.length!=a.Le.length)return!1;for(var c=0;c<this.Le.length;c++)if(!this.Le[c].Eb(a.Le[c]))return!1;return!0};b.prototype.Tp=function(){this.xa=!0};b.prototype.toString=function(){var a=toString();return 200<a.length?a.substring(0,197)+"... ("+a.length.toString()+" characters)":a};b.create=function(){return new b};b.Om=function(c,d){var h=new b;h.add(a.oo.create(c,d));return h};b.ro=function(c,
d){var h=new b;h.add(a.oo.eG(c,d));return h};return b}();a.ky=b})(C||(C={}));(function(a){var b=Math.PI,c=2*Math.PI,d=Math.PI/2,h=function(){function a(){}a.sQ=function(b,c){var d=new a;d.x=b;d.y=c;d.type=0;d.vi=0;return d};a.Jl=function(b){var c=new a;c.x=b.x;c.y=b.y;c.type=0;c.vi=0;return c};a.rQ=function(b){var c=new a;c.x=b.x;c.y=b.y;c.type=b.type;c.vi=b.vi;return c};a.ae=function(b,c,d){var h=new a;h.x=b.x+c*Math.cos(d);h.y=b.y+c*Math.sin(d);h.type=b.type;h.vi=b.vi;return h};a.Hv=function(b,
c){var d=new a;d.x=.5*(b.x+c.x);d.y=.5*(b.y+c.y);d.type=b.type;d.vi=b.vi;return d};a.ZF=function(b,c){var d=new a;d.x=b.x+.001*(c.x-b.x);d.y=b.y+.001*(c.y-b.y);d.type=b.type;d.vi=b.vi;return d};return a}(),e=function(){return function(){}}();(function(a){a[a.Round=0]="Round";a[a.Bevel=1]="Bevel";a[a.Miter=2]="Miter";a[a.Square=3]="Square"})(a.rM||(a.rM={}));var f=function(){function p(a){this.vB=this.$b=this.Qg=null;this.ie=a}p.V=function(b,c,d,h,e,f){if(null==b)throw a.g.F();if(1>b.ub())throw a.g.F();
if(0==c||b.u())return b;f=new p(f);f.ep=b;f.Pa=c;f.ta=e;f.kj=d;f.lB=h;return f.wy()};p.prototype.UN=function(){var b=this.ep,c=b.ec(),d=b.Ac(),h=new a.b;h.xc(d,c);h.normalize();h.uw();h.scale(this.Pa);c.add(h);d.add(h);h=b.Ka();b.Lc(c);b.Xc(d);return h};p.prototype.TN=function(){var b=this.ep;if(0<this.Pa&&2!=this.kj){var c=new a.Ja;c.hd(b,!1);this.ep=c;return this.wy()}b=new a.di(b.$);b.P(this.Pa,this.Pa);return b};p.prototype.ZJ=function(a,b,c,d){return(b.x-a.x)*(d.x-c.x)+(b.y-a.y)*(d.y-c.y)};p.prototype.pc=
function(a,b){if(void 0===b)this.$b.push(a),this.Hf++;else if(0==this.Hf)this.pc(a);else{var c=this.qx,e,p;e=this.Qg[0==b?c-1:b-1];p=this.Qg[b];var f=this.ZJ(e,p,this.$b[this.Hf-1],a);0<f?this.pc(a):0>f&&(0<this.ZJ(e,p,p,this.$b[this.Hf-1])?(p=this.Qg[0==b?c-2:1==b?c-1:b-2],c=h.ae(e,this.Pa,Math.atan2(e.y-p.y,e.x-p.x)-d),this.$b[this.Hf-1]=c,1==this.kj||2==this.kj?(c=h.Hv(c,e),this.pc(c),c=h.ae(e,this.Pa,this.ww+d),e=h.Hv(c,e),e.type|=256,this.pc(e)):(c=h.ae(e,this.Pa,this.ww+d),c.type|=256),this.pc(c),
this.pc(a,b)):(c=h.ae(p,this.Pa,this.ww+d),this.pc(c),1==this.kj||2==this.kj?(c=h.Hv(c,p),this.pc(c),c=h.ae(p,this.Pa,this.MA-d),e=h.Hv(c,p),e.type|=256,this.pc(e)):(c=h.ae(p,this.Pa,this.MA-d),c.type|=256),this.pc(c)))}};p.prototype.AF=function(){var e,p,f,n,g,y,D=this.qx;this.Hf=0;var w=.5*this.ta,k=0,l=0;for(e=0;e<D;e++){n=this.Qg[e];g=0==e?this.Qg[D-1]:this.Qg[e-1];y=e==D-1?this.Qg[0]:this.Qg[e+1];var m=g.x-n.x,q=g.y-n.y,r=y.x-n.x,I=y.y-n.y;p=Math.atan2(q,m);f=Math.atan2(I,r);this.ww=p;this.MA=
f;0==e&&(k=p,l=f);m=m*I-r*q;q=f;f<p&&(f+=c);if(0<m*this.Pa)1==this.kj||2==this.kj?(p=h.ae(n,this.Pa,p+d),this.pc(p),p=h.ZF(n,p),this.pc(p),p=h.ae(n,this.Pa,f-d),n=h.ZF(n,p),n.type|=256,this.pc(n),this.pc(p)):(m=.5*(f-p),m=this.Pa/Math.abs(Math.sin(m)),p=h.ae(n,m,.5*(p+f)),this.pc(p,e));else if(0!=(n.type&512)){m=1-w/Math.abs(this.Pa);g=1;y=0>this.Pa?-b:b;-1<m&&1>m&&(q=2*Math.acos(m),.017453292519943295>q&&(q=.017453292519943295),g=a.J.truncate(b/q+1.5),1<g&&(y/=g));q=p+d;p=h.ae(n,this.Pa,q);0==e&&
(p.type|=1024);this.pc(p,e);m=this.Pa/Math.cos(y/2);q+=y/2;p=h.ae(n,m,q);p.type|=1024;for(this.pc(p);0<--g;)q+=y,p=h.ae(n,m,q),p.type|=1024,this.pc(p);p=h.ae(n,this.Pa,f-d);p.type|=1024;this.pc(p)}else if(1==this.kj)p=h.ae(n,this.Pa,p+d),this.pc(p,e),p=h.ae(n,this.Pa,f-d),this.pc(p);else if(0==this.kj)for(m=1-w/Math.abs(this.Pa),g=1,y=f-d-(p+d),-1<m&&1>m&&(q=2*Math.acos(m),.017453292519943295>q&&(q=.017453292519943295),g=a.J.truncate(Math.abs(y)/q+1.5),1<g&&(y/=g)),m=this.Pa/Math.cos(.5*y),q=p+d+
.5*y,p=h.ae(n,m,q),this.pc(p,e);0<--g;)q+=y,p=h.ae(n,m,q),this.pc(p);else 2==this.kj?(m=g.x-n.x,q=g.y-n.y,r=y.x-n.x,I=y.y-n.y,g=(m*r+q*I)/Math.sqrt(m*m+q*q)/Math.sqrt(r*r+I*I),.99999999<g?(p=h.ae(n,1.4142135623730951*this.Pa,f-.25*b),this.pc(p,e),p=h.ae(n,1.4142135623730951*this.Pa,f+.25*b),this.pc(p)):(g=Math.abs(this.Pa/Math.sin(.5*Math.acos(g))),y=Math.abs(this.lB*this.Pa),g>y?(m=.5*(f-p),m=this.Pa/Math.abs(Math.sin(m)),p=h.ae(n,m,.5*(p+f)),f=a.b.pa(p.x,p.y),p=a.b.pa(n.x,n.y),n=new a.b,n.xc(f,
p),f=new a.b,f.iX(y/n.length(),n,p),p=(g-y)*Math.abs(this.Pa)/Math.sqrt(g*g-this.Pa*this.Pa),0<this.Pa?n.uw():n.Tr(),n.scale(p/n.length()),p=new a.b,p.add(f,n),g=new a.b,g.xc(f,n),p=h.Jl(p),this.pc(p,e),p=h.Jl(g),this.pc(p)):(m=.5*(f-p),m=this.Pa/Math.abs(Math.sin(m)),p=h.ae(n,m,.5*(p+f)),this.pc(p,e)))):(f=q,0<this.Pa?(f>p&&(f-=c),g=p-f<d):(f<p&&(f+=c),g=f-p<d),g?(m=1.4142135623730951*this.Pa,q=0>m?p+.25*b:p+.75*b,p=h.ae(n,m,q),this.pc(p,e),q=0>m?f-.25*b:f-.75*b,p=h.ae(n,m,q),this.pc(p)):(m=.5*(f-
p),m=this.Pa/Math.abs(Math.sin(m)),f<p&&(f+=c),p=h.ae(n,m,(p+f)/2),this.pc(p,e)))}this.ww=k;this.MA=l;this.pc(this.$b[0],0);n=h.rQ(this.$b[this.Hf-1]);this.$b[0]=n;return this.YW()};p.prototype.pv=function(b,c){if(!(2>c))for(var d=0;d<c;d++){var h=this.$b[b+d];0!=d?this.vB.bj(a.b.pa(h.x,h.y)):this.vB.Bu(a.b.pa(h.x,h.y))}};p.prototype.VN=function(a,b,c){var d=a.wa(b),e=a.Fc(b);this.$b=[];this.vB=c;if(a.Qb(b)){for(b=a.Ba(d);a.Ba(e-1).vb(b);)e--;if(2<=e-d){this.qx=e-d;this.Qg=[];for(b=d;b<e;b++)this.Qg.push(h.Jl(a.Ba(b)));
this.AF()&&this.pv(0,this.Hf-1)}}else{for(b=a.Ba(d);d<e&&a.Ba(d+1).vb(b);)d++;for(b=a.Ba(e-1);d<e&&a.Ba(e-2).vb(b);)e--;if(2<=e-d){this.qx=2*(e-d)-2;this.Qg=[];c=h.Jl(a.Ba(d));c.type|=1536;this.Qg.push(c);for(b=d+1;b<e-1;b++)c=h.Jl(a.Ba(b)),this.Qg.push(c);c=h.Jl(a.Ba(e-1));c.type|=512;this.Qg.push(c);for(b=e-2;b>=d+1;b--)c=h.Jl(a.Ba(b)),c.type|=1024,this.Qg.push(c);if(this.AF())if(2<=this.$b.length){a=-1;(e=0!=(this.$b[this.Hf-1].type&1024))||(a=0);for(b=1;b<this.Hf;b++)(d=0!=(this.$b[b].type&1024))?
e||(e=b-1,1<e-a+1&&this.pv(a,e-a+1)):e&&(a=b-1),e=d;e||(e=this.Hf-1,1<e-a+1&&this.pv(a,e-a+1))}else a=0,e=this.Hf-1,0<=a&&1<=e-a&&this.pv(a,e-a+1)}}this.Qg=null;this.qx=0;this.$b=null;this.Hf=0};p.prototype.YW=function(){for(var a=!1,b=0;b<this.Hf;b++){var c=this.$b[b];c.Oh=b+1;c.Rh=b-1;this.$b[b]=c}c=this.$b[0];c.Rh=this.Hf-2;this.$b[0]=c;c=this.$b[this.Hf-2];c.Oh=0;this.$b[this.Hf-2]=c;for(b=c=0;b<this.Hf;b++)if(0!=(this.$b[c].type&256)){var d=this.$Q(c);if(-1!=d)c=d;else{a=!0;break}}else c=this.$b[c].Oh;
if(a)return!1;this.pQ(c);return!0};p.prototype.$Q=function(a){for(var b=this.Hf-1,c=a,d,h,e=1;e<=b-2;e++){d=c=this.$b[c].Oh;h=a;for(var p=1;p<=e;p++){h=this.$b[h].Rh;if(0==(this.$b[h].type&256)&&0==(this.$b[d].type&256)){var f=this.CT(h,d);if(-1!=f)return f}d=this.$b[d].Rh}}return-1};p.prototype.CT=function(b,c){var d,h,p,f;d=this.$b[this.$b[b].Rh];h=this.$b[b];p=this.$b[this.$b[c].Rh];f=this.$b[c];if(!this.mX(d,h,p,f))return-1;var n=new e;return this.NR(d,h,p,f,n)&&!n.qF&&a.J.GK((h.x-d.x)*(f.y-p.y)-
(h.y-d.y)*(f.x-p.x))!=a.J.GK(this.Pa)?(d=this.$b[b].Rh,n.Vn.type=h.type,n.Vn.Oh=c,n.Vn.Rh=d,this.$b[b]=n.Vn,n.Vn=this.$b[c],n.Vn.Rh=b,this.$b[c]=n.Vn,c):-1};p.prototype.mX=function(a,b,c,d){return Math.max(a.x,b.x)>=Math.min(c.x,d.x)&&Math.max(c.x,d.x)>=Math.min(a.x,b.x)&&Math.max(a.y,b.y)>=Math.min(c.y,d.y)&&Math.max(c.y,d.y)>=Math.min(a.y,b.y)};p.prototype.NR=function(a,b,c,d,e){e.qF=!1;var p,f,n;p=(b.y-a.y)*(d.x-c.x)-(b.x-a.x)*(d.y-c.y);f=(c.y-a.y)*(b.x-a.x)-(c.x-a.x)*(b.y-a.y);p=0==p?2:f/p;return 0<=
p&&1>=p&&(n=p,p=(d.y-c.y)*(b.x-a.x)-(d.x-c.x)*(b.y-a.y),f=(a.y-c.y)*(d.x-c.x)-(a.x-c.x)*(d.y-c.y),p=0==p?2:f/p,0<=p&&1>=p)?(e.Vn=h.sQ(a.x+p*(b.x-a.x),a.y+p*(b.y-a.y)),e.Vn.vi=c.vi+n*(d.vi-c.vi),0!=n&&1!=n||0!=p&&1!=p||(e.qF=!0),e.s_=p,e.t_=n,(0==n||1==n)&&0<p&&1>p||(0==p||1==p)&&0<n&&1>n?!1:!0):!1};p.prototype.pQ=function(a){for(;this.$b[a].Rh<a;)a=this.$b[a].Rh;var b=0,c=a;do c=this.$b[c],this.$b[b]=c,c=c.Oh,b++;while(c!=a);this.$b[b]=this.$b[0];this.Hf=b+1};p.prototype.zE=function(a){var b=this.ep,
c=b.Fa();if(null!=c){c.zj();for(var d=-1;c.Ya();)d++,this.VN(b,d,a)}};p.prototype.wy=function(){var b=this.ep.G();return 322==b?this.UN():197==b?this.TN():a.T.Nc(b)?(b=new a.Ua,b.cc(this.ep,!0),this.ep=b,this.wy()):1607==b?(b=new a.Ua,this.zE(b),b):1736==b?(b=new a.Ja,this.zE(b),b):null};return p}();a.HL=f})(C||(C={}));(function(a){var b=function(){function a(a){this.Uk=a}a.prototype.w=function(a,b){this.Uk.a.w(a,b)};a.prototype.Jd=function(a){var b=this.Uk.Na.ia(a);this.Uk.Na.Jd(a,-1);this.Uk.a.td(b,
!1)};return a}(),c=function(){function a(a){this.Uk=a}a.prototype.w=function(a,b){this.Uk.jV.w(a,b)};a.prototype.Jd=function(a){this.Uk.Na.Jd(a,-1)};return a}(),d=function(){function a(a){this.Uk=a}a.prototype.w=function(a,b){b.L(this.Uk.mV[a])};a.prototype.Jd=function(a){this.Uk.Na.Jd(a,-1)};return a}(),h=function(){function h(h){void 0===h?(this.Na=new a.xk,this.Na.Ne(20),this.a=new a.ed,this.aV=this.a.ah(550),this.Pt=this.a.Vf(this.aV,-1),this.xi=new b(this)):h instanceof Array?(this.Na=new a.xk,
this.Na.Ne(20),this.mV=h,this.xi=new d(this)):(this.Na=new a.xk,this.Na.Ne(20),this.jV=h,this.xi=new c(this))}h.prototype.Jb=function(b){var c=b.G();if(a.Ou.fh(c))this.FO(b);else if(a.Bl.Nc(c))this.MO(b);else if(197==c)this.CO(b);else if(33==c)this.JO(b);else throw a.g.F("invalid shape type");};h.prototype.uS=function(){var b=new a.Wa,c=this.Na.wc(-1),d=new a.Ja(this.a.Gr);this.a.xj(this.Na.ia(c),b);d.Of(b);for(c=this.Na.nb(c);-1!=c;c=this.Na.nb(c))this.a.xj(this.Na.ia(c),b),d.lineTo(b);return d};
h.qQ=function(b){var c=new h(b),d=b.D(),e=1,p=new a.b,f=new a.b,n=new a.b;for(b.w(0,p);;){b.w(e,f);if(!(f.zA(p)&&e<d-1))break;e++}c.Na.addElement(0,-1);c.Na.yo(e);for(d=e+1;d<b.D();d++)b.w(d,n),e=c.RC(n),-1!=e&&c.Na.pk(e,d);n=new a.Wa;e=c.Na.wc(-1);d=new a.Ja(b.description);b.xe(c.Na.ia(e),n);d.Of(n);for(e=c.Na.nb(e);-1!=e;e=c.Na.nb(e))b.xe(c.Na.ia(e),n),d.lineTo(n);return d};h.pa=function(a,b,c){for(var d=new h(a),e=1,p=a[0];a[e].zA(p)&&e<b-1;)e++;d.Na.addElement(0,-1);d.Na.yo(e);for(e+=1;e<b;e++)p=
d.RC(a[e]),-1!=p&&d.Na.pk(p,e);a=0;for(b=d.Na.wc(-1);-1!=b;b=d.Na.nb(b))c[a++]=d.Na.ia(b);return a};h.JH=function(b,c){var d=b.wa(c),e=b.Fc(c);c=!b.Qb(c)&&b.Ko(c);b=b.Qa(0);d*=2;e*=2;c&&(e-=2);if(6>e-d)return!0;c=new a.b;var p=new a.b,f=new a.b;b.fc(d,c);b.fc(d+2,p);b.fc(d+4,f);var n=h.de(p,f,c);if(n.nt()||!h.dc(n.value()))return!1;for(var g=a.b.pa(p.x,p.y),y=new a.b,d=d+6;d<e;d+=2){y.L(p);p.L(f);b.fc(d,f);n=h.de(p,f,c);if(n.nt()||!h.dc(n.value()))return!1;n=h.de(g,f,c);if(n.nt()||!h.dc(n.value()))return!1;
n=h.de(p,f,y);if(n.nt()||!h.dc(n.value()))return!1}return!0};h.prototype.FO=function(b){for(var c=new a.Wa,d=new a.b,h=0;h<b.D();h++){b.w(h,d);var e=this.ys(d);if(-1!=e){b.xe(h,c);var p=this.a.pc(this.Pt,c);this.Na.pk(e,p)}}};h.prototype.CO=function(b){for(var c=new a.Wa,d=new a.b,h=0;4>h;h++){b.Gx(h,d);var e=this.ys(d);if(-1!=e){b.gg(h,c);var p=this.a.pc(this.Pt,c);this.Na.pk(e,p)}}};h.prototype.MO=function(b){var c=new a.Wa,d=b.ec(),d=this.ys(d);if(-1!=d){b.Kp(c);var h=this.a.pc(this.Pt,c);this.Na.pk(d,
h)}d=b.Ac();d=this.ys(d);-1!=d&&(b.Ip(c),b=this.a.pc(this.Pt,c),this.Na.pk(d,b))};h.prototype.JO=function(a){var b=a.w(),b=this.ys(b);-1!=b&&(a=this.a.pc(this.Pt,a),this.Na.pk(b,a))};h.prototype.ys=function(a){var b=-1;if(0==this.Na.size(-1))return b=this.Na.addElement(-4,-1);if(1==this.Na.size(-1)){var c=this.a.Ba(this.Na.ia(this.Na.wc(-1)));a.zA(c)||(b=this.Na.yo(-5));return b}return b=this.RC(a)};h.prototype.RC=function(b){var c=-1,d=this.Na.wc(-1),e=this.Na.Ec(-1),p=this.Na.ia(d),f=this.Na.ia(e),
n=new a.b,g=new a.b;this.xi.w(p,n);this.xi.w(f,g);p=a.b.Gp(g,b,n);if(h.dc(p))c=this.Na.yo(-1),n=this.PC(b,e,d),n!=d&&this.QC(b,d,this.Na.Se(n));else if(h.Hj(p)){for(var g=this.Na.fw(-1),y=this.Na.wc(-1),w=this.Na.Ec(-1),k,p=new a.b,f=new a.b;y!=this.Na.Se(w);)k=this.Na.ia(g),this.xi.w(k,p),k=a.b.Gp(p,b,n),h.Hj(k)?(w=g,g=this.Na.Ul(g)):(y=g,g=this.Na.Nq(g));g=w;n=y;k=this.Na.ia(g);y=this.Na.ia(n);this.xi.w(k,p);this.xi.w(y,f);if(n==d||(p=a.b.Gp(f,b,p),h.dc(p)))c=this.Na.ov(n,g,-2,!1),this.QC(b,g,e),
this.PC(b,n,d)}else null==this.xb&&(this.xb=new a.Hb),this.xb.Lc(g),this.xb.Xc(n),n=this.xb.ne(b,!0),0>n?(n=this.Na.Se(e),this.Na.Jd(e,-1),c=this.Na.yo(-3),this.PC(b,n,d)):1<n&&(n=this.Na.nb(d),this.Na.Jd(d,-1),c=this.Na.ov(-1,n,-3,!1),this.QC(b,n,e));return c};h.prototype.QC=function(b,c,d){if(c!=d){var e=this.Na.ia(c),p=this.Na.nb(c),f=new a.b,n=new a.b;for(this.xi.w(e,f);c!=d&&2<this.Na.size(-1);){this.xi.w(this.Na.ia(p),n);e=a.b.Gp(n,b,f);if(h.dc(e))break;e=c;c=p;f.L(n);p=this.Na.nb(c);this.xi.Jd(e)}}};
h.prototype.PC=function(b,c,d){if(c==d)return d;var e=this.Na.ia(c),p=this.Na.Se(c),f=new a.b,n=new a.b;for(this.xi.w(e,f);c!=d&&2<this.Na.size(-1);){this.xi.w(this.Na.ia(p),n);e=a.b.Gp(f,b,n);if(h.dc(e))break;e=c;c=p;f.L(n);p=this.Na.Se(c);this.xi.Jd(e)}return c};h.de=function(b,c,d){var h=new a.Xb;h.set(c.x);h.sub(b.x);var e=new a.Xb;e.set(d.y);e.sub(b.y);var p=new a.Xb;p.set(c.y);p.sub(b.y);c=new a.Xb;c.set(d.x);c.sub(b.x);h.Tg(e);p.Tg(c);h.sub(p);return h};h.dc=function(a){return 0>a};h.Hj=function(a){return 0<
a};h.os=function(a){return 0==a};return h}();a.Lu=h})(C||(C={}));(function(a){var b=function(){function b(a){this.ie=this.a=null;this.sI=!0;this.ie=a}b.mJ=function(b,c,d){b=a.na.As(b);return a.Ku.pw(c.Te(),c.Cf(),d.Te(),d.Cf(),a.Ub.Yx(b))};b.bQ=function(b,c){var d=new a.Wa;a.Ku.zV(b,c,d);return d};b.V=function(a,c,d,e){d=new b(d);d.a=a;d.ta=c;d.sI=e;return d.gO()};b.prototype.$N=function(b){return a.Ku.zR(this.a,b)};b.prototype.dO=function(b){return a.Mu.V(this.a,b,this.ie)};b.prototype.gO=function(){for(var b=
this.ta,c=a.na.As(b),b=a.na.PO(b),d=1.00001*b,b=1.000001*b,e=!1,f=30<this.a.ud+10?1E3:(this.a.ud+10)*(this.a.ud+10),g=0,w=this.a.FT();;g++){if(g>f)throw a.g.X("Internal Error: max number of iterations exceeded");var k=this.$N(c),e=e||k;this.sI&&(k=0!=this.a.zq(c,!0,!1),e=e||k);k=!1;if(0==g||w||a.Mu.hJ(!0,this.a,b,null,this.ie))k=this.dO(d),e=e||k;if(!k)break}return e};return b}();a.vk=b})(C||(C={}));(function(a){var b=function(){function b(a){this.te=this.Sc=null;this.kx=0;this.mc=a;this.OA=!0}b.prototype.gw=
function(a,b){var c=this.a.jc(a);if(null==c){if(!this.a.nd(a,b))return null;c=b}return c};b.prototype.Or=function(a){void 0===a&&(a=!1);this.kx++;if(a||0==(this.kx&4095))this.kx=0};b.prototype.KQ=function(){var b=this.a.Pr(!1),c=!1,d=new a.Hb,e=new a.Hb,f=new a.h;f.Oa();var n=new a.h;n.Oa();for(var g=new a.Wa,w=new a.jE,k=b.next();-1!=k;k=b.next()){var l=null,m=!1;if(!a.T.Po(this.a.ic(b.Ek))){l=this.gw(k,d);if(null==l)continue;l.s(f);f.P(this.ta,this.ta);if(l.eh(this.ta))if(l.eh(0))m=!0,l=null;else continue}var q=
this.a.Pr(b),r=q.next();for(-1!=r&&(r=q.next());-1!=r;r=q.next()){var I=null,t=!1;if(!a.T.Po(this.a.ic(q.Ek))){I=this.gw(r,e);if(null==I)continue;I.s(n);if(I.eh(this.ta))if(I.eh(0))t=!0,I=null;else continue}var u=0,v=0;if(null!=l&&null!=I)f.HH(n)&&(w.Hp(l),w.Hp(I),w.Ma(this.ta,!1),u=w.Wl(0),v=w.Wl(1),0<u+v&&(this.a.as(k,w,0,!0),this.a.as(r,w,1,!0)),w.clear());else if(null!=l){var x=new a.b;this.a.w(r,x);if(f.contains(x)){w.Hp(l);this.a.xj(r,g);w.vA(this.ta,g,!1);u=w.Wl(0);if(0<u)if(this.a.as(k,w,
0,!0),t){t=-1;for(x=this.a.U(r);-1!=x&&x!=r&&(I=this.gw(x,e),t=x,null!=I&&I.eh(0));x=this.a.U(x));for(x=r;-1!=x&&(this.a.Zh(x,w.ag),x!=t);x=this.a.U(x));}else this.a.Zh(r,w.ag);w.clear()}}else if(null!=I){if(x=new a.b,this.a.w(k,x),n.P(this.ta,this.ta),n.contains(x)){w.Hp(I);this.a.xj(k,g);w.vA(this.ta,g,!1);v=w.Wl(0);if(0<v)if(this.a.as(r,w,0,!0),m){t=-1;for(x=this.a.U(k);-1!=x&&x!=k&&(I=this.gw(x,e),t=x,null!=I&&I.eh(0));x=this.a.U(x));for(x=k;-1!=x&&(this.a.Zh(x,w.ag),x!=t);x=this.a.U(x));}else this.a.Zh(k,
w.ag);w.clear()}}else continue;if(0!=u+v){if(0!=u){l=this.a.jc(k);if(null==l){if(!this.a.nd(k,d))continue;l=d;d.s(f)}else l.s(f);if(l.eh(this.ta))break}c=!0}}}return c};b.prototype.LQ=function(){return this.gW()};b.prototype.gW=function(){return(new a.bE).mY(this.a,this.ta)};b.prototype.iJ=function(){var b=!1,c,d;null==this.Sc&&(this.Sc=new a.xk);var e=new a.ha(0);e.zb(this.a.ud+1);for(var f=this.a.Pr(),n=f.next();-1!=n;n=f.next())e.add(n);this.a.Xx(e,e.size);e.add(-1);f=this.a.Sd();n=this.a.Sd();
this.te=new a.lE(this.a,this.ta,!this.OA);this.Sc.Lp(this.te);var g=new a.ha(0),w=new a.ha(0),k=0;new a.b;var l=this.a.Cd;this.a.yb.vc();for(var m=this.a.yb.ya[0].f,q,r,I=e.get(k++);-1!=I;){r=l.S(I,0);q=m[2*r];r=m[2*r+1];var t=q,u=r;do{var v=l.S(I,2),x=l.S(I,1);-1!=v&&(c=l.S(v,0),d=m[2*c],c=m[2*c+1],0>(u<c?-1:u>c?1:t<d?-1:t>d?1:0)&&(w.add(I),w.add(v)));-1!=x&&(c=l.S(x,0),d=m[2*c],c=m[2*c+1],0>(u<c?-1:u>c?1:t<d?-1:t>d?1:0)&&(w.add(x),w.add(x)));d=this.a.Sa(I,f);-1!=d&&(g.add(d),this.a.Va(I,f,-1));
d=this.a.Sa(I,n);-1!=d&&(g.add(d),this.a.Va(I,n,-1));I=e.get(k++);-1!==I&&(u=l.S(I,0),t=m[2*u],u=m[2*u+1])}while(-1!=I&&t===q&&u===r);t=1==g.size&&2==w.size;d=u=-1;v=0;for(x=g.size;v<x;v++){c=g.get(v);var z=this.Sc.Se(c);-1==z||g.qA(z)||(u=z);c=this.Sc.nb(c);-1==c||g.qA(c)||(d=c);if(-1!=u&&-1!=d)break}this.te.EK(r,q);v=0;for(x=g.size;v<x;v++)c=g.get(v),this.Sc.Jd(c,-1);g.clear(!1);if(!t&&-1!=u&&-1!=d&&this.QP(u,d)){b=!0;this.nj=this.te.ln();break}v=0;for(x=w.size;v<x;v+=2){r=w.get(v);q=w.get(v+1);
t?(r=this.Sc.ov(u,d,r,!0),t=!1):r=this.Sc.addElement(r,-1);if(this.te.Lg){this.nj=this.te.ln();b=!0;break}-1==this.a.Sa(q,f)?this.a.Va(q,f,r):this.a.Va(q,n,r)}if(b)break;w.uf(0)}this.a.je(f);this.a.je(n);return b};b.prototype.QP=function(a,b){this.te.compare(this.Sc,this.Sc.ia(a),b);a=this.te.Lg;this.te.Es();return a};b.Dj=function(b){for(var c=b.qd;-1!=c;c=b.Re(c))if(a.T.Hc(b.ic(c)))return!0;return!1};b.wl=function(a,c,d,e){if(!b.Dj(a))return!1;c=new b(e);c.a=a;c.ta=d;if(15>a.ud)a=c.KQ();else return c.LQ();
return a};b.V=function(a,c,d){return b.wl(a,a.LG(),c,d)};b.hJ=function(c,d,e,f,n){if(!b.Dj(d))return!1;var h=new b(n);h.a=d;h.ta=e;h.OA=c;if(h.iJ())return null!=f&&f.ls(h.nj),!0;var p=new a.Gd;p.AC();d.Vc(p);h=new b(n);h.a=d;h.ta=e;h.OA=c;c=h.iJ();p.AC();d.Vc(p);return c?(null!=f&&f.ls(h.nj),!0):!1};b.vm=function(a,b){a=a.D();return 16>a?!1:2*a+Math.log(a)*Math.LOG10E/Math.log(2)*1*b<1*a*b};b.IQ=function(c,d,e,f){if(a.T.Hc(d.G()))return(new b(f)).JQ(c,d,e);throw a.g.X("crack_A_with_B");};b.prototype.JQ=
function(d,e,f){var h=new a.h;d.ac(h);var p=new a.h;e.ac(p);p.P(f,f);if(!p.Yb(h))return d;var n=d.ob,g=null;null!=n&&(g=n.Mb);b.vm(d,d.D())&&(g=a.na.Pj(d,p));var y=null!=g?g.jf():null,w=e.Fa();e=d.Fa();for(var k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],p=[];w.Ya();)for(;w.Ea();){var l=w.ba();if(null!=g)for(y.bo(l,f),n=y.next();-1!=n;n=y.next()){if(this.Or(),e.Tb(g.ia(n),-1),e.Ea())for(var n=e.ba(),m=n.Ma(l,null,k,null,f),n=0;n<m;++n){var q=k[n];if(0!=q&&1!=q){var r=e.Db(),I=new c;I.t=q;I.index=r;p.push(I)}}}else{var t=
new a.h;l.ac(t);t.P(f,f);if(h.Yb(t))for(e.zj();e.Ya();)for(;e.Ea();)if(this.Or(),n=e.ba(),q=new a.h,n.ac(q),q.Yb(t))for(m=n.Ma(l,null,k,null,f),n=0;n<m;++n)q=k[n],0!=q&&1!=q&&(r=e.Db(),I=new c,I.t=q,I.index=r,p.push(I))}}if(0==p.length)return d;p=p.sort(c.Fs);d=d.Ka();for(e.zj();e.Ya()&&!e.Ea(););f=e.ba();h=new a.Bg;g=-1;n=0;for(y=p.length;n<y;){k=p[n].index;for(w=n+1;w<y&&p[w].index==k;)++w;for(;e.Db()<k;){this.Or();l=e.Ea();q=e.Ta;(t=l||!e.Lo()||e.Mo())&&d.cc(f,g!=q);g=q;if(!l)for(;e.Ya()&&!e.Ea(););
f=e.ba()}for(k=0;n<w;n++)q=p[n].t,q!=k&&(f.yh(k,q,h),k=q,q=e.Ta,d.cc(h.get(),g!=q),g=q);if(t=(l=e.Ea())||!e.Lo()||e.Mo())f.yh(k,1,h),d.cc(h.get(),!1);if(l)f=e.ba();else{for(;e.Ya()&&!e.Ea(););e.Ea()?f=e.ba():f=null}n=w}null!=f&&(q=e.Ta,(t=(l=e.Ea())||!e.Lo()||e.Mo())&&d.cc(f,g!=q),g=q);for(l=e.Ea();;){if(!l){for(;e.Ya()&&!(l=e.Ea()););if(!l)break}f=e.ba();q=e.Ta;(t=(l=e.Ea())||!e.Lo()||e.Mo())&&d.cc(f,g!=q);g=q}return d};return b}();a.Mu=b;var c=function(){function a(){}a.Fs=function(a,b){return a.index==
b.index?a.t>b.t?1:a.t<b.t?-1:0:a.index>b.index?1:-1};return a}()})(C||(C={}));(function(a){(function(a){a[a.Left=0]="Left";a[a.Right=1]="Right";a[a.Coincident=2]="Coincident";a[a.Undefined=3]="Undefined";a[a.Uncut=4]="Uncut"})(a.JL||(a.JL={}));var b=function(){return function(a,b,c,d,h,e,f,n,g,w,k){this.Y=a;this.nx=b;this.Kt=c;this.Ng=d;this.En=w;this.jm=k}}();a.hZ=b;var c=function(){function b(a,b){this.KI=a;this.hj=b}b.prototype.cO=function(b,c){var d=new a.b;this.hj.w(b,d);var h=new a.b;this.hj.w(c,
h);d=d.compare(h);if(0!=d)return d;d=this.hj.Sa(b,this.KI);h=this.hj.Sa(c,this.KI);return d<h?-1:d==h?0:1};return b}(),d=function(){return function(a,b,c,d,h,e,f,n,g){this.Ng=a;this.Kt=b;this.wB=c;this.WI=d;this.ej=h;this.jm=e;this.En=f;this.XI=n;this.pV=g}}();a.gZ=d;var h=function(){function h(){}h.IL=function(c,d,e,f,p,n){if(d.u())c=new b(d,4,-1,-1,NaN,4,-1,-1,NaN,-1,-1,NaN,-1,-1,NaN),p.push(c);else{var g=new a.ed;g.Jb(d);g.Jb(e);a.vk.V(g,f,n,!0);d=0;e=g.Sd();for(f=g.qd;-1!=f;f=g.Re(f))for(n=g.Pb(f);-1!=
n;n=g.Sb(n))for(var y=g.cb(n),D=0,w=g.La(n);D<w;y=g.U(y),D++)g.Va(y,e,d++);d=h.MU(e,g);h.ZO(c,d,g,p)}};h.MU=function(b,d){for(var e=d.ud,f=new a.ha(0),p=d.qd;-1!=p;p=d.Re(p))for(var n=d.Pb(p);-1!=n;n=d.Sb(n))for(var g=d.cb(n),y=0,D=d.La(n);y<D;g=d.U(g),y++)f.add(g);var w=new c(b,d);f.Fd(0,e,function(a,b){return w.cO(a,b)});b=[];var k=[],l=d.Sd(),m=d.Sd(),p=d.qd,n=d.Re(p),D=new a.b,q=new a.b,r=f.get(0),I=d.kd(r),t=d.mg(I);d.w(r,D);for(var u=1,g=0;u<e-1;){for(var v=!1,y=u;y<e;y++)if(y!=g){var x=f.get(y),
z=d.kd(x),B=d.mg(z);d.w(x,q);if(D.vb(q))t==p&&B==n&&(v=h.HP(l,m,d,b,k,I,r,z,x));else break}if(v||g==u-1){v&&g==u-1&&u--;if(++g==e)break;r=f.get(g);I=d.kd(r);t=d.mg(I);d.w(r,D)}v||(u=g+1)}e=[];for(p=d.qd;-1!=p;p=d.Re(p))for(n=d.Pb(p);-1!=n;n=d.Sb(n))for(f=d.cb(n),y=0,D=d.La(n);y<D;f=d.U(f),y++){g=d.Sa(f,m);if(0<=g)for(;g<k.length&&k[g].Ng==f;)e.push(k[g++]);g=d.Sa(f,l);if(0<=g)for(;g<b.length&&b[g].Ng==f;)e.push(b[g++])}d.je(l);d.je(m);return e};h.HP=function(a,b,c,d,e,f,p,n,g){var y=c.Vj(f),D=c.Vj(n),
w=c.cb(f),K=c.cb(n),P=c.Ra(p),k=c.Ra(g),l=!1,N=!1,m=!1,U=!1;p!=w&&(g!=K&&(l=h.XQ(a,c,d,f,P,n,k)),g!=D&&(N=h.qR(a,c,d,f,P,n,g)));p!=y&&(g!=K&&(m=h.ER(b,c,e,f,p,n,k,w)),g!=D&&(U=h.cS(b,c,e,f,p,n,g,w)));l&&N&&m?(a=d.length-1,2==e[U?e.length-2:e.length-1].ej&&(d[a-1]=d[a],--d.length)):l&&N&&U&&2==e[e.length-1].ej&&(e=d[d.length-1],--d.length,c.Sa(e.Ng,a)==d.length&&c.Va(e.Ng,a,-1));return l||N||m||U};h.XQ=function(b,c,h,e,f,p,n){var g,y;y=new a.Hb;var D=new a.Hb,w=[0,0],K=[0,0];g=c.jc(f);null==g&&(c.nd(f,
y),g=y);y=c.jc(n);null==y&&(c.nd(n,D),y=D);g=g.Ma(y,null,w,K,0);2>g&&(e=new d(f,e,w[0],NaN,g,n,p,K[0],NaN),h.push(e),e=c.Sa(f,b),0>e&&c.Va(f,b,h.length-1));return!0};h.qR=function(b,c,h,e,f,p,n){var g,y;y=new a.Hb;var D=new a.Hb,w=[0,0],K=[0,0];g=c.jc(f);null==g&&(c.nd(f,y),g=y);y=c.jc(n);null==y&&(c.nd(n,D),y=D);g=g.Ma(y,null,w,K,0);return 2>g?(e=new d(f,e,w[0],NaN,g,n,p,K[0],NaN),h.push(e),e=c.Sa(f,b),0>e&&c.Va(f,b,h.length-1),!0):!1};h.ER=function(b,c,h,e,f,p,n,g){var y,D;D=new a.Hb;var w=new a.Hb,
K=[0,0],P=[0,0];y=c.jc(f);null==y&&(c.nd(f,D),y=D);D=c.jc(n);null==D&&(c.nd(n,w),D=w);y=y.Ma(D,null,K,P,0);if(2==y)return e=new d(f,e,K[0],K[1],y,n,p,P[0],P[1]),h.push(e),e=c.Sa(f,b),0>e&&c.Va(f,b,h.length-1),!0;w=!1;f==g&&(e=new d(f,e,K[0],NaN,y,n,p,P[0],NaN),h.push(e),e=c.Sa(f,b),0>e&&c.Va(f,b,h.length-1),w=!0);return w};h.cS=function(b,c,h,e,f,p,n,g){var y,D;D=new a.Hb;var w=new a.Hb,K=[0,0],P=[0,0];y=c.jc(f);null==y&&(c.nd(f,D),y=D);D=c.jc(n);null==D&&(c.nd(n,w),D=w);y=y.Ma(D,null,K,P,0);if(2==
y)return e=new d(f,e,K[0],K[1],y,n,p,P[0],P[1]),h.push(e),e=c.Sa(f,b),0>e&&c.Va(f,b,h.length-1),!0;w=!1;f==g&&(e=new d(f,e,K[0],NaN,y,n,p,P[0],NaN),h.push(e),e=c.Sa(f,b),0>e&&c.Va(f,b,h.length-1),w=!0);return w};h.ZO=function(c,d,e,f){var p,n=[];n[0]=new a.b;n[1]=new a.b;n[2]=new a.b;n[3]=new a.b;var g=new a.b,y=new a.b,D=new a.b,w=new a.b,K=null;null!=f&&(K=new a.Bg,K.Hs());var P,k=0,l=null,m=new a.Hb;new a.Hb;for(var q=e.Pb(e.qd);-1!=q;q=e.Sb(q)){var r,I=4,t=-1,u,v,x,z=-1,B,A,F,C,G=-1,E=-1,J=NaN;
r=!0;var H=!1,M=!0,ua=!0,L=!0,O=0;x=q;B=0;for(var R=e.cb(q),Q=e.La(q),S=0;S<Q;R=e.U(R),S++){P=e.jc(R);if(null==P){if(!e.nd(R,m))continue;P=m}-1==z&&(z=R);for(var T=0;k<d.length&&R==d[k].Ng;){t=d[k].Kt;u=d[k].Ng;v=d[k].wB;A=d[k].En;F=d[k].jm;C=d[k].XI;if(2==d[k].ej){if(H||(x=t,z=u,B=v,G=A,E=F,J=C,I=2,null!=f?l=new a.Ua:O=0,L=!1,ua=!0),v=d[k].WI,C=d[k].pV,null!=f?(P.yh(T,d[k].WI,K),l.cc(K.get(),ua)):O++,T=v,H=!0,ua=r=!1,k+1==d.length||2!=d[k+1].ej||d[k+1].Ng==u&&d[k+1].wB!=T)null!=f?(p=new b(l,2,t,
u,v,I,x,z,B,A,F,C,G,E,J),f.push(p)):null.add(O),x=t,z=u,B=v,G=A,E=F,J=C,I=2,H=r=!1,ua=L=!0}else{var W=e.U(u);if(k<d.length-1&&d[k+1].Ng==W&&d[k+1].jm==F&&2==d[k+1].ej)v!=T&&(L&&(null!=f?l=new a.Ua:O=0),r=0<k&&d[k-1].Kt==t?1==I?0:0==I?1:3:3,null!=f?(P.yh(T,v,K),l.cc(K.get(),ua),p=new b(l,r,t,u,v,I,x,z,B,A,F,C,G,E,J),f.push(p)):(O++,null.add(O)),T=v,x=t,z=u,B=v,G=A,E=F,J=C,I=r,r=M=!1,ua=L=!0);else if(!h.JU(c,e,d,k,g,y)){h.GT(e,d,k,q,R,D,w);var V=!1,W=!1;p=!0;if(!(g.vb(D)||y.vb(D)||g.vb(w)||y.vb(w))){n[0].L(g);
n[1].L(y);n[2].L(D);n[3].L(w);n.sort(a.b.ts);var X=n[0],Y=n[1],aa=n[2],Z=n[3];X.vb(g)?Y.vb(y)?c?(W=V=!0,p=!1):V=!1:Z.vb(y)?c?p=W=V=!0:V=!1:(V=!0,p=Y.vb(D)):Y.vb(g)?aa.vb(y)?c?(W=V=!0,p=!1):V=!1:X.vb(y)?c?p=W=V=!0:V=!1:(V=!0,p=aa.vb(D)):aa.vb(g)?Z.vb(y)?c?(W=V=!0,p=!1):V=!1:Y.vb(y)?c?p=W=V=!0:V=!1:(V=!0,p=Z.vb(D)):X.vb(y)?c?(W=V=!0,p=!1):V=!1:aa.vb(y)?c?p=W=V=!0:V=!1:(V=!0,p=X.vb(D))}if(V){V=R==u;if(v!=T||V&&0==T)L&&(null!=f?l=new a.Ua:O=0),null!=f?(P.yh(T,v,K),l.cc(K.get(),ua)):O++;if(p)if(1!=I){if(v!=
T||V&&0==T)null!=f?(p=new b(l,1,t,u,v,I,x,z,B,A,F,C,G,E,J),f.push(p)):null.add(O);if(!W)I=1;else if(k==d.length-2||d[k+2].Kt!=t)I=0}else{if(v!=T||V&&0==T)null!=f?(p=new b(l,3,t,u,v,I,x,z,B,A,F,C,G,E,J),f.push(p)):null.add(O);I=1}else if(0!=I){if(v!=T||V&&0==T)null!=f?(p=new b(l,0,t,u,v,I,x,z,B,A,F,C,G,E,J),f.push(p)):null.add(O);if(!W)I=0;else if(k==d.length-2||d[k+2].Kt!=t)I=1}else{if(v!=T||V&&0==T)null!=f?(p=new b(l,3,t,u,v,I,x,z,B,A,F,C,G,E,J),f.push(p)):null.add(O);I=0}if(v!=T||V&&0==T)T=v,x=
t,z=u,B=v,G=A,E=F,J=C,r=M=!1,ua=L=!0}}}k++}1!=T&&(L&&(null!=f?l=new a.Ua:O=0),null!=f?(P.yh(T,1,K),l.cc(K.get(),ua)):O++,ua=L=!1,M=!0)}M&&(v=1,u=e.Vj(q),u=e.Ra(u),F=A=-1,C=NaN,r?null!=f?(p=new b(l,4,t,u,v,I,x,z,B,A,F,C,G,E,J),f.push(p)):null.add(O):(r=1==I?0:0==I?1:3,null!=f?(p=new b(l,r,t,u,v,I,x,z,B,A,F,C,G,E,J),f.push(p)):null.add(O)))}};h.JU=function(b,c,d,e,f,p){var n=d[e].XI;if(1==n)return h.KT(b,c,d,e,f,p);if(0==n)return h.GU(b,c,d,e,f,p);throw a.g.za();};h.KT=function(b,c,d,h,e,f){var p=new a.Hb,
n=d[h].Ng,g=d[h].En,y=d[h].jm,D=-1,w=-1,K=-1,k=-1;if(!b&&0<h)var P=d[h-1],D=P.Ng,w=P.En,K=P.jm,k=P.ej;var l=-1,N=-1,m=-1,U=-1;h<d.length-1&&(P=d[h+1],l=P.Ng,N=P.En,m=P.jm,U=P.ej);var q=c.U(n),P=c.U(y);if(!b)return 0<h&&D==n&&w==g&&K==P&&2==k||h<d.length-1&&l==q&&N==g&&m==P&&2==U?(b=c.jc(y),null==b&&(c.nd(y,p),b=p),f.L(b.Dg(1)),e.du(f),f.normalize(),e.normalize(),!1):h<d.length-1&&l==n&&N==g&&m==P?(b=c.jc(y),null==b&&(c.nd(y,p),b=p),e.L(b.Dg(1)),b=c.jc(P),null==b&&(c.nd(P,p),b=p),f.L(b.Dg(0)),e.Kr(),
f.normalize(),e.normalize(),!1):!0;if(h==d.length-1||l!=n||N!=g||m!=P||2==U)return b=c.jc(y),null==b&&(c.nd(y,p),b=p),f.L(b.Dg(1)),e.du(f),f.normalize(),e.normalize(),!1;b=c.jc(y);null==b&&(c.nd(y,p),b=p);e.L(b.Dg(1));b=c.jc(P);null==b&&(c.nd(P,p),b=p);f.L(b.Dg(0));e.Kr();f.normalize();e.normalize();return!1};h.GU=function(b,c,d,h,e,f){var p=new a.Hb,n=d[h].Ng,g=d[h].En,y=d[h].jm,D=-1,w=-1,K=-1,k=-1;if(!b&&h<d.length-1)var P=d[h+1],D=P.Ng,w=P.En,K=P.jm,k=P.ej;var l=-1,N=-1,m=-1,P=-1;0<h&&(P=d[h-1],
l=P.Ng,N=P.En,m=P.jm,P=P.ej);var U=c.U(n),q=c.Ra(y);return b?0==h||l!=n||N!=g||m!=q||2==P?(b=c.jc(y),null==b&&(c.nd(y,p),b=p),f.L(b.Dg(0)),e.du(f),f.normalize(),e.normalize(),!1):!0:0<h&&l==n&&N==g&&m==q&&2==P||h<d.length-1&&D==U&&w==g&&K==q&&2==k?(b=c.jc(y),null==b&&(c.nd(y,p),b=p),f.L(b.Dg(0)),e.du(f),f.normalize(),e.normalize(),!1):!0};h.GT=function(b,c,d,h,e,f,p){var n=new a.Hb,g=b.jc(e);null==g&&(b.nd(e,n),g=n);d=c[d];c=d.Ng;d=d.wB;e=b.U(c);if(1==d)f.L(g.Dg(1)),-1!=e&&e!=b.Vj(h)?(g=b.jc(e),null==
g&&(b.nd(e,n),g=n),p.L(g.Dg(0)),g=b.jc(c),null==g&&b.nd(c,n)):p.L(f),f.Kr(),p.normalize(),f.normalize();else if(0==d)p.L(g.Dg(d)),f.du(p),p.normalize(),f.normalize();else throw a.g.za();};return h}();a.KL=h})(C||(C={}));(function(a){(function(a){a[a.Linear=0]="Linear";a[a.Angular=1]="Angular";a[a.Area=2]="Area"})(a.GN||(a.GN={}));var b=function(){function b(a,b,c){this.sd=b;this.Bi=c;this.eB=a}b.prototype.Eb=function(a){return a instanceof b?this.Bi===a.Bi:!1};b.cH=function(a){return 0!==a.sd?null:
-1===a.eB?new b(-1,2,a.Bi*a.Bi):b.vh(f[a.eB])};b.vh=function(a){a=e[a];return void 0===a?null:a};b.yQ=function(a,c,d){var h=null;if(void 0!==d&&null!==d)try{"EPSG"===d.values[0]&&(h=b.vh(parseInt(d.values[1])))}catch(xa){}null===h&&(h=new b(-1,a,c));return h};b.prototype.Bc=function(){return this.eB};b.prototype.GG=function(b){if(b.sd!=this.sd)throw a.g.Da();return this.Bi/b.Bi};b.mi=function(a,b,c){return b.GG(c)*a};b.cG=function(a,b,c,d,h){c=c.GG(d);for(d=0;d<b;d++)h[d]=a[d]*c};return b}();a.$c=
b;for(var c=[109401,1E4,109402,4046.8564224,109403,4046.87260987425,109404,1,109405,.09290304,109406,.09290341161327487,109407,.09290137299531805,109408,3.34450944,109409,3429904,109410,1.000027193184865,109411,404.6872609874253,109412,.04046872609874253,109413,2589998.4703195216,109414,1E6,109415,.8361123569578626,109416,404.67838076760535,109417,.04046783807676053,109418,.8361244606523066,109419,.09290271785025629,109420,404.68423895571647,109421,.04046842389557164,109422,.83612589696064,109423,
.0929028774400711,109424,404.6849341289498,109425,.04046849341289498,109426,.836125904805842,109427,.09290287831176021,109428,404.68493792602754,109429,.04046849379260275,109430,.09290354800069446,109431,.09290274144751023,109432,.09290207073852812,109433,.09290279616016,109434,.09290273520025,109435,.836124673027592,109436,.836118636646753,109437,.8361251654414399,109438,.83612461680225,109439,2589988.110336,109440,.09290286332673177,109441,.09290349665192114,109442,.83612736,109443,.8361307045194736,
109444,404.68564224000005,109445,.04046856422400001,109446,.8361237024040001,109447,.0929026336004445,109448,404.683871963536,109449,.0404683871963536,109450,.01,109451,1E-4,109452,1E-6,109453,6.4516E-4,109454,6.451625806477421E-4,109455,25.292852640000003,109456,25.29295381171408,109457,3434528.1495040003,109458,3434290.937856,109459,2.89612324,109460,25E8,109461,225E8,109462,.7168473118308245,109463,100,109464,1.244521604938272E-7,109465,1E-12,109466,1E-18],d=[1031,4.84813681109536E-9,9101,1,9102,
.0174532925199433,9103,2.908882086657216E-4,9104,4.84813681109536E-6,9105,.01570796326794897,9106,.01570796326794897,9109,1E-6,9112,1.570796326794897E-4,9113,1.570796326794897E-6,9114,9.817477042468104E-4],h=[1025,.001,109452,1033,.01,109451,9001,1,109404,9002,.3048,109405,9003,.3048006096012192,109406,9005,.3047972654,109407,9014,1.8288,109408,9030,1852,109409,9031,1.0000135965,109410,9033,20.11684023368047,109411,9034,.2011684023368047,109412,9035,1609.3472186944375,109413,9036,1E3,109414,9037,
.9143917962000001,109415,9038,20.1166195164,109416,9039,.201166195164,109417,9040,.9143984146160287,109418,9041,.304799471538676,109419,9042,20.116765121552632,109420,9043,.2011676512155263,109421,9050,.9143992,109422,9051,.3047997333333333,109423,9052,20.1167824,109424,9053,.201167824,109425,9060,.9143992042898124,109426,9061,.3047997347632708,109427,9062,20.116782494375872,109428,9063,.2011678249437587,109429,9070,.3048008333333334,109430,9080,.3047995102481469,109431,9081,.30479841,109432,9082,
.3047996,109433,9083,.3047995,109434,9084,.9143985307444408,109435,9085,.91439523,109436,9086,.9143988,109437,9087,.9143985,109438,9093,1609.344,109439,9094,.3047997101815088,109440,9095,.3048007491,109441,9096,.9144,109442,9097,20.1168,109444,9098,.201168,109445,9099,.914398,109446,9300,.3047993333333334,109447,9301,20.116756,109448,9302,.20116756,109449,109001,.9144,109442,109002,.9144018288036576,109443,109003,20.1168,109444,109004,.201168,109445,109005,.1,109450,109006,.01,109451,109007,.001,
109452,109008,.0254,109453,109009,.0254000508001016,109454,109010,5.0292,109455,109011,5.029210058420118,109456,109012,1853.248,109457,109013,1853.184,109458,109014,1.7018,109459,109015,.8466683600033867,109462,109016,3.527777777777778E-4,109464,109017,1E-6,109465,109018,1E-9,109466,109030,5E4,109460,109031,15E4,109461],e=[],f=[],g=0;g<c.length;g+=2)e[c[g]]=new b(c[g],2,c[g+1]);c=null;for(g=0;g<d.length;g+=2)e[d[g]]=new b(d[g],1,d[g+1]);d=null;for(g=0;g<h.length;g+=3)e[h[g]]=new b(h[g],0,h[g+1]),
f[h[g]]=h[g+2];h=null})(C||(C={}));(function(a){var b=function(){function a(){this.Gb=this.qb=0}a.prototype.set=function(a,b){void 0!==b?(this.qb=a,this.Gb=b):"number"===typeof a?(this.qb=a,this.Gb=0):(this.qb=a.qb,this.Gb=a.Gb)};a.prototype.value=function(){return this.qb};a.prototype.add=function(a){var b=this.qb+a.qb;a=this.Gb+a.Gb+2.220446049250313E-16*Math.abs(b);this.qb=b;this.Gb=a};a.prototype.GO=function(){var a=this.qb+1,b=this.Gb+2.220446049250313E-16*Math.abs(a);this.qb=a;this.Gb=b};a.prototype.zO=
function(a,b){this.qb=a.qb+b.qb;this.Gb=a.Gb+b.Gb+2.220446049250313E-16*Math.abs(this.qb)};a.prototype.sub=function(a){if("number"===typeof a){var b=this.qb-a;a=this.Gb+2.220446049250313E-16*Math.abs(b)}else b=this.qb-a.qb,a=this.Gb+a.Gb+2.220446049250313E-16*Math.abs(b);this.qb=b;this.Gb=a};a.prototype.Tg=function(a){var b=this.qb*a.qb;this.Gb=this.Gb*Math.abs(a.qb)+a.Gb*Math.abs(this.qb)+this.Gb*a.Gb+2.220446049250313E-16*Math.abs(b);this.qb=b};a.prototype.Fp=function(a){var b=this.qb*a;this.Gb=
this.Gb*Math.abs(a)+2.220446049250313E-16*Math.abs(b);this.qb=b};a.prototype.um=function(a,b){var c=Math.abs(a.qb)*Math.abs(b.qb);this.Gb=a.Gb*Math.abs(b.qb)+b.Gb*Math.abs(a.qb)+a.Gb*b.Gb+2.220446049250313E-16*Math.abs(c);this.qb=c};a.prototype.bn=function(a){var b=Math.abs(a.qb),c=this.qb/a.qb,d=(this.Gb+Math.abs(c)*a.Gb)/b;a.Gb>.01*b&&(a=a.Gb/b,d*=1+(1+a)*a);this.qb=c;this.Gb=d+2.220446049250313E-16*Math.abs(c)};a.prototype.sqrt=function(){var a,b;0<=this.qb?(a=Math.sqrt(this.qb),b=this.qb>10*this.Gb?
.5*this.Gb/a:this.qb>this.Gb?a-Math.sqrt(this.qb-this.Gb):Math.max(a,Math.sqrt(this.qb+this.Gb)-a),b+=2.220446049250313E-16*Math.abs(a)):this.qb<-1*this.Gb?b=a=NaN:(a=0,b=Math.sqrt(this.Gb));this.qb=a;this.Gb=b};a.prototype.sin=function(a){var b=Math.sin(a.qb),c=Math.cos(a.qb);this.qb=b;b=Math.abs(b);this.Gb=(Math.abs(c)+.5*b*a.Gb)*a.Gb+2.220446049250313E-16*b};a.prototype.cos=function(a){var b=Math.sin(a.qb),c=Math.cos(a.qb);this.qb=c;c=Math.abs(c);this.Gb=(Math.abs(b)+.5*c*a.Gb)*a.Gb+2.220446049250313E-16*
c};a.prototype.Kg=function(){return Math.abs(this.qb)<=this.Gb};a.prototype.nt=function(){return this.Kg()&&0!=this.Gb};return a}();a.Xb=b})(C||(C={}));var na=new C.b,pa=new C.b,sa=new C.b,ta=new C.b,W=new C.b;(function(a){var b;(function(a){a[a.closedPath=1]="closedPath";a[a.exteriorPath=2]="exteriorPath";a[a.ringAreaValid=4]="ringAreaValid"})(b||(b={}));var c=function(){function b(a,b,c,d,e,f,n){void 0!==b?(this.bb=a,this.Ek=b,this.Ll=c,this.Ki=d,this.Ca=f,this.TA=n,this.Uw=e):(this.bb=a.bb,this.Ek=
a.Ek,this.Ll=a.Ll,this.Ki=a.Ki,this.Ca=a.Ca,this.TA=a.TA,this.Uw=a.Uw);this.aI=!0}b.prototype.next=function(){return this.aI?(this.aI=!1,this.Ki):-1!=this.Ki?(this.Ki=this.bb.U(this.Ki),this.Ca++,-1!=this.Ki&&this.Ki!=this.Uw?this.Ki:this.CV()):-1};b.prototype.CV=function(){this.Ll=this.bb.Sb(this.Ll);for(this.Ca=0;-1!=this.Ek;){for(;-1!=this.Ll;this.Ll=this.bb.Sb(this.Ll))if(this.Uw=this.Ki=this.bb.cb(this.Ll),-1!=this.Ki)return this.Ki;this.Ek=this.bb.Re(this.Ek);if(-1==this.Ek)break;if(!this.TA||
a.T.Hc(this.bb.ic(this.Ek)))this.Ll=this.bb.Pb(this.Ek)}return-1};b.UQ=function(a,c,d,e,f,n,g){return new b(a,c,d,e,f,n,g)};return b}();a.nZ=c;b=function(){function b(){this.cp=this.un=this.$k=this.ld=this.gl=this.pp=this.oj=this.rd=this.Ci=this.oh=this.tf=this.Gr=this.Jr=this.yb=this.sm=null;this.cx=this.qd=-1;this.ud=0;this.RA=!1;this.Gr=this.Jr=this.yb=null}b.prototype.ui=function(a){return null!=this.tf?this.tf[a]:null};b.prototype.sh=function(a,b){if(null==this.tf){if(null==b)return;this.tf=
[];for(var c=0,d=this.yb.D();c<d;c++)this.tf.push(null)}this.tf[a]=b};b.prototype.Sp=function(a,b){this.rd.R(a,1,b)};b.prototype.Rp=function(a,b){this.rd.R(a,2,b)};b.prototype.wC=function(a,b){this.rd.R(a,6,b)};b.prototype.Lq=function(a){return this.rd.S(a,6)};b.prototype.Rx=function(a,b){this.rd.R(a,7,b)};b.prototype.dw=function(a){return this.rd.S(a,0)};b.prototype.tK=function(a,b){this.ld.R(a,1,b)};b.prototype.xK=function(a,b){this.ld.R(a,0,b)};b.prototype.MG=function(a){return this.ld.S(a,7)};
b.prototype.Pp=function(a,b){this.ld.R(a,3,b)};b.prototype.Qp=function(a,b){this.ld.R(a,4,b)};b.prototype.JV=function(b){null==this.ld&&(this.ld=new a.Zc(8));var c=this.ld.Me();this.ld.R(c,2,b);this.ld.R(c,5,0);this.ld.R(c,6,0);this.ld.R(c,7,c);return c};b.prototype.bS=function(a){this.ld.jd(a)};b.prototype.LV=function(b){null==this.rd&&(this.rd=new a.Zc(8),this.Cd=new a.Zc(5),this.oj=new a.Pd(0),this.pp=new a.Pd(0));var c=this.rd.Me();this.rd.R(c,0,c);this.rd.R(c,3,0);this.rd.R(c,6,0);this.Rx(c,
b);c>=this.oj.size&&(b=16>c?16:a.J.truncate(3*c/2),this.oj.resize(b),this.pp.resize(b));this.oj.set(c,0);this.pp.set(c,0);return c};b.prototype.wG=function(a){this.rd.jd(a)};b.prototype.Fz=function(a){this.Cd.jd(a);this.ud--};b.prototype.lJ=function(b){null==this.rd&&(this.rd=new a.Zc(8),this.Cd=new a.Zc(5),this.oj=new a.Pd(0),this.pp=new a.Pd(0));var c=this.Cd.Me(),d=0<=b?b:c;this.Cd.R(c,0,d);if(0>b){if(d>=this.yb.D()){b=16>d?16:a.J.truncate(3*d/2);this.yb.resize(b);if(null!=this.tf)for(var h=0;h<
b;h++)this.tf.push(null);null!=this.oh&&this.oh.resize(b);this.Jr=this.yb.Qa(0)}this.yb.rb(d,-1E38,-1E38);null!=this.tf&&(this.tf[d]=null);null!=this.oh&&this.oh.write(d,1)}this.Cd.R(c,4,2*d);this.ud++;return c};b.prototype.$j=function(a,b,c){var d=-1!=b?this.Ra(b):this.Vj(a),h=-1!=d?this.U(d):-1,e=this.lJ(null==c?this.ud:-1),f=this.Za(e);null!=c&&this.yb.xu(f,c);this.Bj(e,a);this.Jc(e,h);this.Kc(e,d);-1!=h&&this.Kc(h,e);-1!=d&&this.Jc(d,e);c=this.Qb(a);d=this.cb(a);-1==b&&this.rh(a,e);b==d&&this.ig(a,
e);c&&-1==h&&(this.Jc(e,e),this.Kc(e,e));this.sk(a,this.La(a)+1);a=this.mg(a);this.qk(a,this.D(a)+1);return e};b.prototype.gn=function(){null==this.cp&&(this.cp=new a.Wa(this.yb.description));return this.cp};b.prototype.Op=function(a,b){this.ld.R(a,2,this.ld.S(a,2)&-134217729||(1==b?134217728:0))};b.prototype.Eo=function(a){return 0!=(this.ld.S(a,2)&134217728)?1:0};b.prototype.DO=function(a){var b=this.ah(a.G(),a.description);1736==a.G()&&this.Op(b,a.Eo());this.iF(b,a);return b};b.prototype.EO=function(a){var b=
this.ah(a.G(),a.description);this.jF(b,a);return b};b.prototype.sW=function(b,c){null==this.rd&&(this.rd=new a.Zc(8),this.Cd=new a.Zc(5),this.oj=new a.Pd(0),this.pp=new a.Pd(0));this.rd.Ne(this.rd.xd+b);this.Cd.Ne(this.Cd.xd+c);this.oj.zb(this.oj.size+b);this.pp.zb(this.pp.size+b)};b.prototype.iF=function(b,c){this.sW(c.aa(),c.D());this.sm.Hd(c,0,c.D());this.Jr=this.yb.Qa(0);for(var d=null!=this.tf&&null!=c.$e,h=0,e=c.aa();h<e;h++)if(!(2>c.La(h))){var f=this.Vf(b,-1);this.ho(f,c.Qb(h));for(var p=
c.wa(h),n=c.Fc(h);p<n;p++){var g=this.$j(f,-1,null);if(d)if(g=this.Za(g),0!=(c.aH(p)&1))this.sh(g,null);else{var w=new a.Bg;c.jc(p,w,!0);this.sh(g,w.get())}}}};b.prototype.jF=function(a,b){this.sm.Hd(b,0,b.D());this.Jr=this.yb.Qa(0);a=this.Vf(a,-1);var c=0;for(b=b.D();c<b;c++)this.$j(a,-1,null)};b.prototype.kY=function(b,c,d){var h=this.U(b);if(-1==h)throw a.g.za();for(var e=this.gn(),f=this.kd(b),p=0,n=c.Wl(d);p<n;p++){var g=this.Za(b),y=this.U(b),w=c.Mq(d,p);0==p&&(w.Kp(e),this.Zh(b,e));322==w.G()?
this.sh(g,null):this.sh(g,a.T.me(w));w.Ip(e);p<n-1?b=this.$j(f,y,e):this.Zh(h,e)}};b.prototype.jY=function(b,c,d){var h=this.U(b);if(-1==h)throw a.g.za();for(var e=this.gn(),f=this.kd(b),p=0,n=c.Wl(d);p<n;p++){var g=this.Za(b),y=this.U(b),w=c.Mq(d,n-p-1);0==p&&(w.Ip(e),this.Zh(b,e));322==w.G()?this.sh(g,null):this.sh(g,a.T.me(w));w.Kp(e);p<n-1?b=this.$j(f,y,e):this.Zh(h,e)}};b.prototype.LG=function(){var b=new a.h;b.Oa();for(var c=this.Pr(),d=new a.b,e=!0,f=c.next();-1!=f;f=c.next())this.w(f,d),e?
b.Nb(d.x,d.y):b.ol(d.x,d.y),e=!1;return b};b.prototype.Jb=function(b){var c=b.G();if(a.T.Hc(c))return this.DO(b);if(550==c)return this.EO(b);throw a.g.za();};b.prototype.TO=function(b,c){var d=c.G();if(a.T.Hc(d))this.iF(b,c);else if(550==d)this.jF(b,c);else throw a.g.za();};b.prototype.IO=function(b,c){var d=this.ah(1736,b.description);if(2>b.La(c))return d;this.sm.Hd(b,b.wa(c),b.Fc(c));this.Jr=this.yb.Qa(0);var h=this.Vf(d,-1);this.ho(h,b.Qb(c)||!0);var e=null!=this.tf&&null!=b.$e,f=b.wa(c);for(c=
b.Fc(c);f<c;f++){var p=this.$j(h,-1,null);if(e)if(p=this.Za(p),0!=(b.aH(f)&1))this.sh(p,null);else{var n=new a.Bg;b.jc(f,n,!0);this.sh(p,n.get())}}return d};b.prototype.Pe=function(b){var c=this.ic(b),d=a.fM.ah(c,this.sm.description),h=this.D(b);if(0==h)return d;if(a.T.Hc(c)){for(var c=this.aa(b),e=a.Tc.wh(c+1),f=a.Tc.vq(c+1,0),n=d.description,g=0,w=n.Ga;g<w;g++){for(var k=n.pd(g),l=a.ma.Xa(k),m=a.Tc.oz(k,h),q=this.yb.Qa(k),r=0,I=0,t=0,u=this.Pb(b);-1!=u;u=this.Sb(u)){var v=0;this.Qb(u)&&(v|=1);this.tU(u)&&
(v|=4);0!=v&&f.lC(I,v);var x=this.La(u);e.write(I++,t);t+=x;if(0==k)for(var x=q,z=m,B=new a.b,v=this.cb(u);r<t;v=this.U(v),r++){var A=this.Za(v);x.fc(2*A,B);z.mo(2*r,B)}else for(v=this.cb(u);r<t;v=this.U(v),r++)for(A=this.Za(v),z=0;z<l;z++)B=q.Lf(A*l+z),m.Im(r*l+z,B)}d.eo(k,m);e.write(c,h)}d.uK(f);d.vK(e);d.Cc(16777215)}else if(550==c){n=d.description;d.resize(h);g=0;for(w=n.Ga;g<w;g++){k=n.pd(g);l=a.ma.Xa(k);m=d.Qa(k);q=this.yb.Qa(k);r=0;u=this.Pb(b);x=this.La(u);for(v=this.cb(u);r<x;v=this.U(v),
r++)for(A=this.Za(v),z=0;z<l;z++)B=q.Lf(A*l+z),m.Im(r*l+z,B);d.eo(k,m)}d.Cc(16777215)}return d};b.prototype.dC=function(a){for(var b=this.Pb(a);-1!=b;b=this.Qr(b));var b=this.iT(a),c=this.Re(a);-1!=b?this.tK(b,c):this.qd=c;-1!=c?this.xK(c,b):this.cx=b;this.bS(a)};b.prototype.ah=function(b,c){return void 0===c?this.fG(b,a.we.Hg()):this.fG(b,c)};b.prototype.fG=function(b,c){b=this.JV(b);null==this.yb?this.yb=this.sm=new a.Dd(c):this.sm.tm(c);this.Gr=this.sm.description;this.RA=1<this.Gr.Ga;-1==this.qd?
this.qd=b:(this.xK(b,this.cx),this.tK(this.cx,b));return this.cx=b};b.prototype.Re=function(a){return this.ld.S(a,1)};b.prototype.iT=function(a){return this.ld.S(a,0)};b.prototype.ic=function(a){return this.ld.S(a,2)&2147483647};b.prototype.lK=function(b,c,d){c=this.$k[c];b=this.MG(b);b>=c.size&&c.resize(Math.max(a.J.truncate(1.25*b),16),-1);c.write(b,d)};b.prototype.NG=function(a,b){a=this.MG(a);b=this.$k[b];return a<b.size?b.read(a):-1};b.prototype.gG=function(){null==this.$k&&(this.$k=[]);for(var b=
0;b<this.$k.length;b++)if(null==this.$k[b])return this.$k[b]=a.Tc.wh(0),b;this.$k.push(a.Tc.wh(0));return this.$k.length-1};b.prototype.ZW=function(a){this.$k[a]=null};b.prototype.Pb=function(a){return this.ld.S(a,3)};b.prototype.Xv=function(a){return this.ld.S(a,4)};b.prototype.D=function(a){return this.ld.S(a,5)};b.prototype.aa=function(a){return this.ld.S(a,6)};b.prototype.zq=function(b,c,d){for(var h=0,e=this.qd;-1!=e;e=this.Re(e)){var f=this.ic(e);if(a.T.Hc(f)&&(!d||1736==f))for(var f=1736==
this.ic(e),p=this.Pb(e);-1!=p;){for(var n=0,g=this.cb(p);n<a.J.truncate(this.La(p)/2);){var y=this.U(g);if(-1==y)break;var w=this.Za(g),k=this.ui(w);null!=k?w=k.Rb():(k=this.Za(y),w=this.yb.vs(w,k));w<=b?(0==w?0==h&&(h=-1):h=1,y!=this.Vj(p)&&(this.MC(y,g),this.td(y,!0))):g=this.U(g);n++}n=this.cb(p);for(g=this.Qb(p)?n:this.Vj(p);0<this.La(p);)if(y=this.Ra(g),-1!=y){var l=this.Za(y),k=this.ui(l);null!=k?w=k.Rb():(w=this.Za(g),w=this.yb.vs(w,l));if(w<=b)0==w?0==h&&(h=-1):h=1,this.MC(y,g),this.td(y,
!1),n==y&&(n=this.cb(p));else if(g=this.Ra(g),g==n)break}else{this.td(g,!0);0==h&&(h=-1);break}g=this.La(p);c&&(f?3>g:2>g)?(p=this.Qr(p),h=0<g?1:0==h?-1:h):p=this.Sb(p)}}return h};b.prototype.MC=function(a,b){var c=this.Za(a),d=this.Za(b);null!=this.oh&&(c=this.oh.read(c),this.oh.write(d,c));if(null!=this.Ci)for(d=0,c=this.Ci.length;d<c;d++)if(null!=this.Ci[d]){var h=this.Sa(a,d);-1!=h&&this.Va(b,d,h)}};b.prototype.Em=function(b,c,d){var h=0,e=this.U(b);if(-1==e)throw a.g.za();for(var f=this.Za(b),
p=this.Za(e),n=this.ui(f),g=null==n?this.yb.vs(f,p):n.Rb(),y=0;y<d;y++){var w=c[y];if(0<w&&1>w){var k=w;null!=n&&(k=0<g?n.zy(w)/g:0);this.yb.HE(f,p,k,this.gn());var l=this.$j(this.kd(b),e,this.gn());h++;if(null!=n){var m=n.Ml(0,w),k=this.Za(this.Ra(l));this.sh(k,m);this.Nf(l,m.Ac());if(y==d-1||1==c[y+1])w=n.Ml(w,1),this.sh(k,w)}}}return h};b.prototype.iY=function(b,c,d){var h=0,e=this.U(b);if(-1==e)throw a.g.X("internal error");var f=this.Za(b),p=this.Za(e),n=this.ui(f),g=null==n?this.yb.vs(f,p):
n.Rb(),y=0;b=this.kd(b);for(var w=0;w<d;w++){var k=c[w];if(y<k&&1>k){var l=k;null!=n&&(l=0<g?n.zy(k)/g:0);this.yb.HE(f,p,l,this.gn());l=this.WT(b,e,this.gn());h++;if(null!=n){var y=n.Ml(y,k),m=this.Za(this.Ra(l));this.sh(m,y);this.rb(l,y.sa,y.oa);if(w==d-1||1==c[w+1])y=n.Ml(k,1),l=this.Za(l),this.sh(l,y)}}y=k}return h};b.prototype.WT=function(a,b,c){var d=-1!=b?this.Ra(b):this.Vj(a),h=-1!=d?this.U(d):-1,e=this.lJ(null==c?this.ud:-1),f=this.Za(e);null!=c&&this.yb.xu(f,c);this.Bj(e,a);this.Jc(e,h);
this.Kc(e,d);-1!=h&&this.Kc(h,e);-1!=d&&this.Jc(d,e);c=this.Qb(a);d=this.cb(a);-1==b&&this.rh(a,e);b==d&&(c&&-1!=d||this.ig(a,e));c&&-1==h&&(this.Jc(e,e),this.Kc(e,e));this.sk(a,this.La(a)+1);a=this.mg(a);this.qk(a,this.D(a)+1);return e};b.prototype.FF=function(b,c,d){var h=this.Za(c),e=this.Za(d);if(0>h||e>this.ud-1)throw a.g.F("invalid call");if(h>e&&!this.Qb(b))throw a.g.F("cannot iterate across an open path");for(b=0;c!=d;c=this.U(c))h=this.Za(c),e=this.ui(h),null!=e?b+=e.Rb():(e=this.Za(this.U(c)),
b+=this.yb.vs(h,e));return b};b.prototype.Zh=function(a,b){var c=this.Za(a);this.yb.xu(c,b);c=this.ui(c);null!=c&&c.setStart(b);a=this.Ra(a);-1!=a&&(a=this.Za(a),null!=this.ui(a)&&c.setEnd(b))};b.prototype.xj=function(a,b){a=this.Za(a);this.yb.xe(a,b)};b.prototype.Nf=function(a,b){this.rb(a,b.x,b.y)};b.prototype.rb=function(a,b,c){var d=this.Za(a);this.yb.rb(d,b,c);d=this.ui(d);null!=d&&d.zC(b,c);a=this.Ra(a);-1!=a&&(a=this.Za(a),null!=this.ui(a)&&d.Am(b,c))};b.prototype.w=function(a,b){this.yb.w(this.Cd.S(a,
0),b)};b.prototype.Mc=function(a,b){this.yb.ya[0].fc(2*this.Cd.S(a,0),b)};b.prototype.Ba=function(b){var c=new a.b;this.yb.w(this.Cd.S(b,0),c);return c};b.prototype.gH=function(a,b){this.Jr.fc(2*a,b)};b.prototype.Wc=function(a,b,c){return this.yb.Wc(a,this.Za(b),c)};b.prototype.setAttribute=function(a,b,c,d){this.yb.setAttribute(a,this.Za(b),c,d)};b.prototype.Za=function(a){return this.Cd.S(a,0)};b.prototype.Cf=function(b){var c=new a.b;this.w(b,c);return c.y};b.prototype.Uq=function(a,b){a=this.Za(a);
b=this.Za(b);var c=this.yb.ya[0].f;return c[2*a]===c[2*b]&&c[2*a+1]===c[2*b+1]};b.prototype.qw=function(a,b){a=this.Za(a);var c=this.yb.ya[0].f;return c[2*a]===b.x&&c[2*a+1]===b.y};b.prototype.VX=function(b,c){1>c&&(c=1);if(null==this.oh){if(1==c)return;this.oh=a.Tc.$m(this.yb.D(),1)}b=this.Za(b);b>=this.oh.size&&this.oh.resize(b+1,1);this.oh.write(b,c)};b.prototype.fH=function(a){a=this.Za(a);return null==this.oh||a>=this.oh.size?1:this.oh.read(a)};b.prototype.Va=function(a,b,c){b=this.Ci[b];a=this.Za(a);
b.size<this.yb.D()&&b.resize(this.yb.D(),-1);b.write(a,c)};b.prototype.Sa=function(a,b){a=this.Za(a);b=this.Ci[b];return a<b.size?b.read(a):-1};b.prototype.Sd=function(){null==this.Ci&&(this.Ci=[]);for(var b=0;b<this.Ci.length;b++)if(null==this.Ci[b])return this.Ci[b]=a.Tc.wh(0,-1),b;this.Ci.push(a.Tc.wh(0,-1));return this.Ci.length-1};b.prototype.je=function(a){this.Ci[a]=null};b.prototype.jc=function(a){return null!=this.tf?(a=this.Za(a),this.tf[a]):null};b.prototype.nd=function(b,c){var d=this.Cd.S(b,
2);if(-1==d)return!1;if(this.RA){var h=new a.Wa;this.xj(b,h);c.setStart(h);this.xj(d,h);c.setEnd(h)}else this.yb.Mc(this.Cd.S(b,0),na),c.Wm(0,na),this.yb.Mc(this.Cd.S(d,0),na),c.Wm(1,na);return!0};b.prototype.LW=function(b,c,d){if(this.RA){var h=new a.Wa;this.xj(b,h);d.setStart(h);this.xj(c,h);d.setEnd(h)}else this.yb.Mc(b,na),d.Wm(0,na),this.yb.Mc(c,na),d.Wm(1,na)};b.prototype.Vf=function(b,c){var d;if(-1!=c){if(b!=this.mg(c))throw a.g.za();d=this.at(c)}else d=this.Xv(b);var h=this.LV(b);-1!=c&&
this.Sp(c,h);this.Rp(h,c);this.Sp(h,d);-1!=d?this.Rp(d,h):this.Pp(b,h);-1==c&&this.Qp(b,h);this.Bm(b,this.aa(b)+1);return h};b.prototype.pH=function(a,b,c,d){a=this.Vf(a,-1);for(var h=0,e=b,f=!1;e==c&&(f=!0),this.Bj(e,a),h++,e=this.U(e),e!=b;);this.ho(a,!0);this.sk(a,h);f&&(b=c);this.ig(a,b);this.rh(a,this.Ra(b));this.Up(a,!1);null!=d&&(d[0]=f);return a};b.prototype.Qr=function(a){var b=this.at(a),c=this.Sb(a),d=this.mg(a);-1!=b?this.Rp(b,c):this.Pp(d,c);-1!=c?this.Sp(c,b):this.Qp(d,b);this.$P(a);
this.Bm(d,this.aa(d)-1);this.wG(a);return c};b.prototype.$P=function(a){var b=this.cb(a);if(-1!=b){for(var c=0,d=this.La(a);c<d;c++){var h=b,b=this.U(b);this.Fz(h)}b=this.mg(a);this.qk(b,this.D(b)-this.La(a))}this.sk(a,0)};b.prototype.Sb=function(a){return this.rd.S(a,2)};b.prototype.at=function(a){return this.rd.S(a,1)};b.prototype.La=function(a){return this.rd.S(a,3)};b.prototype.Qb=function(a){return 0!=(this.Lq(a)&1)};b.prototype.ho=function(a,b){if(this.Qb(a)!=b){if(0<this.La(a)){var c=this.cb(a),
d=this.Vj(a);b?(this.Jc(d,c),this.Kc(c,d)):(this.Jc(d,-1),this.Kc(c,-1));c=this.Za(d);this.sh(c,null)}this.wC(a,(this.Lq(a)|1)-1|(b?1:0))}};b.prototype.mg=function(a){return this.rd.S(a,7)};b.prototype.tU=function(a){return 0!=(this.Lq(a)&2)};b.prototype.rC=function(a,b){this.wC(a,(this.Lq(a)|2)-2|(b?2:0))};b.prototype.jA=function(b){if(this.zU(b))return this.oj.get(this.dw(b));var c=new a.Hb,d=this.cb(b);if(-1==d)return 0;var h=new a.b;this.w(d,h);for(var e=0,f=0,n=this.La(b);f<n;f++,d=this.U(d)){var g=
this.jc(d);if(null==g){if(!this.nd(d,c))continue;g=c}e+=g.yy(h.x,h.y)}this.Up(b,!0);this.oj.set(this.dw(b),e);return e};b.prototype.Zr=function(a,b,c){b=this.gl[b];a=this.dw(a);b.size<this.oj.size&&b.resize(this.oj.size,-1);b.write(a,c)};b.prototype.Xj=function(a,b){a=this.dw(a);b=this.gl[b];return a<b.size?b.read(a):-1};b.prototype.pz=function(){null==this.gl&&(this.gl=[]);for(var b=0;b<this.gl.length;b++)if(null==this.gl[b])return this.gl[b]=a.Tc.wh(0),b;this.gl.push(a.Tc.wh(0));return this.gl.length-
1};b.prototype.eC=function(a){this.gl[a]=null};b.prototype.BV=function(b,c,d){if(-1==d)throw a.g.F();if(c!=d){var h=this.Sb(d),e=this.at(d),f=this.mg(d);-1==e?this.Pp(f,h):this.Rp(e,h);-1==h?this.Qp(f,e):this.Sp(h,e);this.qk(f,this.D(f)-this.La(d));this.Bm(f,this.aa(f)-1);e=-1==c?this.Xv(b):this.at(c);this.Sp(d,e);this.Rp(d,c);-1==c?this.Qp(b,d):this.Sp(c,d);-1==e?this.Pp(b,d):this.Rp(e,d);this.qk(b,this.D(b)+this.La(d));this.Bm(b,this.aa(b)+1);this.Rx(d,b)}};b.prototype.Oj=function(a,b){this.yb.xe(this.Za(b),
this.gn());this.$j(a,-1,this.gn())};b.prototype.td=function(b,c){var d=this.kd(b),h=this.Ra(b),e=this.U(b);-1!=h&&this.Jc(h,e);var f=this.La(d);b==this.cb(d)&&this.ig(d,1<f?e:-1);-1!=e&&this.Kc(e,h);b==this.Vj(d)&&this.rh(d,1<f?h:-1);if(-1!=h&&-1!=e){var h=this.Za(h),p=this.Za(e);c?(c=this.ui(h),null!=c&&(h=new a.b,this.yb.w(p,h),c.Xc(h))):(p=this.Za(b),c=this.ui(p),this.sh(h,c),null!=c&&(h=this.yb.Ba(h),c.Lc(h)))}this.sk(d,f-1);d=this.mg(d);this.qk(d,this.D(d)-1);this.Fz(b);return e};b.prototype.cb=
function(a){return this.rd.S(a,4)};b.prototype.Vj=function(a){return this.rd.S(a,5)};b.prototype.U=function(a){return this.Cd.S(a,2)};b.prototype.Ra=function(a){return this.Cd.S(a,1)};b.prototype.kd=function(a){return this.Cd.S(a,3)};b.prototype.pc=function(a,b){return this.$j(a,-1,b)};b.prototype.Pr=function(b){if(void 0===b)return this.Pr(!1);if(b instanceof c)return new c(b);var d,h=-1,e=-1,f=-1,n=0,g=!1;for(d=this.qd;-1!=d;d=this.Re(d))if(!b||a.T.Hc(this.ic(d))){for(h=this.Pb(d);-1!=h;h=this.Sb(h))if(f=
e=this.cb(h),n=0,-1!=e){g=!0;break}if(g)break}return c.UQ(this,d,h,e,f,n,b)};b.prototype.Vc=function(a){this.sm.Vc(a);if(null!=this.tf)for(var b=0,c=this.tf.length;b<c;b++)null!=this.tf[b]&&this.tf[b].Vc(a)};b.prototype.as=function(a,b,c,d){d?this.kY(a,b,c):this.jY(a,b,c)};b.prototype.Kc=function(a,b){this.Cd.R(a,1,b)};b.prototype.Jc=function(a,b){this.Cd.R(a,2,b)};b.prototype.Bj=function(a,b){this.Cd.R(a,3,b)};b.prototype.sk=function(a,b){this.rd.R(a,3,b)};b.prototype.ig=function(a,b){this.rd.R(a,
4,b)};b.prototype.rh=function(a,b){this.rd.R(a,5,b)};b.prototype.Bm=function(a,b){this.ld.R(a,6,b)};b.prototype.qk=function(a,b){this.ld.R(a,5,b)};b.prototype.UJ=function(a){var b=a;do{var c=this.U(b);this.Jc(b,this.Ra(b));this.Kc(b,c);b=c}while(b!=a)};b.prototype.CC=function(a){this.ud=a};b.prototype.Rr=function(a){var b=this.at(a),c=this.Sb(a),d=this.mg(a);-1!=b?this.Rp(b,c):this.Pp(d,c);-1!=c?this.Sp(c,b):this.Qp(d,b);this.ig(a,-1);this.rh(a,-1);this.wG(a)};b.prototype.Ni=function(b,c){var d=this.Ra(b),
h=this.U(b);-1!=d&&this.Jc(d,h);-1!=h&&this.Kc(h,d);if(-1!=d&&-1!=h)if(d=this.Za(d),h=this.Za(h),c){if(c=this.ui(d),null!=c){var e=new a.b;this.yb.w(h,e);c.Xc(e)}}else h=this.Za(b),c=this.ui(h),this.sh(d,c),null!=c&&(e=new a.b,this.yb.w(d,e),c.Lc(e));this.Fz(b)};b.prototype.zU=function(a){return 0!=(this.Lq(a)&4)};b.prototype.Up=function(a,b){this.wC(a,(this.Lq(a)|4)-4|(b?4:0))};b.prototype.Xx=function(a,b){var c=this.Cd.f;this.yb.vc();var d=this.yb.ya[0].f;a.Fd(0,b,function(a,b){a=c[5*a];b=c[5*b];
var h=d[2*a];a=d[2*a+1];var e=d[2*b];b=d[2*b+1];return a<b?-1:a>b?1:h<e?-1:h>e?1:0})};b.prototype.FT=function(){for(var b=this.qd;-1!=b;b=this.Re(b))if(!a.T.Hc(this.ic(b)))return!0;return!1};b.prototype.HC=function(a,b){for(var c=this.Pb(a),d=this.Pb(b),h=this.Xv(a),e=this.Xv(b),f=this.Pb(a);-1!=f;f=this.Sb(f))this.Rx(f,b);for(f=this.Pb(b);-1!=f;f=this.Sb(f))this.Rx(f,a);this.Pp(a,d);this.Pp(b,c);this.Qp(a,e);this.Qp(b,h);c=this.D(a);d=this.aa(a);h=this.aa(b);this.qk(a,this.D(b));this.qk(b,c);this.Bm(a,
h);this.Bm(b,d);c=this.ld.S(a,2);this.ld.R(a,2,this.ld.S(b,2));this.ld.R(b,2,c)};return b}();a.ed=b})(C||(C={}));(function(a){var b=function(b){function c(c,d,e,f){var h=b.call(this)||this;h.$=new a.h;void 0===c?h.$F():"number"===typeof c?h.uQ(c,d,e,f):c instanceof a.Wa?void 0!==d?h.Iv(c,d,e):h.vQ(c):c instanceof a.ma?void 0!==d?h.xQ(c,d):h.wQ(c):c instanceof a.h?h.tQ(c):h.$F();return h}ca(c,b);c.prototype.Iv=function(b,c,d){this.description=a.we.Hg();this.$.Oa();b.u()||this.hv(b,c,d)};c.prototype.tQ=
function(b){this.description=a.we.Hg();this.$.I(b);this.$.normalize()};c.prototype.wQ=function(b){if(null==b)throw a.g.F();this.description=b;this.$.Oa()};c.prototype.xQ=function(b,c){if(null==b)throw a.g.F();this.description=b;this.$.I(c);this.$.normalize()};c.prototype.$F=function(){this.description=a.we.Hg();this.$.Oa()};c.prototype.vQ=function(b){this.description=a.we.Hg();this.$.Oa();b.u()||this.hv(b)};c.prototype.uQ=function(b,c,d,e){this.description=a.we.Hg();this.I(b,c,d,e)};c.prototype.I=
function(a,b,c,d){this.zc();if("number"===typeof a)this.$.I(a,b,c,d);else for(this.Oa(),b=0,c=a.length;b<c;b++)this.Nb(a[b])};c.prototype.Np=function(b){this.zc();if(!b.BU())throw a.g.F();this.$.I(b)};c.prototype.Oa=function(){this.zc();this.$.Oa()};c.prototype.u=function(){return this.$.u()};c.prototype.O=function(){return this.$.O()};c.prototype.ea=function(){return this.$.ea()};c.prototype.Jk=function(){return this.$.Jk()};c.prototype.Cq=function(){return this.$.Cq()};c.prototype.Bq=function(){return this.$.Tf()};
c.prototype.Nb=function(b){if(b instanceof a.b)this.zc(),this.$.Nb(b);else if(b instanceof a.h)this.zc(),this.$.Nb(b);else if(b instanceof a.Wa){if(this.zc(),!b.Gc()){var d=b.description;this.description!=d&&this.tm(d);if(this.u())this.hv(b);else{this.$.Nb(b.w());for(var h=1,e=d.Ga;h<e;h++)for(var f=d.Qd(h),n=a.ma.Xa(f),g=0;g<n;g++){var w=b.Wc(f,g),k=this.hg(f,g);k.Nb(w);this.setInterval(f,g,k)}}}}else if(b instanceof c&&!b.u())for(d=b.description,d!=this.description&&this.tm(d),this.$.Nb(b.$),h=
1,e=d.Ga;h<e;h++)for(f=d.pd(h),n=a.ma.Xa(f),g=0;g<n;g++)w=b.hg(f,g),k=this.hg(f,g),k.Nb(w),this.setInterval(f,g,k)};c.prototype.hv=function(b,c,d){if(void 0!==c){this.$.I(b.w(),c,d);c=b.description;d=1;for(var h=c.Ga;d<h;d++)for(var e=c.Qd(d),f=a.ma.Xa(e),p=0;p<f;p++){var n=b.Wc(e,p);this.setInterval(e,p,n,n)}}else for(this.$.I(b.ka[0],b.ka[1]),c=b.description,d=1,h=c.Ga;d<h;d++)for(e=c.Qd(d),f=a.ma.Xa(e),p=0;p<f;p++)n=b.Wc(e,p),this.setInterval(e,p,n,n)};c.prototype.setInterval=function(b,c,d,e){var h=
null;"number"===typeof d?h=new a.yc(d,e):h=d;this.zc();if(0==b)if(0==c)this.$.o=h.ga,this.$.v=h.la;else if(1==c)this.$.A=h.ga,this.$.B=h.la;else throw a.g.vd();else this.OE(0,b,c,h.ga),this.OE(1,b,c,h.la)};c.prototype.P=function(a,b){this.zc();this.$.P(a,b)};c.prototype.Vc=function(b){if(b instanceof a.Gd)this.zc(),b.NC(this.$);else if(this.zc(),!this.$.u()){var c=new a.QL;this.Jp(c);c.sU()?c.Oa():b.NC(c)}};c.prototype.copyTo=function(b){if(b.G()!=this.G())throw a.g.F();b.zc();b.description=this.description;
b.$.I(this.$);b.ka=null;if(null!=this.ka){b.cv();for(var c=0;c<2*(this.description.Ye.length-2);c++)b.ka[c]=this.ka[c]}};c.prototype.Ka=function(){return new c(this.description)};c.prototype.ef=function(){return this.$.AG()};c.prototype.Rb=function(){return this.$.RG()};c.prototype.G=function(){return 197};c.prototype.ub=function(){return 2};c.prototype.Wn=function(a){this.copyTo(a)};c.prototype.s=function(a){a.o=this.$.o;a.A=this.$.A;a.v=this.$.v;a.B=this.$.B};c.prototype.Jp=function(a){a.o=this.$.o;
a.A=this.$.A;a.v=this.$.v;a.B=this.$.B;a.I(this.$.o,this.$.A,this.Zd(0,1,0),this.$.v,this.$.B,this.Zd(1,1,0))};c.prototype.hg=function(b,c){var d=new a.yc;d.I(this.Zd(0,b,c),this.Zd(1,b,c));return d};c.prototype.gg=function(b,c){c.Eg(this.description);var d=this.description.Ga-1;switch(b){case 0:for(b=0;b<d;b++)for(var e=this.description.pd(b),h=a.ma.Xa(e),f=0;f<h;f++)c.setAttribute(e,f,this.Zd(0,e,f));c.rb(this.$.o,this.$.A);break;case 1:for(b=0;b<d;b++)for(e=this.description.pd(b),h=a.ma.Xa(e),
f=0;f<h;f++)c.setAttribute(e,f,this.Zd(1,e,f));c.rb(this.$.o,this.$.B);break;case 2:for(b=0;b<d;b++)for(e=this.description.pd(b),h=a.ma.Xa(e),f=0;f<h;f++)c.setAttribute(e,f,this.Zd(0,e,f));c.rb(this.$.v,this.$.B);break;case 3:for(b=0;b<d;b++)for(e=this.description.pd(b),h=a.ma.Xa(e),f=0;f<h;f++)c.setAttribute(e,f,this.Zd(1,e,f));c.rb(this.$.v,this.$.A);break;default:throw a.g.vd();}};c.prototype.Gx=function(a,b){a=this.$.Gx(a);b.ja(a.x,a.y)};c.prototype.CS=function(a,b){return b*(a.Er-2)};c.prototype.BG=
function(b,c,d){if(this.$.u())throw a.g.X("empty geometry");if(0==c)return 0!=b?0!=d?this.$.B:this.$.v:0!=d?this.$.A:this.$.o;if(d>=a.ma.Xa(c))throw a.g.F();var e=this.description.lg(c);this.cv();return 0<=e?this.ka[this.CS(this.description,b)+this.description.eT(e)-2+d]:a.ma.be(c)};c.prototype.cv=function(){this.zc();if(null==this.ka&&2<this.description.Ye.length){this.ka=[];for(var b=c.N(this.description,0),d=c.N(this.description,1),e=0,f=1,n=this.description.Ga;f<n;f++)for(var g=this.description.pd(f),
w=a.ma.Xa(g),g=a.ma.be(g),k=0;k<w;k++)this.ka[b+e]=g,this.ka[d+e]=g,e++}};c.prototype.to=function(b){if(null!=this.ka)if(2<b.Ye.length){for(var d=a.we.vx(b,this.description),e=[],h=c.N(this.description,0),f=c.N(this.description,1),n=c.N(b,0),g=c.N(b,1),w=0,k=1,l=b.Ga;k<l;k++){var m=b.pd(k),q=a.ma.Xa(m);if(-1==d[k])for(var r=a.ma.be(m),m=0;m<q;m++)e[n+w]=r,e[g+w]=r,w++;else for(r=this.description.zk(d[k])-2,m=0;m<q;m++)e[n+w]=this.ka[h+r],e[g+w]=this.ka[f+r],w++,r++}this.ka=e}else this.ka=null;this.description=
b};c.prototype.Zd=function(b,d,e){if(this.$.u())throw a.g.X("This operation was performed on an Empty Geometry.");if(0==d)return 0!=b?0!=e?this.$.B:this.$.v:0!=e?this.$.A:this.$.o;if(e>=a.ma.Xa(d))throw a.g.vd();var h=this.description.lg(d);return 0<=h?(this.cv(),this.ka[c.N(this.description,b)+this.description.zk(h)-2+e]):a.ma.be(d)};c.prototype.OE=function(b,d,e,f){this.zc();if(0==d)0!=b?0!=e?this.$.B=f:this.$.v=f:0!=e?this.$.A=f:this.$.o=f;else{if(e>=a.ma.Xa(d))throw a.g.vd();if(!this.hasAttribute(d)){if(a.ma.DH(d,
f))return;this.Rd(d)}d=this.description.lg(d);this.cv();this.ka[c.N(this.description,b)+this.description.zk(d)-2+e]=f}};c.N=function(a,b){return b*(a.Ye.length-2)};c.prototype.Ma=function(b){this.zc();var c=new a.h;b.s(c);return this.$.Ma(c)};c.prototype.Yb=function(b){return b instanceof a.h?this.$.Yb(b):this.$.Yb(b.$)};c.prototype.Bv=function(a,b,c){this.zc();a.u()?this.Oa():void 0!==b?this.hv(a,b,c):this.$.Bv(a.Te(),a.Cf())};c.prototype.offset=function(a,b){this.zc();this.$.offset(a,b)};c.prototype.normalize=
function(){this.zc();this.$.normalize()};c.prototype.Tf=function(b){if(void 0!==b)if(b.Eg(this.description),this.u())b.Oa();else{for(var c=this.description.Ga,d=1;d<c;d++)for(var e=this.description.pd(d),h=a.ma.Xa(e),f=0;f<h;f++){var n=.5*(this.BG(0,e,f)+this.BG(1,e,f));b.setAttribute(e,f,n)}b.rb(this.$.Tf())}else{b=new a.Wa(this.description);if(this.u())return b;c=this.description.Ga;for(d=1;d<c;d++)for(e=this.description.Qd(d),h=a.ma.Xa(e),f=0;f<h;f++)n=.5*(this.Zd(0,e,f)+this.Zd(1,e,f)),b.setAttribute(e,
f,n);b.rb(this.$.Jk(),this.$.Cq());return b}};c.prototype.aA=function(){return new a.Wa(this.$.aA())};c.prototype.contains=function(b){return b instanceof a.Wa?b.u()?!1:this.$.contains(b.Te(),b.Cf()):this.$.contains(b.$)};c.prototype.DQ=function(a){return this.$.contains(a)};c.prototype.Eb=function(a){if(a==this)return!0;if(!(a instanceof c)||this.description!=a.description)return!1;if(this.u())return a.u()?!0:!1;if(!this.$.Eb(a.$))return!1;for(var b=0,d=2*(this.description.Ye.length-2);b<d;b++)if(this.ka[b]!=
a.ka[b])return!1;return!0};c.prototype.kc=function(){var b=this.description.kc(),b=a.J.bh(b,this.$.kc());if(!this.u()&&null!=this.ka)for(var c=0,d=2*(this.description.Ye.length-2);c<d;c++)b=a.J.bh(b,this.ka[c]);return b};c.prototype.dt=function(){return this.$.o};c.prototype.ft=function(){return this.$.A};c.prototype.ct=function(){return this.$.v};c.prototype.et=function(){return this.$.B};c.prototype.Fg=function(){return a.Pi.Xm(this,null)};c.prototype.toString=function(){return this.u()?"Envelope: []":
"Envelope: ["+this.$.o+", "+this.$.A+", "+this.$.v+", "+this.$.B+"]"};return c}(a.T);a.di=b})(C||(C={}));(function(a){var b=function(){function b(a,b,c,d){void 0===a?this.Oa():(this.o=a,this.A=b,this.v=c,this.B=d)}b.pa=function(a,c,d,e){var h=new b;h.o=a;h.A=c;h.v=d;h.B=e;return h};b.prototype.I=function(c,d,e,f){"number"===typeof c?void 0!==e?(this.o=c,this.A=d,this.v=e,this.B=f,this.normalize()):(this.o=c,this.A=d,this.v=c,this.B=d):c instanceof a.b?void 0!==d?(this.o=c.x-.5*d,this.v=this.o+d,this.A=
c.y-.5*e,this.B=this.A+e,this.normalize()):(this.o=c.x,this.A=c.y,this.v=c.x,this.B=c.y):c instanceof b?this.I(c.o,c.A,c.v,c.B):c instanceof a.yc&&(c.u()||d.u()?this.Oa():(this.o=c.ga,this.v=c.la,this.A=d.ga,this.B=d.la))};b.prototype.OS=function(a,c){var d=new b;d.I(this.o,this.A,this.v,this.B);d.P(a,c);return d};b.prototype.Mx=function(a,b){if(void 0!==b)if(0==b)this.Oa();else{this.o=a[0].x;this.A=a[0].y;this.v=this.o;this.B=this.A;for(var c=1;c<b;c++){var d=a[c];d.x<this.o?this.o=d.x:d.x>this.v&&
(this.v=d.x);d.y<this.A?this.A=d.y:d.y>this.B&&(this.B=d.y)}}else if(null==a||0==a.length)this.Oa();else for(d=a[0],this.I(d.x,d.y),c=1;c<a.length;c++)d=a[c],this.ol(d.x,d.y)};b.prototype.Oa=function(){this.B=this.v=this.A=this.o=NaN};b.prototype.u=function(){return isNaN(this.o)};b.prototype.Nb=function(c,d){"number"===typeof c?this.u()?(this.o=c,this.A=d,this.v=c,this.B=d):(this.o>c?this.o=c:this.v<c&&(this.v=c),this.A>d?this.A=d:this.B<d&&(this.B=d)):c instanceof a.b?this.Nb(c.x,c.y):c instanceof
a.od?this.Nb(c.x,c.y):c instanceof b&&!c.u()&&(this.Nb(c.o,c.A),this.Nb(c.v,c.B))};b.prototype.ol=function(a,b){this.o>a?this.o=a:this.v<a&&(this.v=a);this.A>b?this.A=b:this.B<b&&(this.B=b)};b.prototype.P=function(a,b){this.u()||(this.o-=a,this.v+=a,this.A-=b,this.B+=b,(this.o>this.v||this.A>this.B)&&this.Oa())};b.prototype.scale=function(a){0>a&&this.Oa();this.u()||(this.o*=a,this.v*=a,this.A*=a,this.B*=a)};b.prototype.Yb=function(a){return!this.u()&&!a.u()&&(this.o<=a.o?this.v>=a.o:a.v>=this.o)&&
(this.A<=a.A?this.B>=a.A:a.B>=this.A)};b.prototype.HH=function(a){return(this.o<=a.o?this.v>=a.o:a.v>=this.o)&&(this.A<=a.A?this.B>=a.A:a.B>=this.A)};b.prototype.Ma=function(a){if(this.u()||a.u())return!1;a.o>this.o&&(this.o=a.o);a.v<this.v&&(this.v=a.v);a.A>this.A&&(this.A=a.A);a.B<this.B&&(this.B=a.B);(a=this.o<=this.v&&this.A<=this.B)||this.Oa();return a};b.prototype.Gx=function(b){switch(b){case 0:return a.b.pa(this.o,this.A);case 1:return a.b.pa(this.o,this.B);case 2:return a.b.pa(this.v,this.B);
case 3:return a.b.pa(this.v,this.A);default:throw a.g.vd();}};b.prototype.SB=function(b){if(null==b||4>b.length)throw a.g.F();null!=b[0]?b[0].ja(this.o,this.A):b[0]=a.b.pa(this.o,this.A);null!=b[1]?b[1].ja(this.o,this.B):b[1]=a.b.pa(this.o,this.B);null!=b[2]?b[2].ja(this.v,this.B):b[2]=a.b.pa(this.v,this.B);null!=b[3]?b[3].ja(this.v,this.A):b[3]=a.b.pa(this.v,this.A)};b.prototype.AG=function(){return this.u()?0:this.O()*this.ea()};b.prototype.RG=function(){return this.u()?0:2*(this.O()+this.ea())};
b.prototype.Jk=function(){return(this.v+this.o)/2};b.prototype.Cq=function(){return(this.B+this.A)/2};b.prototype.O=function(){return this.v-this.o};b.prototype.ea=function(){return this.B-this.A};b.prototype.move=function(a,b){this.u()||(this.o+=a,this.A+=b,this.v+=a,this.B+=b)};b.prototype.Bv=function(b,c){if(void 0!==c)this.move(b-this.Jk(),c-this.Cq());else if(b instanceof a.b)this.Bv(b.x,b.y);else if(b instanceof a.Wa){c=(this.v-this.o)/2;var d=(this.B-this.A)/2;this.o=b.Te()-c;this.v=b.Te()+
c;this.A=b.Cf()-d;this.B=b.Cf()+d}else throw a.g.F();};b.prototype.offset=function(a,b){this.o+=a;this.v+=a;this.A+=b;this.B+=b};b.prototype.normalize=function(){if(!this.u()){var a=Math.min(this.o,this.v),b=Math.max(this.o,this.v);this.o=a;this.v=b;a=Math.min(this.A,this.B);b=Math.max(this.A,this.B);this.A=a;this.B=b}};b.prototype.Zn=function(a){a.ja(this.o,this.A)};b.prototype.HJ=function(a){a.ja(this.v,this.A)};b.prototype.KJ=function(a){a.ja(this.o,this.B)};b.prototype.$n=function(a){a.ja(this.v,
this.B)};b.prototype.BU=function(){return this.u()||this.o<=this.v&&this.A<=this.B};b.prototype.Tf=function(){return a.b.pa((this.v+this.o)/2,(this.B+this.A)/2)};b.prototype.aA=function(){return a.b.pa(this.o,this.A)};b.prototype.contains=function(c,d){if(void 0!==d)return c>=this.o&&c<=this.v&&d>=this.A&&d<=this.B;if(c instanceof a.Wa)return this.contains(c.Te(),c.Cf());if(c instanceof a.b)return this.contains(c.x,c.y);if(c instanceof b)return c.o>=this.o&&c.v<=this.v&&c.A>=this.A&&c.B<=this.B;throw a.g.F();
};b.prototype.Zm=function(c,d){if(void 0!==d)return c>this.o&&c<this.v&&d>this.A&&d<this.B;if(c instanceof a.b)return this.Zm(c.x,c.y);if(c instanceof b)return c.o>this.o&&c.v<this.v&&c.A>this.A&&c.B<this.B;throw a.g.F();};b.prototype.Eb=function(a){return a==this?!0:a instanceof b?this.u()&&a.u()?!0:this.o!=a.o||this.A!=a.A||this.v!=a.v||this.B!=a.B?!1:!0:!1};b.prototype.kc=function(){var b=this.o,b=a.J.truncate(b^b>>>32),c=a.J.bh(b),b=this.v,b=a.J.truncate(b^b>>>32),c=a.J.bh(b,c),b=this.A,b=a.J.truncate(b^
b>>>32),c=a.J.bh(b,c),b=this.B,b=a.J.truncate(b^b>>>32);return c=a.J.bh(b,c)};b.prototype.Ky=function(b){var c=new a.b;c.L(b);if(c.Dy())return c;if(this.u())return c.iv(),c;c.x<this.o?c.x=this.o:c.x>this.v&&(c.x=this.v);c.y<this.A?c.y=this.A:c.y>this.B&&(c.y=this.B);if(!c.Eb(b))return c;b=this.Tf();(c.x<b.x?c.x-this.o:this.v-c.x)<(c.y<b.y?c.y-this.A:this.B-c.y)?c.x=c.x<b.x?this.o:this.v:c.y=c.y<b.y?this.A:this.B;return c};b.prototype.av=function(a){if(this.u())return NaN;if(a.x==this.o)return a.y-
this.A;var b=this.B-this.A,c=this.v-this.o;return a.y==this.B?b+a.x-this.o:a.x==this.v?b+c+this.B-a.y:a.y==this.A?2*b+c+this.v-a.x:this.av(this.Ky(a))};b.prototype.DE=function(a){if(this.u())return-1;a=this.av(a);var b=this.B-this.A,c=this.v-this.o;return a<b?0:(a-=b)<c?1:a-c<b?2:3};b.prototype.uo=function(){return this.u()?2.220446049250313E-14:2.220446049250313E-14*(Math.abs(this.o)+Math.abs(this.v)+Math.abs(this.A)+Math.abs(this.B)+1)};b.prototype.ez=function(a,c){var d=this.yk(a),e=this.yk(c);
if(0!=(d&e))return 0;if(0==(d|e))return 4;var h=(0!=d?1:0)|(0!=e?2:0);do{var f=c.x-a.x,g=c.y-a.y;f>g?0!=(d&b.dc)?(0!=(d&b.N)?(a.y+=g*(this.o-a.x)/f,a.x=this.o):(a.y+=g*(this.v-a.x)/f,a.x=this.v),d=this.yk(a)):0!=(e&b.dc)?(0!=(e&b.N)?(c.y+=g*(this.o-c.x)/f,c.x=this.o):(c.y+=g*(this.v-c.x)/f,c.x=this.v),e=this.yk(c)):0!=d?(0!=(d&b.tb)?(a.x+=f*(this.A-a.y)/g,a.y=this.A):(a.x+=f*(this.B-a.y)/g,a.y=this.B),d=this.yk(a)):(0!=(e&b.tb)?(c.x+=f*(this.A-c.y)/g,c.y=this.A):(c.x+=f*(this.B-c.y)/g,c.y=this.B),
e=this.yk(c)):0!=(d&b.ad)?(0!=(d&b.tb)?(a.x+=f*(this.A-a.y)/g,a.y=this.A):(a.x+=f*(this.B-a.y)/g,a.y=this.B),d=this.yk(a)):0!=(e&b.ad)?(0!=(e&b.tb)?(c.x+=f*(this.A-c.y)/g,c.y=this.A):(c.x+=f*(this.B-c.y)/g,c.y=this.B),e=this.yk(c)):0!=d?(0!=(d&b.N)?(a.y+=g*(this.o-a.x)/f,a.x=this.o):(a.y+=g*(this.v-a.x)/f,a.x=this.v),d=this.yk(a)):(0!=(e&b.N)?(c.y+=g*(this.o-c.x)/f,c.x=this.o):(c.y+=g*(this.v-c.x)/f,c.x=this.v),e=this.yk(c));if(0!=(d&e))return 0}while(0!=(d|e));return h};b.prototype.yk=function(a){return(a.x<
this.o?1:0)|(a.x>this.v?1:0)<<1|(a.y<this.A?1:0)<<2|(a.y>this.B?1:0)<<3};b.prototype.eh=function(a){return!this.u()&&(this.O()<=a||this.ea()<=a)};b.prototype.Cb=function(b){return b instanceof a.b?Math.sqrt(this.NK(b)):Math.sqrt(this.Zx(b))};b.prototype.Zx=function(a){var b=0,c=0,d;d=this.o-a.v;d>b&&(b=d);d=this.A-a.B;d>c&&(c=d);d=a.o-this.v;d>b&&(b=d);d=a.A-this.B;d>c&&(c=d);return b*b+c*c};b.prototype.NK=function(a){var b=0,c=0,d;d=this.o-a.x;d>b&&(b=d);d=this.A-a.y;d>c&&(c=d);d=a.x-this.v;d>b&&
(b=d);d=a.y-this.B;d>c&&(c=d);return b*b+c*c};b.prototype.Yn=function(a){this.u()?a.Oa():a.I(this.o,this.v)};b.XN=function(a,b,c,d){var e=1;isNaN(a)||(e+=Math.abs(a));isNaN(b)||(e+=Math.abs(b));isNaN(c)||(e+=Math.abs(c));isNaN(d)||(e+=Math.abs(d));return 2.220446049250313E-14*e};b.N=1;b.tb=4;b.dc=3;b.ad=12;return b}();a.h=b})(C||(C={}));(function(a){var b;(function(a){a[a.initialize=0]="initialize";a[a.initializeRed=1]="initializeRed";a[a.initializeBlue=2]="initializeBlue";a[a.initializeRedBlue=3]=
"initializeRedBlue";a[a.sweep=4]="sweep";a[a.sweepBruteForce=5]="sweepBruteForce";a[a.sweepRedBlueBruteForce=6]="sweepRedBlueBruteForce";a[a.sweepRedBlue=7]="sweepRedBlue";a[a.sweepRed=8]="sweepRed";a[a.sweepBlue=9]="sweepBlue";a[a.iterate=10]="iterate";a[a.iterateRed=11]="iterateRed";a[a.iterateBlue=12]="iterateBlue";a[a.iterateBruteForce=13]="iterateBruteForce";a[a.iterateRedBlueBruteForce=14]="iterateRedBlueBruteForce";a[a.resetRed=15]="resetRed";a[a.resetBlue=16]="resetBlue"})(b||(b={}));var c=
function(){function a(a,b){this.Di=a;this.cI=b}a.prototype.gs=function(a,b,c){this.Di.hY(c,a,b,this.cI)};a.prototype.Qq=function(a){return this.Di.Ks(a,this.cI)};return a}();b=function(){function b(){this.ax=this.ip=this.Ff=this.Ad=null;this.lr=new a.h;this.un=this.gk=this.hk=this.Od=this.dg=this.Wd=this.Qw=this.$o=this.zd=this.Lb=null;this.Zb=-1;this.ta=0;this.sl()}b.prototype.bs=function(){this.sl();this.Bw=!0;null==this.Lb?(this.$o=new a.ha(0),this.Lb=[]):(this.$o.uf(0),this.Lb.length=0)};b.prototype.hd=
function(b,c){if(!this.Bw)throw a.g.Da();var d=new a.h;d.I(c);this.$o.add(b);this.Lb.push(d)};b.prototype.yq=function(){if(!this.Bw)throw a.g.Da();this.Bw=!1;null!=this.Lb&&0<this.Lb.length&&(this.Zb=0,this.Oc=!1)};b.prototype.QK=function(){this.sl();this.Aw=!0;null==this.Lb?(this.$o=new a.ha(0),this.Lb=[]):(this.$o.uf(0),this.Lb.length=0)};b.prototype.aF=function(b,c){if(!this.Aw)throw a.g.Da();var d=new a.h;d.I(c);this.$o.add(b);this.Lb.push(d)};b.prototype.qG=function(){if(!this.Aw)throw a.g.Da();
this.Aw=!1;null!=this.Lb&&0<this.Lb.length&&null!=this.zd&&0<this.zd.length&&(-1==this.Zb?this.Zb=3:2==this.Zb?this.Zb=3:3!=this.Zb&&(this.Zb=1),this.Oc=!1)};b.prototype.PK=function(){this.sl();this.zw=!0;null==this.zd?(this.Qw=new a.ha(0),this.zd=[]):(this.Qw.uf(0),this.zd.length=0)};b.prototype.XE=function(b,c){if(!this.zw)throw a.g.Da();var d=new a.h;d.I(c);this.Qw.add(b);this.zd.push(d)};b.prototype.pG=function(){if(!this.zw)throw a.g.Da();this.zw=!1;null!=this.Lb&&0<this.Lb.length&&null!=this.zd&&
0<this.zd.length&&(-1==this.Zb?this.Zb=3:1==this.Zb?this.Zb=3:3!=this.Zb&&(this.Zb=2),this.Oc=!1)};b.prototype.next=function(){if(this.Oc)return!1;for(var b=!0;b;)switch(this.Zb){case 0:b=this.tA();break;case 1:b=this.PT();break;case 2:b=this.MT();break;case 3:b=this.OT();break;case 4:b=this.rY();break;case 5:b=this.nY();break;case 6:b=this.oY();break;case 7:b=this.pY();break;case 8:b=this.by();break;case 9:b=this.IC();break;case 10:b=this.FA();break;case 11:b=this.FU();break;case 12:b=this.CU();
break;case 13:b=this.DU();break;case 14:b=this.EU();break;case 15:b=this.OJ();break;case 16:b=this.NJ();break;default:throw a.g.za();}return this.Oc?!1:!0};b.prototype.BC=function(a){this.ta=a};b.prototype.hA=function(a){return this.Lb[a]};b.prototype.Lz=function(a){return this.zd[a]};b.prototype.Vl=function(a){return this.$o.read(a)};b.prototype.Rl=function(a){return this.Qw.read(a)};b.GA=function(a){return 1==(a&1)};b.Fj=function(a){return 0==(a&1)};b.prototype.sl=function(){this.Bw=this.zw=this.Aw=
!1;this.bg=this.cg=this.mh=this.Ke=-1;this.Oc=!0};b.prototype.tA=function(){this.$f=this.rg=-1;if(10>this.Lb.length)return this.Ke=this.Lb.length,this.Zb=5,!0;null==this.Ad&&(this.Ad=new a.ms(!0),this.ip=this.Ad.jf(),this.Wd=new a.ha(0));this.Ad.bs();for(var b=0;b<this.Lb.length;b++){var c=this.Lb[b];this.Ad.xs(c.o,c.v)}this.Ad.yq();this.Wd.zb(2*this.Lb.length);this.Wd.resize(0);for(b=0;b<2*this.Lb.length;b++)this.Wd.add(b);this.Au(this.Wd,2*this.Lb.length,!0);this.Ke=2*this.Lb.length;this.Zb=4;return!0};
b.prototype.PT=function(){this.$f=this.rg=-1;if(10>this.Lb.length||10>this.zd.length)return this.Ke=this.Lb.length,this.Zb=6,!0;null==this.Ad&&(this.Ad=new a.ms(!0),this.ip=this.Ad.jf(),this.Wd=new a.ha(0));this.Ad.bs();for(var b=0;b<this.Lb.length;b++){var c=this.Lb[b];this.Ad.xs(c.o,c.v)}this.Ad.yq();this.Wd.zb(2*this.Lb.length);this.Wd.resize(0);for(b=0;b<2*this.Lb.length;b++)this.Wd.add(b);this.Au(this.Wd,this.Wd.size,!0);this.Ke=this.Wd.size;-1!=this.cg&&(this.Od.zh(this.cg),this.hk.resize(0),
this.cg=-1);this.Zb=7;return this.NJ()};b.prototype.MT=function(){this.$f=this.rg=-1;if(10>this.Lb.length||10>this.zd.length)return this.Ke=this.Lb.length,this.Zb=6,!0;null==this.Ff&&(this.Ff=new a.ms(!0),this.ax=this.Ff.jf(),this.dg=new a.ha(0));this.Ff.bs();for(var b=0;b<this.zd.length;b++){var c=this.zd[b];this.Ff.xs(c.o,c.v)}this.Ff.yq();this.dg.zb(2*this.zd.length);this.dg.resize(0);for(b=0;b<2*this.zd.length;b++)this.dg.add(b);this.Au(this.dg,this.dg.size,!1);this.mh=this.dg.size;-1!=this.bg&&
(this.Od.zh(this.bg),this.gk.resize(0),this.bg=-1);this.Zb=7;return this.OJ()};b.prototype.OT=function(){this.$f=this.rg=-1;if(10>this.Lb.length||10>this.zd.length)return this.Ke=this.Lb.length,this.Zb=6,!0;null==this.Ad&&(this.Ad=new a.ms(!0),this.ip=this.Ad.jf(),this.Wd=new a.ha(0));null==this.Ff&&(this.Ff=new a.ms(!0),this.ax=this.Ff.jf(),this.dg=new a.ha(0));this.Ad.bs();for(var b=0;b<this.Lb.length;b++){var c=this.Lb[b];this.Ad.xs(c.o,c.v)}this.Ad.yq();this.Ff.bs();for(b=0;b<this.zd.length;b++)c=
this.zd[b],this.Ff.xs(c.o,c.v);this.Ff.yq();this.Wd.zb(2*this.Lb.length);this.dg.zb(2*this.zd.length);this.Wd.resize(0);this.dg.resize(0);for(b=0;b<2*this.Lb.length;b++)this.Wd.add(b);for(b=0;b<2*this.zd.length;b++)this.dg.add(b);this.Au(this.Wd,this.Wd.size,!0);this.Au(this.dg,this.dg.size,!1);this.Ke=this.Wd.size;this.mh=this.dg.size;-1!=this.cg&&(this.Od.zh(this.cg),this.hk.resize(0),this.cg=-1);-1!=this.bg&&(this.Od.zh(this.bg),this.gk.resize(0),this.bg=-1);this.Zb=7;return!0};b.prototype.rY=
function(){var a=this.Wd.get(--this.Ke),c=a>>1;if(b.Fj(a))return this.Ad.remove(c),0==this.Ke?(this.$f=this.rg=-1,this.Oc=!0,!1):!0;this.ip.gC(this.Lb[c].o,this.Lb[c].v,this.ta);this.rg=c;this.Zb=10;return!0};b.prototype.nY=function(){if(-1==--this.Ke)return this.$f=this.rg=-1,this.Oc=!0,!1;this.mh=this.rg=this.Ke;this.Zb=13;return!0};b.prototype.oY=function(){if(-1==--this.Ke)return this.$f=this.rg=-1,this.Oc=!0,!1;this.rg=this.Ke;this.mh=this.zd.length;this.Zb=14;return!0};b.prototype.pY=function(){var a=
this.Wd.get(this.Ke-1),c=this.dg.get(this.mh-1),d=this.Ks(a,!0),e=this.Ks(c,!1);return d>e?this.by():d<e?this.IC():b.GA(a)?this.by():b.GA(c)?this.IC():this.by()};b.prototype.by=function(){var c=this.Wd.get(--this.Ke),d=c>>1;if(b.Fj(c))return-1!=this.cg&&-1!=this.hk.get(d)?(this.Od.jd(this.cg,this.hk.get(d)),this.hk.set(d,-1)):this.Ad.remove(d),0==this.Ke?(this.$f=this.rg=-1,this.Oc=!0,!1):!0;if(-1!=this.bg&&0<this.Od.Zs(this.bg))for(c=this.Od.wc(this.bg);-1!=c;){var e=this.Od.getData(c);this.Ff.dh(e);
this.gk.set(e,-1);e=this.Od.nb(c);this.Od.jd(this.bg,c);c=e}0<this.Ff.size()?(this.ax.gC(this.Lb[d].o,this.Lb[d].v,this.ta),this.rg=d,this.Zb=12):(-1==this.cg&&(null==this.Od&&(this.Od=new a.cq),this.hk=new a.ha(0),this.hk.resize(this.Lb.length,-1),this.hk.$h(-1,0,this.Lb.length),this.cg=this.Od.ni(1)),this.hk.set(d,this.Od.addElement(this.cg,d)),this.Zb=7);return!0};b.prototype.IC=function(){var c=this.dg.get(--this.mh),d=c>>1;if(b.Fj(c))return-1!=this.bg&&-1!=this.gk.get(d)?(this.Od.jd(this.bg,
this.gk.get(d)),this.gk.set(d,-1)):this.Ff.remove(d),0==this.mh?(this.$f=this.rg=-1,this.Oc=!0,!1):!0;if(-1!=this.cg&&0<this.Od.Zs(this.cg))for(c=this.Od.wc(this.cg);-1!=c;){var e=this.Od.getData(c);this.Ad.dh(e);this.hk.set(e,-1);e=this.Od.nb(c);this.Od.jd(this.cg,c);c=e}0<this.Ad.size()?(this.ip.gC(this.zd[d].o,this.zd[d].v,this.ta),this.$f=d,this.Zb=11):(-1==this.bg&&(null==this.Od&&(this.Od=new a.cq),this.gk=new a.ha(0),this.gk.resize(this.zd.length,-1),this.gk.$h(-1,0,this.zd.length),this.bg=
this.Od.ni(0)),this.gk.set(d,this.Od.addElement(this.bg,d)),this.Zb=7);return!0};b.prototype.FA=function(){this.$f=this.ip.next();if(-1!=this.$f)return!1;var a=this.Wd.get(this.Ke)>>1;this.Ad.dh(a);this.Zb=4;return!0};b.prototype.FU=function(){this.rg=this.ip.next();if(-1!=this.rg)return!1;this.$f=this.rg=-1;var a=this.dg.get(this.mh)>>1;this.Ff.dh(a);this.Zb=7;return!0};b.prototype.CU=function(){this.$f=this.ax.next();if(-1!=this.$f)return!1;var a=this.Wd.get(this.Ke)>>1;this.Ad.dh(a);this.Zb=7;
return!0};b.prototype.DU=function(){if(-1==--this.mh)return this.Zb=5,!0;this.lr.I(this.Lb[this.Ke]);var a=this.Lb[this.mh];this.lr.P(this.ta,this.ta);return this.lr.Yb(a)?(this.$f=this.mh,!1):!0};b.prototype.EU=function(){if(-1==--this.mh)return this.Zb=6,!0;this.lr.I(this.Lb[this.Ke]);var a=this.zd[this.mh];this.lr.P(this.ta,this.ta);return this.lr.Yb(a)?(this.$f=this.mh,!1):!0};b.prototype.OJ=function(){if(null==this.Ad)return this.Oc=!0,!1;this.Ke=this.Wd.size;0<this.Ad.size()&&this.Ad.reset();
-1!=this.cg&&(this.Od.zh(this.cg),this.hk.resize(0),this.cg=-1);this.Oc=!1;return!0};b.prototype.NJ=function(){if(null==this.Ff)return this.Oc=!0,!1;this.mh=this.dg.size;0<this.Ff.size()&&this.Ff.reset();-1!=this.bg&&(this.Od.zh(this.bg),this.gk.resize(0),this.bg=-1);this.Oc=!1;return!0};b.prototype.Au=function(b,d,e){null==this.un&&(this.un=new a.Ju);e=new c(this,e);this.un.sort(b,0,d,e)};b.prototype.hY=function(a,c,d,e){var h=this;a.Fd(c,d,function(a,c){var d=h.Ks(a,e),f=h.Ks(c,e);return d<f||d==
f&&b.Fj(a)&&b.GA(c)?-1:1})};b.prototype.Ks=function(a,c){var d=.5*this.ta;if(c)return c=this.Lb[a>>1],d=b.Fj(a)?c.A-d:c.B+d;c=this.zd[a>>1];return d=b.Fj(a)?c.A-d:c.B+d};return b}();a.mD=b})(C||(C={}));(function(a){var b=function(){function b(){}b.pa=function(a,c,d,e,f,g){var h=new b;h.o=a;h.A=c;h.xf=d;h.v=e;h.B=f;h.Zg=g;return h};b.prototype.Oa=function(){this.xf=this.o=NaN};b.prototype.u=function(){return isNaN(this.o)};b.prototype.sU=function(){return isNaN(this.xf)};b.prototype.I=function(a,b,
c,d,e,f){void 0!==d?"number"===typeof a?(this.o=a,this.A=b,this.xf=c,this.v=d,this.B=e,this.Zg=f):(this.o=a.x-.5*b,this.v=this.o+b,this.A=a.y-.5*c,this.B=this.A+c,this.xf=a.z-.5*d,this.Zg=this.xf+d):(this.o=a,this.A=b,this.xf=c,this.v=a,this.B=b,this.Zg=c)};b.prototype.move=function(a){this.o+=a.x;this.A+=a.y;this.xf+=a.z;this.v+=a.x;this.B+=a.y;this.Zg+=a.z};b.prototype.copyTo=function(a){a.o=this.o;a.A=this.A;a.v=this.v;a.B=this.B};b.prototype.ol=function(a,b,c){this.o>a?this.o=a:this.v<a&&(this.v=
a);this.A>b?this.A=b:this.B<b&&(this.B=b);0==isNaN(this.xf)?this.xf>c?this.xf=c:this.Zg<c&&(this.Zg=c):this.Zg=this.xf=c};b.prototype.Nb=function(c,d,e,f,g,w){if("number"===typeof c)f?(this.Nb(c,d,e),this.Nb(f,g,w)):this.u()?(this.o=c,this.A=d,this.xf=e,this.v=c,this.B=d,this.Zg=e):this.ol(c,d,e);else if(c instanceof a.od)this.Nb(c.x,c.y,c.z);else if(c instanceof b)c.u()||(this.Nb(c.o,c.A,c.xf),this.Nb(c.v,c.B,c.Zg));else throw a.g.F();};b.prototype.pa=function(a,b,c){a.u()||b.u()?this.Oa():(this.o=
a.ga,this.v=a.la,this.A=b.ga,this.B=b.la,this.xf=c.ga,this.Zg=c.la)};b.prototype.SB=function(b){if(null==b||8>b.length)throw a.g.F();b[0]=new a.od(this.o,this.A,this.xf);b[1]=new a.od(this.o,this.B,this.xf);b[2]=new a.od(this.v,this.B,this.xf);b[3]=new a.od(this.v,this.A,this.xf);b[4]=new a.od(this.o,this.A,this.Zg);b[5]=new a.od(this.o,this.B,this.Zg);b[6]=new a.od(this.v,this.B,this.Zg);b[7]=new a.od(this.v,this.A,this.Zg)};b.prototype.Mx=function(a){if(null==a||0==a.length)this.Oa();else{var b=
a[0];this.I(b.x,b.y,b.z);for(b=1;b<a.length;b++){var c=a[b];this.ol(c.x,c.y,c.z)}}};return b}();a.QL=b})(C||(C={}));(function(a){(function(a){a.za=function(){var a=Error();a.message="Internal Error";return a};a.af=function(){var a=Error();a.message="Not Implemented";return a};a.Dl=function(){var a=Error();a.message="The input unit and the spatial reference unit are not of the same unit type.ie Linear vs.Angular";return a};a.Da=function(){var a=Error();a.message="Invalid Call";return a};a.F=function(a){var b=
Error();b.message="Illegal Argument Exception";void 0!==a&&(b.message+=": "+a);return b};a.tN=function(){var a=Error();a.message="Runtime Exception.";return a};a.X=function(a){var b=Error();b.message="Geometry Exception: "+a;return b};a.yL=function(){var a=Error();a.message="Assert Failed Exception";return a};a.vd=function(){var a=Error();a.message="IndexOutOfBoundsException";return a};a.PZ=function(a){a.message="UserCancelException";return a}})(a.g||(a.g={}))})(C||(C={}));(function(a){a=a.Um||(a.Um=
{});a[a.forward=0]="forward";a[a.reverse=1]="reverse"})(C||(C={}));(function(a){var b=function(){function b(a,b){this.$a=a;this.HI=b;this.MI=-1;this.am=!1}b.prototype.Oe=function(){return!0};b.prototype.next=function(){if(++this.MI==this.HI.D())return null;var b=this.HI.Ba(this.MI);b.scale(this.$a.oc);var c=new a.Ja;this.$a.Vy(b,this.am,c);return c};b.prototype.Ia=function(){return 0};return b}(),c=function(){function b(b,c,d){this.$a=b;this.ex=c;this.So=!1;this.Yo=d;this.Pw=[0];this.Wk=[0];this.kk=
[0];this.Et=[0];this.am=!1;this.fr=new a.Ja;this.Yk=[]}b.prototype.Oe=function(){return!0};b.prototype.next=function(){if(this.So){this.So=!1;this.Bd.ba();var b=a.T.me(this.fr);return b=a.Cg.ql(b,this.$a.pr,!0,!0,this.$a.mc)}null==this.Bd&&(this.Bd=this.ex.Fa(),this.Bd.Ya(),null!=this.Yo&&this.Yo.Gl(null,0));if(!this.Bd.Ea()){if(!this.Bd.Ya())return null;null!=this.Yo&&this.Yo.Gl(null,0)}b=null;this.Wk[0]=0;this.oB=this.Pw[0]=0;this.Ei=NaN;this.So=!1;for(var c=this.Yk.length=0,e=new a.b,h=new a.b,
f=[0];this.Bd.Ea()&&8>this.oB;){var g=this.Bd.ba();e.L(g.ec());h.L(g.Ac());e.scale(this.$a.oc);h.scale(this.$a.oc);a.Ij.Fv(e,h)?e.x=h.x:a.Ij.Dv(e,h)&&(h.x=e.x);this.Yk.length=0;a.Ij.yG(this.$a.Vb,this.$a.rc,this.$a.Xe,e,h,this.$a.yB,this.$a.Vt,f,this.kk,this.Et,this.Yk,this.Pw);null!=this.Yo&&(g=this.Yk.slice(0),this.Yo.sH(this.Yo.aa()-1,g,g.length-1));a.Ij.Ev(e,h)?(this.fr.Oa(),this.$a.Vy(e,this.am,this.fr),this.So=!0):(this.fr.Oa(),this.So=this.bz(f[0],this.fr));if(this.So){this.Bd.Mi();if(this.Bd.rA()){this.Bd.Mi();
this.Bd.ba();break}this.Bd.dX();break}null==b&&(b=new a.Ja,b.Gl(null,0));this.fF(b);c++}this.Pw[0]=0;if(0<c){for(f=this.Bd.Db();0<c;)this.Bd.Mi(),e.L(this.ex.Ba(this.Bd.Db())),h.L(this.ex.Ba(this.Bd.Lk())),e.scale(this.$a.oc),h.scale(this.$a.oc),this.am&&(a.Ij.Fv(e,h)?e.x=h.x:a.Ij.Dv(e,h)&&(h.x=e.x)),this.Yk.length=0,a.Ij.yG(this.$a.Vb,this.$a.rc,this.$a.Xe,h,e,this.$a.yB,this.$a.Vt,null,this.kk,this.Et,this.Yk,this.Pw),this.fF(b),c--;e.L(this.ex.Ba(this.Bd.Db()));e.scale(this.$a.oc);d.Ds(this.$a.Vb,
this.$a.rc,this.$a.oc,this.$a.wb,e,this.Ei+1.570796326794897,this.Ei+4.71238898038469,this.$a.Wo,this.am,this.Wk,b,NaN,NaN);this.Bd.Tb(f);this.Bd.ba();c=a.na.$g(null,b,!0);return b=a.Cg.ql(b,c,!0,!0,this.$a.mc)}this.So=!1;this.Bd.ba();b=a.T.me(this.fr);return b=a.Cg.ql(b,this.$a.pr,!0,!0,this.$a.mc)};b.prototype.fF=function(b){var c=this.Yk[0],e,h=this.kk[0]-1.570796326794897,f=this.Et[0]+1.570796326794897,p;if(!isNaN(this.Ei)){this.Ei>=this.kk[0]?(e=this.Ei+1.570796326794897,h=e+3.141592653589793-
(this.Ei-this.kk[0])):(e=this.Ei+1.570796326794897,h=e+3.141592653589793-(6.283185307179586-(this.kk[0]-this.Ei)));p=this.Ei>=this.kk[0]&&3.141592653589793>=this.Ei-this.kk[0]?!1:this.Ei<this.kk[0]&&3.141592653589793<=this.kk[0]-this.Ei?!1:!0;var g=!1;if(Math.abs(h-e)<=.5*this.$a.Wo)if(p){var n=b.Ba(b.D()-2);n.scale(this.$a.oc);var w=new a.da(0);a.mb.Iz(this.$a.Vb,this.$a.rc,c.x,c.y,n.x,n.y,w);for(n=w.j;n<=e;)n+=6.283185307179586;for(;n>e;)n-=6.283185307179586;n<h&&(g=!0)}else g=!0;g?(b.fC(0,b.D()-
1),this.am||(c=new a.b,c.L(b.Ba(b.D()-1)),c.scale(this.$a.oc),-3.141592653589793>c.x-this.Wk[0]?this.Wk[0]-=6.283185307179586:3.141592653589793<c.x-this.Wk[0]&&(this.Wk[0]+=6.283185307179586)),p||(h=.5*(h+e))):(p?(e=new a.b,e.L(c),e.scale(1/this.$a.oc),b.Wf(0,-1,e)):d.Ds(this.$a.Vb,this.$a.rc,this.$a.oc,this.$a.wb,this.Yk[0],e,h,this.$a.Wo,this.am,this.Wk,b,NaN,NaN),this.oB+=1)}d.Uy(this.$a.Vb,this.$a.rc,this.$a.oc,this.$a.wb,this.$a.Xe,this.Yk,h,f,this.am,this.Wk,b);this.Ei=this.Et[0]};b.prototype.bz=
function(a,b){return this.$a.bz(this.Yk,a,this.kk[0],this.Et[0],this.am,b)};b.prototype.Ia=function(){return 0};return b}(),d=function(){function d(){}d.buffer=function(b,c,e,h,f,g){if(null==b)throw a.g.F("Geometry::Geodesic_bufferer::buffer");if(b.u())return new a.Ja(b.description);var p=new d;p.lh=c;p.Pc=a.fb.lc(c);var n=a.fb.hw(p.Pc);p.mc=g;p.Vb=a.fb.Sv(p.Pc);p.rc=n*(2-n);p.oc=p.Pc.Td().Bi;p.ta=p.lh.Ho();p.pr=p.Pc.Ho();p.Vt=p.pr*p.oc;p.or=1.570796326794897/p.oc;p.j_=3.141592653589793/p.oc;p.Gt=
6.283185307179586/p.oc;p.k_=p.Gt/6;p.tB=0;p.i_=1.5707963267948966*p.Vb/p.tB;4==e?(p.Xe=2,p.Jw=!0):(p.Xe=e,p.Jw=!1);p.Pa=h;p.wb=Math.abs(h);isNaN(f)||.001>f?p.XX():p.Vo=f;e=b.G();a.T.Nc(e)?(e=new a.Ua(b.description),e.cc(b,!0),b=e,e=1607):197==e&&(e=new a.h,b.s(e),e.O()<=p.ta||e.ea()<=p.ta?(e=new a.Ua(b.description),e.hd(b,!1),b=e,e=1607):(e=new a.Ja(b.description),e.hd(b,!1),b=e,e=1736));p.YX();a.T.Po(e)||p.ZX();if(p.wb<=.5*p.Vo)return 1736!=e?new a.Ja(b.description):p.Jw?b:a.Ij.Js(b,p.lh,p.Xe,p.yB,
-1,g);if(0>p.Pa&&1736!=e)return new a.Ja(b.description);p.Jw&&a.T.Hc(e)?(c=a.Ij.Js(b,c,4,NaN,p.Vo,g),b=a.fb.Vg(c,p.lh,p.Pc,g)):b=a.fb.Vg(b,p.lh,p.Pc,g);b=a.gi.Qj(b,p.Pc);if(b.u())return new a.Ja(b.description);!p.Jw&&a.T.Hc(e)&&(b=a.Ij.nJ(p.oc,b));b=d.UY(b,p.Pc);switch(e){case 1736:g=p.tP(b);break;case 1607:g=p.uP(b);break;case 550:g=p.rP(b);break;case 33:g=p.sP(b);break;default:throw a.g.X("corrupted_geometry");}p=a.fb.Vg(g,p.Pc,p.lh,p.mc);p.tm(b.description);return p};d.prototype.tP=function(b){var d=
new a.Ja;b=new c(this,b,d);b=a.ei.local().V(b,this.Pc,this.mc).next();b=a.bq.Rj(b,this.Pc,2);var e=new a.Gd;e.scale(1/this.oc,1/this.oc);d.Vc(e);d=a.bq.Rj(d,this.Pc,2);return 0<=this.Pa?a.ei.local().V(d,b,this.Pc,this.mc):a.eq.local().V(d,b,this.Pc,this.mc)};d.prototype.uP=function(b){b=new c(this,b,null);b=a.ei.local().V(b,this.Pc,this.mc).next();return b=a.bq.Rj(b,this.Pc,2)};d.prototype.rP=function(c){c=new b(this,c);c=a.ei.local().V(c,this.Pc,this.mc).next();return c=a.bq.Rj(c,this.Pc,2)};d.prototype.sP=
function(b){b=b.w();b.scale(this.oc);var c=new a.Ja;this.Vy(b,!1,c);return c=a.bq.Rj(c,this.Pc,2)};d.prototype.bz=function(b,c,e,h,f,g){var p=b[0],n=b[b.length-1],y=p.y>n.y?p.y:n.y,D=a.C.q(this.Vb,this.rc,p.y<n.y?p.y:n.y),y=a.C.q(this.Vb,this.rc,y);if(.001<this.tB-(D+c+this.wb)&&.001<this.tB+(y-c-this.wb))return!1;c=e-1.570796326794897;e=h+1.570796326794897;var D=c-3.141592653589793,y=c+3.141592653589793,w=e+3.141592653589793,K=[NaN],k=[NaN],P=[NaN],l=[NaN];h=!1;d.jD(this.Vb,this.rc,this.wb,p,c,D,
n,e,K,k);d.jD(this.Vb,this.rc,this.wb,n,w,e,p,D,P,l);e<K[0]&&K[0]<w?h=!0:e<k[0]&&k[0]<w&&(h=!0);h||(D<P[0]&&P[0]<c?h=!0:D<l[0]&&l[0]<c&&(h=!0));if(!h&&f)return!1;for(var m=[],N=b.length-1;0<=N;N--)m.push(b[N]);g.Oa();g.Gl(null,0);N=[0];d.Uy(this.Vb,this.rc,this.oc,this.wb,this.Xe,b,c,e,f,N,g);d.Ds(this.Vb,this.rc,this.oc,this.wb,n,e,w,this.Wo,f,N,g,K[0],k[0]);d.Uy(this.Vb,this.rc,this.oc,this.wb,this.Xe,m,w,y,f,N,g);d.Ds(this.Vb,this.rc,this.oc,this.wb,p,D,c,this.Wo,f,N,g,P[0],l[0]);b=!1;f||(b=this.OF(this.oc,
g));return h||b};d.prototype.Vy=function(a,b,c){c.Oa();c.Gl(null,0);d.Ds(this.Vb,this.rc,this.oc,this.wb,a,-this.Wo,6.283185307179586,this.Wo,b,[0],c,NaN,NaN);b||this.OF(this.oc,c)};d.prototype.OF=function(a,b){var c=this.VP(a,b);a=this.WP(a,b);return c||a};d.prototype.VP=function(b,c){var d=c.D(),e=!1,h=new a.h;c.s(h);if(!a.l.W(h.B*b,1.570796326794897)&&!a.l.W(h.A*b,-1.570796326794897))return!1;for(var f=new a.b,d=d-1;0<=d;d--)c.w(d,f),f.y==h.B&&a.l.W(f.y*b,1.570796326794897)?(e=!0,this.wJ(f,d,c)):
f.y==h.A&&a.l.W(f.y*b,-1.570796326794897)&&(e=!0,this.wJ(f,d,c));return e};d.prototype.WP=function(a,b){var c=b.Ba(0),d=b.Ba(b.D()-1);return 3.141592653589793<Math.abs(c.x-d.x)*a?(this.qW(b),!0):this.UP(b)};d.prototype.UP=function(a){return 0>a.ef()?(this.pW(a),!0):!1};d.prototype.wJ=function(b,c,d){var e=d.D(),h=0<c?c-1:e-1,e=d.Ba(c<e-1?c+1:0),h=d.Ba(h);if(!a.l.W(e.y,b.y)&&!a.l.W(e.x,b.x)){var f=new a.b;f.ja(e.x,b.y);d.rb(c,f)}a.l.W(h.y,b.y)||a.l.W(h.x,b.x)||(e=new a.b,e.ja(h.x,b.y),d.Wf(0,c,e))};
d.prototype.qW=function(b){var c=new a.Ja,d=new a.Ja,e=new a.Gd,h=b.Ba(0),f=b.Ba(b.D()-1),p=new a.b;h.x>f.x?(f=this.or,e.zg(-this.Gt,0)):(f=-this.or,e.zg(this.Gt,0));c.add(b,!1);b.Oa();d.add(c,!1);d.Vc(e);h=new a.h;d.s(h);h.P((this.Gt-h.O())/2,0);h.A=-this.or;h.B=this.or;for(var g=0;g<d.D();g++)d.w(g,p),c.Wf(0,-1,p);d.Vc(e);for(g=0;g<d.D();g++)d.w(g,p),c.Wf(0,-1,p);d=c.Ba(0);e=c.Ba(c.D()-1);p.ja(e.x,f);c.Wf(0,-1,p);p.ja(.5*(e.x+d.x),f);c.Wf(0,-1,p);p.ja(d.x,f);c.Wf(0,-1,p);c=a.gi.jt(c,this.Pc,2,!0,
h.o);c=a.gi.jt(c,this.Pc,2,!0,h.v);c=a.le.clip(c,h,this.pr,NaN);b.add(c,!1)};d.prototype.pW=function(b){var c=new a.h;b.s(c);c.P((this.Gt-c.O())/2,0);c.A=-this.or;c.B=this.or;b.Gl(null,0);var d=new a.b;d.ja(c.o,c.A);b.Wf(1,-1,d);d.ja(c.o,c.B);b.Wf(1,-1,d);d.ja(.5*(c.o+c.v),c.B);b.Wf(1,-1,d);d.ja(c.v,c.B);b.Wf(1,-1,d);d.ja(c.v,c.A);b.Wf(1,-1,d);d.ja(.5*(c.o+c.v),c.A);b.Wf(1,-1,d)};d.Uy=function(b,c,e,h,f,g,n,w,k,l,m){var p=null;k||(p=new a.b,p.Yc(),0<m.D()&&(p.L(m.Ba(m.D()-1)),p.scale(e)));var y=new a.da(0),
D=new a.da(0),K=new a.da(0),P=new a.b,N=new a.b,q=g[g.length-1];e=1/e;for(var r=0;r<g.length;r++){var U=g[r],I;0==r?I=n:r==g.length-1?I=w:(a.mb.Kd(b,c,q.x,q.y,U.x,U.y,null,null,y,f),I=y.j-1.570796326794897);a.mb.Yi(b,c,U.x,U.y,h,I,D,K);k?N.ja(D.j,K.j):(P.ja(D.j,K.j),d.nE(U.x,P.x,p.x,l),N.ja(l[0]+P.x,P.y),p.L(N));N.scale(e);m.Wf(0,-1,N)}};d.Ds=function(b,c,e,h,f,g,n,w,k,l,m,q,r){if(!(n-g<w)){var p=new a.da(0),y=new a.da(0),D=new a.b,K=new a.b,P=null;k||(P=new a.b,P.Yc(),0<m.D()&&(P.L(m.Ba(m.D()-1)),
P.scale(e)));var N=a.J.truncate(Math.ceil(g/w)),U=N++*w;U==g&&(U=N++*w);for(e=1/e;U<n+w;){g<q&&q<U?(U=q,N--):g<r&&r<U&&(U=r,N--);if(U>=n)break;a.mb.Yi(b,c,f.x,f.y,h,U,p,y);k?K.ja(p.j,y.j):(D.ja(p.j,y.j),d.nE(f.x,D.x,P.x,l),K.ja(l[0]+D.x,D.y),P.L(K));K.scale(e);m.Wf(0,-1,K);g=U;U=N++*w}}};d.jD=function(b,c,d,e,h,f,g,n,w,k){var p=new a.b,y=new a.b,D=new a.da(0),K=new a.da(0);a.mb.Yi(b,c,e.x,e.y,d,h,D,K);p.ja(D.j,K.j);a.mb.Yi(b,c,e.x,e.y,d,f,D,K);y.ja(D.j,K.j);d=new a.da(0);a.mb.Iz(b,c,g.x,g.y,p.x,p.y,
d);w[0]=d.j;a.mb.Iz(b,c,g.x,g.y,y.x,y.y,d);for(k[0]=d.j;w[0]<=k[0];)w[0]+=6.283185307179586;for(;w[0]>k[0];)w[0]-=6.283185307179586;for(;w[0]>=n;)w[0]-=6.283185307179586,k[0]-=6.283185307179586;for(;w[0]<n;)w[0]+=6.283185307179586,k[0]+=6.283185307179586};d.nE=function(a,b,c,d){if(isNaN(c)){for(;3.141592653589793<d[0]+b-a;)d[0]-=6.283185307179586;for(;3.141592653589793<a-(d[0]+b);)d[0]+=6.283185307179586}else 3.141592653589793<d[0]+b-c?d[0]-=6.283185307179586:3.141592653589793<c-(d[0]+b)&&(d[0]+=
6.283185307179586)};d.UY=function(b,c){var d=b.G(),e;a.T.Hc(d)?e=b.aa():550==d?e=b.D():e=1;if(1==e)return b;var h=new a.ha(0);h.resize(e);for(var f=[],p=new a.h,g=0;g<e;g++){h.write(g,g);var n;a.T.Hc(d)?(b.nk(g,p),n=p.Tf()):n=b.Ba(g);n=a.dM.xY(c,n);f[g]=n}h.Fd(0,h.size,function(a,b){return f[a]<f[b]?-1:f[a]>f[b]?1:0});p=b.Ka();for(g=0;g<e;g++)n=h.read(g),a.T.Hc(d)?p.Ui(b,n,!0):p.Hd(b,n,n+1);return p};d.prototype.YX=function(){var b=Math.min(3.141592653589793*this.Vb-this.wb,this.wb),b=Math.min(b,
.39269908169872414*this.Vb),c=new a.b;c.ja(0,10*this.oc);var d=45*this.oc,e=new a.da(0),h=new a.da(0),f=new a.da(0),g=new a.da(0),n=new a.da(0),w=new a.da(0),k=new a.da(0),l=new a.da(0),m=new a.b,q=new a.b,r=new a.b,I=new a.b;a.mb.Yi(this.Vb,this.rc,c.x,c.y,b,0,e,h);m.ja(e.j,h.j);a.mb.Yi(this.Vb,this.rc,c.x,c.y,b,d,f,g);q.ja(f.j,g.j);for(var e=new a.da(0),h=new a.da(0),t=new a.da(0);;){a.mb.Yi(this.Vb,this.rc,c.x,c.y,b,.5*(0+d),n,w);r.ja(n.j,w.j);a.mb.Kd(this.Vb,this.rc,m.x,m.y,q.x,q.y,e,h,null,2);
a.mb.Sj(this.Vb,this.rc,m.x,m.y,.5*e.j,h.j,k,l,2);I.ja(k.j,l.j);a.mb.Kd(this.Vb,this.rc,r.x,r.y,I.x,I.y,t,null,null,2);if(t.j<=this.Vo)break;d*=.9;a.mb.Yi(this.Vb,this.rc,c.x,c.y,b,d,f,g);q.ja(f.j,g.j)}this.Wo=6.283185307179586/Math.ceil(6.283185307179586/(d-0))};d.prototype.ZX=function(){var b=Math.min(3.141592653589793*this.Vb-this.wb,this.wb),b=Math.min(b,.39269908169872414*this.Vb),c=new a.b,d=new a.b;c.ja(0,10*this.oc);d.ja(10*this.oc,10*this.oc);var e=new a.da(0),h=new a.da(0),f=new a.da(0);
a.mb.Kd(this.Vb,this.rc,c.x,c.y,d.x,d.y,f,e,h,this.Xe);var g=new a.da(0),n=new a.da(0),w=new a.da(0),k=new a.da(0),l=new a.b,m=new a.da(0),q=new a.da(0),r=new a.da(0),I=new a.da(0),t=new a.da(0),u=new a.da(0),v=new a.da(0),x=new a.da(0),z=new a.da(0),B=new a.b,A=new a.b,F=new a.b,C=new a.b,G=1,e=e.j,h=h.j+1.570796326794897,f=f.j;a.mb.Yi(this.Vb,this.rc,c.x,c.y,b,e-1.570796326794897,q,r);B.ja(q.j,r.j);a.mb.Yi(this.Vb,this.rc,d.x,d.y,b,h,I,t);A.ja(I.j,t.j);for(var q=new a.da(0),r=new a.da(0),h=new a.da(0),
E=new a.da(0);;){a.mb.Sj(this.Vb,this.rc,c.x,c.y,.5*(0+G)*f,e,g,n,this.Xe);l.ja(g.j,n.j);a.mb.Kd(this.Vb,this.rc,c.x,c.y,l.x,l.y,null,null,m,this.Xe);a.mb.Yi(this.Vb,this.rc,l.x,l.y,b,m.j+1.570796326794897,u,v);F.ja(u.j,v.j);a.mb.Kd(this.Vb,this.rc,B.x,B.y,A.x,A.y,q,r,null,2);a.mb.Sj(this.Vb,this.rc,B.x,B.y,.5*q.j,r.j,x,z,2);C.ja(x.j,z.j);a.mb.Kd(this.Vb,this.rc,F.x,F.y,C.x,C.y,h,null,null,2);if(h.j<=this.Vo)break;G*=.9;a.mb.Sj(this.Vb,this.rc,c.x,c.y,G*f,e,w,k,this.Xe);d.ja(w.j,k.j);a.mb.Kd(this.Vb,
this.rc,c.x,c.y,d.x,d.y,null,null,E,this.Xe);a.mb.Yi(this.Vb,this.rc,d.x,d.y,b,E.j+1.570796326794897,I,t);A.ja(I.j,t.j)}b=G*f;1E5<b&&(b=1E5);this.yB=b};d.prototype.XX=function(){var a;a=5E4<this.wb?100:1E4<this.wb?10:1;500>this.wb/a&&(a=this.wb/500);.01>a&&(a=.01);this.Vo=a};return d}();a.bM=d})(C||(C={}));(function(a){var b=function(){function b(){}b.tb=function(b,c){var d=new a.b;d.L(c);b.push(d)};b.Dj=function(a,b){a.add(b.x);a.add(b.y)};b.SC=function(a){a.uf(a.size-2)};b.$C=function(a,b){b.ja(a.get(a.size-
2),a.get(a.size-1))};b.Js=function(c,d,e,f,g,w){if(null==c)throw a.g.F();var h=c.G();if(c.u()||a.T.Po(h))return c;var p=new b;p.lh=d;p.Pc=a.fb.lc(d);var n=a.fb.hw(p.Pc);p.mc=w;p.Vb=a.fb.Sv(p.Pc);p.rc=n*(2-n);p.oc=p.Pc.Td().Bi;p.pr=p.Pc.Ho();p.Vt=p.pr*p.oc;p.jB=f;p.iB=g;p.Xe=e;197==h?(e=new a.Ja(c.description),e.hd(c,!1)):a.T.Nc(h)?(e=new a.Ua(c.description),e.cc(c,!0)):e=c;if(4!=p.Xe){d=0==p.lh.Eb(p.Pc)?a.fb.Vg(e,p.lh,p.Pc,w):a.gi.Qj(e,p.Pc);if(d.u())return d;d=b.nJ(p.oc,d);d=p.Jz(d);d=a.bq.Rj(d,
p.Pc,p.Xe);p=a.fb.Vg(d,p.Pc,p.lh,w)}else{2==a.ve.Fb(d)?(c=a.fb.Ok(d),w=a.wk.local().V(e,c,d,w),w==c&&(w=new a.Ja,c.copyTo(w))):w=a.gi.Qj(e,p.Pc);d=w;if(d.u())return d;p=p.aY(d)}return p};b.nJ=function(c,d){var e=new a.h;d.ac(e);if(3.141592653589793>e.O()*c)return d;for(var h=!1,e=d.Fa(),f=new a.b,g=new a.b;e.Ya();)for(;e.Ea();){var n=e.ba();f.L(n.ec());g.L(n.Ac());f.scale(c);g.scale(c);if(3.141592653589793<Math.abs(f.x-g.x)){var w=b.Ev(f,g);if(!w){h=!0;break}if(6.283185307179586<Math.abs(f.x-g.x)){h=
!0;break}}}if(!h)return d;var h=d.Ka(),k=1<d.description.Ga,l=new a.b,m=new a.b,q=new a.b,r=new a.b,t=new a.Wa;for(e.zj();e.Ya();)for(var I=NaN,u=[0];e.Ea();){n=e.ba();f.L(n.ec());g.L(n.Ac());f.scale(c);g.scale(c);isNaN(I)?(b.ad(f.x,NaN,u),m.L(f)):m.L(q);I=m.x;if(w=b.Ev(f,g)){if(6.283185307179586<g.x-f.x)for(;6.283185307179586<g.x-f.x;)g.x-=6.283185307179586;if(-6.283185307179586>g.x-f.x)for(;-6.283185307179586>g.x-f.x;)g.x+=6.283185307179586;b.ad(g.x,NaN,u);q.L(g)}else l.L(g),b.KU(l),b.ad(l.x,I,
u),q.ja(u[0]+l.x,l.y);.5>Math.abs(q.x-g.x)&&q.L(g);k?(n.Fx(0,t),r.L(m),r.scale(1/c),t.rb(r),(w=e.pn())?h.Of(t):h.lineTo(t),e.Oo()&&!d.Qb(e.Ta)&&(n.Fx(1,t),r.L(q),r.scale(1/c),t.rb(r),h.lineTo(t))):((w=e.pn())&&h.uA(null,0),n=h.aa()-1,r.L(m),r.scale(1/c),h.Wf(n,-1,r),e.Oo()&&!d.Qb(e.Ta)&&(r.L(q),r.scale(1/c),h.Wf(n,-1,r)))}return h};b.yG=function(c,d,e,f,g,w,k,l,m,q,r,t){var h=new a.b,p=new a.b,n=0<f.compare(g);b.hE(n,f,g,h,p);b.vE(c,d,e,h,p,w,NaN,k,l,m,q,null,r,t);n&&b.aD(m,q,null,r)};b.prototype.Jz=
function(c){var d=c.Ka(),e=c.Fa(),f=[],g=null,n=null,w=1<c.description.Ga;w&&(g=new a.Pd(0),n=new a.Bg);for(var k=[0],l=new a.b,m=new a.b,q=new a.b,r=new a.b;e.Ya();)for(k[0]=0;e.Ea();){var t=e.ba();l.L(t.ec());m.L(t.Ac());l.scale(this.oc);m.scale(this.oc);var I=0<l.compare(m);b.hE(I,l,m,q,r);f.length=0;null!=g&&g.uf(0);0<this.jB?b.vE(this.Vb,this.rc,this.Xe,q,r,this.jB,this.iB,this.Vt,null,null,null,w?g:null,f,k):b.fN(this.Vb,this.rc,this.Xe,q,r,this.iB,this.Vt,w?g:null,f,k);I&&b.aD(null,null,w?
g:null,f);f[0].L(t.ec());f[f.length-1].L(t.Ac());for(var u=1;u<f.length-1;u++)f[u].scale(1/this.oc);w?(I=b.fE(I,t,n),b.CD(e.pn(),e.Oo()&&!c.Qb(e.Ta),t,I,g,f,d)):b.AD(e.pn(),e.Oo()&&!c.Qb(e.Ta),f,d)}return d};b.prototype.aY=function(c){var d=c.Ka(),e=c.Fa(),f=[],g=null,n=new a.Bg,w=1<c.description.Ga;for(w&&(g=new a.Pd(0));e.Ya();)for(;e.Ea();){var k=e.ba(),l=k.ec(),m=k.Ac(),l=0<l.compare(m),m=b.fE(l,k,n);f.length=0;null!=g&&g.uf(0);b.vY(this.Vb,this.rc,this.oc,m,this.lh,this.jB,this.iB,w?g:null,f);
l&&b.aD(null,null,w?g:null,f);w?b.CD(e.pn(),e.Oo()&&!c.Qb(e.Ta),k,m,g,f,d):b.AD(e.pn(),e.Oo()&&!c.Qb(e.Ta),f,d)}return d};b.AD=function(a,b,c,d){a&&d.uA(null,0);a=d.aa()-1;var e=c.slice(0);d.sH(a,e,e.length-1);b&&d.Wf(a,-1,c[c.length-1])};b.CD=function(b,c,d,e,f,g,w){var h=new a.Wa;d.Kp(h);b?w.Of(h):w.lineTo(h);if(2<g.length){b=e.Rb();for(var p=1;p<g.length-1;p++){var n=e.PH(f.get(p)*b);e.Fx(n,h);h.rb(g[p]);w.lineTo(h)}}c&&(d.Ip(h),w.lineTo(h))};b.vE=function(c,d,e,f,g,w,k,l,m,q,r,t,I,u){var h=new a.da(0),
p=new a.da(0),n=new a.da(0);a.mb.Kd(c,d,f.x,f.y,g.x,g.y,n,h,p,e);var n=n.j,y=h=h.j,p=p.j;0>y&&(y+=6.283185307179586);0>p&&(p+=6.283185307179586);null!=m&&(m[0]=n);null!=q&&(q[0]=y);null!=r&&(r[0]=p);q=m=NaN;null!=t&&(q=a.C.Wg(c,d),r=a.C.q(c,d,f.y),m=(q-r)/n,q=(q+r)/n);r=b.Fv(f,g);var p=b.Dv(f,g),y=r||p,D=b.eE(f,g,l),K=new a.da(0),P=new a.da(0),N=new a.b,U=new a.b,ka=new a.b;b.ad(f.x,NaN,u);var v=[u[0]];if(n<=w)b.tb(I,f),b.ad(g.x,NaN,u),null!=t&&t.add(0),y?(r&&b.ZC(f,g,t,I),p&&b.TC(f,g,t,I)):D?b.UC(f,
g,h,m,q,t,I):0<k&&(U.ja(f.x-v[0],f.y),N.ja(g.x-u[0],g.y),b.Gz(c,d,e,f,n,h,U,N,0,1,k,t,I,v)),b.tb(I,g);else{w=1+a.J.truncate(Math.ceil(n/w));var xa=n/(w-1),x=new a.b,ya=0;b.tb(I,f);x.L(f);U.ja(f.x-u[0],f.y);null!=t&&t.add(0);for(var z=1;z<w;z++){var wa;z<w-1?(a.mb.Sj(c,d,f.x,f.y,z*xa,h,K,P,e),N.ja(K.j,P.j),b.ad(N.x,x.x,u),ka.ja(u[0]+N.x,N.y),wa=z/(w-1)):(b.ad(g.x,NaN,u),N.ja(g.x-u[0],g.y),ka.L(g),wa=1);y?(1==z&&r&&b.ZC(f,ka,t,I),z==w-1&&p&&b.TC(x,g,t,I)):D?b.cE(x,ka,l)&&(f.x<g.x?x.x>ka.x&&(u[0]+=6.283185307179586,
ka.ja(u[0]+N.x,N.y)):x.x<ka.x&&(u[0]-=6.283185307179586,ka.ja(u[0]+N.x,N.y)),b.UC(x,ka,h,m,q,t,I)):0<k&&b.Gz(c,d,e,f,n,h,U,N,ya,wa,k,t,I,v);b.tb(I,ka);null!=t&&t.add(wa);x.L(ka);U.L(N);v[0]=u[0];ya=wa}}};b.fN=function(c,d,e,f,g,w,k,l,m,q){var h=new a.da(0),p=new a.da(0),n=new a.da(0);a.mb.Kd(c,d,f.x,f.y,g.x,g.y,n,h,p,e);var p=n.j,h=h.j,y=n=NaN;if(null!=l)var y=a.C.Wg(c,d),D=a.C.q(c,d,f.y),n=(y-D)/p,y=(y+D)/p;var D=b.Fv(f,g),K=b.Dv(f,g),P=D||K;k=b.eE(f,g,k);var N=b.Ev(f,g),N=P||k||N;b.ad(f.x,NaN,q);
var r=new a.b;b.tb(m,f);r.L(f);null!=l&&l.add(0);N?(P?(D&&b.ZC(f,g,l,m),K&&b.TC(f,g,l,m)):k&&b.UC(f,g,h,n,y,l,m),b.ad(g.x,NaN,q),b.tb(m,g)):p<=w?(b.ad(g.x,NaN,q),b.tb(m,g)):(n=new a.b,k=new a.b,n.L(f),k.L(g),n.x-=q[0],k.x-=q[0],-3.141592653589793>k.x?k.x+=6.283185307179586:3.141592653589793<k.x&&(k.x-=6.283185307179586),b.Gz(c,d,e,f,p,h,n,k,0,1,w,l,m,q),b.tb(m,g),b.ad(g.x,NaN,q));null!=l&&l.add(1)};b.Gz=function(c,d,e,f,g,w,k,l,m,q,r,t,I,u){var h=new a.b,p=new a.b;h.ja(k.x+u[0],k.y);new a.da(0);new a.da(0);
new a.da(0);new a.da(0);var n=new a.da(0),y=new a.da(0),D=new a.da(0),K=new a.b,P=new a.b,N=new a.b,U=new a.b;K.L(k);P.L(l);k=new a.Pd(0);l=new a.Pd(0);b.Dj(k,P);l.add(q);var ka=new a.b,v=new a.Hb,xa=[];for(b.rE(4,xa);0<k.size;){for(var x=!1,z,ya=NaN,wa=0;3>wa;wa++)if(z=xa[wa]*q+(1-xa[wa])*m,a.mb.Sj(c,d,f.x,f.y,z*g,w,n,y,e),N.ja(n.j,y.j),0==wa&&(ya=z,U.L(N)),b.kX(K,N,P,v),v.hc(v.ne(N,!0),ka),a.mb.Kd(c,d,N.x,N.y,ka.x,ka.y,D,null,null,2),D.j>r){x=!0;break}x?(P.L(U),q=ya,b.Dj(k,P),l.add(q)):(b.SC(k),
l.Hk(l.size-1,1,l.size-1),0<k.size&&(b.ad(P.x,h.x,u),p.ja(u[0]+P.x,P.y),b.tb(I,p),h.L(p),null!=t&&t.add(q),K.L(P),m=q,b.$C(k,P),q=l.get(l.size-1)))}};b.vY=function(c,d,e,f,g,w,k,l,m){var h=new a.b,p=new a.b,n=new a.b,y=new a.b,D=new a.b,K=new a.b,P=new a.b,N=new a.b,q=new a.b,r=new a.b,U=new a.da(0),t=new a.da(0),I=new a.b,u=[[],[]],v=1==a.ve.Fb(g);g=g.pe(0);var x=f.ec(),z=f.Ac();v?(K.ja(x.x*e,x.y*e),P.ja(z.x*e,z.y*e)):(u[0][0]=x.x,u[0][1]=x.y,u[1][0]=z.x,u[1][1]=z.y,a.fb.nu(),K.x=u[0][0]*e,K.y=u[0][1]*
e,P.x=u[1][0]*e,P.y=u[1][1]*e);var B=0,A=0,F=1,C=f.Mo();h.L(x);p.L(z);var z=new a.Pd(0),G=new a.Pd(0),E=new a.Pd(0);b.Dj(z,p);b.Dj(G,P);E.add(F);b.tb(m,h);null!=l&&l.add(A);var J=[],H;H=0<k?C?5:3:C?5:1;b.rE(H,J);for(var M=new a.da(0),ua=new a.da(0),L=new a.da(0),O=new a.da(0),R=new a.da(0),Q=new a.da(0),S=new a.da(0);0<G.size;){var T=!1,V,W=NaN;a.mb.Kd(c,d,K.x,K.y,P.x,P.y,M,ua,null,2);for(x=0;x<H;x++){if(0==x){if(!C&&0>=k&&M.j<=w&&3.141592653589793>Math.abs(K.x-P.x))break;if(f.zy(A,F)<=g)break}V=
J[x]*F+(1-J[x])*A;f.hc(V,n);v?N.ja(n.x*e,n.y*e):(u[0][0]=n.x,u[0][1]=n.y,a.fb.nu(),N.x=u[0][0]*e,N.y=u[0][1]*e);if(0==x&&(W=V,D.L(n),r.L(N),0<w&&(M.j>w||3.141592653589793<=Math.abs(K.x-P.x)))){T=!0;break}if(C&&0<w){if(a.mb.Kd(c,d,K.x,K.y,N.x,N.y,L,null,null,2),L.j>w||3.141592653589793<=Math.abs(K.x-N.x)){T=!0;break}}else if(0<k)if(C?(y.kU(h,p,J[x]),v?q.ja(y.x*e,y.y*e):(u[0][0]=y.x,u[0][1]=y.y,a.fb.nu(),q.x=u[0][0]*e,q.y=u[0][1]*e)):(y.L(n),q.L(N)),a.mb.Kd(c,d,K.x,K.y,q.x,q.y,O,null,null,2),O.j<=M.j){a.mb.Sj(c,
d,K.x,K.y,O.j,ua.j,U,t,2);I.ja(U.j,t.j);a.mb.Kd(c,d,I.x,I.y,N.x,N.y,R,null,null,2);if(R.j>k){T=!0;break}if(C){a.mb.Kd(c,d,I.x,I.y,q.x,q.y,Q,null,null,2);if(Q.j>k){T=!0;break}a.mb.Kd(c,d,q.x,q.y,N.x,N.y,S,null,null,2);if(S.j>k){T=!0;break}}}else{T=!0;break}}T?(p.L(D),P.L(r),F=W,b.Dj(z,p),b.Dj(G,P),E.add(F)):(b.SC(z),b.SC(G),E.Hk(E.size-1,1,E.size-1),b.tb(m,p),B+=M.j,null!=l&&l.add(B),0<G.size&&(h.L(p),K.L(P),A=F,b.$C(z,p),b.$C(G,P),F=E.get(E.size-1)))}if(null!=l)for(c=1/B,x=0;x<l.size;x++)l.write(x,
l.read(x)*c)};b.aD=function(a,b,c,d){d.reverse();null!=c&&c.Xd(0,c.size,1);c=null!=a?a[0]:NaN;d=null!=b?b[0]:NaN;null!=a&&(a[0]=d);null!=b&&(b[0]=c)};b.hE=function(a,b,c,d,e){a?(d.L(c),e.L(b)):(d.L(b),e.L(c))};b.fE=function(a,b,c){if(!a)return b;c.create(b.G());b.copyTo(c.get());c.get().reverse();return c.get()};b.ad=function(a,b,c){if(isNaN(b)){for(;3.141592653589793<c[0]-a;)c[0]-=6.283185307179586;for(;3.141592653589793<a-c[0];)c[0]+=6.283185307179586}else 3.141592653589793<c[0]+a-b?c[0]-=6.283185307179586:
3.141592653589793<b-(c[0]+a)&&(c[0]+=6.283185307179586)};b.kX=function(a,b,c,d){3.141592653589793>Math.abs(b.x-a.x)?(d.Lc(a),3.141592653589793<=c.x-a.x?d.Am(c.x-6.283185307179586,c.y):3.141592653589793<=a.x-c.x?d.Am(c.x+6.283185307179586,c.y):d.Am(c.x,c.y)):(d.Lc(c),3.141592653589793<=a.x-c.x?d.Am(a.x-6.283185307179586,a.y):3.141592653589793<=c.x-a.x?d.Am(a.x+6.283185307179586,a.y):d.Am(a.x,a.y))};b.rE=function(a,b){for(var c=0;c<a;c++){var d=Math.ceil(c/2)/(a+1);0!=c%2&&(d=-d);b[c]=.5+d}};b.Fv=function(b,
c){return a.l.W(b.y,1.570796326794897)&&!a.l.W(c.y,1.570796326794897)||a.l.W(b.y,-1.570796326794897)&&!a.l.W(c.y,-1.570796326794897)?!0:!1};b.Dv=function(b,c){return a.l.W(c.y,1.570796326794897)&&!a.l.W(b.y,1.570796326794897)||a.l.W(c.y,-1.570796326794897)&&!a.l.W(b.y,-1.570796326794897)?!0:!1};b.eE=function(c,d,e){return!b.cE(c,d,e)||a.l.W(c.y,1.570796326794897)||a.l.W(c.y,-1.570796326794897)||a.l.W(d.y,1.570796326794897)||a.l.W(d.y,-1.570796326794897)?!1:!0};b.cE=function(a,b,c){return Math.abs(Math.abs(a.x-
b.x)-3.141592653589793)<=c?!0:!1};b.Ev=function(b,c){return a.l.W(b.y,1.570796326794897)&&a.l.W(c.y,1.570796326794897)||a.l.W(b.y,-1.570796326794897)&&a.l.W(c.y,-1.570796326794897)?!0:!1};b.ZC=function(c,d,e,f){if(0<c.y){var h=new a.b;h.ja(d.x,1.570796326794897)}else h=new a.b,h.ja(d.x,-1.570796326794897);a.l.W(c.x,h.x)||a.l.W(d.y,h.y)||(b.tb(f,h),null!=e&&e.add(0))};b.TC=function(c,d,e,f){if(0<d.y){var h=new a.b;h.ja(c.x,1.570796326794897)}else h=new a.b,h.ja(c.x,-1.570796326794897);a.l.W(d.x,h.x)||
a.l.W(c.y,h.y)||(b.tb(f,h),null!=e&&e.add(1))};b.UC=function(c,d,e,f,g,w,k){a.l.wd(e)?(0<1.570796326794897-c.y&&(e=new a.b,e.ja(c.x,1.570796326794897),b.tb(k,e),null!=w&&w.add(f)),0<1.570796326794897-d.y&&(e=new a.b,e.ja(d.x,1.570796326794897),b.tb(k,e),null!=w&&w.add(f))):(0<1.570796326794897+c.y&&(e=new a.b,e.ja(c.x,-1.570796326794897),b.tb(k,e),null!=w&&w.add(g)),0<1.570796326794897+d.y&&(e=new a.b,e.ja(d.x,-1.570796326794897),b.tb(k,e),null!=w&&w.add(g)))};b.KU=function(a){if(-3.141592653589793>
a.x)for(;-3.141592653589793>a.x;)a.x+=6.283185307179586;if(3.141592653589793<a.x)for(;3.141592653589793<a.x;)a.x-=6.283185307179586};return b}();a.Ij=b})(C||(C={}));(function(a){var b=function(){function b(){}b.Rj=function(c,d,e){if(null==c||null==d||!a.fb.Ic(d))throw a.g.F();if(c.u())return c;var f=c,h=f.G();if(a.T.Hc(h)){f=a.gi.Qj(c,d);c=new a.h;f.s(c);for(var h=a.na.$d(d,c,!1),p=a.fb.Ch(d),g=Math.floor((c.o-p.o)/p.O())*p.O()+p.o;g<c.v;)g>c.o+h&&g<c.v-h&&(f=a.gi.jt(f,d,e,!0,g)),g+=p.O()}else{if(197==
h)return c=new a.Ja(f.description),c.hd(f,!1),b.Rj(c,d,e);if(a.T.Nc(h))return c=new a.Ua(f.description),c.cc(f,!0),b.Rj(c,d,e)}return b.CM(f,d)};b.CM=function(c,d){if(null==c||null==d||!a.fb.Ic(d))throw a.g.F();if(c.u())return c;var e;e=c.G();197==e?(e=new a.Ja(c.description),e.hd(c,!1)):a.T.Nc(e)?(e=new a.Ua(c.description),e.cc(c,!0)):e=c;e=a.gi.Qj(e,d);return e.u()?e:1==a.ve.Fb(d)?a.gi.cn(e,d,0,e!=c,0):b.xM(e,d,e!=c)};b.xM=function(b,c,d){if(!a.fb.Ic(c))throw a.g.F();if(b.u())return b;var e=a.fb.ce(c),
f=0-180*e,e=360*e;2==a.ve.Fb(c)&&(f=a.fb.Ch(c),e=f.v,f=f.o,e-=f);return a.gi.Aq(b,f,e,c,d,0,!0)};return b}();a.bq=b})(C||(C={}));(function(a){var b=function(){function b(){}b.NN=function(a,b){var c=Math.abs(a%b);return isNaN(c)||c==a||c<=Math.abs(b)/2?c:0>a?-1*(c-b):0<a?1*(c-b):0*(c-b)};b.K=function(a){return 0>a?-a:a};b.Bb=function(a,c){return 0<=c?b.K(a):-b.K(a)};b.W=function(a,c){return a==c||b.K(a-c)<=b.cD*(1+(b.K(a)+b.K(c))/2)};b.wd=function(a){return 0==a||b.K(a)<=b.cD};b.Xu=function(a){a=b.NN(a,
b.Wy);return b.K(a)<=b.Xf?a:0>a?a+b.Wy:a-b.Wy};b.HA=function(a,c){a.j=b.Xu(a.j);c.j=b.Xu(c.j);b.K(c.j)>b.ro&&(a.j=b.Xu(a.j+b.Xf),c.j=b.Bb(b.Xf,c.j)-c.j)};b.Wg=function(a,c){c=Math.sqrt(1-c);c=(1-c)/(1+c);var d=c*c;return a/(1+c)*(1+d*(.25+d*(.015625+1/256*d)))*b.ro};b.sS=function(c,d,e,f,g){var h,p,n,y,D,w,k,l=0,m=w=0,q=0,r=0,t=0;D=0;var u,I,v;k=0;var x,z,B;v=new a.da;h=new a.da;if(null!=g)if(v.j=c,h.j=d,b.HA(v,h),c=v.j,d=h.j,v.j=e,h.j=f,b.HA(v,h),e=v.j,f=h.j,e=b.Xu(e-c),b.W(d,f)&&(b.wd(e)||b.W(b.K(d),
b.ro)))null!=g&&(g.j=0);else{if(b.W(d,-f)){if(b.W(b.K(d),b.ro)){null!=g&&(g.j=2*b.Wg(6378137,.0066943799901413165));return}if(b.W(b.K(e),b.Xf)){null!=g&&(g.j=2*b.Wg(6378137,.0066943799901413165));return}}if(b.wd(.0066943799901413165))r=Math.cos(d),t=Math.cos(f),null!=g&&(l=Math.sin((f-d)/2),w=Math.sin(e/2),k=2*Math.asin(Math.sqrt(l*l+r*t*w*w)),g.j=6378137*k);else{v=1-Math.sqrt(.9933056200098587);c=1-v;h=Math.atan(c*Math.tan(d));d=Math.sin(h);h=Math.cos(h);p=Math.atan(c*Math.tan(f));f=Math.sin(p);
p=Math.cos(p);y=n=e;z=0;B=1;x=e;for(I=!0;1==I;)z+=1,1==B&&(D=Math.sin(x),w=Math.cos(x),l=p*D,k=h*f-d*p*w,l=Math.sqrt(l*l+k*k),w=d*f+h*p*w,k=Math.atan2(l,w),m=1E-15>b.K(l)?h*p*D/b.Bb(1E-15,l):h*p*D/l,q=1-m*m,r=1E-15>b.K(q)?w-d*f/b.Bb(1E-15,q)*2:w-d*f/q*2,t=r*r,D=((-3*q+4)*v+4)*q*v/16),u=(1-D)*v*(k+D*l*(r+w*D*(2*t-1))),1==B?(x=e+u*m,1E-14>b.K(x-y)?I=!1:b.K(x)>b.Xf?(B=2,x=b.Xf,0>e&&(x=-x),m=0,q=1,n=y=2,k=b.Xf-b.K(Math.atan(d/h)+Math.atan(f/p)),l=Math.sin(k),w=Math.cos(k),D=((-3*q+4)*v+4)*q*v/16,1E-14>
b.K(m-n)?I=!1:(r=1E-15>b.K(q)?w-d*f/b.Bb(1E-15,q)*2:w-d*f/q*2,t=r*r)):(0>(x-y)*(y-n)&&5<z&&(x=(2*x+3*y+n)/6),n=y,y=x)):(m=(x-e)/u,0>(m-y)*(y-n)&&5<z&&(m=(2*m+3*y+n)/6),n=y,y=m,q=1-m*m,D=m*l/(h*p),w=-Math.sqrt(b.K(1-D*D)),x=Math.atan2(D,w),l=p*D,k=h*f-d*p*w,l=Math.sqrt(l*l+k*k),w=d*f+h*p*w,k=Math.atan2(l,w),D=((-3*q+4)*v+4)*q*v/16,1E-14>b.K(m-n)?I=!1:(r=1E-15>b.K(q)?w-d*f/b.Bb(1E-15,q)*2:w-d*f/q*2,t=r*r));null!=g&&(m=Math.sqrt(1+(1/(c*c)-1)*q),m=(m-1)/(m+1),q=m*(1-.375*m*m),g.j=(1+m*m/4)/(1-m)*c*6378137*
(k-q*l*(r+q/4*(w*(-1+2*t)-q/6*r*(-3+4*l*l)*(-3+4*t)))))}}};b.Xf=3.141592653589793;b.ro=1.5707963267948966;b.Wy=6.283185307179586;b.cD=3.552713678800501E-15;return b}();a.$L=b})(C||(C={}));(function(a){var b=function(){return function(a){this.re=a;this.nl=this.re.getCode();0>this.nl&&(this.nl=0)}}();a.uZ=b;var c=function(){function c(a){void 0===a&&(a=null);this.Lh=null;this.tn=!1;null!==a&&(this.Lh=new b(a))}c.prototype.Bc=function(){return null!=this.Lh?this.Lh.nl:0};c.prototype.Sf=function(){var a=
new c;this.copyTo(a);return a};c.prototype.copyTo=function(a){a.Lh=this.Lh;a.tn=this.tn};c.prototype.Wv=function(){var a=this.Sf();a.mt();return a};c.prototype.mt=function(){this.tn=!this.tn};c.prototype.jn=function(){return null!=this.Lh?this.Lh.re:null};c.prototype.pK=function(c){if(0>=c)throw a.g.F();if(c!=this.Bc()){c=a.Qf.geogtran(c);if(null==c)throw a.g.F("Geogtran not found.");this.Lh=new b(c)}};c.prototype.dH=function(){return null==this.Lh?null:this.Lh.re.toString()};c.prototype.getName=
function(){if(null==this.Lh||null==this.Lh.re)return"";var a="";this.tn&&(a+="~");return a+=this.Lh.re.getName()};c.prototype.TX=function(c){if(null==c)throw a.g.F();var d=null;try{d=a.Qf.fromString(a.Uc.PE_TYPE_GEOGTRAN,c)}catch(y){throw a.g.F();}this.Lh=new b(d)};c.prototype.Eb=function(a){return a==this?!0:a instanceof c&&(!(0>=this.Bc()||this.Bc()!=a.Bc())||this.jn().isEqual(a.jn()))?this.tn==a.tn:!1};c.prototype.toString=function(){var a=toString();return 200<a.length?a.substring(0,197)+"... ("+
a.length.toString()+" characters)":a};c.create=function(a,b){var d=new c;d.pK(a);b&&d.mt();return d};c.eG=function(a,b){var d=new c;d.TX(a);b&&d.mt();return d};return c}();a.oo=c})(C||(C={}));(function(a){var b=function(){function a(){}a.pa=function(b,c,d,e){var f=new a;f.Bn=b;f.Cn=c;f.zI=d;f.AI=e;return f};a.Fs=function(a,b){return a.Bn==b.Bn?a.Cn==b.Cn?0:a.Cn<b.Cn?-1:1:a.Bn<b.Bn?-1:1};return a}(),c=function(){function c(){this.Hw=!1;this.BI=[];this.cB=[];this.XH=this.Hw=this.WH=!1;this.kq()}c.Go=
function(){null==c.wE&&(c.wE=new c);return c.wE};c.b_=function(){return c.Go().Hw};c.c_=function(){return c.Go().XH};c.eZ=function(a,b){if(a==b)return null;var d=c.Go();if(d.WH){var e=c.Bz(d.cB,a,b);return null!=e?e:null}e=c.Bz(d.cB,a,b);return null!=e?e:c.Bz(d.BI,a,b)};c.XY=function(b,c,d,e,f){var h=a.ky.create();if(0<b)try{var p=a.oo.create(b,c);if(0==p.Bc())return null;h.add(p);if(0<d){var g=a.oo.create(d,e);if(0==g.Bc())return null;h.add(g)}f&&(h=h.Wv())}catch(ka){h=null}return h};c.Bz=function(a,
d,e){if(d==e||0==a.length)return null;for(var f=b.pa(d,e,0,0),h=!1,p=!1,g=0,n=0,y=-1,w=0;w<a.length;w++)if(0===b.Fs(f,a[w])){y=w;break}if(0>y||a[y].Bn!=f.Bn||a[y].Cn!=f.Cn){f=b.pa(e,d,0,0);d=-1;for(w=0;w<a.length;w++)if(0===b.Fs(f,a[w])){d=w;break}0<=d&&a[d].Bn==f.Bn&&a[d].Cn==f.Cn&&(g=a[d].zI,n=a[d].AI,p=h=!0)}else g=a[y].zI,n=a[y].AI,h=!1,p=!0;if(!p)return null;0==g&&(g=n,n=0);f=a=!1;0>g&&(g=-g,a=!0);0>n&&(n=-n,f=!0);return c.XY(g,a,n,f,h)};c.prototype.kq=function(){this.FE(this.BI)&&(this.Hw=!0);
this.FE(this.cB)&&(this.XH=!0);this.WH=!this.Hw};c.prototype.FE=function(a){try{for(var c=[],c=c.sort(b.Fs),d=0;d<c.length;d++)a.push(c[d])}catch(D){}return!0};c.yZ=function(){return null};return c}();a.tZ=c})(C||(C={}));(function(a){var b=function(){function a(){}a.prototype.Iy=function(a){this.Ii=a};a.prototype.QE=function(a){this.Mb=a};a.prototype.RE=function(a){this.tp=a};a.KF=function(a){return a.u()||1607!=a.G()&&1736!=a.G()?!1:!0};a.IF=function(a){return a.u()||1607!=a.G()&&1736!=a.G()||20>
a.D()?!1:!0};a.JF=function(a){return a.u()||1607!=a.G()&&1736!=a.G()||20>a.D()?!1:!0};return a}();a.yl=b})(C||(C={}));(function(a){var b=function(){function b(){}b.EN=function(b){var c=new a.Ja;c.$x(b.dt(),b.ft());c.ak(b.dt(),b.et());c.ak(b.ct(),b.et());c.ak(b.ct(),b.ft());return c};b.Vg=function(b,c){return null===b?null:a.ns.local().V(b,c,null)};b.LY=function(b,c){var d=a.ei.local();b=new a.gd(b);return d.V(b,c,null).next()};b.an=function(b,c,d){return a.eq.local().V(b,c,d,null)};b.Wp=function(b,
c,d){return a.qy.local().V(b,c,d,null)};b.sY=function(b,c,d){var e=a.qy.local();b=new a.gd(b);c=new a.gd(c);d=e.V(b,c,d,null);for(e=[];null!=(c=d.next());)e.push(c);return e};b.Eb=function(b,c,d){return a.Jj.local().V(3,b,c,d,null)};b.mR=function(b,c,d){return a.Jj.local().V(4,b,c,d,null)};b.nU=function(b,c,d){var e=a.wk.local();b=new a.gd(b);c=new a.gd(c);d=e.V(b,c,d,null);for(e=[];null!=(c=d.next());)e.push(c);return e};b.jR=function(b,c,d){var e=a.eq.local();b=new a.gd(b);c=new a.gd(c);d=e.V(b,
c,d,null);for(e=[];null!=(c=d.next());)e.push(c);return e};b.Ma=function(b,c,d){return a.wk.local().V(b,c,d,null)};b.WY=function(b,c,d){return a.Jj.local().V(2,b,c,d,null)};b.contains=function(b,c,d){return a.Jj.local().V(1,b,c,d,null)};b.VQ=function(b,c,d){return a.Jj.local().V(16,b,c,d,null)};b.touches=function(b,c,d){return a.Jj.local().V(8,b,c,d,null)};b.TV=function(b,c,d){return a.Jj.local().V(32,b,c,d,null)};b.pU=function(b,c,d){return a.Jj.local().V(1073741824,b,c,d,null)};b.aC=function(b,
c,d,e){return a.TM.local().V(b,c,d,e,null)};b.Cb=function(b,c,d,e){var f=null;if(null!=d){if(f=d.Td(),null!=e&&f.Bc()!=e.Bc()&&f.sd!=e.sd)throw a.g.Dl();}else if(null!=e)throw a.g.F();b=a.LM.local().V(b,c,null);null!==f&&null!==e&&(b=a.$c.mi(b,f,e));return b};b.clip=function(b,c,d){return a.FM.local().V(b,a.h.pa(c.dt(),c.ft(),c.ct(),c.et()),d,null)};b.Ml=function(b,c,d){if(null==b||null==c)return null;b=a.HM.local().V(!0,b,c,d,null);for(c=[];null!=(d=b.next());)d.u()||c.push(d);return c.slice(0)};
b.mP=function(c,d,e,f,g,w,k,l){if(!0===g)return b.QW(c,d,e,f,w,k,l);g=e;if(null!=d){if(k=d.Td(),null!=f&&k.Bc()!=f.Bc()){if(k.sd!=f.sd)throw a.g.Dl();g=[];a.$c.cG(e,e.length,f,k,g)}}else if(null!=f)throw a.g.F();e=a.JD.local();if(w){c=new a.gd(c);d=e.V(c,d,g,w,null);for(c=[];null!=(w=d.next());)c.push(w);w=c.slice(0)}else for(w=[],f=0;f<c.length;f++)w[f]=e.V(c[f],d,g[f],null);return w};b.QW=function(b,c,d,e,f,g,w){if(null===c)throw a.g.F();if(null===e||void 0===e)e=4326!==c.Bc()?c.Td():a.$c.vh(9001);
if(0!==e.sd)throw a.g.F();a.$c.cG(d,d.length,e,a.$c.vh(9001),d);e=a.OD.local();if(f){b=new a.gd(b);c=e.V(b,c,g,d,w,!1,f,null);for(d=[];null!=(g=c.next());)d.push(g);f=d.slice(0)}else{f=[];for(var h=0;h<b.length;h++)f[h]=e.V(b[h],c,g,d[h],w,!1,null)}return f};b.buffer=function(b,c,d,e,f,g,w){var h=d;if(!1===f){if(null!=c){if(f=c.Td(),null!=e&&f.Bc()!=e.Bc()){if(f.sd!=e.sd)throw a.g.Dl();h=a.$c.mi(d,e,f)}}else if(null!=e)throw a.g.F();b=a.JD.local().V(b,c,h,null)}else{if(null===c)throw a.g.F();if(null===
e||void 0===e)e=4326!==c.Bc()?c.Td():a.$c.vh(9001);if(0!==e.sd)throw a.g.F();h=a.$c.mi(d,e,a.$c.vh(9001));b=a.OD.local().V(b,c,g,h,w,!1,null)}return b};b.RV=function(b,c,d,e,f,g,w){if(null!=c){var h=c.Td();if(null!=w&&h.Bc()!=w.Bc()){if(h.sd!=w.sd)throw a.g.Dl();d=a.$c.mi(d,w,h)}}else if(null!=w)throw a.g.F();b=new a.gd(b);c=a.RD.local().V(b,c,d,e,f,g,null);for(d=[];null!=(e=c.next());)d.push(e);return d.slice(0)};b.offset=function(b,c,d,e,f,g,w){if(null!=c){var h=c.Td();if(null!=w&&h.Bc()!=w.Bc()){if(h.sd!=
w.sd)throw a.g.Dl();d=a.$c.mi(d,w,h)}}else if(null!=w)throw a.g.F();return a.RD.local().V(b,c,d,e,f,g,null)};b.FQ=function(b){return a.LD.local().V(b,null)};b.GQ=function(b,c){var d=a.LD.local();b=new a.gd(b);d=d.V(b,c,null);for(b=[];null!=(c=d.next());)b.push(c);return b};b.bA=function(b,c,d){return a.oy.local().bA(b,c,d)};b.cA=function(b,c){return a.oy.local().cA(b,c)};b.dA=function(b,c,d,e){return a.oy.local().dA(b,c,d,e)};b.FC=function(b,c){return a.Qm.local().V(b,c,!1,null)};b.AU=function(b,
c){return a.Qm.local().Wq(b,c,null)};b.gS=function(b,c,d,e,f){var h=a.ND.local();if(null!=c){if(c=c.Td(),null!=f&&c.Bc()!=f.Bc()){if(c.sd!=f.sd)throw a.g.Dl();d=a.$c.mi(d,f,c)}}else if(null!=f)throw a.g.F();return h.V(b,d,e,null)};b.Js=function(b,c,d,e){var f=a.Pm.local();if(null!=c){if(c=c.Td(),null!=e&&c.Bc()!=e.Bc()){if(c.sd!=e.sd)throw a.g.Dl();d=a.$c.mi(d,e,c)}}else if(null!=e)throw a.g.F();return f.V(b,d,null)};b.Hz=function(b,c,d,e,f){void 0===f&&(f=0);var h=a.NM.local();if(4==f)throw a.g.af();
if(0!==f)throw a.g.af();if(null!==e){if(0!==e.sd)throw a.g.F("Unit must be a linear unit type");d=a.$c.mi(d,e,a.$c.vh(9001))}return h.V(b,d,c,f,null)};b.mS=function(c,d,e,f){if(null===c)return 0;if(4==f)throw a.g.af();if(0!==f)throw a.g.af();if(197==c.G())c=b.EN(c);else if(1736!=c.G())return 0;f=a.fb.lc(d);c=a.fb.Vg(c,d,f,null);c=a.aM.nS([c])[0];if(null!==e){if(2!==e.sd)throw a.g.F("Unit must be a area unit type");c=a.$c.mi(c,a.$c.vh(109404),e)}return c};b.qS=function(b,c,d,e){b=a.PM.local().V(b,
c,e,null);if(null!==d){if(0!==d.sd)throw a.g.F("Unit must be a linear unit type");b=a.$c.mi(b,a.$c.vh(9001),d)}return b};b.aW=function(b,c,d){if(null===b)return 0;var e=null;if(null!=c){e=c.Td();if(0==e.sd&&(e=a.$c.cH(e),null==e&&null!==d))throw a.g.F();if(null!=d&&e.Bc()!=d.Bc()&&e.sd!=d.sd)throw a.g.Dl();}else if(null!=d)throw a.g.F();return 1736==b.G()||197==b.G()?(b=b.ef(),null!==d?a.$c.mi(b,e,d):b):0};b.bW=function(b,c,d){if(null===b||b.u()||1>b.ub())return 0;var e=null;if(null!=c){if(e=c.Td(),
null!=d&&e.Bc()!=d.Bc()&&e.sd!=d.sd)throw a.g.Dl();}else if(null!=d)throw a.g.F();1736==b.G()||197==b.G()?c=b.Fg():a.T.Nc(b.G())?(c=new a.Ua(b.description),c.cc(b,!0)):c=b;b=0;c=c.Fa();for(var f=new a.b,h=new a.b;c.Ya();)for(;c.Ea();){var p=c.ba();p.Oq(f);p.Ns(h);b+=a.b.Cb(f,h)}null!==e&&null!==d&&(b=a.$c.mi(b,e,d));return b};b.ZZ=function(b,c){return a.ve.pS(b,c)};b.EQ=function(a){return void 0!==a.points?b.pN(a,void 0===a.hasZ?!1:a.hasZ,void 0===a.hasM?!1:a.hasM):void 0!==a.rings?b.yE(a.rings,void 0===
a.hasZ?!1:a.hasZ,void 0===a.hasM?!1:a.hasM,"P"):void 0!==a.paths?b.yE(a.paths,void 0===a.hasZ?!1:a.hasZ,void 0===a.hasM?!1:a.hasM,"L"):void 0!==a.x?b.uN(a):void 0!==a.xmin?b.nN(a):null};b.uN=function(b){if(null==b.x||"NaN"==b.x)return new a.Wa;var c=new a.Wa(b.x,b.y);void 0!==b.z&&null!==b.z&&c.WX(b.z);void 0!==b.m&&null!==b.m&&c.GX(b.m);return c};b.nN=function(b){if(null==b.xmin||"NaN"==b.xmin)return new a.di;var c=new a.di(b.xmin,b.ymin,b.xmax,b.ymax);void 0!==b.zmin&&null!==b.zmin&&c.setInterval(1,
0,b.zmin,b.zmax);void 0!==b.mmin&&null!==b.mmin&&c.setInterval(2,0,b.mmin,b.mmax);return c};b.pN=function(b,c,d){var e=0,f=new a.Dd,h=3*b.points.length;0!=h%2&&h++;2>h&&(h=2);var p=a.J.truncate(3*b.points.length/2);4>p?p=4:16>p&&(p=16);for(var h=a.Tc.$m(h,0),g=a.Tc.$m(p),p=a.Tc.$m(p),n=0;n<b.points.length;n++)h.write(2*n,b.points[n][0]),h.write(2*n+1,b.points[n][1]),g.write(n,c||d?b.points[n][2]:NaN),p.write(n,d&&c?b.points[n][3]:NaN),e++;0!=e&&(f.resize(e),f.eo(0,h));c&&(f.Rd(1),f.eo(1,g));d&&(f.Rd(2),
f.eo(2,0==c?g:p));f.Cc(16777215);return f};b.yE=function(b,c,d,e){var f,h=0,p=2;"P"==e?(f=new a.Ja,h=1,p=3):f=new a.Ua;for(var g=a.Tc.wh(0),n=a.Tc.vq(0),y=0,w=0,k=[],l=[],m=0;m<b.length;m++){var q=b[m].length;k[m]=!1;if("P"===e&&b[m][0][0]===b[m][b[m].length-1][0]&&b[m][0][1]===b[m][b[m].length-1][1]){var r=0==d?!0:b[m][0][3]===b[m][b[m].length-1][3]||void 0===b[m][0][3]&&void 0===b[m][b[m].length-1][3];(0==c||b[m][0][2]===b[m][b[m].length-1][2]||void 0===b[m][0][2]&&void 0===b[m][b[m].length-1][2])&&
r&&(k[m]=!0,--q)}q>=p?(l[m]=!1,w+=1,g.add(y),n.add(h),y+=q):l[m]=!0}e=3*y;0!=e%2&&e++;2>e&&(e=2);m=a.J.truncate(3*y/2);4>m?m=4:16>m&&(m=16);e=a.Tc.$m(e,0);h=a.Tc.$m(m);p=a.Tc.$m(m);for(m=q=0;m<b.length;m++)if(!1===l[m])for(r=0;r<b[m].length;r++){var t=!1;r===b[m].length-1&&!0===k[m]&&(t=!0);t||(e.write(2*q,b[m][r][0]),e.write(2*q+1,b[m][r][1]),h.write(q,c||d?b[m][r][2]:NaN),p.write(q,d&&c?b[m][r][3]:NaN),q++)}0!=y&&(b=f,g.resize(w),n.resize(w),0<y&&(g.add(y),n.add(0)),b.eo(0,e),b.uK(n),b.vK(g));c&&
(f.Rd(1),f.eo(1,h));d&&(f.Rd(2),f.eo(2,0==c?h:p));f.Cc(16777215);return f};return b}();a.gc=b})(C||(C={}));(function(a){var b=function(){function a(){}a.Gj=function(a){var b=0,c,d=a.length,e=a[0],f;for(c=0;c<d-1;c++)f=a[c+1],b+=(f[0]-e[0])*(f[1]+e[1]),e=f;return 0<=b};a.rotate=function(b,c,d){c=c*Math.PI/180;var e=Math.cos(c),f=Math.sin(c);if(void 0!==b.paths){c={paths:[]};for(var h=0;h<b.paths.length;h++){for(var p=b.paths[h],g=[],n=0;n<p.length;n++){var w=p[n].slice(0);g.push(w);var k=e*(p[n][0]-
d.x)-f*(p[n][1]-d.y)+d.x,l=f*(p[n][0]-d.x)+e*(p[n][1]-d.y)+d.y;w[0]=k;w[1]=l}c.paths.push(g)}return c}if(void 0!==b.rings){c={rings:[]};for(h=0;h<b.rings.length;h++){for(var p=b.rings[h],g=[],m=a.Gj(p),n=0;n<p.length;n++)w=p[n].slice(0),g.push(w),k=e*(p[n][0]-d.x)-f*(p[n][1]-d.y)+d.x,l=f*(p[n][0]-d.x)+e*(p[n][1]-d.y)+d.y,w[0]=k,w[1]=l;a.Gj(g)!==m&&g.reverse();c.rings.push(g)}return c}if(void 0!==b.x)return c={x:e*(b.x-d.x)-f*(b.y-d.y)+d.x,y:f*(b.x-d.x)+e*(b.y-d.y)+d.y},void 0!==b.z&&(c.z=b.z),void 0!==
b.m&&(c.m=b.m),c;if(void 0!==b.points){c={points:[]};b=b.points;for(n=0;n<b.length;n++)h=b[n].slice(0),h[0]=e*(b[n][0]-d.x)-f*(b[n][1]-d.y)+d.x,h[1]=f*(b[n][0]-d.x)+e*(b[n][1]-d.y)+d.y,c.points.push(h);return c}return null};a.YR=function(b,c){var d,e;if(void 0!==b.paths){d={paths:[]};for(var f=0;f<b.paths.length;f++){for(var h=b.paths[f],g=[],n=0;n<h.length;n++){var w=h[n].slice(0);g.push(w);e=c.x-h[n][0];w[0]=h[n][0]+2*e}d.paths.push(g)}return d}if(void 0!==b.rings){d={rings:[]};for(f=0;f<b.rings.length;f++){for(var h=
b.rings[f],k=a.Gj(h),g=[],n=0;n<h.length;n++)w=h[n].slice(0),g.push(w),e=c.x-h[n][0],w[0]=h[n][0]+2*e;a.Gj(g)!==k&&g.reverse();d.rings.push(g)}return d}if(void 0!==b.x)return e=c.x-b.x,d={x:b.x+2*e,y:b.y},void 0!==b.z&&(d.z=b.z),void 0!==b.m&&(d.m=b.m),d;if(void 0!==b.points){d={points:[]};f=b.points;for(n=0;n<f.length;n++)h=f[n].slice(0),e=c.x-h[0],h[0]+=2*e,d.points.push(h);return d}return void 0!==b.xmin?(d={o:b.xmin,A:b.ymin,v:b.xmax,B:b.ymax},void 0!==b.zmin&&(d.zmin=b.zmin,d.zmax=b.zmax),void 0!==
b.mmin&&(d.mmin=b.mmin,d.mmax=b.mmax),e=c.x-b.xmin,d.xmax=b.xmin+2*e,e=c.x-b.xmax,d.xmin=b.xmax+2*e,d):null};a.ZR=function(b,c){var d,e;if(void 0!==b.paths){d={paths:[]};for(var f=0;f<b.paths.length;f++){for(var h=b.paths[f],g=[],n=0;n<h.length;n++){var w=h[n].slice(0);g.push(w);e=c.y-h[n][1];w[1]=h[n][1]+2*e}d.paths.push(g)}return d}if(void 0!==b.rings){d={rings:[]};for(f=0;f<b.rings.length;f++){for(var h=b.rings[f],k=a.Gj(h),g=[],n=0;n<h.length;n++)w=h[n].slice(0),g.push(w),e=c.y-h[n][1],w[1]=h[n][1]+
2*e;a.Gj(g)!==k&&g.reverse();d.rings.push(g)}return d}if(void 0!==b.x)return e=c.y-b.y,d={y:b.y+2*e,x:b.x},void 0!==b.z&&(d.z=b.z),void 0!==b.m&&(d.m=b.m),d;if(void 0!==b.points){d={points:[]};f=b.points;for(n=0;n<f.length;n++)h=f[n].slice(0),e=c.y-h[1],h[1]+=2*e,d.points.push(h);return d}return void 0!==b.xmin?(d={o:b.xmin,A:b.ymin,v:b.xmax,B:b.ymax},void 0!==b.zmin&&(d.zmin=b.zmin,d.zmax=b.zmax),void 0!==b.mmin&&(d.mmin=b.mmin,d.mmax=b.mmax),e=c.y-b.ymin,d.ymax=b.ymin+2*e,e=c.y-b.ymax,d.ymin=b.ymax+
2*e,d):null};return a}();a.my=b})(C||(C={}));(function(a){var b=function(){function b(){}b.ah=function(b,c){null==c&&(c=a.we.Hg());switch(b){case 33:return new a.Wa(c);case 322:return new a.Hb(c);case 197:return new a.di(c);case 550:return new a.Dd(c);case 1607:return new a.Ua(c);case 1736:return new a.Ja(c);default:throw a.g.X("invalid argument.");}};return b}();a.fM=b})(C||(C={}));(function(a){var b=function(){function b(b,c){this.qf=a.ha.yd(b,-1);this.va=new a.Nu;this.gm=c}b.prototype.bX=function(a){this.va.ru(Math.min(this.qf.size,
a));this.va.ao(a)};b.prototype.addElement=function(b,c){if(void 0===c)return this.AO(b);c=a.J.truncate(c%this.qf.size);var d=this.qf.get(c);-1==d&&(d=this.va.ni(),this.qf.set(c,d));return this.va.addElement(d,b)};b.prototype.AO=function(b){var c=this.gm.Yz(b),c=a.J.truncate(c%this.qf.size),d=this.qf.get(c);-1==d&&(d=this.va.ni(),this.qf.set(c,d));return this.va.addElement(d,b)};b.prototype.jd=function(b,c){if(void 0===c)this.dR(b);else{c=a.J.truncate(c%this.qf.size);var d=this.qf.get(c);if(-1==d)throw a.g.F();
for(var e=this.va.wc(d),f=-1;-1!=e;){var h=this.va.nb(e);this.va.ia(e)==b?(this.va.jd(d,f,e),-1==this.va.wc(d)&&(this.va.zh(d),this.qf.set(c,-1))):f=e;e=h}}};b.prototype.dR=function(b){var c=this.gm.Yz(b),c=a.J.truncate(c%this.qf.size),d=this.qf.get(c);if(-1==d)throw a.g.F();for(var e=this.va.wc(d),f=-1;-1!=e;){var g=this.va.nb(e);this.va.ia(e)==b?(this.va.jd(d,f,e),-1==this.va.wc(d)&&(this.va.zh(d),this.qf.set(c,-1))):f=e;e=g}};b.prototype.IS=function(b){b=a.J.truncate(b%this.qf.size);b=this.qf.get(b);
return-1==b?-1:this.va.wc(b)};b.prototype.YS=function(a){return this.va.nb(a)};b.prototype.Jd=function(b){var c=this.gm.Yz(this.ia(b)),c=a.J.truncate(c%this.qf.size),d=this.qf.get(c);if(-1==d)throw a.g.F();for(var e=this.va.wc(d),f=-1;-1!=e;){if(e==b){this.va.jd(d,f,e);-1==this.va.wc(d)&&(this.va.zh(d),this.qf.set(c,-1));return}f=e;e=this.va.nb(e)}throw a.g.F();};b.prototype.ia=function(a){return this.va.ia(a)};b.prototype.clear=function(){this.qf=a.ha.yd(this.qf.size,-1);this.va.clear()};b.prototype.size=
function(){return this.va.WG()};return b}();a.nM=b})(C||(C={}));(function(a){var b=function(){function b(){this.lj=new a.Zc(3);this.va=new a.Zc(6);this.WU=!1;this.De=-1}b.prototype.Pl=function(a){this.lj.jd(a)};b.prototype.Bx=function(){return this.lj.Me()};b.prototype.Qv=function(a){this.va.jd(a)};b.prototype.IB=function(){return this.va.Me()};b.prototype.xC=function(a,b){this.lj.R(a,1,b)};b.prototype.Qx=function(a,b){this.lj.R(a,2,b)};b.prototype.FX=function(a,b){this.lj.R(a,3,b)};b.prototype.vC=
function(a,b){this.va.R(a,4,b)};b.prototype.IX=function(a,b){this.va.R(a,3,b)};b.prototype.yK=function(a,b){this.va.R(a,2,b)};b.prototype.ni=function(a){var b=this.IB();this.va.R(b,3,this.De);this.va.R(b,4,0);this.va.R(b,5,a);-1!=this.De&&this.yK(this.De,b);return this.De=b};b.prototype.zh=function(a){this.QF(a);var b=this.va.S(a,2),c=this.va.S(a,3);-1!=b?this.IX(b,c):this.De=c;-1!=c&&this.yK(c,b);this.Qv(a);return c};b.prototype.ru=function(a){this.va.Ne(a)};b.prototype.SG=function(a){return this.va.S(a,
5)};b.prototype.EX=function(a,b){this.va.R(a,5,b)};b.prototype.addElement=function(a,b){return this.RT(a,b)};b.prototype.RT=function(a,b){var c=this.Bx();this.Qx(c,-1);-1==this.va.S(a,0)&&this.va.R(a,0,c);var d=this.va.S(a,1);this.xC(c,d);-1!=d&&this.Qx(d,c);this.va.R(a,1,c);this.setData(c,b);this.vC(a,this.Zs(a)+1);this.WU&&this.FX(c,a);return c};b.prototype.jd=function(a,b){var c=this.Se(b),d=this.nb(b);-1!=c?this.Qx(c,d):this.va.R(a,0,d);-1!=d?this.xC(d,c):this.va.R(a,1,c);this.Pl(b);this.vC(a,
this.Zs(a)-1);return d};b.prototype.ao=function(a){this.lj.Ne(a)};b.prototype.getData=function(a){return this.lj.S(a,0)};b.prototype.setData=function(a,b){this.lj.R(a,0,b)};b.prototype.nb=function(a){return this.lj.S(a,2)};b.prototype.Se=function(a){return this.lj.S(a,1)};b.prototype.wc=function(a){return this.va.S(a,0)};b.prototype.Ec=function(a){return this.va.S(a,1)};b.prototype.clear=function(){for(var a=this.De;-1!=a;)a=this.zh(a)};b.prototype.QF=function(a){for(var b=this.Ec(a);-1!=b;){var c=
b,b=this.Se(c);this.Pl(c)}this.va.R(a,0,-1);this.va.R(a,1,-1);this.vC(a,0)};b.prototype.u=function(){return 0==this.lj.size};b.prototype.WG=function(){return this.lj.size};b.prototype.Zs=function(a){return this.va.S(a,4)};b.prototype.eA=function(a){return this.va.S(a,3)};return b}();a.cq=b})(C||(C={}));(function(a){var b=function(){function b(b){void 0===b?(this.Og=new a.Zc(2),this.va=new a.Zc(4),this.De=-1,this.Cw=!0):(this.Og=new a.Zc(2),this.va=new a.Zc(b?4:2),this.De=-1,this.Cw=b)}b.prototype.Pl=
function(a){this.Og.jd(a)};b.prototype.Bx=function(){return this.Og.Me()};b.prototype.Qv=function(a){this.va.jd(a)};b.prototype.IB=function(){return this.va.Me()};b.prototype.ni=function(){var a=this.IB();this.Cw&&(this.va.R(a,3,this.De),-1!=this.De&&this.va.R(this.De,2,a),this.De=a);return a};b.prototype.zh=function(a){for(var b=this.wc(a);-1!=b;){var c=b,b=this.nb(b);this.Pl(c)}this.Cw&&(b=this.va.S(a,2),c=this.va.S(a,3),-1!=b?this.va.R(b,3,c):this.De=c,-1!=c&&this.va.R(c,2,b));this.Qv(a)};b.prototype.ru=
function(a){this.va.Ne(a)};b.prototype.addElement=function(a,b){var c=this.va.S(a,1),d=this.Bx();-1!=c?this.Og.R(c,1,d):this.va.R(a,0,d);this.va.R(a,1,d);this.Og.R(d,0,b);return d};b.prototype.ao=function(a){this.Og.Ne(a)};b.prototype.jd=function(a,b,c){-1!=b?(this.Og.R(b,1,this.Og.S(c,1)),this.va.S(a,1)==c&&this.va.R(a,1,b)):(this.va.R(a,0,this.Og.S(c,1)),this.va.S(a,1)==c&&this.va.R(a,1,-1));this.Pl(c)};b.prototype.kz=function(a,b){var c=this.va.S(a,1),d=this.va.S(b,0);-1!=d&&(-1!=c?this.Og.R(c,
1,d):this.va.R(a,0,d),this.va.R(a,1,this.va.S(b,1)));this.Cw&&(c=this.va.S(b,2),d=this.va.S(b,3),-1!=c?this.va.R(c,3,d):this.De=d,-1!=d&&this.va.R(d,2,c));this.Qv(b)};b.prototype.ia=function(a){return this.Og.S(a,0)};b.prototype.pk=function(a,b){this.Og.R(a,0,b)};b.prototype.nb=function(a){return this.Og.S(a,1)};b.prototype.wc=function(a){return this.va.S(a,0)};b.prototype.Fo=function(a){return this.ia(this.wc(a))};b.prototype.clear=function(){this.Og.Wi(!0);this.va.Wi(!0);this.De=-1};b.prototype.u=
function(a){return void 0===a?0==this.Og.size:-1==this.va.S(a,0)};b.prototype.WG=function(){return this.Og.size};b.prototype.eA=function(a){return this.va.S(a,3)};return b}();a.Nu=b})(C||(C={}));(function(a){var b=function(){function b(){}b.wD=function(c,d,e,f,g,w,k){var h=new a.b;h.L(c);c=new a.b;c.L(d);g.Ky(h);g.Ky(c);d=g.av(h);var p=g.av(c);0==p&&(p=g.RG());if(h.x!=c.x&&(h.y!=c.y||h.y!=g.A&&h.y!=g.B)||p>d!=w){d=g.DE(h);var p=g.DE(c),n,y=w?1:3;do d=d+y&3,n=g.Gx(d),0!=k&&(f=b.wD(h,n,e,f,g,w,k)),
e[f++].ja(n.x,n.y),h=n;while((d&3)!=p);0!=k&&(f=b.wD(h,c,e,f,g,w,k))}else if(g=new a.b,g.ja(c.x-h.x,c.y-h.y),0!=k&&(k=a.J.truncate(g.nO()/k),0<k))for(g.scale(1/(k+1)),w=0;w<k;w++)h.add(g),e[f++].ja(h.x,h.y);return f};b.$d=function(a,b,c){b=b.uo();a=null!=a&&void 0!==a.pe?a.pe(0):0;c&&(b*=4,a*=1.1);return Math.max(a,b)};b.As=function(a){return 2*Math.sqrt(2)*a};b.PO=function(a){return Math.sqrt(2)*a};b.$g=function(c,d,e){var f=new a.h;d.s(f);return b.$d(c,f,e)};b.GF=function(a,b,c){b=b.hg(1,0).uo();
a=null!=a?a.pe(1):0;c&&(b*=4,a*=1.1);return Math.max(a,b)};b.$Z=function(b,c){var d=new a.h;b.ac(d);d.Nb(c);return d};b.Zv=function(b,c){var d=new a.h;b.ac(d);b=new a.h;c.ac(b);d.Nb(b);return d};b.f_=function(b,c){var d=b.NS(c),e=b.wa(c),f=b.Fc(c),h=b.Ba(d);d==e?(f=b.Ba(f-1),d=b.Ba(e+1)):d==f-1?(f=b.Ba(d-1),d=b.Ba(e)):(f=b.Ba(d-1),d=b.Ba(d+1));h=a.b.Gp(f,h,d);return 0==h?0<b.Ym(c):-1==h};b.xP=function(b){var c=new a.h;b.ac(c);if(c.u())return null;var d=new a.gq(c,8),e=-1,f=new a.h,g=!1;do for(var n=
0,w=b.aa();n<w;n++)if(b.nk(n,f),e=d.lw(n,f,e),-1==e){if(g)throw a.g.X("internal error");b.Bo(c,!1);g=!0;d.reset(c,8);break}else g=!1;while(g);return d};b.BF=function(b){var c=new a.h;b.ac(c);for(var d=new a.gq(c,8),e=-1,f=b.Fa(),g=new a.h,n=!1;f.Ya();)for(;f.Ea();){var w=f.ba(),k=f.Db();w.s(g);e=d.lw(k,g,e);if(-1==e){if(n)throw a.g.za();b.Bo(c,!1);n=!0;d.reset(c,8);f.zj();break}}return d};b.Pj=function(b,c){var d=new a.h;b.ac(d);for(var e=new a.gq(d,8),f=-1,h=new a.h,g=b.Fa(),n=!1;g.Ya();)for(;g.Ea();){var w=
g.ba(),k=g.Db();w.s(h);if(h.Yb(c)&&(f=e.lw(k,h,f),-1==f)){if(n)throw a.g.X("internal error.");b.Bo(d,!1);n=!0;e.reset(d,8);g.zj();break}}return e};b.AZ=function(b){var c=new a.h;b.ac(c);for(var d=new a.gq(c,8),e=new a.b,f=new a.h,g=!1,n=0;n<b.D();n++)if(b.w(n,e),f.I(e),-1==d.dh(n,f)){if(g)throw a.g.za();b.Bo(c,!1);g=!0;d.reset(c,8);n=-1}return d};b.CF=function(b,c){for(var d=new a.gq(c,8),e=new a.b,f=!1,h=new a.h,g=0;g<b.D();g++)if(b.w(g,e),c.contains(e)&&(h.I(e),-1==d.dh(g,h))){if(f)throw a.g.za();
f=!0;g=new a.h;b.Bo(g,!1);d.reset(g,8);g=-1}return d};b.DS=function(b,c,d){var e=new a.h,f=new a.h;b.ac(e);c.ac(f);e.P(d,d);f.P(d,d);var h=new a.h;h.I(e);h.Ma(f);b=b.Fa();c=c.Fa();var g=new a.mD;g.BC(d);var p=!1;for(g.QK();b.Ya();)for(;b.Ea();)b.ba().s(e),e.Yb(h)&&(p=!0,d=new a.h,d.I(e),g.aF(b.Db(),d));g.qG();if(!p)return null;e=!1;for(g.PK();c.Ya();)for(;c.Ea();)c.ba().s(f),f.Yb(h)&&(e=!0,d=new a.h,d.I(f),g.XE(c.Db(),d));g.pG();return e?g:null};b.ES=function(b,c,d,e,f){var h=b.G(),g=c.G(),p=new a.h,
n=new a.h;b.ac(p);c.ac(n);p.P(d,d);n.P(d,d);var y=new a.h;y.I(p);y.Ma(n);var D=new a.mD;D.BC(d);var w=!1;D.QK();var k=0;for(d=b.aa();k<d;k++)if(!e||1736!=h||b.rw(k))b.nk(k,p),p.Yb(y)&&(w=!0,D.aF(k,p));D.qG();if(!w)return null;b=!1;D.PK();e=0;for(d=c.aa();e<d;e++)if(!f||1736!=g||c.rw(e))c.nk(e,n),n.Yb(y)&&(b=!0,D.XE(e,n));D.pG();return b?D:null};b.p_=function(a,b){return 0<a.Nk(b)};b.zZ=function(b,c){var d=new a.h;b.MW(c,d);var d=new a.gq(d,8),e=-1,f=new a.h;b=b.Fa();b.hC(c);if(b.Ya())for(;b.Ea();){c=
b.ba();var h=b.Db();c.ac(f);e=d.lw(h,f,e);if(-1==e)throw a.g.X("internal error");}return d};b.Jv=function(b,c,d){if(b!=c)for(var e=0;e<d;e++)null==b[e]?b[e]=a.b.Jl(c[e]):b[e].L(c[e])};b.mz=function(a,b,c,d){var e=0;for(d+=0;e<d;c++,e++)null==a[e]&&(a[e]=[0,0]),a[e][0]=b[c].x,a[e][1]=b[c].y};b.lz=function(b,c,d,e){var f=c,h=0;for(c=e+c;f<c;h++,f++)null==b[f]?b[f]=a.b.pa(d[h][0],d[h][1]):b[f].ja(d[h][0],d[h][1])};b.HQ=function(b,c,d){if(b!=c)for(var e=0;e<d;e++)null==b[e]?b[e]=new a.Wa(c[e]):c[e].copyTo(b[e])};
b.RY=function(a,b,c,d){var e=d.ga;d=d.la;for(var f=0;f<b;f+=c){var h=a.read(f);h<e?a.write(f,e):h>d&&a.write(f,d)}};b.JY=function(a,b,c,d){var e=d.ga;d=d.la;for(var f=0;f<b;f+=c){var h=a.read(f);h<e?a.write(f,e):h>d&&a.write(f,d)}};b.IK=function(c,d,e){if(c.hasAttribute(e)){var f=c.G();if(a.T.fh(f)){var h=a.ma.ti(e),f=a.ma.Xa(e),g=c.D();if(1==h){c=c.Qa(e);b.RY(c,g*f,f,d);return}if(2==h){c=c.Qa(e);b.JY(c,g*f,f,d);return}throw a.g.X("snap_coordinate not implemented");}if(197==f)g=c.hg(e,0),f=!1,g.ga<
d.ga&&(f=!0,g.ga=d.ga),g.la>d.la&&(f=!0,g.la=d.la),f&&c.setInterval(e,0,g);else if(33==f)g=c.Wc(e,0),f=!1,g<d.ga&&(f=!0,g=d.ga),g>d.la&&(f=!0,g=d.la),f&&c.setAttribute(e,0,g);else if(a.T.Nc(f))g=c.bt(e,0),f=!1,g<d.ga&&(f=!0,g=d.ga),g>d.la&&(f=!0,g=d.la),f&&c.Tx(e,0,g),g=c.Ms(e,0),g<d.ga&&(f=!0,g=d.ga),g>d.la&&(f=!0,g=d.la),f&&c.Lx(e,0,g);else throw a.g.X("snap_coordinate not implemented");}};b.wl=function(a,b,c,d,e){var f=0;null!=b&&(f=b.pe(a),e&&!d||null==b||(f+=1.01*b.iA(a)));d&&(c*=4,f*=1.01);
return Math.max(f,c)};b.BZ=function(c,d,e,f){d=a.h.XN(d.Te(),d.Cf(),e.Te(),e.Cf());return b.wl(0,c,d,f,!1)};b.Xy=function(a,c,d){return b.wl(0,a,c.uo(),d,!1)};b.CZ=function(a,c,d){return b.wl(1,a,c.uo(),d,!1)};b.DP=function(c,d){var e=new a.h;d.s(e);return b.Xy(c,e,!0)};b.Yy=function(a,c){return b.wl(0,a,c.uo(),!1,!0)};b.DZ=function(a,c,d){return b.wl(1,a,c.uo(),d,!0)};b.zv=function(c,d){var e=new a.h;d.s(e);return b.Yy(c,e)};b.BH=function(b,c,d,e){e*=e;var f=new a.b;f.xc(b,c);b=new a.b;b.xc(d,c);
c=f.uk();d=b.uk();if(c<=e&&d<=e)return!0;var h=a.Ub.Yx(f.Vi(b));return h<=e*c||h<=e*d?0<=f.pi(b):!1};b.JK=function(b,c,d,e){for(var f=0;f<c;f++){var h=b[f].y,g=a.J.tk(h,d,e);g!=h&&(b[f].y=g)}};return b}();a.na=b})(C||(C={}));(function(a){var b=function(){function a(a){this.ab=a}a.prototype.compare=function(a,b,c){a=a.ia(c);c=this.ab.Rk(b);var d=this.ab.Rk(a);return c<d?-1:c==d?f.Vq(b)&&f.tw(a)?-1:f.Vq(a)&&f.tw(b)?1:0:1};return a}(),c=function(){function a(a){this.ab=a}a.prototype.gs=function(a,b,
c){this.ab.eY(c,a,b)};a.prototype.Qq=function(a){return this.ab.Rk(a)};return a}(),d;(function(a){a[a.initialize=0]="initialize";a[a.pIn=1]="pIn";a[a.pL=2]="pL";a[a.pR=3]="pR";a[a.pT=4]="pT";a[a.right=5]="right";a[a.left=6]="left";a[a.all=7]="all"})(d||(d={}));var e=function(){function b(){this.ab=null;this.qj=new a.yc;this.nh=new a.ha(0);this.Mg=[0,0]}b.prototype.Oi=function(a,b){this.qj.ga=a.ga-b;this.qj.la=a.la+b;this.nh.resize(0);this.Be=0;this.Mg[0]=0};b.prototype.gC=function(b,c,d){if(b>c)throw a.g.F();
this.qj.ga=b-d;this.qj.la=c+d;this.nh.resize(0);this.Be=0;this.Mg[0]=0};b.prototype.bo=function(a,b){this.qj.ga=a-b;this.qj.la=a+b;this.nh.resize(0);this.Be=0;this.Mg[0]=0};b.prototype.next=function(){if(!this.ab.ar)throw a.g.Da();if(0>this.Be)return-1;for(var b=!0;b;)switch(this.Mg[this.Be]){case 1:b=this.UV();break;case 2:b=this.VV();break;case 3:b=this.WV();break;case 4:b=this.XV();break;case 5:b=this.gX();break;case 6:b=this.PU();break;case 7:b=this.SO();break;case 0:b=this.tA();break;default:throw a.g.za();
}return-1!=this.ih?this.Gq()>>1:-1};b.NZ=function(a,c,d){var e=new b;e.ab=a;e.nh.zb(20);e.Oi(c,d);return e};b.OZ=function(a,c,d){var e=new b;e.ab=a;e.nh.zb(20);e.bo(c,d);return e};b.pa=function(a){var c=new b;c.ab=a;c.nh.zb(20);c.Be=-1;return c};b.prototype.tA=function(){this.ih=this.uI=this.mj=this.Rc=-1;if(null!=this.ab.Ge&&0<this.ab.Ge.size)return this.Mg[0]=1,this.mj=this.ab.Jf,!0;this.Be=-1;return!1};b.prototype.UV=function(){this.Rc=this.mj;if(-1==this.Rc)return this.ih=this.Be=-1,!1;var a=
this.ab.Hq(this.Rc);if(this.qj.la<a)return a=this.ab.Qk(this.Rc),this.mj=this.ab.Uj(this.Rc),-1!=a&&(this.Fi=this.ab.Tl(a),this.Mg[++this.Be]=6),!0;if(a<this.qj.ga)return a=this.ab.Qk(this.Rc),this.mj=this.ab.Pk(this.Rc),-1!=a&&(this.Fi=this.ab.Xs(a),this.Mg[++this.Be]=5),!0;this.Mg[this.Be]=2;this.uI=this.Rc;a=this.ab.Qk(this.Rc);this.mj=this.ab.Uj(this.Rc);-1!=a&&(this.Fi=this.ab.Tl(a),this.Mg[++this.Be]=7);return!0};b.prototype.VV=function(){this.Rc=this.mj;if(-1==this.Rc)return this.Mg[this.Be]=
3,this.mj=this.ab.Pk(this.uI),!0;if(this.ab.Hq(this.Rc)<this.qj.ga){var a=this.ab.Qk(this.Rc);this.mj=this.ab.Pk(this.Rc);-1!=a&&(this.Fi=this.ab.Xs(a),this.Mg[++this.Be]=5);return!0}a=this.ab.Qk(this.Rc);this.mj=this.ab.Uj(this.Rc);-1!=a&&(this.Fi=this.ab.Tl(a),this.Mg[++this.Be]=7);a=this.ab.Pk(this.Rc);-1!=a&&this.nh.add(a);return!0};b.prototype.WV=function(){this.Rc=this.mj;if(-1==this.Rc)return this.Mg[this.Be]=4,!0;if(this.qj.la<this.ab.Hq(this.Rc)){var a=this.ab.Qk(this.Rc);this.mj=this.ab.Uj(this.Rc);
-1!=a&&(this.Fi=this.ab.Tl(a),this.Mg[++this.Be]=6);return!0}a=this.ab.Qk(this.Rc);this.mj=this.ab.Pk(this.Rc);-1!=a&&(this.Fi=this.ab.Tl(a),this.Mg[++this.Be]=7);a=this.ab.Uj(this.Rc);-1!=a&&this.nh.add(a);return!0};b.prototype.XV=function(){if(0==this.nh.size)return this.ih=this.Be=-1,!1;this.Rc=this.nh.get(this.nh.size-1);this.nh.resize(this.nh.size-1);var a=this.ab.Qk(this.Rc);-1!=a&&(this.Fi=this.ab.Tl(a),this.Mg[++this.Be]=7);-1!=this.ab.Uj(this.Rc)&&this.nh.add(this.ab.Uj(this.Rc));-1!=this.ab.Pk(this.Rc)&&
this.nh.add(this.ab.Pk(this.Rc));return!0};b.prototype.PU=function(){this.ih=this.Fi;if(-1!=this.ih&&f.Vq(this.Gq())&&this.ab.Rk(this.Gq())<=this.qj.la)return this.Fi=this.VG(),!1;this.Be--;return!0};b.prototype.gX=function(){this.ih=this.Fi;if(-1!=this.ih&&f.tw(this.Gq())&&this.ab.Rk(this.Gq())>=this.qj.ga)return this.Fi=this.jT(),!1;this.Be--;return!0};b.prototype.SO=function(){this.ih=this.Fi;if(-1!=this.ih&&f.Vq(this.Gq()))return this.Fi=this.VG(),!1;this.Be--;return!0};b.prototype.VG=function(){return this.ab.og?
this.ab.ug.nb(this.ih):this.ab.tj.nb(this.ih)};b.prototype.jT=function(){return this.ab.og?this.ab.ug.Se(this.ih):this.ab.tj.Se(this.ih)};b.prototype.Gq=function(){return this.ab.og?this.ab.ug.ia(this.ih):this.ab.tj.getData(this.ih)};return b}();a.xZ=e;var f=function(){function d(a){this.un=this.Ai=this.ug=this.tj=this.Dn=this.ek=this.Ge=this.fk=null;this.og=a;this.ar=this.Ew=!1}d.prototype.bs=function(){this.sl(!0)};d.prototype.xs=function(b,c){if(!this.Ew)throw a.g.Da();this.fk.push(new a.yc(b,
c))};d.prototype.yq=function(){if(!this.Ew)throw a.g.X("invalid call");this.Ew=!1;this.ar=!0;this.og||(this.TT(),this.Mw=this.fk.length)};d.prototype.dh=function(b){if(!this.og||!this.ar)throw a.g.F("invalid call");if(-1==this.Jf){var c=this.fk.length;if(this.UA){var d=new a.ha(0);d.zb(2*c);this.JJ(d);this.Ai.zb(2*c);this.Ai.resize(0);this.IJ(d);this.Dn.resize(c,-1);this.Dn.$h(-1,0,c);this.UA=!1}else this.Dn.$h(-1,0,c);this.Jf=this.Lv()}c=this.rH(b<<1,this.Jf);d=this.ug.addElement((b<<1)+1,this.kA(c));
this.AK(c,d);this.Dn.set(b,c);this.Mw++};d.prototype.remove=function(b){if(!this.og||!this.ar)throw a.g.X("invalid call");var c=this.Dn.get(b);if(-1==c)throw a.g.F("the interval does not exist in the interval tree");this.Dn.set(b,-1);this.Mw--;var d=this.kA(c),e;e=this.ug.tT(d);this.ug.Jd(this.QS(c),d);this.ug.Jd(this.mT(c),d);b=this.ug.size(d);0==b&&(this.ug.fR(d),this.DK(e,-1));this.ek.jd(c);for(var d=this.XG(e),f=this.Uj(e),h=this.Pk(e),c=0;!(0<b||e==this.Jf||-1!=f&&-1!=h);)e==this.Uj(d)?-1!=f?
(this.tl(d,f),this.rk(f,d),this.tl(e,-1)):-1!=h?(this.tl(d,h),this.rk(h,d),this.vl(e,-1)):this.tl(d,-1):-1!=f?(this.vl(d,f),this.rk(f,d),this.tl(e,-1)):-1!=h?(this.vl(d,h),this.rk(h,d),this.vl(e,-1)):this.vl(d,-1),this.rk(e,-1),c++,e=d,d=this.Qk(e),b=-1!=d?this.ug.size(d):0,f=this.Uj(e),h=this.Pk(e),d=this.XG(e)};d.prototype.reset=function(){if(!this.og||!this.ar)throw a.g.F("invalid call");this.sl(!1)};d.prototype.size=function(){return this.Mw};d.prototype.jf=function(){return e.pa(this)};d.prototype.JJ=
function(a){for(var b=this.fk.length,c=0;c<2*b;c++)a.add(c);this.fY(a,2*b)};d.prototype.IJ=function(a){for(var b=NaN,c=0;c<a.size;c++){var d=a.get(c),e=this.Rk(d);e!=b&&(this.Ai.add(d),b=e)}};d.prototype.TT=function(){var b=this.fk.length,c=new a.ha(0);c.zb(2*b);this.JJ(c);this.Ai.zb(2*b);this.Ai.resize(0);this.IJ(c);this.ek.Ne(b);this.tj.ao(2*b);var d=a.Tc.wh(b);d.$h(-1,0,b);this.Jf=this.Lv();for(b=0;b<c.size;b++){var e=c.get(b),f=d.get(e>>1);-1!=f?this.AK(f,this.tj.addElement(this.kA(f),e)):(f=
this.rH(e,this.Jf),d.set(e>>1,f))}};d.prototype.rH=function(b,c){var d=c,e=c,f,h=-1,g=0,p=this.Ai.size-1,n=0,y=b>>1,D=NaN,w=NaN;f=!0;for(var k=this.XS(y),y=this.US(y);f;){g<p?(n=g+a.J.truncate((p-g)/2),-1==this.Sz(d)&&this.jK(d,this.Ai.get(n),this.Ai.get(n+1))):-1==this.Sz(d)&&this.jK(d,this.Ai.get(g),this.Ai.get(g));var K=this.Hq(d);if(y<K)-1!=c&&(c==d?(e=d,D=K,c=this.Uj(d),-1!=c?w=this.Hq(c):w=NaN):w>K&&(K<D?this.tl(e,d):this.vl(e,d),this.vl(d,c),this.og&&(this.rk(d,e),this.rk(c,d)),e=d,D=K,c=-1,
w=NaN)),p=this.RS(d),-1==p&&(p=this.Lv(),this.CX(d,p)),d=p,p=n;else if(k>K)-1!=c&&(c==d?(e=d,D=K,c=this.Pk(d),-1!=c?w=this.Hq(c):w=NaN):w<K&&(K<D?this.tl(e,d):this.vl(e,d),this.tl(d,c),this.og&&(this.rk(d,e),this.rk(c,d)),e=d,D=K,c=-1,w=NaN)),g=this.nT(d),-1==g&&(g=this.Lv(),this.NX(d,g)),d=g,g=n+1;else{f=this.Qk(d);-1==f&&(f=this.TQ(d),this.DK(d,f));var l=this.BO(f,b),h=this.RQ();this.QX(h,f);this.BX(h,l);d!=c&&(K<D?this.tl(e,d):this.vl(e,d),this.og&&this.rk(d,e),-1!=c&&(w<K?this.tl(d,c):this.vl(d,
c),this.og&&this.rk(c,d)));f=!1}}return h};d.prototype.Lv=function(){return this.Ge.Me()};d.prototype.TQ=function(a){return this.og?this.ug.Is(a):this.tj.ni(a)};d.prototype.RQ=function(){return this.ek.Me()};d.prototype.sl=function(c){c?(this.Ew=this.UA=!0,this.ar=!1,null==this.Ai?this.Ai=a.Tc.wh(0):this.Ai.resize(0),null==this.fk?this.fk=[]:this.fk.length=0):this.UA=!1;this.og?null==this.Dn?(this.Dn=a.Tc.wh(0),this.ug=new a.xk,this.ug.Lp(new b(this))):this.ug.clear():null==this.tj?this.tj=new a.cq:
this.tj.clear();null==this.Ge?(this.ek=new a.Zc(3),this.Ge=new a.Zc(this.og?8:7)):(this.ek.Wi(!1),this.Ge.Wi(!1));this.Jf=-1;this.Mw=0};d.prototype.jK=function(a,b,c){this.wX(a,b);this.xX(a,c)};d.prototype.Hq=function(a){var b=this.Sz(a);if(-1==b)return NaN;b=this.Rk(b);a=this.Rk(this.yS(a));return b==a?b:.5*(b+a)};d.prototype.wX=function(a,b){this.Ge.R(a,0,b)};d.prototype.xX=function(a,b){this.Ge.R(a,1,b)};d.prototype.CX=function(a,b){this.Ge.R(a,3,b)};d.prototype.NX=function(a,b){this.Ge.R(a,4,
b)};d.prototype.DK=function(a,b){this.Ge.R(a,2,b)};d.prototype.tl=function(a,b){this.Ge.R(a,5,b)};d.prototype.vl=function(a,b){this.Ge.R(a,6,b)};d.prototype.rk=function(a,b){this.Ge.R(a,7,b)};d.prototype.QX=function(a,b){this.ek.R(a,0,b)};d.prototype.BO=function(a,b){return this.og?this.ug.addElement(b,a):this.tj.addElement(a,b)};d.prototype.BX=function(a,b){this.ek.R(a,1,b)};d.prototype.AK=function(a,b){this.ek.R(a,2,b)};d.prototype.Tl=function(a){return this.og?this.ug.wc(a):this.tj.wc(a)};d.prototype.Xs=
function(a){return this.og?this.ug.Ec(a):this.tj.Ec(a)};d.Vq=function(a){return 0==(a&1)};d.tw=function(a){return 1==(a&1)};d.prototype.Sz=function(a){return this.Ge.S(a,0)};d.prototype.yS=function(a){return this.Ge.S(a,1)};d.prototype.Qk=function(a){return this.Ge.S(a,2)};d.prototype.RS=function(a){return this.Ge.S(a,3)};d.prototype.nT=function(a){return this.Ge.S(a,4)};d.prototype.Uj=function(a){return this.Ge.S(a,5)};d.prototype.Pk=function(a){return this.Ge.S(a,6)};d.prototype.XG=function(a){return this.Ge.S(a,
7)};d.prototype.kA=function(a){return this.ek.S(a,0)};d.prototype.QS=function(a){return this.ek.S(a,1)};d.prototype.mT=function(a){return this.ek.S(a,2)};d.prototype.XS=function(a){return this.fk[a].ga};d.prototype.US=function(a){return this.fk[a].la};d.prototype.fY=function(b,d){null==this.un&&(this.un=new a.Ju);var e=new c(this);this.un.sort(b,0,d,e)};d.prototype.eY=function(a,b,c){var e=this;a.Fd(b,c,function(a,b){var c=e.Rk(a),f=e.Rk(b);return c<f||c==f&&d.Vq(a)&&d.tw(b)?-1:1})};d.prototype.Rk=
function(a){var b=this.fk[a>>1];return d.Vq(a)?b.ga:b.la};return d}();a.ms=f})(C||(C={}));(function(a){var b=function(){function b(b){if(null==b)throw a.g.X("Invalid arguement");this.He=b;var c=b.FS();c.DT()?b.he.IH()?this.fp=a.Qi.PannableFold:this.fp=a.Qi.Clip:this.fp=a.Qi.DontClip;c.ET()?b.Ee.IH()?this.Jn=a.Qi.PannableFold:this.Jn=a.Qi.Clip:this.Jn=a.Qi.DontClip;this.vn=c.Cv;this.lI=c.sz;b=this.He.rI;this.$H=b.gt(2147483648);this.Gw=b.gt(1073741824)}b.Vg=function(a,b,c){return b.xr.Vg(a,c)};b.fs=
function(a,b,c,d){return a.xr.fs(b,c,d)};b.Fu=function(a,b,c,d){c=0>c?b.length:c;a=a.xr.fs(b,c,d);if(a==c)return a;for(var e=b=0;e<c;e++){var f=d[e];f.isNaN()||(b<e&&d[b].L(f),b++)}for(;b<c;b++)d[b].Yc();return a};b.OC=function(a,b,c,d){return a.xr.OC(b,c,d)};b.XK=function(a,b,c,d){c=0>c?b.length:c;a=a.xr.OC(b,c,d);if(a==c)return a;for(var e=b=0;e<c;e++){var f=d[e];isNaN(f.x)||(b<e&&d[b].I(f.x,f.y,f.z),b++)}for(;b<c;b++)d[b].iv();return a};b.transform=function(c,d,e,f,g){if(c.No())return a.na.HQ(f,
d,e),e;for(var h=[],p=0,n=0;n<e;){for(var y=Math.min(h.length,e-n),D=n,w=0;D<y;D++,w++)null==h[w]?h[w]=d[D].w():d[D].w(h[w]);var k;k=g?b.Fu(c,h,y,h):b.fs(c,h,y,h);for(w=D=0;D<k;D++,w++)null==f[n]&&(f[n]=new a.Wa(d[n])),f[n].rb(h[w]);n+=y;p+=k}return p};b.YK=function(b,c,d){if(0==d)return[];var e=new a.Dd;e.LO(c,2*d);c=this.Vg(e,b,null);b=c.Qa(0);c=2*c.D();d=a.J.df(c);b.rl(0,c,d,0,!0);return d};b.prototype.fs=function(b,c,d){if(this.He.No())return b!=d&&a.na.Jv(d,b,c),c;var e=this.He.he,f=this.He.Ee,
h=e.Fb(),g=f.Fb();if(0==h&&h===g){var p=e.Zi(),f=f.Zi(),f=p/f,p=new a.Gd;p.Vp(f,f);p.DY(b,c,d);return c}p=a.J.vv(Math.min(c,64));if(3==h){var n;n=e.jj;e=n.Ik();h=e.Fb();d!=b&&a.na.Jv(d,b,c);a.Ib.Il(n,d,c,!0);n.Fu(a.Um.forward,d,c);a.Ib.Hl(n,d,c,!0)}if(3==h||3===g)throw a.g.X("image: transform_in_place_");if(2==h)this.fp==a.Qi.Clip?(d!=b&&a.na.Jv(d,b,c),b=e.Ok(),a.Ib.lU(b,e,d,c)):(d!=b&&a.na.Jv(d,b,c),e.Ic()&&(h=e.pe(0),n=e.oe(),a.Ib.cY(d,c,n,h),a.Ib.uG(d,c,e,0))),a.Ib.$M(e,d,c,p);else for(h=e.pe(0),
n=e.oe(),e=0;e<c;e++)a.Ib.dY(b[e],n,h,d[e]);a.Ib.YM(this.He,d,c,p);b=0;(g=2==g)?b=f.ri():isNaN(this.vn)||(b=this.vn);g&&this.Jn!=a.Qi.Clip||a.Ib.uG(d,c,f.lc(),b);g&&(a.Ib.zH(d,c,f,this.Jn),a.Ib.ZM(f,d,c,p));b=c;for(e=0;e<c;++e)d[e].isNaN()&&b--;return b};b.prototype.OC=function(b,c,d){c=0>c?b.length:c;if(this.He.No()){for(var e=0;e<c;++e)null==d[e]&&(d[e]=new a.od),d[e].I(b[e].x,b[e].y,b[e].z);return c}var f=this.He.he,e=this.He.Ee,h=f.Fb(),g=e.Fb();if(0==h&&h==g)return f=f.Zi(),e=e.Zi(),e=f/e,f=
new a.DN,f.Vp(e,e,e),f.transform(b,c,d),c;h=new a.Dd;h.Rd(1);h.Rd(3);h.KO(b);b=h.Qa(3);e=0;for(f=c;e<f;e++)b.write(e,e);h=this.Vg(h,null);for(e=0;e<c;++e)null==d[e]?d[e]=a.od.pa(NaN,NaN,NaN):d[e].iv();if(null==h)return 0;b=h.Qa(3);var g=h.Qa(0),p=h.Qa(1);h.KW(d,c);e=0;for(f=h.D();e<f;e++)c=b.read(e),g.TW(2*e,d[c]),d[c].z=p.read(e);return h.D()};b.prototype.Vg=function(b,c){if(this.He.No()||b.u())return b;if(33==b.G())return this.DJ(b);var d=this.He.he,e=this.He.Ee,f=d.Fb(),h=e.Fb();if(0==f&&f==h)return d=
d.Zi(),e=e.Zi(),d/=e,e=new a.Gd,e.Vp(d,d),d=a.T.me(b),d.Vc(e),d;switch(b.G()){case 1607:case 1736:e=this.BJ(b,c);break;case 550:e=this.zW(b,c);break;case 197:e=this.yW(b,c);break;default:throw a.g.X("");}return e};b.prototype.DJ=function(b){var c=b.w(),d=[];d[0]=c;this.fs(d,1,d);b=new a.Wa(b);b.rb(d[0]);return b};b.prototype.BJ=function(b,c){if(b.on())throw a.g.X("curves not supported");var d=b.G();if(1736==d)return this.AW(b,c);if(1607==d)return this.BW(b,c);throw a.g.X("projectMultiPath");};b.prototype.AW=
function(c,d){var e=this.He.he,f=this.He.Ee,h=e.Fb(),g=f.Fb(),n=a.J.vv(Math.min(c.D(),64));c=a.Ja.me(c);if(3==h){var w=e.jj,e=w.Ik(),h=e.Fb();c=w.Il(c,!0);this.qq(w,a.Um.forward,c);c=w.Hl(c,!0)}w=null;3==g&&(w=f.jj,f=w.Ik(),g=f.Fb());var k=2==h,l=2==g,m=l?f.lc():f,q=!l&&!this.Gw,g=!1,r=c;if(k){if(r=a.Ib.AJ(r,e,this.fp,d),r.u())return r}else{c=new a.h;r.ac(c);h=e.oe();if(c.A<h.A||c.B>h.B){var t=a.h.pa(c.o-1,h.A,c.v+1,h.B),r=a.th.rq(r,t,e,NaN,0,d);if(r.u())return r}c.O()>2*h.O()&&(r=a.Ib.Aq(r,-2*h.O(),
2*h.O(),e,!0,0,!0,d))}c=this.lI;(h=!isNaN(c))&&(r=a.Pm.local().V(r,c,d));var t=l?f.Wj():null,u=NaN;k&&(u=e.ri());var I=null!=f.Us();if(this.$H)k&&(a.Ib.qs(e,u,r,n),h&&(k=e.Dh(),u=e.lc().Dh(),c*=u/k)),a.Ib.ps(this.He,r,q,n),h&&(k=e.lc().Dh(),u=f.lc().Dh(),c*=u/k),e=r;else{var v=new a.Ua(r.description);v.WE(r);k&&(a.Ib.qs(e,u,v,n),h&&(k=e.Dh(),u=e.lc().Dh(),c*=u/k));a.Ib.ps(this.He,v,q,n);h&&(k=e.lc().hn(),u=f.lc().hn(),c*=u/k);q=NaN;l?(t=f.Wj(),q=f.ri()):isNaN(this.vn)||(q=this.vn);k=b.ye(e)|b.ye(f);
u=10*m.pe(0);this.Gw&&(k=3,u=0);e=a.Ib.kS(r,e,v,m,q,d,k,u)}I&&(e=a.Ib.lF(e,f,d));l&&(g||(l=m.oe().O(),e.hg(0,0).O()>=l-m.pe(0)&&(m=t.getNorthPoleLocation(),l=t.getSouthPoleLocation(),r=t.getNorthPoleGeometry(),t=t.getSouthPoleGeometry(),q=0,r==a.Ag.PE_POLE_POINT&&m!=a.Ag.PE_POLE_OUTSIDE_BOUNDARY&&(q=1),t==a.Ag.PE_POLE_POINT&&l!=a.Ag.PE_POLE_OUTSIDE_BOUNDARY&&(q|=2),0!==q&&(g=!0))),e=a.Ib.wA(e,f,this.Jn,d),h&&(e=a.Pm.local().V(e,c,d)),a.Ib.ry(f,e,n));if(e.u())return e;g&&(e=a.Qm.local().V(e,f,!1,d));
null!=w&&(e=w.Hl(e,!1),this.qq(w,a.Um.reverse,e),e=w.Il(e,!1));return e};b.ye=function(b){if(2!=b.Fb())return 0;var c=0,d=b.Wj();b=d.getNorthPoleLocation();var e=d.getSouthPoleLocation(),f=d.getNorthPoleGeometry(),d=d.getSouthPoleGeometry();f==a.Ag.PE_POLE_POINT&&b!=a.Ag.PE_POLE_OUTSIDE_BOUNDARY&&(c=1);d==a.Ag.PE_POLE_POINT&&e!=a.Ag.PE_POLE_OUTSIDE_BOUNDARY&&(c|=2);return c};b.prototype.BW=function(c,d){var e=this.He.he,f=this.He.Ee,h=e.Fb(),g=f.Fb(),n=a.J.vv(Math.min(c.D(),64));c=a.Ua.me(c);if(3==
h){var w=e.jj,e=w.Ik(),h=e.Fb();c=w.Il(c,!0);this.qq(w,a.Um.forward,c);c=w.Hl(c,!0)}w=null;3==g&&(w=f.jj,f=w.Ik(),g=f.Fb());var k=2==h,h=(g=2==g)?f.lc():f,l=!g&&!this.Gw;if(k){if(c=a.Ib.AJ(c,e,this.fp,d),c.u())return c}else{var m=new a.h;c.ac(m);var q=e.oe();if(m.A<q.A||m.B>q.B)if(m=a.h.pa(m.o-1,q.A,m.v+1,q.B),c=a.th.rq(c,m,e,NaN,0,d),c.u())return c}var r=NaN;k&&(r=e.ri());var m=null!=f.Us(),q=this.lI,t=!isNaN(q);t&&(c=a.Pm.local().V(c,q,d));if(this.$H)k&&a.Ib.qs(e,r,c,n),t&&(k=e.Dh(),r=e.lc().Dh(),
q*=r/k),a.Ib.ps(this.He,c,l,n),t&&(k=e.lc().Dh(),r=f.lc().Dh(),q*=r/k),e=c;else{var u=new a.Ua(c.description);u.WE(c);k&&(a.Ib.qs(e,r,u,n),t&&(k=e.Dh(),r=e.lc().Dh(),q*=r/k));a.Ib.ps(this.He,u,l,n);t&&(k=e.lc().Dh(),r=f.lc().Dh(),q*=r/k);l=NaN;g?l=f.ri():isNaN(this.vn)||(l=this.vn);k=b.ye(e)|b.ye(f);r=10*h.pe(0);this.Gw&&(k=3,r=0);e=a.Ib.lS(c,e,u,h,l,d,k,r)}m&&(e=a.Ib.lF(e,f,d));g&&(e=a.Ib.wA(e,f,this.Jn,d),t&&(e=a.Pm.local().V(e,q,d)),a.Ib.ry(f,e,n));if(e.u())return e;null!=w&&(e=w.Hl(e,!1),this.qq(w,
a.Um.reverse,e),e=w.Il(e,!1));return e};b.prototype.yW=function(b,c){var d=(b.ea()+b.O())/400;if(0!=d){var e=a.Pm.local().V(b,d,c),e=this.BJ(e,c),d=b.Ka();e.Wn(d)}else d=new a.Wa(b.Bq()),e=this.DJ(d),d=b.Ka(),e.u()?d.Oa():(b.copyTo(d),e=e.w(),d.I(e.x,e.y,e.x,e.y));return d};b.prototype.zW=function(b,c){b=a.T.me(b);var d=this.He.he,e=this.He.Ee,f=d.Fb(),h=e.Fb(),g=a.J.vv(Math.min(b.D(),64));if(3==f){var n=d.jj,d=n.Ik(),f=d.Fb();b=n.Hl(b,!0);this.qq(n,a.Um.forward,b);b=n.Il(b,!0)}if(2==f){this.fp==
a.Qi.Clip?b=a.wk.local().V(b,d.Ok(),d,c):d.Ic()&&(f=new a.h,b.ac(f),d.oe().contains(f)||(this.fp==a.Qi.PannableFold&&(b=a.Ib.Qj(b,d)),a.Ib.zu(b,d.oe(),d.pe(0),!0),b=a.Ib.cn(b,d,0,!0,0,c)));if(b.u())return b;a.Ib.qs(d,0,b,g)}else a.Ib.zu(b,d.oe(),d.pe(0),!0);a.Ib.ps(this.He,b,!1,g);d=0;f=!1;n=null;3==h&&(f=!0,n=e.jj,e=n.Ik(),h=e.Fb());(h=2==h)?d=e.ri():isNaN(this.vn)||(d=this.vn);h&&this.Jn!=a.Qi.Clip||(b=a.Ib.cn(b,e.lc(),d,!1,0,c));if(h&&(b=a.Ib.wA(b,e,this.Jn,c),a.Ib.ry(e,b,g),b.u()))return b;f&&
(b=n.Hl(b,!0),this.qq(n,a.Um.reverse,b),b=n.Il(b,!0));return b};b.prototype.qq=function(b,c,d){var e=d.D();if(0!=e){for(var f=d.Qa(0),h=a.J.df(200,0),g=[],p=0;p<e;){var n=Math.min(100,e-p);f.rl(2*p,2*n,h,2,!0);for(var k=0;k<n;++k)g[k]=a.b.pa(h[2*p],h[2*p+1]);b.Fu(c,g,n);p+=n}d.Cc(1993)}};b.Fj=function(b,c,d){if(null==b||null==c||!c.Ic())throw a.g.X("Invalid Arguement");if(b.u())return b;var e;e=b.G();197==e?(e=new a.Ja(b.description),e.hd(b,!1)):a.T.Nc(e)?(e=new a.Ua(b.description),e.cc(b,!0)):e=
b;e=a.Ib.Qj(e,c);return e.u()?e:a.Ib.cn(e,c,0,e!=b,0,d)};b.Rj=function(c,d,e,f){if(null==c||null==d||!d.Ic())throw a.g.X("Invalid Arguement");if(c.u())return c;var h=c.G();if(a.T.Hc(h)){c=a.Ib.Qj(c,d);h=new a.h;c.s(h);for(var g=a.na.Xy(d,h,!1),p=d.Ch(),n=Math.floor((h.o-p.o)/p.O())*p.O()+p.o;n<h.v;)n>h.o+g&&n<h.v-g&&(c=a.Ib.ST(c,d,e,n)),n+=p.O()}else{if(197==h)return h=new a.Ja(c.description),h.hd(c,!1),b.Rj(h,d,e,f);if(a.T.Nc(h))return h=new a.Ua(c.description),h.cc(c,!0),b.Rj(h,d,e,f)}return b.Fj(c,
d,f)};b.Lm=function(c,d,e,f){var h=d.Fb(),g=new a.kE;d.NW(g);if(0==h)return b.Ej(c,g,d,e);f==a.aq.foldAndClipWithHorizon&&d.Ic()&&(c=b.Fj(c,d,e));c=b.Ej(c,g,d,e);if(f==a.aq.clipToDomainOnly||c.u())return c;if(1==h)return f==a.aq.clipWithHorizon?(f=new a.h,c.ac(f),h=d.oe(),g=.01*h.O(),f.A=h.A,f.B=h.B,f.o-=g,f.v+=g,a.th.rq(c,f,d,NaN,0,e)):c;if(2==h)return h=d.Ok(),f==a.aq.clipWithHorizon||f==a.aq.foldAndClipWithHorizon?(d=a.wk.local().V(c,h,d,e),d==h?a.T.me(d):d):c;if(3==h)return c;throw a.g.X("missing implementation");
};b.Ej=function(b,c,d,e){var f=c.xT(),h=b.hasAttribute(1),g=b.hasAttribute(2),p=new a.yc;p.Oa();var n=new a.yc;n.Oa();h&&(p=c.zT());g&&(n=c.TS());c=a.th.rq(b,f,d,NaN,0,e);h&&(h=c.hg(1,0),p.contains(h)||(b==c&&(c=a.T.me(c)),a.na.IK(c,p,1)));g&&(h=c.hg(2,0),n.contains(h)||(b==c&&(c=a.T.me(c)),a.na.IK(c,n,2)));return c};return b}();a.qo=b})(C||(C={}));(function(a){var b=function(b){function c(c,d,e,f){var h=b.call(this)||this;void 0===c?h.description=a.we.Hg():void 0===e?h.description=c:(h.description=
a.we.Hg(),h.zC(c,d),h.Am(e,f));return h}ca(c,b);c.prototype.G=function(){return 322};c.prototype.Rb=function(){var a=this.ua-this.sa,b=this.ra-this.oa;return Math.sqrt(a*a+b*b)};c.prototype.eh=function(a){var b=this.ua-this.sa,c=this.ra-this.oa;return Math.sqrt(b*b+c*c)<=a};c.prototype.Mo=function(){return!1};c.prototype.Dg=function(){var b=new a.b;b.xc(this.Ac(),this.ec());return b};c.CQ=function(a,b){return new c(a.x,a.y,b.x,b.y)};c.prototype.Wn=function(b){b.Oa();b.Eg(this.description);var c=new a.h;
this.s(c);b.Np(c);for(var c=1,d=this.description.Ga;c<d;c++)for(var e=this.description.pd(c),f=a.ma.Xa(e);c<f;c++){var h=this.hg(e,0);b.setInterval(e,0,h)}};c.prototype.s=function(a){a.I(this.ua,this.ra,this.sa,this.oa);a.normalize()};c.prototype.Jp=function(a){a.Oa();a.Nb(this.ua,this.ra,this.Zd(0,1,0));a.Nb(this.sa,this.oa,this.Zd(1,1,0))};c.prototype.Vc=function(b){if(b instanceof a.Gd){this.zc();var c=new a.b;c.x=this.ua;c.y=this.ra;b.ai(c,c);this.ua=c.x;this.ra=c.y;c.x=this.sa;c.y=this.oa;b.ai(c,
c);this.sa=c.x;this.oa=c.y}else this.zc(),c=new a.od,c.x=this.ua,c.y=this.ra,c.z=this.Zd(0,1,0),c=b.Yp(c),this.ua=c.x,this.ra=c.y,this.vo(0,1,0,c.z),c.x=this.sa,c.y=this.oa,c.z=this.Zd(1,1,0),c=b.Yp(c),this.sa=c.x,this.oa=c.y,this.vo(1,1,0,c.z)};c.prototype.Ka=function(){return new c(this.description)};c.prototype.yy=function(a,b){return(this.sa-a-(this.ua-a))*(this.oa-b+(this.ra-b))*.5};c.prototype.cy=function(a){return a*this.Rb()};c.prototype.PH=function(a){return a/this.Rb()};c.prototype.HG=function(b){return a.Ub.Xq(this.ua,
this.sa,b)};c.prototype.xS=function(b){return a.Ub.Xq(this.ra,this.oa,b)};c.prototype.Ml=function(b,c){var d=new a.Bg;this.yh(b,c,d);return d.get()};c.prototype.yh=function(b,c,d){if(null==d)throw a.g.F();d.Hs();d=d.get();d.Eg(this.description);var e=new a.b;this.hc(b,e);d.zC(e.x,e.y);this.hc(c,e);d.Am(e.x,e.y);for(var e=1,f=this.description.Ga;e<f;e++)for(var h=this.description.Qd(e),g=a.ma.Xa(h),p=0;p<g;p++){var n=this.Wc(b,h,p);d.Tx(h,p,n);n=this.Wc(c,h,p);d.Lx(h,p,n)}};c.prototype.Wc=function(b,
c,d){if(0==c)return 0==d?this.hc(b).x:this.hc(b).y;switch(a.ma.Zz(c)){case 0:return.5>b?this.bt(c,d):this.Ms(c,d);case 1:var e=this.bt(c,d);c=this.Ms(c,d);return a.Ub.Xq(e,c,b);case 2:throw a.g.X("not implemented");}throw a.g.za();};c.prototype.ne=function(a,b){var c=this.sa-this.ua,d=this.oa-this.ra,e=c*c+d*d;if(0==e)return.5;c=((a.x-this.ua)*c+(a.y-this.ra)*d)/e;b||(0>c?c=0:1<c&&(c=1));return c};c.prototype.Tq=function(a,b,c,d){if(a){a=this.oa-this.ra;if(0==a)return b==this.oa?-1:0;b=(b-this.ra)/
a;if(0>b||1<b)return 0;null!=c&&(c[0]=this.HG(b))}else{a=this.sa-this.ua;if(0==a)return b==this.sa?-1:0;b=(b-this.ua)/a;if(0>b||1<b)return 0;null!=c&&(c[0]=this.xS(b))}null!=d&&(d[0]=b);return 1};c.prototype.kf=function(a,b){var c=this.oa-this.ra;if(0==c)return a==this.oa?b:NaN;c=(a-this.ra)/c;a=this.HG(c);1==c&&(a=this.sa);return a};c.prototype.fv=function(a,b,c){return 0<=this.lq(a.x,a.y,b,c)};c.prototype.Ti=function(a,b,c){return 0<=this.lq(a,b,c,!0)};c.prototype.ot=function(a,b){return this.fv(a,
b,!1)};c.prototype.pJ=function(){if(this.oa<this.ra||this.oa==this.ra&&this.sa<this.ua){var a=this.ua;this.ua=this.sa;this.sa=a;a=this.ra;this.ra=this.oa;this.oa=a;for(var a=0,b=this.description.Er-2;a<b;a++){var c=this.ka[a];this.ka[a]=this.ka[a+b];this.ka[a+b]=c}}};c.prototype.jv=function(b,c){b=a.b.pa(b,c);b.sub(this.ec());c=new a.b;c.xc(this.Ac(),this.ec());var d=c.Vi(b);b=8.881784197001252E-16*(Math.abs(c.x*b.y)+Math.abs(c.y*b.x));return d>b?-1:d<-b?1:0};c.prototype.lq=function(b,c,d,e){var f=
this.ua,h=this.ra,g=b-f,p=c-h,g=Math.sqrt(g*g+p*p);if(g<=Math.max(d,6.661338147750939E-16*g))return e&&0==g?NaN:0;g=b-this.sa;p=c-this.oa;g=Math.sqrt(g*g+p*p);if(g<=Math.max(d,6.661338147750939E-16*g))return e&&0==g?NaN:1;g=this.sa-this.ua;p=this.oa-this.ra;e=Math.sqrt(g*g+p*p);if(0<e){var n=1/e,g=g*n,p=p*n,y=b-f,D=c-h,k=y*g+D*p,w=1.7763568394002505E-15*(Math.abs(y*g)+Math.abs(D*p)),l=g,g=-p,p=l,w=Math.max(d,w);if(k<-w||k>e+w)return NaN;if(Math.abs(y*g+D*p)<=Math.max(d,1.7763568394002505E-15*(Math.abs(y*
g)+Math.abs(D*p)))&&(g=a.J.tk(k*n,0,1),.5>=g?(p=this.ua+(this.sa-this.ua)*g,e=this.ra+(this.oa-this.ra)*g):(p=this.sa-(this.sa-this.ua)*(1-g),e=this.oa-(this.oa-this.ra)*(1-g)),a.b.wz(p,e,b,c)<=d)){if(.5>g){if(a.b.wz(p,e,f,h)<=d)return 0}else if(a.b.wz(p,e,this.sa,this.oa)<=d)return 1;return g}}return NaN};c.prototype.Eb=function(a){return null==a?!1:a==this?!0:a.constructor!==this.constructor?!1:this.hO(a)};c.prototype.LE=function(b,c,d){var e=d?this.ua:this.sa;d=d?this.ra:this.oa;var f=new a.b;
f.x=b.sa-e;f.y=b.oa-d;return c.pi(f)>6.661338147750939E-16*c.CE(f)?(f.x=b.ua-e,f.y=b.ra-d,c.pi(f)<=6.661338147750939E-16*c.CE(f)):!0};c.prototype.KE=function(b){var c=new a.b;c.x=this.sa-this.ua;c.y=this.oa-this.ra;if(!this.LE(b,c,!1))return!1;c.Kr();return this.LE(b,c,!0)?!0:!1};c.dc=function(a,b){var c=a.jv(b.ua,b.ra),d=a.jv(b.sa,b.oa);if(0>c&&0>d||0<c&&0<d)return!1;c=b.jv(a.ua,a.ra);d=b.jv(a.sa,a.oa);if(0>c&&0>d||0<c&&0<d)return!1;c=a.Rb();d=b.Rb();return c>d?a.KE(b):b.KE(a)};c.tb=function(b,c,
d){var e=a.b.pa(NaN,NaN),f=b.sa-b.ua,h=b.oa-b.ra,g=c.sa-c.ua,p=c.oa-c.ra,n=g*h-f*p;if(0==n)return e;var y=8.881784197001252E-16*(Math.abs(g*h)+Math.abs(f*p)),k=c.ua-b.ua,w=c.ra-b.ra,l=g*w-k*p,m=l/n,q=Math.abs(n),g=(8.881784197001252E-16*(Math.abs(g*w)+Math.abs(k*p))*q+y*Math.abs(l))/(n*n)+2.220446049250313E-16*Math.abs(m);if(m<-g||m>1+g)return e;p=f*w-k*h;g=p/n;f=(8.881784197001252E-16*(Math.abs(f*w)+Math.abs(k*h))*q+y*Math.abs(p))/(n*n)+2.220446049250313E-16*Math.abs(g);if(g<-f||g>1+f)return e;m=
a.J.tk(m,0,1);f=a.J.tk(g,0,1);h=b.hc(m);n=c.hc(f);y=new a.b;y.xc(h,n);if(y.length()>d&&(y.add(h,n),y.scale(.5),m=b.ne(y,!1),f=c.ne(y,!1),b=b.hc(m),c=c.hc(f),b.sub(c),b.length()>d))return e;e.ja(m,f);return e};c.lO=function(a,b,d,e){var f=0;if(a.ua==b.ua&&a.ra==b.ra||a.ua==b.sa&&a.ra==b.oa)if(f++,!e)return 1;if(a.sa==b.ua&&a.oa==b.ra||a.sa==b.sa&&a.oa==b.oa){f++;if(2==f)return 2;if(!e)return 1}return b.Ti(a.ua,a.ra,d)||b.Ti(a.sa,a.oa,d)||a.Ti(b.ua,b.ra,d)||a.Ti(b.sa,b.oa,d)?1:e&&0!=f?0:0==c.dc(a,b)?
0:1};c.Cy=function(b,d,e,f,g,n){var h=0,p=b.lq(d.ua,d.ra,n,!1),y=b.lq(d.sa,d.oa,n,!1),k=d.lq(b.ua,b.ra,n,!1),D=d.lq(b.sa,b.oa,n,!1);isNaN(p)||(null!=f&&(f[h]=p),null!=g&&(g[h]=0),null!=e&&(e[h]=a.b.pa(d.ua,d.ra)),h++);isNaN(y)||(null!=f&&(f[h]=y),null!=g&&(g[h]=1),null!=e&&(e[h]=a.b.pa(d.sa,d.oa)),h++);2==h||isNaN(k)||0==p&&0==k||0==y&&1==k||(null!=f&&(f[h]=0),null!=g&&(g[h]=k),null!=e&&(e[h]=a.b.pa(b.ua,b.ra)),h++);2==h||isNaN(D)||1==p&&0==D||1==y&&1==D||(null!=f&&(f[h]=1),null!=g&&(g[h]=D),null!=
e&&(e[h]=a.b.pa(d.sa,d.oa)),h++);if(0<h)return 2==h&&null!=f&&f[0]>f[1]&&(b=f[0],f[0]=f[1],f[1]=b,null!=g&&(f=g[0],g[0]=g[1],g[1]=f),null!=e&&(g=a.b.pa(e[0].x,e[0].y),e[0]=e[1],e[1]=g)),h;h=c.tb(b,d,n);if(isNaN(h.x))return 0;null!=e&&(e[0]=b.hc(h.x));null!=f&&(f[0]=h.x);null!=g&&(g[0]=h.y);return 1};c.prototype.hH=function(){return 0};c.prototype.iq=function(){};c.prototype.toString=function(){return"Line: ["+this.ua.toString()+", "+this.ra.toString()+", "+this.sa.toString()+", "+this.oa.toString()+
"]"};return c}(a.iE);a.Hb=b})(C||(C={}));(function(a){var b=function(){function a(){this.fm=[];this.Ca=-1}a.prototype.Ia=function(){return this.Ca};a.prototype.next=function(){if(null!=this.fm&&0!=this.fm.length){this.Ca++;var a=this.fm[0];1>=this.fm.length?this.fm=[]:this.fm=this.fm.slice(1);return a}return this.fm=null};a.prototype.wY=function(a){this.fm.push(a)};a.prototype.Oe=function(){return!0};return a}();a.wM=b})(C||(C={}));(function(a){(function(a){a[a.enumFillRuleOddEven=0]="enumFillRuleOddEven";
a[a.enumFillRuleWinding=1]="enumFillRuleWinding"})(a.kN||(a.kN={}));var b=function(b){function c(c,d){var e=b.call(this)||this;e.Yf=!1;e.ur=null;e.hr=0;e.gr=0;e.cj=null;e.gh=!1;e.kb=null;e.jb=null;e.$e=null;e.uj=null;e.Vd=null;e.ir=0;e.Ta=0;e.mr=0;if(void 0===d)e.Yf=c,e.gh=!1,e.ir=0,e.hr=0,e.gr=0,e.qa=0,e.description=a.we.Hg();else{if(null==d)throw a.g.F();e.Yf=c;e.gh=!1;e.ir=0;e.hr=0;e.gr=0;e.qa=0;e.description=d}e.cj=null;e.Ta=0;return e}ca(c,b);c.prototype.on=function(){return 0<this.ir};c.prototype.By=
function(){this.zc();null==this.ur?this.ur=new a.Wa(this.description):this.ur.Eg(this.description)};c.prototype.$x=function(b,c){var d=new a.b;d.x=b;d.y=c;this.Bu(d)};c.prototype.Bu=function(a){this.By();this.ur.rb(a);this.gh=!0};c.prototype.Of=function(b){if(b.u())throw a.g.F();this.tm(b.description);this.By();b.copyTo(this.ur);this.gh=!0};c.prototype.xy=function(){var b=1;this.gh&&(this.By(),null==this.kb?(this.kb=a.Tc.wh(2),this.kb.write(0,0),this.jb=a.Tc.vq(2,0)):(this.kb.resize(this.kb.size+
1,0),this.jb.resize(this.jb.size+1,0)),this.Yf&&this.jb.write(this.jb.size-2,1),b++);var c=this.qa;this.kb.write(this.kb.size-1,this.qa+b);this.El(c+b);this.jb.write(this.kb.size-1,0);this.gh&&(this.xu(c,this.ur),this.gh=!1)};c.prototype.ak=function(a,b){this.xy();this.rb(this.qa-1,a,b)};c.prototype.bj=function(a){this.xy();this.rb(this.qa-1,a)};c.prototype.lineTo=function(a){this.xy();this.xu(this.qa-1,a)};c.prototype.SV=function(b){this.zc();if(this.Yf)throw a.g.za();var c=this.aa();if(b>c)throw a.g.za();
if(this.Qb(b)){if(null==this.jb)throw a.g.za();var d=this.qa,e=this.wa(b),f=this.Fc(b);this.El(this.qa+1);this.vc();for(var h=0,g=this.description.Ga;h<g;h++)if(null!=this.ya[h]){var n=a.ma.Xa(this.description.Qd(h));this.ya[h].Tk(n*f,this.ya[h],n*e,n,!0,1,n*d)}for(;c>b;c--)d=this.kb.read(c),this.kb.write(c,d+1);this.jb.dz(b,1)}};c.prototype.sq=function(){var a;this.Eu();void 0===a&&(this.gh=!1,a=this.aa()-1);var b=this.jb.read(a);this.jb.write(a,b|1);null!=this.$e&&(a=this.Fc(a)-1,this.$e.write(a,
1),this.uj.write(a,-1))};c.tb=function(a){return c.N[a]};c.prototype.Qb=function(a){return 0!=(this.jb.read(a)&1)};c.prototype.Ko=function(a){if(this.Qb(a))return!0;var b=this.wa(a);a=this.Fc(a)-1;if(b>a)return!1;b=this.Ba(b);a=this.Ba(a);return b.vb(a)};c.prototype.ht=function(a){return 0!=(this.jb.read(a)&2)};c.prototype.cc=function(b,c){this.tm(b.description);if(322==b.G()){var d=new a.Wa;if(c||this.u())b.Kp(d),this.Of(d);b.Ip(d);this.lineTo(d)}else throw a.g.za();};c.prototype.oq=function(a){var b=
0==this.qa;this.$x(a.o,a.A);this.ak(a.o,a.B);this.ak(a.v,a.B);this.ak(a.v,a.A);this.sq();this.gh=!1;b&&this.kg(256,!1)};c.prototype.hd=function(b,c){if(!b.u()){for(var d=0==this.qa,e=new a.Wa(this.description),f=0;4>f;f++)b.gg(c?4-f-1:f,e),0==f?this.Of(e):this.lineTo(e);this.sq();this.gh=!1;d&&!c&&this.kg(256,!1)}};c.prototype.add=function(a,b){for(var c=0;c<a.aa();c++)this.Ui(a,c,!b)};c.prototype.Ui=function(a,b,c){this.Vf(-1,a,b,c)};c.prototype.Gl=function(a,b){this.uA(a,b)};c.prototype.zs=function(b,
c,d,e,f){f||0!=this.aa()||(f=!0);0>c&&(c=b.aa()-1);if(c>=b.aa()||0>d||0>e||e>b.ew(c))throw a.g.X("index out of bounds");if(0!=e){var h=b.Qb(c)&&d+e==b.ew(c);if(!h||1!=e){this.gh=!1;this.tm(b.description);d=b.wa(c)+d+1;f&&(e++,d--);h&&e--;h=this.qa;this.El(this.qa+e);this.vc();if(f){if(0==e)return;this.kb.add(this.qa);f=b.jb.read(c);f&=-5;this.Yf&&(f|=1);this.jb.write(this.jb.size-1,f);this.jb.add(0)}else this.kb.write(this.jb.size-1,this.qa);f=0;for(var g=this.description.Ga;f<g;f++){var p=this.description.pd(f),
n=a.ma.Xa(p),y=b.description.lg(p);0>y||null==b.ya[y]?this.ya[f].Zj(n*h,a.ma.be(p),e*n,n*h):this.ya[f].Tk(n*h,b.ya[y],n*d,e*n,!0,n,n*h)}if(this.on())throw a.g.za();if(b.ht(c))throw a.g.za();this.Cc(1993)}}};c.prototype.TJ=function(){for(var a=0,b=this.aa();a<b;a++)this.fX(a)};c.prototype.fX=function(b){this.vc();if(b>=this.aa())throw a.g.F();var c=this.wa(b),d=this.La(b);b=this.Qb(b)?1:0;for(var e=0,f=this.description.Ga;e<f;e++)if(null!=this.ya[e]){var h=a.ma.Xa(this.description.Qd(e));this.ya[e].Xd(h*
(c+b),h*(d-b),h)}this.Cc(1993)};c.prototype.Qr=function(b){this.vc();var c=this.aa();0>b&&(b=c-1);if(b>=c)throw a.g.F();for(var d=this.wa(b),e=this.La(b),f=0,h=this.description.Ga;f<h;f++)if(null!=this.ya[f]){var g=a.ma.Xa(this.description.Qd(f));this.ya[f].Hk(g*d,g*e,g*this.qa)}for(d=b+1;d<=c;d++)f=this.kb.read(d),this.kb.write(d-1,f-e);if(null==this.jb)for(d=b+1;d<=c;d++)b=this.jb.read(d),this.jb.write(d-1,b);this.kb.resize(c);this.jb.resize(c);this.qa-=e;this.kh-=e;this.Cc(1993)};c.prototype.Vf=
function(b,c,d,e){if(c==this)throw a.g.F();if(d>=c.aa())throw a.g.F();var f=this.aa();if(b>f)throw a.g.F();0>b&&(b=f);0>d&&(d=c.aa()-1);this.gh=!1;this.tm(c.description);c.vc();var h=c.wa(d),g=c.La(d),p=this.qa,n=c.Qb(d)&&!e?1:0;this.El(this.qa+g);this.vc();for(var y=b<f?this.wa(b):p,k=0,D=this.description.Ga;k<D;k++){var w=this.description.Qd(k),l=c.description.lg(w),m=a.ma.Xa(w);0<=l&&null!=c.ya[l]?(0!=n&&this.ya[k].Tk(y*m,c.ya[l],m*h,m,!0,m,m*p),this.ya[k].Tk((y+n)*m,c.ya[l],m*(h+n),m*(g-n),e,
m,m*(p+n))):this.ya[k].Zj(y*m,a.ma.be(w),m*g,m*p)}this.kb.add(p+g);for(e=f;e>=b+1;e--)h=this.kb.read(e-1),this.kb.write(e,h+g);c.ht(d);this.jb.add(0);for(e=f-1;e>=b+1;e--)f=this.jb.read(e),f&=-5,this.jb.write(e+1,f);f=c.cT().read(d);f&=-5;this.Yf&&(f|=1);this.jb.write(b,f)};c.prototype.uA=function(b,c){var d=-1,e=this.aa();if(d>e)throw a.g.F();0>d&&(d=e);this.gh=!1;var f=this.qa;this.El(this.qa+c);this.vc();var h=d<e?this.wa(d):f;null!=b?this.ya[0].Sq(2*h,b,0,c,!0,2*f):(b=a.ma.be(0),this.ya[0].Zj(2*
h,b,2*c,2*f));for(var g=1,p=this.description.Ga;g<p;g++){b=this.description.pd(g);var n=a.ma.Xa(b);b=a.ma.be(b);this.ya[g].Zj(h*n,b,n*c,n*f)}this.kb.add(this.qa);for(f=e;f>=d+1;f--)h=this.kb.read(f-1),this.kb.write(f,h+c);this.jb.add(0);for(f=e-1;f>=d+1;f--)e=this.jb.read(f),e&=-5,this.jb.write(f+1,e);this.Yf&&this.jb.write(d,1)};c.prototype.sH=function(b,c,d){var e=-1;0>b&&(b=this.aa());if(b>this.aa()||e>this.La(b)||d>c.length)throw a.g.X("index out of bounds");if(0!=d){b==this.aa()&&(this.kb.add(this.qa),
this.Yf?this.jb.add(1):this.jb.add(0));0>e&&(e=this.La(b));this.vc();var f=this.qa;this.El(this.qa+d);this.vc();for(var h=0,g=this.description.Ga;h<g;h++){var p=this.description.Qd(h),n=a.ma.Xa(p);this.ya[h].no(n*(this.wa(b)+e+d),(f-this.wa(b)-e)*n,this.ya[h],n*(this.wa(b)+e),!0,n);0==h?this.ya[h].js(n*(this.wa(b)+e),d,c,0,!0):this.ya[h].$h(a.ma.be(p),(this.wa(b)+e)*n,d*n)}this.on()&&(this.$e.no(this.wa(b)+e+d,f-this.wa(b)-e,this.$e,this.wa(b)+e,!0,1),this.uj.no(this.wa(b)+e+d,f-this.wa(b)-e,this.uj,
this.wa(b)+e,!0,1),this.$e.$h(1,this.wa(b)+e,d),this.uj.$h(-1,this.wa(b)+e,d));b+=1;for(c=this.aa();b<=c;b++)this.kb.write(b,this.kb.read(b)+d)}};c.prototype.Wf=function(b,c,d){var e=this.aa();0>b&&(b=this.aa());if(b>=e||c>this.La(b))throw a.g.X("index out of bounds");b==this.aa()&&(this.kb.add(this.qa),this.Yf?this.jb.add(1):this.jb.add(0));0>c&&(c=this.La(b));var f=this.qa;this.El(this.qa+1);this.vc();var h=this.wa(b);this.ya[0].dh(2*(h+c),d,2*f);d=1;for(var g=this.description.Ga;d<g;d++){var p=
this.description.Qd(d),n=a.ma.Xa(p);this.ya[d].Zj(n*(h+c),a.ma.be(p),n,n*f)}for(b+=1;b<=e;b++)this.kb.write(b,this.kb.read(b)+1)};c.prototype.fC=function(b,c){var d=this.aa();0>b&&(b=d-1);if(b>=d||c>=this.La(b))throw a.g.X("index out of bounds");this.vc();var e=this.wa(b);0>c&&(c=this.La(b)-1);e+=c;c=0;for(var f=this.description.Ga;c<f;c++)if(null!=this.ya[c]){var h=a.ma.Xa(this.description.Qd(c));this.ya[c].Hk(h*e,h,h*this.qa)}for(;d>=b+1;d--)e=this.kb.read(d),this.kb.write(d,e-1);this.qa--;this.kh--;
this.Cc(1993)};c.prototype.FF=function(b,c,d,e){b=this.wa(b)+c;d=this.wa(d)+e;if(d<b||0>b||d>this.D()-1)throw a.g.F();e=this.Fa();c=0;e.Tb(b);do{for(;e.Ea();){b=e.ba();if(e.Db()==d)break;b=b.Rb();c+=b}if(e.Db()==d)break}while(e.Ya());return c};c.prototype.CP=function(b,c,d){c=this.wa(b)+c;d=this.wa(b)+d;if(0>c||d>this.D()-1)throw a.g.F();var e=this.Fa();if(c>d){if(!this.Qb(b))throw a.g.F("cannot iterate across an open path");e.mC()}var f=b=0;e.Tb(c);do f+=b,b=e.ba().Rb();while(e.Db()!=d);return f};
c.prototype.Fg=function(){return a.Pi.Xm(this,null)};c.prototype.hU=function(b,c,d,e){for(var f=b;f<d-1;f++)if(this.Qb(f))throw a.g.F("cannot interpolate across closed paths");f=this.description.Ga;if(1!=f){var h=this.FF(b,c,d,e);if(0!=h)for(var g=1;g<f;g++){var p=this.description.pd(g);if(2!=a.ma.Zz(p))for(var n=a.ma.Xa(p),y=0;y<n;y++)this.jU(p,b,c,d,e,h,y)}}};c.prototype.gU=function(b,c,d){var e=this.description.Ga;if(1!=e){var f=this.CP(b,c,d);if(0!=f)for(var h=1;h<e;h++){var g=this.description.pd(h);
if(2!=a.ma.Zz(g))for(var p=a.ma.Xa(g),n=0;n<p;n++)this.iU(g,b,c,d,f,n)}}};c.prototype.jU=function(b,c,d,e,f,g,n){var h=this.Fa();c=this.wa(c)+d;e=this.wa(e)+f;f=this.Wc(b,c,n);d=this.Wc(b,e,n);var p=f,y=0;h.Tb(c);do if(h.Ea()){h.ba();if(h.Db()==e)break;this.setAttribute(b,h.Db(),n,p);h.Mi();do{c=h.ba();if(h.Lk()==e)return;c=c.Rb();y+=c;p=a.Ub.Xq(f,d,y/g);h.Lo()||this.setAttribute(b,h.Lk(),n,p)}while(h.Ea())}while(h.Ya())};c.prototype.iU=function(b,c,d,e,f,g){var h=this.Fa(),p=this.wa(c)+d;c=this.wa(c)+
e;if(c!=p){e=this.Wc(b,p,g);d=this.Wc(b,c,g);var n=0;h.Tb(p);h.mC();p=e;do{var y=h.ba();this.setAttribute(b,h.Db(),g,p);p=y.Rb();n+=p;p=a.Ub.Xq(e,d,n/f)}while(h.Lk()!=c)}};c.prototype.Oa=function(){this.ir=0;this.gh=!1;this.Vd=this.$e=this.uj=this.jb=this.kb=null;this.PE()};c.prototype.Vc=function(b){b instanceof a.Gd?this.mF(b,-1):this.VO(b)};c.prototype.mF=function(b,c){if(!this.u()&&!b.No()){this.vc();var d=this.ya[0],e=new a.b,f=new a.b,h,g,p;for(0>c?(h=this.on(),g=0,p=this.qa):(h=this.ht(c),
g=this.wa(c),p=this.Fc(c));g<p;g++){e.x=d.read(2*g);e.y=d.read(2*g+1);if(h&&(c=this.uj.read(g),0<=c))switch(this.$e.read(g)&7){case 2:f.x=this.Vd.read(c);f.y=this.Vd.read(c+1);b.ai(f,f);this.Vd.write(c,f.x);this.Vd.write(c+1,f.y);f.x=this.Vd.read(c+3);f.y=this.Vd.read(c+4);b.ai(f,f);this.Vd.write(c+3,f.x);this.Vd.write(c+4,f.y);break;case 4:throw a.g.za();}b.ai(e,e);d.write(2*g,e.x);d.write(2*g+1,e.y)}this.Cc(1993)}};c.prototype.VO=function(b){if(!this.u()){this.Rd(1);this.vc();for(var c=this.ya[0],
d=this.ya[1],e=new a.od,f=new a.od,h=this.on(),g=0;g<this.qa;g++){e.x=c.read(2*g);e.y=c.read(2*g+1);e.z=d.read(g);if(h){var n=this.uj.read(g);if(0<=n)switch(this.$e.read(g)&7){case 2:f.x=this.Vd.read(n);f.y=this.Vd.read(n+1);f.z=this.Vd.read(n+2);f=b.Yp(f);this.Vd.write(n,f.x);this.Vd.write(n+1,f.y);this.Vd.write(n+1,f.z);f.x=this.Vd.read(n+3);f.y=this.Vd.read(n+4);f.z=this.Vd.read(n+5);f=b.Yp(f);this.Vd.write(n+3,f.x);this.Vd.write(n+4,f.y);this.Vd.write(n+5,f.z);break;case 4:throw a.g.za();}}e=
b.Yp(e);c.write(2*g,e.x);c.write(2*g+1,e.y);d.write(g,e.z)}this.Cc(1993)}};c.prototype.My=function(){null==this.kb&&(this.kb=a.Tc.wh(1,0),this.jb=a.Tc.vq(1,0));null!=this.$e&&(this.$e.resize(this.kh,1),this.uj.resize(this.kh,-1))};c.prototype.iq=function(b){b.gh=!1;b.ir=this.ir;b.mr=this.mr;null!=this.kb?b.kb=a.ha.Dk(this.kb):b.kb=null;null!=this.jb?b.jb=a.Km.Dk(this.jb):b.jb=null;null!=this.uj?b.uj=a.ha.Dk(this.uj):b.uj=null;null!=this.$e?b.$e=a.Km.Dk(this.$e):b.$e=null;null!=this.Vd?b.Vd=a.Pd.Dk(this.Vd):
b.Vd=null;b.hr=this.hr;b.gr=this.gr;this.Ak(1024)?b.cj=null:b.cj=this.cj};c.prototype.Rb=function(){if(!this.Ak(512))return this.hr;for(var b=this.Fa(),c=new a.ny(0);b.Ya();)for(;b.Ea();)c.add(b.ba().Rb());this.hr=c.ln();this.kg(512,!1);return c.ln()};c.prototype.Eb=function(a){if(a==this)return!0;if(!(a instanceof c&&b.prototype.Eb.call(this,a)))return!1;var d=this.aa();return d!=a.aa()||null!=this.kb&&!this.kb.Eb(a.kb,0,d+1)||this.mr!=a.mr||null!=this.jb&&!this.jb.Eb(a.jb,0,d)?!1:b.prototype.Eb.call(this,
a)};c.prototype.Fa=function(){return new a.xN(this)};c.prototype.Ly=function(a){b.prototype.Ly.call(this,a);if(this.on())for(a=this.Fa();a.Ya();)for(;a.Ea();)break};c.prototype.Bo=function(a,c){b.prototype.Bo.call(this,a,c);if(this.on())for(a=this.Fa();a.Ya();)for(;a.Ea();)break};c.prototype.Ey=function(){null==this.kb||0==this.kb.size?this.qa=0:this.qa=this.kb.read(this.kb.size-1)};c.prototype.ef=function(){if(!this.Yf)return 0;this.lv();return this.gr};c.prototype.rw=function(a){if(!this.Yf)return!1;
if(!this.Ak(8))return 0!=(this.jb.read(a)&4);this.lv();return 0<this.cj.read(a)};c.prototype.Ym=function(a){if(!this.Yf)return 0;this.lv();return this.cj.read(a)};c.prototype.lv=function(){if(this.Ak(1024)){var b=this.aa();null==this.cj?this.cj=new a.Pd(b):this.cj.size!=b&&this.cj.resize(b);for(var b=new a.ny(0),c=new a.ny(0),d=new a.b,e=0,f=this.Fa();f.Ya();){c.reset();for(this.w(this.wa(f.Ta),d);f.Ea();)c.add(f.ba().yy(d.x,d.y));b.add(c.ln());var g=e++;this.cj.write(g,c.ln())}this.gr=b.ln();this.kg(1024,
!1)}};c.prototype.ZS=function(){if(this.Yf){this.Fl();for(var a=0,b=this.aa(),c=0;c<b;c++)0!=(this.jb.read(c)&4)&&a++}};c.prototype.Fl=function(){if(this.Ak(8)){this.lv();var b=this.aa();if(null==this.jb||this.jb.size<b)this.jb=a.Tc.vq(b+1);for(var c=1,d=0;d<b;d++){var e=this.cj.read(d);0==d&&(c=0<e?1:-1);0<e*c?this.jb.lC(d,4):this.jb.dz(d,4)}this.kg(8,!1)}};c.prototype.cw=function(b){var c=this.Ta,d=this.aa();if(0<=c&&c<d){if(b<this.Fc(c)){if(b>=this.wa(c))return c;c--}else c++;if(0<=c&&c<d&&b>=
this.wa(c)&&b<this.Fc(c))return this.Ta=c}if(5>d){for(c=0;c<d;c++)if(b<this.Fc(c))return this.Ta=c;throw a.g.X("corrupted geometry");}c=0;for(--d;d>c;){var e=c+(d-c>>1),f=this.wa(e);if(b<f)d=e-1;else if(c=this.Fc(e),b>=c)c=e+1;else return this.Ta=e}return this.Ta=c};c.prototype.NS=function(b){var c=this.Qa(0);this.dT();var d=this.Fc(b),e=this.wa(b);b=-1;var f=new a.b,h=new a.b;f.y=-Infinity;f.x=-Infinity;for(e+=0;e<d;e++)c.fc(2*e,h),-1==f.compare(h)&&(b=e,f.L(h));return b};c.prototype.lA=function(){var a=
this.D();if(!this.Yf)for(var a=a-this.aa(),b=0,c=this.aa();b<c;b++)this.Qb(b)&&a++;return a};c.prototype.ew=function(a){var b=this.La(a);this.Qb(a)||b--;return b};c.prototype.Ka=function(){return new c(this.Yf,this.description)};c.prototype.ub=function(){return this.Yf?2:1};c.prototype.G=function(){return this.Yf?1736:1607};c.prototype.dT=function(){this.Eu()};c.prototype.vK=function(a){this.kb=a;this.Cc(16777215)};c.prototype.oT=function(){this.Eu();return this.$e};c.prototype.cT=function(){this.Eu();
return this.jb};c.prototype.uK=function(a){this.jb=a;this.Cc(16777215)};c.prototype.aa=function(){return null!=this.kb?this.kb.size-1:0};c.prototype.Fc=function(a){return this.kb.read(a+1)};c.prototype.La=function(a){return this.kb.read(a+1)-this.kb.read(a)};c.prototype.wa=function(a){return this.kb.read(a)};c.prototype.bv=function(b,c){null==this.ob&&(this.ob=new a.yl);c=a.ty.PW(c);var d=this.ob.Ii;if(null!=d)if(d.ll<b||c>d.kT())this.ob.Iy(null);else return!0;d=a.ty.create(this,b,c);this.ob.Iy(d);
return!0};c.prototype.kc=function(){var a=b.prototype.kc.call(this);if(!this.Gc()){var c=this.aa();null!=this.kb&&this.kb.Ck(a,0,c+1);null!=this.jb&&this.jb.Ck(a,0,c)}return a};c.prototype.aH=function(a){return null!=this.$e?this.$e.read(a):1};c.prototype.jc=function(b,c,d){var e=this.cw(b);if(b==this.Fc(e)-1&&!this.Qb(e))throw a.g.X("index out of bounds");this.vc();var f=this.$e,h=1;null!=f&&(h=f.read(b)&7);switch(h){case 1:c.Hs();break;case 2:throw a.g.za();case 4:throw a.g.za();default:throw a.g.za();
}c=c.get();d?c.Eg(a.we.Hg()):c.Eg(this.description);e=b==this.Fc(e)-1&&this.Qb(e)?this.wa(e):b+1;f=new a.b;this.w(b,f);c.Lc(f);this.w(e,f);c.Xc(f);if(!d)for(d=1,f=this.description.Ga;d<f;d++)for(var h=this.description.Qd(d),g=a.ma.Xa(h),p=0;p<g;p++){var n=this.Wc(h,b,p);c.Tx(h,p,n);n=this.Wc(h,e,p);c.Lx(h,p,n)}};c.prototype.nk=function(b,c){if(b>=this.aa())throw a.g.F();if(this.u())c.Oa();else{if(this.ht(b))throw a.g.X("not implemented");var d=this.Qa(0),e=new a.b,f=new a.h;f.Oa();var h=this.wa(b);
for(b=this.Fc(b);h<b;h++)d.fc(2*h,e),f.Nb(e);c.I(f)}};c.prototype.MW=function(b,c){if(b>=this.aa())throw a.g.F();if(this.u())c.Oa();else{if(this.ht(b))throw a.g.X("not implemented");var d=this.Qa(0),e=new a.b,f=new a.h;f.Oa();var h=this.wa(b);for(b=this.Fc(b);h<b;h++)d.fc(2*h,e),f.Nb(e);c.I(f)}};c.prototype.Kj=function(b){null==this.ob&&(this.ob=new a.yl);if(0==b||16>this.D())return!1;b=a.na.BF(this);this.ob.QE(b);return!0};c.prototype.WN=function(){null==this.ob&&(this.ob=new a.yl);if(null!=this.ob.tp)return!0;
this.ob.RE(null);var b=a.na.xP(this);this.ob.RE(b);return!0};c.prototype.Op=function(a){this.mr=a};c.prototype.Eo=function(){return this.mr};c.prototype.WE=function(b){if(this==b)throw a.g.X("MultiPathImpl.add");for(var c=this.aa(),d=0;d<b.aa();d++)this.Ui(b,d,!0),this.SV(c),c++};c.prototype.KP=function(b){var c=this.cw(b),d=this.wa(c);if(d!=b){c=this.Fc(c);if(b>=c||b<d)throw a.g.X("change_ring_start_point");for(var e=0,f=this.description.Ga;e<f;e++){var h=this.description.pd(e),h=a.ma.Xa(h);this.ya[e].rotate(d*
h,b*h,c*h)}}};c.N=[0,0,6,0,8,0];return c}(a.Ou);a.Bl=b})(C||(C={}));(function(a){var b=function(b){function c(c){var d=b.call(this)||this;if(void 0!==c){if(null==c)throw a.g.F();d.description=c}else d.description=a.we.Hg();d.qa=0;return d}ca(c,b);c.prototype.Ka=function(){return new c(this.description)};c.prototype.add=function(a){this.resize(this.qa+1);this.Zh(this.qa-1,a)};c.prototype.qv=function(b,c){this.resize(this.qa+1);var d=new a.b;d.ja(b,c);this.rb(this.qa-1,d)};c.prototype.Hd=function(b,
c,d){d=0>d?b.D():d;if(0>c||c>b.D()||d<c)throw a.g.F();if(c!=d){this.tm(b.description);d-=c;var e=this.qa;this.resize(this.qa+d);this.vc();for(var f=0,h=b.description.Ga;f<h;f++){var g=b.description.Qd(f),p=a.ma.Xa(g),n=this.Qa(g),g=b.Qa(g);n.Tk(e*p,g,c*p,d*p,!0,1,e*p)}}};c.prototype.$E=function(b,c){var d=b.length;c=0>c?d:c;if(0>d||0>c)throw a.g.F();if(0!=c){d=c-0;c=this.qa;this.resize(this.qa+d);for(var e=0;e<d;e++)this.rb(c+e,b[0+e])}};c.prototype.fC=function(b){if(0>b||b>=this.D())throw a.g.X("index out of bounds");
this.vc();for(var c=0,d=this.description.Ga;c<d;c++)if(null!=this.ya[c]){var e=a.ma.Xa(this.description.Qd(c));this.ya[c].Hk(e*b,e,e*this.qa)}this.qa--;this.kh--;this.Cc(1993)};c.prototype.resize=function(a){this.El(a)};c.prototype.iq=function(){};c.prototype.Oa=function(){b.prototype.PE.call(this)};c.prototype.Vc=function(b){if(b instanceof a.Gd){if(!this.u()){this.vc();for(var c=this.ya[0],d=new a.b,e=0;e<this.qa;e++)d.x=c.read(2*e),d.y=c.read(2*e+1),b.ai(d,d),c.write(2*e,d.x),c.write(2*e+1,d.y);
this.Cc(1993)}}else if(!this.u()){this.vc();this.Rd(1);this.vc();for(var c=this.ya[0],d=this.ya[1],f=new a.od,e=0;e<this.qa;e++){f.x=c.read(2*e);f.y=c.read(2*e+1);f.z=d.read(e);var h=b.Yp(f);c.write(2*e,h.x);c.write(2*e+1,h.y);d.write(e,h.z)}this.Cc(1993)}};c.prototype.ub=function(){return 0};c.prototype.G=function(){return 550};c.prototype.ef=function(){return 0};c.prototype.Rb=function(){return 0};c.prototype.Eb=function(a){return a==this?!0:a instanceof c?b.prototype.Eb.call(this,a):!1};c.prototype.KO=
function(b){var c=b.length,d=c;if(0>c||0>c||0>d)throw a.g.F();this.Rd(1);if(0!=d){c=d-0;d=this.qa;this.PJ(this.qa+c);for(var e=this.Qa(0),f=0;f<c;f++){var h=b[0+f].y;e.write(2*(d+f),b[0+f].x);e.write(2*(d+f)+1,h)}e=this.Qa(1);for(f=0;f<c;f++)e.write(d+f,b[0+f].z);this.Cc(1993)}};c.prototype.LO=function(b,c){var d=b.length;c=0>c?d:c;if(0>d||0>c)throw a.g.F();if(0!=c){d=c-0;if(0!=(d&1))throw a.g.F();c=this.qa;this.PJ(this.qa+d/2);this.ya[0].hs(2*c,d,b,0,!0)}};c.prototype.PJ=function(b){var c=this.qa;
this.El(b);if(this.qa>c){b=1;for(var d=this.description.Ga;b<d;b++){var e=this.description.pd(b),f=a.ma.Xa(e);this.ya[b].Zj(f*c,a.ma.be(e),f*(this.qa-c),f*c)}}};c.prototype.JW=function(b,c){var d=this.qa,d=Math.min(d,c+1E3);if(0>c||c>=this.qa||d<c||1E3!=b.length)throw a.g.F();var e=this.Qa(0),f=d-c,h=[];e.rl(2*c,2*f,h,0,!0);for(e=0;e<f;e++)b[e]=a.b.pa(h[2*e],h[2*e+1]);return d};c.prototype.KW=function(b,c){var d=this.qa,d=Math.min(d,0+c);if(0>=this.qa||0>d||b.length!=c)throw a.g.F();c=this.Qa(0);
var e=null,f=a.ma.be(1),h=this.hasAttribute(1);h&&(e=this.Qa(1));var d=d-0,g=[],p=[];c.rl(0,2*d,g,0,!0);e.rl(0,d,p,0,!0);for(c=0;c<d;c++)b[c]=new a.od(g[2*c],g[2*c+1],h?p[c]:f)};c.prototype.Ey=function(){};c.prototype.My=function(){};c.prototype.bv=function(){return!1};c.prototype.Kj=function(){return!1};c.prototype.Fg=function(){return null};return c}(a.Ou);a.Dd=b})(C||(C={}));(function(a){(function(a){a[a.NotDetermined=0]="NotDetermined";a[a.Structure=1]="Structure";a[a.DegenerateSegments=2]="DegenerateSegments";
a[a.Clustering=3]="Clustering";a[a.Cracking=4]="Cracking";a[a.CrossOver=5]="CrossOver";a[a.RingOrientation=6]="RingOrientation";a[a.RingOrder=7]="RingOrder";a[a.OGCPolylineSelfTangency=8]="OGCPolylineSelfTangency";a[a.OGCPolygonSelfTangency=9]="OGCPolygonSelfTangency";a[a.OGCDisconnectedInterior=10]="OGCDisconnectedInterior"})(a.BM||(a.BM={}));var b=function(){function a(a,b,c){void 0===a?(this.Ji=0,this.rm=this.qm=-1):(this.Ji=a,this.qm=b,this.rm=c)}a.prototype.ls=function(a){this.Ji=a.Ji;this.qm=
a.qm;this.rm=a.rm};return a}();a.Yd=b})(C||(C={}));(function(a){var b=function(){function b(){}b.XZ=function(b){if(!1===b)throw a.g.yL();};b.GK=function(a){return isNaN(a)?NaN:0===a?a:0<a?1:-1};b.vv=function(a){var c;void 0===c&&(c=0);for(var d=[],e=0;e<a;e++)d[e]=b.df(2,c);return d};b.df=function(a,b){void 0===b&&(b=0);for(var c=[],d=0;d<a;d++)c[d]=b;return c};b.Ov=function(a,b){var c,d;void 0===c&&(c=0);for(void 0===d&&(d=a.length-1);c<=d;c++)a[c]=b};b.tk=function(a,b,c){return a<b?b:a>c?c:a};b.y_=
function(){return 4};b.bh=function(a,b){var c=5381;void 0!==b?c=(b<<5)+b+(a&255):c=(c<<5)+c+(a&255);c=(c<<5)+c+(a>>8&255);c=(c<<5)+c+(a>>16&255);return(c<<5)+c+(a>>24&255)&2147483647};b.$i=function(){throw Error("Not Implemented");};b.q_=function(){return-Infinity};b.v_=function(){return Infinity};b.e_=function(){return 2147483647};b.UZ=function(){return 2.220446049250313E-16};b.cZ=function(){return 1.7976931348623157E308};b.KB=function(a){return b.LN(a)+12345&2147483647};b.UH=function(a){var c=32,
d=a%b.qz|0,e=a/b.qz|0;if(0===(c&=63))return a;32>c?(a=d>>>c|e<<32-c,c=e>>c):(a=e>>c-32,c=0<=e?0:-1);return c*b.qz+(a>>>0)};b.LN=function(a){a|=0;return(1103495168*a|0)+(20077*a|0)|0};b.truncate=function(a){return 0>a?-1*Math.floor(Math.abs(a)):Math.floor(a)};b.zM=Math.pow(2,53)-1;b.WZ=-b.zM;b.eD=65536;b.sZ=16777216;b.qz=b.eD*b.eD;return b}();a.J=b})(C||(C={}));(function(a){(function(a){a[a.Project=0]="Project";a[a.Union=1]="Union";a[a.Difference=2]="Difference";a[a.Proximity2D=3]="Proximity2D";a[a.Relate=
4]="Relate";a[a.Equals=5]="Equals";a[a.Disjoint=6]="Disjoint";a[a.Intersects=7]="Intersects";a[a.Within=8]="Within";a[a.Contains=9]="Contains";a[a.Crosses=10]="Crosses";a[a.Touches=11]="Touches";a[a.Overlaps=12]="Overlaps";a[a.Buffer=13]="Buffer";a[a.Distance=14]="Distance";a[a.Intersection=15]="Intersection";a[a.Clip=16]="Clip";a[a.Cut=17]="Cut";a[a.DensifyByLength=18]="DensifyByLength";a[a.DensifyByAngle=19]="DensifyByAngle";a[a.LabelPoint=20]="LabelPoint";a[a.GeodesicBuffer=21]="GeodesicBuffer";
a[a.GeodeticDensifyByLength=22]="GeodeticDensifyByLength";a[a.ShapePreservingDensify=23]="ShapePreservingDensify";a[a.GeodeticLength=24]="GeodeticLength";a[a.GeodeticArea=25]="GeodeticArea";a[a.Simplify=26]="Simplify";a[a.SimplifyOGC=27]="SimplifyOGC";a[a.Offset=28]="Offset";a[a.Generalize=29]="Generalize";a[a.SymmetricDifference=30]="SymmetricDifference";a[a.ConvexHull=31]="ConvexHull";a[a.Boundary=32]="Boundary";a[a.SimpleRelation=33]="SimpleRelation"})(a.WM||(a.WM={}));var b=function(){function b(){}
b.prototype.G=function(){return null};b.prototype.xo=function(){return!1};b.prototype.Av=function(){return!1};b.RZ=function(b){a.T.fh(b.G())&&(b=b.ob,null!=b&&(b.Iy(null),b.QE(null)))};return b}();a.bf=b})(C||(C={}));(function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}ca(c,b);c.prototype.G=function(){return 13};c.local=function(){null===c.N&&(c.N=new c);return c.N};c.prototype.V=function(b,c,d,e,f){return b instanceof a.T?(f=new a.gd(b),this.V(f,c,[d],!1,e).next()):
!0===e?(d=new a.KD(b,c,d,!1,f),a.ei.local().V(d,c,f)):new a.KD(b,c,d,!1,f)};c.N=null;return c}(a.bf);a.JD=b})(C||(C={}));(function(a){var b=function(){function b(b,c,d,e,f){this.Ca=-1;this.ge=b;this.LA=c;this.At=d;this.XU=new a.h;this.XU.Oa();this.Zo=-1;this.mc=f}b.prototype.next=function(){for(var a;null!=(a=this.ge.next());)return this.Ca=this.ge.Ia(),this.Zo+1<this.At.length&&this.Zo++,this.buffer(a,this.At[this.Zo]);return null};b.prototype.Ia=function(){return this.Ca};b.prototype.buffer=function(b,
c){return a.EL.buffer(b,c,this.LA,NaN,96,this.mc)};b.prototype.Oe=function(){return!0};return b}();a.KD=b})(C||(C={}));(function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}ca(c,b);c.prototype.G=function(){return 16};c.local=function(){null===c.N&&(c.N=new c);return c.N};c.prototype.V=function(b,c,d,e){return b instanceof a.T?(b=new a.gd(b),this.V(b,c,d,e).next()):new a.GM(b,c,d,e)};c.N=null;return c}(a.bf);a.FM=b})(C||(C={}));(function(a){var b=function(){function b(b,
c,d){this.Ca=-1;if(null==b)throw a.g.F();this.$=c;this.bl=b;this.ta=a.na.$d(d,c,!1)}b.prototype.next=function(){var b;return null!=(b=this.bl.next())?(this.Ca=this.bl.Ia(),a.le.clip(b,this.$,this.ta,0)):null};b.prototype.Ia=function(){return this.Ca};b.prototype.Oe=function(){return!0};return b}();a.GM=b})(C||(C={}));(function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}ca(c,b);c.prototype.G=function(){return 31};c.local=function(){null===c.N&&(c.N=new c);return c.N};
c.prototype.V=function(b,c,d){return b instanceof a.T?a.MD.EF(b):new a.MD(c,b,d)};c.N=null;return c}(a.bf);a.LD=b})(C||(C={}));(function(a){var b=function(){function b(b,c,d){this.dB=new a.Lu;this.Ca=-1;if(null==c)throw a.g.F();this.bI=b;this.Oc=!1;this.bl=c;this.mc=d}b.prototype.next=function(){if(this.bI){if(!this.Oc){var a=this.BP(this.bl);this.Oc=!0;return a}return null}if(!this.Oc){a=this.bl.next();if(null!=a)return this.Ca=this.bl.Ia(),b.EF(a);this.Oc=!0}return null};b.prototype.Ia=function(){return this.Ca};
b.prototype.BP=function(a){for(var b;null!=(b=a.next());)this.dB.Jb(b);return this.dB.uS()};b.prototype.Oe=function(){if(this.Oc)return!0;if(!this.bI)throw a.g.X("Invalid call for non merging convex hull.");var b=this.bl.next();if(null!=b)return this.dB.Jb(b),!0;throw a.g.X("Expects a non-null geometry.");};b.EF=function(c){if(b.Xf(c))return c;var d=c.G();if(a.Bl.Nc(d))return d=new a.Ua(c.description),d.cc(c,!0),d;if(550==d&&2==c.D()){var e=new a.Wa,d=new a.Ua(c.description);c.xe(0,e);d.Of(e);c.xe(1,
e);d.lineTo(e);return d}return a.Lu.qQ(c)};b.Xf=function(b){if(b.u())return!0;var c=b.G();return 33==c||197==c?!0:a.Bl.Nc(c)?!1:550==c?1==b.D()?!0:!1:1607==c?1==b.aa()&&2>=b.D()?!0:!1:1!=b.aa()?!1:2>=b.D()?!0:a.Lu.JH(b,0)};return b}();a.MD=b})(C||(C={}));(function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}ca(c,b);c.prototype.G=function(){return 17};c.local=function(){null===c.N&&(c.N=new c);return c.N};c.prototype.V=function(b,c,d,e,f){return new a.IM(b,c,d,
e,f)};c.N=null;return c}(a.bf);a.HM=b})(C||(C={}));(function(a){var b=function(){function b(b,c,d,e,f){this.pg=null;if(null==c||null==d)throw a.g.X("invalid argument");this.UU=b;this.YA=c;this.kI=d;b=a.na.Zv(c,d);this.ta=a.na.$d(e,b,!0);this.jI=-1;this.ie=f}b.prototype.Ia=function(){return 0};b.prototype.next=function(){this.hS();return++this.jI<this.pg.length?this.pg[this.jI]:null};b.prototype.hS=function(){if(null==this.pg)switch(this.pg=[],this.YA.G()){case 1607:this.jS();break;case 1736:this.iS()}};
b.prototype.jS=function(){var b=new a.Ua,c=new a.Ua,d=new a.Ua;this.pg.push(b);this.pg.push(c);var e=[];a.KL.IL(this.UU,this.YA,this.kI,this.ta,e,this.ie);for(var f=0;f<e.length;f++){var g=e[f];0==g.nx?b.add(g.Y,!1):1==g.nx||2==g.nx?c.add(g.Y,!1):3==g.nx?this.pg.push(g.Y):d.add(g.Y,!1)}d.u()||b.u()&&c.u()&&!(3<=this.pg.length)||this.pg.push(d);b.u()&&c.u()&&3>this.pg.length&&(this.pg.length=0)};b.prototype.iS=function(){var b=new a.ha(0),c=new a.ed,d=c.gG(),e=c.Jb(this.YA),f=c.Jb(this.kI),g=new a.Cg;
try{g.Wr(c,this.ta,this.ie);g.Ml(d,e,f,b);var k=c.Pe(e),w=new a.Ja,l=new a.Ja;this.pg.length=0;this.pg.push(w);this.pg.push(l);for(e=0;e<b.size;e++){var m,q=new a.ed,r=q.Jb(k),t=q.Jb(c.Pe(b.get(e)));g.Vr(q,this.ie);var u=g.nw(r,t);m=q.Pe(u);if(!m.u()){var v=c.NG(b.get(e),d);2==v?w.add(m,!1):1==v?l.add(m,!1):this.pg.push(m);var I=new a.ed,r=I.Jb(k),t=I.Jb(c.Pe(b.get(e)));g.Vr(I,this.ie);k=I.Pe(g.an(r,t))}}!k.u()&&0<b.size&&this.pg.push(k);w.u()&&l.u()&&(this.pg.length=0)}finally{g.ph()}};b.prototype.Oe=
function(){return!0};return b}();a.IM=b})(C||(C={}));(function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}ca(c,b);c.prototype.G=function(){return 18};c.local=function(){null===c.N&&(c.N=new c);return c.N};c.prototype.V=function(b,c,d){if(b instanceof a.T)return b=new a.gd(b),this.V(b,c,d).next();if(0>=c)throw a.g.F();return new a.JM(b,c,d)};c.N=null;return c}(a.bf);a.Pm=b})(C||(C={}));(function(a){var b=function(){function b(a,b){this.Ca=-1;this.ge=a;this.Mt=
b}b.prototype.Ia=function(){return this.Ca};b.prototype.next=function(){var a;return null!=(a=this.ge.next())?(this.Ca=this.ge.Ia(),this.gR(a)):null};b.prototype.gR=function(b){if(b.u()||1>b.ub())return b;var c=b.G();if(1736==c||1607==c)return this.vz(b);if(a.T.Nc(c))return this.iR(b);if(197==c)return this.hR(b);throw a.g.za();};b.prototype.iR=function(b){if(b.Rb()<=this.Mt)return b;var c=new a.Ua(b.description);c.cc(b,!0);return this.vz(c)};b.prototype.hR=function(b){var c=new a.Ja(b.description);
c.hd(b,!1);var d=new a.h;b.s(d);b=d.ea();return d.O()<=this.Mt&&b<=this.Mt?c:this.vz(c)};b.prototype.vz=function(b){for(var c=b.Ka(),d=b.Fa();d.Ya();)for(var e=!0;d.Ea();){var f=d.ba();if(322!=f.G())throw a.g.X("not implemented");var g=d.Lo(),n=f.Rb();if(n>this.Mt){var k=Math.ceil(n/this.Mt),n=new a.Wa(b.description);e&&(f.Kp(n),c.Of(n));for(var w=e=1/k,l=0,k=k-1;l<k;l++)f.Fx(w,n),c.lineTo(n),w+=e;g?c.sq():(f.Ip(n),c.lineTo(n))}else g?c.sq():c.cc(f,e);e=!1}return c};b.prototype.Oe=function(){return!0};
return b}();a.JM=b})(C||(C={}));(function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}ca(c,b);c.local=function(){null===c.N&&(c.N=new c);return c.N};c.prototype.G=function(){return 2};c.prototype.V=function(b,c,d,e){return b instanceof a.T?(b=new a.gd(b),c=new a.gd(c),this.V(b,c,d,e).next()):new a.KM(b,c,d,e)};c.an=function(b,d,e,f){if(b.u()||d.u())return b;var g=b.ub(),h=d.ub();if(g>h)return b;var p=b.G(),n=d.G(),y=new a.h,k=new a.h,D=new a.h;b.s(y);d.s(k);D.I(y);
D.Nb(k);var D=a.na.$d(e,D,!0),w=D*Math.sqrt(2)*1.00001,l=new a.h;l.I(y);l.P(w,w);if(!l.Yb(k))return b;if(1==g&&2==h)return c.ro(b,d,n,e,f);if(33==p)switch(a.Bl.Nc(n)?(e=new a.Ua(d.description),e.cc(d,!0)):e=d,n){case 1736:return c.Mm(b,e,D);case 1607:return c.Nm(b,e,D);case 550:return c.Al(b,e,D);case 197:return c.zl(b,e,D);case 33:return c.Lm(b,e,D);default:throw a.g.F();}else if(550==p)switch(n){case 1736:return c.xl(b,d,D);case 197:return c.Hj(b,d,D);case 33:return c.wl(b,d,D)}return a.Cg.an(b,
d,e,f)};c.Mm=function(b,c,d){return 0==a.fd.KH(c,b,d)?b:b.Ka()};c.Nm=function(b,c,d){var e=b.w();c=c.Fa();for(var f=d*Math.sqrt(2)*1.00001,g=f*f,h=new a.h;c.Ya();)for(;c.Ea();){var p=c.ba();p.s(h);h.P(f,f);if(h.contains(e)){if(p.ot(e,d))return b.Ka();var n=p.ec();if(a.b.sc(e,n)<=g)return b.Ka();n=p.Ac();if(a.b.sc(e,n)<=g)return b.Ka()}}return b};c.Al=function(b,c,d){var e=c.Qa(0);c=c.D();var f=b.w(),g=new a.b;d=d*Math.sqrt(2)*1.00001;d*=d;for(var h=0;h<c;h++)if(e.fc(2*h,g),a.b.sc(g,f)<=d)return b.Ka();
return b};c.zl=function(b,c,d){var e=new a.h;c.s(e);e.P(d,d);c=b.w();return e.contains(c)?b.Ka():b};c.Lm=function(b,c,d){d=d*Math.sqrt(2)*1.00001;d*=d;var e=b.w();c=c.w();return a.b.sc(e,c)<=d?b.Ka():b};c.xl=function(b,c,d){var e=new a.h;c.s(e);e.P(d,d);for(var f=b.D(),g=!1,h=[],p=0;p<f;p++)h[p]=!1;for(var n=new a.b,p=0;p<f;p++)b.w(p,n),e.contains(n)&&0!=a.fd.ee(c,n,d)&&(g=!0,h[p]=!0);if(!g)return b;c=b.Ka();for(p=0;p<f;p++)h[p]||c.Hd(b,p,p+1);return c};c.Hj=function(b,c,d){var e=new a.h;c.s(e);e.P(d,
d);c=b.D();var f=!1;d=[];for(var g=0;g<c;g++)d[g]=!1;for(var h=new a.b,g=0;g<c;g++)b.w(g,h),e.contains(h)&&(f=!0,d[g]=!0);if(!f)return b;e=b.Ka();for(g=0;g<c;g++)d[g]||e.Hd(b,g,g+1);return e};c.wl=function(b,c,d){var e=b.Qa(0),f=b.D(),g=c.w(),h=new a.b,p=!1;c=[];for(var n=0;n<f;n++)c[n]=!1;n=d*Math.sqrt(2)*1.00001;d=n*n;for(n=0;n<f;n++)e.fc(2*n,h),a.b.sc(h,g)<=d&&(p=!0,c[n]=!0);if(!p)return b;e=b.Ka();for(n=0;n<f;n++)c[n]||e.Hd(b,n,n+1);return e};c.ro=function(b,c,d,e,f){var g=new a.di;b.Wn(g);var h=
new a.h;c.s(h);g.Nb(h);g.P(.1*g.O(),.1*g.ea());h=new a.Ja;h.hd(g,!1);1736==d?h.add(c,!0):h.hd(c,!0);return a.wk.local().V(b,h,e,f)};c.N=null;return c}(a.bf);a.eq=b})(C||(C={}));(function(a){var b=function(){function b(a,b,c,d){this.qt=null==b;this.Ca=-1;this.ge=a;this.LA=c;this.$U=b.next();this.mc=d}b.prototype.next=function(){if(this.qt)return null;var b;return null!=(b=this.ge.next())?(this.Ca=this.ge.Ia(),a.eq.an(b,this.$U,this.LA,this.mc)):null};b.prototype.Ia=function(){return this.Ca};b.prototype.Oe=
function(){return!0};return b}();a.KM=b})(C||(C={}));(function(a){var b=function(){function b(b){this.ie=b;this.ck=new a.h;this.ck.Oa();this.Kh=new a.h;this.Kh.Oa()}b.prototype.Du=function(){var a;a=this.ck.o;this.ck.o=this.Kh.o;this.Kh.o=a;a=this.ck.v;this.ck.v=this.Kh.v;this.Kh.v=a;a=this.ck.A;this.ck.A=this.Kh.A;this.Kh.A=a;a=this.ck.B;this.ck.B=this.Kh.B;this.Kh.B=a};b.prototype.wR=function(b,c){var d=!this.ck.Yb(this.Kh);if(a.T.Hc(b.G())&&a.T.Hc(c.G())){if(b.D()>c.D())return this.uF(b,c,d);this.Du();
d=this.uF(c,b,d);this.Du();return d}if(550==b.G()&&a.T.Hc(c.G()))return d=this.vF(c,b,d),this.Du(),d;if(550==c.G()&&a.T.Hc(b.G()))return this.vF(b,c,d);if(550==b.G()&&550==c.G()){if(b.D()>c.D())return this.wF(b,c);this.Du();d=this.wF(c,b);this.Du();return d}return 0};b.prototype.uF=function(b,c,d){var e=b.Fa(),f=c.Fa(),g=new a.h,h=new a.h,p=1.7976931348623157E308;if(!d&&this.VY(b,c,e,f))return 0;for(;e.Ya();)for(;e.Ea();)if(b=e.ba(),b.s(g),!(g.Zx(this.Kh)>p)){for(;f.Ya();)for(;f.Ea();)if(c=f.ba(),
c.s(h),g.Zx(h)<p&&(c=b.Cb(c,d),c*=c,c<p)){if(0==c)return 0;p=c}f.zj()}return Math.sqrt(p)};b.prototype.vF=function(b,c,d){var e=b.Fa(),f=new a.h,g=1.7976931348623157E308,h=new a.b,p,n=c.D();for(d=!d&&1736==b.G();e.Ya();)for(;e.Ea();){var y=e.ba();y.s(f);if(!(1<n&&f.Zx(this.Kh)>g)){for(var k=0;k<n;k++){c.w(k,h);if(d&&0!=a.fd.ee(b,h,0))return 0;p=y.ne(h,!1);h.sub(y.hc(p));p=h.uk();if(p<g){if(0==p)return 0;g=p}}d=!1}}return Math.sqrt(g)};b.prototype.wF=function(b,c){for(var d=1.7976931348623157E308,
e=new a.b,f=new a.b,g,h=b.D(),p=c.D(),n=0;n<h;n++)if(b.w(n,e),!(1<p&&this.Kh.NK(e)>d))for(var k=0;k<p;k++)if(c.w(k,f),g=a.b.sc(e,f),g<d){if(0==g)return 0;d=g}return Math.sqrt(d)};b.prototype.VY=function(b,c,d,e){if(1736==b.G()){for(;e.Ya();)if(e.Ea()){var f=e.ba();if(0!=a.fd.ee(b,f.Ac(),0))return!0}e.zj()}if(1736==c.G()){for(;d.Ya();)if(d.Ea()&&(b=d.ba(),0!=a.fd.ee(c,b.Ac(),0)))return!0;d.zj()}return!1};b.prototype.Xm=function(a,b){if(a.u()||b.u())return NaN;a.s(this.ck);b.s(this.Kh);return this.wR(a,
b)};return b}(),c=function(c){function d(){return null!==c&&c.apply(this,arguments)||this}ca(d,c);d.prototype.V=function(c,d,e){if(null==c||null==d)throw a.g.F();if(c.u()||d.u())return NaN;var f,g;f=c.G();g=d.G();if(33==f){if(33==g)return a.b.Cb(c.w(),d.w());if(197==g)return e=new a.h,d.s(e),e.Cb(c.w());f=new a.Dd;f.add(c);c=f}else if(197==f){if(197==g)return g=new a.h,c.s(g),e=new a.h,d.s(e),e.Cb(g);f=new a.Ja;f.hd(c,!1);c=f}33==g?(g=new a.Dd,g.add(d),d=g):197==g&&(g=new a.Ja,g.hd(d,!1),d=g);return(new b(e)).Xm(c,
d)};d.local=function(){null===d.N&&(d.N=new d);return d.N};d.prototype.G=function(){return 14};d.N=null;return d}(a.bf);a.LM=c})(C||(C={}));(function(a){var b=function(){function b(a,b,c,d){this.yI=a;this.FI=b;this.ie=d;this.ZH=c}b.prototype.next=function(){var a=this.yI.next();return null==a?null:this.rD(a)};b.prototype.Ia=function(){return this.yI.Ia()};b.prototype.rD=function(b){var c=b.G();if(a.T.Po(c))return b;if(197==c)return c=new a.Ja(b.description),c.hd(b,!1),this.rD(c);if(b.u())return b;
if(null==b)throw a.g.za();for(var c=b.Ka(),d=new a.Hb,e=0,f=b.aa();e<f;e++)this.ZL(b,e,c,d);return c};b.prototype.ZL=function(b,c,d,e){if(!(2>b.La(c))){var f=b.wa(c),g=b.Fc(c)-1,h=b.Qa(0),p=b.Qb(c),n=new a.ha(0);n.zb(b.La(c)+1);var y=new a.ha(0);y.zb(b.La(c)+1);n.add(p?f:g);n.add(f);for(f=new a.b;1<n.size;){var k=n.Ec();n.Mf();var w=n.Ec();b.w(k,f);e.Lc(f);b.w(w,f);e.Xc(f);w=this.WL(e,f,h,k,w,g);0<=w?(n.add(w),n.add(k)):y.add(k)}p||y.add(n.get(0));if(y.size==n.size)d.Ui(b,c,!0);else if(2<=y.size&&
(!this.ZH||2!=y.size||!(p||a.b.Cb(b.Ba(y.get(0)),b.Ba(y.get(1)))<=this.FI))){c=new a.Wa;e=0;for(g=y.size;e<g;e++)b.xe(y.get(e),c),0==e?d.Of(c):d.lineTo(c);p&&(this.ZH||2!=y.size||d.lineTo(c),d.sq())}}};b.prototype.WL=function(a,b,c,d,e,f){var g=e-1;e<=d&&(g=f);f=e=-1;for(d+=1;d<=g;d++){c.fc(2*d,b);var h=b.x,p=b.y;a.hc(a.ne(b,!1),b);b.x-=h;b.y-=p;h=b.length();h>this.FI&&h>f&&(e=d,f=h)}return e};b.prototype.Oe=function(){return!0};return b}();a.MM=b})(C||(C={}));(function(a){var b=function(b){function c(){return null!==
b&&b.apply(this,arguments)||this}ca(c,b);c.prototype.G=function(){return 29};c.prototype.V=function(b,c,d,e){return b instanceof a.T?(b=new a.gd(b),this.V(b,c,d,e).next()):new a.MM(b,c,d,e)};c.local=function(){null===c.N&&(c.N=new c);return c.N};c.N=null;return c}(a.bf);a.ND=b})(C||(C={}));(function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}ca(c,b);c.prototype.G=function(){return 21};c.local=function(){null===c.N&&(c.N=new c);return c.N};c.prototype.V=function(b,
c,d,e,f,g,n,k){return b instanceof a.T?(k=new a.gd(b),this.V(k,c,d,[e],f,g,!1,n).next()):!0===n?(d=new a.PD(b,c,d,e,f,!1,!1,k),a.ei.local().V(d,c,k)):new a.PD(b,c,d,e,f,!1,!1,k)};c.N=null;return c}(a.bf);a.OD=b})(C||(C={}));(function(a){var b=function(){function b(b,c,d,e,f,g,k,w){if(g)throw a.g.af();if(null==c)throw a.g.F();this.Ca=-1;this.Jt=b;this.Pg=c;this.Xe=d;this.At=e;this.Vo=f;this.Zo=-1;this.mc=w;this.YU=new a.h;this.YU.Oa()}b.prototype.next=function(){for(var a;null!=(a=this.Jt.next());)return this.Ca=
this.Jt.Ia(),this.Zo+1<this.At.length&&this.Zo++,this.rS(a,this.At[this.Zo]);return null};b.prototype.Ia=function(){return this.Ca};b.prototype.rS=function(b,c){return a.bM.buffer(b,this.Pg,this.Xe,c,this.Vo,this.mc)};b.prototype.Oe=function(){return!0};return b}();a.PD=b})(C||(C={}));(function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}ca(c,b);c.prototype.G=function(){return 24};c.local=function(){null===c.N&&(c.N=new c);return c.N};c.prototype.V=function(b,
c,d,e){if(null==c)throw a.g.F();if(b.u()||1>b.ub())return 0;if(4==d)throw a.g.af();var f=a.fb.lc(c),g=a.fb.hw(f),h=a.fb.Sv(f),g=g*(2-g),p=f.Td().Bi,n=b.G(),y;1736==n||197==n?y=b.Fg():a.T.Nc(n)?(y=new a.Ua(b.description),y.cc(b,!0)):y=b;if(0==f.Eb(c)){if(a.fb.Ic(c)){y=a.gi.Qj(y,c);1607==n&&y==b&&(y=a.T.me(b));b=new a.yc;a.fb.Ch(c).Yn(b);for(var n=0,k=y.D();n<k;n++){var D=y.Ba(n);D.x=a.gi.Tn(D.x,b);y.rb(n,D)}}b=y.Ka();y=a.gi.CJ(c,f,y,b,e)?b:a.fb.Vg(y,c,f,e)}return this.yR(y,d,h,g,p)};c.prototype.yR=
function(b,c,d,e,f){var g=new a.da(0),h=0;for(b=b.Fa();b.Ya();)for(;b.Ea();){var p=b.ba(),n=p.ec(),p=p.Ac();n.scale(f);p.scale(f);a.mb.Kd(d,e,n.x,n.y,p.x,p.y,g,null,null,c);h+=g.j}return h};c.N=null;return c}(a.bf);a.PM=b})(C||(C={}));(function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}ca(c,b);c.prototype.G=function(){return 18};c.local=function(){null===c.N&&(c.N=new c);return c.N};c.prototype.V=function(b,c,d,e,f){return b instanceof a.T?(b=new a.gd(b),this.V(b,
c,d,e,f).next()):new a.OM(b,d,e,c,-1,-1,f)};c.N=null;return c}(a.bf);a.NM=b})(C||(C={}));(function(a){var b=function(){function b(b,c,d,e,f,g){if(0<g)throw a.g.af();if(4!=d&&0<f)throw a.g.af();if(null==c)throw a.g.F();this.Ca=-1;this.Jt=b;this.Pg=c;this.Xe=d;this.eV=e;this.dV=f}b.prototype.next=function(){for(var a;null!=(a=this.Jt.next());)return this.Ca=this.Jt.Ia(),this.Jz(a);return null};b.prototype.Ia=function(){return this.Ca};b.prototype.Jz=function(b){return a.Ij.Js(b,this.Pg,this.Xe,this.eV,
this.dV,this.mc)};b.prototype.Oe=function(){return!0};return b}();a.OM=b})(C||(C={}));(function(a){(function(a){a[a.Unknown=0]="Unknown";a[a.Contains=1]="Contains";a[a.Within=2]="Within";a[a.Equals=3]="Equals";a[a.Disjoint=4]="Disjoint";a[a.Touches=8]="Touches";a[a.Crosses=16]="Crosses";a[a.Overlaps=32]="Overlaps";a[a.NoThisRelation=64]="NoThisRelation";a[a.Intersects=1073741824]="Intersects";a[a.IntersectsOrDisjoint=1073741828]="IntersectsOrDisjoint"})(a.kM||(a.kM={}));var b=function(){function b(){}
b.w_=function(c,d,e,f){if(d.u()||c.u())return 4;var g=c.G(),h=d.G(),p;a.T.Nc(g)&&(c=p=new a.Ua(c.description),p.cc(c,!0));a.T.Nc(h)&&(d=p=new a.Ua(d.description),p.cc(d,!0));switch(g){case 33:switch(h){case 33:return b.LT(c,d,e);case 197:return b.de(b.lD(d,c,e));case 550:return b.de(b.tD(d,c,e));case 1607:return b.de(b.dE(d,c,e,f));case 1736:return b.de(b.DD(d,c,e))}throw a.g.za();case 197:switch(h){case 33:return b.lD(c,d,e);case 197:return b.JP(c,d,e);case 550:return b.de(b.oD(d,c,e,f));case 1607:return b.de(b.HD(d,
c));case 1736:return b.de(b.zD(d,c))}throw a.g.za();case 550:switch(h){case 33:return b.tD(c,d,e);case 197:return b.oD(c,d,e,f);case 550:return b.qD(c,d,e,f);case 1607:return b.de(b.YD(d,c));case 1736:return b.de(b.BD(d,c))}throw a.g.za();case 1607:switch(h){case 33:return b.dE(c,d,e,f);case 197:return b.HD(c,d);case 550:return b.YD(c,d);case 1607:return b.QV(c,d);case 1736:return b.de(b.FD(d,c))}throw a.g.za();case 1736:switch(h){case 33:return b.DD(c,d,e);case 197:return b.zD(c,d);case 550:return b.BD(c,
d);case 1607:return b.FD(c,d);case 1736:return b.OU(c,d)}throw a.g.za();default:throw a.g.za();}};b.LT=function(a,c,d){a=a.w();c=c.w();return b.xD(a,c,d)};b.xD=function(a,b,c){a.sub(b);return a.uk()<=c*c?3:4};b.lD=function(c,d,e){var f=new a.h;c.s(f);c=d.w();return b.uR(f,c,e)};b.uR=function(a,b,c){a.P(-c,-c);if(a.contains(b))return 1;a.P(c,c);return a.contains(b)?8:4};b.GR=function(a,b,c){return b.contains(c)?1:a.contains(c)?8:4};b.JP=function(c,d,e){var f=new a.h;c.s(f);c=new a.h;d.s(c);return b.ZQ(f,
c,e)};b.ZQ=function(a,b,c){var d=0;a.contains(b)&&(d|=1);b.contains(a)&&(d|=2);if(0!=d)return d;a.P(-c,-c);b.P(-c,-c);if(a.Yb(b))return d=a,d.P(c,c),d=d.contains(b)?1:0,b.P(c,c),d|=b.contains(a)?2:0,0!=d?d:32;d=a;d.P(c,c);b.P(c,c);return d.Yb(b)?8:4};b.tD=function(a,c,d){c=c.w();return b.vD(a,c,d)};b.vD=function(a,c,d){for(var e=0,f=a.D();e<f;e++){var g;g=a.Ba(e);g=b.xD(g,c,d);if(4!=g)return 0!=(g&2)&&1!=f?1:g}return 4};b.oD=function(c,d,e,f){var g=new a.h;d.s(g);return b.IT(c,g,e,f)};b.IT=function(a,
c,d,e){c.P(-d,-d);c.P(d,d);for(var f=d=0,g=a.D();f<g;f++){var h;h=a.Ba(f);h=b.de(b.GR(c,c,h));if(4!=h&&(d|=h,4==e))return 1073741824}return 0==d?4:2==d?d:32};b.qD=function(a,c,d,e){for(var f=0,g=0,h=c.D();g<h;g++){var p;p=c.Ba(g);p=b.vD(a,p,d);if(4!=p&&(f++,4==e))return 1073741824}return 0<f?f==c.D()?3==e?(p=b.qD(c,a,d,1),1==p?3:0):1:32:0};b.dE=function(a,c,d,e){c=c.w();return b.IV(a,c,d,e)};b.fS=function(a,b){var c=null;a=a.ob;null!=a&&(c=a.Ii);if(null!=c){c=c.wm(b.x,b.y);if(0==c)return 4;if(1==
c)return 1}else return-1;return 0};b.IV=function(c,d,e,f){if(0==(f&1073741839))return 64;var g=b.fS(c,d);if(0<g)return g;e*=e;for(g=c.Fa();g.Ya();){var h=g.Ta;if(!c.Qb(h)){var p=c.La(h),h=c.wa(h);if(0==p)continue;if(a.b.sc(c.Ba(h),d)<=e||1<p&&a.b.sc(c.Ba(h+p-1),d)<=e)return 8}if(8!=f)for(;g.Ea();)if(p=g.ba(),p=p.hc(p.ne(d,!1)),a.b.sc(p,d)<=e)return 0!=(f&1073741828)?1073741824:1}return 0!=(f&1073741828)?4:64};b.HD=function(c,d){var e=new a.h;d.s(e);return b.wV(c,e)};b.wV=function(a,c){a=b.Nm(a,c);
return 0<a?a:0};b.Nm=function(a,b){a=a.ob;if(null!=a)a=a.Ii;else return-1;if(null!=a){a=a.Xn(b);if(0==a)return 4;if(1==a)return 1}else return-1;return 0};b.YD=function(c,d){var e=new a.h;d.s(e);e=b.Nm(c,e);return 0<e?e:0};b.$u=function(c,d){var e=new a.h;d.s(e);e=b.Nm(c,e);return 0<e?e:-1==e&&(e=new a.h,c.s(e),e=b.Nm(d,e),0<e)?b.de(e):0};b.QV=function(a,c){a=b.$u(a,c);return 0<a?a:0};b.DD=function(a,c,d){c=c.w();return b.LU(a,c,d)};b.LU=function(b,c,d){b=a.fd.ee(b,c,d);if(0==b)return 4;if(1==b)return 1;
if(2==b)return 8;throw a.g.za();};b.zD=function(c,d){var e=new a.h;d.s(e);return b.IU(c,e)};b.IU=function(a,c){a=b.Nm(a,c);return 0<a?a:0};b.BD=function(a,c){a=b.$u(a,c);return 0<a?a:0};b.FD=function(a,c){a=b.$u(a,c);return 0<a?a:0};b.OU=function(a,c){a=b.$u(a,c);return 0<a?a:0};b.OW=function(b,c){var d=b.G(),e=c.G(),f;if(a.T.fh(d)&&(f=b.ob,null!=f&&(f=f.Ii,null!=f))){if(33==e){var g=c.w();f=f.wm(g.x,g.y)}else g=new a.h,c.s(g),f=f.Xn(g);if(1==f)return 1;if(0==f)return 4}if(a.T.fh(e)&&(f=c.ob,null!=
f&&(f=f.Ii,null!=f))){33==d?(d=b.w(),f=f.wm(d.x,d.y)):(d=new a.h,b.s(d),f=f.Xn(d));if(1==f)return 2;if(0==f)return 4}return 0};b.de=function(a){0!=(a&1)&&(a=a&-2|2);0!=(a&2)&&(a=a&-3|1);return a};return b}();a.QM=b})(C||(C={}));(function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}ca(c,b);c.local=function(){null===c.N&&(c.N=new c);return c.N};c.prototype.G=function(){return 15};c.prototype.V=function(b,c,d,e,f){return b instanceof a.T?(b=new a.gd(b),c=new a.gd(c),
this.V(b,c,d,e,f).next()):void 0===f?new a.QD(b,c,d,e,-1):new a.QD(b,c,d,e,f)};c.prototype.xo=function(b,c,d){if(!this.Av(b))return!1;c=a.na.$g(c,b,!1);var e=b.Kj(d);return e=e||b.bv(c,d)};c.prototype.Av=function(b){return a.ty.$y(b)};c.N=null;return c}(a.bf);a.wk=b})(C||(C={}));(function(a){var b=function(){function b(b,c,d,e,f){this.qt=null==c;this.Ca=-1;this.ge=b;this.Pg=d;this.pf=c.next();this.dk=this.pf.G();this.mc=e;this.fj=f;if(-1!=this.fj&&(0>=this.fj||7<this.fj))throw a.g.F("bad dimension mask");
}b.prototype.next=function(){if(this.qt)return null;var a;if(null!=this.ox){a=this.ox.next();if(null!=a)return a;this.ox=null}for(;null!=(a=this.ge.next());){this.Ca=this.ge.Ia();if(-1==this.fj)return a=this.Ma(a);this.ox=this.mU(a);return a=this.ox.next()}return null};b.prototype.Ia=function(){return this.Ca};b.prototype.Ma=function(b){var c=this.cL(b);if(null!=c)return c;var c=a.na.Zv(this.pf,b),d=a.na.$d(this.Pg,c,!0),c=new a.h;this.pf.s(c);var e=new a.h;b.s(e);c.P(2*d,2*d);c.Ma(e);c.P(100*d,100*
d);d=a.le.clip(this.pf,c,0,0);b=a.le.clip(b,c,0,0);return a.Cg.nw(b,d,this.Pg,this.mc)};b.prototype.xJ=function(b,c,d){var e=0;if(0!=(c&1))null==d[0]&&(d[0]=new a.Dd(b)),e++;else for(var f=0;f<d.length-1;f++)d[f]=d[f+1];if(0!=(c&2))null==d[e]&&(d[e]=new a.Ua(b)),e++;else for(f=e;f<d.length-1;f++)d[f]=d[f+1];if(0!=(c&4))null==d[e]&&(d[e]=new a.Ja(b)),e++;else for(f=e;f<d.length-1;f++)d[f]=d[f+1];if(3!=e){b=[];for(f=0;f<e;f++)b[f]=d[f];return new a.gd(b)}return new a.gd(d)};b.prototype.mU=function(b){var c=
this.cL(b);if(null!=c){var d=[null,null,null];d[c.ub()]=c;return this.xJ(b.description,this.fj,d)}c=a.na.Zv(this.pf,b);d=a.na.$d(this.Pg,c,!0);c=new a.h;this.pf.s(c);c.P(2*d,2*d);var e=new a.h;b.s(e);c.Ma(e);c.P(100*d,100*d);d=a.le.clip(this.pf,c,0,0);c=a.le.clip(b,c,0,0);d=a.Cg.yA(c,d,this.Pg,this.mc);return this.xJ(b.description,this.fj,d)};b.prototype.cL=function(c){var d=a.na.Zv(c,this.pf),e=a.na.$d(this.Pg,d,!0),d=c.G(),f=c.u(),g=this.pf.u(),g=f||g;if(!g){g=new a.h;c.s(g);var n=new a.h;this.pf.s(n);
n.P(2*e,2*e);g=!g.Yb(n)}if(!g)if(n=a.QM.OW(this.pf,c),4==n)g=!0;else{if(0!=(n&2))return this.pf;if(0!=(n&1))return c}if(g)return e=a.T.hf(d),g=a.T.hf(this.dk),e<g?b.N(c,f):e>g?this.SJ():0==e?550==d&&33==this.dk?this.SJ():b.N(c,f):b.N(c,f);if((-1==this.fj||4==this.fj)&&197==d&&197==this.dk)return e=this.pf,d=new a.h,c.s(d),f=new a.h,e.s(f),d.Ma(f),e=new a.di,c.copyTo(e),e.Np(d),e;if(197==d&&0==a.T.hf(this.dk)||197==this.dk&&0==a.T.hf(d))return f=197==d?c:this.pf,c=197==d?this.pf:c,d=new a.h,f.s(d),
a.le.clip(c,d,e,0);if(0==a.T.hf(d)&&0<a.T.hf(this.dk)||0<a.T.hf(d)&&0==a.T.hf(this.dk)){e=a.na.$g(this.Pg,c,!1);if(550==d||33==d)return a.Cg.AH(c,this.pf,e);if(550==this.dk||33==this.dk)return a.Cg.AH(this.pf,c,e);throw a.g.za();}return-1!=this.fj&&2!=this.fj||1607!=d||1736!=this.dk?-1!=this.fj&&2!=this.fj||1736!=d||1607!=this.dk?null:this.$K(this.pf,c):this.$K(c,this.pf)};b.prototype.$K=function(b,c){var d=b,e=c,f=a.na.$g(this.Pg,c,!1),g=new a.h;e.s(g);var h=new a.h;d.s(h);h.P(2*f,2*f);g.Ma(h);g.P(10*
f,10*f);var d=b=a.le.clip(b,g,0,0),h=new a.ha(0),n=-1,k=e.ob;if(null!=k){var w=k.Ii;if(null!=w){n=0;h.zb(d.D()+d.aa());for(var l=new a.h,m=d.Fa();m.Ya();)for(;m.Ea();){m.ba().s(l);var q=w.Xn(l);1==q?h.add(1):0==q?h.add(0):(h.add(-1),n++)}}}5<c.D()&&(e=c=a.le.clip(c,g,0,0),k=e.ob);0>n&&(n=d.lA());g=d.D()+e.D();if(n*e.D()>Math.log(g)*g*4)return null;g=null;n=e.Fa();null!=k&&null!=k.Mb&&(g=k.Mb);null==g&&20<e.D()&&(g=a.na.BF(e));e=b.Ka();k=null;w=d.Fa();l=[0,0,0,0,0,0,0,0,0];m=new a.Pd(0);q=new a.Bg;
b=-1;for(var r=0,t=0,u=0<h.size,v=-1;w.Ya();){var v=w.Ta,x=0;b=-1;for(r=0;w.Ea();){var z=u?a.J.truncate(h.get(t)):-1;t++;var I=w.ba();if(0>z){if(null!=g)for(null==k?k=g.PS(I,f):k.bo(I,f),z=k.next();-1!=z;z=k.next()){n.Tb(g.ia(z));for(var z=n.ba(),B=I.Ma(z,null,l,null,f),z=0;z<B;z++)m.add(l[z])}else for(n.zj();n.Ya();)for(;n.Ea();)for(z=n.ba(),B=I.Ma(z,null,l,null,f),z=0;z<B;z++)m.add(l[z]);if(0<m.size){m.Fd(0,m.size,function(a,b){return a-b});var A=0;m.add(1);for(var B=-1,z=0,F=m.size;z<F;z++){var C=
m.get(z);if(C!=A){var G=!1;0!=A||1!=C?(I.yh(A,C,q),A=q.get()):(A=I,G=!0);if(2<=x){e.zs(d,v,b,r,3==x);if(1!=this.gF(c,A.ec(),f)&&1!=this.hF(c,A,f))return null;e.cc(A,!1);x=1;r=0}else switch(B=this.hF(c,A,f),B){case 1:G?2>x?(b=w.Db()-d.wa(v),r=1,x=0==x?3:2):r++:(e.cc(A,0==x),x=1);break;case 0:x=0;b=-1;r=0;break;default:return null}A=C}}}else{z=this.gF(c,I.ec(),f);if(0>z)return null;1==z?(2>x&&(b=w.Db()-d.wa(v),x=0==x?3:2),r++):(b=-1,r=0)}m.clear(!1)}else 0!=z&&1==z&&(0==x?(x=3,b=w.Db()-d.wa(v)):1==
x?(x=2,b=w.Db()-d.wa(v)):r++)}2<=x&&(e.zs(d,v,b,r,3==x),b=-1)}return e};b.prototype.gF=function(b,c,d){return a.cf.qn(b,c,d)};b.prototype.hF=function(b,c,d){var e=c.ec();c=c.Ac();var f=a.cf.qn(b,e,d),g=a.cf.qn(b,c,d);if(1==f&&0==g||0==f&&1==g)return-1;if(0==f||0==g)return 0;if(1==f||1==g)return 1;f=new a.b;f.add(e,c);f.scale(.5);b=a.cf.qn(b,f,d);return 0==b?0:1==b?1:-1};b.N=function(a,b){return b?a:a.Ka()};b.prototype.SJ=function(){null==this.xI&&(this.xI=this.pf.Ka());return this.xI};b.prototype.Oe=
function(){return!0};return b}();a.QD=b})(C||(C={}));(function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}ca(c,b);c.prototype.G=function(){return 28};c.local=function(){null===c.N&&(c.N=new c);return c.N};c.prototype.V=function(b,c,d,e,f,g,n){return b instanceof a.T?(b=new a.gd(b),this.V(b,c,d,e,f,g,n).next()):new a.RM(b,c,d,e,f,g,n)};c.N=null;return c}(a.bf);a.RD=b})(C||(C={}));(function(a){var b=function(){function b(a,b,c,d,e,f,g){this.Ca=-1;this.ge=a;this.jk=
b;this.Pa=c;this.kj=d;this.lB=e;this.tI=f;this.ie=g}b.prototype.next=function(){var a=this.ge.next();return null!=a?(this.Ca=this.ge.Ia(),this.EM(a)):null};b.prototype.Ia=function(){return this.Ca};b.prototype.EM=function(b){var c;c=0>=this.tI?a.na.$g(this.jk,b,!1):this.tI;return a.HL.V(b,this.Pa,this.kj,this.lB,c,this.ie)};b.prototype.Oe=function(){return!0};return b}();a.RM=b})(C||(C={}));(function(a){(function(a){a[a.clipToDomainOnly=1]="clipToDomainOnly";a[a.clipWithHorizon=2]="clipWithHorizon";
a[a.foldAndClipWithHorizon=3]="foldAndClipWithHorizon"})(a.aq||(a.aq={}));var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}ca(c,b);c.prototype.G=function(){return 0};c.local=function(){null===c.N&&(c.N=new c);return c.N};c.prototype.V=function(b,c,d){return b instanceof a.T?(b=new a.gd(b),this.V(b,c,d).next()):new a.SM(b,c,d)};c.prototype.transform=function(b,c,d,e){return a.qo.transform(b,c,d,e,!0)};c.prototype.YK=function(b,c,d){return a.qo.YK(b,c,d)};c.prototype.Fu=
function(b,c,d,e){return a.qo.Fu(b,c,d,e)};c.prototype.AY=function(b,c,d,e){return a.qo.fs(b,c,d,e)};c.prototype.XK=function(b,c,d,e){return a.qo.XK(b,c,d,e)};c.N=null;return c}(a.bf);a.ns=b})(C||(C={}));(function(a){var b=function(){function b(a,b,c){this.Ca=-1;this.ge=a;this.nV=b;this.ie=c}b.prototype.next=function(){var b=this.ge.next();return null!=b?(this.Ca=this.ge.Ia(),a.qo.Vg(b,this.nV,this.ie)):null};b.prototype.Ia=function(){return this.Ca};b.prototype.Oe=function(){return!0};return b}();
a.SM=b})(C||(C={}));(function(a){var b=function(){function b(){}b.prototype.reset=function(){this.Mh=this.al=-1;this.st=this.$q=!1};b.prototype.QR=function(a,b,c){for(a.Tb(b,c);a.Ea();){var d=a.ba(),d=d.Rb();if(0!=d)return a.Db()}for(a.Tb(b,c);a.rA();)if(d=a.Mi(),d=d.Rb(),0!=d)return a.Db();return-1};b.prototype.RR=function(a,b){for(a.Tb(b,-1);a.rA();)if(0!=a.Mi().Rb())return a.Db();return-1};b.prototype.PR=function(a,b){a.Tb(b,-1);for(a.ba();a.Ea();)if(0!=a.ba().Rb())return a.Db();return-1};b.prototype.OR=
function(b,c,d,e){this.al=this.QR(c,d,e);if(-1!=this.al){c.Tb(this.al,-1);var f=c.ba(),g=f.hc(f.ne(b,!1));d=a.b.sc(g,b);e=new a.b;e.L(g);e.sub(f.ec());g=new a.b;g.L(b);g.sub(f.ec());this.$q=0>e.Vi(g);this.Mh=this.PR(c,this.al);if(-1!=this.Mh){c.Tb(this.Mh,-1);var f=c.ba(),h=f.ne(b,!1),h=f.hc(h),p=a.b.sc(h,b);p>d?this.Mh=-1:(e.L(h),e.sub(f.ec()),g.L(b),g.sub(f.ec()),this.st=0>e.Vi(g))}-1==this.Mh&&(this.Mh=this.RR(c,this.al),-1!=this.Mh&&(c.Tb(this.Mh,-1),f=c.ba(),h=f.ne(b,!1),h=f.hc(h),p=a.b.sc(h,
b),p>d?this.Mh=-1:(e.L(h),e.sub(f.ec()),g.L(b),g.sub(f.ec()),this.st=0>e.Vi(g),b=this.al,this.al=this.Mh,this.Mh=b,b=this.$q,this.$q=this.st,this.st=b)))}};b.prototype.AP=function(a,b,c,d,e){c=c.Fa();this.OR(a,c,d,e);if(-1!=this.al&&-1==this.Mh)return this.$q;if(-1!=this.al&&-1!=this.Mh){if(this.$q==this.st)return this.$q;c.Tb(this.al,-1);a=c.ba().Dg(1);c.Tb(this.Mh,-1);b=c.ba().Dg(0);return 0<=a.Vi(b)?!0:!1}return b};return b}(),c=function(c){function d(){return null!==c&&c.apply(this,arguments)||
this}ca(d,c);d.local=function(){null===d.N&&(d.N=new d);return d.N};d.prototype.G=function(){return 3};d.prototype.bA=function(b,c,d,e){void 0===e&&(e=!1);if(b.u())return new a.Sm;c=c.w();var f=b,g=b.G();197==g&&(f=new a.Ja,f.hd(b,!1),g=1736);switch(g){case 33:return this.tJ(f,c);case 550:return this.fJ(f,c);case 1607:case 1736:return this.DV(f,c,d,e);default:throw a.g.X("not implemented");}};d.prototype.cA=function(b,c){if(b.u())return new a.Sm;c=c.w();var d=b,e=b.G();197==e&&(d=new a.Ja,d.hd(b,
!1),e=1736);switch(e){case 33:return this.tJ(d,c);case 550:case 1607:case 1736:return this.fJ(d,c);default:throw a.g.X("not implemented");}};d.prototype.dA=function(b,c,d,e){if(0>e)throw a.g.F();if(b.u())return[];c=c.w();var f=b,g=b.G();197==g&&(f=new a.Ja,f.hd(b,!1),g=1736);switch(g){case 33:return this.hW(f,c,d,e);case 550:case 1607:case 1736:return this.GV(f,c,d,e);default:throw a.g.X("not implemented");}};d.prototype.DV=function(c,d,e,f){if(1736==c.G()&&e&&(e=new a.h,c.s(e),e=a.na.$d(null,e,!1),
0!=(f?a.fd.ee(c,d,0):a.fd.ee(c,d,e)))){var g=new a.Sm(d,0,0);f&&g.BK(!0);return g}for(var h=c.Fa(),g=new a.b,p=e=-1,n=1.7976931348623157E308,y=0;h.Ya();)for(;h.Ea();){var k=h.ba(),k=k.hc(k.ne(d,!1)),D=a.b.sc(k,d);D<n?(y=1,g=k,e=h.Db(),p=h.Ta,n=D):D==n&&y++}g=new a.Sm(g,e,Math.sqrt(n));f&&(h.Tb(e,p),k=h.ba(),f=0>a.b.Gp(d,k.ec(),k.Ac()),1<y&&(y=new b,y.reset(),f=y.AP(d,f,c,e,p)),g.BK(f));return g};d.prototype.tJ=function(b,c){b=b.w();c=a.b.Cb(b,c);return new a.Sm(b,0,c)};d.prototype.fJ=function(b,c){var d=
b.Qa(0);b=b.D();for(var e=0,f=0,g=0,h=1.7976931348623157E308,p=0;p<b;p++){var n=new a.b;d.fc(2*p,n);var y=a.b.sc(n,c);y<h&&(f=n.x,g=n.y,e=p,h=y)}d=new a.Sm;d.Hy(f,g,e,Math.sqrt(h));return d};d.prototype.hW=function(b,c,d,e){if(0==e)return d=[];d*=d;b=b.w();c=a.b.sc(b,c);c<=d?(d=[],e=new a.Sm,e.Hy(b.x,b.y,0,Math.sqrt(c)),d[0]=e):d=[];return d};d.prototype.GV=function(b,c,d,e){if(0==e)return e=[];var f=b.Qa(0),g=b.D();b=[];var h=0;d*=d;for(var p=0;p<g;p++){var n=f.read(2*p),y=f.read(2*p+1),k=c.x-n,
D=c.y-y,k=k*k+D*D;k<=d&&(D=new a.Sm,D.Hy(n,y,p,Math.sqrt(k)),h++,b.push(D))}c=b.length;b.sort(function(a,b){return a.Pa<b.Pa?-1:a.Pa==b.Pa?0:1});if(e>=c)return b.slice(0);b.length=e;return b.slice(0)};d.N=null;return d}(a.bf);a.oy=c})(C||(C={}));(function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}ca(c,b);c.prototype.G=function(){return 4};c.prototype.V=function(b,c,d,e,f){return a.Tm.aC(b,c,d,e,f)};c.local=function(){null===c.N&&(c.N=new c);return c.N};c.prototype.Av=
function(b){return a.Iu.az(b)};c.prototype.xo=function(b,c,d){return a.Iu.VE(b,c,d)};c.N=null;return c}(a.bf);a.TM=b})(C||(C={}));(function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}ca(c,b);c.prototype.G=function(){return 33};c.prototype.V=function(b,c,d,e,f){return 1073741824===b?!a.Ed.bC(c,d,e,4,f):a.Ed.bC(c,d,e,b,f)};c.local=function(){null===c.N&&(c.N=new c);return c.N};c.prototype.Av=function(b){return a.Iu.az(b)};c.prototype.xo=function(b,c,d){return a.Iu.VE(b,
c,d)};c.N=null;return c}(a.bf);a.Jj=b})(C||(C={}));(function(a){var b=function(){function b(b,c,d,e){this.ie=e;this.VU=d;this.Ca=-1;if(null==b)throw a.g.F();this.bl=b;this.jk=c}b.prototype.next=function(){var a;return null!=(a=this.bl.next())?(this.Ca=this.bl.Ia(),this.FC(a)):null};b.prototype.Ia=function(){return this.Ca};b.prototype.FC=function(b){if(null==b)throw a.g.F();return a.py.HK(b,this.jk,this.VU,this.ie)};b.prototype.Oe=function(){return!0};return b}();a.UM=b})(C||(C={}));(function(a){var b=
function(b){function c(){return null!==b&&b.apply(this,arguments)||this}ca(c,b);c.prototype.G=function(){return 26};c.prototype.V=function(b,c,d,e){return b instanceof a.T?(b=new a.gd(b),this.V(b,c,d,e).next()):new a.UM(b,c,d,e)};c.prototype.Wq=function(b,c,d,e,f){return 0<(void 0!==e?a.py.Wq(b,c,d,e,f):a.py.Wq(b,c,!1,null,d))};c.local=function(){null===c.N&&(c.N=new c);return c.N};c.N=null;return c}(a.bf);a.Qm=b})(C||(C={}));(function(a){var b=function(){function a(){this.nr=0}a.prototype.MX=function(a){this.nr&=
-2;this.nr|=a?1:0};a.prototype.mn=function(){return 0!=(this.nr&1)};a.prototype.ZG=function(){return this.mn()?0:1};return a}();a.lZ=b;var c=function(){return function(){}}(),d=function(){return function(a,b,c,d){this.x=a;this.y=b;this.aj=c;this.rn=d}}(),e=function(){function a(a){this.Ze=a}a.prototype.compare=function(a,b,c){a=a.ia(c);b=this.Ze.Kf.read(2*b);a=this.Ze.Kf.read(2*a);b-=a;return 0>b?-1:0<b?1:0};return a}(),f=function(){function a(a){this.Ze=a}a.prototype.compare=function(a,b,c){b=this.Ze.ib[b];
a=this.Ze.ib[a.ia(c)];var d=b.mn(),e=a.mn();c=b.Ie.kf(this.Ze.Dp,0);var f=a.Ie.kf(this.Ze.Dp,0);c==f&&(c=Math.min(d?b.Ie.ra:b.Ie.oa,e?a.Ie.ra:a.Ie.oa),d=.5*(c-this.Ze.Dp)+this.Ze.Dp,d==this.Ze.Dp&&(d=c),c=b.Ie.kf(d,0),f=a.Ie.kf(d,0));return c<f?-1:c>f?1:0};return a}(),g=function(){function b(b,c){this.EJ=new a.b;this.parent=b;this.AT=c}b.prototype.gs=function(a,b,c){var d=this.parent,e=this.AT;c.Fd(a,b,function(a,b){return d.li(a,b,e)})};b.prototype.Qq=function(a){a=this.parent.Hi.get(a);this.parent.Kf.fc(2*
(a>>1),this.EJ);return this.EJ.y+(0!=(a&1)?this.parent.lk:-this.parent.lk)};return b}(),k=function(){function h(b,c,d,e,f){this.mI=b.description;this.Y=b;this.lh=c;this.lk=a.na.$g(this.lh,b,!1);this.vp=a.na.$g(this.lh,b,!0);this.gB=d;this.TU=this.mI.Ga;this.ib=[];this.jp=[];this.Ih=new a.cq;this.hb=new a.xk;this.se=new a.Yd;this.YH=this.Zl=f}h.prototype.DA=function(){this.YH=!0;return(!a.T.Hc(this.Y.G())||this.NF()&&this.MF(!1))&&this.MP()?a.T.Hc(this.Y.G())?this.PP()?1607==this.Y.G()?this.RP()?2:
0:this.SP()?this.TP():0:0:2:0};h.prototype.LC=function(b,c){var d=this.Kf.read(2*b);b=this.Kf.read(2*b+1);var e=this.Kf.read(2*c);c=this.Kf.read(2*c+1);var f=!a.Ku.pw(d,b,e,c,this.lk*this.lk);return f?f:0==this.Y.ub()?!1:d==e&&b==c};h.prototype.NF=function(){for(var b=this.Y,c=b.Yf?3:2,d=0,e=b.aa();d<e;d++)if(b.La(d)<c)return this.se=new a.Yd(1,d,0),!1;return!0};h.prototype.MF=function(b){for(var c=this.Y,d=c.Fa(),e=c.hasAttribute(1),c=e?a.na.GF(this.lh,c,!1):0;d.Ya();)for(;d.Ea();){var f=d.ba();
if(!(f.Rb()>this.lk)){if(b&&e){var g=f.bt(1,0),f=f.bt(1,0);if(Math.abs(f-g)>c)continue}this.se=new a.Yd(2,d.Db(),-1);return!1}}return!0};h.prototype.MP=function(){var b=this.Y,c=null;a.T.Hc(this.Y.G())&&(c=this.Y);var d=(this.YH||this.Zl)&&null!=c,f=b.D();this.Kf=b.Qa(0);this.Hi=new a.ha(0);this.Hi.zb(2*f);this.Gi=new a.ha(0);this.Gi.zb(2*f);d&&(null==this.nm&&(this.nm=new a.ha(0)),this.nm.zb(f));for(var h=b=0;h<f;h++)if(this.Hi.add(2*h),this.Hi.add(2*h+1),this.Gi.add(2*h),this.Gi.add(2*h+1),d){for(;h>=
c.Fc(b);)b++;this.nm.add(b)}(new a.Ju).sort(this.Gi,0,2*f,new g(this,d));this.hb.clear();this.hb.Lp(new e(this));this.hb.Ne(f);c=0;for(f*=2;c<f;c++)if(d=this.Gi.get(c),b=this.Hi.get(d),d=b>>1,0==(b&1)){b=this.hb.addElement(d,-1);h=this.hb.Se(b);if(-1!=h&&!this.LC(this.hb.ia(h),d))return this.se=new a.Yd(3,d,this.hb.ia(h)),!1;var p=this.hb.nb(b);if(-1!=p&&!this.LC(this.hb.ia(p),d))return this.se=new a.Yd(3,d,this.hb.ia(p)),!1}else if(b=this.hb.search(d,-1),h=this.hb.Se(b),p=this.hb.nb(b),this.hb.Jd(b,
-1),-1!=h&&-1!=p&&!this.LC(this.hb.ia(h),this.hb.ia(p)))return this.se=new a.Yd(3,this.hb.ia(h),this.hb.ia(p)),!1;return!0};h.prototype.PP=function(){return 10>this.Y.D()?this.NP():this.OP()};h.prototype.OP=function(){var b=new a.ed;b.Jb(this.Y);var c=new a.Yd;return a.Mu.hJ(!1,b,this.lk,c,this.ie)?(c.qm=b.Za(c.qm),c.rm=b.Za(c.rm),this.se.ls(c),!1):!0};h.prototype.NP=function(){for(var b=this.Y,c=b.Fa(),b=b.Fa();c.Ya();)for(;c.Ea();){var d=c.ba();if(!c.Oo()||!c.vU()){b.cX(c);do for(;b.Ea();){var e=
b.ba(),e=d.ws(e,this.lk,!0);if(0!=e)return this.se=new a.Yd(2==e?5:4,c.Db(),b.Db()),!1}while(b.Ya())}}return!0};h.prototype.SP=function(){var b=this.Y;this.ib.length=0;this.jp.length=0;this.tg=b.Fa();this.tg.mC();var c=new a.ha(0);c.zb(10);for(var d=NaN,e=0,f=0,b=2*b.D();f<b;f++){var g=this.Gi.get(f),g=this.Hi.get(g);if(0==(g&1)){var g=g>>1,h=this.Kf.read(2*g),p=this.Kf.read(2*g+1);if(0!=c.size&&(h!=d||p!=e)){if(!this.yJ(c))return!1;null!=c&&c.clear(!1)}c.add(g);d=h;e=p}}return this.yJ(c)?!0:!1};
h.prototype.RP=function(){for(var b=this.Y,d=Array(b.aa()),e=0,f=b.aa();e<f;e++)d[e]=b.Ko(e);var f=new c,g,h,p,n=new a.b,e=this.Gi.get(0),e=this.Hi.get(e),y=e>>1;this.Kf.fc(2*y,n);e=this.nm.get(y);g=d[e];h=b.wa(e);p=b.Fc(e)-1;f.Nl=y==h||y==p;f.Ry=this.Zl?!g&&f.Nl:f.Nl;f.aj=e;f.x=n.x;f.y=n.y;f.rn=y;for(var k=new c,D=1,l=this.Gi.size;D<l;D++)if(e=this.Gi.get(D),e=this.Hi.get(e),0==(e&1)){y=e>>1;this.Kf.fc(2*y,n);e=this.nm.get(y);e!=f.aj&&(g=d[e],h=b.wa(e),p=b.Fc(e)-1);var w,m=y==h||y==p;w=this.Zl?!g&&
f.Nl:f.Nl;k.x=n.x;k.y=n.y;k.aj=e;k.rn=y;k.Ry=w;k.Nl=m;if(k.x==f.x&&k.y==f.y)if(this.Zl){if(!k.Ry||!f.Ry)if(k.aj!=f.aj||!k.Nl&&!f.Nl)return this.se=new a.Yd(8,k.rn,f.rn),!1}else if(!k.Nl||!f.Nl)return this.se=new a.Yd(5,k.rn,f.rn),!1;e=f;f=k;k=e}return!0};h.prototype.PF=function(){for(var b=this.Y,c=[],e=-1,f=!1,g=0,h=b.aa();g<h;g++)b.rw(g)&&(f=!1,e++,g<h-1&&(b.rw(g+1)||(f=!0))),c[g]=f?e:-1;var f=new a.b,g=this.Gi.get(0),g=this.Hi.get(g),p=g>>1;this.Kf.fc(2*p,f);for(var g=this.nm.get(p),e=new d(f.x,
f.y,g,p,c[g]),b=[],n=1,h=this.Gi.size;n<h;n++)if(g=this.Gi.get(n),g=this.Hi.get(g),0==(g&1)){p=g>>1;this.Kf.fc(2*p,f);g=this.nm.get(p);g=new d(f.x,f.y,g,p,c[g]);if(g.x==e.x&&g.y==e.y){if(g.aj==e.aj)return this.se=new a.Yd(9,g.rn,e.rn),!1;0<=c[g.aj]&&c[g.aj]==c[e.aj]&&(0!=b.length&&b[b.length-1]==e||b.push(e),b.push(g))}e=g}if(0==b.length)return!0;g=new a.cq(!0);a.J.Ov(c,-1);f=-1;n=new a.b;n.Yc();e=0;for(h=b.length;e<h;e++){p=b[e];if(p.x!=n.x||p.y!=n.y)f=g.ni(0),n.x=p.x,n.y=p.y;var y=c[p.aj];-1==y&&
(y=g.ni(2),c[p.aj]=y);g.addElement(y,f);g.addElement(f,y)}h=new a.ha(0);h.zb(10);for(e=g.De;-1!=e;e=g.eA(e))if(b=g.SG(e),0==(b&1)&&0!=(b&2)){b=-1;h.add(e);for(h.add(-1);0<h.size;){f=h.Ec();h.Mf();n=h.Ec();h.Mf();p=g.SG(n);if(0!=(p&1)){b=0==(p&2)?f:n;break}g.EX(n,p|1);for(p=g.wc(n);-1!=p;p=g.nb(p))y=g.getData(p),y!=f&&(h.add(y),h.add(n))}if(-1!=b){g=-1;e=0;for(h=c.length;e<h;e++)if(c[e]==b){g=e;break}this.se=new a.Yd(10,g,-1);return!1}}return!0};h.prototype.TP=function(){var b=this.Y;if(0>=b.ef())return this.se=
new a.Yd(6,1==b.aa()?1:-1,-1),0;if(1==b.aa())return this.Zl&&!this.PF()?0:2;this.np=a.ha.yd(b.aa(),0);this.sB=a.ha.yd(b.aa(),-1);for(var c=-1,d=0,e=0,g=b.aa();e<g;e++){var h=b.Ym(e);this.np.write(e,0>h?0:256);if(0<h)c=e,d=h;else{if(0==h)return this.se=new a.Yd(6,e,-1),0;if(0>c||d<Math.abs(h))if(this.se=new a.Yd(7,e,-1),this.Zl)return 0;this.sB.write(e,c)}}this.Yt=b.aa();this.Hn=new a.ha(0);this.Hn.zb(10);g=b.D();this.Dp=NaN;b=new a.ha(0);b.zb(10);this.Ir=a.ha.yd(g,-1);this.ux=a.ha.yd(g,-1);null!=
this.bk?this.bk.clear(!1):this.bk=new a.ha(0);this.bk.zb(10);this.hb.clear();this.hb.Lp(new f(this));c=0;for(g*=2;0<this.Yt&&c<g;c++)if(d=this.Gi.get(c),d=this.Hi.get(d),0==(d&1)){d>>=1;e=this.Kf.read(2*d+1);if(e!=this.Dp&&0!=b.size){if(!this.lu(b))return 0;null!=b&&b.clear(!1)}b.add(d);this.Dp=e}return 0<this.Yt&&!this.lu(b)?0:this.Zl?0==this.se.Ji&&this.PF()?2:0:0==this.se.Ji?2:1};h.prototype.yJ=function(b){if(1==b.size)return!0;for(var c=0,d=b.size;c<d;c++){var e=b.get(c);this.tg.Tb(e);var f=this.tg.Mi();
this.ib.push(this.Kv(f,e,this.tg.Ta,!0));this.tg.ba();f=this.tg.ba();this.ib.push(this.Kv(f,e,this.tg.Ta,!1))}var g=this;this.ib.sort(function(a,b){return g.sR(a,b)});e=this.Ih.De;-1==e&&(e=this.Ih.ni(0));this.Ih.ao(this.ib.length);c=0;for(d=this.ib.length;c<d;c++)this.Ih.addElement(e,c);for(var c=!0,h=d=-1;c;){c=!1;f=this.Ih.wc(e);if(-1==f)break;for(var p=this.Ih.nb(f);-1!=p;){d=this.Ih.getData(f);h=this.Ih.getData(p);d=this.ib[d].Bp;h=this.ib[h].Bp;if(d==h)if(c=!0,this.Ih.jd(e,f),f=this.Ih.Se(p),
p=this.Ih.jd(e,p),-1==p||-1==f)break;else continue;f=p;p=this.Ih.nb(f)}}c=this.Ih.Zs(e);this.Ih.QF(e);if(0<c)return this.se=new a.Yd(5,d,h),!1;c=0;for(d=b.size;c<d;c++)this.YB(this.ib[c]);this.ib.length=0;return!0};h.prototype.lu=function(b){for(var c=0,d=b.size;c<d;c++){var e=b.get(c),f=this.Ir.read(e);if(-1!=f){var g=this.hb.ia(f);this.bk.add(g);this.hb.Jd(f,-1);this.YB(this.ib[g]);this.ib[g]=null;this.Ir.write(e,-1)}f=this.ux.read(e);-1!=f&&(g=this.hb.ia(f),this.bk.add(g),this.hb.Jd(f,-1),this.YB(this.ib[g]),
this.ib[g]=null,this.ux.write(e,-1))}c=0;for(d=b.size;c<d;c++){e=b.get(c);this.tg.Tb(e);f=this.tg.Mi();if(f.ra>f.oa){var h=this.tg.Db(),p=this.Kv(f,e,this.tg.Ta,!0);0<this.bk.size?(g=this.bk.Ec(),this.bk.Mf(),this.ib[g]=p):(g=this.ib.length,this.ib.push(p));f=this.hb.addElement(g,-1);-1==this.Ir.read(h)?this.Ir.write(h,f):this.ux.write(h,f);0==(this.np.read(this.tg.Ta)&3)&&this.Hn.add(f)}this.tg.ba();f=this.tg.ba();f.ra<f.oa&&(h=this.tg.Lk(),p=this.Kv(f,e,this.tg.Ta,!1),0<this.bk.size?(g=this.bk.Ec(),
this.bk.Mf(),this.ib[g]=p):(g=this.ib.length,this.ib.push(p)),f=this.hb.addElement(g,-1),-1==this.Ir.read(h)?this.Ir.write(h,f):this.ux.write(h,f),0==(this.np.read(this.tg.Ta)&3)&&this.Hn.add(f))}c=0;for(d=this.Hn.size;c<d&&0<this.Yt;c++)if(f=this.Hn.get(c),0==(this.np.read(this.ib[this.hb.ia(f)].rB)&3)){b=-1;for(var e=this.hb.Se(f),n=f,p=null,g=-1,y=0;-1!=e;){g=this.hb.ia(e);p=this.ib[g];g=p.rB;y=this.np.read(g);if(0!=(y&3))break;n=e;e=this.hb.Se(e)}-1==e?(h=1,e=n):(b=1==(y&3)?g:this.sB.read(g),
h=0!=p.ZG()?0:1,e=this.hb.nb(e));do{g=this.hb.ia(e);p=this.ib[g];g=p.rB;n=this.np.read(g);if(0==(n&3)){if(h!=p.ZG())return this.se=new a.Yd(6,g,-1),!1;y=0==h||p.mn()?2:1;n=n&252|y;this.np.write(g,y);if(2==y&&0==this.se.Ji&&this.sB.read(g)!=b&&(this.se=new a.Yd(7,g,-1),this.Zl))return!1;this.Yt--;if(0==this.Yt)return!0}1==(n&3)&&(b=g);n=e;e=this.hb.nb(e);h=0!=h?0:1}while(n!=f)}null!=this.Hn?this.Hn.clear(!1):this.Hn=new a.ha(0);return!0};h.prototype.Kv=function(b,c,d,e){if(322==b.G())b=this.OQ(b);
else throw a.g.za();b.Bp=c;b.rB=d;b.nr=0;b.MX(e);return b};h.prototype.OQ=function(c){var d;0<this.jp.length?(d=this.jp[this.jp.length-1],--this.jp.length,c.copyTo(d.Ie)):(d=new b,d.Ie=a.iE.me(c));return d};h.prototype.YB=function(a){322==a.Ie.G()&&this.jp.push(a)};h.prototype.EV=function(){for(var b=this.Y.D(),c=new a.ha(0),d=0;d<b;d++)c.add(d);var e=this;c.Fd(0,b,function(a,b){return e.Gv(a,b)});for(d=1;d<b;d++)if(0==this.Gv(c.get(d-1),c.get(d)))return this.se=new a.Yd(3,c.get(d-1),c.get(d)),0;
return 2};h.prototype.mW=function(){return this.NF()?this.MF(!0)?2:0:0};h.prototype.kW=function(){return this.DA()};h.prototype.FV=function(){for(var b=this.Y.D(),c=new a.ha(0),d=0;d<b;d++)c.add(d);var e=this;c.Fd(0,b,function(a,b){return e.oQ(a,b)});var f=Array(b);a.J.Ov(f,!1);f[c.get(0)]=!0;for(d=1;d<b;d++){var g=c.get(d-1),h=c.get(d);0==this.Gv(g,h)?f[h]=!1:f[h]=!0}for(var c=this.Y.Ka(),g=this.Y,h=0,p=1,d=0;d<b;d++)f[d]?p=d+1:(h<p&&c.Hd(g,h,p),h=d+1);h<p&&c.Hd(g,h,p);c.Xg(2,this.vp);return c};
h.prototype.nW=function(){var b=this.Y,c=b.Fa(),d=b.Fa(),e=this.Y.Ka(),f=this.Y,g=b.hasAttribute(1),h=g?a.na.GF(this.lh,b,!0):0,p=new a.ha(0),n=new a.ha(0);p.zb(a.J.truncate(b.D()/2+1));for(n.zb(a.J.truncate(b.D()/2+1));c.Ya();)if(d.Ya(),!(2>b.La(c.Ta))){d.eX();for(var y,k,D=!0;c.Ea();){var l=c.ba(),w=d.Mi();if(c.Db()>d.Db())break;D&&(p.add(c.Db()),n.add(d.Lk()),D=!1);k=p.Ec();var m=c.Lk();if(1<m-k){var K=new a.b;K.xc(b.Ba(k),b.Ba(m));y=K.length()}else y=l.Rb();k=n.Ec();m=d.Db();1<m-k?(K=new a.b,
K.xc(b.Ba(k),b.Ba(m)),k=K.length()):k=w.Rb();y>this.vp?p.add(c.Lk()):g&&(y=b.Wc(1,p.Ec(),0),l=l.Ms(1,0),Math.abs(l-y)>h&&p.add(c.Lk()));k>this.vp?n.add(d.Db()):g&&(y=b.Wc(1,n.Ec(),0),l=w.Ms(1,0),Math.abs(l-y)>h&&n.add(d.Db()))}p.Ec()<n.Ec()?p.size>n.size?p.Mf():n.Mf():(p.Ec()!=n.Ec()&&n.Mf(),n.Mf());if(2<=n.size+p.size){D=new a.Wa;w=0;for(l=p.size;w<l;w++)f.xe(p.get(w),D),0==w?e.Of(D):e.lineTo(D);for(w=n.size-1;0<w;w--)f.xe(n.get(w),D),e.lineTo(D);f.Qb(c.Ta)?e.sq():0<n.size&&(f.xe(n.get(0),D),e.lineTo(D))}null!=
p&&p.clear(!1);null!=n&&n.clear(!1)}e.Xg(2,this.vp);return e};h.prototype.lW=function(){return this.bY()};h.prototype.bY=function(){if(1736==this.Y.G()&&1==this.Y.Eo())return a.Cg.ql(this.Y,this.vp,!0,!1,this.ie);this.hj=new a.ed;this.hj.Jb(this.Y);0!=this.hj.ud&&(1!=this.gB&&a.vk.V(this.hj,this.vp,this.ie,!0),1736==this.Y.G()&&a.so.V(this.hj,this.hj.qd,this.gB,!1,this.ie));this.Y=this.hj.Pe(this.hj.qd);1736==this.Y.G()&&(this.Y.Fl(),this.Y.Op(0));this.Y.Xg(2,this.vp);return this.Y};h.dc=function(b,
c,d){if(b.u())return 1;var e=b.G();if(33==e)return 1;if(197==e)return d=new a.h,b.s(d),d.eh(a.na.$g(c,b,!1))?0:1;if(a.T.Nc(e))throw a.g.za();if(!a.T.fh(e))throw a.g.za();var e=a.na.$g(c,b,!1),f=b.Nk(e);d=d?-1:f;if(-1!=d)return d;1==d&&(e=0);d=(new h(b,c,d,0,!1)).DA();b.Xg(d,e);return d};h.Wq=function(b,c,d,e,f){null!=e&&(e.Ji=0,e.qm=-1,e.rm=-1);if(b.u())return 1;var g=b.G();if(33==g)return 1;var p=a.na.$g(c,b,!1);if(197==g)return c=new a.h,b.s(c),c.eh(p)?(null!=e&&(e.Ji=2,e.qm=-1,e.rm=-1),0):1;if(a.T.Nc(g))return p=
new a.Ua(b.description),p.cc(b,!0),h.Wq(p,c,d,e,f);f=b.Nk(p);d=d?-1:f;if(-1!=d)return d;c=new h(b,c,d,0,!1);if(550==g)d=c.EV();else if(1607==g)d=c.mW();else if(1736==g)d=c.kW();else throw a.g.za();b.Xg(d,p);null!=e&&0==d&&e.ls(c.se);return d};h.tb=function(b,c,d,e,f){null!=e&&(e.Ji=0,e.qm=-1,e.rm=-1);if(b.u())return 1;var g=b.G();if(33==g)return 1;var p=a.na.$g(c,b,!1);if(197==g)return c=new a.h,b.s(c),c.eh(p)?(null!=e&&(e.Ji=2,e.qm=-1,e.rm=-1),0):1;if(a.T.Nc(g))return g=new a.Ua(b.description),g.cc(b,
!0),h.Wq(g,c,d,e,f);b=new h(b,c,-1,0,!0);if(550==g||1607==g||1736==g)c=b.DA();else throw a.g.za();null!=e&&e.ls(b.se);return c};h.HK=function(b,c,d,e){if(b.u())return b;var f=b.G();if(33==f)return b;var g=a.na.$g(c,b,!1);if(197==f)return c=new a.h,b.s(c),c.eh(g)?b.Ka():b;if(a.T.Nc(f))return f=new a.Ua(b.description),f.cc(b,!0),h.HK(f,c,d,e);e=b.Nk(g);d=d?-1:e;if(2==d)return b;b=new h(b,c,d,0,!1);if(550==f)b=b.FV();else if(1607==f)b=b.nW();else if(1736==f)b=b.lW();else throw a.g.za();return b};h.GC=
function(b,c,d,e){if(b.u())return b;var f=b.G();if(33==f)return b;var g=a.na.$g(c,b,!1);if(197==f)return c=new a.h,b.s(c),c.eh(g)?b.Ka():b;if(a.T.Nc(f))return g=new a.Ua(b.description),g.cc(b,!0),h.GC(g,c,d,e);if(!a.T.fh(f))throw a.g.X("OGC simplify is not implemented for this geometry type "+f);return a.Cg.GC(b,g,!1,e)};h.prototype.li=function(b,c,d){if(b==c)return 0;b=this.Hi.get(b);var e=this.Hi.get(c);c=b>>1;var f=e>>1,g=new a.b,h=new a.b;this.Kf.fc(2*c,g);g.y+=0!=(b&1)?this.lk:-this.lk;this.Kf.fc(2*
f,h);h.y+=0!=(e&1)?this.lk:-this.lk;b=g.compare(h);return 0==b&&d?(d=this.nm.get(c)-this.nm.get(f),0>d?-1:0<d?1:0):b};h.prototype.Gv=function(b,c){if(b==c)return 0;var d=this.Y,e=d.Ba(b),f=d.Ba(c);if(e.x<f.x)return-1;if(e.x>f.x)return 1;if(e.y<f.y)return-1;if(e.y>f.y)return 1;for(e=1;e<this.TU;e++)for(var f=this.mI.pd(e),g=a.ma.Xa(f),h=0;h<g;h++){var p=d.Wc(f,b,h),n=d.Wc(f,c,h);if(p<n)return-1;if(p>n)return 1}return 0};h.prototype.oQ=function(a,b){var c=this.Gv(a,b);return 0==c?a<b?-1:1:c};h.prototype.sR=
function(a,b){if(a===b)return 0;var c=a.Ie.Dg(a.mn()?1:0);a.mn()&&c.Kr();a=b.Ie.Dg(b.mn()?1:0);b.mn()&&a.Kr();b=c.ev();var d=a.ev();return d==b?(b=c.Vi(a),Math.abs(b)<=8.881784197001252E-16*(Math.abs(a.x*c.y)+Math.abs(a.y*c.x))&&(b--,b++),0>b?1:0<b?-1:0):b<d?-1:1};return h}();a.py=k})(C||(C={}));(function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}ca(c,b);c.prototype.G=function(){return 30};c.local=function(){null===c.N&&(c.N=new c);return c.N};c.prototype.V=
function(b,c,d,e){return b instanceof a.T?(b=new a.gd(b),c=new a.gd(c),this.V(b,c,d,e).next()):new a.VM(b,c,d,e)};c.Wp=function(b,d,e,f){var g=b.ub(),h=d.ub();if(b.u()&&d.u())return g>h?b:d;if(b.u())return d;if(d.u())return b;var p=new a.h,n=new a.h,y=new a.h;b.s(p);d.s(n);y.I(p);y.Nb(n);p=a.na.$d(e,y,!0);n=b.G();y=d.G();return 33==n&&33==y?c.Om(b,d,p):n!=y?0<g||0<h?g>h?b:d:550==n?c.ye(b,d,p):c.ye(d,b,p):a.Cg.Wp(b,d,e,f)};c.Om=function(b,c,d){d=d*Math.sqrt(2)*1.00001;d*=d;var e=b.w(),f=c.w(),g=new a.Dd(b.description);
a.b.sc(e,f)>d&&(g.add(b),g.add(c));return g};c.ye=function(b,c,d){var e=b.Qa(0),f=b.D(),g=c.w(),h=b.Ka();d=d*Math.sqrt(2)*1.00001;var p=new a.h;b.s(p);p.P(d,d);if(p.contains(g)){d*=d;for(var p=!1,n=[],y=0;y<f;y++)n[y]=!1;for(y=0;y<f;y++){var k=e.read(2*y),l=e.read(2*y+1),k=k-g.x,l=l-g.y;k*k+l*l<=d&&(p=!0,n[y]=!0)}if(p)for(y=0;y<f;y++)n[y]||h.Hd(b,y,y+1);else h.Hd(b,0,f),h.add(c)}else h.Hd(b,0,f),h.add(c);return h};c.N=null;return c}(a.bf);a.qy=b})(C||(C={}));(function(a){var b=function(){function b(a,
b,c,d){this.qt=null==b;this.Ca=-1;this.ge=a;this.Pg=c;this.oV=b.next();this.mc=d}b.prototype.next=function(){if(this.qt)return null;var b;return null!=(b=this.ge.next())?(this.Ca=this.ge.Ia(),a.qy.Wp(b,this.oV,this.Pg,this.mc)):null};b.prototype.Ia=function(){return this.Ca};b.prototype.Oe=function(){return!0};return b}();a.VM=b})(C||(C={}));(function(a){var b=function(){function a(){}a.prototype.kw=function(){this.Kz=null;this.gy=-1;this.eL=!1};return a}(),c=function(){function a(){this.Cs=0;this.Tj=
[]}a.prototype.NO=function(a){this.Cs+=a.gy;this.Tj.push(a)};a.prototype.oW=function(){this.Cs-=this.Tj[this.Tj.length-1].gy;--this.Tj.length};a.prototype.Qy=function(){return this.Tj[this.Tj.length-1]};a.prototype.Eb=function(a){return a===this};return a}(),d=function(){function d(a,b,c){this.Ca=-1;this.Oc=!1;this.CI=[!1,!1,!1,!1];this.jr=[0,0,0,0];this.VA=!1;this.dl=-1;this.Yq=0;this.Xo=-1;this.xp=[];this.ge=a;this.Pg=b;this.mc=c}d.tb=function(a){var b=[],c=0;for(a=Object.keys(a);c<a.length;c++)b.push(Number(a[c]));
b.sort(function(a,b){return a-b});return b};d.prototype.iH=function(b){var c=this.xp[b],e=d.tb(c)[0],f=c[e],g=f.Qy().Kz,f=f.Qy().eL;delete c[e];f&&(g=a.Qm.local().V(g,this.Pg,!1,this.mc),0==b&&33==g.G()&&(b=new a.Dd(g.description),g.u()||b.add(g),g=b));return g};d.prototype.next=function(){if(this.Oc&&this.Xo==this.dl)return null;for(;!this.RK(););if(-1==this.dl)return null;if(this.VA){for(this.Xo++;;){if(this.Xo>this.dl||0>this.Xo)throw a.g.za();if(this.CI[this.Xo])break}this.Ca++;return this.iH(this.Xo)}this.Ca=
0;this.Xo=this.dl;return this.iH(this.dl)};d.prototype.Ia=function(){return this.Ca};d.prototype.RK=function(){if(this.Oc)return!0;var b=null;null!=this.ge&&(b=this.ge.next(),null==b&&(this.Oc=!0,this.ge=null));if(null!=b){var c=b.ub();this.CI[c]=!0;c>=this.dl&&!this.VA&&(this.eF(c,!1,b),c>this.dl&&!this.VA&&this.aX(c))}if(0<this.Yq)for(c=0;c<=this.dl;c++)for(;1<this.jr[c];)if(b=this.eQ(c),0!=b.length)b=a.Cg.nR(b,this.Pg,this.mc),this.eF(c,!0,b);else break;return this.Oc};d.prototype.eQ=function(a){for(var b=
[],c=[],e=this.xp[a],f=d.tb(e),g=0;g<f.length;g++){var h=f[g],p=e[h];if(this.Oc||1E4<p.Cs&&1<p.Tj.length){this.jr[a]-=p.Tj.length;for(this.Yq-=p.Tj.length;0<p.Tj.length;)b.push(p.Qy().Kz),p.oW();c.push(h)}}for(g=0;g<c.length;g++)delete e[c[g]];return b};d.prototype.aX=function(a){for(var b=0;b<a;b++)this.xp[b]=[],this.Yq-=this.jr[b],this.jr[b]=0};d.prototype.eF=function(a,e,f){var g=new b;g.kw();g.Kz=f;f=d.lf(f);g.gy=f;f=d.ye(f);if(a+1>this.xp.length)for(var h=0,p=Math.max(2,a+1);h<p;h++)this.xp.push([]);
h=this.xp[a][f];void 0===h&&(h=new c,this.xp[a][f]=h);g.eL=e;h.NO(g);this.jr[a]++;this.Yq++;this.dl=Math.max(this.dl,a)};d.ye=function(b){return 0<b?a.J.truncate(Math.log(b)/Math.log(4)+.5):0};d.lf=function(b){var c=b.G();if(a.T.fh(c))return b.D();if(33==c)return 1;if(197==c)return 4;if(a.T.Nc(c))return 2;throw a.g.za();};d.prototype.Oe=function(){return this.RK()};return d}();a.XM=d})(C||(C={}));(function(a){var b=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}ca(c,b);c.prototype.G=
function(){return 1};c.prototype.V=function(b,c,d,e){return void 0===e?new a.XM(b,c,d):this.xR(b,c,d,e)};c.prototype.xR=function(b,c,d,e){b=new a.gd([b,c]);return this.V(b,d,e).next()};c.local=function(){null===c.N&&(c.N=new c);return c.N};c.N=null;return c}(a.bf);a.ei=b})(C||(C={}));(function(a){var b;(function(a){a[a.nextPath=0]="nextPath";a[a.nextSegment=1]="nextSegment";a[a.iterate=2]="iterate"})(b||(b={}));b=function(){function b(b,c,d,e){this.Qt=new a.h;this.hV=b;this.iV=c;this.br=e;this.op=
-1;this.$l=!1;var f=b.ob;null!=f&&(f=e?f.tp:f.Mb,null!=f&&(this.Oc=!1,this.ta=d,this.Mb=f,this.lx=this.Mb.jf(),this.cr=this.$l=!0,this.Zb=0,e?this.op=c.aa():this.Bd=c.Fa()));this.$l||(f=c.ob,null!=f&&(f=e?f.tp:f.Mb,null!=f&&(this.Oc=!1,this.ta=d,this.Mb=f,this.lx=this.Mb.jf(),this.$l=!0,this.cr=!1,this.Zb=0,e?this.op=b.aa():this.Bd=b.Fa())));this.$l||(this.Di=e?a.na.ES(b,c,d,1<=b.Nk(0),1<=c.Nk(0)):a.na.DS(b,c,d))}b.prototype.next=function(){if(this.$l){if(this.Oc)return!1;for(var b=!0;b;)switch(this.Zb){case 0:b=
this.MV();break;case 1:b=this.NV();break;case 2:b=this.FA();break;default:throw a.g.X("internal error");}return this.Oc?!1:!0}return null==this.Di?!1:this.Di.next()};b.prototype.Vl=function(){return this.$l?this.cr?this.Mb.ia(this.Dt):this.br?this.op:this.Bd.Db():this.Di.Vl(this.Di.rg)};b.prototype.Rl=function(){return this.$l?this.cr?this.br?this.op:this.Bd.Db():this.Mb.ia(this.Dt):this.Di.Rl(this.Di.$f)};b.prototype.hA=function(){if(!this.br)throw a.g.X("internal error");return this.$l?this.cr?
this.Mb.JG(this.Dt):this.Qt:this.Di.hA(this.Di.rg)};b.prototype.Lz=function(){if(!this.br)throw a.g.X("internal error");return this.$l?this.cr?this.Qt:this.Mb.JG(this.Dt):this.Di.Lz(this.Di.$f)};b.prototype.MV=function(){if(!this.br){if(!this.Bd.Ya())return this.Oc=!0,!1;this.Zb=1;return!0}if(-1==--this.op)return this.Oc=!0,!1;this.cr?this.iV.nk(this.op,this.Qt):this.hV.nk(this.op,this.Qt);this.lx.Oi(this.Qt,this.ta);this.Zb=2;return!0};b.prototype.NV=function(){if(!this.Bd.Ea())return this.Zb=0,
!0;var a=this.Bd.ba();this.lx.bo(a,this.ta);this.Zb=2;return!0};b.prototype.FA=function(){this.Dt=this.lx.next();return-1==this.Dt?(this.Zb=this.br?0:1,!0):!1};return b}();a.Rm=b})(C||(C={}));(function(a){a=a.eN||(a.eN={});a[a.enumClosed=1]="enumClosed";a[a.enumHasNonlinearSegments=2]="enumHasNonlinearSegments";a[a.enumOGCStartPolygon=4]="enumOGCStartPolygon";a[a.enumCalcMask=4]="enumCalcMask"})(C||(C={}));(function(a){var b=function(){function b(){}b.Cb=function(c,d,e,f,g,k,l,m,w){var h=[0,0,0],
p=[0,0,0],n=[0,0,0],y=[0,0,0,0],D=new a.da(0),K=new a.da(0),q=new a.da(0);if(null!=l||null!=m||null!=w)if(a.l.Ri(d))a.uh.Cb(c,e,f,g,k,l,m,w);else{g=a.C.ca(g);e=a.C.ca(e);var r=a.C.ca(g-e);if(a.l.W(f,k)&&(a.l.W(e,g)||a.l.W(a.l.K(f),1.570796326794897)))null!=l&&(l.j=0),null!=m&&(m.j=0),null!=w&&(w.j=0);else{if(a.l.W(f,-k)){if(a.l.W(a.l.K(f),1.570796326794897)){null!=l&&(l.j=2*a.C.Wg(c,d));null!=m&&(m.j=0<f?a.C.ca(3.141592653589793-a.C.ca(g)):a.C.ca(g));null!=w&&(w.j=0<f?a.C.ca(g):a.C.ca(3.141592653589793-
a.C.ca(g)));return}a.l.W(a.l.K(r),3.141592653589793)&&(null!=l&&(l.j=2*a.C.Wg(c,d)),null!=m&&(m.j=0),null!=w&&(w.j=0))}else{if(a.l.W(a.l.K(f),1.570796326794897)||a.l.W(a.l.K(k),1.570796326794897)){a.Cl.Cb(c,d,e,f,g,k,l,m,w);return}if(a.l.W(e,g)||a.l.W(a.l.K(r),3.141592653589793)){a.Cl.Cb(c,d,e,f,g,k,l,m,w);return}if(a.l.wd(f)){a.Cl.Cb(c,d,e,f,g,k,l,m,w);return}}var P=Math.sqrt(1-d);g=a.C.ca(g-e);e=0;a.C.Fk(1,d,f,e,0,D,K,q);h[0]=D.j;h[1]=K.j;h[2]=q.j;a.C.Fk(1,d,k,g,0,D,K,q);p[0]=D.j;p[1]=K.j;p[2]=
q.j;n[0]=0;n[1]=0;n[2]=-1*d*a.C.n(1,d,f)*Math.sin(f);0>g?a.C.Nr(n,p,h,y,0):a.C.Nr(n,h,p,y,0);for(var K=[0,0,0],q=[0,0,0],t=[0,0,0],h=[0,0,0],D=[0,0,0],u=Math.acos(y[2]/1),N=1-d,U=Math.tan(u),v=1+U*U/N,x=2*n[2]*U/N,U=Math.sqrt(x*x-4*v*(n[2]*n[2]/N-1)),v=2*v,N=(-x+U)/v,x=(-x-U)/v,U=Math.tan(u),v=U*N+n[2],u=(N+x)/2,n=(v+(U*x+n[2]))/2,U=a.C.Zp(N-u,v-n),N=n/P*1.570796326794897,x=0;100>x;x++){v=a.C.Hm(d,N);v=v*v/Math.cos(N)*(Math.sin(N)-n*v/(1*(1-d)));if(a.l.wd(v))break;N-=v}var n=a.C.n(1,d,N)*Math.cos(N),
n=Math.sqrt((n-u)*(n+u)),U=1-U/n,U=U*(2-U),v=a.C.lo(K),u=a.C.lo(q),N=a.C.lo(t),z=a.C.Gu(t,K),x=a.C.Gu(t,q);a.C.fy(t,K,h);a.C.fy(t,q,D);K=Math.acos(z/(N*v));q=Math.acos(x/(N*u));q*=a.l.Bb(1,a.C.Gu(h,D));if(1.570796326794897<=a.l.K(K)&&1.570796326794897<=a.l.K(q)||3.141592653589793<a.l.K(K-q))K=(3.141592653589793-a.l.K(K))*a.l.Bb(1,K),q=(3.141592653589793-a.l.K(q))*a.l.Bb(1,q);h=a.C.mk(U,q);D=a.C.q(n,U,a.C.mk(U,K));h=a.C.q(n,U,h);h=a.l.K(h-D)*c;K=new a.da(0);q=new a.da(0);t=y[1]/1;t*=-a.l.Bb(1,r);D=
Math.acos(t)*a.l.Bb(1,r);b.Rf(c,d,e,f,h,D,K,q);a.l.W(g,K.j)&&a.l.W(k,q.j)||(U=a.C.Zp(a.C.ca(g-K.j),k-q.j),b.Rf(c,d,e,f,h,a.C.ca(D+3.141592653589793),K,q),v=a.C.Zp(a.C.ca(g-K.j),k-q.j),v<U&&(D=a.C.ca(D+3.141592653589793)));K=[0,0,0,0];q=[0,0,0,0];n=[0,0,0];U=[0,0,0];c=[0,0,0];e=[0,0,0];f=[0,0,0];t=[0,0,0];n[0]=0;n[1]=0;n[2]=P;U[0]=0;U[1]=0;U[2]=0;a.C.Nr(U,n,p,K,0);a.l.wd(k)?(c[0]=p[0],c[1]=p[1],c[2]=1,e[0]=1*Math.cos(g)-1*Math.sin(g),e[1]=1*Math.sin(g)+1*Math.cos(g)):(d=a.C.n(1,d,k)*Math.cos(k),c[0]=
0,c[1]=0,p[2]+=Math.tan(1.570796326794897-a.l.K(k))*d*a.l.Bb(1,k),e[0]=d*Math.cos(g)-d*Math.sin(g),e[1]=d*Math.sin(g)+d*Math.cos(g));e[2]=p[2];a.C.Nr(p,e,c,q,1);a.C.fy(q,K,f);a.C.fy(q,y,t);t=a.C.Gu(f,t)/(a.C.lo(f)*a.C.lo(t));t*=a.l.Bb(1,r);g=Math.acos(t)*-a.l.Bb(1,r);0<D&&0<g?g=a.C.ca(g+3.141592653589793):0>D&&0>g&&(g=a.C.ca(g+3.141592653589793));null!=l&&(l.j=h);null!=m&&(m.j=D);null!=w&&(w.j=g)}}};b.Rf=function(b,c,d,e,f,g,k,l){var h=[0,0,0],p=[0,0,0],n=[0,0,0],y=[0,0,0],D=[0,0,0],m=[0,0,0],w=[0,
0,0],K=[0,0,0,0],q=new a.da(0),r=new a.da(0),P=new a.da(0),t=new a.da(0),u=new a.da(0),N=new a.da(0);if(null!=k&&null!=l)if(a.l.Ri(c))a.uh.Rf(b,d,e,f,g,k,l);else if(a.l.wd(f))null!=k&&(k.j=d),null!=l&&(l.j=e);else if(g=a.C.ca(g),0>f&&(f=a.l.K(f),g=a.C.ca(g+3.141592653589793)),d=a.C.ca(d),e=a.C.ca(e),1.570796326794897<a.l.K(e)&&(d=a.C.ca(d+3.141592653589793),e=a.l.Bb(3.141592653589793,e)-e),a.l.W(a.l.K(e),1.570796326794897)||a.l.wd(e)||a.l.wd(g)||a.l.W(a.l.K(g),3.141592653589793))a.Cl.Rf(b,c,d,e,f,
g,k,l);else{var v=Math.sqrt(1-c);b=f/b;a.C.Fk(1,c,e,0,0,t,u,N);h[0]=t.j;h[1]=u.j;h[2]=u.j;w[0]=0;w[1]=0;w[2]=-1*c*a.C.n(1,c,e)*Math.sin(e);t=a.C.n(1,c,e);u=a.C.ca(1.570796326794897-g);N=Math.sin(u);f=Math.cos(e);e=Math.sin(e);D[0]=t*f-e*N;D[1]=Math.cos(u);D[2]=(1-c)*t*e+f*N;0>g?a.C.Nr(w,D,h,K,0):a.C.Nr(w,h,D,K,0);h=Math.acos(K[2]/1);K=Math.atan2(-K[1],-K[0]);e=1-c;D=Math.tan(h);u=1+D*D/e;t=2*w[2]*D/e;D=Math.sqrt(t*t-4*u*(w[2]*w[2]/e-1));u*=2;e=(-t+D)/u;t=(-t-D)/u;D=Math.tan(h);u=D*e+w[2];h=(e+t)/
2;w=(u+(D*t+w[2]))/2;D=a.C.Zp(e-h,u-w);v=w/v*1.570796326794897;for(e=0;100>e;e++){t=a.C.Hm(c,v);t=t*t/Math.cos(v)*(Math.sin(v)-w*t/(1*(1-c)));if(a.l.wd(t))break;v-=t}v=a.C.n(1,c,v)*Math.cos(v);v=Math.sqrt((v-h)*(v+h));w=1-D/v;w*=2-w;m=Math.acos(a.C.Gu(m,p)/(a.C.lo(m)*a.C.lo(p)));m*=a.l.Bb(1,p[0]);g=(a.C.q(v,w,a.C.mk(w,m))+b*a.l.Bb(1,g))/a.C.Wg(v,w);g=a.C.ca(1.570796326794897*g);g=a.C.Ep(w,g);a.C.n(v,w,g);D=a.C.ca(K+d);d=Math.cos(D);g=Math.sin(D);n[0]=y[0]*d+y[1]*-g;n[1]=y[0]*g+y[1]*d;n[2]=y[2];a.C.GP(c,
n[0],n[1],n[2],P,r,q);null!=k&&(k.j=r.j);null!=l&&(l.j=P.j)}};return b}();a.aE=b})(C||(C={}));(function(a){var b=function(){function b(b){this.ab=null;this.ou=new a.b;this.pu=new a.b;this.a=b}b.prototype.compare=function(a,b,c){this.a.Mc(b,this.ou);this.a.Mc(a.ia(c),this.pu);return this.ou.compare(this.pu)};return b}(),c=function(){function b(b){this.ag=new a.b;this.hl=new a.b;this.a=b}b.prototype.Zh=function(a){this.ag.L(a)};b.prototype.compare=function(a,b){this.a.Mc(a.ia(b),this.hl);return this.ag.compare(this.hl)};
return b}(),d=function(a){function b(b){var c=a.call(this,b.a,b.ta,!1)||this;c.bb=b;return c}ca(b,a);b.prototype.compare=function(a,b,c){if(this.Lg)return-1;var d=this.bb.fe.Fo(this.bb.si(b));a=a.ia(c);var e=this.bb.fe.Fo(this.bb.si(a));this.xn=c;return this.XF(b,d,a,e)};return b}(a.lE),e=function(a){function b(b){var c=a.call(this,b.a,b.ta)||this;c.bb=b;return c}ca(b,a);b.prototype.compare=function(a,b){if(this.Lg)return-1;a=this.bb.fe.Fo(this.bb.si(a.ia(b)));this.xn=b;return this.YF(b,a)};return b}(a.AN),
f=function(){function f(){this.Sc=this.Ef=this.cp=this.fe=this.Hh=this.Md=this.ib=this.a=null;this.hh=!1;this.Uh=this.Gn=this.Ce=this.jl=this.Jh=this.el=this.eg=this.te=null;this.Wh=this.zr=this.DB=this.ta=0;this.Kw=this.Ro=!1;this.sp=new a.b;this.pj=new a.b;this.ib=new a.Zc(8);this.Md=new a.Zc(5);this.Hh=new a.Nu;this.fe=new a.Nu;this.hh=!1;this.Uh=new a.b;this.Uh.ja(0,0);this.ta=0;this.Wh=-1;this.Ro=!1;this.a=null;this.Ef=new a.xk;this.Sc=new a.xk;this.Jh=new a.ha(0);this.jl=new a.jE;this.eg=new a.ha(0);
this.el=new a.ha(0);this.cp=new a.Wa}f.prototype.mY=function(b,c){var d=new a.Gd;d.AC();b.Vc(d);this.Xr(b);this.Ro=!1;this.ta=c;this.DB=c*c;c=this.JC();b.Vc(d);c||(this.JR(),c||this.JC());-1!=this.Wh&&(this.a.je(this.Wh),this.Wh=-1);this.a=null;return this.Ro};f.prototype.qY=function(a,b){this.Xr(a);this.Ro=!1;this.ta=b;this.DB=b*b;this.hh=!1;this.JC();this.hh||(this.hh=1==a.zq(b,!0,!1));-1!=this.Wh&&(this.a.je(this.Wh),this.Wh=-1);this.a=null};f.prototype.Ig=function(a,b){return this.ib.S(a,0+b)};
f.prototype.oC=function(a,b,c){this.ib.R(a,0+b,c)};f.prototype.si=function(a){return this.ib.S(a,2)};f.prototype.yX=function(a,b){this.ib.R(a,2,b)};f.prototype.UG=function(a,b){return this.ib.S(a,3+b)};f.prototype.Jq=function(a){return this.ib.S(a,7)};f.prototype.zm=function(a,b){this.ib.R(a,7,b)};f.prototype.Kq=function(a,b){return this.ib.S(a,3+this.Iq(a,b))};f.prototype.Yr=function(a,b,c){this.ib.R(a,3+this.Iq(a,b),c)};f.prototype.gT=function(a,b){return this.ib.S(a,5+this.Iq(a,b))};f.prototype.$r=
function(a,b,c){this.ib.R(a,5+this.Iq(a,b),c)};f.prototype.Ls=function(a){return this.Md.S(a,0)};f.prototype.vX=function(a,b){this.Md.R(a,0,b)};f.prototype.Pz=function(a){return this.Md.S(a,4)};f.prototype.Ur=function(a,b){this.Md.R(a,4,b)};f.prototype.Sl=function(a){return this.Md.S(a,1)};f.prototype.io=function(a,b){this.Md.R(a,1,b)};f.prototype.Oz=function(a){return this.Md.S(a,3)};f.prototype.vu=function(a,b){this.Md.R(a,3,b)};f.prototype.Sn=function(a){var b=this.Md.Me(),c=this.Hh.ni();this.vX(b,
c);-1!=a?(this.Hh.addElement(c,a),this.a.Va(a,this.Wh,b),this.Ur(b,this.a.Za(a))):this.Ur(b,-1);return b};f.prototype.aR=function(a){this.Md.jd(a)};f.prototype.cF=function(a,b){this.Hh.addElement(this.Ls(a),b);this.a.Va(b,this.Wh,a)};f.prototype.eu=function(a){var b=this.ib.Me(),c=this.fe.ni();this.yX(b,c);-1!=a&&this.fe.addElement(c,a);return b};f.prototype.dF=function(a,b){this.fe.addElement(this.si(a),b)};f.prototype.Mv=function(a){this.ib.jd(a);a=this.Jh.Pv(a);0<=a&&this.Jh.vJ(a)};f.prototype.Nj=
function(b,c){if(-1==this.Ig(b,0))this.oC(b,0,c);else if(-1==this.Ig(b,1))this.oC(b,1,c);else throw a.g.za();this.Oy(b,c)};f.prototype.Oy=function(a,b){var c=this.Sl(b);if(-1!=c){var d=this.Kq(c,b);this.$r(d,b,a);this.Yr(a,b,d);this.Yr(c,b,a);this.$r(a,b,c)}else this.$r(a,b,a),this.Yr(a,b,a),this.io(b,a)};f.prototype.Iq=function(a,b){return this.Ig(a,0)==b?0:1};f.prototype.Rn=function(a,b){var c=this.Oz(b);-1!=c&&(this.Ef.Jd(c,-1),this.vu(b,-1));var d,c=this.Sl(b);if(-1!=c){var e=d=c,f;do{f=!1;var g=
this.Iq(d,b),h=this.UG(d,g);if(this.Ig(d,g+1&1)==a){this.Nv(d);this.fe.zh(this.si(d));this.Mv(d);if(d==h){c=-1;break}c==d&&(c=this.Sl(b),e=h,f=!0)}d=h}while(d!=e||f);if(-1!=c){do g=this.Iq(d,b),h=this.UG(d,g),this.oC(d,g,a),d=h;while(d!=e);d=this.Sl(a);-1!=d?(e=this.Kq(d,a),f=this.Kq(c,a),e==d?(this.io(a,c),this.Oy(d,a),this.io(a,d)):f==c&&this.Oy(c,a),this.Yr(c,a,e),this.$r(e,a,c),this.Yr(d,a,f),this.$r(f,a,d)):this.io(a,c)}}c=this.Ls(a);d=this.Ls(b);for(e=this.Hh.wc(d);-1!=e;e=this.Hh.nb(e))this.a.Va(this.Hh.ia(e),
this.Wh,a);this.Hh.kz(c,d);this.aR(b)};f.prototype.xV=function(a,b){var c=this.Ig(a,0),d=this.Ig(a,1),e=this.Ig(b,0),f=this.Ig(b,1);this.fe.kz(this.si(a),this.si(b));b==this.Sl(c)&&this.io(c,a);b==this.Sl(d)&&this.io(d,a);this.Nv(b);this.Mv(b);c==e&&d==f||d==e&&c==f||(this.Do(c,this.sp),this.Do(e,this.pj),this.sp.vb(this.pj)?(c!=e&&this.Rn(c,e),d!=f&&this.Rn(d,f)):(d!=e&&this.Rn(d,e),c!=f&&this.Rn(c,f)))};f.prototype.Nv=function(a){var b=this.Ig(a,1);this.jG(a,this.Ig(a,0));this.jG(a,b)};f.prototype.jG=
function(a,b){var c=this.Kq(a,b),d=this.gT(a,b),e=this.Sl(b);c!=a?(this.Yr(d,b,c),this.$r(c,b,d),e==a&&this.io(b,c)):this.io(b,-1)};f.prototype.kF=function(a,b,c){var d=this.fe.wc(a),e=this.fe.ia(d);a=this.ff(e);var f=this.ff(this.a.U(e));this.a.as(e,b,c,!0);for(d=this.fe.nb(d);-1!=d;d=this.fe.nb(d)){var e=this.fe.ia(d),g=this.ff(e)==a;this.a.as(e,b,c,g)}d=b.Mq(c,0).ec();b=b.Mq(c,b.Wl(c)-1).Ac();this.fL(a,d);this.fL(f,b)};f.prototype.dG=function(a,b,c){var d=this.si(a),e=this.Ig(a,0),f=this.Ig(a,
1),g=this.eu(-1);this.Jh.add(g);this.zm(g,-3);this.eg.add(g);this.Nj(g,e);a=1;for(b=b.Wl(c);a<b;a++)c=this.Sn(-1),this.el.add(c),this.eg.add(c),this.Nj(g,c),g=this.eu(-1),this.Jh.add(g),this.zm(g,-3),this.eg.add(g),this.Nj(g,c);this.Nj(g,f);for(d=this.fe.wc(d);-1!=d;d=this.fe.nb(d))if(f=this.fe.ia(d),this.ff(f)==e){a=0;do 0<a&&(g=this.eg.get(a-1),this.cF(g,f),-1==this.Pz(g)&&this.Ur(g,this.a.Za(f))),g=this.eg.get(a),a+=2,this.dF(g,f),f=this.a.U(f);while(a<this.eg.size)}else{a=this.eg.size-1;do a<
this.eg.size-2&&(g=this.eg.get(a+1),this.cF(g,f),0>this.Pz(g)&&this.Ur(g,this.a.Za(f))),g=this.eg.get(a),a-=2,this.dF(g,f),f=this.a.U(f);while(0<=a)}this.eg.clear(!1)};f.prototype.ff=function(a){return this.a.Sa(a,this.Wh)};f.prototype.zJ=function(b,c,d){var e=this.Ig(c,0),f=new a.b;this.Do(e,f);var g=new a.b,h=this.Ig(c,1);this.Do(h,g);var p=d.Wl(b),n=d.Mq(b,0),k=new a.b;n.Oq(k);if(!f.vb(k)){if(!this.hh){var y=f.compare(this.Uh),k=k.compare(this.Uh);0>y*k&&(this.hh=!0)}this.zG(e,this.eg);this.el.add(e)}!this.hh&&
1<p&&(y=f.compare(g),n=n.Ac(),f.compare(n)!=y||n.compare(g)!=y?this.hh=!0:0>n.compare(this.Uh)&&(this.hh=!0));n=d.Mq(b,p-1);b=n.Ac();g.vb(b)||(this.hh||(y=g.compare(this.Uh),k=b.compare(this.Uh),0>y*k&&(this.hh=!0)),this.zG(h,this.eg),this.el.add(h));this.eg.add(c);g=0;for(h=this.eg.size;g<h;g++)b=this.eg.get(g),d=this.Jq(b),a.Zc.EA(d)&&(this.Sc.Jd(d,-1),this.zm(b,-1)),b!=c&&-3!=this.Jq(b)&&(this.Jh.add(b),this.zm(b,-3));this.eg.clear(!1)};f.prototype.LP=function(a,b){this.te.compare(this.Sc,this.Sc.ia(a),
b);this.te.Lg&&(this.te.Es(),this.tG(a,b))};f.prototype.tG=function(b,c){this.Ro=!0;b=this.Sc.ia(b);c=this.Sc.ia(c);var d,e;e=this.fe.Fo(this.si(b));var f=this.fe.Fo(this.si(c));d=this.a.jc(e);null==d&&(null==this.Ce&&(this.Ce=new a.Hb),this.a.nd(e,this.Ce),d=this.Ce);e=this.a.jc(f);null==e&&(null==this.Gn&&(this.Gn=new a.Hb),this.a.nd(f,this.Gn),e=this.Gn);this.jl.Hp(d);this.jl.Hp(e);this.jl.Ma(this.ta,!0)&&(this.hh=!0);this.MK(b,c,-1,this.jl);this.jl.clear()};f.prototype.VR=function(b,c){this.Ro=
!0;c=this.Sc.ia(c);var d,e=this.fe.Fo(this.si(c));d=this.a.jc(e);null==d&&(null==this.Ce&&(this.Ce=new a.Hb),this.a.nd(e,this.Ce),d=this.Ce);e=this.FG(b);this.jl.Hp(d);this.a.xj(e,this.cp);this.jl.vA(this.ta,this.cp,!0);this.MK(c,-1,b,this.jl);this.jl.clear()};f.prototype.VT=function(){if(0!=this.Jh.size)for(;0!=this.Jh.size;){if(this.Jh.size>Math.max(100,this.a.ud)){this.Jh.clear(!1);this.hh=!0;break}var a=this.Jh.Ec();this.Jh.Mf();this.zm(a,-1);-1!=this.rU(a)&&this.UT(a);this.Qo=!1}};f.prototype.UT=
function(a){var b;this.Qo?(b=this.Sc.ov(this.NI,this.II,a,!0),this.Qo=!1):b=this.Sc.bF(a);-1==b?this.xV(this.Sc.ia(this.Sc.IG()),a):(this.zm(a,b),this.te.Lg&&(this.te.Es(),this.tG(this.te.xn,b)))};f.prototype.rU=function(b){var c=this.Ig(b,0);b=this.Ig(b,1);this.Do(c,this.sp);this.Do(b,this.pj);if(a.b.sc(this.sp,this.pj)<=this.DB)return this.hh=!0,-1;var d=this.sp.compare(this.Uh),e=this.pj.compare(this.Uh);return 0>=d&&0<e?b:0>=e&&0<d?c:-1};f.prototype.HR=function(){var b=new a.ha(0);b.zb(this.a.ud);
for(var c=this.a.Pr(),d=c.next();-1!=d;d=c.next())-1!=this.a.Sa(d,this.Wh)&&b.add(d);this.a.Xx(b,b.size);this.IR(b)};f.prototype.IR=function(c){this.Ef.clear();this.Ef.Ne(c.size);this.Ef.Lp(new b(this.a));var d=new a.b;d.Yc();for(var e=-1,f=new a.b,g=0,h=c.size;g<h;g++){var p=c.get(g);this.a.Mc(p,f);f.vb(d)?(p=this.a.Sa(p,this.Wh),this.Rn(e,p)):(e=this.ff(p),this.a.Mc(p,d),p=this.Ef.yo(p),this.vu(e,p))}};f.prototype.JR=function(){var b=new a.ha(0);b.zb(this.a.ud);for(var c=this.Ef.wc(-1);-1!=c;c=
this.Ef.nb(c))b.add(this.Ef.ia(c));this.Ef.clear();this.a.Xx(b,b.size);for(var c=0,d=b.size;c<d;c++){var e=b.get(c),f=this.ff(e),e=this.Ef.yo(e);this.vu(f,e)}};f.prototype.zG=function(b,c){var d=this.Sl(b);if(-1!=d){var e=d;do a.Zc.EA(this.Jq(e))&&c.add(e),e=this.Kq(e,b);while(e!=d)}};f.prototype.fL=function(a,b){for(a=this.Hh.wc(this.Ls(a));-1!=a;a=this.Hh.nb(a))this.a.Nf(this.Hh.ia(a),b)};f.prototype.MK=function(a,b,c,d){this.Nv(a);-1!=b&&this.Nv(b);this.zJ(0,a,d);-1!=b&&this.zJ(1,b,d);-1!=c&&(d.ag.w(this.sp),
this.Do(c,this.pj),this.pj.vb(this.sp)||this.el.add(c));c=0;for(var e=this.el.size;c<e;c++){var f=this.el.get(c),g=this.Oz(f);-1!=g&&(this.Ef.Jd(g,-1),this.vu(f,-1))}c=this.si(a);e=-1!=b?this.si(b):-1;this.kF(c,d,0);-1!=b&&this.kF(e,d,1);this.dG(a,d,0);-1!=b&&this.dG(b,d,1);this.fe.zh(c);this.Mv(a);-1!=b&&(this.fe.zh(e),this.Mv(b));c=0;for(e=this.el.size;c<e;c++)f=this.el.get(c),f==this.zr&&(this.Kw=!0),g=this.Oz(f),-1==g&&(g=this.Ef.bF(this.FG(f)),-1==g?(a=this.ff(this.Ef.ia(this.Ef.IG())),this.Rn(a,
f)):this.vu(f,g));this.el.clear(!1)};f.prototype.Do=function(a,b){this.a.gH(this.Pz(a),b)};f.prototype.FG=function(a){return this.Hh.Fo(this.Ls(a))};f.prototype.JC=function(){this.Kw=!1;this.zr=-1;null==this.te&&(this.Sc.Dw=!1,this.te=new d(this),this.Sc.Uo=this.te);var b=new a.ha(0),f=null,g=null,h=0;this.II=this.NI=-1;this.Qo=!1;for(var p=this.Ef.wc(-1);-1!=p;){h++;this.Qo=!1;var n=this.Ef.ia(p);this.zr=this.ff(n);this.a.Mc(n,this.Uh);this.te.EK(this.Uh.y,this.Uh.x);var k,y=this.Sl(this.zr);k=-1==
y;if(!k){n=y;do{var l=this.Jq(n);-1==l?(this.Jh.add(n),this.zm(n,-3)):-3!=l&&b.add(l);n=this.Kq(n,this.zr)}while(n!=y)}if(0<b.size){this.Qo=1==b.size&&1==this.Jh.size;k=0;for(y=b.size;k<y;k++)n=this.Sc.ia(b.get(k)),this.zm(n,-2);var m=-2,w=-2;k=0;for(y=b.size;k<y;k++){l=b.get(k);if(-2==m){var q=this.Sc.Se(l);-1!=q?(n=this.Sc.ia(q),n=this.Jq(n),-2!=n&&(m=q)):m=-1}-2==w&&(l=this.Sc.nb(l),-1!=l?(n=this.Sc.ia(l),n=this.Jq(n),-2!=n&&(w=l)):w=-1);if(-2!=m&&-2!=w)break}k=0;for(y=b.size;k<y;k++)l=b.get(k),
n=this.Sc.ia(l),this.Sc.Jd(l,-1),this.zm(n,-1);b.clear(!1);this.NI=-1!=m?m:-1;this.II=-1!=w?w:-1;-1!=m&&-1!=w?this.Qo||this.LP(m,w):-1==m&&-1==w&&(this.Qo=!1)}else k&&(null==f&&(f=new e(this)),f.Zh(this.Uh),this.Sc.$J(f),f.Lg&&(f.Es(),this.VR(this.zr,f.xn)));this.VT();this.Kw?(this.Kw=!1,null==g&&(g=new c(this.a)),g.Zh(this.Uh),p=this.Ef.$J(g)):p=this.Ef.nb(p)}return this.Ro};f.prototype.Xr=function(b){this.a=b;this.Wh=this.a.Sd();this.ib.Ne(b.ud+32);this.Md.Ne(b.ud);this.Hh.ru(b.ud);this.Hh.ao(b.ud);
this.fe.ru(b.ud+32);this.fe.ao(b.ud+32);for(b=this.a.qd;-1!=b;b=this.a.Re(b))if(a.T.Hc(this.a.ic(b)))for(p=this.a.Pb(b);-1!=p;p=this.a.Sb(p)){var c=this.a.La(p),d=this.a.cb(p),e=this.Sn(d),f=this.eu(d);this.Nj(f,e);n=this.a.U(d);d=0;for(c-=2;d<c;d++){var g=this.a.U(n),h=this.Sn(n);this.Nj(f,h);f=this.eu(n);this.Nj(f,h);n=g}this.a.Qb(p)?(h=this.Sn(n),this.Nj(f,h),f=this.eu(n),this.Nj(f,h),this.Nj(f,e)):(h=this.Sn(n),this.Nj(f,h))}else for(var p=this.a.Pb(b);-1!=p;p=this.a.Sb(p))for(var n=this.a.cb(p),
e=0,c=this.a.La(p);e<c;e++)this.Sn(n),n=this.a.U(n);this.HR()};return f}();a.bE=f})(C||(C={}));(function(a){var b=function(b){function c(d,e,f){var g=b.call(this)||this;if(void 0!==d)if(void 0!==f){g.description=a.we.Hg();var h=new a.od;h.I(d,e,f);g.EC(h)}else if(void 0!==e)g.description=a.we.Hg(),g.rb(d,e);else if(d instanceof a.ma)g.description=d;else if(d instanceof a.b)g.description=a.we.Hg(),g.rb(d);else if(d instanceof c)g.description=d.description,g.rb(d.Te(),d.Cf()),null!==d.ka&&(g.ka=d.ka.slice(0));
else throw a.g.F();else g.description=a.we.Hg();return g}ca(c,b);c.prototype.w=function(b){if(void 0!==b){if(this.Gc())throw a.g.X("This operation should not be performed on an empty geometry.");b.ja(this.ka[0],this.ka[1])}else{if(this.Gc())throw a.g.X("This operation should not be performed on an empty geometry.");b=new a.b;b.ja(this.ka[0],this.ka[1]);return b}};c.prototype.rb=function(a,b){"number"===typeof a?(this.zc(),null==this.ka&&this.nq(),this.ka[0]=a,this.ka[1]=b):(this.zc(),this.rb(a.x,
a.y))};c.prototype.oA=function(){if(this.Gc())throw a.g.X("This operation should not be performed on an empty geometry.");var b=new a.od;b.x=this.ka[0];b.y=this.ka[1];b.z=this.description.kH()?this.ka[2]:a.ma.be(1);return b};c.prototype.EC=function(b){this.zc();var c=this.hasAttribute(1);c||a.ma.DH(1,b.z)||(this.Rd(1),c=!0);null==this.ka&&this.nq();this.ka[0]=b.x;this.ka[1]=b.y;c&&(this.ka[2]=b.z)};c.prototype.Te=function(){if(this.Gc())throw a.g.X("This operation should not be performed on an empty geometry.");
return this.ka[0]};c.prototype.DC=function(a){this.setAttribute(0,0,a)};c.prototype.Cf=function(){if(this.Gc())throw a.g.X("This operation should not be performed on an empty geometry.");return this.ka[1]};c.prototype.FK=function(a){this.setAttribute(0,1,a)};c.prototype.yT=function(){return this.Wc(1,0)};c.prototype.WX=function(a){this.setAttribute(1,0,a)};c.prototype.SS=function(){return this.Wc(2,0)};c.prototype.GX=function(a){this.setAttribute(2,0,a)};c.prototype.Bc=function(){return this.CG(3,
0)};c.prototype.pK=function(a){this.setAttribute(3,0,a)};c.prototype.Wc=function(b,c){var d=this.description.lg(b);return 0<=d?this.ka[this.description.zk(d)+c]:a.ma.be(b)};c.prototype.CG=function(b,c){var d=this.description.lg(b);return 0<=d?this.ka[this.description.zk(d)+c]:a.ma.be(b)};c.prototype.setAttribute=function(a,b,c){this.zc();var d=this.description.lg(a);0>d&&(this.Rd(a),d=this.description.lg(a));null==this.ka&&this.nq();this.ka[this.description.zk(d)+b]=c};c.prototype.G=function(){return 33};
c.prototype.ub=function(){return 0};c.prototype.Oa=function(){this.zc();null!=this.ka&&(this.ka[0]=NaN,this.ka[1]=NaN)};c.prototype.to=function(b){if(null!=this.ka){for(var c=a.we.vx(b,this.description),d=[],e=0,f=0,g=b.Ga;f<g;f++){var h=b.pd(f),n=a.ma.Xa(h);if(-1==c[f])for(var k=a.ma.be(h),h=0;h<n;h++)d[e]=k,e++;else for(k=this.description.zk(c[f]),h=0;h<n;h++)d[e]=this.ka[k],e++,k++}this.ka=d}this.description=b};c.prototype.nq=function(){this.QJ(this.description.Ye.length);c.N(this.description.Ye,
this.ka,this.description.Ye.length);this.ka[0]=NaN;this.ka[1]=NaN};c.prototype.Vc=function(b){if(b instanceof a.Gd){if(!this.Gc()){var c=this.w();b.ai(c,c);this.rb(c)}}else this.Gc()||(this.Rd(1),c=this.oA(),this.EC(b.Yp(c)))};c.prototype.copyTo=function(b){if(33!=b.G())throw a.g.F();b.zc();null==this.ka?(b.Oa(),b.ka=null,b.Eg(this.description)):(b.Eg(this.description),b.QJ(this.description.Ye.length),c.N(this.ka,b.ka,this.description.Ye.length))};c.prototype.Ka=function(){return new c(this.description)};
c.prototype.u=function(){return this.Gc()};c.prototype.Gc=function(){return null==this.ka||isNaN(this.ka[0])||isNaN(this.ka[1])};c.prototype.Wn=function(a){a.Oa();this.description!=a.description&&a.Eg(this.description);a.Nb(this)};c.prototype.s=function(a){this.Gc()?a.Oa():(a.o=this.ka[0],a.A=this.ka[1],a.v=this.ka[0],a.B=this.ka[1])};c.prototype.Jp=function(a){if(this.Gc())a.Oa();else{var b=this.oA();a.o=b.x;a.A=b.y;a.xf=b.z;a.v=b.x;a.B=b.y;a.Zg=b.z}};c.prototype.hg=function(b,c){var d=new a.yc;
if(this.Gc())return d.Oa(),d;b=this.Wc(b,c);d.ga=b;d.la=b;return d};c.prototype.QJ=function(b){if(null==this.ka)this.ka=a.J.df(b);else if(this.ka.length<b){for(var c=this.ka.slice(0),d=this.ka.length;d<b;d++)c[d]=0;this.ka=c}};c.N=function(a,b,c){if(0<c)for(c=0;c<a.length;c++)b[c]=a[c]};c.prototype.Eb=function(a){if(a==this)return!0;if(!(a instanceof c)||this.description!=a.description)return!1;if(this.Gc())return a.Gc()?!0:!1;for(var b=0,d=this.description.Ye.length;b<d;b++)if(this.ka[b]!=a.ka[b])return!1;
return!0};c.prototype.kc=function(){var b=this.description.kc();if(!this.Gc())for(var c=0,d=this.description.Ye.length;c<d;c++)var e=this.ka[c],e=a.J.truncate(e^e>>>32),b=a.J.bh(e,b);return b};c.prototype.Fg=function(){return null};return c}(a.T);a.Wa=b})(C||(C={}));(function(a){var b=function(){function a(a,b,c){void 0!==a&&(this.x=a,this.y=b,this.z=c)}a.pa=function(b,c,d){var e=new a;e.x=b;e.y=c;e.z=d;return e};a.prototype.I=function(a,b,c){this.x=a;this.y=b;this.z=c};a.prototype.Vx=function(){this.z=
this.y=this.x=0};a.prototype.normalize=function(){var a=this.length();0==a&&(this.x/=a,this.y/=a,this.z/=a)};a.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};a.prototype.sub=function(b){return new a(this.x-b.x,this.y-b.y,this.z-b.z)};a.prototype.Tg=function(b){return new a(this.x*b,this.y*b,this.z*b)};a.prototype.iv=function(){this.x=NaN};a.prototype.Dy=function(){return isNaN(this.x)};a.prototype.pi=function(a){return this.x*a.x+this.y*a.y+this.z*a.z};return a}();
a.od=b})(C||(C={}));(function(a){var b=function(){function b(a,b,c){this.tx=this.dx=null;this.sg=b;this.gV=b.y-c;this.fV=b.y+c;this.Hr=0;this.PA=a;this.ta=c;this.sV=c*c;this.QA=0!=c;this.yw=!1}b.prototype.result=function(){return 0!=this.Hr?1:0};b.prototype.tO=function(b){b=b.hc(b.ne(this.sg,!1));return a.b.sc(b,this.sg)<=this.sV?!0:!1};b.prototype.mG=function(a){if(!this.QA&&(this.PA&&this.sg.vb(a.ec())||this.sg.vb(a.Ac())))this.yw=!0;else if(a.ra==this.sg.y&&a.ra==a.oa){if(this.PA&&!this.QA){var b=
Math.max(a.ua,a.sa);this.sg.x>Math.min(a.ua,a.sa)&&this.sg.x<b&&(this.yw=!0)}}else{var c=!1,b=Math.max(a.ua,a.sa);this.sg.x>b?c=!0:this.sg.x>=Math.min(a.ua,a.sa)&&(c=0<a.Tq(!0,this.sg.y,this.tx,null)&&this.tx[0]<=this.sg.x);if(c){if(this.sg.y==a.ec().y){if(this.sg.y<a.Ac().y)return}else if(this.sg.y==a.Ac().y&&this.sg.y<a.ec().y)return;this.Hr=this.PA?this.Hr^1:this.Hr+(a.ec().y>a.Ac().y?1:-1)}}};b.prototype.mu=function(a){var b=a.hg(0,1);if(b.ga>this.fV||b.la<this.gV)return!1;if(this.QA&&this.tO(a))return!0;
if(b.ga>this.sg.y||b.la<this.sg.y)return!1;null==this.dx&&(this.dx=[null,null,null,null,null]);null==this.tx&&(this.tx=[0,0,0]);b=a.hH(this.dx);if(0<b)for(a=0;a<b;a++){var c=this.dx[a].get();this.mG(c);if(this.yw)return!0}else if(this.mG(a),this.yw)return!0;return!1};b.N=function(a,c,d){c=new b(0==a.Eo(),c,d);for(a=a.Fa();a.Ya();)for(;a.Ea();)if(d=a.ba(),c.mu(d))return-1;return c.result()};b.dc=function(c,d,e,f){var g=new a.h;c.ac(g);g.P(f,f);var h=new b(0==c.Eo(),e,f);c=c.Fa();var p=new a.h;p.I(g);
p.v=e.x+f;p.A=e.y-f;p.B=e.y+f;e=d.$z(p,f);for(f=e.next();-1!=f;f=e.next())if(c.Tb(d.ia(f)),c.Ea()&&(f=c.ba(),h.mu(f)))return-1;return h.result()};b.qn=function(c,d,e){if(c.u())return 0;var f=new a.h;c.ac(f);f.P(e,e);if(!f.contains(d))return 0;f=c.ob;if(null!=f){var g=f.Ii;if(null!=g){g=g.wm(d.x,d.y);if(1==g)return 1;if(0==g)return 0}f=f.Mb;if(null!=f)return b.dc(c,f,d,e)}return b.N(c,d,e)};b.yU=function(c,d,e,f){if(c.u())return 0;var g=new a.h;c.ac(g);g.P(f,f);if(!g.contains(d,e))return 0;g=c.ob;
if(null!=g&&(g=g.Ii,null!=g)){g=g.wm(d,e);if(1==g)return 1;if(0==g)return 0}return b.N(c,a.b.pa(d,e),f)};b.xU=function(a,c,d){return c.u()?0:b.qn(a,c.w(),d)};b.BA=function(c,d,e,f,g){var h=new a.h;c.ac(h);h.P(f,f);if(!h.contains(e))return 0;var p=new b(!0,e,f);if(null!=g){var n=new a.h;n.I(h);n.v=e.x+f;n.A=e.y-f;n.B=e.y+f;c=c.Fa();f=g.$z(n,f);for(n=f.next();-1!=n;n=f.next())if(c.Tb(g.ia(n),d),c.Ea()&&c.Ta==d&&(n=c.ba(),p.mu(n)))return-1}else if(c=c.Fa(),c.hC(d),c.Ya())for(;c.Ea();)if(n=c.ba(),p.mu(n))return-1;
return p.result()};b.AA=function(c,d,e){var f=new a.h;c.ac(f);f.P(e,e);if(!f.contains(d))return 0;d=new b(!1,d,e);for(e=c.Fa();e.Ya();)if(!(0>c.Ym(e.Ta))){for(d.Hr=0;e.Ea();)if(f=e.ba(),d.mu(f))return-1;if(0!=d.Hr)return 1}return d.result()};b.Ug=function(c,d,e,f,g){var h=c.Fa();h.hC(d);if(!h.Ya()||!h.Ea())throw a.g.X("corrupted geometry");for(d=2;2==d&&h.Ea();)d=h.ba().hc(.5),d=b.BA(c,e,d,f,g);if(2==d)throw a.g.X("internal error");return 1==d?!0:!1};b.vm=function(a,b){a=a.D();return 16>a?!1:2*a+
Math.log(a)/Math.log(2)*1*b<1*a*b};return b}();a.cf=b})(C||(C={}));(function(a){var b=function(a){function b(b){return a.call(this,!0,b)||this}ca(b,a);b.prototype.Ka=function(){return new b(this.description)};b.prototype.ub=function(){return 2};b.prototype.G=function(){return 1736};b.prototype.yH=function(a,b,c){this.gU(a,b,c)};b.prototype.HS=function(){this.ZS()};return b}(a.Bl);a.Ja=b})(C||(C={}));(function(a){(function(a){a[a.PiPOutside=0]="PiPOutside";a[a.PiPInside=1]="PiPInside";a[a.PiPBoundary=
2]="PiPBoundary"})(a.jN||(a.jN={}));var b=function(){function b(){}b.KH=function(b,c,d){b=a.cf.xU(b,c,d);return 0==b?0:1==b?1:2};b.ee=function(b,c,d){b=a.cf.qn(b,c,d);return 0==b?0:1==b?1:2};b.BN=function(b,c,d,e){b=a.cf.yU(b,c,d,e);return 0==b?0:1==b?1:2};b.o_=function(b,c,d,e){return 0==a.cf.BA(b,c,d,e,null)?0:1};b.AA=function(b,c,d){return 0==a.cf.AA(b,c,d)?0:1};b.YY=function(c,d,e,f,g){if(d.length<e||g.length<e)throw a.g.F();for(var h=0;h<e;h++)g[h]=b.ee(c,d[h],f)};b.$Y=function(c,d,e,f,g){if(d.length/
2<e||g.length<e)throw a.g.F();for(var h=0;h<e;h++)g[h]=b.BN(c,d[2*h],d[2*h+1],f)};b.UK=function(c,d,e,f,g){if(1736==c.G())b.YY(c,d,e,f,g);else if(197==c.G()){var h=new a.h;c.s(h);b.OV(h,d,e,f,g)}else throw a.g.X("invalid_call");};b.A_=function(c,d,e,f,g){if(1736==c.G())b.$Y(c,d,e,f,g);else if(197==c.G()){var h=new a.h;c.s(h);b.YV(h,d,e,f,g)}else throw a.g.Da();};b.OV=function(b,c,d,e,f){if(c.length<d||f.length<d)throw a.g.F();if(b.u())for(e=0;e<d;e++)f[e]=0;else for(b.P(.5*-e,.5*-e),b.P(.5*e,.5*e),
e=0;e<d;e++)b.contains(c[e])?f[e]=1:b.contains(c[e])?f[e]=2:f[e]=0};b.YV=function(b,c,d,e,f){if(c.length/2<d||f.length<d)throw a.g.F();if(b.u())for(e=0;e<d;e++)f[e]=0;else for(b.P(.5*-e,.5*-e),b.P(.5*e,.5*e),e=0;e<d;e++)b.contains(c[2*e],c[2*e+1])?f[e]=1:b.contains(c[2*e],c[2*e+1])?f[e]=2:f[e]=0};b.xL=function(a,b,c,d,e){for(var f=0;f<c;f++)e[f]=a.ot(b[f],d)?2:0};b.bZ=function(a,b,c,d,e){var f=a.ob,g=null;null!=f&&(g=f.Ii);for(var f=c,h=0;h<c;h++)if(e[h]=1,null!=g){var p=b[h];0==g.wm(p.x,p.y)&&(e[h]=
0,f--)}if(0!=f)for(a=a.Fa();a.Ya()&&0!=f;)for(;a.Ea()&&0!=f;)for(g=a.ba(),h=0;h<c&&0!=f;h++)1==e[h]&&g.ot(b[h],d)&&(e[h]=2,f--);for(h=0;h<c;h++)1==e[h]&&(e[h]=0)};b.VK=function(c,d,e,f,g){var h=c.G();if(1607==h)b.bZ(c,d,e,f,g);else if(a.T.Nc(h))b.xL(c,d,e,f,g);else throw a.g.X("Invalid call.");};return b}();a.fd=b})(C||(C={}));(function(a){var b=function(a){function b(b,c){var d;2==arguments.length?(d=a.call(this,!1,b.description)||this,d.Of(b),d.lineTo(c)):d=a.call(this,!1,b)||this;return d}ca(b,
a);b.prototype.Ka=function(){return new b(this.description)};b.prototype.ub=function(){return 1};b.prototype.G=function(){return 1607};b.prototype.yH=function(a,b,c,d){this.hU(a,b,c,d)};return b}(a.Bl);a.Ua=b})(C||(C={}));(function(a){var b=function(){function a(){}a.JZ=function(){};return a}();a.FZ=b})(C||(C={}));(function(a){(function(a){a[a.clipWithInputHorizon=1]="clipWithInputHorizon";a[a.clipWithOutputHorizon=2]="clipWithOutputHorizon"})(a.RL||(a.RL={}));var b=function(){function a(){this.Ol=
3;this.sz=this.Cv=NaN}a.prototype.DT=function(){return this.gt(1)};a.prototype.ET=function(){return this.gt(2)};a.prototype.gt=function(a){return 0!=(this.Ol&a)};a.prototype.Sf=function(){var b=new a;b.Cv=this.Cv;b.sz=this.sz;b.Ol=this.Ol;return b};return a}();a.pZ=b;(function(a){a[a.Dont_Geonomalize_Polygon=2147483648]="Dont_Geonomalize_Polygon";a[a.Dont_Adjust_At_Poles=1073741824]="Dont_Adjust_At_Poles"})(a.SL||(a.SL={}));var c=function(){function a(){this.Ol=0}a.prototype.gt=function(a){return 0!=
(this.Ol&a)};a.me=function(b){var c=new a;c.Ol=b.Ol;return c};a.prototype.ZN=function(a){this.Ol=a.Ol};return a}();a.qZ=c;var d=function(){function b(b,c,d){this.he=b;this.Ee=c;this.qg=new a.h;this.qg.I(d);this.bV=b.kc()+c.kc()+this.qg.kc().toString()}b.prototype.kc=function(){return this.bV};b.prototype.Eb=function(a){return this==a||this.he.Eb(a.he)&&this.Ee.Eb(a.Ee)&&this.qg.Eb(a.qg)};return b}();a.GZ=d;d=function(){function d(){this.Ee=this.he=null;this.qI=new b;this.rI=new c;this.xr=this.re=
null;this.sr=this.Yl=!0}d.Gs=function(a,b,c,e){var f;void 0===e&&(e=null);void 0===f&&(f=null);var g=new d;g.kq(a,b,c,e,f);return g};d.prototype.kq=function(b,c,d,e,f){if(null==b||null==c)throw a.g.X("invalidArgument");this.he=b;this.Ee=c;this.sr=this.Yl=!1;null!=e&&(this.qI=e.Sf());null!=f&&this.rI.ZN(f);f=!1;1==c.Fb()&&null!=e&&(e=e.Cv,isNaN(e)||0==e||(f=!0));if(b==c)this.Yl=!f,this.sr=!0;else{e=b.Fb();var g=c.Fb();if(0==e||0==g){if(null!=d)throw a.g.F();null!=b.Td()&&null!=c.Td()&&(this.Yl=b.Td().Eb(c.Td()))}else 3==
e||3==g?this.Yl=b.Eb(c):this.he.JT(this.Ee)?this.Yl=!f:this.Yl=!1,this.re=d,null!=this.re&&this.re.Tp(),this.sr=(null==this.re||0==this.re.count())&&this.he.lc().Eb(this.Ee.lc())}this.jL()};d.prototype.Wv=function(){var a=new d;a.he=this.Ee;a.Ee=this.he;null!=this.re&&(a.re=this.re.Wv());a.Yl=this.Yl;a.sr=this.sr;a.jL();return a};d.prototype.No=function(){return this.Yl};d.prototype.FS=function(){return this.qI.Sf()};d.prototype.Eb=function(a){return a==this?!0:a instanceof d&&this.he.Eb(a.he)&&this.Ee.Eb(a.Ee)?
this.re==a.re?!0:null!=this.re&&null!=a.re&&this.re.Eb(a.re)?!0:!1:!1};d.prototype.jL=function(){this.xr=new a.qo(this)};d.z_={};return d}();a.rs=d})(C||(C={}));(function(a){var b=function(){function b(){}b.uq=function(a){return a*b.$V};b.Wx=function(a,c){return b.PY(c-a)};b.SY=function(b){if(-360<=b&&720>b)return 0>b?b+=360:360<=b&&(b-=360),b;b=a.Ub.TL(b);0>b&&(b+=360);return b};b.PY=function(a){a=b.SY(a);180<a&&(a-=360);return a};b.SZ=.0174532925199433;b.$V=57.29577951308232;return b}();a.ks=b;
var c=function(){function c(){}c.Qj=function(b,c){var d=new a.h;b.s(d);var e=a.fb.Ch(c),f=new a.h;f.I(e);f.o=d.o;f.v=d.v;f.P(.01*f.ea(),0);e=a.na.$d(c,d,!1);return f.contains(d)?b:a.le.clip(b,f,e,0)};c.jt=function(b,d,e,f,g){if(!a.fb.Ic(d))throw a.g.F();var h=a.na.$g(d,b,!1),p=a.fb.Ch(d),n=a.fb.lc(d),k=n.Td().Bi,y=a.fb.hw(n),n=a.fb.Sv(n),y=y*(2-y),l=new a.yc;p.Yn(l);var m=[[0,0],[0,0]];2==a.ve.Fb(d)?f?(m[0][0]=c.Tn(g,l),m[0][1]=p.Cq(),a.fb.nu(),p=m[0][0]*k):(m[0][0]=p.Jk(),m[0][1]=g,a.fb.nu(),p=m[0][1]*
k):p=g*k;if(!f&&0!=p)throw a.g.F();var D=new a.da,w=new a.ed;b=w.Jb(b);for(var q=[0],r=new a.b,K=new a.b,t=new a.b,u=new a.b,v=new a.b,x=new a.b,z=w.Pb(b);-1!=z;z=w.Sb(z)){var I=w.cb(z);w.w(I,t);for(var B=!1,A=I=w.U(I);-1!=A;A=w.U(A)){if(A==I){if(B)break;B=!0}w.w(A,u);if(f&&h<g-t.x&&u.x-g>h||h<g-u.x&&t.x-g>h||!f&&h<-t.y&&u.y>h||h<-u.y&&t.y>h){do if(!(Math.abs(t.x-u.x)>=.5*l.O())){2==a.ve.Fb(d)?(m[0][0]=c.Tn(t.x,l),m[0][1]=t.y,m[1][0]=c.Tn(u.x,l),m[1][1]=u.y,a.fb.xW(),v.x=m[0][0]*k,v.y=m[0][1]*k,x.x=
m[1][0]*k,x.y=m[1][1]*k):(v.x=t.x*k,v.y=t.y*k,x.x=u.x*k,x.y=u.y*k);x.x=6.283185307179586*(u.x-t.x)/l.O()+v.x;if(f){if(K.x=p,K.y=c.sA(n,y,v,x,p,e),isNaN(K.y))break}else{K.x=c.pA(n,y,v,x,e);if(isNaN(K.x))break;K.y=0}a.mb.Kd(n,y,v.x,v.y,x.x,x.y,D,null,null,e);var F=D.j;a.mb.Kd(n,y,v.x,v.y,K.x,K.y,D,null,null,e);var C=D.j;2==a.ve.Fb(d)?(m[0][0]=K.x/k,m[0][1]=K.y/k,a.fb.tS(),f?(r.y=m[0][1],r.x=g):(r.x=c.zl(m[0][0],t.x,u.x,l),r.y=g)):f?(r.x=g,r.y=K.y/k):(r.x=c.zl(K.x/k,t.x,u.x,l),r.y=g);q[0]=0<F?a.J.tk(C/
F,0,1):.5;0!=q[0]&&1!=q[0]&&(F=w.Ra(A),w.Em(F,q,1),w.rb(w.U(F),r.x,r.y))}while(0)}t.L(u)}}return w.Pe(b)};c.cn=function(b,d,e,f,g){if(b.u())return b;var h=a.fb.ce(d);return c.Aq(b,e-180*h,360*h,d,f,g,!0)};c.sA=function(b,d,e,f,g,n){if(3.141592653589793<=Math.abs(e.x-f.x)||!c.Ug(e.x,f.x,g))return NaN;var h;e.x>f.x?h=f:(h=e,e=f);f=new a.da(0);var p=new a.da(0),k=new a.da(0);a.mb.Kd(b,d,h.x,h.y,e.x,e.y,p,f,null,n);var y=p.j,l=0,m=1,D=new a.b;for(D.L(h);y*(m-l)>1E-12*b;){var w=.5*(l+m);a.mb.Sj(b,d,h.x,
h.y,y*w,f.j,p,k,n);D.x=p.j;D.y=k.j;if(D.x==g)break;if(c.Ug(h.x,D.x,g))m=w;else if(c.Ug(e.x,D.x,g))l=w;else return NaN}return D.y};c.Ug=function(a,c,d){a=b.uq(a);c=b.Wx(a,b.uq(c));d=b.Wx(a,b.uq(d));return 0==d||0<c&&0<d&&d<=c||0>c&&0>d&&d>=c?!0:!1};c.Tn=function(a,b){var c=b.la-b.ga;return b.yu(a-Math.floor((a-b.ga)/c)*c)};c.zl=function(b,c,d,e){var f=new a.yc;f.I(c,d);d=e.O();b=Math.floor((b-c)/d)*d+b;for(f=f.Tf();Math.abs(b-f)>Math.abs(b+d-f);)b+=d;return b};c.pA=function(b,c,d,e,f){var g;d.y>e.y?
g=e:(g=d,d=e);e=new a.yc;e.I(g.y,d.y);if(!e.contains(0)||3.141592653589793<=Math.abs(g.x-d.x))return NaN;if(g.x==d.x)return g.x;var h=new a.da(0),p=new a.da(0),n=new a.da(0);a.mb.Kd(b,c,g.x,g.y,d.x,d.y,p,h,null,f);var k=p.j,y=0,l=1,m=new a.b;for(m.L(g);k*(l-y)>1E-12*b;){var w=.5*(y+l);a.mb.Sj(b,c,g.x,g.y,k*w,h.j,p,n,f);m.x=p.j;m.y=n.j;e.I(g.y,m.y);if(0==m.y)break;if(e.contains(0))l=w;else if(e.I(d.y,m.y),e.contains(0))y=w;else return NaN}return m.x};c.Aq=function(b,c,d,e,f,g,n){var h=new a.h;b.s(h);
if(h.u())return b;var p=new a.yc;h.Yn(p);var k=new a.yc;k.I(c,c+d);if(k.contains(p)&&k.la!=p.la)return b;var y=new a.h;y.I(h);var l=b.G();if(33==l){y=f?b:b.Sf();h=y.Te();if(h<k.ga||h>=k.la||n&&h==k.la)h+=Math.ceil((k.ga-h)/d)*d,h=k.yu(h),y.DC(h);return y}if(550==l){y=f?b:b.Sf();e=y.Qa(0);l=2*y.D();b=!1;for(f=0;f<l;f+=2)if(h=e.read(f),h<k.ga||h>=k.la||n&&h==k.la)b=!0,h+=Math.ceil((k.ga-h)/d)*d,h=k.yu(h),e.write(f,h);b&&y.Cc(1993);return y}if(k.contains(p))return b;if(197==l)return d=f?b:b.Sf(),h.Ma(y),
d.Np(h),d;var m=.1*Math.max(h.ea(),h.O());y.P(0,m);n=b;k=e.pe(0);b=a.ei.local();f=new a.Gd;for(var w=0;;){var D=Math.floor((p.ga-c)/d),q=Math.ceil((p.la-c)/d);if(3<q-D){D=Math.floor(.5*(q+D));y.o=h.o-m;y.v=c+d*D;var r=a.le.clip(n,y,k,g);y.o=y.v;y.v=h.v+m;var K=a.le.clip(n,y,k,g);f.zg((D-q)*d,0);K.Vc(f);1736==l?n=b.V(r,K,e,null):(n=r,n.add(K,!1));n.s(h);h.Yn(p);w++}else break}y.o=c;y.v=c+d;c=new a.h;c.I(y);c.P(k,0);c=Math.floor((h.o-y.o)/d)*d;0!=c?(y.move(c,0),f.zg(-c,0)):f.sC();c=1607==l?new a.Ua(n.description):
new a.Ja(n.description);g=new a.h;for(p=new a.h;h.v>y.o;){m=a.le.clip(n,y,k,0);m.s(p);if(1607==l?!m.u()&&(p.O()>k||p.ea()>k):!m.u()&&(1736!=l||p.O()>k))m.Vc(f),m.s(p),c.s(g),g.P(k,k),g.Yb(p)&&1736==l?c=b.V(c,m,e,null):c.add(m,!1);y.move(d,0);f.shift(-d,0)}return c};c.CJ=function(b,c,d,e,f){var g=new a.Dd(d.description);g.Hd(d,0,-1);f=a.fb.Vg(g,b,c,f);g=d.D();e.Oa();if(!a.fb.Ic(b)||g!=f.D())return!1;var h=new a.h;d.s(h);var p=new a.h;f.s(p);h=h.O();p=p.O();if(0!=h&&0!=p){if(p/=h,b=a.fb.Ch(c).O()/a.fb.Ch(b).O(),
1E-10<Math.abs(p/b-1))return!1}else if(0!=h||0!=p)return!1;e.add(d,!1);for(d=0;d<g;d++)b=f.Ba(d),e.rb(d,b);return!0};c.xA=function(){throw a.g.af();};return c}();a.gi=c})(C||(C={}));(function(a){var b;(function(a){a[a.Clip=0]="Clip";a[a.DontClip=1]="DontClip";a[a.PannableFold=2]="PannableFold"})(b=a.Qi||(a.Qi={}));var c;(function(a){a[a.Geodesic=0]="Geodesic";a[a.Loxodrome=1]="Loxodrome";a[a.GreatElliptic=2]="GreatElliptic";a[a.NormalSection=3]="NormalSection";a[a.ShapePreserving=4]="ShapePreserving"})(c=
a.cM||(a.cM={}));var d=function(){function d(){}d.iw=function(b,c,d){if(d||0<c){b=b.toString(a.Uc.PE_STR_NAME_CANON|a.Uc.PE_STR_AUTH_NONE);c=[];for(d=0;d<b.length;d++)c[d]="a"<=b[d]&&"z">=b[d]?c[d]=b[d].toUpperCase():b[d];return c.join()}return b.toString(a.Uc.PE_STR_AUTH_TOP)};d.qs=function(b,c,d,e){var f=e.length,g=d.D();if(0!=g){var h=d.Qa(0),p=Math.min(g,f),n=0,k=b.Jg();isNaN(c)&&(c=0);var y=b.Ic();b=y?b.lc().oe().O():0;for(var l=179*b/360;0<g;){h.Hx(n<<1,p,e,0,!0);a.fi.projToGeogCenter(k,p,e,
c);if(y)for(var m=0;m<p;m++){var D=e[m][0]-c,q=a.Ub.sign(D),w=h.read(2*(n+m));0>q*a.Ub.sign(w)&&Math.abs(D)>l&&(e[m][0]+=-q*b)}h.hy(n<<1,p,e,0,!0);n+=p;g-=p;p=Math.min(g,f)}d.Cc(1993)}};d.rZ=function(b,c,d,e){var f=b.Jg();isNaN(c)&&(c=0);var g=d.Te();e[0][0]=g;e[0][1]=d.Cf();a.fi.projToGeogCenter(f,1,e,c);b.Ic()&&(c=a.Ub.sign(e[0][0]-c),0>c*a.Ub.sign(g)&&(b=b.lc().oe().O(),Math.abs(e[0][0])>179*b/360&&(e[0][0]-=c*b)));d.rb(e[0][0],e[0][1])};d.$M=function(b,c,d,e){var f=0,g=b.Jg();isNaN(f)&&(f=0);
var h=b.Ic(),p=b.ce();b=360*p;for(var p=179*p,n=e.length,k=0;k<d;){for(var y=k;y<d&&c[y].isNaN();++y)k++;var l=Math.min(n,d-k);if(0<l){for(var y=1,m=k+1;y<l;++y,++m)if(c[m].isNaN()){l=y;break}a.na.mz(e,c,k,l);a.fi.projToGeogCenter(g,l,e,f);if(h)for(y=0,m=k;y<l;++y,++m){var D=c[m].x,q=e[y][0]-f,w=a.Ub.sign(q);0>w*a.Ub.sign(D)&&Math.abs(q)>p&&(e[y][0]-=w*b)}a.na.lz(c,k,e,l);k+=l}}};d.ry=function(b,c,d){var e=d.length,f=c.D();if(!(1>f)){var g=c.Qa(0),h=Math.min(f,e),p=0,n=b.Jg(),k=b.Ic(),y=k?b.oe().O():
0,l=179*y/360,m=0;for(k&&(m=b.ri());0<f;){g.Hx(p<<1,h,d,0,!0);a.fi.geogToProj(n,h,d);if(k)for(b=0;b<h;b++){var D=d[b][0],q=a.Ub.sign(D),w=g.read(2*(p+b))-m;0>q*a.Ub.sign(w)&&Math.abs(D)>l&&(d[b][0]+=-q*y)}g.hy(p<<1,h,d,0,!0);p+=h;f-=h;h=Math.min(f,e)}c.Cc(1993)}};d.oZ=function(b,c,d){if(!c.u()){var e=b.Jg();d[0][0]=c.Te();d[0][1]=c.Cf();a.fi.geogToProj(e,1,d);if(b.Ic()){var e=a.Ub.sign(d[0][0]),f=b.ri();0>e*a.Ub.sign(c.Te()-f)&&(b=b.oe().O(),Math.abs(d[0][0])>179*b/360&&(d[0][0]-=e*b))}c.rb(d[0][0],
d[0][1])}};d.ZM=function(b,c,d,e){if(0!=d){var f=b.Jg(),g=b.Ic(),h=g?b.oe().O():0,p=179*h/360,n=0;g&&(n=b.ri());for(b=0;b<d;){for(var k=b;k<d&&c[k].isNaN();++k)b++;var y=Math.min(e.length,d-b);if(0<y){for(var k=1,l=b+1;k<y;++k,++l)if(c[l].isNaN()){y=k;break}a.na.mz(e,c,b,y);a.fi.geogToProj(f,y,e);if(g)for(k=0,l=b;k<y;k++){var m=e[k][0],D=a.Ub.sign(m);0>D*a.Ub.sign(c[l].x-n)&&Math.abs(m)>p&&(e[k][0]-=D*h)}a.na.lz(c,b,e,y);b+=y}}}};d.ps=function(b,c,d,e){var f=c.D();if(0!=f){var g=c.Qa(0),h=b.he,p=
b.Ee,n=h.lc().Zi(),k=p.lc().Zi(),y=h.ce(),l=p.ce();b=b.re;if(null==b||0==b.count()){d=n/k;e=(h.kn()-p.kn())*l;k=-90*y;b=90*y;n=!1;l=1;for(h=2*f;l<h;)y=g.get(l),p=a.J.tk(y,k,b),p!=y&&(g.set(l,p),n=!0),l+=2;if(0!=e||1!=d)for(n=!0,k=new a.b,l=0;l<f;l++)g.fc(2*l,k),k.x*=d,k.x+=e,k.y*=d,g.mo(2*l,k);n&&c.Cc(1993)}else{var h=e.length,p=Math.min(f,h),m=a.J.df(p),D=null,q=0,w=NaN,r=NaN,K=360*l,t=l/y;d&&(r=90*l,w=89.9*y,D=a.J.df(p));for(var u=!0,v=0;0!=f;){y=!1;g.Hx(q<<1,p,e,0,!0);for(l=0;l<p;l++)m[l]=e[l][0];
if(d)for(l=0;l<p;l++){var x=Math.abs(e[l][1])-w;0<x&&(y=e[l][1],e[l][1]=a.Ub.Kl(w,y),D[l]=a.Ub.Kl(x,y),y=!0)}l=e[0][0];b.transform(e,p,n,k);u&&(v=e[0][0]-t*l,u=!1);for(l=0;l<p;l++)x=e[l][0]-m[l]*t-v,200<Math.abs(x)&&(e[l][0]=0<x?e[l][0]-K:e[l][0]+K);if(y){for(l=0;l<p;l++)0!=D[l]&&(e[l][1]+=t*D[l],e[l][1]>r?e[l][1]=r:e[l][1]<-r&&(e[l][1]=-r));for(y=0;y<p;y++)D[y]=0}g.hy(q<<1,p,e,0,!0);q+=p;f-=p;p=Math.min(f,h)}c.Cc(1993)}}};d.iZ=function(b,c,d,e){if(c.u())return!1;var f=b.he,g=b.Ee,h=b.re,p=f.lc().Zi(),
n=g.lc().Zi();e[0][0]=c.Te();e[0][1]=c.Cf();if(null!=h&&0<h.count()){b=!0;var k=!1,y=NaN,l=0,m=1;d&&(d=f.ce(),y=g.ce(),m=y/d,y*=90,f=89.9*d,g=Math.abs(e[0][1])-f,0<g&&(k=e[0][1],e[0][1]=a.Ub.Kl(f,k),l=a.Ub.Kl(g,k),k=!0));h.transform(e,1,p,n);k&&0!=l&&(e[0][1]+=m*l,e[0][1]>y?e[0][1]=y:e[0][1]<-y&&(e[0][1]=-y));c.rb(e[0][0],e[0][1])}else{d=f.ce();b=a.J.tk(e[0][1],-90*d,90*d)!=e[0][1];y=g.ce();h=(f.kn()-g.kn())*y;p/=n;if(1!=p||0!=h)b=!0,e[0][0]*=p,e[0][0]+=h,e[0][1]*=p;b&&c.rb(e[0][0],e[0][1])}return b};
d.YM=function(b,c,d,e){var f;if(b.sr)e=90*b.he.ce(),a.na.JK(c,d,-e,e);else{var g=b.re,h=b.he,p=b.Ee;b=h.Vs();var n=p.Vs(),k=h.ce(),y=90*k,l=p.ce();if(null==g||0==g.count()){if(e=b/n,g=(h.kn()-p.kn())*l,a.na.JK(c,d,-y,y),0!=g||1!=e)for(l=0;l<d;l++)c[l].x*=e,c[l].x+=g,c[l].y*=e}else for(var h=Math.min(d,e.length),y=a.J.df(h),p=360*l,k=l/k,m=!0,D=0,q=0;0!=d;){for(l=0;l<h;l++)y[l]=c[l+q].x;l=c[0].x;a.na.mz(e,c,q,h);g.transform(e,h,b,n);a.na.lz(c,q,e,h);m&&(D=c[0].x-k*l,m=!1);for(l=0;l<h;l++)f=c[q+l].x-
y[l]*k-D,200<Math.abs(f)&&(c[q+l].x=0<f?c[q+l].x-p:c[q+l].x+p);q+=h;d-=h;h=Math.min(d,e.length)}}};d.YZ=function(a,b,c,e){return d.cn(a,b,isNaN(c)?0:c,!0,e,null)};d.Wu=function(a,b){a=a.Ch();isNaN(b)||a.Bv(b,0);return a};d.kS=function(b,c,e,f,g,h,n,k){for(var p=d.Wu(f,g),y=p.O(),l=y/360,m=d.ED*l,q=b.Qa(0),D=c.Ic(),w=D?y/c.oe().O():0,r=!1,K=new a.Ja(e.description),t=0,u=e.aa();t<u;++t){var P=D,v=new a.Ua(e.description);v.Ui(e,t,!0);if(0!=n){var N=d.yD(!0,v,p.B-k,p.B,n);(r=r||N)&&(P=!1)}var x=-1;P&&
(x=b.wa(t));var U=v.Qa(0),z=v.D(),B=0,I=U.read(0),A=0,N=3*f.pe(0),ka=!1,F=new a.b;F.Yc();var C=new a.b;C.Yc();for(var G=!1,E=1;E<z;++E){var J=a.b.pa(U.Lf(2*E),U.Lf(2*E+1)),H=J.x,M=H+B,L=M-I;J.x=M;if(Math.abs(L)>m){if(P){var O=x+(E+1<z?E:0),R=q.read(2*(x+E-1)),O=(q.read(2*O)-R)*w;Math.abs(L-O)>1*l&&(P=!1)}P||(B-=a.Ub.Kl(y,M-I),M=H+B,++A,G=0!=B,J.x=M)}else ka||a.na.BH(C,F,J,N)&&(ka=!0);G&&U.write(2*E,M);I=M;C.L(F);F.L(J)}0<A&&v.Cc(1993);P=v.Ba(0);z=v.Ba(z-1);v=a.b.Cb(P,z)<N?d.lM(v,f,g,h,ka):d.pM(b,
t,v,f,g);K.add(v,!1)}g=f.pe(0);e=p.O()/180;d.zu(K,p,.1*g,!1);g=a.th.clip(K,p,g,e,h);K=K!=g;b=b.ef();k=g.ef();n=0;0<k&&0>b?n=1:0>=k&&0<b&&(0==k?(k=NaN,2==c.Fb()?k=c.Ok().ef():1==c.Fb()&&(k=c.oe().AG()),b>.99*k&&(n=-1)):n=-1);0!=n&&(c=new a.Ja(g.description),c.oq(p),c=a.Pm.local().V(c,e,h),c.add(g,!1),K=!0,g=c);K&&(g=a.Qm.local().V(g,f,!1,h));return g};d.pM=function(b,c,e,f,g){var h=e.D(),p=e.Ba(0),n=e.Ba(h-1);f=d.Wu(f,g);g=f.O();var p=a.Ub.sign(n.x-p.x),k=new a.h;e.ac(k);var y=f.Jk(),l,n=y-g,y=y+g;
if(0<=p){for(var m=Math.ceil((n-k.o)/g),m=m*g;n>k.o+m;)m+=g;for(;n<k.v+m;)m-=g;l=m;720<k.O()&&(y=n+360*Math.ceil(k.O()/360))}else{m=Math.ceil((y-k.v)/g);for(m*=g;y<k.v+m;)m-=g;for(;y>k.o+m;)m+=g;l=m;720<k.O()&&(n=y-360*Math.ceil(k.O()/360))}var m=p*g,q=a.h.pa(k.o,k.A,k.v,k.B);q.move(l,0);var D=new a.Gd;D.zg(l,0);e.Vc(D);k=new a.Ua(e.description);k.add(e,!1);l=e.Ba(h-1);g=0;for(var w=k.Ba(0).x,r=0;0<p?q.v<y:q.o>n;)1024<=r&&(r=0),q.move(m,0),D.Wb=m,e.Vc(D),w+=m,f.o<=w&&f.v>=w&&(g=k.D()-1),e.rb(0,l),
l=e.Ba(h-1),k.zs(e,0,0,h-1,!1);e=new a.Ja(k.description);h=0<b.Ym(c);e.add(k,!1);b=k.Ba(0);n=k.Ba(k.D()-1);c=e.aa()-1;(0>p?h:!h)?(p=a.b.pa(n.x,f.B),e.bj(p),p=a.b.pa(f.Jk(),f.B),e.bj(p),f=a.b.pa(b.x,f.B)):(p=a.b.pa(n.x,f.A),e.bj(p),p=a.b.pa(f.Jk(),f.A),e.bj(p),f=a.b.pa(b.x,f.A));e.bj(f);e.yH(0,c,0);e.KP(g);return e};d.lM=function(b,c,e,f,g){var h=new a.Ja(b.description);h.add(b,!1);h.fC(0,h.D()-1);var p=new a.h;h.ac(p);e=d.Wu(c,e);for(var n=e.O(),k=Math.ceil((e.o-p.o)/n),k=k*n;e.o>p.o+k;)k+=n;for(;e.o<
p.v+k;)k-=n;k+=n;if(0!=k){p.move(k,0);var y=new a.Gd;y.zg(k,0);h.Vc(y)}if(e.o<=p.o&&e.v>p.v)return g&&(g=h.ef(),h=a.Qm.local().V(h,c,!0,f),c=h.ef(),(c=a.Ub.sign(g)!=a.Ub.sign(c))&&h.TJ()),h;b=new a.Ja(b.description);b.add(h,!1);for(g=g||p.O()>n-c.pe(0);p.o<e.v;)p.move(n,0),y=new a.Gd,y.zg(n,0),h.Vc(y),b.add(h,!1);g&&(g=b.ef(),b.Op(1),b=a.Qm.local().V(b,c,!0,f),c=b.ef(),(c=a.Ub.sign(g)!=a.Ub.sign(c))&&b.TJ());return b};d.yD=function(b,c,d,e,f){for(var g=c.Qa(0),h=c.D(),p=!1,n=0;n<h;n++){var k=a.b.pa(g.Lf(2*
n),g.Lf(2*n+1));if(0!=(f&1)&&k.y>=d){p=!0;break}if(0!=(f&2)&&k.y<=-d){p=!0;break}}if(!p)return!1;g=!1;b&&(g=c.Ko(0));b=new a.ed;var h=b.Jb(c),p=b.Pb(h),y=-1,l=!0,m=new a.b;m.Yc();for(var n=new a.Wa,q=-1,D=b.cb(p);-1!=D;D=b.U(D)){var k=b.Ba(D),w=0!=(f&1)&&90<=k.y?1:0,w=w|(0!=(f&2)&&k.y<=-d?2:0);if(0<y&&y!=w){if(m.x!=k.x){m.x=k.x;b.xj(b.Ra(D),n);var r=b.$j(p,D,n);b.Nf(r,m)}if(g)for(q=-1!=q?b.U(q):b.cb(p),r=b.Ra(D);q!=r;)q=b.td(q,!1);q=-1}0<w&&(k.y=a.Ub.Kl(e,k.y),b.Nf(D,k),l||y==w||(k.x!=m.x?(b.xj(D,
n),r=b.$j(p,D,n),b.rb(r,m.x,k.y),q=r):q=D));y=w;m=k;l=!1}if(g){if(-1!=q)for(q=b.U(q);-1!=q;)q=b.td(q,!1);d=b.cb(p);b.Uq(d,b.Vj(p))||(b.xj(d,n),b.$j(p,-1,n))}b.Pe(h).copyTo(c);return!0};d.x_=function(a,b){var c=0,d=a.La(b);b+=1;for(var e=a.aa();b<e&&!(0<a.Ym(b));++b)c++;return 64<d&&3<=c};d.wA=function(c,e,f,g){var h=c;if(h.u()||f==b.DontClip)return h;var p=h.G();if(33==p)return g=h,h=[g.w()],d.zH(h,1,e,f),h[0].isNaN()?g.Oa():g.rb(h[0]),c;c=e.lc();var n=c.ce(),k=90*n,y=180*n,l=360*n,m=e.ri(),q=.5*
n,D=new a.h;h.s(D);var w=e.Ts(),r=e.dS(),K=197==w.G();e=new a.h;w.s(e);f==b.PannableFold&&(f=c.oe().O(),e.o=m-.5*f,e.v=e.o+f);if(D.A<-k||D.B>k){(new a.h).I(D.o-n,-k,D.v+n,k);h=a.th.rq(h,e,c,NaN,0,g);if(h.u())return h;h.s(D)}if(r&&(e.B<D.A||e.A>D.B))return h.Ka();D.O()>l&&(h=d.Aq(h,m-y,l,c,!0,0,!0,g),h.s(D));k=d.hX(D.o,D.v,e.o,e.v,l);0!=k&&D.move(k,0);if(D.v>e.v||D.o<e.o){if(D.v>e.v)for(;D.o>=e.v;)D.move(-l,0),k-=l;for(;D.o<e.v-l;)D.move(l,0),k+=l}f=a.na.zv(c,w);0!=k&&(n=new a.Gd,n.zg(k,0),h.Vc(n));
if(r){if(K&&e.contains(D))return h;r=[null,null];for(k=0;2>k;k++){K?n=a.T.Hc(p)?a.th.clip(h,e,f,q,g):a.th.clip(h,e,f,0,g):(n=a.wk.local().V(h,w,c,g),n==w&&(n=a.T.me(n)));if(e.o<=D.o&&e.v>=D.v||e.o>=D.o&&e.v<=D.v)return n;r[k]=n;0==k&&(D.move(-l,0),n=new a.Gd,n.zg(-l,0),h.Vc(n))}if(550==p)r[0].Hd(r[1],0,-1);else if(a.T.Hc(p))r[0].add(r[1],!1);else if(33==p)r[0].u()&&(r[0]=r[1]);else throw a.g.X("intersect_with_GCS_horizon: unexpected geometry type");return r[0]}if(e.B<D.A||e.A>D.B)return h;for(p=0;!h.u()&&
D.v>e.o;)0!=p&&(n=new a.Gd,n.zg(p,0),h.Vc(n)),a.Jj.local().V(4,h,w,c,g)||(h=a.eq.local().V(h,w,c,g),w==h&&(h=a.T.me(h))),0!=p&&(q=new a.Gd,q.zg(-p,0),h.Vc(q)),p-=l,D.move(-l,0);return h};d.zH=function(c,e,f,g){if(0!=e&&g!=b.DontClip)if(g==b.PannableFold){g=f.aT();for(var h=e,p=0;p<e;p++)if(c[p].y>g.B||c[p].y<g.A)c[p].Yc(),h--;0!=h&&d.Uu(c,e,g.o,g.O())}else{g=f.ce();var n=90*g,k=180*g;g*=360;h=e;for(p=0;p<e;p++)if(c[p].y>n||c[p].y<-n)c[p].Yc(),h--;if(0!=h){h=new a.h;h.Mx(c,e);var n=f.Ts(),y=f.Uv(),
p=197==n.G(),l=new a.h;n.s(l);if(!y||!(l.B<h.A||l.A>h.B))if(y)if(d.Uu(c,e,l.Jk()-k,g),h=e,p)for(p=0;p<e;p++)l.contains(c[p])||(c[p].Yc(),h--);else for(f=a.na.zv(f.lc(),n),p=0;p<e;p++)(k=0!=a.fd.ee(n,c[p],f))||(c[p].Yc(),h--);else for(d.Uu(c,e,-k,g),h=e,f=a.na.zv(f.lc(),n),p=0;p<e;p++)if(k=c[p],k.isNaN()&&h--,y=d.XD(k.x,l.o,l.v,g),k.x+=y,k=0!=a.fd.ee(n,k,f))c[p].Yc(),h--}}};d.a_=function(b,c,d){if(0<=c&&!b.Qb(c))return 0;var e=0;if(1==d.Fb())return c=90*d.ce(),c-=2*c/Math.PI*a.Uc.PE_HORIZON_DELTA,
d=new a.h,b.s(d),d.B>=c&&(e=1),d.A<=-c&&(e|=2),e;var f=d.Wj();if(null==f)return 0;var g=null;0<=c&&(g=b);for(var h=0;2>h;h++)if((0<h?f.getSouthPoleLocation():f.getNorthPoleLocation())!=a.Ag.PE_POLE_OUTSIDE_BOUNDARY){var p=d.gA(0<h);p.isNaN()||(p=0>c?a.cf.AA(b,p,0):a.cf.BA(g,c,p,0,null),e|=p<<h)}return e};d.Aq=function(b,c,d,e,f,g,h,n){var p=b.G(),k=c+d;if(33===p){e=f?b:b.Sf();var y=e.Te();if(y<c||y>=k||h&&y==k)y+=Math.ceil((c-y)/d)*d,y=a.J.tk(y,c,k),e.DC(y);return e}if(b.u())return b;y=new a.h;b.s(y);
if(y.u())return b;var l=new a.yc;y.Yn(l);var m=new a.yc;m.I(c,k);if(m.contains(l))return b;k=new a.h;k.I(y);if(550===p){e=f?b:b.Sf();n=e.Qa(0);p=2*e.D();k=!1;for(c=0;c<p;c+=2)if(y=n.read(c),y<m.ga||y>=m.la||h&&y==m.la)k=!0,y+=Math.ceil((m.ga-y)/d)*d,y=m.yu(y),n.write(c,y);k&&e.Cc(1993);return e}if(197==p)return d=f?b:b.Sf(),y.Ma(k),d.Np(y),d;var q=.1*Math.max(y.ea(),y.O());k.P(0,q);h=b;m=e.pe(0);b=a.ei.local();for(f=new a.Gd;;){var D=Math.floor((l.ga-c)/d),w=Math.ceil((l.la-c)/d);if(3<w-D){D=Math.floor(.5*
(w+D));k.o=y.o-q;k.v=c+d*D;var r=a.th.clip(h,k,m,g,n);k.o=k.v;k.v=y.v+q;var K=a.th.clip(h,k,m,g,n);f.zg((D-w)*d,0);K.Vc(f);1736==p?h=b.V(r,K,e,null):(h=r,h.add(K,!1));h.s(y);y.Yn(l)}else break}k.o=c;k.v=c+d;c=new a.h;c.I(k);c.P(m,0);c=Math.floor((y.o-k.o)/d)*d;0!=c?(k.move(c,0),f.zg(-c,0)):f.sC();c=1607==p?new a.Ua(h.description):new a.Ja(h.description);g=new a.h;for(l=new a.h;y.v>k.o;){q=a.th.clip(h,k,m,0,n);q.s(l);if(1607==p?!q.u()&&(l.O()>m||l.ea()>m):!q.u()&&(1736!=p||l.O()>m))q.Vc(f),q.s(l),
c.s(g),g.P(m,m),g.Yb(l)&&1736==p?c=b.V(c,q,e,null):c.add(q,!1);k.move(d,0);f.shift(-d,0)}return c};d.Uu=function(b,c,d,e){for(var f=d+e,g=0;g<c;g++){var h=b[g].x;d<=h&&h<f||!(h<d||h>f||h==f)||(h+=Math.ceil((d-h)/e)*e,h=a.J.tk(h,d,f),b[g].x=h)}};d.cn=function(b,c,e,f,g,h){if(!c.Ic())throw a.g.X("fold_into_360_degree_range");if(b.u())return b;var p;if(2==c.Fb())e=c.bw(),p=c.aw()-e;else{var n=c.ce();p=360*n;e-=180*n}return d.Aq(b,e,p,c,f,g,!0,h)};d.uG=function(a,b,c,e){if(2==c.Fb())e=c.bw(),c=c.aw()-
e;else{var f=c.ce();c=360*f;e-=180*f}d.Uu(a,b,e,c)};d.Qj=function(b,c){var d=c.oe();if(33==b.G()){var e=b.Cf();return d.A<=e&&e<=d.B?b:b.Ka()}e=new a.h;b.s(e);var f=new a.h;f.I(d);f.o=e.o;f.v=e.v;f.P(.01*f.ea(),0);d=a.na.Yy(c,e);return f.contains(e)?b:a.th.clip(b,f,d,0,null)};d.Hj=function(a,b,c){return a>b.v&&a-b.v<c?b.v:a<b.o&&b.o-a<c?b.o:a};d.dY=function(a,b,c,e){e.x=d.Hj(a.x,b,c);e.y=a.y};d.cY=function(a,b,c,e){for(var f=0;f<b;f++)a[f].y<c.A||a[f].y>c.B?a[f].Yc():a[f].x=d.Hj(a[f].x,c,e)};d.zu=
function(b,c,e,f){if(!b.u()){var g=b.G();if(!f||1736!=g)if(a.T.fh(g)){f=b.Qa(0);for(var g=0,h=b.D();g<h;g++){var p=f.read(2*g),n=d.Hj(p,c,e);n!=p&&f.write(2*g,n)}b.Cc(1993)}else if(197==g)f=new a.h,b.s(f),f.o=d.Hj(f.o,c,e),f.v=d.Hj(f.v,c,e),b.Np(f);else if(33==g)b.DC(d.Hj(b.Te(),c,e));else throw a.g.X("internal error");}};d.ST=function(b,c,e,f){var g=new a.ed,h=g.Jb(b);b=a.na.zv(c,b);d.jt(g,h,c,b,e,!0,f);return g.Pe(h)};d.jt=function(b,e,f,g,h,n,k){if(!f.Ic())throw a.g.F("invalid call");var p=f.oe(),
y=f.lc(),l=y.Jg().getDatum().getSpheroid(),y=y.Td().Bi,m=l.getFlattening(),l=l.getAxis(),m=m*(2-m),q=new a.yc;p.Yn(q);var D=null,w=[[0,0],[0,0]];2==f.Fb()?(D=f.Jg(),n?(w[0][0]=d.Tn(k,q),w[0][1]=p.Cq(),a.fi.projToGeog(D,1,w),p=w[0][0]*y):(w[0][0]=p.Jk(),w[0][1]=k,a.fi.projToGeog(D,1,w),p=w[0][1]*y)):p=k*y;if(!n&&0!=p&&h!=c.GreatElliptic)throw a.g.X("invalid argument");var r=new a.da,K=[0],t=new a.b,u=new a.b,P=new a.b,v=[null,null],N=new a.b,x=new a.b,z=new a.b,U=new a.b;for(e=b.Pb(e);-1!=e;e=b.Sb(e)){var B=
b.cb(e);b.w(B,N);for(var I=!1,A=B=b.U(B);-1!=A;A=b.U(A)){if(A==B){if(I)break;I=!0}b.w(A,x);if(n&&(g<k-N.x&&x.x-k>g||g<k-x.x&&N.x-k>g)||!n&&(0!=k||g<-N.y&&x.y>g||g<-x.y&&N.y>g)){do if(!(Math.abs(N.x-x.x)>=.5*q.O())){2==f.Fb()?(w[0][0]=d.Tn(N.x,q),w[0][1]=N.y,w[1][0]=d.Tn(x.x,q),w[1][1]=x.y,a.fi.projToGeogCenter(D,2,w,0),z.x=w[0][0]*y,z.y=w[0][1]*y,U.y=w[1][1]*y):(z.x=N.x*y,z.y=N.y*y,U.y=x.y*y);U.x=2*(x.x-N.x)*Math.PI/q.O()+z.x;var F;if(n){u.x=p;u.y=d.sA(l,m,z,U,p,h);if(isNaN(u.y))break;v[0]=u;F=1}else if(h==
c.GreatElliptic){var C=[0,0];F=a.uy.xA(l,m,z,U,p,C);if(0==F)break;u.x=C[0];u.y=p;v[0]=u;2==F&&(P.x=C[1],P.y=p,v[1]=P)}else{u.x=d.pA(l,m,z,U,h);if(isNaN(u.x))break;u.y=0;v[0]=u;F=1}for(var G=-1,C=0;C<F;C++){a.mb.Kd(l,m,z.x,z.y,U.x,U.y,r,null,null,h);var E=r.j;a.mb.Kd(l,m,z.x,z.y,v[C].x,v[C].y,r,null,null,h);var J=r.j;2==f.Fb()?(w[0][0]=v[C].x/y,w[0][1]=v[C].y/y,a.fi.geogToProj(D,1,w),n?(t.y=w[0][1],t.x=k):(t.x=d.zl(w[0][0],N.x,x.x,q),t.y=k)):n?(t.x=k,t.y=v[C].y/y):(t.x=d.zl(v[C].x/y,N.x,x.x,q),t.y=
k);K[0]=0<E?a.J.tk(J/E,0,1):.5;if(0==K[0]||1==K[0])break;G>K[0]||(G=b.Ra(A),b.Em(G,K,1),b.rb(b.U(G),t.x,t.y),G=K[0])}}while(0)}N.L(x)}}};d.Tn=function(a,b){var c=b.la-b.ga;return b.yu(a-Math.floor((a-b.ga)/c)*c)};d.zl=function(b,c,d,e){var f=new a.yc;f.I(c,d);d=e.O();b=Math.floor((b-c)/d)*d+b;for(f=f.Tf();Math.abs(b-f)>Math.abs(b+d-f);)b+=d;return b};d.Ug=function(b,c,d){b=a.ks.uq(b);c=a.ks.Wx(b,a.ks.uq(c));d=a.ks.Wx(b,a.ks.uq(d));return 0==d||0<c&&0<d&&d<=c||0>c&&0>d&&d>=c?!0:!1};d.sA=function(b,
e,f,g,h,n){if(n==c.GreatElliptic)return a.uy.oU(e,f,g,h);if(Math.abs(f.x-g.x)>=Math.PI||!d.Ug(f.x,g.x,h))return NaN;var p;f.x>g.x?p=g:(p=f,f=g);g=new a.da;var k=new a.da,y=new a.da;a.mb.Kd(b,e,p.x,p.y,f.x,f.y,k,g,null,n);var l=k.j,m=0,q=1,w=new a.b;for(w.L(p);l*(q-m)>1E-12*b;){var D=.5*(m+q);a.mb.Sj(b,e,p.x,p.y,l*D,g.j,k,y,n);w.x=k.j;w.y=y.j;if(w.x==h)break;if(d.Ug(p.x,w.x,h))q=D;else if(d.Ug(f.x,w.x,h))m=D;else return NaN}return w.y};d.pA=function(b,d,e,f,g){if(g==c.GreatElliptic)return g=[0,0],
a.uy.xA(b,d,e,f,0,g),g[0];var h;e.y>f.y?h=f:(h=e,e=f);f=new a.yc;f.I(h.y,e.y);if(!f.contains(0)||Math.abs(h.x-e.x)>=Math.PI)return NaN;if(h.x==e.x)return h.x;var p=new a.da,n=new a.da,k=new a.da;a.mb.Kd(b,d,h.x,h.y,e.x,e.y,n,p,null,g);var y=n.j,l=0,m=1,q=new a.b;for(q.L(h);y*(m-l)>1E-12*b;){var w=.5*(l+m);a.mb.Sj(b,d,h.x,h.y,y*w,p.j,n,k,g);q.x=n.j;q.y=k.j;f.I(h.y,q.y);if(0==q.y)break;if(f.contains(0))m=w;else if(f.I(e.y,q.y),f.contains(0))l=w;else return NaN}return q.x};d.E_=function(b,c,d,e,f,g){if(c==
f&&d!=g)throw a.g.F();if(0>=e)return 0;if(b.No()){g*=2;var h=2*d;b=2*e;for(d=0;d<b;d++)f[g+d]=c[h+d];return e}if(2>=e){g=[new a.b,new a.b];for(h=0;h<e;h++)g[h].ja(c[2*h],c[2*h+1]);c=a.ns.local().AY(b,g,e,g);for(h=0;h<e;h++)f[2*h]=g[h].x,f[2*h+1]=g[h].y;return c}var p=b.he,h=b.Ee,n=p.Fb(),k=h.Fb();if(0==n&&n==k)return b=p.Zi(),h=h.Zi(),h=b/h,b=new a.Gd,b.Vp(h,h),b.BY(c,d,f,g,e),e;n=new a.Dd;n.Rd(3);n.resize(e);for(var k=n.Qa(0),y=n.Qa(3),h=0,l=2*d,m=2*g;h<e;h++,m+=2){d=c[l++];var p=c[l++],q=m;if(isNaN(d)||
isNaN(p))p=d=0,q=-1;y.write(h,q);k.write(2*h,d);k.write(2*h+1,p)}n.Cc(1993);c=a.ns.local().V(n,b,null);h=0;for(g*=2;h<e;h++,g+=2)f[g]=NaN,f[g+1]=NaN;if(c.u())return 0;g=c.Qa(3);b=c.Qa(0);h=n=0;for(e=c.D();h<e;h++)c=g.read(h),-1!=c&&(d=b.read(2*h),p=b.read(2*h+1),f[c]=d,f[c+1]=p,n++);return n};d.CJ=function(b,c,d,e){if(!b.he.Ic())return!1;var f=new a.Dd(c.description);f.Hd(c,0,-1);e=a.ns.local().V(f,b,e);f=c.D();d.Oa();if(f!=e.D())return!1;var g=new a.h;c.s(g);var h=new a.h;e.s(h);g=g.O();h=h.O();
if(0!=g&&0!=h){if(h/=g,b=b.Ee.Ch().O()/b.he.Ch().O(),1E-10<Math.abs(h/b-1))return!1}else if(0!=g||0!=h)return!1;d.add(c,!1);c=new a.b;for(b=0;b<f;b++)e.w(b,c),d.rb(b,c);return!0};d.OO=function(a,b){a%=360*b;a>=180*b&&(a-=360*b);return a};d.AJ=function(c,e,f,g){if(f==b.Clip){var h=e.Ok();197==h.G()?(f=new a.h,h.s(f),h=a.na.Yy(e,f),c=a.th.clip(c,f,h,5E4*e.hn(),g)):a.Jj.local().V(1,h,c,e,g)||(c=a.wk.local().V(c,h,e,g),c==h&&(c=a.Bl.me(c)))}else e.Ic()&&(g=new a.h,c.ac(g),e.oe().contains(g)||(d.zu(c,
e.oe(),e.pe(0),!0),f==b.PannableFold&&(c=d.Qj(c,e)),c=d.cn(c,e,0,!0,1E5*e.hn(),null)));return c};d.lF=function(b,c,d){var e=c.Us();if(null==e)return b;c=c.lc();var f=c.oe().O(),g=new a.h;b.ac(g);var h=new a.yc;g.Yn(h);for(var g=e.Fa(),e=null,p=new a.Gd;g.Ya();)for(;g.Ea();){var n=g.ba(),k=n.hg(0,0),y=new a.yc;y.I(k.ga,k.la);for(k=0;y.la>h.ga;)y.move(-f),--k;for(;y.ga<=h.la;){if(y.Yb(h)){null==e&&(e=new a.Ua);var l=a.Hb.CQ(n.ec(),n.Ac());0!=k&&(p.zg(k*f,0),l.Vc(p));e.cc(l,!0)}y.move(f);++k}}return null!=
e?(c=a.na.DP(c,e),c=a.na.As(c),a.Mu.IQ(b,e,c,d)):b};d.hX=function(a,b,c,e,f){return a>=c&&b<=e?0:d.XD(.5*(b+a),c,e,f)};d.XD=function(b,c,d,e){return a.Ub.round((.5*(d+c)-b)/e)*e};d.lS=function(b,c,e,f,g,h,n,k){var p=d.Wu(f,g),y=p.O(),l=y/360,m=d.ED*l,q=b.Qa(0),w=c.Ic(),r=w?y/c.oe().O():0,D;c=b.Ka();for(var t=0,K=e.aa();t<K;++t){var u=w,P=new a.Ua(e.description);P.Ui(e,t,!0);D=e.Qb(t);0!=n&&(D=d.yD(D,P,p.B-k,p.B,n))&&(u=!1);var v=-1;D=P.D();var x=!1;u&&(v=b.wa(t),x=b.Qb(t));var N=P.Qa(0),z=0,U=N.read(0),
B=0,I=3*f.pe(0),A=!1,F=new a.b;F.Yc();var C=new a.b;C.Yc();for(var G=!1,ka=1;ka<D;++ka){var E=a.b.pa(N.Lf(2*ka),N.Lf(2*ka+1)),J=E.x,H=J+z,M=H-U;E.x=H;if(Math.abs(M)>m){if(u){var L=v+ka-1,O=v;if(!x||ka+1<D)O+=ka;L=q.read(2*L);O=(q.read(2*O)-L)*r;Math.abs(M-O)>1*l&&(w=!1)}u||(z-=a.Ub.Kl(y,H-U),H=J+z,++B,G=0!=z,E.x=H)}else A||a.na.BH(F,C,E,I)&&(A=!0);G&&N.write(2*ka,H);U=H;F.L(C);C.L(E)}0!=B&&P.Cc(1993);u=P.Ba(0);D=P.Ba(D-1);a.b.Cb(u,D);P=d.sM(P,f,isNaN(g)?0:g,h);c.add(P,!1)}b=f.pe(0);e=p.O()/180;d.zu(c,
p,.1*b,!1);return a.th.clip(c,p,b,e,h)};d.sM=function(a,b,c,e){return d.cn(a,b,c,!0,0,e)};d.lU=function(b,c,d,e){var f=b.G();if(1736==f)for(c=null!=c?c.pe(0):0,f=0;f<e;f++)1!=a.fd.ee(b,d[f],c)&&d[f].Yc();else if(197==f)for(f=0;f<e;f++)b.DQ(d[f])||d[f].Yc();else throw a.g.F();};d.Il=function(b,c,d,e){if(32>d)for(var f=new a.Wa,g=0;g<d;g++)f.rb(c[g]),b.Il(f,e).w(c[g]);else{var h=new a.Dd;h.Rd(3);h.$E(c,d);f=h.Qa(3);for(g=0;g<d;g++)f.write(g,g);g=b.Il(h,e);b=g.Qa(0);f=g.Qa(3);e=a.b.pa(NaN,NaN);for(h=
0;h<d;h++)c[h]=e;d=g.D();for(g=0;g<d;g++)e=f.read(g),b.fc(2*g,c[e])}};d.Hl=function(b,c,d,e){if(32>d)for(var f=new a.Wa,g=0;g<d;g++)f.rb(c[g]),b.Hl(f,e).w(c[g]);else{var h=new a.Dd;h.Rd(3);h.$E(c,d);f=h.Qa(3);for(g=0;g<d;g++)f.write(g,g);g=b.Hl(h,e);b=g.Qa(0);f=g.Qa(3);e=a.b.pa(NaN,NaN);for(h=0;h<d;h++)c[h]=e;d=g.D();for(g=0;g<d;g++)e=f.read(g),b.fc(2*g,c[e])}};d.HZ="ABCDEFGHIJKLMNOPQRSTUVWXYZ";d.ED=210;return d}();a.Ib=d})(C||(C={}));(function(a){(function(a){a[a.rightSide=1]="rightSide"})(a.mN||
(a.mN={}));var b=function(){function b(b,c,d){this.zt=new a.b;void 0===b?this.Bp=-1:(this.zt.L(b),this.Bp=c,this.Pa=d,this.$w=0)}b.prototype.BK=function(a){this.$w=a?this.$w|1:this.$w&-2};b.prototype.u=function(){return 0>this.Bp};b.prototype.Qz=function(){if(this.u())throw a.g.X("invalid call");return new a.Wa(this.zt.x,this.zt.y)};b.prototype.Za=function(){if(this.u())throw a.g.X("invalid call");return this.Bp};b.prototype.Tz=function(){if(this.u())throw a.g.X("invalid call");return this.Pa};b.prototype.CA=
function(){return 0!=(this.$w&1)};b.prototype.Hy=function(a,b,c,d){this.zt.x=a;this.zt.y=b;this.Bp=c;this.Pa=d};return b}();a.Sm=b})(C||(C={}));(function(a){var b=function(){function b(){}b.prototype.bo=function(b,c){this.Sh.resize(0);this.ij.length=0;this.Xk=-1;b.ac(this.il);this.il.P(c,c);this.il.Yb(this.Mb.Ha)?((this.tt=a.T.Nc(b.G()))?(this.VI=b.ec(),this.UI=b.Ac(),this.ta=c):this.ta=NaN,this.Sh.add(this.Mb.Jf),this.ij.push(this.Mb.Ha),this.Nt=this.Mb.Ss(this.Mb.Jf)):this.Nt=-1};b.prototype.Oi=
function(a,b){this.Sh.resize(0);this.ij.length=0;this.Xk=-1;this.il.I(a);this.il.P(b,b);this.ta=NaN;this.il.Yb(this.Mb.Ha)?(this.Sh.add(this.Mb.Jf),this.ij.push(this.Mb.Ha),this.Nt=this.Mb.Ss(this.Mb.Jf),this.tt=!1):this.Nt=-1};b.prototype.next=function(){if(0==this.Sh.size)return-1;this.Xk=this.Nt;var b=null,d=null,e,f=null,g=null;this.tt&&(b=new a.b,d=new a.b,f=new a.h);for(var n=!1;!n;){for(;-1!=this.Xk;){e=this.Mb.Mz(this.Mb.Tv(this.Xk));if(e.Yb(this.il))if(this.tt){if(b.L(this.VI),d.L(this.UI),
f.I(e),f.P(this.ta,this.ta),0<f.ez(b,d)){n=!0;break}}else{n=!0;break}this.Xk=this.Mb.$v(this.Xk)}if(-1==this.Xk){e=this.Sh.Ec();var k=this.ij[this.ij.length-1];null==g&&(g=[],g[0]=new a.h,g[1]=new a.h,g[2]=new a.h,g[3]=new a.h);c.iK(k,g);this.Sh.Mf();--this.ij.length;for(k=0;4>k;k++){var l=this.Mb.Eq(e,k);if(-1!=l&&0<this.Mb.qT(l)&&g[k].Yb(this.il))if(this.tt){if(b.L(this.VI),d.L(this.UI),f.I(g[k]),f.P(this.ta,this.ta),0<f.ez(b,d)){var m=new a.h;m.I(g[k]);this.Sh.add(l);this.ij.push(m)}}else m=new a.h,
m.I(g[k]),this.Sh.add(l),this.ij.push(m)}if(0==this.Sh.size)return-1;this.Xk=this.Mb.Ss(this.Sh.get(this.Sh.size-1))}}this.Nt=this.Mb.$v(this.Xk);return this.Xk};b.BQ=function(c,d,e){var f=new b;f.Mb=c;f.il=new a.h;f.Sh=new a.ha(0);f.ij=[];f.bo(d,e);return f};b.AQ=function(c,d,e){var f=new b;f.Mb=c;f.il=new a.h;f.Sh=new a.ha(0);f.ij=[];f.Oi(d,e);return f};b.zQ=function(c){var d=new b;d.Mb=c;d.il=new a.h;d.Sh=new a.ha(0);d.ij=[];return d};return b}();a.IZ=b;var c=function(){function c(b,c){this.If=
new a.Zc(11);this.zi=new a.Zc(5);this.ut=[];this.Ww=new a.ha(0);this.Ha=new a.h;this.sl(b,c)}c.prototype.reset=function(a,b){this.If.Wi(!1);this.zi.Wi(!1);this.ut.length=0;this.Ww.clear(!1);this.sl(a,b)};c.prototype.dh=function(a,b){return this.mw(a,b,0,this.Ha,this.Jf,!1,-1)};c.prototype.lw=function(a,b,c){c=-1==c?this.Jf:this.YG(c);var d=this.ea(c),e=this.GS(c);return this.mw(a,b,d,e,c,!1,-1)};c.prototype.ia=function(a){return this.BS(a)};c.prototype.JG=function(a){return this.Mz(this.Tv(a))};c.prototype.ea=
function(a){return this.Vv(a)};c.prototype.GS=function(b){var c=new a.h;c.I(this.Ha);var d=this.Vv(b);b=this.TG(b);for(var e=0;e<2*d;e+=2){var f=a.J.truncate(3&b>>e);0==f?(c.o=.5*(c.o+c.v),c.A=.5*(c.A+c.B)):1==f?(c.v=.5*(c.o+c.v),c.A=.5*(c.A+c.B)):(2==f?c.v=.5*(c.o+c.v):c.o=.5*(c.o+c.v),c.B=.5*(c.A+c.B))}return c};c.prototype.qT=function(a){return this.nA(a)};c.prototype.PS=function(a,c){return b.BQ(this,a,c)};c.prototype.$z=function(a,c){return b.AQ(this,a,c)};c.prototype.jf=function(){return b.zQ(this)};
c.prototype.sl=function(b,c){if(0>c||32<2*c)throw a.g.F("invalid height");this.cV=c;this.Ha.I(b);this.Jf=this.If.Me();this.Ux(this.Jf,0);this.Ox(this.Jf,0);this.sK(this.Jf,0);this.oK(this.Jf,0)};c.prototype.mw=function(b,d,e,f,g,n,k){if(!f.contains(d))return 0==e?-1:this.mw(b,d,0,this.Ha,this.Jf,n,k);if(!n)for(var h=g;-1!=h;h=this.bT(h))this.Ux(h,this.nA(h)+1);h=new a.h;h.I(f);f=g;var p=[];p[0]=new a.h;p[1]=new a.h;p[2]=new a.h;for(p[3]=new a.h;e<this.cV&&this.FP(f);e++){c.iK(h,p);for(var l=!1,y=
0;4>y;y++)if(p[y].contains(d)){var l=!0,m=this.Eq(f,y);-1==m&&(m=this.NQ(f,y));this.Ux(m,this.nA(m)+1);f=m;h.I(p[y]);break}if(!l)break}return this.QT(b,d,e,h,f,n,g,k)};c.prototype.QT=function(a,b,c,d,e,f,g,n){var h=this.PG(e);if(f){if(e==g)return n;this.lR(n);f=n}else f=this.PQ(),this.qC(f,a),this.nX(this.Tv(f),b);this.LX(f,e);-1!=h?(this.Sx(f,h),this.Px(h,f)):this.kK(e,f);this.tC(e,f);this.Ox(e,this.Yv(e)+1);this.EP(e)&&this.aS(c,d,e);return f};c.prototype.lR=function(a){var b=this.YG(a),c=this.PG(b),
d=this.hT(a),e=this.$v(a);this.Ss(b)==a?(-1!=e?this.Sx(e,-1):this.tC(b,-1),this.kK(b,e)):c==a?(this.Px(d,-1),this.tC(b,d)):(this.Sx(e,d),this.Px(d,e));this.Sx(a,-1);this.Px(a,-1);this.Ox(b,this.Yv(b)-1)};c.iK=function(a,b){var c=.5*(a.o+a.v),d=.5*(a.A+a.B);b[0].I(c,d,a.v,a.B);b[1].I(a.o,d,c,a.B);b[2].I(a.o,a.A,c,d);b[3].I(c,a.A,a.v,d)};c.prototype.EP=function(a){return 8==this.Yv(a)&&!this.jH(a)};c.prototype.aS=function(a,b,c){var d,e,f=this.Ss(c);do e=this.Tv(f),d=this.zi.S(f,0),e=this.Mz(e),this.mw(d,
e,a,b,c,!0,f),f=d=this.$v(f);while(-1!=f)};c.prototype.FP=function(a){return 8<=this.Yv(a)||this.jH(a)};c.prototype.jH=function(a){return-1!=this.Eq(a,0)||-1!=this.Eq(a,1)||-1!=this.Eq(a,2)||-1!=this.Eq(a,3)};c.prototype.NQ=function(a,b){var c=this.If.Me();this.rX(a,b,c);this.Ux(c,0);this.Ox(c,0);this.ul(c,a);this.oK(c,this.Vv(a)+1);this.sK(c,b<<2*this.Vv(a)|this.TG(a));return c};c.prototype.PQ=function(){var b=this.zi.Me(),c;0<this.Ww.size?(c=this.Ww.Ec(),this.Ww.Mf()):(c=this.ut.length,this.ut.push(new a.h));
this.oX(b,c);return b};c.prototype.Eq=function(a,b){return this.If.S(a,b)};c.prototype.rX=function(a,b,c){this.If.R(a,b,c)};c.prototype.Ss=function(a){return this.If.S(a,4)};c.prototype.kK=function(a,b){this.If.R(a,4,b)};c.prototype.PG=function(a){return this.If.S(a,5)};c.prototype.tC=function(a,b){this.If.R(a,5,b)};c.prototype.TG=function(a){return this.If.S(a,6)};c.prototype.sK=function(a,b){this.If.R(a,6,b)};c.prototype.Yv=function(a){return this.If.S(a,7)};c.prototype.nA=function(a){return this.If.S(a,
8)};c.prototype.Ox=function(a,b){this.If.R(a,7,b)};c.prototype.Ux=function(a,b){this.If.R(a,8,b)};c.prototype.bT=function(a){return this.If.S(a,9)};c.prototype.ul=function(a,b){this.If.R(a,9,b)};c.prototype.Vv=function(a){return this.If.S(a,10)};c.prototype.oK=function(a,b){this.If.R(a,10,b)};c.prototype.BS=function(a){return this.zi.S(a,0)};c.prototype.qC=function(a,b){this.zi.R(a,0,b)};c.prototype.hT=function(a){return this.zi.S(a,1)};c.prototype.$v=function(a){return this.zi.S(a,2)};c.prototype.Sx=
function(a,b){this.zi.R(a,1,b)};c.prototype.Px=function(a,b){this.zi.R(a,2,b)};c.prototype.YG=function(a){return this.zi.S(a,3)};c.prototype.LX=function(a,b){this.zi.R(a,3,b)};c.prototype.Tv=function(a){return this.zi.S(a,4)};c.prototype.oX=function(a,b){this.zi.R(a,4,b)};c.prototype.Mz=function(a){return this.ut[a]};c.prototype.nX=function(a,b){this.ut[a].I(b)};return c}();a.gq=c})(C||(C={}));(function(a){(function(a){a[a.Outside=0]="Outside";a[a.Inside=1]="Inside";a[a.Border=2]="Border"})(a.jM||
(a.jM={}));var b=function(){function a(a,b){this.Eh=null;this.qV=b;this.Eh=a}a.prototype.Kx=function(a,b){this.hI!=b&&a.flush();this.hI=b};a.prototype.nG=function(a,b){for(var c=0;c<b;)for(var d=a[c++],e=a[c++],f=a[c++]*this.qV;d<e;d++)this.Eh[f+(d>>4)]|=this.hI<<2*(d&15)};return a}();a.KZ=b;var c=function(){function c(a,b,c){this.Eh=null;this.BB=this.ll=this.dJ=this.bJ=this.Ct=this.pI=this.fg=this.Nn=0;this.rj=this.ml=this.em=null;this.kw(a,b,c)}c.create=function(b,d,e){if(!c.$y(b))throw a.g.F();
return c.ad(b,d,e)};c.Yg=function(b,d,e){if(!c.$y(b))throw a.g.F();return c.de(b,d,e)};c.PW=function(b){switch(b){case 0:b=1024;break;case 1:b=16384;break;case 2:b=262144;break;default:throw a.g.X("Internal Error");}return b};c.$y=function(a){return a.u()||1607!=a.G()&&1736!=a.G()?!1:!0};c.prototype.KR=function(b,c){c=c.Fa();for(var d=new a.b,e=new a.b;c.Ya();)for(;c.Ea();){var f=c.ba();if(322!=f.G())throw a.g.X("Internal Error");b.ai(f.ec(),d);b.ai(f.Ac(),e);this.rj.Ny(d.x,d.y,e.x,e.y)}this.rj.MJ(a.vy.ly)};
c.prototype.LR=function(){throw a.g.X("Internal Error");};c.prototype.Cz=function(b,c){for(var d=1;4>d;d++)b.Ny(c[d-1].x,c[d-1].y,c[d].x,c[d].y);b.Ny(c[3].x,c[3].y,c[0].x,c[0].y);this.rj.MJ(a.vy.ly)};c.prototype.SK=function(b,c,d){for(var e=[null,null,null,null],f=0;f<e.length;f++)e[f]=new a.b;c=c.Fa();d=this.ml.CY(d)+1.5;for(var f=new a.b,g=new a.b,h=new a.b,p=new a.b,n=new a.b,k=new a.h,l=new a.b;c.Ya();){var y=!1,m=!0;for(l.ja(0,0);c.Ea();){var q=c.ba();p.x=q.ua;p.y=q.ra;n.x=q.sa;n.y=q.oa;k.Oa();
k.Nb(p.x,p.y);k.ol(n.x,n.y);if(this.em.HH(k)){this.ml.ai(n,n);m?(this.ml.ai(p,p),l.L(p),m=!1):p.L(l);f.xc(n,p);var q=f.length(),r=.5>q;0==q?f.ja(1,0):(r||l.L(n),f.scale(d/q),g.ja(-f.y,f.x),h.ja(f.y,-f.x),p.sub(f),n.add(f),e[0].add(p,g),e[1].add(p,h),e[2].add(n,h),e[3].add(n,g),r?y=!0:this.Cz(b,e))}else y&&(this.Cz(b,e),y=!1),m=!0}y&&this.Cz(b,e)}};c.prototype.XC=function(b){return a.J.truncate(b*this.pI+this.bJ)};c.prototype.YC=function(b){return a.J.truncate(b*this.Ct+this.dJ)};c.ad=function(a,b,
d){return new c(a,b,d)};c.de=function(a,b,d){return new c(a,b,d)};c.prototype.kw=function(c,d,e){this.fg=Math.max(a.J.truncate(2*Math.sqrt(e)+.5),64);this.Nn=a.J.truncate((2*this.fg+31)/32);this.em=new a.h;this.ll=d;e=0;for(var f=this.fg,g=this.Nn;8<=f;)e+=f*g,f=a.J.truncate(f/2),g=a.J.truncate((2*f+31)/32);this.Eh=a.J.df(e,0);this.rj=new a.vy;e=new b(this.Eh,this.Nn,this);this.rj.$X(this.fg,this.fg,e);c.s(this.em);this.em.P(d,d);var f=new a.h,g=a.h.pa(1,1,this.fg-2,this.fg-2),h=d*g.O();d*=g.ea();
f.I(this.em.Tf(),Math.max(h,this.em.O()),Math.max(d,this.em.ea()));this.BB=this.ll;this.ml=new a.Gd;this.ml.NT(f,g);new a.Gd;switch(c.G()){case 550:e.Kx(this.rj,2);this.LR();break;case 1607:e.Kx(this.rj,2);this.SK(this.rj,c,this.BB);break;case 1736:e.Kx(this.rj,1),this.KR(this.ml,c),e.Kx(this.rj,2),this.SK(this.rj,c,this.BB)}this.pI=this.ml.lb;this.Ct=this.ml.gb;this.bJ=this.ml.Wb;this.dJ=this.ml.bc;this.wP()};c.prototype.wP=function(){this.rj.flush();for(var b=0,c=this.fg*this.Nn,d=this.fg,e=a.J.truncate(this.fg/
2),f=this.Nn,g=a.J.truncate((2*e+31)/32);8<d;){for(d=0;d<e;d++)for(var n=2*d,k=2*d+1,l=0;l<e;l++){var m=2*l,q=2*l+1,r=m>>4,m=2*(m&15),w=q>>4,q=2*(q&15),t=this.Eh[b+f*n+r]>>m&3,t=t|this.Eh[b+f*n+w]>>q&3,t=t|this.Eh[b+f*k+r]>>m&3,t=t|this.Eh[b+f*k+w]>>q&3;this.Eh[c+g*d+(l>>4)]|=t<<2*(l&15)}d=e;f=g;b=c;e=a.J.truncate(d/2);g=a.J.truncate((2*e+31)/32);c=b+f*d}};c.prototype.wm=function(a,b){if(!this.em.contains(a,b))return 0;a=this.XC(a);b=this.YC(b);if(0>a||a>=this.fg||0>b||b>=this.fg)return 0;a=this.Eh[this.Nn*
b+(a>>4)]>>2*(a&15)&3;return 0==a?0:1==a?1:2};c.prototype.Xn=function(b){if(!b.Ma(this.em))return 0;var c=this.XC(b.o),d=this.XC(b.v),e=this.YC(b.A);b=this.YC(b.B);0>c&&(c=0);0>e&&(e=0);d>=this.fg&&(d=this.fg-1);b>=this.fg&&(b=this.fg-1);if(c>d||e>b)return 0;for(var f=Math.max(d-c,1)*Math.max(b-e,1),g=0,h=this.Nn,n=this.fg,k=0;;){if(32>f||16>n){for(f=e;f<=b;f++)for(var l=c;l<=d;l++)if(k=this.Eh[g+h*f+(l>>4)]>>2*(l&15)&3,1<k)return 2;if(0==k)return 0;if(1==k)return 1}g+=h*n;n=a.J.truncate(n/2);h=a.J.truncate((2*
n+31)/32);c=a.J.truncate(c/2);e=a.J.truncate(e/2);d=a.J.truncate(d/2);b=a.J.truncate(b/2);f=Math.max(d-c,1)*Math.max(b-e,1)}};c.prototype.kT=function(){return this.fg*this.Nn};return c}();a.ty=c})(C||(C={}));(function(a){(function(a){a[a.contains=1]="contains";a[a.within=2]="within";a[a.equals=3]="equals";a[a.disjoint=4]="disjoint";a[a.touches=8]="touches";a[a.crosses=16]="crosses";a[a.overlaps=32]="overlaps";a[a.unknown=0]="unknown";a[a.intersects=1073741824]="intersects"})(a.rN||(a.rN={}));var b=
function(){function a(){}a.pa=function(b,c,d,e,f,g,n,k){var h=new a;h.bx=b;h.Fn=c;h.ik=d;h.sj=e;h.DI=f;h.l_=g;h.m_=n;h.n_=k;return h};return a}(),c=function(){function b(){}b.VE=function(c,d,e){if(!b.az(c))return!1;var f=a.na.$g(d,c,!1);d=!1;a.yl.KF(c)&&(d=d||c.bv(f,e));f=c.G();1736!=f&&1607!=f||!a.yl.IF(c)||0==e||(d=d||c.Kj(e));1736!=f&&1607!=f||!a.yl.JF(c)||0==e||(d=d||c.WN());return d};b.az=function(b){return a.yl.KF(b)||a.yl.IF(b)||a.yl.JF(b)};return b}();a.Iu=c;c=function(){function c(){this.Qh=
[]}c.bC=function(b,d,e,f,g){var h=b.G(),p=d.G();if(197==h){if(197==p)return c.IW(b,d,e,f);if(33==p)return 2==f?f=1:1==f&&(f=2),c.pE(d,b,e,f)}else if(33==h){if(197==p)return c.pE(b,d,e,f);if(33==p)return c.SW(b,d,e,f)}if(b.u()||d.u())return 4==f?!0:!1;var k=new a.h;b.s(k);var n=new a.h;d.s(n);var l=new a.h;l.I(k);l.Nb(n);e=a.na.$d(e,l,!1);if(c.Gk(k,n,e))return 4==f?!0:!1;k=!1;a.Bl.Nc(h)&&(h=new a.Ua(b.description),h.cc(b,!0),b=h,h=1607);a.Bl.Nc(p)&&(p=new a.Ua(d.description),p.cc(d,!0),d=p,p=1607);
if(197!=h&&197!=p){if(b.ub()<d.ub()||33==h&&550==p)2==f?f=1:1==f&&(f=2)}else 1736!=h&&197!=p&&(2==f?f=1:1==f&&(f=2));switch(h){case 1736:switch(p){case 1736:k=c.iu(b,d,e,f,g);break;case 1607:k=c.Un(b,d,e,f,g);break;case 33:k=c.hu(b,d,e,f,g);break;case 550:k=c.gu(b,d,e,f,g);break;case 197:k=c.TK(b,d,e,f,g)}break;case 1607:switch(p){case 1736:k=c.Un(d,b,e,f,g);break;case 1607:k=c.PB(b,d,e,f,g);break;case 33:k=c.ku(b,d,e,f,g);break;case 550:k=c.ju(b,d,e,f,g);break;case 197:k=c.rL(b,d,e,f)}break;case 33:switch(p){case 1736:k=
c.hu(d,b,e,f,g);break;case 1607:k=c.ku(d,b,e,f,g);break;case 550:k=c.cu(d,b,e,f,g)}break;case 550:switch(p){case 1736:k=c.gu(d,b,e,f,g);break;case 1607:k=c.ju(d,b,e,f,g);break;case 550:k=c.GB(b,d,e,f,g);break;case 33:k=c.cu(b,d,e,f,g);break;case 197:k=c.nH(b,d,e,f)}break;case 197:switch(p){case 1736:k=c.TK(d,b,e,f,g);break;case 1607:k=c.rL(d,b,e,f);break;case 550:k=c.nH(d,b,e,f)}}return k};c.IW=function(b,d,e,f){if(b.u()||d.u())return 4==f?!0:!1;var g=new a.h,h=new a.h,p=new a.h;b.s(g);d.s(h);p.I(g);
p.Nb(h);b=a.na.$d(e,p,!1);switch(f){case 4:return c.Gk(g,h,b);case 2:return c.mE(h,g,b);case 1:return c.mE(g,h,b);case 3:return c.ye(g,h,b);case 8:return c.UL(g,h,b);case 32:return c.OL(g,h,b);case 16:return c.LL(g,h,b)}return!1};c.pE=function(b,d,e,f){if(b.u()||d.u())return 4==f?!0:!1;b=b.w();var g=new a.h,h=new a.h;d.s(g);h.I(b);h.Nb(g);d=a.na.$d(e,h,!1);switch(f){case 4:return c.Dx(b,g,d);case 2:return c.KC(b,g,d);case 1:return c.vV(b,g,d);case 3:return c.MH(b,g,d);case 8:return c.jC(b,g,d)}return!1};
c.SW=function(b,d,e,f){if(b.u()||d.u())return 4==f?!0:!1;b=b.w();d=d.w();var g=new a.h;g.I(b);g.Nb(d);e=a.na.$d(e,g,!1);switch(f){case 4:return c.HV(b,d,e);case 2:return c.LH(d,b,e);case 1:return c.LH(b,d,e);case 3:return c.NH(b,d,e)}return!1};c.iu=function(a,b,d,e,f){switch(e){case 4:return c.wL(a,b,d);case 2:return c.Ex(b,a,d,f);case 1:return c.Ex(a,b,d,f);case 3:return c.ML(a,b,d);case 8:return c.qM(a,b,d);case 32:return c.VL(a,b,d,f)}return!1};c.Un=function(a,b,d,e,f){switch(e){case 4:return c.CL(a,
b,d);case 1:return c.OB(a,b,d,f);case 8:return c.tM(a,b,d,f);case 16:return c.uY(a,b,d)}return!1};c.hu=function(a,b,d,e){switch(e){case 4:return c.TY(a,b,d);case 1:return c.HW(a,b,d);case 8:return c.mM(a,b,d)}return!1};c.gu=function(a,b,d,e){switch(e){case 4:return c.QY(a,b,d);case 1:return c.ZV(a,b,d);case 8:return c.iM(a,b,d);case 16:return c.jX(a,b,d)}return!1};c.TK=function(a,b,d,e,f){if(c.IY(a,b,d))return 4==e?!0:!1;if(4==e)return!1;switch(e){case 2:return c.vM(a,b,d);case 1:return c.PV(a,b,
d);case 3:return c.GL(a,b,d);case 8:return c.YL(a,b,d,f);case 32:return c.PL(a,b,d,f);case 16:return c.RW(a,b,d,f)}return!1};c.PB=function(a,b,d,e){switch(e){case 4:return c.FN(a,b,d);case 2:return c.oL(b,a,d);case 1:return c.oL(a,b,d);case 3:return c.KN(a,b,d);case 8:return c.dD(a,b,d);case 32:return c.PN(a,b,d);case 16:return c.qL(a,b,d)}return!1};c.ku=function(a,b,d,e){switch(e){case 4:return c.CN(a,b,d);case 1:return c.DM(a,b,d);case 8:return c.RO(a,b,d)}return!1};c.ju=function(a,b,d,e){switch(e){case 4:return c.vN(a,
b,d);case 1:return c.AM(a,b,d);case 8:return c.uL(a,b,d);case 16:return c.oN(a,b,d)}return!1};c.rL=function(a,b,d,e){if(c.qN(a,b,d))return 4==e?!0:!1;if(4==e)return!1;switch(e){case 2:return c.aP(a,b,d);case 1:return c.yM(a,b,d);case 3:return c.IN(a,b,d);case 8:return c.SN(a,b,d);case 32:return c.MN(a,b,d);case 16:return c.gN(a,b,d)}return!1};c.GB=function(a,b,d,e){switch(e){case 4:return c.$O(a,b,d);case 2:return c.sG(b,a,d);case 1:return c.sG(a,b,d);case 3:return c.YQ(a,b,d);case 32:return c.FR(a,
b,d)}return!1};c.cu=function(a,b,d,e){switch(e){case 4:return c.xG(a,b,d);case 2:return c.HU(a,b,d);case 1:return c.RN(a,b,d);case 3:return c.zx(a,b,d)}return!1};c.nH=function(a,b,d,e){switch(e){case 4:return c.xO(a,b,d);case 2:return c.HT(a,b,d);case 1:return c.ON(a,b,d);case 3:return c.IP(a,b,d);case 8:return c.eS(a,b,d);case 16:return c.tL(a,b,d)}return!1};c.ML=function(b,d,e){var f=new a.h,g=new a.h;b.s(f);d.s(g);if(!c.ye(f,g,e))return!1;f=c.uc(b,d,!1);if(4==f||1==f||2==f)return!1;if(c.oG(b,d,
e))return!0;f=b.Rb();g=d.Rb();return Math.abs(f-g)>4*Math.max(b.D(),d.D())*e?!1:c.IA(b,d,e,!0)};c.wL=function(a,b,d){var e=c.uc(a,b,!0);return 4==e?!0:1==e||2==e||1073741824==e?!1:c.LJ(a,b,d)};c.qM=function(a,b,d){var e=c.uc(a,b,!1);return 4==e||1==e||2==e?!1:c.lL(a,b,d,null)};c.VL=function(a,b,d,e){var f=c.uc(a,b,!1);return 4==f||1==f||2==f?!1:c.YJ(a,b,d,e)};c.Ex=function(b,d,e,f){var g=new a.h,h=new a.h;b.s(g);d.s(h);if(!c.Dc(g,h,e))return!1;g=c.uc(b,d,!1);return 4==g||2==g?!1:1==g?!0:c.oJ(b,d,
e,f)};c.CL=function(a,b,d){var e=c.uc(a,b,!0);return 4==e?!0:1==e||1073741824==e?!1:c.LJ(a,b,d)};c.tM=function(a,b,d,e){var f=c.uc(a,b,!1);return 4==f||1==f?!1:c.mL(a,b,d,e)};c.uY=function(a,b,d){var e=c.uc(a,b,!1);return 4==e||1==e?!1:c.FJ(a,b,d,null)};c.OB=function(b,d,e,f){var g=new a.h,h=new a.h;b.s(g);d.s(h);if(!c.Dc(g,h,e))return!1;g=c.uc(b,d,!1);return 4==g?!1:1==g?!0:c.qJ(b,d,e,f)};c.TY=function(b,c,d){return 0==a.fd.KH(b,c,d)?!0:!1};c.mM=function(a,b,d){b=b.w();return c.dL(a,b,d)};c.HW=function(a,
b,d){b=b.w();return c.gJ(a,b,d)};c.QY=function(b,d,e){var f=c.uc(b,d,!1);if(4==f)return!0;if(1==f)return!1;f=new a.h;b.s(f);f.P(e,e);for(var g=new a.b,h=0;h<d.D();h++)if(d.w(h,g),f.contains(g)){var p=a.fd.ee(b,g,e);if(1==p||2==p)return!1}return!0};c.iM=function(b,c,d){var e=this.uc(b,c,!1);if(4==e||1==e)return!1;e=new a.h;b.s(e);e.P(d,d);var f,g=!1,h;h=b;for(var p=!1,k=0;k<c.D();k++){f=c.Ba(k);if(e.contains(f))if(f=a.fd.ee(h,f,d),2==f)g=!0;else if(1==f)return!1;p||(!a.cf.vm(b,c.D()-1)||null!=b.ob&&
null!=b.ob.Mb?h=b:(h=new a.Ja,b.copyTo(h),h.Kj(1)),p=!0)}return g?!0:!1};c.jX=function(b,c,d){var e=this.uc(b,c,!1);if(4==e||1==e)return!1;var f=new a.h,e=new a.h,g=new a.h;b.s(f);c.s(g);e.I(f);e.P(d,d);var g=f=!1,h,p;p=b;for(var k=!1,n=0;n<c.D();n++){h=c.Ba(n);e.contains(h)?(h=a.fd.ee(p,h,d),0==h?g=!0:1==h&&(f=!0)):g=!0;if(f&&g)return!0;k||(!a.cf.vm(b,c.D()-1)||null!=b.ob&&null!=b.ob.Mb?p=b:(p=new a.Ja,b.copyTo(p),p.Kj(1)),k=!0)}return!1};c.ZV=function(b,c,d){var e=new a.h,f=new a.h;b.s(e);c.s(f);
if(!this.Dc(e,f,d))return!1;f=this.uc(b,c,!1);if(4==f)return!1;if(1==f)return!0;var f=!1,g,h;h=b;for(var p=!1,k=0;k<c.D();k++){g=c.Ba(k);if(!e.contains(g))return!1;g=a.fd.ee(h,g,d);if(1==g)f=!0;else if(0==g)return!1;p||(!a.cf.vm(b,c.D()-1)||null!=b.ob&&null!=b.ob.Mb?h=b:(h=new a.Ja,b.copyTo(h),h.Kj(1)),p=!0)}return f};c.GL=function(b,d,e){var f=new a.h,g=new a.h;b.s(f);d.s(g);if(!c.ye(f,g,e))return!1;f=new a.Ja;f.hd(d,!1);return c.IA(b,f,e,!0)};c.IY=function(b,d,e){var f=c.uc(b,d,!1);if(4==f)return!0;
if(1==f||2==f)return!1;var g=new a.h,f=new a.h;b.s(g);d.s(f);if(c.Dc(f,g,e))return!1;g=new a.b;f.Zn(g);d=a.fd.ee(b,g,e);if(0!=d)return!1;f.HJ(g);d=a.fd.ee(b,g,e);if(0!=d)return!1;f.$n(g);d=a.fd.ee(b,g,e);if(0!=d)return!1;f.KJ(g);d=a.fd.ee(b,g,e);if(0!=d)return!1;d=b.Qa(0);g=new a.h;g.I(f);g.P(e,e);for(var h=0,p=b.D();h<p;h++){var k=d.read(2*h),n=d.read(2*h+1);if(g.contains(k,n))return!1}return!c.UE(b,f,e)};c.YL=function(b,d,e,f){var g=c.uc(b,d,!1);if(4==g||1==g||2==g)return!1;var g=new a.h,h=new a.h;
b.s(g);d.s(h);if(c.Dc(h,g,e))return!1;if(h.O()<=e&&h.ea()<=e)return d=d.Bq(),c.dL(b,d,e);if(h.O()<=e||h.ea()<=e)return g=new a.Ua,h=new a.Wa,d.gg(0,h),g.Of(h),d.gg(2,h),g.lineTo(h),c.mL(b,g,e,f);g=new a.Ja;g.hd(d,!1);return c.lL(b,g,e,f)};c.PL=function(b,d,e,f){var g=c.uc(b,d,!1);if(4==g||1==g||2==g)return!1;var g=new a.h,h=new a.h;b.s(g);d.s(h);if(c.Dc(h,g,e)||h.O()<=e||h.ea()<=e)return!1;g=new a.Ja;g.hd(d,!1);return c.YJ(b,g,e,f)};c.vM=function(b,d,e){var f=new a.h,g=new a.h;b.s(f);d.s(g);return c.Dc(g,
f,e)};c.PV=function(b,d,e){var f=new a.h,g=new a.h;b.s(f);d.s(g);if(!c.Dc(f,g,e))return!1;f=c.uc(b,d,!1);if(4==f||2==f)return!1;if(1==f)return!0;if(g.O()<=e&&g.ea()<=e)return d=d.Bq(),c.gJ(b,d,e);if(g.O()<=e||g.ea()<=e)return g=new a.Ua,f=new a.Wa,d.gg(0,f),g.Of(f),d.gg(2,f),g.lineTo(f),c.qJ(b,g,e,null);g=new a.Ja;g.hd(d,!1);return c.oJ(b,g,e,null)};c.RW=function(b,d,e,f){var g=new a.h,h=new a.h;b.s(g);d.s(h);if(c.Dc(h,g,e)||h.ea()>e&&h.O()>e||h.ea()<=e&&h.O()<=e)return!1;g=new a.Ua;h=new a.Wa;d.gg(0,
h);g.Of(h);d.gg(2,h);g.lineTo(h);return c.FJ(b,g,e,f)};c.KN=function(b,d,e){var f=new a.h,g=new a.h;b.s(f);d.s(g);return c.ye(f,g,e)&&4!=c.uc(b,d,!1)?c.oG(b,d,e)?!0:c.IA(b,d,e,!1):!1};c.FN=function(b,c,d){return 4==this.uc(b,c,!1)?!0:(new a.Rm(b,c,d,!0)).next()?!this.TH(b,c,d):!1};c.dD=function(b,d,e){if(4==c.uc(b,d,!1))return!1;var f=new a.Pd(0);if(0!=c.FB(b,d,e,f))return!1;for(var g=new a.Dd,h=0;h<f.size;h+=2){var p=f.read(h),k=f.read(h+1);g.qv(p,k)}b=b.Fg();d=d.Fg();b.Hd(d,0,d.D());return c.yx(b,
g,e)};c.qL=function(b,d,e){if(4==c.uc(b,d,!1))return!1;var f=new a.Pd(0);if(0!=c.FB(b,d,e,f))return!1;for(var g=new a.Dd,h=0;h<f.size;h+=2){var p=f.read(h),k=f.read(h+1);g.qv(p,k)}b=b.Fg();d=d.Fg();b.Hd(d,0,d.D());return!c.yx(b,g,e)};c.PN=function(a,b,d){return 4==c.uc(a,b,!1)?!1:c.LF(a,b,d)};c.oL=function(b,d,e){var f=new a.h,g=new a.h;b.s(f);d.s(g);return c.Dc(f,g,e)&&4!=c.uc(b,d,!1)?c.lf(d,b,e,!1):!1};c.CN=function(a,b,d){if(4==c.uc(a,b,!1))return!0;b=b.w();return!c.KA(a,b,d)};c.RO=function(a,
b,d){if(4==c.uc(a,b,!1))return!1;b=b.w();return c.HB(a,b,d)};c.DM=function(a,b,d){if(4==c.uc(a,b,!1))return!1;b=b.w();return c.bD(a,b,d)};c.vN=function(a,b,d){return 4==c.uc(a,b,!1)?!0:!c.rF(a,b,d,!1)};c.uL=function(b,c,d){if(4==this.uc(b,c,!1))return!1;var e=b.Fa(),f=new a.h,g=new a.h,h=new a.h;b.s(f);c.s(g);f.P(d,d);g.P(d,d);h.I(f);h.Ma(g);var p,k,f=null;p=b.ob;null!=p?(k=p.Mb,f=p.tp,null==k&&(k=p=a.na.Pj(b,h))):k=p=a.na.Pj(b,h);var n=k.jf(),l=null;null!=f&&(l=f.jf());var m=new a.b,y=new a.b,q=
!1,r=d*d,f=new a.Km(c.D());for(p=0;p<c.D();p++)f.write(p,0);for(p=0;p<c.D();p++)if(c.w(p,m),h.contains(m))if(g.I(m.x,m.y,m.x,m.y),null==l||(l.Oi(g,d),-1!=l.next())){n.Oi(g,d);for(var t=n.next();-1!=t;t=n.next())if(e.Tb(k.ia(t)),t=e.ba(),t.hc(t.ne(m,!1),y),a.b.sc(m,y)<=r){f.write(p,1);q=!0;break}}if(!q)return!1;b=b.Fg();e=new a.Dd;g=new a.b;for(p=0;p<c.D();p++)0!=f.read(p)&&(c.w(p,g),e.qv(g.x,g.y));return this.yx(b,e,d)};c.oN=function(b,c,d){if(4==this.uc(b,c,!1))return!1;var e=b.Fa(),f=new a.h,g=
new a.h,h=new a.h;b.s(f);c.s(g);f.P(d,d);g.P(d,d);h.I(f);h.Ma(g);var p,k,f=null;p=b.ob;null!=p?(k=p.Mb,f=p.tp,null==k&&(k=p=a.na.Pj(b,h))):k=p=a.na.Pj(b,h);var n=k.jf(),l=null;null!=f&&(l=f.jf());var m=new a.b,y=new a.b,q=!1,r=!1,t=d*d,f=new a.Km(c.D());for(p=0;p<c.D();p++)f.write(p,0);for(p=0;p<c.D();p++)if(c.w(p,m),h.contains(m))if(g.I(m.x,m.y,m.x,m.y),null!=l&&(l.Oi(g,d),-1==l.next()))r=!0;else{n.Oi(g,d);for(var w=!1,u=n.next();-1!=u;u=n.next())if(e.Tb(k.ia(u)),u=e.ba(),u.hc(u.ne(m,!1),y),a.b.sc(m,
y)<=t){f.write(p,1);w=q=!0;break}w||(r=!0)}else r=!0;if(!q||!r)return!1;b=b.Fg();e=new a.Dd;g=new a.b;for(p=0;p<c.D();p++)0!=f.read(p)&&(c.w(p,g),e.qv(g.x,g.y));return!this.yx(b,e,d)};c.AM=function(b,d,e){var f=new a.h,g=new a.h;b.s(f);d.s(g);if(!c.Dc(f,g,e)||4==c.uc(b,d,!1)||!c.rF(b,d,e,!0))return!1;b=b.Fg();return!c.mH(b,d,e)};c.IN=function(b,d,e){var f=new a.h,g=new a.h;b.s(f);d.s(g);return g.ea()>e&&g.O()>e?!1:c.ye(f,g,e)};c.qN=function(b,d,e){var f=new a.h,g=new a.h;b.s(f);d.s(g);return c.Dc(g,
f,e)?!1:!c.UE(b,g,e)};c.SN=function(b,d,e){var f=new a.h,g=new a.h;b.s(f);d.s(g);if(g.ea()<=e&&g.O()<=e)return g=d.Bq(),c.HB(b,g,e);if(g.ea()<=e||g.O()<=e)return g=new a.Ua,f=new a.Wa,d.gg(0,f),g.Of(f),d.gg(2,f),g.lineTo(f),c.dD(b,g,e);b=b.Fa();d=new a.h;f=new a.h;d.I(g);f.I(g);d.P(-e,-e);f.P(e,e);for(var g=!1,h=new a.h,p=new a.h;b.Ya();)for(;b.Ea();){b.ba().s(h);p.I(d);p.Ma(h);if(!p.u()&&(p.ea()>e||p.O()>e))return!1;p.I(f);p.Ma(h);p.u()||(g=!0)}return g};c.MN=function(b,d,e){var f=new a.h,g=new a.h;
b.s(f);d.s(g);if(c.Dc(f,g,e)||c.Dc(g,f,e)||c.Dc(g,f,e)||g.ea()>e&&g.O()>e||g.ea()<=e&&g.O()<=e)return!1;f=new a.Ua;g=new a.Wa;d.gg(0,g);f.Of(g);d.gg(2,g);f.lineTo(g);return c.LF(b,f,e)};c.aP=function(b,d,e){var f=new a.h,g=new a.h;b.s(f);d.s(g);if(!c.Dc(g,f,e)||g.ea()<=e&&g.O()<=e)return!1;if(g.ea()<=e||g.O()<=e)return c.Dc(g,f,e);b=b.Fa();d=new a.h;d.I(g);d.P(-e,-e);for(var g=!1,f=new a.h,h=new a.h;b.Ya();)for(;b.Ea();)b.ba().s(f),d.Zm(f)?g=!0:(h.I(d),h.Ma(f),!h.u()&&(h.ea()>e||h.O()>e)&&(g=!0));
return g};c.yM=function(b,d,e){var f=new a.h,g=new a.h;d.s(g);b.s(f);if(!c.Dc(f,g,e)||g.ea()>e&&g.O()>e)return!1;if(g.ea()<=e&&g.O()<=e)return d=d.Bq(),c.bD(b,d,e);f=new a.Ua;g=new a.Wa;d.gg(0,g);f.Of(g);d.gg(2,g);f.lineTo(g);return c.lf(f,b,e,!1)};c.gN=function(b,d,e){var f=new a.h,g=new a.h;b.s(f);d.s(g);if(c.Dc(g,f,e)||g.ea()<=e&&g.O()<=e)return!1;if(g.ea()<=e||g.O()<=e)return f=new a.Ua,g=new a.Wa,d.gg(0,g),f.Of(g),d.gg(2,g),f.lineTo(g),c.qL(b,f,e);b=b.Fa();d=new a.h;f=new a.h;f.I(g);d.I(g);f.P(-e,
-e);d.P(e,e);for(var h=g=!1,p=new a.h,k=new a.h;b.Ya();)for(;b.Ea();)if(b.ba().s(p),h||d.contains(p)||(h=!0),g||(k.I(f),k.Ma(p),!k.u()&&(k.ea()>e||k.O()>e)&&(g=!0)),g&&h)return!0;return!1};c.YQ=function(b,d,e){var f=new a.h,g=new a.h;b.s(f);d.s(g);return c.ye(f,g,e)?c.rR(b,d,e)?!0:c.RB(b,d,e,!1,!0,!1):!1};c.$O=function(a,b,d){return!c.mH(a,b,d)};c.FR=function(a,b,d){return c.RB(a,b,d,!1,!1,!0)};c.sG=function(b,d,e){var f=new a.h,g=new a.h;b.s(f);d.s(g);return c.Dc(f,g,e)?c.RB(d,b,e,!0,!1,!1):!1};
c.yx=function(b,c,d){d*=d;for(var e=new a.b,f=new a.b,g=0;g<c.D();g++){c.w(g,f);for(var h=!1,p=0;p<b.D();p++)if(b.w(p,e),a.b.sc(e,f)<=d){h=!0;break}if(!h)return!1}return!0};c.zx=function(b,d,e){var f=new a.h,g=new a.h;b.s(f);d.s(g);return c.ye(f,g,e)};c.xG=function(a,b,d){b=b.w();return c.bu(a,b,d)};c.HU=function(a,b,d){return c.zx(a,b,d)};c.RN=function(a,b,d){return!c.xG(a,b,d)};c.IP=function(b,d,e){var f=new a.h,g=new a.h;b.s(f);d.s(g);return g.ea()>e||g.O()>e?!1:c.ye(f,g,e)};c.xO=function(b,d,
e){var f=new a.h,g=new a.h;b.s(f);d.s(g);if(c.Dc(g,f,e))return!1;d=new a.h;d.I(g);d.P(e,e);e=new a.b;for(g=0;g<b.D();g++)if(b.w(g,e),d.contains(e))return!1;return!0};c.eS=function(b,c,d){var e=new a.h,f=new a.h,g=new a.h;c.s(e);if(e.ea()<=d&&e.O()<=d)return!1;if(e.ea()<=d||e.O()<=d){c=new a.b;var h=!1;f.I(e);g.I(e);f.P(d,d);e.ea()>d?g.P(0,-d):g.P(-d,0);for(var p=0;p<b.D();p++)if(b.w(p,c),f.contains(c)){if(e.ea()>d){if(c.y>g.A&&c.y<g.B)return!1}else if(c.x>g.o&&c.x<g.v)return!1;h=!0}return h}f.I(e);
g.I(e);f.P(d,d);g.P(-d,-d);c=new a.b;h=!1;for(p=0;p<b.D();p++)if(b.w(p,c),f.contains(c)){if(g.Zm(c))return!1;h=!0}return h};c.HT=function(b,d,e){var f=new a.h,g=new a.h;b.s(f);d.s(g);if(!c.Dc(g,f,e))return!1;if(g.ea()<=e&&g.O()<=e)return c.ye(f,g,e);if(g.ea()<=e||g.O()<=e){d=!1;var f=new a.h,h=new a.h;f.I(g);h.I(g);g.ea()>e?f.P(0,-e):f.P(-e,0);h.P(e,e);for(var p=new a.b,k=0;k<b.D();k++){b.w(k,p);if(!h.contains(p))return!1;g.ea()>e?p.y>f.A&&p.y<f.B&&(d=!0):p.x>f.o&&p.x<f.v&&(d=!0)}return d}d=!1;f=
new a.h;h=new a.h;f.I(g);h.I(g);f.P(-e,-e);h.P(e,e);p=new a.b;for(k=0;k<b.D();k++){b.w(k,p);if(!h.contains(p))return!1;f.Zm(p)&&(d=!0)}return d};c.ON=function(b,d,e){var f=new a.h,g=new a.h;b.s(f);d.s(g);if(!c.Dc(f,g,e)||g.ea()>e||g.O()>e)return!1;d=d.Bq();return!c.bu(b,d,e)};c.tL=function(b,d,e){var f=new a.h,g=new a.h;b.s(f);d.s(g);if(c.Dc(g,f,e)||g.ea()<=e&&g.O()<=e)return!1;if(g.ea()<=e||g.O()<=e){d=new a.h;f=new a.h;d.I(g);g.ea()>e?d.P(0,-e):d.P(-e,0);f.I(g);f.P(e,e);for(var h=new a.b,p=!1,k=
!1,n=0;n<b.D();n++)if(b.w(n,h),p||(g.ea()>e?h.y>d.A&&h.y<d.B&&(p=!0):h.x>d.o&&h.x<d.v&&(p=!0)),k||f.contains(h)||(k=!0),p&&k)return!0;return!1}d=new a.h;f=new a.h;d.I(g);d.P(-e,-e);f.I(g);f.P(e,e);h=new a.b;k=p=!1;for(n=0;n<b.D();n++)if(b.w(n,h),!p&&d.Zm(h)&&(p=!0),k||f.contains(h)||(k=!0),p&&k)return!0;return!1};c.NH=function(b,c,d){return a.b.sc(b,c)<=d*d?!0:!1};c.HV=function(b,c,d){return a.b.sc(b,c)>d*d?!0:!1};c.LH=function(a,b,d){return c.NH(a,b,d)};c.MH=function(b,d,e){var f=new a.h;f.I(b);
return c.ye(f,d,e)};c.Dx=function(b,c,d){var e=new a.h;e.I(c);e.P(d,d);return!e.contains(b)};c.jC=function(b,c,d){if(c.ea()<=d&&c.O()<=d)return!1;var e=new a.h,f=new a.h;e.I(c);e.P(d,d);if(!e.contains(b))return!1;if(c.ea()<=d||c.O()<=d){f.I(c);c.ea()>d?f.P(0,-d):f.P(-d,0);if(c.ea()>d){if(b.y>f.A&&b.y<f.B)return!1}else if(b.x>f.o&&b.x<f.v)return!1;return!0}f.I(c);f.P(-d,-d);return f.Zm(b)?!1:!0};c.KC=function(b,c,d){if(c.ea()<=d&&c.O()<=d)return!0;if(c.ea()<=d||c.O()<=d){var e=new a.h;e.I(c);c.ea()>
d?e.P(0,-d):e.P(-d,0);var f=!1;c.ea()>d?b.y>e.A&&b.y<e.B&&(f=!0):b.x>e.o&&b.x<e.v&&(f=!0);return f}e=new a.h;e.I(c);e.P(-d,-d);return e.Zm(b)};c.vV=function(a,b,d){return c.MH(a,b,d)};c.ye=function(a,b,d){return c.Dc(a,b,d)&&c.Dc(b,a,d)};c.Gk=function(b,c,d){var e=new a.h;e.I(c);e.P(d,d);return!b.Yb(e)};c.UL=function(b,d,e){if(b.ea()<=e&&b.O()<=e){var f=b.Tf();return c.jC(f,d,e)}if(d.ea()<=e&&d.O()<=e)return f=d.Tf(),c.jC(f,b,e);b.ea()>e&&b.O()>e&&(d.ea()<=e||d.O()<=e)?f=d:(f=b,b=d);if(f.ea()<=e||
f.O()<=e){if(b.ea()<=e||b.O()<=e){d=new a.Hb;var g=new a.Hb,h=[0,0],p=[0,0],k=new a.b;f.Zn(k);d.Lc(k);f.$n(k);d.Xc(k);b.Zn(k);g.Lc(k);b.$n(k);g.Xc(k);d.Ma(g,null,h,p,e);return 1!=d.Ma(g,null,null,null,e)?!1:0==h[0]||1==h[1]||0==p[0]||1==p[1]}d=new a.h;g=new a.h;d.I(b);d.P(-e,-e);g.I(d);g.Ma(f);return!g.u()&&(g.ea()>e||g.O()>e)?!1:!0}b.P(e,e);g=new a.h;g.I(f);g.Ma(b);return g.u()||!g.u()&&g.ea()>e&&g.O()>e?!1:!0};c.OL=function(b,d,e){if(c.Dc(b,d,e)||c.Dc(d,b,e)||b.ea()<=e&&b.O()<=e||d.ea()<=e&&d.O()<=
e)return!1;if(b.ea()<=e||b.O()<=e){if(d.ea()>e&&d.O()>e)return!1;var f=new a.Hb,g=new a.Hb,h=[0,0],p=[0,0],k=new a.b;b.Zn(k);f.Lc(k);b.$n(k);f.Xc(k);d.Zn(k);g.Lc(k);d.$n(k);g.Xc(k);f.Ma(g,null,h,p,e);return 2!=f.Ma(g,null,null,null,e)?!1:(0<h[0]||1>h[1])&&(0<p[0]||1>p[1])}if(d.ea()<=e||d.O()<=e)return!1;f=new a.h;f.I(b);f.Ma(d);return f.u()||f.ea()<=e||f.O()<=e?!1:!0};c.mE=function(b,d,e){if(!c.Dc(b,d,e))return!1;if(b.ea()<=e&&b.O()<=e)return b=b.Tf(),c.KC(b,d,e);if(d.ea()<=e&&d.O()<=e)return d=d.Tf(),
c.KC(d,b,e);if(b.ea()<=e||b.O()<=e)return c.Dc(b,d,e);if(d.ea()<=e||d.O()<=e){var f=new a.h;f.I(b);f.P(-e,-e);if(f.Zm(d))return!0;b=new a.h;b.I(f);b.Ma(d);return b.u()||b.ea()<=e&&b.O()<=e?!1:!0}return c.Dc(b,d,e)};c.LL=function(b,d,e){if(c.Dc(b,d,e)||c.Dc(d,b,e)||b.ea()<=e&&b.O()<=e||d.ea()<=e&&d.O()<=e||d.ea()>e&&d.O()>e&&b.ea()>e&&b.O()>e)return!1;var f;b.ea()>e&&b.O()>e?f=d:(f=b,b=d);if(b.ea()>e&&b.O()>e){d=new a.h;var g=new a.h;g.I(b);g.P(-e,-e);d.I(g);d.Ma(f);return d.u()||d.ea()<=e&&d.O()<=
e?!1:!0}d=new a.Hb;var g=new a.Hb,h=[0,0],p=[0,0],k=new a.b;f.Zn(k);d.Lc(k);f.$n(k);d.Xc(k);b.Zn(k);g.Lc(k);b.$n(k);g.Xc(k);d.Ma(g,null,h,p,e);return 1!=d.Ma(g,null,null,null,e)?!1:0<h[0]&&1>h[1]&&0<p[0]&&1>p[1]};c.LJ=function(b,c,d){var e,f,g=new a.h,h=new a.h,p=new a.Rm(b,c,d,!0);if(!p.next())return!0;if(this.TH(b,c,d))return!1;var k;k=b;var n;n=null;1736==c.G()&&(n=c);var l=!1,m=!1;do{e=p.Vl();f=p.Rl();f=c.Ba(c.wa(f));g.I(p.hA());g.P(d,d);if(g.contains(f)&&(f=a.fd.ee(k,f,0),0!=f)||1736==c.G()&&
(e=b.Ba(b.wa(e)),h.I(p.Lz()),h.P(d,d),h.contains(e)&&(f=a.fd.ee(n,e,0),0!=f)))return!1;l||(!a.cf.vm(b,c.aa()-1)||null!=b.ob&&null!=b.ob.Mb?k=b:(k=new a.Ja,b.copyTo(k),k.Kj(1)),l=!0);1736!=c.G()||m||(m=c,!a.cf.vm(m,b.aa()-1)||null!=c.ob&&null!=c.ob.Mb?n=c:(n=new a.Ja,m.copyTo(n),n.Kj(1)),m=!0)}while(p.next());return!0};c.Dc=function(b,c,d){var e=new a.h;e.I(b);e.P(d,d);return e.contains(c)};c.xl=function(b,c,d){var e=new a.h;e.I(c);e.P(d,d);c=new a.b;b.Zn(c);if(!e.contains(c))return!0;b.HJ(c);if(!e.contains(c))return!0;
b.KJ(c);if(!e.contains(c))return!0;b.$n(c);return e.contains(c)?!1:!0};c.oG=function(b,c,d){if(b.aa()!=c.aa()||b.D()!=c.D())return!1;var e=new a.b,f=new a.b,g=!0;d*=d;for(var h=0;h<b.aa();h++){if(b.Fc(h)!=c.Fc(h)){g=!1;break}for(var p=b.wa(h);p<c.Fc(h);p++)if(b.w(p,e),c.w(p,f),a.b.sc(e,f)>d){g=!1;break}if(!g)break}return g?!0:!1};c.rR=function(b,c,d){if(b.D()!=c.D())return!1;var e=new a.b,f=new a.b,g=!0;d*=d;for(var h=0;h<b.D();h++)if(b.w(h,e),c.w(h,f),a.b.sc(e,f)>d){g=!1;break}return g?!0:!1};c.RB=
function(b,c,d,e,f,g){var h=!1,p;b.D()>c.D()?(e&&(e=!1,h=!0),p=c):(p=b,b=c);c=null;if(f||g||h){c=new a.Km(b.D());for(var k=0;k<b.D();k++)c.write(k,0)}var k=new a.h,n=new a.h,l=new a.h;p.s(k);b.s(n);k.P(d,d);n.P(d,d);l.I(k);l.Ma(n);for(var n=new a.b,m=new a.b,q=!0,y=a.na.CF(b,l),r=y.jf(),t=d*d,w=0;w<p.D();w++)if(p.w(w,n),l.contains(n)){var u=!1;k.I(n.x,n.y,n.x,n.y);r.Oi(k,d);for(var D=r.next();-1!=D&&!(D=y.ia(D),b.w(D,m),a.b.sc(n,m)<=t&&((f||g||h)&&c.write(D,1),u=!0,e));D=r.next());if(!u&&(q=!1,f||
e))return!1}else{if(f||e)return!1;q=!1}if(g&&q)return!1;if(e)return!0;for(k=0;k<b.D();k++)if(1==c.read(k)){if(g)return!0}else if(f||h)return!1;return g?!1:!0};c.mH=function(b,c,d){var e;b.D()>c.D()?e=c:(e=b,b=c);c=new a.h;var f=new a.h,g=new a.h;e.s(c);b.s(f);c.P(d,d);f.P(d,d);g.I(c);g.Ma(f);for(var f=new a.b,h=new a.b,p=d*d,k=a.na.CF(b,g),n=k.jf(),l=0;l<e.D();l++)if(e.w(l,f),g.contains(f)){c.I(f.x,f.y,f.x,f.y);n.Oi(c,d);for(var m=n.next();-1!=m;m=n.next())if(b.w(k.ia(m),h),a.b.sc(f,h)<=p)return!0}return!1};
c.IA=function(a,b,d,e){return c.lf(a,b,d,e)&&c.lf(b,a,d,e)};c.lf=function(d,e,f,g){function h(a,b){return q.WF(a,b)}var p=!0,k=[0,0],n=[0,0],l=0,m=new a.ha(0),q=new c,y,r=new a.h,t=new a.h,w=new a.h;d.s(r);e.s(t);r.P(f,f);t.P(f,f);w.I(r);w.Ma(t);d=d.Fa();var t=e.Fa(),u=null,D=u=null,v=e.ob;null!=v?(u=v.Mb,D=v.tp,null==u&&(u=a.na.Pj(e,w))):u=a.na.Pj(e,w);e=u.jf();v=null;for(null!=D&&(v=D.jf());d.Ya();)for(;d.Ea();){var x=!1,z=d.ba();z.s(r);if(!r.Yb(w))return!1;if(null!=v&&(v.Oi(r,f),-1==v.next()))return p=
!1;D=z.Rb();e.bo(z,f);for(y=e.next();-1!=y;y=e.next()){t.Tb(u.ia(y));y=t.ba();var B=z.Ma(y,null,k,n,f);if(2==B&&(!g||n[0]<=n[1])){var B=k[0],I=k[1],A=n[0],F=n[1];if(B*D<=f&&(1-I)*D<=f){x=!0;l=0;m.resize(0);q.Qh.length=0;for(var C=d.Db(),A=!0;A;){if(d.Ea()){z=d.ba();D=z.Rb();B=z.Ma(y,null,k,n,f);if(2==B&&(!g||n[0]<=n[1])&&(B=k[0],I=k[1],B*D<=f&&(1-I)*D<=f)){C=d.Db();continue}if(t.Ea()&&(y=t.ba(),B=z.Ma(y,null,k,n,f),2==B&&(!g||n[0]<=n[1])&&(B=k[0],I=k[1],B*D<=f&&(1-I)*D<=f))){C=d.Db();continue}}A=
!1}C!=d.Db()&&(d.Tb(C),d.ba());break}else C=d.Db(),y=b.pa(C,d.Ta,B,I,t.Db(),t.Ta,A,F),q.Qh.push(y),m.add(m.size)}}if(!x){if(l==q.Qh.length)return!1;1<m.size-l&&m.Fd(l,m.size,h);for(x=0;l<q.Qh.length;l++)if(y=q.Qh[m.get(l)],!(y.ik<x&&y.sj<x)){if(D*(y.ik-x)>f)return!1;x=y.sj;if(D*(1-x)<=f||1==x)break}if(D*(1-x)>f)return!1;l=0;m.resize(0);q.Qh.length=0}}return p};c.LF=function(b,d,e){if(1>c.FB(b,d,e,null))return!1;var f=new a.h,g=new a.h;b.s(f);d.s(g);var h=c.xl(f,g,e),f=c.xl(g,f,e);return h&&f?!0:h&&
!f?!c.lf(d,b,e,!1):f&&!h?!c.lf(b,d,e,!1):!c.lf(b,d,e,!1)&&!c.lf(d,b,e,!1)};c.FB=function(d,e,f,g){function h(a,b){return t.WF(a,b)}var p,k;d.lA()>e.lA()?(p=e,k=d):(p=d,k=e);d=p.Fa();e=k.Fa();var n=[0,0],l=[0,0],m=-1,q=0,y,r=new a.ha(0),t=new c,w,u=new a.h,D=new a.h,v=new a.h;p.s(u);k.s(D);u.P(f,f);D.P(f,f);v.I(u);v.Ma(D);p=null;null!=g&&(p=new a.b);y=D=D=null;var x=k.ob;null!=x?(D=x.Mb,y=x.tp,null==D&&(D=a.na.Pj(k,v))):D=a.na.Pj(k,v);k=D.jf();x=null;for(null!=y&&(x=y.jf());d.Ya();)for(y=0;d.Ea();){var z=
d.ba();z.s(u);if(u.Yb(v)&&(null==x||(x.Oi(u,f),-1!=x.next()))){var B=z.Rb();k.bo(z,f);for(var I=k.next();-1!=I;I=k.next()){var A=D.ia(I);e.Tb(A);w=e.ba();var F=w.Rb(),C=z.Ma(w,null,n,l,f);if(0<C){var I=n[0],m=l[0],G=2==C?n[1]:NaN,E=2==C?l[1]:NaN;if(2==C){if(B*(G-I)>f)return m=1;var J=B*(G-I);if(e.Ea()){w=e.ba();C=z.Ma(w,null,n,null,f);if(2==C){var C=n[0],H=n[1],C=B*(H-C);if(J+C>f)return m=1}e.Tb(A);e.ba()}if(!e.pn()){e.Mi();w=e.Mi();C=z.Ma(w,null,n,null,f);if(2==C&&(C=n[0],H=n[1],C=B*(H-C),J+C>f))return m=
1;e.Tb(A);e.ba()}if(d.Ea()){A=d.Db();z=d.ba();C=z.Ma(w,null,n,null,f);if(2==C&&(C=n[0],H=n[1],C=B*(H-C),J+C>f))return m=1;d.Tb(A);d.ba()}if(!d.pn()){A=d.Db();d.Mi();z=d.Mi();C=z.Ma(w,null,n,null,f);if(2==C&&(C=n[0],H=n[1],C=F*(H-C),J+C>f))return m=1;d.Tb(A);d.ba()}w=b.pa(d.Db(),d.Ta,I,G,e.Db(),e.Ta,m,E);t.Qh.push(w);r.add(r.size)}m=0;null!=g&&(z.hc(I,p),g.add(p.x),g.add(p.y))}}if(q<t.Qh.length){r.Fd(q,r.size,h);z=0;for(I=t.Qh[r.get(q)].Fn;q<t.Qh.length;q++)if(w=t.Qh[r.get(q)],!(w.ik<z&&w.sj<z))if(B*
(w.ik-z)>f)y=B*(w.sj-w.ik),z=w.sj,I=w.Fn;else{w.Fn!=I?(y=B*(w.sj-w.ik),I=w.Fn):y+=B*(w.sj-w.ik);if(y>f)return m=1;z=w.sj;if(1==z)break}B*(1-z)>f&&(y=0);q=0;r.resize(0);t.Qh.length=0}}}return m};c.TH=function(b,c,d){var e=b.Fa(),f=c.Fa();for(b=new a.Rm(b,c,d,!1);b.next();){c=b.Vl();var g=b.Rl();e.Tb(c);f.Tb(g);c=e.ba();if(0<f.ba().Ma(c,null,null,null,d))return!0}return!1};c.rF=function(b,c,d,e){var f=b.Fa(),g=new a.h,h=new a.h,p=new a.h;b.s(g);c.s(h);g.P(d,d);g.contains(h);h.P(d,d);p.I(g);p.Ma(h);
g=b.ob;null!=g?(g=g.Mb,null==g&&(g=a.na.Pj(b,p))):g=a.na.Pj(b,p);b=g.jf();for(var k=new a.b,n=new a.b,l=d*d,m=0;m<c.D();m++)if(c.w(m,k),p.contains(k)){h.I(k.x,k.y,k.x,k.y);b.Oi(h,d);for(var q=!1,y=b.next();-1!=y;y=b.next())if(f.Tb(g.ia(y)),y=f.ba(),y.hc(y.ne(k,!1),n),a.b.sc(n,k)<=l){q=!0;break}if(e){if(!q)return!1}else if(q)return!0}return e?!0:!1};c.KA=function(b,c,d){var e=new a.b,f=d*d,g=b.Fa();b=b.ob;if(null!=b&&(b=b.Mb,null!=b)){var h=new a.h;h.I(c);d=b.$z(h,d);for(h=d.next();-1!=h;h=d.next())if(g.Tb(b.ia(h)),
g.Ea()){var h=g.ba(),p=h.ne(c,!1);h.hc(p,e);if(a.b.sc(c,e)<=f)return!0}return!1}for(b=new a.h;g.Ya();)for(;g.Ea();)if(h=g.ba(),h.s(b),b.P(d,d),b.contains(c)&&(p=h.ne(c,!1),h.hc(p,e),a.b.sc(c,e)<=f))return!0;return!1};c.bD=function(a,b,d){return c.KA(a,b,d)&&!c.HB(a,b,d)};c.HB=function(a,b,d){a=a.Fg();return!c.bu(a,b,d)};c.UE=function(b,c,d){if(b.on()){var e=new a.Hb(c.o,c.A,c.o,c.B),f=new a.Hb(c.o,c.B,c.v,c.B),g=new a.Hb(c.v,c.B,c.v,c.A);c=new a.Hb(c.v,c.A,c.o,c.A);for(b=b.Fa();b.Ya();)for(;b.Ea();){var h=
b.ba();if(h.Yb(e,d)||h.Yb(f,d)||h.Yb(g,d)||h.Yb(c,d))return!0}}else{e=new a.h;e.I(c);e.P(d,d);d=b.Qa(0);f=new a.b;g=new a.b;c=new a.b;for(var h=new a.b,p=0,k=b.aa();p<k;p++)for(var n=!0,l=b.wa(p),m=b.Fc(p);l<m;l++)if(n)d.fc(2*l,g),n=!1;else{d.fc(2*l,f);c.L(g);h.L(f);if(0!=e.ez(c,h))return!0;g.L(f)}}return!1};c.uc=function(b,d,e){var f=b.G(),g=d.G();if(a.T.fh(f)){var h=b.ob;if(null!=h&&(h=h.Ii,null!=h))if(33==g){var p=d.w(),p=h.wm(p.x,p.y);if(1==p)return 1;if(0==p)return 4}else{p=new a.h;d.s(p);p=
h.Xn(p);if(1==p)return 1;if(0==p)return 4;if(e&&a.T.fh(g)&&c.gE(d,h))return 1073741824}}if(a.T.fh(g)&&(h=d.ob,null!=h&&(h=h.Ii,null!=h)))if(33==f){b=b.w();p=h.wm(b.x,b.y);if(1==p)return 2;if(0==p)return 4}else{d=new a.h;b.s(d);p=h.Xn(d);if(1==p)return 2;if(0==p)return 4;if(e&&a.T.fh(f)&&c.gE(b,h))return 1073741824}return 0};c.gE=function(b,c){for(var d=b.D(),e=new a.b,f=0;f<d;f++)if(b.w(f,e),1==c.wm(e.x,e.y))return!0;return!1};c.lL=function(b,c,d,e){for(var f=1<=b.Nk(0)&&1<=c.Nk(0),g=b.Fa(),h=c.Fa(),
p=[0,0],k=[0,0],n=new a.Rm(b,c,d,!1),l=!1;n.next();){var m=n.Vl(),q=n.Rl();g.Tb(m);h.Tb(q);m=g.ba();q=h.ba().Ma(m,null,k,p,d);if(2==q){l=p[0];q=p[1];m=m.Rb();if(f&&(q-l)*m>d)return!1;l=!0}else if(0!=q){l=p[0];m=k[0];if(0<l&&1>l&&0<m&&1>m)return!1;l=!0}}if(!l)return!1;g=new a.h;h=new a.h;f=new a.h;b.s(g);c.s(h);g.P(1E3*d,1E3*d);h.P(1E3*d,1E3*d);f.I(g);f.Ma(h);return 10<b.D()&&(b=a.le.clip(b,f,d,0),b.u())||10<c.D()&&(c=a.le.clip(c,f,d,0),c.u())?!1:a.Tm.iu(b,c,d,"F********",e)};c.YJ=function(b,d,e,f){var g=
1<=b.Nk(0)&&1<=d.Nk(0),h=new a.h,p=new a.h,k=new a.h;b.s(h);d.s(p);for(var n=!1,l=c.xl(h,p,e),m=c.xl(p,h,e),q=b.Fa(),y=d.Fa(),r=[0,0],t=[0,0],w=new a.Rm(b,d,e,!1);w.next();){var u=w.Vl(),D=w.Rl();q.Tb(u);y.Tb(D);D=q.ba();u=y.ba().Ma(D,null,t,r,e);if(2==u){var u=r[0],v=r[1],D=D.Rb();if(g&&(v-u)*D>e&&(n=!0,l&&m))return!0}else if(0!=u&&(u=r[0],D=t[0],0<u&&1>u&&0<D&&1>D))return!0}g=new a.h;q=new a.h;g.I(h);g.P(1E3*e,1E3*e);q.I(p);q.P(1E3*e,1E3*e);k.I(g);k.Ma(q);h="";h=n?h+"**":h+"T*";if(l){if(10<d.D()&&
(d=a.le.clip(d,k,e,0),d.u()))return!1;h+="****"}else h+="T***";if(m){if(10<b.D()&&(b=a.le.clip(b,k,e,0),b.u()))return!1;h+="***"}else h+="T**";return a.Tm.iu(b,d,e,h.toString(),f)};c.oJ=function(b,d,e,f){var g=[!1],h=c.eJ(b,d,e,g);if(g[0])return h;g=new a.h;d.s(g);g.P(1E3*e,1E3*e);return 10<b.D()&&(b=a.le.clip(b,g,e,0),b.u())?!1:a.Tm.Ex(b,d,e,f)};c.eJ=function(b,c,d,e){e[0]=!1;for(var f=b.Fa(),g=c.Fa(),h=[0,0],p=[0,0],k=new a.Rm(b,c,d,!1),n=!1;k.next();){var l=k.Vl(),m=k.Rl();f.Tb(l,-1);g.Tb(m,-1);
l=f.ba();l=g.ba().Ma(l,null,p,h,d);if(0!=l&&(n=!0,1==l&&(l=h[0],m=p[0],0<l&&1>l&&0<m&&1>m)))return e[0]=!0,!1}if(!n){e[0]=!0;h=new a.h;b.s(h);h.P(d,d);k=b;n=!1;p=new a.h;e=0;for(f=c.aa();e<f;e++)if(0<c.La(e)){c.nk(e,p);if(h.Yb(p)){if(g=c.Ba(c.wa(e)),g=a.cf.qn(k,g,0),0==g)return!1}else return!1;n||(!a.cf.vm(b,c.aa()-1)||null!=b.ob&&null!=b.ob.Mb?k=b:(g=new a.Ja,b.copyTo(g),g.Kj(1),k=g),n=!0)}if(1==b.aa()||1607==c.G())return!0;h=new a.h;c.s(h);h.P(d,d);p=c;k=!1;d=new a.h;e=0;for(f=b.aa();e<f;e++)if(0<
b.La(e)){b.nk(e,d);if(h.Yb(d)&&(g=b.Ba(b.wa(e)),g=a.cf.qn(p,g,0),1==g))return!1;k||(!a.cf.vm(c,b.aa()-1)||null!=c.ob&&null!=c.ob.Mb?p=c:(g=new a.Ja,c.copyTo(g),g.Kj(1),p=g),k=!0)}return!0}return!1};c.mL=function(b,c,d,e){for(var f=b.Fa(),g=c.Fa(),h=[0,0],p=[0,0],k=new a.Rm(b,c,d,!1),n=!1;k.next();){var l=k.Vl(),m=k.Rl();f.Tb(l);g.Tb(m);l=f.ba();l=g.ba().Ma(l,null,p,h,d);if(2==l)n=!0;else if(0!=l){n=h[0];l=p[0];if(0<n&&1>n&&0<l&&1>l)return!1;n=!0}}if(!n)return!1;g=new a.h;h=new a.h;f=new a.h;b.s(g);
c.s(h);g.P(1E3*d,1E3*d);h.P(1E3*d,1E3*d);f.I(g);f.Ma(h);return 10<b.D()&&(b=a.le.clip(b,f,d,0),b.u())||10<c.D()&&(c=a.le.clip(c,f,d,0),c.u())?!1:a.Tm.Un(b,c,d,"F********",e)};c.FJ=function(b,d,e,f){for(var g=b.Fa(),h=d.Fa(),p=[0,0],k=[0,0],n=new a.Rm(b,d,e,!1),l=!1;n.next();){var m=n.Vl(),q=n.Rl();g.Tb(m);h.Tb(q);m=g.ba();m=h.ba().Ma(m,null,k,p,e);if(2==m)l=!0;else if(0!=m){l=p[0];m=k[0];if(0<l&&1>l&&0<m&&1>m)return!0;l=!0}}if(!l)return!1;h=new a.h;p=new a.h;k=new a.h;n=new a.h;g=new a.h;b.s(h);d.s(p);
return c.xl(p,h,e)?(k.I(h),k.P(1E3*e,1E3*e),n.I(p),n.P(1E3*e,1E3*e),g.I(k),g.Ma(n),10<b.D()&&(b=a.le.clip(b,g,e,0),b.u())||10<d.D()&&(d=a.le.clip(d,g,e,0),d.u())?!1:e=a.Tm.Un(b,d,e,"T********",f)):e=a.Tm.Un(b,d,e,"T*****T**",f)};c.qJ=function(b,d,e,f){var g=[!1],h=c.eJ(b,d,e,g);if(g[0])return h;g=new a.h;d.s(g);g.P(1E3*e,1E3*e);return 10<b.D()&&(b=a.le.clip(b,g,e,0),b.u())?!1:a.Tm.OB(b,d,e,f)};c.gJ=function(b,c,d){return 1==a.fd.ee(b,c,d)?!0:!1};c.dL=function(b,c,d){return 2==a.fd.ee(b,c,d)?!0:!1};
c.bu=function(b,c,d){var e=new a.b;d*=d;for(var f=0;f<b.D();f++)if(b.w(f,e),a.b.sc(e,c)<=d)return!1;return!0};c.prototype.WF=function(a,b){a=this.Qh[a];b=this.Qh[b];return a.Fn<b.Fn||a.Fn==b.Fn&&(a.bx<b.bx||a.bx==b.bx&&(a.ik<b.ik||a.ik==b.ik&&(a.sj<b.sj||a.sj==b.sj&&a.DI<b.DI)))?-1:1};return c}();a.Ed=c})(C||(C={}));(function(a){var b;(function(a){a[a.InteriorInterior=0]="InteriorInterior";a[a.InteriorBoundary=1]="InteriorBoundary";a[a.InteriorExterior=2]="InteriorExterior";a[a.BoundaryInterior=3]=
"BoundaryInterior";a[a.BoundaryBoundary=4]="BoundaryBoundary";a[a.BoundaryExterior=5]="BoundaryExterior";a[a.ExteriorInterior=6]="ExteriorInterior";a[a.ExteriorBoundary=7]="ExteriorBoundary";a[a.ExteriorExterior=8]="ExteriorExterior"})(b||(b={}));var c;(function(a){a[a.AreaAreaPredicates=0]="AreaAreaPredicates";a[a.AreaLinePredicates=1]="AreaLinePredicates";a[a.LineLinePredicates=2]="LineLinePredicates";a[a.AreaPointPredicates=3]="AreaPointPredicates";a[a.LinePointPredicates=4]="LinePointPredicates";
a[a.PointPointPredicates=5]="PointPointPredicates"})(c||(c={}));b=function(){function b(){this.Fe=0;this.i=new a.Vu;this.H=[0,0,0,0,0,0,0,0,0];this.eb=[0,0,0,0,0,0,0,0,0];this.fa=[!1,!1,!1,!1,!1,!1,!1,!1,!1];this.Ln=this.jx=-1}b.aC=function(b,c,d,e,f){if(9!=e.length)throw a.g.X("relation string length has to be 9 characters");for(var g=0;9>g;g++){var h=e.charAt(g);if("*"!=h&&"T"!=h&&"F"!=h&&"0"!=h&&"1"!=h&&"2"!=h)throw a.g.X("relation string");}g=this.fT(e,b.ub(),c.ub());if(0!=g)return a.Ed.bC(b,
c,d,g,f);g=new a.h;b.s(g);h=new a.h;c.s(h);var p=new a.h;p.I(g);p.Nb(h);d=a.na.$d(d,p,!1);b=this.bG(b,d);c=this.bG(c,d);if(b.u()||c.u())return this.XW(b,c,e);g=c.G();h=!1;switch(b.G()){case 1736:switch(g){case 1736:h=this.iu(b,c,d,e,f);break;case 1607:h=this.Un(b,c,d,e,f);break;case 33:h=this.hu(b,c,d,e,f);break;case 550:h=this.gu(b,c,d,e,f)}break;case 1607:switch(g){case 1736:h=this.Un(c,b,d,this.Pq(e),f);break;case 1607:h=this.PB(b,c,d,e,f);break;case 33:h=this.ku(b,c,d,e,f);break;case 550:h=this.ju(b,
c,d,e,f)}break;case 33:switch(g){case 1736:h=this.hu(c,b,d,this.Pq(e),f);break;case 1607:h=this.ku(c,b,d,this.Pq(e),f);break;case 33:h=this.jW(b,c,d,e);break;case 550:h=this.cu(c,b,d,this.Pq(e),f)}break;case 550:switch(g){case 1736:h=this.gu(c,b,d,this.Pq(e),f);break;case 1607:h=this.ju(c,b,d,this.Pq(e),f);break;case 550:h=this.GB(b,c,d,e,f);break;case 33:h=this.cu(b,c,d,e,f)}break;default:h=!1}return h};b.iu=function(c,d,e,f,g){var h=new b;h.yj();h.Cj(f);h.cK();var p=new a.h,k=new a.h;c.s(p);d.s(k);
f=!1;a.Ed.Gk(p,k,e)&&(h.rv(c,d),f=!0);f||(p=a.Ed.uc(c,d,!1),4==p?(h.rv(c,d),f=!0):1==p?(h.Py(d),f=!0):2==p&&(h.nF(c),f=!0));f||(f=new a.ed,c=f.Jb(c),d=f.Jb(d),h.Mp(f,e,g),h.tq(c,d),h.i.ph());return b.yg(h.H,h.cd)};b.Ex=function(c,d,e,f){var g=new b;g.yj();g.Cj("T*****F**");g.cK();var h=new a.h,p=new a.h;c.s(h);d.s(p);var k=!1;a.Ed.Gk(h,p,e)&&(g.rv(c,d),k=!0);k||(h=a.Ed.uc(c,d,!1),4==h?(g.rv(c,d),k=!0):1==h?(g.Py(d),k=!0):2==h&&(g.nF(c),k=!0));if(k)return h=this.yg(g.H,g.cd);k=new a.ed;c=k.Jb(c);h=
k.Jb(d);a.vk.V(k,e,f,!1);e=k.Pe(h).Fg();k.zq(0,!0,!0);a.so.V(k,c,-1,!1,f);if(0==k.D(c))return!1;a.so.V(k,h,-1,!1,f);g.Xr(k,f);d=0==k.D(h);if(!d&&(g.tq(c,h),g.i.ph(),h=this.yg(g.H,g.cd),!h))return h;c=k.Pe(c);k=new a.ed;c=k.Jb(c);h=k.Jb(e);g.Xr(k,f);g.Fe=0;g.yj();g.Cj(d?"T*****F**":"******F**");g.kC();g.tq(c,h);g.i.ph();return h=this.yg(g.H,g.cd)};b.Un=function(c,d,e,f,g){var h=new b;h.yj();h.Cj(f);h.kC();var k=new a.h,p=new a.h;c.s(k);d.s(p);f=!1;a.Ed.Gk(k,p,e)&&(h.sv(c,d),f=!0);f||(k=a.Ed.uc(c,d,
!1),4==k?(h.sv(c,d),f=!0):1==k&&(h.oF(d),f=!0));f||(f=new a.ed,c=f.Jb(c),d=f.Jb(d),h.Mp(f,e,g),h.Gh=h.i.wq(),b.Zu(d,h.i,h.Gh),h.tq(c,d),h.i.xq(h.Gh),h.i.ph());return b.yg(h.H,h.cd)};b.OB=function(c,d,e,f){var g=new b;g.yj();g.Cj("T*****F**");g.kC();var h=new a.h,k=new a.h;c.s(h);d.s(k);var p=!1;a.Ed.Gk(h,k,e)&&(g.sv(c,d),p=!0);p||(h=a.Ed.uc(c,d,!1),4==h?(g.sv(c,d),p=!0):1==h&&(g.oF(d),p=!0));if(p)return e=this.yg(g.H,g.cd);p=new a.ed;c=p.Jb(c);d=p.Jb(d);g.Mp(p,e,f);if(0==p.D(c))return!1;g.tq(c,d);
g.i.ph();return e=this.yg(g.H,g.cd)};b.gu=function(c,d,e,f,g){var h=new b;h.yj();h.Cj(f);h.dK();var k=new a.h,p=new a.h;c.s(k);d.s(p);f=!1;a.Ed.Gk(k,p,e)&&(h.tv(c),f=!0);f||(k=a.Ed.uc(c,d,!1),4==k?(h.tv(c),f=!0):1==k&&(h.YO(),f=!0));f||(f=new a.ed,c=f.Jb(c),d=f.Jb(d),h.Mp(f,e,g),h.jz(c,d),h.i.ph());return b.yg(h.H,h.cd)};b.PB=function(c,d,e,f,g){var h=new b;h.yj();h.Cj(f);h.DX();f=new a.h;var k=new a.h;c.s(f);d.s(k);var p=!1;a.Ed.Gk(f,k,e)&&(h.RH(c,d),p=!0);p||4!=a.Ed.uc(c,d,!1)||(h.RH(c,d),p=!0);
p||(f=new a.ed,c=f.Jb(c),d=f.Jb(d),h.Mp(f,e,g),h.yi=h.i.wq(),h.Gh=h.i.wq(),b.Zu(c,h.i,h.yi),b.Zu(d,h.i,h.Gh),h.tq(c,d),h.i.xq(h.yi),h.i.xq(h.Gh),h.i.ph());return b.yg(h.H,h.cd)};b.ju=function(c,d,e,f,g){var h=new b;h.yj();h.Cj(f);h.rK();f=new a.h;var k=new a.h;c.s(f);d.s(k);var p=!1;a.Ed.Gk(f,k,e)&&(h.JA(c),p=!0);p||4!=a.Ed.uc(c,d,!1)||(h.JA(c),p=!0);p||(f=new a.ed,c=f.Jb(c),d=f.Jb(d),h.Mp(f,e,g),h.yi=h.i.wq(),b.Zu(c,h.i,h.yi),h.jz(c,d),h.i.xq(h.yi),h.i.ph());return b.yg(h.H,h.cd)};b.GB=function(c,
d,e,f,g){var h=new b;h.yj();h.Cj(f);h.wK();f=new a.h;var k=new a.h;c.s(f);d.s(k);var p=!1;a.Ed.Gk(f,k,e)&&(h.uJ(),p=!0);p||(f=new a.ed,c=f.Jb(c),d=f.Jb(d),h.Mp(f,e,g),h.jz(c,d),h.i.ph());return b.yg(h.H,h.cd)};b.hu=function(c,d,e,f){var g=new b;g.yj();g.Cj(f);g.dK();var h=new a.h;c.s(h);d=d.w();var k=!1;a.Ed.Dx(d,h,e)&&(g.tv(c),k=!0);k||(e=a.fd.ee(c,d,e),1==e?(g.H[0]=0,g.H[2]=2,g.H[3]=-1,g.H[5]=1,g.H[6]=-1):2==e?(g.H[6]=-1,0!=c.ef()?(g.H[0]=-1,g.H[3]=0,g.H[2]=2,g.H[5]=1):(g.H[0]=0,g.H[3]=-1,g.H[5]=
-1,e=new a.h,c.s(e),g.H[2]=0==e.ea()&&0==e.O()?-1:1)):g.tv(c));return this.yg(g.H,f)};b.ku=function(c,d,e,f,g){var h=new b;h.yj();h.Cj(f);h.rK();var k=new a.h;c.s(k);f=d.w();var p=!1;a.Ed.Dx(f,k,e)&&(h.JA(c),p=!0);if(!p){var k=null,n=p=!1;if(h.fa[0]||h.fa[6])a.Ed.KA(c,f,e)?(h.fa[0]&&(k=a.Pi.Xm(c,g),n=!a.Ed.bu(k,f,e),p=!0,h.H[0]=n?-1:0),h.H[6]=-1):(h.H[0]=-1,h.H[6]=0);h.fa[3]&&(null!=k&&k.u()?h.H[3]=-1:(p||(null==k&&(k=a.Pi.Xm(c,g)),n=!a.Ed.bu(k,f,e),p=!0),h.H[3]=n?0:-1));h.fa[5]&&(null!=k&&k.u()?
h.H[5]=-1:p&&!n?h.H[5]=0:(null==k&&(k=a.Pi.Xm(c,g)),g=a.Ed.zx(k,d,e),h.H[5]=g?-1:0));h.fa[2]&&(0!=c.Rb()?h.H[2]=1:(g=new a.Dd(c.description),g.Hd(c,0,c.D()),c=a.Ed.zx(g,d,e),h.H[2]=c?-1:0))}return this.yg(h.H,h.cd)};b.cu=function(c,d,e,f){var g=new b;g.yj();g.Cj(f);g.wK();var h=new a.h;c.s(h);d=d.w();var k=!1;a.Ed.Dx(d,h,e)&&(g.uJ(),k=!0);if(!k){h=!1;k=!0;e*=e;for(var p=0;p<c.D();p++){var n=c.Ba(p);a.b.sc(n,d)<=e?h=!0:k=!1;if(h&&!k)break}h?(g.H[0]=0,g.H[2]=k?-1:0,g.H[6]=-1):(g.H[0]=-1,g.H[2]=0,g.H[6]=
0)}return b.yg(g.H,f)};b.jW=function(c,d,e,f){c=c.w();d=d.w();for(var g=[],h=0;9>h;h++)g[h]=-1;a.b.sc(c,d)<=e*e?g[0]=0:(g[2]=0,g[6]=0);g[8]=2;return b.yg(g,f)};b.yg=function(a,b){for(var c=0;9>c;c++)switch(b.charAt(c)){case "T":if(-1==a[c])return!1;break;case "F":if(-1!=a[c])return!1;break;case "0":if(0!=a[c])return!1;break;case "1":if(1!=a[c])return!1;break;case "2":if(2!=a[c])return!1}return!0};b.XW=function(b,c,d){var e=[-1,-1,-1,-1,-1,-1,-1,-1,-1];if(b.u()&&c.u()){for(var f=0;9>f;f++)e[f]=-1;
return this.yg(e,d)}f=!1;b.u()&&(b=c,f=!0);e[0]=-1;e[1]=-1;e[3]=-1;e[4]=-1;e[6]=-1;e[7]=-1;e[8]=2;c=b.G();a.T.Hc(c)?1736==c?0!=b.ef()?(e[2]=2,e[5]=1):(e[5]=-1,c=new a.h,b.s(c),e[2]=0==c.ea()&&0==c.O()?0:1):(c=0!=b.Rb(),e[2]=c?1:0,e[5]=a.Pi.Rq(b)?0:-1):(e[2]=0,e[5]=-1);f&&this.ZK(e);return this.yg(e,d)};b.fT=function(a,c,d){return b.XL(a)?3:b.BL(a)?4:b.DL(a,c,d)?8:b.ZY(a,c,d)?16:b.HY(a)?1:b.NU(a,c,d)?32:0};b.XL=function(a){return"T"==a.charAt(0)&&"*"==a.charAt(1)&&"F"==a.charAt(2)&&"*"==a.charAt(3)&&
"*"==a.charAt(4)&&"F"==a.charAt(5)&&"F"==a.charAt(6)&&"F"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1};b.BL=function(a){return"F"==a.charAt(0)&&"F"==a.charAt(1)&&"*"==a.charAt(2)&&"F"==a.charAt(3)&&"F"==a.charAt(4)&&"*"==a.charAt(5)&&"*"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1};b.DL=function(a,b,c){if(0==b&&0==c)return!1;if(2!=b||2!=c)if("F"==a.charAt(0)&&"*"==a.charAt(1)&&"*"==a.charAt(2)&&"T"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"*"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)||
1==b&&1==c&&"F"==a.charAt(0)&&"T"==a.charAt(1)&&"*"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"*"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8))return!0;return 0!=c&&"F"==a.charAt(0)&&"*"==a.charAt(1)&&"*"==a.charAt(2)&&"*"==a.charAt(3)&&"T"==a.charAt(4)&&"*"==a.charAt(5)&&"*"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1};b.ZY=function(a,b,c){return b>c?"T"==a.charAt(0)&&"*"==a.charAt(1)&&"*"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&
"T"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1:1==b&&1==c&&"0"==a.charAt(0)&&"*"==a.charAt(1)&&"*"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"*"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1};b.HY=function(a){return"T"==a.charAt(0)&&"*"==a.charAt(1)&&"*"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"F"==a.charAt(6)&&"F"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1};b.NU=function(a,b,c){if(b==c){if(1!=b)return"T"==a.charAt(0)&&"*"==a.charAt(1)&&
"T"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"T"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1;if("1"==a.charAt(0)&&"*"==a.charAt(1)&&"T"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"T"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8))return!0}return!1};b.Zu=function(a,b,c){a=b.Ia(a);for(var d=b.nf;-1!=d;d=b.ng(d))if(0!=(b.Ld(d)&a)){var e=b.gf(d);if(-1==e)b.ko(d,c,0);else{var f=e,g=0;do 0!=(b.Ah(f)&a)&&g++,f=b.qc(b.Aa(f));while(f!=e);b.ko(d,
c,g)}}};b.Pq=function(a){var b;b=""+a.charAt(0);b+=a.charAt(3);b+=a.charAt(6);b+=a.charAt(1);b+=a.charAt(4);b+=a.charAt(7);b+=a.charAt(2);b+=a.charAt(5);return b+=a.charAt(8)};b.prototype.yj=function(){for(var a=0;9>a;a++)this.H[a]=-2,this.eb[a]=-2};b.ZK=function(a){var b=a[1],c=a[2],d=a[5];a[1]=a[3];a[2]=a[6];a[5]=a[7];a[3]=b;a[6]=c;a[7]=d};b.prototype.Cj=function(a){this.cd=a;for(a=0;9>a;a++)"*"!=this.cd.charAt(a)?(this.fa[a]=!0,this.Fe++):this.fa[a]=!1};b.prototype.zK=function(){for(var a=0;9>
a;a++)this.fa[a]&&-2==this.H[a]&&(this.H[a]=-1,this.fa[a]=!1)};b.prototype.tc=function(a){if(-2==this.H[a])return!1;if(-1==this.H[a])return this.fa[a]=!1,this.Fe--,!0;if("T"!=this.cd.charAt(a)&&"F"!=this.cd.charAt(a)){if(this.H[a]<this.eb[a])return!1;this.fa[a]=!1;this.Fe--;return!0}this.fa[a]=!1;this.Fe--;return!0};b.prototype.cK=function(){this.jx=0;this.eb[0]=2;this.eb[1]=1;this.eb[2]=2;this.eb[3]=1;this.eb[4]=1;this.eb[5]=1;this.eb[6]=2;this.eb[7]=1;this.eb[8]=2;this.fa[8]&&(this.H[8]=2,this.fa[8]=
!1,this.Fe--)};b.prototype.kC=function(){this.jx=1;this.Ln=3;this.eb[0]=1;this.eb[1]=0;this.eb[2]=2;this.eb[3]=1;this.eb[4]=0;this.eb[5]=1;this.eb[6]=1;this.eb[7]=0;this.eb[8]=2;this.fa[8]&&(this.H[8]=2,this.fa[8]=!1,this.Fe--)};b.prototype.DX=function(){this.jx=2;this.Ln=4;this.eb[0]=1;this.eb[1]=0;this.eb[2]=1;this.eb[3]=0;this.eb[4]=0;this.eb[5]=0;this.eb[6]=1;this.eb[7]=0;this.eb[8]=2;this.fa[8]&&(this.H[8]=2,this.fa[8]=!1,this.Fe--)};b.prototype.dK=function(){this.Ln=3;this.eb[0]=0;this.eb[1]=
-1;this.eb[2]=2;this.eb[3]=0;this.eb[4]=-1;this.eb[5]=1;this.eb[6]=0;this.eb[7]=-1;this.eb[8]=2;this.fa[1]&&(this.H[1]=-1,this.fa[1]=!1,this.Fe--);this.fa[4]&&(this.H[4]=-1,this.fa[4]=!1,this.Fe--);this.fa[7]&&(this.H[7]=-1,this.fa[7]=!1,this.Fe--);this.fa[8]&&(this.H[8]=2,this.fa[8]=!1,this.Fe--)};b.prototype.rK=function(){this.Ln=4;this.eb[0]=0;this.eb[1]=-1;this.eb[2]=1;this.eb[3]=0;this.eb[4]=-1;this.eb[5]=0;this.eb[6]=0;this.eb[7]=-1;this.eb[8]=2;this.fa[1]&&(this.H[1]=-1,this.fa[1]=!1,this.Fe--);
this.fa[4]&&(this.H[4]=-1,this.fa[4]=!1,this.Fe--);this.fa[7]&&(this.H[7]=-1,this.fa[7]=!1,this.Fe--);this.fa[8]&&(this.H[8]=2,this.fa[8]=!1,this.Fe--)};b.prototype.wK=function(){this.Ln=5;this.eb[0]=0;this.eb[1]=-1;this.eb[2]=0;this.eb[3]=-1;this.eb[4]=-1;this.eb[5]=-1;this.eb[6]=0;this.eb[7]=-1;this.eb[8]=2;this.fa[1]&&(this.H[1]=-1,this.fa[1]=!1,this.Fe--);this.fa[3]&&(this.H[3]=-1,this.fa[3]=!1,this.Fe--);this.fa[4]&&(this.H[4]=-1,this.fa[4]=!1,this.Fe--);this.fa[5]&&(this.H[5]=-1,this.fa[5]=
!1,this.Fe--);this.fa[7]&&(this.H[7]=-1,this.fa[7]=!1,this.Fe--);this.fa[8]&&(this.H[8]=2,this.fa[8]=!1,this.Fe--)};b.prototype.WO=function(a,b,c){var d=!0;this.fa[0]&&(this.$T(a,b,c),d=d&&this.tc(0));this.fa[1]&&(this.tH(a,b,1),d=d&&this.tc(1));this.fa[2]&&(this.uH(a,b,c,2),d=d&&this.tc(2));this.fa[3]&&(this.tH(a,c,3),d=d&&this.tc(3));this.fa[4]&&(this.bP(a,b,c),d=d&&this.tc(4));this.fa[5]&&(this.sF(a,c,5),d=d&&this.tc(5));this.fa[6]&&(this.uH(a,c,b,6),d=d&&this.tc(6));this.fa[7]&&(this.sF(a,b,7),
d=d&&this.tc(7));return d};b.prototype.rv=function(a,b){this.H[0]=-1;this.H[1]=-1;this.H[3]=-1;this.H[4]=-1;this.Bs(a,this.fa[2]?2:-1,this.cd.charAt(2),this.fa[5]?5:-1,this.cd.charAt(5));this.Bs(b,this.fa[6]?6:-1,this.cd.charAt(6),this.fa[7]?7:-1,this.cd.charAt(7))};b.prototype.Bs=function(b,c,d,e,f){if(-1!=c||-1!=e)("T"!=d&&"F"!=d&&-1!=c||"T"!=f&&"F"!=f&&-1!=e?0!=b.ef():1)?(-1!=c&&(this.H[c]=2),-1!=e&&(this.H[e]=1)):(-1!=e&&(this.H[e]=-1),-1!=c&&(d=new a.h,b.s(d),this.H[c]=0==d.ea()&&0==d.O()?0:
1))};b.prototype.Py=function(a){this.H[2]=2;this.H[3]=-1;this.H[4]=-1;this.H[5]=1;this.H[6]=-1;this.H[7]=-1;this.Bs(a,this.fa[0]?0:-1,this.cd.charAt(0),this.fa[1]?1:-1,this.cd.charAt(1))};b.prototype.nF=function(a){this.Py(a);b.ZK(this.H)};b.prototype.sv=function(b,c){this.H[0]=-1;this.H[1]=-1;this.H[3]=-1;this.H[4]=-1;if(this.fa[6]){var d=this.cd.charAt(6),d="T"!=d&&"F"!=d?0!=c.Rb():!0;this.H[6]=d?1:0}this.fa[7]&&(d=a.Pi.Rq(c),this.H[7]=d?0:-1);this.Bs(b,this.fa[2]?2:-1,this.cd.charAt(2),this.fa[5]?
5:-1,this.cd.charAt(5))};b.prototype.oF=function(b){if(this.fa[0]){var c=this.cd.charAt(0),c="T"!=c&&"F"!=c?0!=b.Rb():!0;this.H[0]=c?1:0}this.fa[1]&&(b=a.Pi.Rq(b),this.H[1]=b?0:-1);this.H[2]=2;this.H[3]=-1;this.H[4]=-1;this.H[5]=1;this.H[6]=-1;this.H[7]=-1};b.prototype.tv=function(a){this.H[0]=-1;this.H[3]=-1;this.H[6]=0;this.Bs(a,this.fa[2]?2:-1,this.cd.charAt(2),this.fa[5]?5:-1,this.cd.charAt(5))};b.prototype.YO=function(){this.H[0]=0;this.H[2]=2;this.H[3]=-1;this.H[5]=1;this.H[6]=-1};b.prototype.RH=
function(b,c){this.H[0]=-1;this.H[1]=-1;this.H[3]=-1;this.H[4]=-1;if(this.fa[2]){var d=this.cd.charAt(2),d="T"!=d&&"F"!=d?0!=b.Rb():!0;this.H[2]=d?1:0}this.fa[5]&&(d=a.Pi.Rq(b),this.H[5]=d?0:-1);this.fa[6]&&(d=this.cd.charAt(6),d="T"!=d&&"F"!=d?0!=c.Rb():!0,this.H[6]=d?1:0);this.fa[7]&&(d=a.Pi.Rq(c),this.H[7]=d?0:-1)};b.prototype.JA=function(b){this.H[0]=-1;this.H[3]=-1;if(this.fa[2]){var c=this.cd.charAt(2),c="T"!=c&&"F"!=c?0!=b.Rb():!0;this.H[2]=c?1:0}this.fa[5]&&(b=a.Pi.Rq(b),this.H[5]=b?0:-1);
this.H[6]=0};b.prototype.uJ=function(){this.H[0]=-1;this.H[2]=0;this.H[6]=0};b.prototype.XO=function(a,b,c){var d=!0;this.fa[0]&&(this.aU(a,b),d=d&&this.tc(0));this.fa[1]&&(this.XT(a,b,c,this.Gh),d=d&&this.tc(1));this.fa[2]&&(this.YT(a,b),d=d&&this.tc(2));this.fa[3]&&(this.fP(a,b,c,this.Gh),d=d&&this.tc(3));this.fa[4]&&(this.cP(a,b,c,this.Gh),d=d&&this.tc(4));this.fa[5]&&(this.dP(a,b,c),d=d&&this.tc(5));this.fa[6]&&(this.BR(a,b),d=d&&this.tc(6));this.fa[7]&&(this.AR(a,b,c,this.Gh),d=d&&this.tc(7));
return d};b.prototype.RU=function(a,b,c){var d=!0;this.fa[0]&&(this.dU(a,b,c,this.yi,this.Gh),d=d&&this.tc(0));this.fa[1]&&(this.vH(a,b,c,this.yi,this.Gh,1),d=d&&this.tc(1));this.fa[2]&&(this.wH(a,b,c,2),d=d&&this.tc(2));this.fa[3]&&(this.vH(a,c,b,this.Gh,this.yi,3),d=d&&this.tc(3));this.fa[4]&&(this.hP(a,b,c,this.yi,this.Gh),d=d&&this.tc(4));this.fa[5]&&(this.tF(a,c,this.yi,5),d=d&&this.tc(5));this.fa[6]&&(this.wH(a,c,b,6),d=d&&this.tc(6));this.fa[7]&&(this.tF(a,b,this.Gh,7),d=d&&this.tc(7));return d};
b.prototype.pF=function(a,b,c){var d=!0;this.fa[0]&&(this.bU(a,b),d=d&&this.tc(0));this.fa[2]&&(this.ZT(a,b),d=d&&this.tc(2));this.fa[3]&&(this.gP(a,b,c),d=d&&this.tc(3));this.fa[5]&&(this.eP(a,b),d=d&&this.tc(5));this.fa[6]&&(this.CR(a,b),d=d&&this.tc(6));return d};b.prototype.SH=function(a,b,c){var d=!0;this.fa[0]&&(this.eU(a,b,c,this.yi),d=d&&this.tc(0));this.fa[2]&&(this.cU(a,c),d=d&&this.tc(2));this.fa[3]&&(this.jP(a,b,c,this.yi),d=d&&this.tc(3));this.fa[5]&&(this.iP(a,b,c,this.yi),d=d&&this.tc(5));
this.fa[6]&&(this.DR(a,b,c),d=d&&this.tc(6));return d};b.prototype.iW=function(a,b,c){var d=!0;this.fa[0]&&(this.fU(a,b,c),d=d&&this.tc(0));this.fa[2]&&(this.xH(a,b,c,2),d=d&&this.tc(2));this.fa[6]&&(this.xH(a,c,b,6),d=d&&this.tc(6));return d};b.prototype.$T=function(a,b,c){2!=this.H[0]&&(a=this.i.Bf(a),0!=(a&b)&&0!=(a&c)&&(this.H[0]=2))};b.prototype.tH=function(a,b,c){if(1!=this.H[c]){var d=this.i.Bf(this.i.Aa(a));0!=(this.i.Bf(a)&b)&&0!=(d&b)&&(this.H[c]=1)}};b.prototype.uH=function(a,b,c,d){2!=
this.H[d]&&(a=this.i.Bf(a),0!=(a&b)&&0==(a&c)&&(this.H[d]=2))};b.prototype.bP=function(a,b,c){if(1!=this.H[4]){var d=this.i.Ah(a);0!=(d&b)&&0!=(d&c)?this.H[4]=1:0!=this.H[4]&&1!=this.i.Kb(this.i.Qe(this.i.Aa(a)),this.wj)&&(a=this.i.Ld(this.i.Uf(a)),0!=(a&b)&&0!=(a&c)&&(this.H[4]=0))}};b.prototype.sF=function(a,b,c){if(1!=this.H[c]){var d=this.i.Bf(this.i.Aa(a));0==(this.i.Bf(a)&b)&&0==(d&b)&&(this.H[c]=1)}};b.prototype.aU=function(a,b){if(1!=this.H[0]){var c=this.i.Bf(this.i.Aa(a));0!=(this.i.Bf(a)&
b)&&0!=(c&b)&&(this.H[0]=1)}};b.prototype.XT=function(a,b,c,d){if(0!=this.H[1]&&1!=this.i.Kb(this.i.Qe(this.i.Aa(a)),this.wj)){var e=this.i.Uf(a),f=this.i.Ld(e);0==(f&b)&&0!=(this.i.Bf(a)&b)&&(a=this.i.Gg(e,d),0!=(f&c)&&0!=a%2&&(this.H[1]=0))}};b.prototype.YT=function(a,b){2!=this.H[2]&&0!=(this.i.Ah(a)&b)&&(this.H[2]=2)};b.prototype.fP=function(a,b,c,d){if(1!=this.H[3]){var e=this.i.Ah(a);0!=(e&b)&&0!=(e&c)?this.H[3]=1:0!=this.H[3]&&1!=this.i.Kb(this.i.Qe(this.i.Aa(a)),this.wj)&&(e=this.i.Uf(a),
a=this.i.Ld(e),0!=(a&b)&&(b=this.i.Gg(e,d),0!=(a&c)&&0==b%2&&(this.H[3]=0)))}};b.prototype.cP=function(a,b,c,d){if(0!=this.H[4]&&1!=this.i.Kb(this.i.Qe(this.i.Aa(a)),this.wj)){var e=this.i.Uf(a);a=this.i.Ld(e);0!=(a&b)&&(b=this.i.Gg(e,d),0!=(a&c)&&0!=b%2&&(this.H[4]=0))}};b.prototype.dP=function(a,b,c){1!=this.H[5]&&(a=this.i.Ah(a),0!=(a&b)&&0==(a&c)&&(this.H[5]=1))};b.prototype.BR=function(a,b){if(1!=this.H[6]){var c=this.i.Bf(this.i.Aa(a));0==(this.i.Bf(a)&b)&&0==(c&b)&&(this.H[6]=1)}};b.prototype.AR=
function(a,b,c,d){if(0!=this.H[7]&&1!=this.i.Kb(this.i.Qe(this.i.Aa(a)),this.wj)){var e=this.i.Uf(a),f=this.i.Ld(e);0==(f&b)&&0==(this.i.Bf(a)&b)&&(a=this.i.Gg(e,d),0!=(f&c)&&0!=a%2&&(this.H[7]=0))}};b.prototype.dU=function(a,b,c,d,e){if(1!=this.H[0]){var f=this.i.Ah(a);0!=(f&b)&&0!=(f&c)?this.H[0]=1:0!=this.H[0]&&1!=this.i.Kb(this.i.Qe(this.i.Aa(a)),this.wj)&&(a=this.i.Uf(a),f=this.i.Ld(a),0!=(f&b)&&0!=(f&c)&&(b=this.i.Gg(a,d),e=this.i.Gg(a,e),0==b%2&&0==e%2&&(this.H[0]=0)))}};b.prototype.vH=function(a,
b,c,d,e,f){if(0!=this.H[f]&&1!=this.i.Kb(this.i.Qe(this.i.Aa(a)),this.wj)){a=this.i.Uf(a);var g=this.i.Ld(a);0!=(g&b)&&0!=(g&c)&&(b=this.i.Gg(a,d),e=this.i.Gg(a,e),0==b%2&&0!=e%2&&(this.H[f]=0))}};b.prototype.wH=function(a,b,c,d){1!=this.H[d]&&(a=this.i.Ah(a),0!=(a&b)&&0==(a&c)&&(this.H[d]=1))};b.prototype.hP=function(a,b,c,d,e){if(0!=this.H[4]&&1!=this.i.Kb(this.i.Qe(this.i.Aa(a)),this.wj)){a=this.i.Uf(a);var f=this.i.Ld(a);0!=(f&b)&&0!=(f&c)&&(b=this.i.Gg(a,d),e=this.i.Gg(a,e),0!=b%2&&0!=e%2&&(this.H[4]=
0))}};b.prototype.tF=function(a,b,c,d){0!=this.H[d]&&1!=this.i.Kb(this.i.Qe(this.i.Aa(a)),this.wj)&&(a=this.i.Uf(a),0==(this.i.Ld(a)&b)&&0!=this.i.Gg(a,c)%2&&(this.H[d]=0))};b.prototype.bU=function(a,b){0!=this.H[0]&&0==(this.i.Ld(a)&b)&&0!=(this.i.Kk(this.i.Nz(a))&b)&&(this.H[0]=0)};b.prototype.ZT=function(a,b){2!=this.H[2]&&0!=(this.i.Ld(a)&b)&&(this.H[2]=2)};b.prototype.gP=function(a,b,c){0!=this.H[3]&&(a=this.i.Ld(a),0!=(a&b)&&0!=(a&c)&&(this.H[3]=0))};b.prototype.eP=function(a,b){1!=this.H[5]&&
0!=(this.i.Ld(a)&b)&&(this.H[5]=1)};b.prototype.CR=function(a,b){0!=this.H[6]&&0==(this.i.Ld(a)&b)&&0==(this.i.Kk(this.i.Nz(a))&b)&&(this.H[6]=0)};b.prototype.eU=function(a,b,c,d){if(0!=this.H[0]){var e=this.i.Ld(a);0!=(e&b)&&0!=(e&c)&&0==this.i.Gg(a,d)%2&&(this.H[0]=0)}};b.prototype.cU=function(a,b){1!=this.H[2]&&(-1!=this.i.gf(a)?this.H[2]=1:0!=this.H[2]&&0==(this.i.Ld(a)&b)&&(this.H[2]=0))};b.prototype.jP=function(a,b,c,d){if(0!=this.H[3]){var e=this.i.Ld(a);0!=(e&b)&&0!=(e&c)&&0!=this.i.Gg(a,
d)%2&&(this.H[3]=0)}};b.prototype.iP=function(a,b,c,d){if(0!=this.H[5]){var e=this.i.Ld(a);0!=(e&b)&&0==(e&c)&&0!=this.i.Gg(a,d)%2&&(this.H[5]=0)}};b.prototype.DR=function(a,b,c){0!=this.H[6]&&(a=this.i.Ld(a),0==(a&b)&&0!=(a&c)&&(this.H[6]=0))};b.prototype.fU=function(a,b,c){0!=this.H[0]&&(a=this.i.Ld(a),0!=(a&b)&&0!=(a&c)&&(this.H[0]=0))};b.prototype.xH=function(a,b,c,d){0!=this.H[d]&&(a=this.i.Ld(a),0!=(a&b)&&0==(a&c)&&(this.H[d]=0))};b.prototype.tq=function(b,c){var d=!1;b=this.i.Ia(b);c=this.i.Ia(c);
this.wj=this.i.xh();for(var e=this.i.nf;-1!=e;e=this.i.ng(e)){var f=this.i.gf(e);if(-1==f){if(-1!=this.Ln)switch(this.Ln){case 3:d=this.pF(e,b,c);break;case 4:d=this.SH(e,b,c);break;default:throw a.g.X("internal error");}}else{var g=f;do{var h=g;if(1!=this.i.Kb(h,this.wj)){do{switch(this.jx){case 0:d=this.WO(h,b,c);break;case 1:d=this.XO(h,b,c);break;case 2:d=this.RU(h,b,c);break;default:throw a.g.X("internal error");}if(d)break;this.i.Ob(h,this.wj,1);h=this.i.qc(h)}while(h!=g&&!d)}if(d)break;g=this.i.qc(this.i.Aa(h))}while(g!=
f);if(d)break}}d||this.zK();this.i.oi(this.wj)};b.prototype.jz=function(b,c){var d=!1;b=this.i.Ia(b);c=this.i.Ia(c);for(var e=this.i.nf;-1!=e;e=this.i.ng(e)){switch(this.Ln){case 3:d=this.pF(e,b,c);break;case 4:d=this.SH(e,b,c);break;case 5:d=this.iW(e,b,c);break;default:throw a.g.za();}if(d)break}d||this.zK()};b.prototype.Xr=function(a,b){this.i.Vr(a,b)};b.prototype.Mp=function(a,b,c){this.tR(a,b,c);this.Xr(a,c)};b.prototype.tR=function(b,c,d){a.vk.V(b,c,d,!1);b.zq(0,!0,!0);for(c=b.qd;-1!=c;c=b.Re(c))1736==
b.ic(c)&&a.so.V(b,c,-1,!1,d)};b.bG=function(b,c){var d=b.G();if(a.T.Nc(d))return d=new a.Ua(b.description),d.cc(b,!0),d;if(197==d){d=new a.h;b.s(d);if(d.ea()<=c&&d.O()<=c)return d=new a.Wa(b.description),b.Tf(d),d;if(d.ea()<=c||d.O()<=c)return d=new a.Ua(b.description),c=new a.Wa,b.gg(0,c),d.Of(c),b.gg(2,c),d.lineTo(c),d;d=new a.Ja(b.description);d.hd(b,!1);return d}return b};return b}();a.Tm=b})(C||(C={}));(function(a){var b=function(){function b(b){this.yn=new a.ha(0);this.Rw=new a.ha(0);this.ou=
new a.b;this.pu=new a.b;this.a=b;this.Ft=-1}b.prototype.jc=function(a){return this.a.jc(this.mA(a))};b.prototype.ow=function(a){var b=this.Uz(a);a=this.KG(a);if(this.a.Ra(b)==a){var c=b,b=a;a=c}this.a.Mc(b,this.ou);this.a.Mc(a,this.pu);return this.ou.y<this.pu.y};b.prototype.mA=function(a){var b=this.Uz(a);a=this.KG(a);return this.a.U(b)==a?b:a};b.prototype.Uz=function(a){return this.yn.get(a)};b.prototype.KG=function(a){return this.Rw.get(a)};b.prototype.vG=function(a){this.yn.set(a,this.Ft);this.Ft=
a};b.prototype.kJ=function(b){if(-1!=this.Ft){var c=this.Ft;this.Ft=this.yn.get(c);this.yn.set(c,b);this.Rw.set(c,this.a.U(b));return c}null==this.yn&&(this.yn=new a.ha(0),this.Rw=new a.ha(0));c=this.yn.size;this.yn.add(b);this.Rw.add(this.a.U(b));return c};b.prototype.fA=function(a){return this.a.kd(this.Uz(a))};return b}();a.mZ=b;var c=function(){function b(b){this.Ze=b;this.Ce=new a.Hb;this.Gn=new a.Hb;this.EI=0;this.up=null;this.hB=-1}b.prototype.compare=function(a,b,c){c=a.ia(c);var d=this.Ze.ib,
e;this.hB==b?e=this.EI:(this.up=d.jc(b),null==this.up?(a=d.a,a.nd(d.mA(b),this.Ce),this.up=this.Ce,e=this.Ce.kf(this.Ze.Xh,0)):e=this.up.kf(this.Ze.Xh,0),this.EI=e,this.hB=b);a=d.jc(c);var f;null==a?(a=d.a,a.nd(d.mA(c),this.Gn),a=this.Gn,f=this.Gn.kf(this.Ze.Xh,0)):f=a.kf(this.Ze.Xh,0);e==f&&(b=d.ow(b),c=d.ow(c),c=Math.min(b?this.up.oa:this.up.ra,c?a.oa:a.ra),b=.5*(c+this.Ze.Xh),b==this.Ze.Xh&&(b=c),e=this.up.kf(b,0),f=a.kf(b,0));return e<f?-1:e>f?1:0};b.prototype.reset=function(){this.hB=-1};return b}(),
d=function(){function d(){this.Qn=this.om=null;this.hb=new a.xk;this.hb.kR();this.te=new c(this);this.hb.Lp(this.te)}d.prototype.WR=function(){var b=!1;this.Vw&&(b=this.XR());if(1==this.a.aa(this.Y)){var c=this.a.Pb(this.Y),b=this.a.jA(c);this.a.rC(c,!0);return 0>b?(b=this.a.cb(c),this.a.UJ(b),this.a.rh(c,this.a.Ra(b)),!0):!1}this.mm=this.a.pz();this.qp=this.a.pz();for(c=this.a.Pb(this.Y);-1!=c;c=this.a.Sb(c))this.a.Zr(c,this.mm,0),this.a.Zr(c,this.qp,-1);c=new a.ha(0);this.Xh=NaN;var d=new a.b;this.Zt=
this.a.aa(this.Y);this.lp=this.a.Sd();this.Ot=this.a.Sd();for(var e=this.om.wc(this.om.De);-1!=e;e=this.om.nb(e)){var f=this.om.getData(e);this.a.Mc(f,d);d.y!=this.Xh&&0!=c.size&&(b=this.lu(c)||b,this.te.reset(),c.clear(!1));c.add(f);this.Xh=d.y;if(0==this.Zt)break}0<this.Zt&&(b=this.lu(c)||b,c.clear(!1));this.a.je(this.lp);this.a.je(this.Ot);for(c=this.a.Pb(this.Y);-1!=c;)if(3==this.a.Xj(c,this.mm)){this.a.rC(c,!0);d=c;for(c=this.a.Xj(c,this.qp);-1!=c;)e=this.a.Xj(c,this.qp),this.a.BV(this.Y,this.a.Sb(d),
c),d=c,c=e;c=this.a.Sb(d)}else this.a.rC(c,!1),c=this.a.Sb(c);this.a.eC(this.mm);this.a.eC(this.qp);return b};d.prototype.lu=function(a){return this.vW(a)};d.prototype.vW=function(c){var d=!1;null==this.ib&&(this.ib=new b(this.a));null==this.Qn?(this.Qn=new a.ha(0),this.Qn.zb(16)):this.Qn.clear(!1);this.uW(c);for(var e=0,f=c.size;e<f;e++){var g=c.get(e);-1!=g&&this.qH(g,-1)}for(e=0;e<this.Qn.size&&0<this.Zt;e++)if(c=this.Qn.get(e),g=this.ib.fA(this.hb.ia(c)),f=-1,0==this.a.Xj(g,this.mm)){for(var g=
this.hb.Se(c),h=c,k;-1!=g;){var n=this.hb.ia(g),p=this.ib.fA(n),l=this.a.Xj(p,this.mm);if(0!=l){f=p;break}h=g;g=this.hb.Se(g)}-1==g?(k=!0,g=h):(n=this.hb.ia(g),k=this.ib.ow(n),g=this.hb.nb(g),k=!k);do{n=this.hb.ia(g);p=this.ib.fA(n);l=this.a.Xj(p,this.mm);if(0==l&&(k!=this.ib.ow(n)&&(d=this.a.cb(p),this.a.UJ(d),this.a.rh(p,this.a.Ra(d)),d=!0),this.a.Zr(p,this.mm,k?3:2),k||(h=this.a.Xj(f,this.qp),this.a.Zr(f,this.qp,p),this.a.Zr(p,this.qp,h)),this.Zt--,0==this.Zt))return d;f=p;h=g;g=this.hb.nb(g);
k=!k}while(h!=c)}return d};d.prototype.uW=function(a){for(var b=0,c=a.size;b<c;b++){var d=a.get(b),e=this.a.Sa(d,this.lp),f=this.a.Sa(d,this.Ot);if(-1!=e){var g=this.hb.ia(e);this.ib.vG(g);this.a.Va(d,this.lp,-1)}-1!=f&&(g=this.hb.ia(f),this.ib.vG(g),this.a.Va(d,this.Ot,-1));g=-1;-1!=e&&-1!=f?(this.hb.Jd(e,-1),this.hb.Jd(f,-1),a.set(b,-1)):g=-1!=e?e:f;-1!=g&&(this.qH(d,g)||this.hb.Jd(g,-1),a.set(b,-1))}};d.prototype.qH=function(b,c){var d=new a.b,e=new a.b;this.a.Mc(b,d);var f=this.a.U(b);this.a.Mc(f,
e);var g=!1;if(d.y<e.y){var g=!0,h=this.ib.kJ(b),k;-1==c?k=this.hb.addElement(h,-1):(k=c,this.hb.pk(k,h));h=this.a.Sa(f,this.lp);-1==h?this.a.Va(f,this.lp,k):this.a.Va(f,this.Ot,k);f=this.a.kd(b);0==this.a.Xj(f,this.mm)&&this.Qn.add(k)}f=this.a.Ra(b);this.a.Mc(f,e);d.y<e.y&&(g=!0,h=this.ib.kJ(f),-1==c?k=this.hb.addElement(h,-1):(k=c,this.hb.pk(k,h)),h=this.a.Sa(f,this.lp),-1==h?this.a.Va(f,this.lp,k):this.a.Va(f,this.Ot,k),f=this.a.kd(b),0==this.a.Xj(f,this.mm)&&this.Qn.add(k));return g};d.V=function(a,
b,c,e){var f=new d;f.a=a;f.Y=b;f.om=c;f.Vw=e;return f.WR()};d.prototype.XR=function(){var b=new a.ha(0),c=new a.ha(0),d=-1,e=-1,f=new a.b;f.Yc();for(var g=-1,h=-1,k=-1,n=new a.b,l=this.om.wc(this.om.De);-1!=l;l=this.om.nb(l)){var m=this.om.getData(l);this.a.Mc(m,n);var q=this.a.kd(m);f.vb(n)&&h==q?(-1==e&&(d=this.a.pz(),e=this.a.Sd()),-1==k&&(k=c.size,this.a.Va(g,e,k),c.add(1),-1==this.a.Xj(q,d)&&(this.a.Zr(q,d,g),b.add(q))),this.a.Va(m,e,k),c.qK(c.Ec()+1)):(k=-1,f.L(n));g=m;h=q}if(0==b.size)return!1;
f=new a.ha(0);g=new a.ha(0);h=0;for(k=b.size;h<k;h++){var q=b.get(h),r=this.a.Xj(q,d),m=this.a.Sa(r,e);f.clear(!1);g.clear(!1);f.add(r);g.add(m);for(m=this.a.U(r);m!=r;m=this.a.U(m)){var t=m,n=this.a.Sa(t,e);if(-1!=n)if(0==g.size)g.add(n),f.add(t);else if(g.Ec()==n){var l=f.Ec(),u=this.a.U(l),r=this.a.U(t);this.a.Jc(l,r);this.a.Kc(r,l);this.a.Jc(t,u);this.a.Kc(u,t);t=[!1];u=this.a.pH(this.Y,u,this.a.cb(q),t);this.a.Va(m,e,-1);t[0]&&this.a.ig(q,r);m=this.a.La(q);r=this.a.La(u);m-=r;this.a.sk(q,m);
c.set(n,c.get(n)-1);1==c.get(n)&&(c.set(n,0),g.Mf(),f.Mf());m=r=l}else f.add(m),g.add(n)}}this.a.eC(d);this.a.je(e);return!0};return d}();a.sN=d})(C||(C={}));(function(a){var b=function(){function b(){}b.prototype.Bg=function(){this.xB=this.xb=null};b.prototype.get=function(){return this.xB};b.prototype.set=function(b){this.xB=b;if(null!=b)throw 322==b.G()&&(this.xb=b),a.g.za();};b.prototype.create=function(b){if(322==b)this.Hs();else throw a.g.X("Not Implemented");};b.prototype.Hs=function(){null==
this.xb&&(this.xb=new a.Hb);this.xB=this.xb};return b}();a.Bg=b})(C||(C={}));(function(a){a=a.wN||(a.wN={});a[a.enumLineSeg=1]="enumLineSeg";a[a.enumBezierSeg=2]="enumBezierSeg";a[a.enumArcSeg=4]="enumArcSeg";a[a.enumNonlinearSegmentMask=6]="enumNonlinearSegmentMask";a[a.enumSegmentMask=7]="enumSegmentMask";a[a.enumDensified=8]="enumDensified"})(C||(C={}));(function(a){var b=function(){return function(a){this.Aj=a;this.VC=this.WC=1;this.WB=this.VB=this.XB=0}}(),c=function(){function c(){this.vr=[0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.fl=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.ag=new a.Wa;this.ta=this.sx=0;this.gp=[];this.Wt=[];this.mx=[];this.yr=[];this.uB=[]}c.prototype.ZB=function(a){if(null!=a){for(var b=0,c=a.length;b<c;b++)this.VW(a[b]);a.length=0}};c.prototype.VW=function(a){a.Aj=null;this.yr.push(a)};c.prototype.Ax=function(a){if(0===this.yr.length)var c=new b(a);else c=this.yr[this.yr.length-1],c.Aj=a,--this.yr.length;return c};c.prototype.lT=function(a,b){return 0==a?this.Wt[b]:this.mx[b]};
c.prototype.JB=function(){this.sx>=this.uB.length&&this.uB.push(new a.Bg);var b=this.uB[this.sx];this.sx++;return b};c.prototype.clear=function(){this.ZB(this.gp);this.ZB(this.Wt);this.ZB(this.mx);this.sx=0};c.prototype.Hp=function(a){this.gp.push(this.Ax(a))};c.prototype.Wl=function(a){return 0==a?this.Wt.length:this.mx.length};c.prototype.Mq=function(a,b){return this.lT(a,b).Aj};c.prototype.Ma=function(b,c){if(2!=this.gp.length)throw a.g.za();this.ta=b;var d=a.Ub.Yx(.01*b),e=!1,f=this.gp[0],g=this.gp[1];
if(c||0!=(f.Aj.ws(g.Aj,b,!0)&5)){if(322==f.Aj.G()&&(c=f.Aj,322==g.Aj.G())){var h=g.Aj,k=a.Hb.Cy(c,h,null,this.vr,this.fl,b);if(0==k)throw a.Hb.Cy(c,h,null,this.vr,this.fl,b),a.g.za();b=Array(9);a.J.Ov(b,null);for(var n=0;n<k;n++){var p=this.vr[n],l=this.fl[n],m=f.WB,q=1;0==p?(m=f.XB,q=f.WC):1==p&&(m=f.VB,q=f.VC);var r=g.WB,t=1;0==l?(r=g.XB,t=g.WC):1==l&&(r=g.VB,t=g.VC);var u=new a.b;m==r?(m=new a.b,c.hc(p,m),p=new a.b,h.hc(l,p),l=q+t,t/=l,a.Ub.QH(m,p,t,u),a.b.sc(u,m)+a.b.sc(u,p)>d&&(e=!0)):m>r?(c.hc(p,
u),p=new a.b,h.hc(l,p),a.b.sc(u,p)>d&&(e=!0)):(h.hc(l,u),m=new a.b,c.hc(p,m),a.b.sc(u,m)>d&&(e=!0));b[n]=u}f=0;g=-1;for(n=0;n<=k;n++)t=n<k?this.vr[n]:1,t!=f&&(d=this.JB(),c.yh(f,t,d),-1!=g&&d.get().Lc(b[g]),n!=k&&d.get().Xc(b[n]),f=t,this.Wt.push(this.Ax(d.get()))),g=n;c=[0,0,0,0,0,0,0,0,0];for(n=0;n<k;n++)c[n]=n;1<k&&this.fl[0]>this.fl[1]&&(t=this.fl[0],this.fl[0]=this.fl[1],this.fl[1]=t,n=c[0],c[0]=c[1],c[1]=n);f=0;g=-1;for(n=0;n<=k;n++)t=n<k?this.fl[n]:1,t!=f&&(d=this.JB(),h.yh(f,t,d),-1!=g&&(f=
c[g],d.get().Lc(b[f])),n!=k&&(f=c[n],d.get().Xc(b[f])),f=t,this.mx.push(this.Ax(d.get()))),g=n;return e}throw a.g.za();}return!1};c.prototype.vA=function(b,c,d){c.copyTo(this.ag);if(1!=this.gp.length)throw a.g.za();this.ta=b;var e=this.gp[0];if(d||e.Aj.fv(c.w(),b,!0))if(322==e.Aj.G()){b=e.Aj;var f=b.ne(c.w(),!1);this.vr[0]=f;var g=e.WB;d=1;0==f?(g=e.XB,d=e.WC):1==f&&(g=e.VB,d=e.VC);e=new a.b;0==g?(g=new a.b,b.hc(f,g),c=c.w(),a.Ub.QH(g,c,1/(d+1),e)):0<g?(e=new a.b,b.hc(f,e)):e=c.w();d=0;f=-1;for(g=
0;1>=g;g++){c=1>g?this.vr[g]:1;if(c!=d){var h=this.JB();b.yh(d,c,h);-1!=f&&h.get().Lc(e);1!=g&&h.get().Xc(e);d=c;this.Wt.push(this.Ax(h.get()))}f=g}this.ag.rb(e)}else throw a.g.za();};return c}();a.jE=c})(C||(C={}));(function(a){var b=function(){function b(b){this.Bt=this.Vk=this.xb=null;this.lm=this.sf=this.bd=this.We=this.Ph=this.Ta=0;this.bb=null;this.Xl=this.sn=!1;this.We=-1;this.Ph=this.bd=0;this.Ta=-1;this.bb=b;this.sf=this.us(this.Ph);this.sn=!1;this.Vk=null;this.lm=-1;this.Xl=!1;this.Bt=new a.b}
b.Nm=function(c,d){if(0>d||d>=c.D())throw a.g.vd();var e=new b(c),f=c.cw(d);e.bd=d-c.wa(f);e.Ph=f+1;e.Ta=f;e.sf=e.us(e.Ta);e.lm=e.bb.wa(e.Ta);e.Xl=e.bb.Qb(e.Ta);return e};b.Mm=function(c,d,e){if(0>d||d>=c.aa()||0>e)throw a.g.vd();var f=c.Qb(d)?0:1;if(e>=c.La(d)-f)throw a.g.vd();c=new b(c);c.We=-1;c.bd=e;c.Ta=d;c.Ph=c.bd+1;c.sf=c.us(c.Ph);c.lm=c.bb.wa(c.Ta);c.Xl=c.bb.Qb(c.Ta);return c};b.prototype.cX=function(b){if(this.bb!=b.bb)throw a.g.Da();this.We=b.We;this.bd=b.bd;this.Ta=b.Ta;this.Ph=b.Ph;this.sf=
b.sf;this.sn=b.sn;this.lm=b.lm;this.Vk=null;this.Xl=b.Xl};b.prototype.ba=function(){this.We!=this.bd&&this.TE();if(this.sn)this.bd=(this.bd+1)%this.sf;else{if(this.bd==this.sf)throw a.g.vd();this.bd++}return this.Vk};b.prototype.Mi=function(){if(this.sn)this.bd=(this.sf+this.bd-1)%this.sf;else{if(0==this.bd)throw a.g.vd();this.bd--}this.bd!=this.We&&this.TE();return this.Vk};b.prototype.dX=function(){this.We=-1;this.bd=0};b.prototype.eX=function(){this.bd=this.sf;this.We=-1};b.prototype.Tb=function(a,
b){void 0===b&&(b=-1);if(0<=this.Ta&&this.Ta<this.bb.aa()){var c=this.jO();if(a>=c&&a<this.bb.Fc(this.Ta)){this.We=-1;this.bd=a-c;return}}c=0<=b&&b<this.bb.aa()&&a>=this.bb.wa(b)&&a<this.bb.Fc(b)?b:this.bb.cw(a);this.Ph=c+1;this.Ta=c;this.We=-1;this.bd=a-this.bb.wa(c);this.sf=this.us(c);this.lm=this.bb.wa(this.Ta);this.Xl=this.bb.Qb(this.Ta)};b.prototype.Ya=function(){this.Ta=this.Ph;if(this.Ta>=this.bb.aa())return!1;this.We=-1;this.bd=0;this.sf=this.us(this.Ta);this.lm=this.bb.wa(this.Ta);this.Xl=
this.bb.Qb(this.Ta);this.Ph++;return!0};b.prototype.zj=function(){this.sf=this.bd=this.We=-1;this.Ph=0;this.Ta=-1;this.Xl=!1;this.lm=-1};b.prototype.hC=function(b){if(0>b)throw a.g.vd();this.Ph=b;this.lm=this.sf=this.bd=this.We=this.Ta=-1;this.Xl=!1};b.prototype.us=function(a){if(this.bb.Gc())return 0;var b=1;this.bb.Qb(a)&&(b=0);return this.bb.La(a)-b};b.prototype.Lo=function(){return this.We==this.sf-1&&this.bb.Qb(this.Ta)};b.prototype.mC=function(){this.sn=!0};b.prototype.Db=function(){return this.bb.kb.f[this.Ta]+
this.We};b.prototype.jO=function(){return this.bb.wa(this.Ta)};b.prototype.Lk=function(){return this.Lo()?this.bb.wa(this.Ta):this.Db()+1};b.prototype.pn=function(){return 0==this.We};b.prototype.Oo=function(){return this.We==this.sf-1};b.prototype.Ea=function(){return this.bd<this.sf};b.prototype.rA=function(){return 0<this.bd};b.prototype.Sf=function(){var a=new b(this.bb);a.We=this.We;a.bd=this.bd;a.sf=this.sf;a.Ta=this.Ta;a.Ph=this.Ph;a.bb=this.bb;a.sn=this.sn;return a};b.prototype.TE=function(){if(0>
this.bd||this.bd>=this.sf)throw a.g.vd();this.We=this.bd;var b=this.Db();this.bb.vc();var c=this.bb.$e,d=1;null!=c&&(d=c.read(b)&7);c=this.bb.description;switch(d){case 1:null==this.xb&&(this.xb=new a.Hb);this.Vk=this.xb;break;case 2:throw a.g.X("internal error");case 4:throw a.g.za();default:throw a.g.za();}this.Vk.Eg(c);d=this.Lk();this.bb.Mc(b,this.Bt);this.Vk.Lc(this.Bt);this.bb.Mc(d,this.Bt);this.Vk.Xc(this.Bt);for(var e=1,f=c.Ga;e<f;e++)for(var g=c.pd(e),k=a.ma.Xa(g),l=0;l<k;l++){var m=this.bb.Wc(g,
b,l);this.Vk.Tx(g,l,m);m=this.bb.Wc(g,d,l);this.Vk.Lx(g,l,m)}};b.prototype.vU=function(){return this.Ta==this.bb.aa()-1};b.prototype.Mo=function(){var a=this.bb.oT();return null!=a?1!=(a.read(this.We)&7):!1};return b}();a.xN=b})(C||(C={}));(function(a){var b=function(){function b(b){b instanceof a.T?(this.wI=b,this.Ca=-1,this.ej=1):(this.ZU=b.slice(0),this.Ca=-1,this.ej=b.length)}b.prototype.Ia=function(){return this.Ca};b.prototype.next=function(){return this.Ca<this.ej-1?(this.Ca++,null!=this.wI?
this.wI:this.ZU[this.Ca]):null};b.prototype.Oe=function(){return!0};return b}();a.gd=b})(C||(C={}));(function(a){var b=function(){return function(){this.next=null}}(),c=function(){function c(){this.Lr=this.wx=this.xx=this.Sk=this.bi=0;this.rG=!1;this.LK=0;this.co=this.jg=this.Jm=this.ii=null;this.ym=0;this.Zy=null;this.Sk=this.bi=-1}c.prototype.$X=function(b,c,d){this.bi=b;this.Sk=c;this.ii=this.Jm=null;this.Lr=0;this.Zy=d;null==this.co&&(this.co=a.J.df(384,0));this.OK()};c.prototype.O=function(){return this.bi};
c.prototype.ea=function(){return this.Sk};c.prototype.flush=function(){0<this.ym&&(this.Zy.nG(this.co,this.ym),this.ym=0)};c.prototype.OK=function(){if(0<this.Lr){for(var a=0;a<this.Sk;a++){for(var b=this.Jm[a];null!=b;){var c=b,b=b.next;c.next=null}this.Jm[a]=null}this.ii=null}this.xx=this.Sk;this.wx=-1;this.Lr=0};c.prototype.MJ=function(a){this.rG=a==c.ly;for(a=this.xx;a<=this.wx;a++)this.QO(),this.HO(a),this.vR();this.OK()};c.prototype.Ny=function(c,d,e,f){if(d!=f){var g=1;d>f&&(g=c,c=e,e=g,g=
d,d=f,f=g,g=-1);if(!(0>f||d>=this.Sk)){0>c&&0>e?e=c=-1:c>=this.bi&&e>=this.bi&&(e=c=this.bi);var h=(e-c)/(f-d);f>this.Sk&&(f=this.Sk,e=h*(f-d)+c);0>d&&(c=h*(0-d)+c,d=0);var k=Math.max(this.bi+1,8388607);-8388607>c?(d=(0-c)/h+d,c=0):c>k&&(d=(this.bi-c)/h+d,c=this.bi);-8388607>e?f=(0-c)/h+d:e>k&&(f=(this.bi-c)/h+d);d=a.J.truncate(d);f=a.J.truncate(f);d!=f&&(e=new b,e.x=a.J.truncate(4294967296*c),e.y=d,e.B=f,e.oR=a.J.truncate(4294967296*h),e.dir=g,null==this.Jm&&(this.Jm=a.J.df(this.Sk,null)),e.next=
this.Jm[e.y],this.Jm[e.y]=e,e.y<this.xx&&(this.xx=e.y),e.B>this.wx&&(this.wx=e.B),this.Lr++)}}};c.prototype.QO=function(){if(null!=this.ii){for(var a=!1,b=null,c=this.ii;null!=c;)if(c.y++,c.y==c.B){var d=c,c=c.next;null!=b?b.next=c:this.ii=c;d.next=null}else c.x+=c.oR,null!=b&&b.x>c.x&&(a=!0),b=c,c=c.next;a&&(this.ii=this.KK(this.ii))}};c.prototype.HO=function(a){if(!(a>=this.Sk)){var b=this.Jm[a];if(null!=b){this.Jm[a]=null;b=this.KK(b);this.Lr-=this.LK;a=this.ii;for(var c=!0,d=b,e=null;null!=a&&
null!=d;)a.x>d.x?(c&&(this.ii=d),c=d.next,d.next=a,null!=e&&(e.next=d),e=d,d=c):(c=a.next,a.next=d,null!=e&&(e.next=a),e=a,a=c),c=!1;null==this.ii&&(this.ii=b)}}};c.tE=function(a,b){return 0>a?0:a>b?b:a};c.prototype.vR=function(){if(null!=this.ii)for(var b=0,d=this.ii,e=a.J.truncate(a.J.UH(d.x)),f=d.next;null!=f;f=f.next)if(b=this.rG?b^1:b+f.dir,f.x>d.x){var g=a.J.truncate(a.J.UH(f.x));0!=b&&(d=c.tE(e,this.bi),e=c.tE(g,this.bi),e>d&&d<this.bi&&(this.co[this.ym++]=d,this.co[this.ym++]=e,this.co[this.ym++]=
f.y,this.ym==this.co.length&&(this.Zy.nG(this.co,this.ym),this.ym=0)));d=f;e=g}};c.prototype.KK=function(b){for(var d=0,e=b;null!=e;e=e.next)d++;this.LK=d;if(1==d)return b;null==this.jg?this.jg=a.J.df(Math.max(d,16),null):this.jg.length<d&&(this.jg=a.J.df(Math.max(d,2*this.jg.length),null));for(var f=0,e=b;null!=e;e=e.next)this.jg[f++]=e;2==d?this.jg[0].x>this.jg[1].x&&(b=this.jg[0],this.jg[0]=this.jg[1],this.jg[1]=b):c.GW(this.jg,d,function(a,b){return a==b?0:a.x<b.x?-1:a.x>b.x?1:0});b=this.jg[0];
this.jg[0]=null;e=b;for(f=1;f<d;f++)e.next=this.jg[f],e=this.jg[f],this.jg[f]=null;e.next=null;return b};c.GW=function(a,b,c){if(b==a.length)a.sort(c);else{var d=a.slice(0,0),e=a.slice(b);b=a.slice(0,b).sort(c);a.length=0;a.push.apply(a,d.concat(b).concat(e))}};c.ly=0;c.vZ=1;return c}();a.vy=c})(C||(C={}));(function(a){var b=function(){function b(){}b.prototype.Si=function(a,b){var c=this.a.Sa(a,this.Fr);this.km==c&&(this.km=this.Je.nb(this.km));this.ap==c&&(this.ap=this.Je.nb(this.ap));this.Je.jd(this.zB,
c);this.Bk(a);if(b&&(c=this.a.kd(a),-1!=c&&this.a.cb(c)==a)){b=this.a.U(a);if(b!=a){var d=this.a.kd(b);if(d==c){this.a.ig(c,b);return}b=this.a.Ra(a);if(b!=a&&(d=this.a.kd(b),d==c)){this.a.ig(c,b);return}}this.a.ig(c,-1);this.a.rh(c,-1)}};b.prototype.JE=function(){for(var b=!1,c=0,d=new a.b;;){c++;null==this.wi?(this.wi=new a.ha(0),this.xt=new a.ha(0),this.Ue=new a.ha(0)):(this.wi.clear(!1),this.xt.clear(!1),this.Ue.clear(!1));for(var e=this.ap,f=0,g=!0;e!=this.km;){var k=this.Je.getData(e),l=new a.b;
this.a.Mc(k,l);g&&(this.a.Mc(k,d),g=!1);var l=this.a.Ra(k),m=this.a.U(k);-559038737!=this.a.Sa(l,this.Sg)&&(this.wi.add(l),this.a.Va(l,this.Sg,-559038737),this.xt.add(k),this.Ue.add(f++));-559038737!=this.a.Sa(m,this.Sg)&&(this.wi.add(m),this.a.Va(m,this.Sg,-559038737),this.xt.add(k),this.Ue.add(f++));e=this.Je.nb(e)}if(2>this.wi.size)break;var q=this;this.Ue.Fd(0,this.Ue.size,function(a,b){return q.bO(a,b)});e=0;for(f=this.Ue.size;e<f;e++)g=this.Ue.get(e),g=this.wi.get(g),this.a.Va(g,this.Sg,e),
l=new a.b,this.a.Mc(g,l);l=this.oO(d);e=0;for(f=this.Ue.size;e<f;e++)g=this.Ue.get(e),-1!=g&&(g=this.wi.get(g),this.a.Va(g,this.Sg,-1));if(l)b=!0;else break}return b};b.prototype.oO=function(a){for(var b=!1,c=!0;c;){var c=!1,d=0;-1==this.Ue.get(d)&&(d=this.Vm(d));for(var e=this.Vm(d),f=0,g=this.Ue.size;f<g&&-1!=d&&-1!=e&&d!=e;f++){var k=this.Ue.get(d),e=this.Ue.get(e),k=this.wi.get(k),e=this.wi.get(e),n=this.a.U(k);this.a.qw(n,a)||(n=this.a.Ra(k));var l=this.a.U(e);this.a.qw(l,a)||(l=this.a.Ra(e));
var m=this.dv(n,k),q=this.dv(l,e),r=m?this.a.Ra(n):this.a.U(n),t=q?this.a.Ra(l):this.a.U(l),u=!1;this.mq(n)?u=!0:this.mq(l)?u=!0:this.mq(k)?u=!0:this.mq(e)?u=!0:this.mq(r)?u=!0:this.mq(t)&&(u=!0);!u&&this.a.Uq(k,e)&&(u=!0,this.ME(m,q,n,k,l,e));!u&&this.a.Uq(r,t)&&(u=!0,this.ME(!m,!q,n,r,l,t));u&&(b=!0);c=c||u;d=this.Vm(d);e=this.Vm(d)}}if(!b)for(d=0,-1==this.Ue.get(d)&&(d=this.Vm(d)),e=this.Vm(d),f=0,g=this.Ue.size;f<g&&-1!=d&&-1!=e&&d!=e;f++)k=this.Ue.get(d),e=this.Ue.get(e),k=this.wi.get(k),e=this.wi.get(e),
n=this.a.U(k),this.a.qw(n,a)||(n=this.a.Ra(k)),l=this.a.U(e),this.a.qw(l,a)||(l=this.a.Ra(e)),m=this.dv(n,k),q=this.dv(l,e),r=m?this.a.Ra(n):this.a.U(n),t=q?this.a.Ra(l):this.a.U(l),this.fO(m,q,k,n,r,e,l,t)&&(b=!0),d=this.Vm(d),e=this.Vm(d);return b};b.prototype.rO=function(){1736==this.a.ic(this.Y)&&1==this.a.Eo(this.Y)&&(new a.Cg).cW(this.Vw,this.a,this.Y,this.ie);var b=!1,c=!0;this.Sg=this.Fr=-1;var d=this.a.D(this.Y),e=new a.ha(0);e.zb(d);for(var f=this.a.Pb(this.Y);-1!=f;f=this.a.Sb(f))for(var g=
this.a.cb(f),k=0,l=this.a.La(f);k<l;k++)e.add(g),g=this.a.U(g);var m=this.a.Cd.f,q=this.a.Cd.dd;this.a.yb.vc();var r=this.a.yb.ya[0].f;e.Fd(0,d,function(a,b){var c=m[q*a],d=m[q*b],e=r[2*c],c=r[2*c+1],f=r[2*d],d=r[2*d+1],e=c<d?-1:c>d?1:e<f?-1:e>f?1:0;0==e&&(e=m[q*a+3],d=m[q*b+3],e=e<d?-1:e==d?0:1);return e});this.Fr=this.a.Sd();this.Je=new a.cq;this.zB=this.Je.ni(0);this.Je.ao(d);for(f=0;f<d;f++)g=e.get(f),k=this.Je.addElement(this.zB,g),this.a.Va(g,this.Fr,k);this.Sg=this.a.Sd();this.km=-1;for(this.AE()&&
(b=!0);c;){c=!1;d=0;e=!1;do{e=!1;this.ap=-1;for(var l=0,f=new a.b,k=new a.b,t=this.Je.wc(this.zB);-1!=t;)g=this.Je.getData(t),-1!=this.ap?(this.a.Mc(g,k),f.vb(k))?l++:(f.L(k),this.km=t,0<l&&(g=this.JE())&&(e=!0,-1!=this.km&&(g=this.Je.getData(this.km),this.a.Mc(g,f))),this.ap=t=this.km,l=0):(this.ap=t,this.a.Mc(this.Je.getData(t),f),l=0),-1!=t&&(t=this.Je.nb(t));this.km=-1;0<l&&(g=this.JE())&&(e=!0);if(10<d++)throw a.g.za();e&&this.iO();this.AE()&&(e=!0);c=c||e&&!1;b=b||e}while(e)}this.a.je(this.Fr);
this.a.je(this.Sg);return b=a.sN.V(this.a,this.Y,this.Je,this.Vw)||b};b.prototype.dv=function(a,b){return this.a.U(b)==a?!1:!0};b.prototype.fO=function(a,b,c,d,e,f,g,k){if(d==g)return this.Bk(c),this.Bk(f),!1;var h=this.a.Sa(c,this.Sg),n=this.a.Sa(e,this.Sg),p=this.a.Sa(f,this.Sg),l=this.a.Sa(k,this.Sg);c=[0,0,0,0,0,0,0,0];var m=[0,0,0,0];c[0]=0;m[0]=h;c[1]=0;m[1]=n;c[2]=1;m[2]=p;c[3]=1;m[3]=l;for(h=1;4>h;h++){n=m[h];p=c[h];for(l=h-1;0<=l&&m[l]>n;)m[l+1]=m[l],c[l+1]=c[l],l--;m[l+1]=n;c[l+1]=p}m=0;
0!=c[0]&&(m|=1);0!=c[1]&&(m|=2);0!=c[2]&&(m|=4);0!=c[3]&&(m|=8);if(5!=m&&10!=m)return!1;a==b?a?(this.a.Jc(k,d),this.a.Kc(d,k),this.a.Jc(e,g),this.a.Kc(g,e)):(this.a.Kc(k,d),this.a.Jc(d,k),this.a.Kc(e,g),this.a.Jc(g,e)):a?(this.a.Kc(d,f),this.a.Jc(f,d),this.a.Kc(g,e),this.a.Jc(e,g)):(this.a.Jc(d,f),this.a.Kc(f,d),this.a.Jc(g,e),this.a.Kc(e,g));return!0};b.prototype.ME=function(a,b,c,d,e,f){this.h_?this.qO():this.pO(a,b,c,d,e,f)};b.prototype.qO=function(){throw a.g.X("not implemented.");};b.prototype.pO=
function(a,b,c,d,e,f){if(a!=b)a?(this.a.Jc(c,e),this.a.Kc(e,c),this.a.Jc(f,d),this.a.Kc(d,f),this.wo(e,c),this.Si(e,!0),this.a.Ni(e,!0),this.Bk(c),this.wo(f,d),this.Si(f,!0),this.a.Ni(f,!1)):(this.a.Jc(e,c),this.a.Kc(c,e),this.a.Jc(d,f),this.a.Kc(f,d),this.wo(e,c),this.Si(e,!0),this.a.Ni(e,!1),this.Bk(c),this.wo(f,d),this.Si(f,!0),this.a.Ni(f,!0)),this.Bk(d);else{var g=a?c:d,h=b?e:f;a=a?d:c;b=b?f:e;e=!1;this.a.Jc(g,h);this.a.Jc(h,g);this.a.Kc(a,b);this.a.Kc(b,a);for(f=b;f!=h;)c=this.a.Ra(f),d=this.a.U(f),
this.a.Kc(f,d),this.a.Jc(f,c),e=e||f==g,f=d;e||(c=this.a.Ra(h),d=this.a.U(h),this.a.Kc(h,d),this.a.Jc(h,c));this.wo(h,g);this.Si(h,!0);this.a.Ni(h,!1);this.Bk(g);this.wo(b,a);this.Si(b,!0);this.a.Ni(b,!1);this.Bk(a)}};b.prototype.AE=function(){for(var a=!1,b=this.a.Pb(this.Y);-1!=b;){for(var c=this.a.cb(b),d=0,e=this.a.La(b);d<e&&1<e;){var f=this.a.Ra(c),g=this.a.U(c);this.a.Uq(f,g)?(a=!0,this.Si(c,!1),this.a.td(c,!0),this.Si(g,!1),this.a.td(g,!0),c=f,d=0,e=this.a.La(b)):(c=g,d++)}if(2>this.a.La(b)){a=
this.a.cb(b);d=0;for(e=this.a.La(b);d<e;d++)this.Si(a,!1),a=this.a.U(a);b=this.a.Qr(b);a=!0}else b=this.a.Sb(b)}return a};b.prototype.mq=function(a){for(var b=!1;;){var c=this.a.U(a),d=this.a.Ra(a);if(c==a)return this.Si(a,!0),this.a.Ni(a,!1),!0;if(!this.a.Uq(c,d))break;b=!0;this.Bk(d);this.Bk(c);this.Si(a,!0);this.a.Ni(a,!1);this.wo(c,d);this.Si(c,!0);this.a.Ni(c,!0);if(c==d)break;a=d}return b};b.prototype.iO=function(){for(var a=0,b=this.Je.wc(this.Je.De);-1!=b;b=this.Je.nb(b)){var c=this.Je.getData(b);
this.a.Bj(c,-1)}for(var d=0,e=this.a.Pb(this.Y);-1!=e;)if(b=this.a.cb(e),-1==b||-1!=this.a.kd(b))c=e,e=this.a.Sb(e),this.a.Rr(c);else{this.a.Bj(b,e);for(var f=1,c=this.a.U(b);c!=b;c=this.a.U(c))this.a.Bj(c,e),f++;this.a.Up(e,!1);this.a.sk(e,f);this.a.rh(e,this.a.Ra(b));d+=f;a++;e=this.a.Sb(e)}for(b=this.Je.wc(this.Je.De);-1!=b;b=this.Je.nb(b))c=this.Je.getData(b),-1==this.a.kd(c)&&(e=this.a.pH(this.Y,c,c,null),d+=this.a.La(e),a++);this.a.Bm(this.Y,a);this.a.qk(this.Y,d);a=0;for(d=this.a.qd;-1!=d;d=
this.a.Re(d))a+=this.a.D(d);this.a.CC(a)};b.prototype.Vm=function(a){for(var b=0,c=this.Ue.size-1;b<c;b++)if(a=(a+1)%this.Ue.size,-1!=this.Ue.get(a))return a;return-1};b.prototype.wo=function(a,b){var c=this.a.Sa(b,this.Fr),d=this.a.Sa(b,this.Sg);this.a.MC(a,b);this.a.Va(b,this.Fr,c);this.a.Va(b,this.Sg,d)};b.prototype.Bk=function(a){var b=this.a.Sa(a,this.Sg);-1!=b&&(this.Ue.set(b,-1),this.a.Va(a,this.Sg,-1))};b.V=function(a,c,d,e,f){var g=new b;g.a=a;g.Y=c;g.gB=d;g.Vw=e;g.ie=f;return g.rO()};b.prototype.bO=
function(b,c){var d=this.wi.get(b),e=new a.b;this.a.Mc(d,e);var d=new a.b,f=this.wi.get(c);this.a.Mc(f,d);if(e.vb(d))return 0;b=this.xt.get(b);f=new a.b;this.a.Mc(b,f);c=this.xt.get(c);b=new a.b;this.a.Mc(c,b);c=new a.b;c.xc(e,f);e=new a.b;e.xc(d,b);return a.b.ts(c,e)};return b}();a.so=b})(C||(C={}));(function(a){(function(a){a[a.Local=0]="Local";a[a.Geographic=1]="Geographic";a[a.Projected=2]="Projected";a[a.Image=3]="Image";a[a.Unknown=4]="Unknown"})(a.yN||(a.yN={}));(function(a){a[a.Integer32=
0]="Integer32";a[a.Integer64=1]="Integer64";a[a.FloatingPoint=2]="FloatingPoint"})(a.lN||(a.lN={}));var b=function(){function b(){this.jq="";this.gv=null;this.xg=0;this.$I=this.Ap=-1;this.Vh=null}b.prototype.Bc=function(){return this.xg};b.prototype.Ps=function(){return 0};b.prototype.Qs=function(){return 0};b.prototype.Rs=function(){return 0};b.prototype.Os=function(){return 0};b.prototype.Wz=function(){return 5.7295779513082306E10};b.prototype.Xz=function(){return 1E3};b.prototype.Vz=function(){return 1E3};
b.prototype.$s=function(){return 1};b.prototype.pe=function(){var b=.001;0!=this.xg?b=a.ss.SR(this.xg):null!=this.Vh&&(b=a.uE.TR(this.Vh));return b};b.prototype.dH=function(){return this.Vh};b.prototype.Td=function(){if(0!=this.xg)return a.$c.vh(a.ss.Dz(this.xg));if(null!=this.Vh)return a.uE.UR(this.Vh)};b.Fb=function(b){if(0!=b.xg){if(!0===a.ss.uU(b.xg))return 1;if(!0===a.ss.wU(b.xg))return 2}return 4};b.prototype.Ys=function(){var b=this.Bc();if(-1!=this.Ap)return this.Ap;this.Ap=a.ss.nL(b);return-1!=
this.Ap?this.Ap:b};b.create=function(c){if(0>=c)throw a.g.F("Invalid or unsupported wkid: "+c);var d=new b;d.xg=c;return d};b.MQ=function(c){if(null==c||0==c.length)throw a.g.F("Cannot create SpatialReference from null or empty text.");var d=new b;d.Vh=c;return d};b.prototype.Eb=function(a){return this==a?!0:null==a||this.constructor!=a.constructor||this.xg!=a.xg||0==this.xg&&this.Vh!==a.Vh?!1:!0};b.pS=function(b,c){var d=Math.PI/180,e=new a.da;a.$L.sS(b.w().x*d,b.w().y*d,c.w().x*d,c.w().y*d,e);return e.j};
b.prototype.toString=function(){return"[ tol: "+this.Ho()+"; wkid: "+this.Bc()+"; wkt: "+this.dH()+"]"};b.prototype.kc=function(){if(""!==this.jq)return this.jq;var a=this.toString();if(Array.prototype.reduce)return this.jq="S"+a.split("").reduce(function(a,b){a=(a<<5)-a+b.charCodeAt(0);return a&a},0);var b=0;if(0===a.length)return"";for(var c=0;c<a.length;c++)b=(b<<5)-b+a.charCodeAt(c),b&=b;return this.jq="S"+b};b.prototype.Ho=function(){return this.pe(0)};b.prototype.Bh=function(){return null!==
this.gv?this.gv:this.gv=a.Su.SQ(this)};b.r_=!0;b.xv=2147483645;b.yv=9007199254740990;return b}();a.ve=b})(C||(C={}));(function(a){var b=function(b){function c(){var c=null!==b&&b.apply(this,arguments)||this;c.jj=null;c.tV=null;c.rp=new a.kE;c.yp=null;c.Xw=null;return c}ca(c,b);c.SQ=function(b){var d=new c;d.xg=b.xg;d.Ap=b.Ap;d.$I=b.$I;d.Vh=b.Vh;if(""!==d.Vh&&null!==d.Vh){b=c.Gj(d.Vh);var e=c.Ej(d.Vh);d.rp.Ay(b,e,a.Tu.Integer64);d.Gy(b);d.Jy(e);d.xg=b.Ys()}else b=c.Fj(d.xg),d.Gy(b),d.Jy(null),d.rp.Ay(b,
null,a.Tu.Integer64);return d};c.prototype.pe=function(a){return this.rp.Ho(a)};c.Ej=function(b){if(0>=b.length)throw a.g.F();var d=null;try{d=a.WD.fromString(b)}catch(y){d=null}return null==d?null:c.de(d,!0)};c.prototype.Gy=function(a){this.Nd=a;this.yp=this.Nd.Td()};c.prototype.Jy=function(a){this.LI=a;this.tV=null!=this.LI?this.LI.yp:null};c.prototype.Ic=function(){return 0==this.Fb()||3==this.Fb()?!1:this.Nd.Ic()};c.prototype.IH=function(){return 0==this.Fb()?!1:3==this.Fb()?this.jj.Ik().Ic():
this.Nd.Ic()};c.prototype.Jg=function(){return null!=this.Nd?this.Nd.rf:null};c.prototype.hn=function(){return this.Nd.hn()};c.prototype.ce=function(){return this.Nd.ce()};c.prototype.Dh=function(){return null!=this.Nd?this.Nd.fx:NaN};c.prototype.kn=function(){return this.Nd.kn()};c.prototype.Us=function(){return this.Nd.Us()};c.prototype.Wj=function(){return this.Nd.Wj()};c.prototype.JT=function(b){return a.ZD.zz(this.Nd,b.Nd)};c.prototype.Ok=function(){return this.Nd.Ok()};c.prototype.Ts=function(){return this.Nd.Ts()};
c.prototype.ri=function(){return 3==this.Fb()?this.jj.Ik().ri():this.Nd.ri()};c.prototype.Ch=function(){if(!this.Ic())throw a.g.F("!isPannable()");var b=new a.h;this.Nd.Ch(b);return b};c.prototype.oe=function(){if(!this.Ic())throw a.g.F("!isPannable()");return this.Nd.mp};c.prototype.aT=function(){if(!this.Ic())throw a.g.F("!isPannable()");var b=new a.h;this.Nd.$S(b);return b};c.prototype.bw=function(){if(!this.Ic())throw a.g.F("!isPannable()");return this.Nd.bw()};c.prototype.aw=function(){if(!this.Ic())throw a.g.F("!isPannable()");
return this.Nd.aw()};c.prototype.Vs=function(){return null!=this.jj?this.jj.Ik().Vs():this.Nd.Vs()};c.prototype.dS=function(){return this.Nd.Uv()};c.prototype.NW=function(a){a.assign(this.rp)};c.prototype.Zi=function(){return this.yp.getUnitFactor()};c.prototype.iA=function(a){return this.rp.iA(a)};c.prototype.lc=function(){var b=this.Fb();if(1==b)return this;if(3==b)return this.jj.Ik().lc();if(0==b)throw a.g.X("invalid call");if(4===b)throw a.g.X("invalid call");if(null!==this.Xw)return this.Xw;
b=this.Jg().getGeogcs();if(null==b)throw a.g.za();return this.Xw=c.hG(b,this.rp.$s())};c.hG=function(b,d){if(null==b)throw a.g.F("null pointer.");var e=new c;b=c.dc(b,!0);e.rp.Ay(b,null,d);e.Gy(b);e.Jy(null);e.xg=b.Ys();return e};c.prototype.Fb=function(){var b=this.Jg();if(null!=b)switch(b.getType()){case a.Uc.PE_TYPE_GEOGCS:return 1;case a.Uc.PE_TYPE_PROJCS:return 2}return 4};c.prototype.gA=function(b){var c=new a.b;this.Nd.gA(b,c);return c};c.prototype.Uv=function(){return this.Nd.Uv()};c.dc=function(b,
d){var e=b.getCode();if(0>=e&&(e=a.Qf.getCode(b),0<e)){var f=a.Qf.coordsys(e);if(null==f)throw a.g.F("Text to wkid mapping had failed: "+e);return c.dc(f,d)}if(d&&0<e&&(f=c.ad[e]))return f;f=a.Ib.iw(b,e,!1);if(d=c.Ug[f])return d;d=0>=e?b:a.Qf.coordsys(e);d=new a.ZD(d);c.Ug[f]=d;0<e&&(c.ad[e]=d);return d};c.Fj=function(b){if(0>=b)throw a.g.F("Invalid or unsupported wkid: "+b);var d=c.ad[b];if(null!=d)return d;d=a.Qf.coordsys(b);if(null==d)throw a.g.F("Invalid or unsupported wkid: "+b);d=c.dc(d,!1);
d.Ys()!=b&&(c.ad[b]=d);return d};c.Gj=function(b){if(null==b||void 0===b||0==b.length)throw a.g.F("Cannot create SpatialReference from null or empty text.");var d=null;try{d=a.Qf.fromString(a.Uc.PE_TYPE_COORDSYS,b)}catch(y){throw a.g.F("Cannot create SpatialReference from text. "+y.message);}if(null===d)throw a.g.F("Cannot create SpatialReference from text. ");return c.dc(d,!0)};c.de=function(b,d){var e=b.getCode();if(0>=e&&(e=a.Qf.getCode(b),0<e)){e=a.Qf.vertcs(e);if(null===e)throw a.g.F();return c.de(e,
d)}if(d&&0<e&&(d=c.Xf[e]))return d;b=a.Ib.iw(b,e,!1);if(d=c.Yg[b])return d;var f;0>=e||(f=a.Qf.vertcs(e));if(null===f)throw a.g.F();d=new a.hN(f);c.Yg[b]=d;0<e&&(c.Xf[e]=d);return d};c.lf=function(b,c){var d;if(null===c||c.u())return null;var e=new a.h,f;null!==c&&1!=b.Fb()?(d=b.lc(),f=d.Jg(),d=a.rs.Gs(b,d,null,null),d=a.ns.local().V(c,d,null),d.s(e)):(f=b.Jg(),c.s(e));d=f.getPrimem().getLongitude();f=f.getUnit().getUnitFactor();return new a.UD(e.o,e.A,e.v,e.B,d,f)};c.IE=function(a){var b={name:"",
steps:[],_pt:null,_entry:null},c=0;for(a=a.getEntries();c<a.length;c++){var d=a[c],e={d_:!1,C_:"",B_:-1,geogtran:null};0===d.getDirection()?e.isInverse=!1:e.isInverse=!0;var f=d.getGeogtran().getCode();-1<f?e.wkid=f:e.wkt=d.getGeogtran().toString();b.steps.push(e)}return b};c.rT=function(b,d,e,f){void 0===e&&(e=null);e=c.lf(f,e);b=a.fq.getGTlist(b.Jg(),d.Jg(),2,a.fq.PE_GTLIST_OPTS_COMMON,e,1);d=null;b&&0<b.length&&(d=this.IE(b[0]),a.sy.destroy(b));null!==e&&e.destroy();return d};c.sT=function(b,d,
e,f){var g;void 0===e&&(e=null);void 0===f&&(f=null);void 0===g&&(g=30);e=c.lf(f,e);b=a.fq.getGTlist(b.Jg(),d.Jg(),2,a.fq.PE_GTLIST_OPTS_COMMON,e,g);d=[];if(b&&0<b.length){for(g=0;g<b.length;g++)d.push(this.IE(b[g]));a.sy.destroy(b)}null!==e&&e.destroy();return d};c.ad={};c.Ug={};c.Xf={};c.Yg={};return c}(a.ve);a.Su=b})(C||(C={}));(function(a){var b;(function(a){a[a.Integer32=0]="Integer32";a[a.Integer64=1]="Integer64";a[a.FloatingPoint=2]="FloatingPoint"})(b=a.Tu||(a.Tu={}));var c=function(){function c(){this.kq()}
c.prototype.assign=function(a){this.bm=a.bm;this.cm=a.cm;this.vj=a.vj;this.Tw=a.Tw;this.Pn=a.Pn;this.Sw=a.Sw;this.rx=a.rx;this.ll=a.ll;this.Cr=a.Cr;this.Br=a.Br;this.Kn=a.Kn};c.prototype.Ps=function(){return this.bm};c.prototype.Qs=function(){return this.cm};c.prototype.Rs=function(){return this.Tw};c.prototype.Os=function(){return this.Sw};c.prototype.Wz=function(){return this.vj};c.prototype.Xz=function(){return this.Pn};c.prototype.Vz=function(){return this.rx};c.prototype.$s=function(){return this.Kn};
c.prototype.kq=function(){this.cm=this.bm=0;this.vj=1;this.Tw=0;this.Pn=1;this.Sw=0;this.rx=1;this.Br=this.Cr=this.ll=2.220446049250313E-14;this.Kn=b.FloatingPoint};c.prototype.Ay=function(c,d,e){this.kq();this.Kn=e;if(e!=b.FloatingPoint){var f=new a.h;c.zS(f);this.bm=f.o;this.cm=f.A}else this.cm=this.bm=-1.7976931348623157E308;f=c.rf.getType();f==a.Uc.PE_TYPE_GEOGCS?(f=(e==b.Integer64?1E-9:1/18E5)*c.ce(),this.vj=1/f):f==a.Uc.PE_TYPE_PROJCS&&(f=(e==b.Integer64?1E-4:.001)*c.hn(),this.vj=1/f);null!=
d?(f=(e==b.Integer32?.001:1E-4)*d.JI,this.Pn=1/f):this.Pn=1E4;this.rx=1E4;this.sO();this.ll=c.fx;this.Cr=null!=d?.001*d.JI:.001;this.Br=2.220446049250313E-14};c.prototype.sO=function(){if(this.Kn!=b.FloatingPoint){var c=this.Kn==b.Integer64?a.ve.yv:a.ve.xv,d=c/this.vj,e=this.bm+d,f=a.J.truncate((e-this.bm)*this.vj);f>c&&(this.vj=c/(e-this.bm));d=this.cm+d;f=a.J.truncate((d-this.cm)*this.vj);f>c&&(this.vj=c/(d-this.cm))}};c.prototype.BC=function(a,b){switch(a){case 0:this.ll=b;case 1:this.Cr=b;case 2:this.Br=
b}};c.prototype.Ho=function(a){switch(a){case 0:return this.ll;case 1:return this.Cr;case 2:return this.Br}return 0};c.prototype.xT=function(){var c=new a.h;switch(this.$s()){case b.Integer32:var d=a.ve.xv/this.Wz();c.I(this.Ps(),this.Qs(),this.Ps()+d,this.Qs()+d);break;case b.Integer64:d=a.ve.yv/this.Wz();c.I(this.Ps(),this.Qs(),this.Ps()+d,this.Qs()+d);break;case b.FloatingPoint:c.I(-1.7976931348623157E308,-1*1.7976931348623157E308,1.7976931348623157E308,1.7976931348623157E308);break;default:throw a.g.X("internal error");
}return c};c.prototype.zT=function(){var c=new a.yc;switch(this.$s()){case b.Integer32:var d=a.ve.xv/this.Xz();c.I(this.Rs(),this.Rs()+d);break;case b.Integer64:d=a.ve.yv/this.Xz();c.I(this.Rs(),this.Rs()+d);break;case b.FloatingPoint:c.I(-1*1.7976931348623157E308,1.7976931348623157E308);break;default:throw a.g.X("internal error");}return c};c.prototype.TS=function(){var c=new a.yc;switch(this.$s()){case b.Integer32:var d=a.ve.xv/this.Vz();c.I(this.Os(),this.Os()+d);break;case b.Integer64:d=a.ve.yv/
this.Vz();c.I(this.Os(),this.Os()+d);break;case b.FloatingPoint:c.I(-1*1.7976931348623157E308,1.7976931348623157E308);break;default:throw a.g.X("internal error");}return c};c.prototype.iA=function(a){if(this.Kn==b.FloatingPoint)return 0;switch(a){case 0:return 1/this.vj;case 1:return 1/this.Pn;case 2:return 1/this.Pn;default:return 0}};c.prototype.toString=function(){var a;a="SRPD [m_toleranceXY: "+this.ll.toString();a=a+";m_falseX: "+this.bm.toString();a=a+";m_falseY: "+this.cm.toString();a=a+";m_unitsXY: "+
this.vj.toString();a=a+";m_falseZ: "+this.Tw.toString();a=a+";m_unitsZ: "+this.Pn.toString();a=a+";m_falseM: "+this.Sw.toString();a=a+";m_toleranceZ: "+this.Cr.toString();a=a+";m_toleranceM: "+this.Br.toString();a=a+";m_precision: "+this.Kn.toString();return a+"] "};return c}();a.kE=c})(C||(C={}));(function(a){function b(a,b){89.99999<b?b=89.99999:-89.99999>b&&(b=-89.99999);b*=.017453292519943;return[111319.49079327169*a,3189068.5*Math.log((1+Math.sin(b))/(1-Math.sin(b)))]}function c(a,b,c){a=a/6378137*
57.29577951308232;return c?[a,57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*b/6378137)))]:[a-360*Math.floor((a+180)/360),57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*b/6378137)))]}function d(b,c){var d=b.Sf();if(33===b.G()){var e=c(d.Te(),d.Cf());d.rb(e[0],e[1])}else if(197===b.G())e=c(b.dt(),b.ft(),!0),b=c(b.ct(),b.et(),!0),d.I(e[0],e[1],b[0],b[1]);else for(e=new a.b,b=0;b<d.D();b++){d.w(b,e);var f=c(e.x,e.y,!0);e.ja(f[0],f[1]);d.rb(b,e)}return d}function e(a){return d(a,
c)}function f(a){return d(a,b)}var g=Math.PI/180,k=function(){function b(){}b.os=function(b){var c=Math.sqrt(.006694379990197414),d=Math.sin(b.y*g);return a.b.pa(6378137*b.x*g,3167719.6636462314*(d/(1-.006694379990197414*d*d)-1/(2*c)*Math.log((1-c*d)/(1+c*d))))};b.xz=function(b,c,d,e){var f=1/298.257223563,h=Math.sin(d);d=Math.cos(d);var k=(1-f)*Math.tan(b);b=1/Math.sqrt(1+k*k);for(var n=k*b,p=Math.atan2(k,d),k=b*h,l=k*k,m=1-l,q=2.7233160610754688E11*m/4.040829998466145E13,r=1+q/16384*(4096+q*(-768+
q*(320-175*q))),t=q/1024*(256+q*(-128+q*(74-47*q))),q=e/(6356752.31424518*r),u=2*Math.PI,y,w,v,x;1E-12<Math.abs(q-u);)v=Math.cos(2*p+q),y=Math.sin(q),w=Math.cos(q),x=t*y*(v+t/4*(w*(-1+2*v*v)-t/6*v*(-3+4*y*y)*(-3+4*v*v))),u=q,q=e/(6356752.31424518*r)+x;e=n*y-b*w*d;m=f/16*m*(4+f*(4-3*m));return a.b.pa((c+(Math.atan2(y*h,b*w-n*y*d)-(1-m)*f*k*(q+m*y*(v+m*w*(-1+2*v*v)))))/g,Math.atan2(n*w+b*y*d,(1-f)*Math.sqrt(l+e*e))/g)};b.uV=function(a,b,c,d){var e=1/298.257223563,f=d-b,g=Math.atan((1-e)*Math.tan(a)),
h=Math.atan((1-e)*Math.tan(c)),k=Math.sin(g),g=Math.cos(g),n=Math.sin(h),h=Math.cos(h),p=f,l,m=1E3,q,r,t,u,y,w,v;do{t=Math.sin(p);u=Math.cos(p);r=Math.sqrt(h*t*h*t+(g*n-k*h*u)*(g*n-k*h*u));if(0===r)return 0;u=k*n+g*h*u;y=Math.atan2(r,u);w=g*h*t/r;q=1-w*w;t=u-2*k*n/q;isNaN(t)&&(t=0);v=e/16*q*(4+e*(4-3*q));l=p;p=f+(1-v)*e*w*(y+v*r*(t+v*u*(-1+2*t*t)))}while(1E-12<Math.abs(p-l)&&0<--m);if(0===m)return k=d-b,{azimuth:Math.atan2(Math.sin(k)*Math.cos(c),Math.cos(a)*Math.sin(c)-Math.sin(a)*Math.cos(c)*Math.cos(k)),
geodesicDistance:6371008.771415059*Math.acos(Math.sin(a)*Math.sin(c)+Math.cos(a)*Math.cos(c)*Math.cos(d-b))};a=2.7233160610754688E11*q/4.040829998466145E13;b=a/1024*(256+a*(-128+a*(74-47*a)));return{azimuth:Math.atan2(h*Math.sin(p),g*n-k*h*Math.cos(p)),oS:6356752.31424518*(1+a/16384*(4096+a*(-768+a*(320-175*a))))*(y-b*r*(t+b/4*(u*(-1+2*t*t)-b/6*t*(-3+4*r*r)*(-3+4*t*t)))),u_:Math.atan2(g*Math.sin(p),g*n*Math.cos(p)-k*h)}};b.hM=function(b){var c=b.hasAttribute(1),d=b.hasAttribute(2),e=[],f=b.aa(),g=
null,h=null;c&&(g=b.Qa(1));d&&(h=b.Qa(2));for(var k=new a.b,n=0;n<f;n++){for(var p=b.wa(n),l=b.La(n),m=0,q=0,r=NaN,t=NaN,u=NaN,y=NaN,w=b.Qb(n),v=[],x=p;x<p+l;x++){b.w(x,k);var y=u=NaN,D=[k.x,k.y];c&&(u=g.get(x),D.push(u));d&&(f=h.get(x),D.push(y));x==p&&w&&(m=k.x,q=k.y,r=u,t=y);v.push(D)}!w||m==k.x&&q==k.y&&(!c||isNaN(r)&&isNaN(u)||r==u)&&(!d||isNaN(t)&&isNaN(y)||t==y)||v.push(v[0].slice(0));e.push(v)}return e};b.Hz=function(a,c){a=b.hM(a);637.100877141506>c&&(c=637.100877141506);for(var d=[],e,f=
0;f<a.length;f++){var h=a[f];d.push(e=[]);e.push([h[0][0],h[0][1]]);var k,n,p,l,m,q;k=h[0][0]*g;n=h[0][1]*g;for(m=0;m<h.length-1;m++)if(p=h[m+1][0]*g,l=h[m+1][1]*g,k!==p||n!==l){l=b.uV(n,k,l,p);p=l.azimuth;l=l.oS;var r=l/c;if(1<r){for(q=1;q<=r-1;q++){var t=b.xz(n,k,p,q*c);e.push([t.x,t.y])}q=b.xz(n,k,p,(l+Math.floor(r-1)*c)/2);e.push([q.x,q.y])}n=b.xz(n,k,p,l);e.push([n.x,n.y]);k=n.x*g;n=n.y*g}}return{VJ:d}};b.nS=function(c){for(var d=[],e=0;e<c.length;e++){var f=c[e],f=b.Hz(f,1E4);d.push(f)}c=[];
for(var g=0;g<d.length;g++){for(var f=d[g],h=0,e=0;e<f.VJ.length;e++){var k=f.VJ[e],n=b.os(a.b.pa(k[0][0],k[0][1])),p=b.os(a.b.pa(k[k.length-1][0],k[k.length-1][1])),l=p.x*n.y-n.x*p.y,m;for(m=0;m<k.length-1;m++)n=b.os(a.b.pa(k[m+1][0],k[m+1][1])),p=b.os(a.b.pa(k[m][0],k[m][1])),l+=p.x*n.y-n.x*p.y;h+=l}h/=1;c.push(h/-2)}return c};return b}();a.aM=k;k=function(){function b(){}b.$B=function(a,c,d,e,f,g,h){b.iD[a.kc()]=c;0==isNaN(d)&&(b.kD[a.kc()]=d);0==isNaN(e)&&(b.uD[a.kc()]=e);0==isNaN(f)&&(b.gD[a.kc()]=
f);b.nD[a.kc()]=g;null!==h&&(b.pD[a.kc()]=h)};b.Ix=function(a,c,d){b.sD[a.kc()+"-"+c.kc()]=d};b.lc=function(c){c=b.iD[c.kc()];if(void 0==c)throw a.g.af();return c};b.ce=function(c){c=b.kD[c.kc()];if(void 0==c)throw a.g.af();return c};b.hw=function(c){c=b.uD[c.kc()];if(void 0==c)throw a.g.af();return c};b.Sv=function(c){c=b.gD[c.kc()];if(void 0==c)throw a.g.af();return c};b.Ch=function(c){c=b.pD[c.kc()];if(void 0==c)throw a.g.af();return a.h.pa(c[0],c[1],c[2],c[3])};b.Ic=function(c){c=b.nD[c.kc()];
if(void 0==c)throw a.g.af();return c};b.Vg=function(c,d,e){if(d.Eb(e))return c;var f=b.sD[d.kc()+"-"+e.kc()];if(void 0!==f)return f(c,d,e);throw a.g.af();};b.nu=function(){throw a.g.af();};b.tS=function(){throw a.g.af();};b.xW=function(){throw a.g.af();};b.Ok=function(){throw a.g.af();};b.WW=function(){var b=a.ve.create(102100),c=a.ve.create(3857),d=a.ve.create(4326);a.fb.$B(b,d,NaN,NaN,NaN,!1,null);a.fb.$B(d,d,1,.0033528106647474805,6378137,!0,[-180,-90,180,90]);a.fb.$B(c,d,NaN,NaN,NaN,!1,null);
a.fb.Ix(b,d,e);a.fb.Ix(d,b,f);a.fb.Ix(c,d,e);a.fb.Ix(d,c,f)};b.iD=[];b.kD=[];b.uD=[];b.gD=[];b.nD=[];b.pD=[];b.sD=[];return b}();a.fb=k})(C||(C={}));C.fb.WW();(function(a){var b=function(){function b(a){this.f=null;this.jh=-1;this.xd=this.size=this.Gf=0;this.dd=a}b.prototype.jd=function(a){a<this.Gf?(this.f[a*this.dd]=this.jh,this.jh=a):this.Gf--;this.size--};b.prototype.S=function(a,b){return this.f[a*this.dd+b]};b.prototype.R=function(a,b,c){this.f[a*this.dd+b]=c};b.prototype.Me=function(){var b=
this.jh;if(-1==b){if(this.Gf==this.xd){b=0!=this.xd?a.J.truncate(3*(this.xd+1)/2):1;2147483647<b&&(b=2147483647);if(b==this.xd)throw a.g.vd();this.Io(b)}b=this.Gf;this.Gf++}else this.jh=this.f[b*this.dd];this.size++;for(var c=b*this.dd+this.dd,d=b*this.dd;d<c;d++)this.f[d]=-1;return b};b.prototype.pl=function(b){var c=this.jh;if(-1==c){if(this.Gf==this.xd){c=0!=this.xd?a.J.truncate(3*(this.xd+1)/2):1;2147483647<c&&(c=2147483647);if(c==this.xd)throw a.g.vd();this.Io(c)}c=this.Gf;this.Gf++}else this.jh=
this.f[c*this.dd];this.size++;for(var d=c*this.dd,e=this.dd,f=0;f<e;f++)this.f[d+f]=b[f];return c};b.prototype.Wi=function(a){this.jh=-1;this.size=this.Gf=0;a&&(this.f=null,this.xd=0)};b.prototype.Ne=function(a){a>this.xd&&this.Io(a)};b.prototype.ay=function(a,b,c){var d=this.f[this.dd*b+c];this.f[this.dd*b+c]=this.f[this.dd*a+c];this.f[this.dd*a+c]=d};b.zl=function(){return-2};b.Al=function(){return-3};b.EA=function(a){return 0<=a};b.prototype.Io=function(a){null==this.f&&(this.f=[]);this.xd=a};
return b}();a.Zc=b;b=function(){function b(a){this.f=new Int32Array(0);this.jh=-1;this.xd=this.size=this.Gf=0;this.dd=a}b.prototype.jd=function(a){a<this.Gf?(this.f[a*this.dd]=this.jh,this.jh=a):this.Gf--;this.size--};b.prototype.S=function(a,b){return this.f[a*this.dd+b]};b.prototype.R=function(a,b,c){this.f[a*this.dd+b]=c};b.prototype.Me=function(){var b=this.jh;if(-1==b){if(this.Gf==this.xd){b=0!=this.xd?a.J.truncate(3*(this.xd+1)/2):1;2147483647<b&&(b=2147483647);if(b==this.xd)throw a.g.vd();
this.Io(b)}b=this.Gf;this.Gf++}else this.jh=this.f[b*this.dd];this.size++;for(var c=b*this.dd;c<b*this.dd+this.dd;c++)this.f[c]=-1;return b};b.prototype.pl=function(b){var c=this.jh;if(-1==c){if(this.Gf==this.xd){c=0!=this.xd?a.J.truncate(3*(this.xd+1)/2):1;2147483647<c&&(c=2147483647);if(c==this.xd)throw a.g.vd();this.Io(c)}c=this.Gf;this.Gf++}else this.jh=this.f[c*this.dd];this.size++;for(var d=c*this.dd,e=0;e<b.length;e++)this.f[d+e]=b[e];return c};b.prototype.Wi=function(a){this.jh=-1;this.size=
this.Gf=0;a&&(this.f=null,this.xd=0)};b.prototype.Ne=function(a){a>this.xd&&this.Io(a)};b.prototype.ay=function(a,b,c){var d=this.f[this.dd*b+c];this.f[this.dd*b+c]=this.f[this.dd*a+c];this.f[this.dd*a+c]=d};b.zl=function(){return-2};b.Al=function(){return-3};b.EA=function(a){return 0<=a};b.prototype.Io=function(a){null==this.f&&(this.f=new Int32Array(0));var b=new Int32Array(this.dd*a);b.set(this.f,0);this.f=b;this.xd=a};return b}();a.zN=b;!0===a.Yh.Gm&&(a.Zc=a.zN)})(C||(C={}));(function(a){var b;
(function(a){a[a.enumInputModeBuildGraph=0]="enumInputModeBuildGraph";a[a.enumInputModeSimplifyAlternate=4]="enumInputModeSimplifyAlternate";a[a.enumInputModeSimplifyWinding=5]="enumInputModeSimplifyWinding";a[a.enumInputModeIsSimplePolygon=7]="enumInputModeIsSimplePolygon"})(b||(b={}));var c=function(){function b(b){this.Ze=b;this.Xh=NaN;this.dI=new a.Bg;this.eI=new a.Bg;this.kt=new a.yc;this.lt=new a.yc}b.prototype.compare=function(a,b,c){a=a.ia(c);this.Ze.TB(b,this.dI);this.Ze.TB(a,this.eI);b=
this.dI.get();a=this.eI.get();this.kt.I(b.ua,b.sa);this.lt.I(a.ua,a.sa);if(this.kt.la<this.lt.ga)return-1;if(this.kt.ga>this.lt.la)return 1;c=b.ra==b.oa;var d=a.ra==a.oa;if(c||d){if(c&&d)return 0;if(b.ra==a.ra&&b.ua==a.ua)return c?1:-1;if(b.oa==a.oa&&b.sa==a.sa)return c?-1:1}c=b.kf(this.Xh,this.kt.ga);d=a.kf(this.Xh,this.lt.ga);c==d&&(c=Math.min(b.oa,a.oa),d=.5*(c+this.Xh),d==this.Xh&&(d=c),c=b.kf(d,this.kt.ga),d=a.kf(d,this.lt.ga));return c<d?-1:c>d?1:0};b.prototype.FK=function(a){this.Xh=a};return b}(),
d=function(){function b(b){this.bb=b;this.YI=new a.Bg;this.ag=new a.b;this.fB=new a.yc}b.prototype.JX=function(a){this.ag.L(a)};b.prototype.compare=function(a,b){this.bb.TB(a.ia(b),this.YI);a=this.YI.get();this.fB.I(a.ua,a.sa);if(this.ag.x<this.fB.ga)return-1;if(this.ag.x>this.fB.la)return 1;a=a.kf(this.ag.y,this.ag.x);return this.ag.x<a?-1:this.ag.x>a?1:0};return b}();b=function(){function b(){this.gI=this.dj=this.gj=this.WA=this.To=this.Ve=this.Qc=this.Fh=this.Ae=null;this.zp=this.Rg=-1;this.fI=
!0;this.$A=!1;this.XA=NaN;this.nj=new a.Yd;this.zP=2147483647;this.yP=a.J.truncate(-2147483648);this.wg=this.ue=this.pm=this.rr=this.wn=this.qr=this.Lt=this.nf=-1;this.qa=0}b.prototype.cz=function(a){this.XA=a};b.prototype.Sn=function(){null==this.Ae&&(this.Ae=new a.Zc(8));var b=this.Ae.Me();this.Ae.R(b,1,0);return b};b.prototype.KV=function(){null==this.Qc&&(this.Qc=new a.Zc(8));var b=this.Qc.Me();this.Qc.R(b,2,0);this.Qc.R(b,3,0);var c=this.Qc.Me();this.Qc.R(c,2,0);this.Qc.R(c,3,0);this.nK(b,c);
this.nK(c,b);return b};b.prototype.jJ=function(){null==this.Ve&&(this.Ve=new a.Zc(8));var b=this.Ve.Me();this.Ve.R(b,2,0);return b};b.prototype.uX=function(a,b){this.Ae.R(a,7,b)};b.prototype.jo=function(a,b){this.Ae.R(a,2,b)};b.prototype.tX=function(a,b){this.Ae.R(a,1,b)};b.prototype.KX=function(a,b){this.Ae.R(a,3,b)};b.prototype.HX=function(a,b){this.Ae.R(a,4,b)};b.prototype.Ur=function(a,b){this.Ae.R(a,5,b)};b.prototype.wS=function(a){return this.Ae.S(a,5)};b.prototype.sX=function(a,b){this.Ae.R(a,
6,b)};b.prototype.yO=function(a,b){this.sX(b,a)};b.prototype.mK=function(a,b){this.Qc.R(a,1,b)};b.prototype.nK=function(a,b){this.Qc.R(a,4,b)};b.prototype.Dm=function(a,b){this.Qc.R(a,5,b)};b.prototype.Cm=function(a,b){this.Qc.R(a,6,b)};b.prototype.zX=function(a,b){this.Qc.R(a,2,b)};b.prototype.Nx=function(a,b){this.Qc.R(a,3,b)};b.prototype.OG=function(a){return this.Qc.S(a,3)};b.prototype.wu=function(a,b){this.Qc.R(a,7,b)};b.prototype.kL=function(a,b){if(-1!=this.fn(a))for(b=b?-1:a,a=this.fn(a);-1!=
a;a=this.it(a))this.a.Va(this.Yj(a),this.rr,b)};b.prototype.ey=function(a,b){-1!=a&&(this.kL(a,b),this.kL(this.Aa(a),b))};b.prototype.uu=function(a,b){this.Ve.R(a,1,b)};b.prototype.qh=function(a,b){this.Ve.R(a,2,b)};b.prototype.fo=function(a,b){this.Ve.R(a,3,b);this.qX(a,this.vS(b));this.pX(b,a)};b.prototype.pX=function(a,b){this.Ve.R(a,4,b)};b.prototype.qX=function(a,b){this.Ve.R(a,5,b)};b.prototype.hK=function(a,b){this.Ve.R(a,6,b)};b.prototype.fK=function(a,b){this.Ve.R(a,7,b)};b.prototype.eK=
function(a,b){this.To.write(a,b)};b.prototype.gK=function(a,b){this.WA.write(a,b)};b.prototype.MY=function(b){var c=0,d=0,e=this.EG(b),f=new a.b,g=new a.b,h=new a.b;this.Ws(e,f);g.L(f);var k=e;do this.en(k,h),d+=a.b.Cb(g,h),this.Af(this.Aa(k))!=b&&(c+=(h.x-f.x-(g.x-f.x))*(h.y-f.y+(g.y-f.y))*.5),g.L(h),k=this.qc(k);while(k!=e);this.To.write(b,c);this.WA.write(b,d)};b.prototype.fW=function(b){var e=new c(this),f=new a.xk;f.Ne(a.J.truncate(this.qa/2));f.Lp(e);for(var g=new a.ha(0),h=this.xh(),k=null,
n=0,l=new a.b,p=this.nf;-1!=p;p=this.ng(p)){n++;var m=this.gf(p);if(-1!=m){g.uf(0);if(!this.FY(f,h,g,m)){this.w(p,l);e.FK(l.y);var q=m;do{var r=this.Kb(q,h);-1!=r&&(f.Jd(r,-1),this.Ob(q,h,-2));q=this.qc(this.Aa(q))}while(m!=q);q=m;do r=this.Kb(q,h),-1==r&&(r=f.addElement(q,-1),g.add(r)),q=this.qc(this.Aa(q));while(m!=q)}for(m=g.size-1;0<=m;m--)r=g.get(m),q=f.ia(r),this.Ob(this.Aa(q),h,r),this.eW(f,r,b)}else-1==this.Nz(p)&&(null==k&&(k=new d(this)),this.w(p,l),k.JX(l),q=f.lX(k),m=this.pm,-1!=q&&(r=
f.ia(q),this.Af(r)==this.Af(this.Aa(r))&&(r=this.QG(f,q)),-1!=r&&(m=this.Af(r))),this.yO(m,p))}this.oi(h)};b.prototype.eW=function(a,b,c){var d=a.ia(b),e=this.Af(d);if(-1==this.Co(e)){var f=this.QG(a,b),g=this.Aa(d),h=this.Af(g);this.Dq(e);this.Dq(h);var k=this.Co(e),n=this.Co(h);-1==f&&-1==k&&(h==e?(this.fo(h,this.pm),k=n=this.pm):(-1==n&&(this.fo(h,this.pm),n=this.pm),this.fo(e,h),k=h));if(-1!=f){var l=this.Af(f);-1==n&&(0>=this.Dq(l)?(n=this.Co(l),this.fo(h,n)):(this.fo(h,l),n=l),h==e&&(k=n))}-1==
k&&this.GY(e,h);0==c?this.EW(a,b,d,f,e,h):5==c?this.FW(a,b,d,g,e,h):4==c&&this.DW(d,f,e,h)}};b.prototype.EW=function(a,b,c,d,e,f){var g=this.Kk(e);if(-1!=d){var h=this.Kk(f),k=this.Kk(this.Af(d));d=g&h&k;k^=k&this.Ah(c);k|=d;0!=k&&(this.qh(f,h|k),this.qh(e,k|g),g=g||k)}for(b=a.nb(b);-1!=b;b=a.nb(b)){d=a.ia(b);c=this.Af(this.Aa(d));e=this.Kk(c);f=this.Ah(d);h=this.Af(d);k=this.Kk(h);d=e&k&g;g^=g&f;g|=d;if(0==g)break;this.qh(c,e|g);this.qh(h,k|g)}};b.prototype.FW=function(b,c,d,e,f,g){if(f!=g){d=this.Kb(d,
this.wg);d+=this.Kb(e,this.wg);e=0;var h=new a.ha(0),k=new a.ha(0);k.add(0);for(var n=b.wc(-1);n!=c;n=b.nb(n)){var l=b.ia(n),p=this.Aa(l),m=this.Af(l),q=this.Af(p);if(m!=q){l=this.Kb(l,this.wg);l+=this.Kb(p,this.wg);e+=l;p=!1;0!=h.size&&h.Ec()==q&&(k.Mf(),h.Mf(),p=!0);if(-1==this.Co(q))throw a.g.za();p&&this.Co(q)==m||(k.add(e),h.add(m))}}e+=d;0!=h.size&&h.Ec()==g&&(k.Mf(),h.Mf());0!=e?0==k.Ec()&&(b=this.a.qd,b=this.Ia(b),this.qh(f,b)):0!=k.Ec()&&(b=this.a.qd,b=this.Ia(b),this.qh(f,b))}};b.prototype.DW=
function(a,b,c,d){var e=this.Ia(this.a.qd);if(-1==b)this.qh(d,this.zp),a=this.Kb(a,this.Rg),0!=(a&1)?this.qh(c,e):this.qh(c,this.zp);else{var f=this.Kk(d);0==f&&(f=this.Kk(this.Af(b)),this.qh(d,f));a=this.Kb(a,this.Rg);0!=(a&1)?this.qh(c,f==e?this.zp:e):this.qh(c,f)}};b.prototype.FY=function(a,b,c,d){var e=d,f=-1,g=-1,h=0;do{if(2==h)return!1;var k=this.Kb(e,b);if(-1!=k){if(-1!=f)return!1;f=k}else{if(-1!=g)return!1;g=e}h++;e=this.qc(this.Aa(e))}while(d!=e);if(-1==g||-1==f)return!1;this.Ob(a.ia(f),
b,-2);a.pk(f,g);c.add(f);return!0};b.prototype.GY=function(a,b){var c=this.Dq(a);if(0!=c){var d=this.Dq(b);0<c&&0>d?this.fo(a,b):0>c&&0<d?this.fo(a,b):(c=this.Co(b),-1!=c&&this.fo(a,c))}};b.prototype.QQ=function(b,c){this.rr=this.a.Sd();for(var d=0,e=c.size;d<e;d++){var f=c.get(d),g=this.a.Sa(f,this.wn),h=this.a.mg(this.a.kd(f)),k=this.a.ic(h);if(a.T.Hc(k)){var n=this.a.U(f);if(-1!=n){var l=this.a.Sa(n,this.wn);if(g!=l){var p=this.KV(),m=this.Aa(p),q=this.Fh.Me();this.Fh.R(q,0,f);this.Fh.R(q,1,-1);
this.wu(p,q);this.mK(p,g);q=this.gf(g);-1==q?(this.jo(g,p),this.Dm(p,m),this.Cm(m,p)):(g=this.Qe(q),this.Dm(q,m),this.Cm(m,q),this.Cm(g,p),this.Dm(p,g));this.mK(m,l);g=this.gf(l);-1==g?(this.jo(l,m),this.Cm(p,m),this.Dm(m,p)):(l=this.Qe(g),this.Dm(g,p),this.Cm(p,g),this.Cm(l,m),this.Dm(m,l));h=this.Ia(h);0==b?(this.Ob(m,this.ue,0),this.Ob(p,this.ue,1736==k?h:0)):5==b?(l=new a.b,this.a.w(f,l),f=new a.b,this.a.w(n,f),g=n=0,0>l.compare(f)?n=1:g=-1,this.Ob(m,this.ue,0),this.Ob(p,this.ue,0),this.Ob(p,
this.wg,n),this.Ob(m,this.wg,g)):7==b?(this.Ob(m,this.ue,this.zp),this.Ob(p,this.ue,1736==k?h:0)):4==b&&(this.Ob(m,this.ue,0),this.Ob(p,this.ue,0),this.Ob(p,this.Rg,1),this.Ob(m,this.Rg,1));k=1736==k?this.yP:0;this.Nx(p,h|k);this.Nx(m,h|k)}}}}};b.prototype.yV=function(a,b){var c=this.fn(b);if(-1!=c){var d=this.fn(a);this.Fh.R(c,1,d);this.wu(a,c);this.wu(b,-1)}a=this.Aa(a);b=this.Aa(b);c=this.fn(b);-1!=c&&(d=this.fn(a),this.Fh.R(c,1,d),this.wu(a,c),this.wu(b,-1))};b.prototype.gY=function(b){function c(a,
b){return e.gQ(a,b)}var d=new a.ha(0);d.zb(10);for(var e=this,f=this.nf;-1!=f;f=this.ng(f)){d.clear(!1);var g=this.gf(f);if(-1!=g){var h=g;do d.add(h),h=this.qc(this.Aa(h));while(h!=g);if(1<d.size){h=!0;if(2<d.size)d.Fd(0,d.size,c),d.add(d.get(0));else if(0<this.fQ(d.get(0),d.get(1))){var k=d.get(0);d.set(0,d.get(1));d.set(1,k)}else h=!1;for(var n=k=d.get(0),l=this.Uf(n),p=this.Aa(n),m=-1,q=1,r=d.size;q<r;q++){var t=d.get(q),u=this.Aa(t),w=this.Mk(u);if(w==l&&t!=n){if(0==b)m=this.OG(n)|this.OG(t),
this.Nx(n,m),this.Nx(p,m),this.Ob(n,this.ue,this.Kb(n,this.ue)|this.Kb(t,this.ue)),this.Ob(p,this.ue,this.Kb(p,this.ue)|this.Kb(u,this.ue));else if(-1!=this.wg)m=this.Kb(n,this.wg)+this.Kb(t,this.wg),u=this.Kb(p,this.wg)+this.Kb(u,this.wg),this.Ob(n,this.wg,m),this.Ob(p,this.wg,u);else{if(7==b){this.nj=new a.Yd(5,f,-1);return}-1!=this.Rg&&(m=this.Kb(n,this.Rg)+this.Kb(t,this.Rg),u=this.Kb(p,this.Rg)+this.Kb(u,this.Rg),this.Ob(n,this.Rg,m),this.Ob(p,this.Rg,u))}this.yV(n,t);this.rz(t);m=n;d.set(q,
-1);t==k&&(d.set(0,-1),k=-1)}else this.ey(m,!1),m=-1,n=t,l=w,p=u}this.ey(m,!1);m=-1;if(h){k=-1;q=0;for(r=d.size;q<r;q++)if(t=d.get(q),-1!=t)if(-1==k)n=k=t,l=this.Uf(n),p=this.Aa(n);else if(t!=n&&(u=this.Aa(t),w=this.Mk(u),this.Cm(p,t),this.Dm(t,p),n=t,l=w,p=u,7==b&&(this.Kb(t,this.ue)|this.Kb(this.Qe(t),this.ue))==(this.zp|1))){this.nj=new a.Yd(5,f,-1);return}this.jo(f,k)}else{k=-1;q=0;for(r=d.size;q<r;q++)if(t=d.get(q),-1!=t){k=t;break}g!=k&&this.jo(f,k)}}}}};b.prototype.vP=function(){for(var b=
-1,c=this.xh(),d=this.nf;-1!=d;d=this.ng(d)){var e=this.gf(d);if(-1!=e){var f=e;do{if(1!=this.Kb(f,c)){var g=this.jJ();this.uu(g,f);this.fK(g,b);-1!=b&&this.hK(b,g);var b=g,h=0,k=f;do h|=this.Kb(k,this.ue),this.zX(k,g),this.Ob(k,c,1),k=this.qc(k);while(k!=f);this.qh(g,h)}f=this.qc(this.Aa(f))}while(f!=e)}}g=this.jJ();this.uu(g,-1);this.fK(g,b);-1!=b&&this.hK(b,g);this.pm=g;this.To=a.Pd.yd(this.Ve.size,NaN);this.WA=a.Pd.yd(this.Ve.size,NaN);this.eK(this.pm,Infinity);this.gK(this.pm,Infinity);this.oi(c)};
b.prototype.JS=function(a,b,c){b=-1!=b?b:this.gf(a);if(-1==b)return-1;for(a=b;;){if(1!=this.Kb(b,c))return b;b=this.qc(this.Aa(b));if(b==a)return-1}};b.prototype.$W=function(){for(var a=this.xh(),b=this.nf;-1!=b;b=this.ng(b))for(var c=-1;;){var d=this.JS(b,c,a);if(-1==d)break;for(var c=this.qc(this.Aa(d)),e=d;;){var f=this.qc(e),g=this.Qe(e),h=this.Aa(e);if(g==h){this.bR(e);if(c==e||c==h)c=-1;if(e==d||g==d){d=f;if(e==d||g==d)break;e=f;continue}}else this.Ob(e,a,1);e=f;if(e==d)break}}};b.prototype.pC=
function(b,c,d,e){this.ph();this.fI=e;this.a=b;this.qr=this.a.gG();b=new a.ha(0);b.zb(null!=d?this.a.D(d.get(0)):this.a.ud);var f=0,g=1,h=null!=d?d.get(0):this.a.qd;for(e=1;-1!=h;){this.a.lK(h,this.qr,g);for(var g=g<<1,k=this.a.Pb(h);-1!=k;k=this.a.Sb(k))for(var n=this.a.cb(k),l=0,p=this.a.La(k);l<p;l++)b.add(n),n=this.a.U(n);a.T.Po(this.a.ic(h))||(f+=this.a.aa(h));null!=d?(h=e<d.size?d.get(e):-1,e++):h=this.a.Re(h)}this.zp=g;this.qa=b.size;this.a.Xx(b,this.qa);null==this.Fh&&(this.Fh=new a.Zc(2),
this.Ae=new a.Zc(8),this.Qc=new a.Zc(8),this.Ve=new a.Zc(8));this.Fh.Ne(this.qa);this.Ae.Ne(this.qa+10);this.Qc.Ne(2*this.qa+32);this.Ve.Ne(Math.max(32,f));this.wn=this.a.Sd();d=new a.b;e=0;f=new a.b;d.Yc();for(g=0;g<=this.qa;g++)if(g<this.qa?(n=b.get(g),this.a.w(n,f)):f.Yc(),!d.vb(f)){if(e<g){n=this.Sn();for(p=l=-1;e<g;e++)p=b.get(e),this.a.Va(p,this.wn,n),h=this.Fh.Me(),this.Fh.R(h,0,p),this.Fh.R(h,1,l),l=h,k=this.a.kd(p),h=this.a.mg(k),h=this.Ia(h),this.tX(n,this.Ld(n)|h);this.uX(n,l);this.Ur(n,
this.a.Za(p));-1!=this.Lt&&this.HX(this.Lt,n);this.KX(n,this.Lt);this.Lt=n;-1==this.nf&&(this.nf=n)}e=g;d.L(f)}this.ue=this.xh();5==c&&(this.wg=this.xh());4==c&&(this.Rg=this.xh());this.QQ(c,b);0==this.nj.Ji&&(this.gY(c),0==this.nj.Ji&&(isNaN(this.XA)||this.XP()?(this.vP(),0==this.nj.Ji&&(this.oi(this.ue),this.ue=-1,this.fI&&this.fW(c))):this.$A=!0))};b.prototype.rz=function(a){var b=this.qc(a),c=this.Qe(a),d=this.Aa(a),e=this.qc(d),f=this.Qe(d);b!=d&&(this.Cm(f,b),this.Dm(b,f));c!=d&&(this.Cm(c,
e),this.Dm(e,c));c=this.Mk(a);this.gf(c)==a&&(e!=a?this.jo(c,e):this.jo(c,-1));e=this.Mk(d);this.gf(e)==d&&(b!=d?this.jo(e,b):this.jo(e,-1));this.Qc.jd(a);this.Qc.jd(d)};b.prototype.QG=function(a,b){for(;;)if(b=a.Se(b),-1!=b){var c=a.ia(b);if(this.Af(c)!=this.Af(this.Aa(c)))return c}else return-1};b.prototype.Vr=function(a,b,c){void 0===c&&(c=!0);this.pC(a,0,null,c)};b.prototype.aK=function(b,c){var d=new a.ha(0);d.add(c);this.pC(b,4,d,1736==b.ic(c))};b.prototype.bK=function(b,c){var d=new a.ha(0);
d.add(c);this.pC(b,5,d,!0)};b.prototype.ph=function(){null!=this.a&&(-1!=this.qr&&(this.a.ZW(this.qr),this.qr=-1),-1!=this.wn&&(this.a.je(this.wn),this.wn=-1),-1!=this.rr&&(this.a.je(this.rr),this.rr=-1),-1!=this.ue&&(this.oi(this.ue),this.ue=-1),-1!=this.wg&&(this.oi(this.wg),this.wg=-1),-1!=this.Rg&&(this.oi(this.Rg),this.Rg=-1),this.a=null,this.Ae.Wi(!0),this.Fh.Wi(!0),this.Lt=this.nf=-1,null!=this.Qc&&this.Qc.Wi(!0),null!=this.gj&&(this.gj.length=0),null!=this.dj&&(this.dj.length=0),null!=this.gI&&
(this.gI.length=0),null!=this.Ve&&this.Ve.Wi(!0),this.pm=-1,this.To=null)};b.prototype.gf=function(a){return this.Ae.S(a,2)};b.prototype.w=function(a,b){this.a.gH(this.wS(a),b)};b.prototype.Ld=function(a){return this.Ae.S(a,1)};b.prototype.ng=function(a){return this.Ae.S(a,4)};b.prototype.Nz=function(a){return this.Ae.S(a,6)};b.prototype.dn=function(a){return this.Ae.S(a,7)};b.prototype.it=function(a){return this.Fh.S(a,1)};b.prototype.Yj=function(a){return this.Fh.S(a,0)};b.prototype.Gg=function(a,
b){b=this.dj[b];return b.size<=a?-1:b.read(a)};b.prototype.ko=function(a,b,c){b=this.dj[b];b.size<=a&&b.resize(this.Ae.size,-1);b.write(a,c)};b.prototype.wq=function(){null==this.dj&&(this.dj=[]);for(var b=a.ha.yd(this.Ae.xd,-1),c=0,d=this.dj.length;c<d;c++)if(null==this.dj[c])return this.dj[c]=b,c;this.dj.push(b);return this.dj.length-1};b.prototype.xq=function(a){this.dj[a]=null};b.prototype.Mk=function(a){return this.Qc.S(a,1)};b.prototype.Uf=function(a){return this.Mk(this.Aa(a))};b.prototype.Aa=
function(a){return this.Qc.S(a,4)};b.prototype.Qe=function(a){return this.Qc.S(a,5)};b.prototype.qc=function(a){return this.Qc.S(a,6)};b.prototype.Af=function(a){return this.Qc.S(a,2)};b.prototype.Bf=function(a){return this.Kk(this.Qc.S(a,2))};b.prototype.fn=function(a){return this.Qc.S(a,7)};b.prototype.Ws=function(a,b){this.w(this.Mk(a),b)};b.prototype.en=function(a,b){this.w(this.Uf(a),b)};b.prototype.Ah=function(a){return this.Qc.S(a,3)&this.zP};b.prototype.Kb=function(a,b){b=this.gj[b];return b.size<=
a?-1:b.read(a)};b.prototype.Ob=function(a,b,c){b=this.gj[b];b.size<=a&&b.resize(this.Qc.size,-1);b.write(a,c)};b.prototype.xh=function(){null==this.gj&&(this.gj=[]);for(var b=a.ha.yd(this.Qc.xd,-1),c=0,d=this.gj.length;c<d;c++)if(null==this.gj[c])return this.gj[c]=b,c;this.gj.push(b);return this.gj.length-1};b.prototype.oi=function(a){this.gj[a]=null};b.prototype.bR=function(a){var b=this.Af(a),c=this.qc(a);c==this.Aa(a)&&(c=this.qc(c),c==a&&(c=-1));this.EG(b)==a&&this.uu(b,c);c=this.To.read(b);isNaN(c)||
(this.eK(b,NaN),this.gK(b,NaN));this.ey(a,!0);this.rz(a)};b.prototype.cR=function(a){for(var b=0,c=a.size;b<c;b++){var d=a.get(b),e=this.Af(this.Aa(d));this.uu(this.Af(d),-1);this.uu(e,-1);this.ey(d,!0);this.rz(d)}};b.prototype.EG=function(a){return this.Ve.S(a,1)};b.prototype.Kk=function(a){return this.Ve.S(a,2)};b.prototype.Co=function(a){return this.Ve.S(a,3)};b.prototype.vS=function(a){return this.Ve.S(a,4)};b.prototype.Dq=function(a){var b=this.To.read(a);isNaN(b)&&(this.MY(a),b=this.To.read(a));
return b};b.prototype.Ia=function(a){return this.a.NG(a,this.qr)};b.prototype.ff=function(a){return this.a.Sa(a,this.wn)};b.prototype.MS=function(a){return this.a.Sa(a,this.rr)};b.prototype.LS=function(a,b){var c=this.gf(a);if(-1==c)return-1;var d=c,e=-1,f=-1;do{if(this.Uf(d)==b)return d;if(-1==e){e=this.gf(b);if(-1==e)break;f=e}if(this.Uf(f)==a)return d=this.Aa(f);d=this.qc(this.Aa(d));f=this.qc(this.Aa(f))}while(d!=c&&f!=e);return-1};b.prototype.TB=function(b,c){c.Hs();c=c.get();var d=new a.b;this.Ws(b,
d);c.Lc(d);this.en(b,d);c.Xc(d)};b.prototype.gQ=function(b,c){if(b==c)return 0;var d=new a.b;this.en(b,d);var e=new a.b;this.en(c,e);if(d.vb(e))return 0;c=new a.b;this.Ws(b,c);b=new a.b;b.xc(d,c);d=new a.b;d.xc(e,c);return a.b.ts(b,d)};b.prototype.fQ=function(b,c){if(b==c)return 0;var d=new a.b;this.en(b,d);var e=new a.b;this.en(c,e);if(d.vb(e))return 0;c=new a.b;this.Ws(b,c);b=new a.b;b.xc(d,c);d=new a.b;d.xc(e,c);return 0<=d.y&&0<b.y?a.b.ts(b,d):0};b.prototype.XP=function(){for(var b=a.Ub.Yx(this.XA),
c=new a.b,d=new a.b,e=new a.b,f=new a.b,g=new a.b,h=this.nf;-1!=h;h=this.ng(h)){var k=this.gf(h);if(-1!=k){var n=k;this.Ws(n,c);this.en(n,d);g.xc(d,c);var l=g.uk();do{var m=n,n=this.qc(this.Aa(n));if(n!=m){this.en(n,e);f.xc(e,c);var m=f.uk(),q=f.Vi(g);if(q*q/(m*l)*Math.min(m,l)<=b)return!1;g.L(f);l=m;d.L(e)}}while(n!=k)}}return!0};return b}();a.Vu=b})(C||(C={}));(function(a){var b=function(){function b(){this.i=null;this.nI=new a.b;this.oI=new a.b;this.Nh=null;this.rt=!1;this.bp=-1}b.prototype.Df=
function(a){return a<this.Nh.length?this.Nh[a]:!1};b.prototype.Ml=function(b,c,d,e){var f=a.T.hf(this.i.a.ic(d));if(2==a.T.hf(this.i.a.ic(c))&&1==f)this.WQ(b,c,d,e);else throw a.g.za();};b.prototype.Vr=function(b,c){null==this.i&&(this.i=new a.Vu);this.i.Vr(b,c)};b.prototype.Wr=function(b,c,d){a.vk.V(b,c,d,!0);for(c=b.qd;-1!=c;c=b.Re(c))1736==b.ic(c)&&a.so.V(b,c,-1,this.rt,d);this.Vr(b,d)};b.prototype.SF=function(a,b,c,d,e){var f=this.i.a;if(1736==f.ic(a))for(a=f.Pb(a);-1!=a;a=f.Sb(a)){var g=f.cb(a);
this.i.ff(g);this.i.ff(f.U(g));var h=this.i.MS(g);if(-1!=h){var k=this.i.Kb(h,c);if(1!=k&&2!=k)if(this.Df(this.i.Bf(h))){this.i.Ob(h,c,1);var k=f.Vf(b,-1),n=h,l=this.i.ff(g),p=1;do{var m=this.nn(g,e);f.Oj(k,m);-1!=d&&this.i.ko(l,d,1);this.i.Ob(n,c,1);var n=this.i.qc(n),q;do m=1==p?f.U(g):f.Ra(g),q=-1!=m?this.i.ff(m):-1;while(q==l);var r=this.i.Mk(n);if(r!=q){do m=1==p?f.Ra(g):f.U(g),q=-1!=m?this.i.ff(m):-1;while(q==l);r!=q?(q=r,m=this.i.Yj(this.i.dn(q))):p=-p}l=q;g=m}while(n!=h);f.ho(k,!0)}else this.i.Ob(h,
c,2)}}};b.prototype.lG=function(){for(var b=this.i.xh(),c=new a.ha(0),d=this.i.nf;-1!=d;d=this.i.ng(d)){var e=this.i.gf(d),f=e;if(-1!=e){do{if(1!=this.i.Kb(f,b)){var g=this.i.Aa(f);this.i.Ob(g,b,1);this.i.Ob(f,b,1);this.Df(this.i.Bf(f))&&this.Df(this.i.Bf(g))&&c.add(f)}f=this.i.qc(this.i.Aa(f))}while(f!=e)}}this.i.oi(b);this.i.cR(c)};b.prototype.nn=function(a,b){return-1==b?a:this.wT(a,b)};b.prototype.wT=function(a,b){var c=this.i.a,d,e,f=this.i.dn(this.i.ff(a));do{d=this.i.Yj(f);e=c.mg(c.kd(d));
if(e==b)return d;f=this.i.it(f)}while(-1!=f);return a};b.prototype.ds=function(b,c,d){this.lG();var e=this.i.a,f=e.ah(1736),g=this.i.xh();this.WK(b,c,f,d,g,-1);this.i.oi(g);a.so.V(e,f,1,this.rt,null);return f};b.prototype.WK=function(a,b,c,d,e,f){this.SF(a,c,e,f,d);-1!=b&&this.SF(b,c,e,f,d);a=this.i.a;for(b=this.i.nf;-1!=b;b=this.i.ng(b)){var g=this.i.gf(b);if(-1!=g){var h=g;do{var k=this.i.Kb(h,e);if(1!=k&&2!=k)if(this.Df(this.i.Bf(h))){var k=a.Vf(c,-1),n=h;do{var l=this.i.fn(n);-1!=l?l=this.i.Yj(l):
(l=this.i.Yj(this.i.fn(this.i.Aa(n))),l=this.i.a.U(l));l=this.nn(l,d);a.Oj(k,l);this.i.Ob(n,e,1);-1!=f&&(l=this.i.ff(l),this.i.ko(l,f,1));n=this.i.qc(n)}while(n!=h);a.ho(k,!0)}else this.i.Ob(h,e,2);h=this.i.qc(this.i.Aa(h))}while(h!=g)}}};b.prototype.yY=function(b,c,d){var e=this.i.a,f=e.ah(1736),g=e.ah(1607),h=e.ah(550);this.lG();var k=-1,n=this.i.xh(),l=this.i.wq();this.WK(b,c,f,d,n,l);for(b=this.i.nf;-1!=b;b=this.i.ng(b))if(c=this.i.gf(b),-1!=c){var p=c;do{var m=this.i.Kb(p,n),q=this.i.Kb(this.i.Aa(p),
n),m=m|q;if(2==m)if(m=this.i.Ah(p),this.Df(m)){var r=e.Vf(g,-1),t=p,m=this.Jx(b,e),m=this.nn(m,d);e.Oj(r,m);this.i.ko(b,l,1);do{m=this.i.Uf(t);q=this.Jx(m,e);q=this.nn(q,d);e.Oj(r,q);this.i.Ob(t,n,1);this.i.Ob(this.i.Aa(t),n,1);this.i.ko(m,l,1);t=this.i.qc(t);m=this.i.Kb(t,n);q=this.i.Kb(this.i.Aa(t),n);m|=q;if(2!=m)break;m=this.i.Ah(t);if(!this.Df(m)){this.i.Ob(t,n,1);this.i.Ob(this.i.Aa(t),n,1);break}}while(t!=p)}else this.i.Ob(p,n,1),this.i.Ob(this.i.Aa(p),n,1);p=this.i.qc(this.i.Aa(p))}while(p!=
c)}for(b=this.i.nf;-1!=b;b=this.i.ng(b))m=this.i.Gg(b,l),1!=m&&(m=this.i.Ld(b),this.Df(m)&&(-1==k&&(k=e.Vf(h,-1)),c=this.i.dn(b),-1!=c&&(c=this.i.Yj(c),m=this.nn(c,d),e.Oj(k,m))));this.i.xq(l);this.i.oi(n);a.so.V(e,f,1,this.rt,null);d=[];d[0]=h;d[1]=g;d[2]=f;return d};b.prototype.Jx=function(a,b){var c=-1;for(a=this.i.dn(a);-1!=a;a=this.i.it(a)){var d=this.i.Yj(a);-1==c&&(c=d);var e=this.i.Ia(b.mg(b.kd(d)));if(this.Df(e)){c=d;break}}return c};b.prototype.QB=function(b,c){for(var d=this.i.Mk(c),e=
this.i.Uf(c),f=0,g=0,h=this.i.dn(d);-1!=h;h=this.i.it(h)){var k=this.i.Yj(h),n=b.kd(k),l=this.i.Ia(b.mg(n)),m=b.U(k),q=b.Ra(k),n=b.cb(n);n==k&&(this.bp=c);-1!=m&&this.i.ff(m)==e?(f++,this.Df(l)&&(n==m&&(this.bp=this.i.qc(c)),g++)):-1!=q&&this.i.ff(q)==e&&(f--,this.Df(l)&&(n==q&&(this.bp=this.i.qc(c)),g--))}this.i.w(d,this.nI);this.i.w(e,this.oI);d=a.b.Cb(this.nI,this.oI);return(0!=g?g:f)*d};b.prototype.Fq=function(a){return this.i.Ah(a)|this.i.Bf(a)|this.i.Bf(this.i.Aa(a))};b.prototype.aL=function(a){for(var b=
this.i.Aa(this.i.Qe(a)),c=-1;b!=a;){if(this.Df(this.Fq(b))){if(-1!=c)return-1;c=b}b=this.i.Aa(this.i.Qe(b))}return-1!=c?this.i.Aa(c):-1};b.prototype.bL=function(a){for(var b=this.i.Aa(this.i.qc(a)),c=-1;b!=a;){if(this.Df(this.Fq(b))){if(-1!=c)return-1;c=b}b=this.i.Aa(this.i.qc(b))}return-1!=c?this.i.Aa(c):-1};b.prototype.RJ=function(b,c,d,e,f){var g=this.i.a,h=b,k=this.i.Aa(h);this.i.Ob(h,d,1);this.i.Ob(k,d,1);var n=this.QB(g,h);this.bp=-1;for(var l=h,m=-1,p=!1,q=1;;){var r=this.i.Qe(h);if(r==k)break;
k=this.i.qc(k);if(this.i.Aa(r)!=k)if(h=this.aL(h),-1==h)break;else p=!0,k=this.i.Aa(h);else h=r;if(h==b){m=b;break}r=this.Fq(h);if(!this.Df(r))break;this.i.Ob(h,d,1);this.i.Ob(k,d,1);l=h;n+=this.QB(g,h);q++}if(-1==m)for(h=b,k=this.i.Aa(h),m=h;;){b=this.i.qc(h);if(b==k)break;k=this.i.Qe(k);if(this.i.Aa(b)!=k)if(h=this.bL(h),-1==h){p=!0;break}else k=this.i.Aa(h);else h=b;r=this.Fq(h);if(!this.Df(r))break;this.i.Ob(h,d,1);this.i.Ob(k,d,1);m=h;n+=this.QB(g,h);q++}else if(-1!=this.bp&&(l=this.bp,m=this.i.Qe(this.bp),
this.i.Aa(m)!=this.i.qc(this.i.Aa(l))&&(m=this.aL(l),-1==m)))throw a.g.za();0<=n||(h=m,m=this.i.Aa(l),l=this.i.Aa(h));d=g.Vf(c,-1);h=l;l=this.i.Mk(l);p=this.i.Uf(m)==l&&p;n=this.Jx(l,g);n=this.nn(n,f);g.Oj(d,n);-1!=e&&this.i.ko(l,e,1);l=0;for(q=p?a.J.truncate((q+1)/2):-1;;){b=this.i.Uf(h);n=this.Jx(b,g);n=this.nn(n,f);g.Oj(d,n);l++;-1!=e&&this.i.ko(b,e,1);p&&l==q&&(d=g.Vf(c,-1),g.Oj(d,n));if(h==m)break;b=this.i.qc(h);if(this.i.Qe(this.i.Aa(h))!=this.i.Aa(b)){if(h=this.bL(h),-1==h)throw a.g.za();}else h=
b}};b.prototype.es=function(a){for(var b=this.i.a.ah(1607),c=this.i.xh(),d=this.i.nf;-1!=d;d=this.i.ng(d)){var e=this.i.gf(d),f=e;do 1!=this.i.Kb(f,c)&&this.Df(this.Fq(f))&&this.RJ(f,b,c,-1,a),f=this.i.qc(this.i.Aa(f));while(f!=e)}this.i.oi(c);return b};b.prototype.zY=function(a){for(var b=this.i.a,c=b.ah(1607),d=b.ah(550),e=this.i.xh(),f=this.i.wq(),g=-1,k=this.i.nf;-1!=k;k=this.i.ng(k)){var n=this.i.gf(k),l=n;do{var m=this.i.Kb(l,e);1!=m&&(m=this.Fq(l),this.Df(m)&&this.RJ(l,c,e,f,a));l=this.i.qc(this.i.Aa(l))}while(l!=
n)}for(k=this.i.nf;-1!=k;k=this.i.ng(k))m=this.i.Gg(k,f),1!=m&&(m=this.i.Ld(k),this.Df(m)&&(-1==g&&(g=b.Vf(d,-1)),n=this.i.dn(k),-1!=n&&(n=this.i.Yj(n),n=this.nn(n,a),b.Oj(g,n))));this.i.oi(e);this.i.xq(f);a=[];a[0]=d;a[1]=c;return a};b.prototype.Xp=function(){for(var a=this.i.a,b=a.ah(550),c=a.Vf(b,-1),d=this.i.nf;-1!=d;d=this.i.ng(d))if(this.Df(this.i.Ld(d))){for(var e=-1,f=this.i.dn(d);-1!=f;f=this.i.it(f)){var g=this.i.Yj(f);-1==e&&(e=g);var k=this.i.Ia(a.mg(a.kd(g)));if(this.Df(k)){e=g;break}}a.Oj(c,
e)}return b};b.prototype.Jo=function(a){this.Nh=[];for(var b=0;b<a;b++)this.Nh[b]=!1};b.fD=function(b,c,d,e){var f=b.Ka(),g=Array(1E3);a.J.Ov(g,null);var h=a.J.df(1E3,0),k=b.D(),n=!0,l=2==c.ub();if(1!=c.ub()&&2!=c.ub())throw a.g.za();for(var m=0;m<k;){var p=a.J.truncate(b.JW(g,m)-m);l?a.fd.UK(c,g,p,d,h):a.fd.VK(c,g,p,d,h);for(var q=0,r=0;r<p;r++){var t=0==h[r];e||(t=!t);t&&(n&&(n=!1,f.Hd(b,0,m)),q!=r&&f.Hd(b,m+q,m+r),q=r+1)}n||q==p||f.Hd(b,m+q,m+p);m+=p}return n?b:f};b.AH=function(c,d,e){return c instanceof
a.Dd?b.fD(c,d,e,!0):d instanceof a.Wa?c.u()||d.u()?c.Ka():a.vk.mJ(e,c,d)?a.vk.bQ(c,d):c.Ka():b.hD(c,d,e,!0)};b.nw=function(c,d,e,f){var g=new a.h;c.s(g);var h=new a.h;d.s(h);var k=new a.h;k.I(g);k.Nb(h);e=a.na.$d(e,k,!0);k=new a.h;k.I(h);h=a.na.As(e);k.P(h,h);if(!g.Yb(k)){if(c.ub()<=d.ub())return b.dc(b.N(c.Ka()),c,"\x26");if(c.ub()>d.ub())return b.dc(b.N(d.Ka()),c,"\x26")}h=new b;g=new a.ed;k=g.Jb(b.N(c));d=g.Jb(b.N(d));h.Wr(g,e,f);f=h.nw(k,d);c=b.dc(g.Pe(f),c,"\x26");a.T.Hc(c.G())&&(c.Xg(2,e),1736==
c.G()&&c.Fl());return c};b.hD=function(b,c,d,e){if(b.u())return b.Ka();if(c.u())return e?b.Ka():null;var f=[null],g=[0],h=2==c.ub();if(1!=c.ub()&&2!=c.ub())throw a.g.za();f[0]=b.w();h?a.fd.UK(c,f,1,d,g):a.fd.VK(c,f,1,d,g);c=0==g[0];e||(c=!c);return c?b.Ka():b};b.TZ=function(c,d,e){return c instanceof a.Dd?b.fD(c,d,e,!1):d instanceof a.Wa?c.u()?c.Ka():d.u()?c:a.vk.mJ(e,c,d)?c.Ka():c:b.hD(c,d,e,!1)};b.prototype.rJ=function(b,c,d,e,f){if(b.u())return b;var g=new a.ed;b=g.Jb(b);return this.ql(g,b,c,d,
e,f)};b.prototype.dW=function(b,c,d,e,f,g){if(f&&550!=b.ic(c)){var h=new a.bE;h.qY(b,d);h.hh?(a.vk.V(b,d,g,!0),f=!1):this.i.cz(d)}else a.vk.V(b,d,g,!0),f=!1;e&&550!=b.ic(c)?this.i.bK(b,c):this.i.aK(b,c);if(this.i.$A)return this.i.ph(),this.i=null,this.ql(b,c,d,e,!1,g);this.i.cz(NaN);g=this.i.Ia(c);this.Jo(g+1);this.Nh[g]=!0;if(1736==b.ic(c)||e&&550!=b.ic(c))return b.Op(c,0),c=this.ds(c,-1,-1),b=b.Pe(c),b.Op(0),f?b.Xg(1,0):(b.Xg(2,d),b.Fl()),b;if(1607==b.ic(c))return c=this.es(-1),b=b.Pe(c),f||b.Xg(2,
d),b;if(550==b.ic(c))return c=this.Xp(),b=b.Pe(c),f||b.Xg(2,d),b;throw a.g.za();};b.prototype.ql=function(b,c,d,e,f,g){this.i=new a.Vu;try{return this.dW(b,c,d,e,f,g)}finally{this.i.ph()}};b.ql=function(a,c,d,e,f){return(new b).rJ(a,c,d,e,f)};b.prototype.cW=function(b,c,d){this.rt=b;this.i=new a.Vu;b=c.Eo(d);var e=c.ic(d);1!=b||550==e?this.i.aK(c,d):this.i.bK(c,d);if(!this.i.$A)if(this.i.cz(NaN),e=this.i.Ia(d),this.Jo(e+1),this.Nh[e]=!0,1736==c.ic(d)||1==b&&550!=c.ic(d))c.Op(d,0),b=this.ds(d,-1,-1),
c.HC(b,d),c.dC(b);else if(1607==c.ic(d))b=this.es(-1),c.HC(b,d),c.dC(b);else if(550==c.ic(d))b=this.Xp(),c.HC(b,d),c.dC(b);else throw a.g.X("internal error");};b.GC=function(a,c,d,e){var f=new b;f.rt=!0;return f.rJ(a,c,!1,d,e)};b.prototype.an=function(b,c){var d=a.T.hf(this.i.a.ic(b)),e=a.T.hf(this.i.a.ic(c));if(d>e)return b;var f=this.i.Ia(b),g=this.i.Ia(c);this.Jo((f|g)+1);this.Nh[this.i.Ia(b)]=!0;if(2==d&&2==e)return this.ds(b,c,-1);if(1==d&&2==e||1==d&&1==e)return this.es(-1);if(0==d)return this.Xp();
throw a.g.za();};b.prototype.kG=function(b,c){var d=a.T.hf(this.i.a.ic(b)),e=a.T.hf(this.i.a.ic(c));if(d>e)return b;if(d<e)return c;var f=this.i.Ia(b),g=this.i.Ia(c);this.Jo((f|g)+1);this.Nh[this.i.Ia(b)]=!0;this.Nh[this.i.Ia(c)]=!0;this.Nh[this.i.Ia(b)|this.i.Ia(c)]=!0;if(2==d&&2==e)return this.ds(b,c,-1);if(1==d&&1==e)return this.es(-1);if(0==d&&0==e)return this.Xp();throw a.g.za();};b.prototype.nw=function(b,c){var d=a.T.hf(this.i.a.ic(b)),e=a.T.hf(this.i.a.ic(c)),f=this.i.Ia(b),g=this.i.Ia(c);
this.Jo((f|g)+1);this.Nh[this.i.Ia(b)|this.i.Ia(c)]=!0;f=-1;1<this.i.a.Gr.Ga&&(f=b);if(2==d&&2==e)return this.ds(b,c,f);if(1==d&&0<e||1==e&&0<d)return this.es(f);if(0==d||0==e)return this.Xp();throw a.g.za();};b.prototype.yA=function(b,c){var d=a.T.hf(this.i.a.ic(b)),e=a.T.hf(this.i.a.ic(c)),f=this.i.Ia(b),g=this.i.Ia(c);this.Jo((f|g)+1);this.Nh[this.i.Ia(b)|this.i.Ia(c)]=!0;f=-1;1<this.i.a.Gr.Ga&&(f=b);if(2==d&&2==e)return this.yY(b,c,f);if(1==d&&0<e||1==e&&0<d)return this.zY(f);if(0==d||0==e)return d=
[],d[0]=this.Xp(),d;throw a.g.za();};b.prototype.Wp=function(b,c){var d=a.T.hf(this.i.a.ic(b)),e=a.T.hf(this.i.a.ic(c)),f=this.i.Ia(b),g=this.i.Ia(c);this.Jo((f|g)+1);this.Nh[this.i.Ia(b)]=!0;this.Nh[this.i.Ia(c)]=!0;if(2==d&&2==e)return this.ds(b,c,-1);if(1==d&&1==e)return this.es(-1);if(0==d&&0==e)return this.Xp();throw a.g.za();};b.N=function(b){var c=b.G();return 197==c?(c=new a.Ja(b.description),b.u()||c.hd(b,!1),c):33==c?(c=new a.Dd(b.description),b.u()||c.add(b),c):322==c?(c=new a.Ua(b.description),
b.u()||c.cc(b,!0),c):b};b.dc=function(b,c,d){var e=b.G();return 197==e?(c=new a.Ja(b.description),b.u()||c.hd(b,!1),c):33!=e||"|"!=d&&"^"!=d?322==e?(c=new a.Ua(b.description),b.u()||c.cc(b,!0),c):33==e&&"-"==d&&33==c.G()||550==e&&"\x26"==d&&33==c.G()?(c=new a.Wa(b.description),b.u()||b.xe(0,c),c):b:(c=new a.Dd(b.description),b.u()||c.add(b),c)};b.an=function(c,d,e,f){if(c.u()||d.u()||c.ub()>d.ub())return b.dc(b.N(c),c,"-");var g=new a.h;c.s(g);var h=new a.h;d.s(h);if(!g.Yb(h))return b.dc(b.N(c),c,
"-");var k=new a.h;k.I(g);k.Nb(h);e=a.na.$d(e,k,!0);h=new b;g=new a.ed;k=g.Jb(b.N(c));d=g.Jb(b.N(d));h.Wr(g,e,f);f=h.an(k,d);f=g.Pe(f);c=b.dc(f,c,"-");a.T.Hc(c.G())&&(c.Xg(2,e),1736==c.G()&&c.Fl());return c};b.kG=function(c,d,e,f){if(c.ub()>d.ub())return b.dc(b.N(c),c,"|");if(c.ub()<d.ub()||c.u())return b.dc(b.N(d),c,"|");if(d.u())return b.dc(b.N(c),c,"|");var g=new a.h;c.s(g);var h=new a.h;d.s(h);var k=new a.h;k.I(g);k.Nb(h);e=a.na.$d(e,k,!0);if(!g.Yb(h.OS(e,e)))switch(c=b.N(c),d=b.N(d),c.G()){case 550:return c=
a.T.me(c),c.Hd(d,0,-1),c;case 1607:return c=a.T.me(c),c.add(d,!1),c;case 1736:return c=a.T.me(c),c.add(d,!1),c;default:throw a.g.za();}h=new b;g=new a.ed;k=g.Jb(b.N(c));d=g.Jb(b.N(d));h.Wr(g,e,f);d=h.kG(k,d);c=b.dc(g.Pe(d),c,"|");a.T.Hc(c.G())&&(c.Xg(2,e),1736==c.G()&&c.Fl());return c};b.nR=function(c,d,e){if(2>c.length)throw a.g.F("not enough geometries to dissolve");for(var f=0,g=0,h=c.length;g<h;g++)f=Math.max(c[g].ub(),f);var k=new a.h;k.Oa();for(var l=new a.ed,n=-1,m=0,p=-1,g=0,h=c.length;g<
h;g++)if(c[g].ub()==f)if(c[g].u())-1==p&&(p=g);else{p=g;-1==n?n=l.Jb(b.N(c[g])):l.TO(n,b.N(c[g]));var q=new a.h;c[g].ac(q);k.Nb(q);m++}if(2>m)return b.N(c[p]);c=2==f;d=a.na.$d(0==f?d:null,k,!0);return(new b).ql(l,n,d,c,!0,e)};b.yA=function(c,d,e,f){var g=[null,null,null],h=new a.h;c.s(h);var k=new a.h;d.s(k);var l=new a.h;l.I(h);l.Nb(k);e=a.na.$d(e,l,!0);l=new a.h;l.I(k);k=a.na.As(e);l.P(k,k);if(!h.Yb(l)){if(c.ub()<=d.ub())return c=b.dc(b.N(c.Ka()),c,"\x26"),g[c.ub()]=c,g;if(c.ub()>d.ub())return c=
b.dc(b.N(d.Ka()),c,"\x26"),g[c.ub()]=c,g}k=new b;h=new a.ed;l=h.Jb(b.N(c));d=h.Jb(b.N(d));k.Wr(h,e,f);f=k.yA(l,d);for(d=0;d<f.length;d++)k=b.dc(h.Pe(f[d]),c,"\x26"),a.T.Hc(k.G())&&(k.Xg(2,e),1736==k.G()&&k.Fl()),g[k.ub()]=k;return g};b.Wp=function(c,d,e,f){if(c.ub()>d.ub())return b.dc(b.N(c),c,"^");if(c.ub()<d.ub()||c.u())return b.dc(b.N(d),c,"^");if(d.u())return b.dc(b.N(c),c,"^");var g=new a.h;c.s(g);var h=new a.h;d.s(h);var k=new a.h;k.I(g);k.Nb(h);e=a.na.$d(e,k,!0);h=new b;g=new a.ed;k=g.Jb(b.N(c));
d=g.Jb(b.N(d));h.Wr(g,e,f);f=h.Wp(k,d);c=b.dc(g.Pe(f),c,"^");a.T.Hc(c.G())&&(c.Xg(2,e),1736==c.G()&&c.Fl());return c};b.wZ=function(b,c,d){c=c.G();d=d.G();return 550==b.G()&&(33==c||33==d)&&1>=b.D()?(d=new a.Wa(b.description),b.u()||b.xe(0,d),d):b};b.prototype.$R=function(a,b){var c=this.i.a;a=c.Vf(a,-1);for(var d=b.size,e=0;e<d;e++){var f=b.get(e);c.Oj(a,f)}c.ho(a,!0)};b.prototype.AX=function(a,b){for(var c=this.i.a,d=c.qd;-1!=d;d=c.Re(d))if(d==b)for(var e=c.Pb(d);-1!=e;e=c.Sb(e)){var f=c.cb(e);
if(-1!=f)for(var g=c.U(f);-1!=g;){var f=this.i.ff(f),h=this.i.ff(g),f=this.i.LS(f,h);-1!=f&&(h=this.i.Aa(f),this.i.Ob(f,a,1),this.i.Ob(h,a,2));f=g;g=c.U(f)}}};b.prototype.wW=function(b,c,d,e){d=this.i.Ia(d);e=this.i.Ia(e);var f=new a.ha(0);f.zb(256);for(var g=this.i.a,h=this.i.xh(),k=this.i.nf;-1!=k;k=this.i.ng(k)){var l=this.i.gf(k);if(-1!=l){var n=l;do{if(1!=this.i.Kb(n,h)){var m=n,p=n,q=!1,r=0;do{this.i.Ob(m,h,1);if(!q){var t=this.i.Ah(m);0!=(t&e)&&0!=(this.i.Bf(m)&d)&&(p=m,q=!0)}q&&(f.add(this.i.Yj(this.i.dn(this.i.Mk(m)))),
-1!=b&&(t=this.i.Ah(m),0!=(t&e)&&(t=this.i.Kb(m,b),r|=t)));m=this.i.qc(m)}while(m!=p);q&&0<this.i.Dq(this.i.Af(p))&&(m=g.ah(1736),this.$R(m,f),-1!=c&&g.lK(m,c,r));f.clear(!1)}n=this.i.qc(this.i.Aa(n))}while(n!=l)}}this.i.oi(h)};b.prototype.WQ=function(a,b,c,d){this.i.$W();var e=-1;-1!=a&&(e=this.i.xh(),this.AX(e,c));this.wW(e,a,b,c);var f=this.i.a;a=0;for(e=f.qd;-1!=e;e=f.Re(e))e!=b&&e!=c&&(d.add(e),a++);d.Fd(0,a,function(a,b){a=f.jA(f.Pb(a));b=f.jA(f.Pb(b));return a<b?-1:a==b?0:1})};b.prototype.ph=
function(){null!=this.i&&(this.i.ph(),this.i=null)};return b}();a.Cg=b})(C||(C={}));(function(a){var b=function(){function b(a){void 0!==a?this.Vp(a):this.sC()}b.prototype.Vx=function(){this.bc=this.Wb=this.Ab=this.sb=this.gb=this.lb=0};b.prototype.Eb=function(a){return this==a?!0:a instanceof b?this.lb==a.lb&&this.sb==a.sb&&this.Wb==a.Wb&&this.Ab==a.Ab&&this.gb==a.gb&&this.bc==a.bc:!1};b.prototype.kc=function(){a.J.$i();a.J.$i();a.J.$i();a.J.$i();a.J.$i();return a.J.$i()};b.prototype.ai=function(a,
b){var c=this.Ab*a.x+this.gb*a.y+this.bc;b.x=this.lb*a.x+this.sb*a.y+this.Wb;b.y=c};b.prototype.BY=function(a,b,c,d,e){var f=2*b;d*=2;for(b=2*(b+e);f<b;f+=2,d+=2){e=a[f];var g=a[f+1];c[d]=this.lb*e+this.sb*g+this.Wb;c[d+1]=this.Ab*e+this.gb*g+this.bc}};b.prototype.DY=function(b,c,d){for(var e=0;e<c;e++){var f=b[e].x,g=b[e].y,h=this.lb*f+this.sb*g+this.Wb,f=this.Ab*f+this.gb*g+this.bc;null!=d[e]?d[e].ja(h,f):d[e]=a.b.pa(h,f)}};b.prototype.multiply=function(a){b.multiply(this,a,this)};b.multiply=function(a,
b,c){var d,e,f,g,h;d=a.lb*b.lb+a.Ab*b.sb;e=a.sb*b.lb+a.gb*b.sb;f=a.Wb*b.lb+a.bc*b.sb+b.Wb;g=a.lb*b.Ab+a.Ab*b.gb;h=a.sb*b.Ab+a.gb*b.gb;a=a.Wb*b.Ab+a.bc*b.gb+b.bc;c.lb=d;c.sb=e;c.Wb=f;c.Ab=g;c.gb=h;c.bc=a};b.prototype.Sf=function(){var a=new b;a.lb=this.lb;a.sb=this.sb;a.Wb=this.Wb;a.Ab=this.Ab;a.gb=this.gb;a.bc=this.bc;return a};b.prototype.NC=function(b){if(!b.u()){for(var c=[],d=0;4>d;d++)c[d]=new a.b;b.SB(c);this.EY(c,c);b.Mx(c,4)}};b.prototype.EY=function(b,c){for(var d=0;d<b.length;d++){var e=
new a.b,f=b[d];e.x=this.lb*f.x+this.sb*f.y+this.Wb;e.y=this.Ab*f.x+this.gb*f.y+this.bc;c[d]=e}};b.prototype.NT=function(a,b){a.u()||b.u()||0==a.O()||0==a.ea()?this.Vx():(this.sb=this.Ab=0,this.lb=b.O()/a.O(),this.gb=b.ea()/a.ea(),this.Wb=b.o-a.o*this.lb,this.bc=b.A-a.A*this.gb)};b.prototype.CY=function(b){var c=new a.b,d=new a.b;c.ja(this.lb,this.Ab);d.ja(this.sb,this.gb);c.sub(c);var e=.5*c.uk();c.ja(this.lb,this.Ab);d.ja(this.sb,this.gb);c.add(d);c=.5*c.uk();return b*(e>c?Math.sqrt(e):Math.sqrt(c))};
b.prototype.sC=function(){this.lb=1;this.Ab=this.Wb=this.sb=0;this.gb=1;this.bc=0};b.prototype.No=function(b){if(void 0!==b){var c=a.b.pa(0,1);this.ai(c,c);c.sub(a.b.pa(0,1));if(c.uk()>b*b)return!1;c.ja(0,0);this.ai(c,c);if(c.uk()>b*b)return!1;c.ja(1,0);this.ai(c,c);c.sub(a.b.pa(1,0));return c.uk()<=b*b}return 1==this.lb&&1==this.gb&&0==this.sb&&0==this.Wb&&0==this.Ab&&0==this.bc};b.prototype.eh=function(a){return Math.abs(this.lb*this.gb-this.Ab*this.sb)<=2*a*(Math.abs(this.lb*this.gb)+Math.abs(this.Ab*
this.sb))};b.prototype.zg=function(a,b){this.lb=1;this.sb=0;this.Wb=a;this.Ab=0;this.gb=1;this.bc=b};b.prototype.Vp=function(a,b){void 0!==b?(this.lb=a,this.Ab=this.Wb=this.sb=0,this.gb=b,this.bc=0):this.Vp(a,a)};b.prototype.AC=function(){this.lb=0;this.sb=1;this.Wb=0;this.Ab=1;this.bc=this.gb=0};b.prototype.OX=function(a){this.PX(Math.cos(a),Math.sin(a))};b.prototype.PX=function(a,b){this.lb=a;this.sb=-b;this.Wb=0;this.Ab=b;this.gb=a;this.bc=0};b.prototype.shift=function(a,b){this.Wb+=a;this.bc+=
b};b.prototype.scale=function(a,b){this.lb*=a;this.sb*=a;this.Wb*=a;this.Ab*=b;this.gb*=b;this.bc*=b};b.prototype.rotate=function(a){var c=new b;c.OX(a);this.multiply(c)};b.prototype.inverse=function(a){if(void 0!==a){var b=this.lb*this.gb-this.sb*this.Ab;0==b?a.Vx():(b=1/b,a.Wb=(this.sb*this.bc-this.Wb*this.gb)*b,a.bc=(this.Wb*this.Ab-this.lb*this.bc)*b,a.lb=this.gb*b,a.sb=-this.sb*b,a.Ab=-this.Ab*b,a.gb=this.lb*b)}else this.inverse(this)};return b}();a.Gd=b})(C||(C={}));(function(a){var b=function(){function b(){}
b.prototype.Vx=function(){this.ci=this.bc=this.Wb=this.zf=this.wf=this.vf=this.yf=this.gb=this.sb=this.Pf=this.Ab=this.lb=0};b.prototype.Vp=function(a,b,c){this.lb=a;this.sb=this.Pf=this.Ab=0;this.gb=b;this.wf=this.vf=this.yf=0;this.zf=c;this.ci=this.bc=this.Wb=0};b.prototype.NC=function(b){if(b.u())return b;for(var c=new a.od[8],d=0;8>d;d++)c[d]=new a.od;b.SB(c);this.transform(c,8,c);b.Mx(c);return b};b.prototype.transform=function(b,c,d){for(var e=0;e<c;e++){var f=new a.od,g=b[e];f.x=this.lb*g.x+
this.sb*g.y+this.vf*g.z+this.Wb;f.y=this.Ab*g.x+this.gb*g.y+this.wf*g.z+this.bc;f.z=this.Pf*g.x+this.yf*g.y+this.zf*g.z+this.ci;d[e]=f}};b.prototype.Yp=function(b){var c=new a.od;c.x=this.lb*b.x+this.sb*b.y+this.vf*b.z+this.Wb;c.y=this.Ab*b.x+this.gb*b.y+this.wf*b.z+this.bc;c.z=this.Pf*b.x+this.yf*b.y+this.zf*b.z+this.ci;return c};b.prototype.Tg=function(a){b.multiply(this,a,this)};b.multiply=function(a,b,c){var d,e,f,g,h,k,l,m,n,p,q;d=a.lb*b.lb+a.Ab*b.sb+a.Pf*b.vf;e=a.lb*b.Ab+a.Ab*b.gb+a.Pf*b.wf;
f=a.lb*b.Pf+a.Ab*b.yf+a.Pf*b.zf;g=a.sb*b.lb+a.gb*b.sb+a.yf*b.vf;h=a.sb*b.Ab+a.gb*b.gb+a.yf*b.wf;k=a.sb*b.Pf+a.gb*b.yf+a.yf*b.zf;l=a.vf*b.lb+a.wf*b.sb+a.zf*b.vf;m=a.vf*b.Ab+a.wf*b.gb+a.zf*b.wf;n=a.vf*b.Pf+a.wf*b.yf+a.zf*b.zf;p=a.Wb*b.lb+a.bc*b.sb+a.ci*b.vf+b.Wb;q=a.Wb*b.Ab+a.bc*b.gb+a.ci*b.wf+b.bc;a=a.Wb*b.Pf+a.bc*b.yf+a.ci*b.zf+b.ci;c.lb=d;c.Ab=e;c.Pf=f;c.sb=g;c.gb=h;c.yf=k;c.vf=l;c.wf=m;c.zf=n;c.Wb=p;c.bc=q;c.ci=a};b.inverse=function(b,c){var d=b.lb*(b.gb*b.zf-b.yf*b.wf)-b.Ab*(b.sb*b.zf-b.yf*b.vf)+
b.Pf*(b.sb*b.wf-b.gb*b.vf);if(0!=d){var e,f,g,h,k,l,m,n,q,r;n=1/d;d=(b.gb*b.zf-b.yf*b.wf)*n;g=-(b.sb*b.zf-b.yf*b.vf)*n;l=(b.sb*b.wf-b.gb*b.vf)*n;e=-(b.Ab*b.zf-b.wf*b.Pf)*n;h=(b.lb*b.zf-b.Pf*b.vf)*n;m=-(b.lb*b.wf-b.Ab*b.vf)*n;f=(b.Ab*b.yf-b.Pf*b.gb)*n;k=-(b.lb*b.yf-b.Pf*b.sb)*n;n*=b.lb*b.gb-b.Ab*b.sb;q=-(b.Wb*d+b.bc*g+b.ci*l);r=-(b.Wb*e+b.bc*h+b.ci*m);b=-(b.Wb*f+b.bc*k+b.ci*n);c.lb=d;c.Ab=e;c.Pf=f;c.sb=g;c.gb=h;c.yf=k;c.vf=l;c.wf=m;c.zf=n;c.Wb=q;c.bc=r;c.ci=b}else throw a.g.X("math singularity");};
b.prototype.Sf=function(){var a=new b;a.lb=this.lb;a.Ab=this.Ab;a.Pf=this.Pf;a.sb=this.sb;a.gb=this.gb;a.yf=this.yf;a.vf=this.vf;a.wf=this.wf;a.zf=this.zf;a.Wb=this.Wb;a.bc=this.bc;a.ci=this.ci;return a};return b}();a.DN=b})(C||(C={}));(function(a){var b=function(b){function d(a){if(void 0!==a)a=b.call(this,a.kc(),a)||this;else{a=b.call(this)||this;a.vg=[];a.vg[0]=0;a.Ga=1;a.Th=[];for(var c=0;10>c;c++)a.Th[c]=-1;a.Th[a.vg[0]]=0}a.Zq=!0;return a}ca(d,b);d.prototype.Rd=function(a){this.hasAttribute(a)||
(this.Th[a]=0,this.GE())};d.prototype.removeAttribute=function(b){if(0==b)throw a.g.F("Position attribue cannot be removed");this.hasAttribute(b)&&(this.Th[b]=-1,this.GE())};d.prototype.reset=function(){this.vg[0]=0;this.Ga=1;for(var a=0;a<this.Th.length;a++)this.Th[a]=-1;this.Th[this.vg[0]]=0;this.Zq=!0};d.prototype.Rz=function(){return c.Go().add(this)};d.Hg=function(){return c.Go().uT()};d.N=function(){return c.Go().vT()};d.prototype.eO=function(){var b=this.kc();return new a.ma(b,this)};d.prototype.GE=
function(){for(var a=this.Ga=0,b=0;10>a;a++)0<=this.Th[a]&&(this.vg[b]=a,this.Th[a]=b,b++,this.Ga++);this.Zq=!0};d.prototype.kc=function(){this.Zq&&(this.gm=this.Ck(),this.Zq=!1);return this.gm};d.prototype.Eb=function(a){if(null==a)return!1;if(a==this)return!0;if(!(a instanceof d)||a.Ga!=this.Ga)return!1;for(var b=0;b<this.Ga;b++)if(this.vg[b]!=a.vg[b])return!1;return this.Zq!=a.Zq?!1:!0};d.prototype.GH=function(a){if(a.Ga!=this.Ga)return!1;for(var b=0;b<this.Ga;b++)if(this.vg[b]!=a.vg[b])return!1;
return!0};d.vx=function(a,b){for(var c=[],d=0;d<a.Ga;d++)c[d]=-1;for(var d=0,e=a.Ga;d<e;d++)c[d]=b.lg(a.pd(d));return c};d.VS=function(a,b){a=new d(a);a.Rd(b);return a.Rz()};d.WS=function(a,b){for(var c=null,e=0;10>e;e++)!a.hasAttribute(e)&&b.hasAttribute(e)&&(null==c&&(c=new d(a)),c.Rd(e));return null!=c?c.Rz():a};d.tb=function(a,b){a=new d(a);a.removeAttribute(b);return a.Rz()};return d}(a.ma);a.we=b;var c=function(){function a(){this.map=[];var a=new b;this.add(a);a=new b;a.Rd(1);this.add(a)}a.Go=
function(){return a.QN};a.prototype.uT=function(){return a.Lm};a.prototype.vT=function(){return a.Mm};a.prototype.add=function(b){var c=b.kc();if(null!=a.Lm&&a.Lm.kc()==c&&b.GH(a.Lm))return a.Lm;if(null!=a.Mm&&a.Mm.kc()==c&&b.GH(a.Mm))return a.Mm;var d=null;void 0!==this.map[c]&&(d=this.map[c]);null==d&&(d=b.eO(),1==d.Ga?a.Lm=d:2==d.Ga&&1==d.pd(1)?a.Mm=d:this.map[c]=d);return d};a.QN=new a;return a}()})(C||(C={}));var qa={feet:9002,kilometers:9036,meters:9001,miles:9035,"nautical-miles":9030,yards:9096},
ra={acres:109402,ares:109463,hectares:109401,"square-feet":109405,"square-kilometers":109414,"square-meters":109404,"square-miles":109413,"square-yards":109442},va=new (function(){function a(){this.mO=50;this.hq=new Map;this.Lj=[]}a.prototype.clear=function(){this.Lj.length=0;this.hq.clear()};a.prototype["delete"]=function(a){return this.hq["delete"](a)?(this.Lj.splice(this.Lj.indexOf(a),1),!0):!1};a.prototype.get=function(a){var b=this.hq.get(a);if(void 0!==b)return this.Lj[0]!==a&&(this.Lj.splice(this.Lj.indexOf(a),
1),this.Lj.unshift(a)),b};a.prototype.has=function(a){return this.hq.has(a)};a.prototype.set=function(a,b){void 0!==this.get(a)&&this["delete"](a);this.Lj.unshift(a);this.hq.set(a,b);this.aO();return this};a.prototype.aO=function(){for(;this.Lj.length&&this.Lj.length>this.mO;){var a=this.Lj.pop();this.hq["delete"](a)}};return a}()),Y=(ia={},ia.convertJSONToGeometry=function(a){return C.gc.EQ(a)},ia.hasM=function(a){return a.hasAttribute(C.hi.M)},ia.hasZ=function(a){return a.hasAttribute(C.hi.Z)},
ia.getPointX=function(a){return a.Te()},ia.getPointY=function(a){return a.Cf()},ia.getPointZ=function(a){return a.yT()},ia.getPointM=function(a){return a.SS()},ia.getXMin=function(a){return a.dt()},ia.getYMin=function(a){return a.ft()},ia.getXMax=function(a){return a.ct()},ia.getYMax=function(a){return a.et()},ia.getZExtent=function(a){return a.hg(C.hi.Z,0)},ia.getMExtent=function(a){return a.hg(C.hi.M,0)},ia.exportPaths=function(a){var b=[],c=a.aa(),d=null,e=null,f=a.hasAttribute(C.hi.Z),g=a.hasAttribute(C.hi.M);
f&&(d=a.Qa(C.hi.Z));g&&(e=a.Qa(C.hi.M));for(var k=new C.b,l=0;l<c;l++){for(var m=a.wa(l),q=a.La(l),r=0,t=0,u=NaN,v=NaN,w=NaN,x=NaN,z=a.Qb(l),B=[],A=m;A<m+q;A++){a.w(A,k);var x=w=NaN,F=[k.x,k.y];f&&(w=d.get(A),F.push(w));g&&(x=e.get(A),F.push(x));A==m&&z&&(r=k.x,t=k.y,u=w,v=x);B.push(F)}!z||r==k.x&&t==k.y&&(!f||isNaN(u)&&isNaN(w)||u==w)&&(!g||isNaN(v)&&isNaN(x)||v==x)||B.push(B[0].slice(0));b.push(B)}return b},ia.exportPathsFlat=function(){},ia.exportPoints=function(a){var b=a.hasAttribute(C.hi.Z),
c=a.hasAttribute(C.hi.M),d=null,e=null;b&&(d=a.Qa(C.hi.Z));c&&(e=a.Qa(C.hi.M));for(var f=new C.b,g=a.D(),k=[],l=0;l<g;l++){a.w(l,f);var m=[f.x,f.y];b&&m.push(d.get(l));c&&m.push(e.get(l));k.push(m)}return k},ia.exportPointsFlat=function(){},ia);return function(){function d(){}d.buffer=O;d.clip=k;d.contains=c;d.convexHull=B;d.crosses=a;d.cut=l;d.densify=Z;d.difference=G;d.disjoint=z;d.distance=b;d.equals=q;d.extendedSpatialReferenceInfo=g;d.generalize=V;d.geodesicArea=ga;d.geodesicBuffer=L;d.geodesicDensify=
ha;d.geodesicLength=oa;d.intersect=M;d.intersects=v;d.isSimple=H;d.nearestCoordinate=S;d.nearestVertex=aa;d.nearestVertices=ba;d.offset=T;d.overlaps=A;d.planarArea=X;d.planarLength=ea;d.relate=E;d.simplify=J;d.symmetricDifference=F;d.touches=t;d.union=R;d.within=x;d.rotate=C.my.rotate;d.flipHorizontal=C.my.YR;d.flipVertical=C.my.ZR;d._enableProjection=ja;d._project=fa;d._getTransformation=da;d._getTransformationBySuitability=ma;return d}()})},"esri/geometry/geometryAdapters/hydrated":function(){define("require exports ../Extent ../Multipoint ../Point ../Polygon ../Polyline".split(" "),
function(u,f,e,r,m,d,g){Object.defineProperty(f,"__esModule",{value:!0});f.hydratedAdapter={convertToGEGeometry:function(d,e){if(null==e)return null;var c="cache"in e?e.cache._geVersion:void 0;null==c&&(c=d.convertJSONToGeometry(e),"cache"in e&&(e.cache._geVersion=c));return c},exportPoint:function(d,e,c){var a=d.hasZ(e),b=d.hasM(e);c=new m({x:d.getPointX(e),y:d.getPointY(e),spatialReference:c});a&&(c.z=d.getPointZ(e));b&&(c.m=d.getPointM(e));c.cache._geVersion=e;return c},exportPolygon:function(e,
f,c){e=new d({rings:e.exportPaths(f),hasZ:e.hasZ(f),hasM:e.hasM(f),spatialReference:c});e.cache._geVersion=f;return e},exportPolyline:function(d,e,c){d=new g({paths:d.exportPaths(e),hasZ:d.hasZ(e),hasM:d.hasM(e),spatialReference:c});d.cache._geVersion=e;return d},exportMultipoint:function(d,e,c){d=new r({hasZ:d.hasZ(e),hasM:d.hasM(e),points:d.exportPoints(e),spatialReference:c});d.cache._geVersion=e;return d},exportExtent:function(d,f,c){var a=d.hasZ(f),b=d.hasM(f);c=new e({xmin:d.getXMin(f),ymin:d.getYMin(f),
xmax:d.getXMax(f),ymax:d.getYMax(f),spatialReference:c});a&&(a=d.getZExtent(f),c.zmin=a.vmin,c.zmax=a.vmax);b&&(d=d.getMExtent(f),c.mmin=d.vmin,c.mmax=d.vmax);c.cache._geVersion=f;return c}}})},"esri/views/draw/support/layerUtils":function(){define(["require","exports"],function(u,f){Object.defineProperty(f,"__esModule",{value:!0});f.addUniqueLayer=function(e,f){f&&e&&e.map&&(e=e.map,e.layers.find(function(e){return e===f})||e.add(f))}})},"esri/widgets/Sketch/support/OperationHandle":function(){define("require exports tslib ../../../core/compilerUtils ../../../core/Evented ../../../core/accessorSupport/decorators".split(" "),
function(u,f,e,r,m,d){Object.defineProperty(f,"__esModule",{value:!0});u=function(f){function g(){var d=null!==f&&f.apply(this,arguments)||this;d.cancelled=!1;d.history={undo:[],redo:[]};d.type=null;return d}e.__extends(g,f);Object.defineProperty(g.prototype,"tool",{get:function(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case "graphic-mover":case "move-3d":return"move";case "box":case "transform-3d":return"transform";case "reshape":case "reshape-3d":return"reshape";case "draw":break;
default:r.neverReached(this.activeComponent)}return null},enumerable:!0,configurable:!0});g.prototype.addToHistory=function(d){this.history.redo=[];this.history.undo.push(d)};g.prototype.resetHistory=function(){this.history.redo=[];this.history.undo=[]};g.prototype.canUndo=function(){return 0<this.history.undo.length};g.prototype.canRedo=function(){return 0<this.history.redo.length};g.prototype.complete=function(){this.reset();this.onEnd();this.emit("complete")};g.prototype.cancel=function(){this.cancelled=
!0;this.complete()};g.prototype.reset=function(){this.activeComponent.reset()};g.prototype.refreshComponent=function(){var d=this.activeComponent;d&&("box"!==d.type&&"reshape"!==d.type||d.refresh())};Object.defineProperty(g.prototype,"undo",{set:function(d){var c=this;this._set("undo",function(){c.canUndo()&&d()})},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"redo",{set:function(d){var c=this;this._set("redo",function(){c.canRedo()&&d()})},enumerable:!0,configurable:!0});e.__decorate([d.property()],
g.prototype,"activeComponent",void 0);e.__decorate([d.property()],g.prototype,"cancelled",void 0);e.__decorate([d.property()],g.prototype,"history",void 0);e.__decorate([d.property({dependsOn:["activeComponent"]})],g.prototype,"tool",null);e.__decorate([d.property()],g.prototype,"type",void 0);e.__decorate([d.property()],g.prototype,"canUndo",null);e.__decorate([d.property()],g.prototype,"canRedo",null);e.__decorate([d.property()],g.prototype,"onEnd",void 0);e.__decorate([d.property()],g.prototype,
"undo",null);e.__decorate([d.property()],g.prototype,"redo",null);e.__decorate([d.property()],g.prototype,"toggleTool",void 0);e.__decorate([d.property()],g.prototype,"setSnapToScene",void 0);e.__decorate([d.property()],g.prototype,"addToSelection",void 0);e.__decorate([d.property()],g.prototype,"removeFromSelection",void 0);return g=e.__decorate([d.subclass("esri.widgets.Sketch.support.OperationHandle")],g)}(m.EventedAccessor);f.OperationHandle=u})},"*noref":1}});
define("require exports tslib @dojo/framework/shim/Map ../intl ../core/events ../core/HandleOwner ../core/watchUtils ../core/accessorSupport/decorators ../layers/support/fieldUtils ./Attachments ./FeatureForm ./FeatureTemplates ./Spinner ./Widget ./Editor/EditorViewModel ./FeatureTemplates/ItemList ./support/widget".split(" "),function(u,f,e,r,m,d,g,k,l,c,a,b,q,v,t,x,z,A){function E(a){a.focus()}return function(f){function g(c,d){var e=f.call(this,c,d)||this;e._candidateCommitted=!1;e._featureForm=
new b;e._attachments=new a({visibleElements:{addSubmitButton:!1,cancelAddButton:!1,cancelUpdateButton:!1,deleteButton:!1,errorMessage:!1,progressBar:!1,updateButton:!1}});e._featureTemplates=new q;e._filterText="";e._prompt=null;e._spinner=new v;e.activeWorkflow=null;e.allowedWorkflows=null;e.iconClass="esri-icon-edit";e.label=void 0;e.layerInfos=null;e.messages=null;e.messagesCommon=null;e.messagesTemplates=null;e.supportingWidgetDefaults=null;e.view=null;e.viewModel=new x;e._handleHeaderClickOrKeyDown=
function(a){a.currentTarget["data-prevent-back"]||e._handleBack.call(e,a)};e._setCandidateFeature=function(a,b){void 0===b&&(b=!1);if(!e._candidateCommitted){var c=e.viewModel.activeWorkflow;c.data.edits.feature=a;b&&(c.next(),e._candidateCommitted=!0)}};e._handleSave=e._handleSave.bind(e);e._handleBack=e._handleBack.bind(e);e._handleDone=e._handleDone.bind(e);e._handleDelete=e._handleDelete.bind(e);e._handleAdd=e._handleAdd.bind(e);e._handleEdit=e._handleEdit.bind(e);e._handleAttachmentAdd=e._handleAttachmentAdd.bind(e);
e._handleAttachmentUpdate=e._handleAttachmentUpdate.bind(e);e._handleAttachmentDelete=e._handleAttachmentDelete.bind(e);return e}e.__extends(g,f);g.prototype.initialize=function(){var a=this,b=this.messages,c=this.messagesCommon;this.own([k.init(this,"viewModel",function(b){a._featureForm.viewModel=b?b.featureFormViewModel:null;a._attachments.viewModel=b?b.attachmentsViewModel:null;a._featureTemplates.viewModel=b?b.featureTemplatesViewModel:null;a._spinner.viewModel=b?b.spinnerViewModel:null}),k.init(this,
"view",function(b,c){var d="editor-"+a.id+"-spinner";c&&c.ui.remove(a._spinner,d);b&&b.ui.add(a._spinner,{key:d,position:"manual"})}),k.on(this,"viewModel.sketchViewModel","create",function(){a.scheduleRender()}),k.on(this,"viewModel.activeWorkflow","cancel-request",function(d){var e=d.controller;a._prompt={title:b.cancelRequestTitle,message:b.cancelRequestWarningMessage,options:[{label:c.form.no,type:"neutral",action:function(){e.deny();return a._prompt=null}},{label:c.form.yes,type:"negative",action:function(){e.allow();
a._prompt=null}}]};a.scheduleRender()}),k.init(this,"supportingWidgetDefaults",function(b){b&&(a._featureForm.set(b.featureForm),a._attachments.set(b.attachments),a._featureTemplates.set(b.featureTemplates),a.viewModel.sketchViewModel.set(b.sketch))}),k.watch(this,"_attachments.error",function(d){d&&(a._prompt={title:b.errorWarningTitle,message:d.message,options:[{label:c.form.ok,type:"neutral",action:function(){a._prompt=null}}]})}),k.watch(this,"viewModel.failures",function(c){if(c){c=c[0];var d=
c.retry,e=c.cancel;a._prompt={title:b.errorWarningTitle,message:m.substitute(b.errorWarningMessageTemplate,{errorMessage:c.error.message}),options:[{label:b.retry,type:"positive",action:function(){d();a._prompt=null}},{label:b.ignore,type:"neutral",action:function(){e();return a._prompt=null}}]}}}),k.watch(this,"viewModel.state",function(b){"awaiting-update-feature-candidate"===b&&(a._candidateCommitted=!1)}),k.watch(this,["_attachments.selectedFile","_attachments.submitting"],function(){return a.scheduleRender()}),
k.whenNot(this,"viewModel.activeWorkflow",function(){return a._featureTemplates.filterText=""})])};g.prototype.destroy=function(){this._attachments.destroy();this._featureForm.destroy();this._featureTemplates.destroy()};g.prototype.startCreateWorkflowAtFeatureTypeSelection=function(){return this.viewModel.startCreateWorkflowAtFeatureTypeSelection()};g.prototype.startCreateWorkflowAtFeatureCreation=function(a){return this.viewModel.startCreateWorkflowAtFeatureCreation(a)};g.prototype.startCreateWorkflowAtFeatureEdit=
function(a){return this.viewModel.startCreateWorkflowAtFeatureEdit(a)};g.prototype.startUpdateWorkflowAtFeatureSelection=function(){return this.viewModel.startUpdateWorkflowAtFeatureSelection()};g.prototype.startUpdateWorkflowAtMultipleFeatureSelection=function(a){return this.viewModel.startUpdateWorkflowAtMultipleFeatureSelection(a)};g.prototype.startUpdateWorkflowAtFeatureEdit=function(a){return this.viewModel.startUpdateWorkflowAtFeatureEdit(a)};g.prototype.deleteFeatureFromWorkflow=function(){return this.viewModel.deleteFeatureFromWorkflow()};
g.prototype.cancelWorkflow=function(a){return this.viewModel.cancelWorkflow(a)};g.prototype.render=function(){var a=this._attachments,b=this.viewModel;if(!b)return A.tsx("div",{class:"esri-editor esri-widget esri-widget--panel"});var c=b.state,d=this._prompt?A.tsx("div",{class:"esri-editor__overlay",key:"overlay"},this.renderPrompt({message:this._prompt.message,title:this._prompt.title,options:this._prompt.options})):null;return A.tsx("div",{class:"esri-editor esri-widget esri-widget--panel"},b.syncing||
a.submitting?this.renderProgressBar():null,"disabled"===c?null:"ready"===c?this.renderLanding():"awaiting-feature-creation-info"===c?this.renderTemplates():"editing-new-feature"===c||"editing-existing-feature"===c?this.renderAttributeEditing():"awaiting-feature-to-update"===c?this.renderFeatureUpdating():"awaiting-update-feature-candidate"===c?this.renderFeatureList():"awaiting-feature-to-create"===c?this.renderFeatureCreation():"adding-attachment"===c?this.renderAttachmentAdding():"editing-attachment"===
c?this.renderAttachmentEditing():null,d)};g.prototype.renderTemplates=function(){return A.tsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(this.messages.selectTemplate,!0),A.tsx("div",{key:"content",class:"esri-editor__content"},this._featureTemplates.render()))};g.prototype.renderAttributeEditing=function(){var a=this.viewModel,b=a.activeWorkflow,a=a.featureFormViewModel,c=b.data.edits.feature,d=this.messages,e=this.messagesCommon,f="create"===b.type?e.add:e.update,g=
[{label:f,type:"primary",disabled:"update"===b.type&&!b.data.edits.modified||0<a.inputFields.length&&!a.valid,clickHandler:this._handleSave}],k=!1;"update"===b.type&&(b.data.editableItem.hasAttachments&&(k=!0),-1<b.data.editableItem.supports.indexOf("delete")&&g.push({label:e.delete,type:"tertiary",clickHandler:this._handleDelete}));b=this._getLabel(c);return A.tsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(b,!0),A.tsx("div",{key:"content",class:this.classes("esri-editor__content",
"esri-editor__scroller")},A.tsx("div",{class:"esri-editor__content-group"},0<a.inputFields.length?this._featureForm.render():this.renderMessage(m.substitute(d.clickToFinishTemplate,{button:f})),k?A.tsx("div",{key:"attachments"},A.tsx("div",null,d.attachments),this._attachments.render()):null)),this.renderControls(g))};g.prototype.renderAttachmentAdding=function(){var a=this._attachments,b=this.messagesCommon,b=[{label:a.submitting?b.cancel:b.add,disabled:a.submitting||!a.selectedFile,type:"primary",
clickHandler:this._handleAttachmentAdd}];return A.tsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(this.messages.addAttachment,!0,a.submitting),A.tsx("div",{key:"content",class:this.classes("esri-editor__content","esri-editor__scroller")},a.render()),this.renderControls(b))};g.prototype.renderAttachmentEditing=function(){var a=this._attachments,b=this.messagesCommon,b=[{label:b.update,disabled:a.submitting||!a.selectedFile,type:"primary",clickHandler:this._handleAttachmentUpdate},
{label:b.delete,disabled:a.submitting,type:"tertiary",clickHandler:this._handleAttachmentDelete}];return A.tsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(this.messages.editAttachment,!0,a.submitting),A.tsx("div",{key:"content",class:this.classes("esri-editor__content","esri-editor__scroller")},a.render()),this.renderControls(b))};g.prototype.renderFeatureUpdating=function(){var a=this.messages;return A.tsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(a.selectFeature,
!0),A.tsx("div",{key:"content",class:this.classes("esri-editor__content","esri-editor__scroller")},this.renderMessage(a.selectFeatureToEdit)))};g.prototype.renderMessage=function(a){return A.tsx("div",{class:"esri-editor__message"},a)};g.prototype.renderFeatureCreation=function(){var a=this.messages,b=this.viewModel,c=b.sketchViewModel,b=b.activeWorkflow.data.creationInfo.layer,c=c.canUndo()&&c.createGraphic?c.createGraphic:null,c=this._getSketchingTip(b.geometryType,c);return A.tsx("div",{class:"esri-editor__temp-wrapper",
key:"wrapper"},this.renderHeader(a.placeFeature,!0),A.tsx("div",{key:"content",class:this.classes("esri-editor__content","esri-editor__scroller")},this.renderMessage(c)))};g.prototype.renderControls=function(a){var b=this;return A.tsx("div",{class:"esri-editor__controls",key:"controls"},a.map(function(a,c){var d=a.disabled,d=void 0===d?!1:d,e=a.type,f=a.clickHandler;return b.renderButton({label:a.label,class:b.classes("esri-editor__control-button","esri-button","secondary"===e?"esri-button--secondary":
"tertiary"===e?"esri-button--tertiary":null,d?"esri-button--disabled":null),disabled:d,clickHandler:f,key:c})}))};g.prototype.renderPrompt=function(a){var b=this,c=a.title,e=a.message;a=a.options;a=void 0===a?[]:a;return A.tsx("div",{class:"esri-editor__warning-card",role:"alert"},A.tsx("div",{class:"esri-editor__warning-header"},A.tsx("span",{class:"esri-icon-notice-triangle","aria-hidden":"true"}),A.tsx("h4",{class:this.classes("esri-heading","esri-editor__warning-heading")},c)),A.tsx("div",{class:"esri-editor__warning-message"},
e),A.tsx("div",{class:"esri-editor__warning-divider"}),a.map(function(a,c){var e=a.label,f=a.action;a=a.type;var g=0===c;return A.tsx("div",{afterCreate:g?E:null,class:b.classes("esri-editor__warning-option",g?"esri-editor__warning-option--primary":null,"positive"===a?"esri-editor__warning-option--positive":"negative"===a?"esri-editor__warning-option--negative":null),key:c,onclick:f,onkeydown:function(a){var b=d.eventKey(a);if("Enter"===b||" "===b)a.preventDefault(),f.call(null)},tabIndex:0,role:"button"},
e)}))};g.prototype.renderProgressBar=function(){return A.tsx("div",{class:this.classes("esri-editor__progress-bar"),key:"progress-bar"})};g.prototype.renderButton=function(a){return A.tsx("button",{class:a.class,disabled:a.disabled,key:a.key,onclick:a.clickHandler},a.label)};g.prototype.renderHeader=function(a,b,c){void 0===b&&(b=!1);void 0===c&&(c=!1);var d=this.messagesCommon;return A.tsx("header",{class:"esri-editor__header",key:"header"},b?A.tsx("div",{"aria-label":d.back,class:this.classes("esri-editor__back-button",
"esri-interactive",c?"esri-button--disabled":null),key:"back-button","data-prevent-back":c,onclick:this._handleHeaderClickOrKeyDown,onkeydown:this._handleHeaderClickOrKeyDown,role:"button",tabIndex:0,title:d.back},A.tsx("span",{"aria-hidden":"true",class:A.isRTL()?"esri-icon-right":"esri-icon-left"})):null,A.tsx("h4",{class:this.classes("esri-editor__title","esri-heading")},a))};g.prototype.renderLanding=function(){var a=this.messages,b=this.viewModel,c=b.allowedWorkflows,d=b.canCreate,b=b.canUpdate,
e=A.isRTL()?"esri-icon-left":"esri-icon-right";return A.tsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(a.widgetLabel),A.tsx("div",{key:"content",class:"esri-editor__content",role:"group"},A.tsx("div",{class:"esri-editor__mode-selection",key:"mode-selection"},-1<c.indexOf("update")?A.tsx("div",{"aria-disabled":b?"false":"true",class:this.classes("esri-editor__feature-list-item",b?null:"esri-editor__feature-list-item--disabled"),key:"update",onclick:this._handleEdit,onkeydown:this._handleEdit,
role:"button",tabIndex:b?0:-1},A.tsx("span",{class:"esri-editor__feature-list-name"},a.editFeature),A.tsx("span",{"aria-hidden":"true",class:this.classes("esri-editor__feature-list-icon",e)})):null,-1<c.indexOf("create")?A.tsx("div",{class:this.classes("esri-editor__feature-list-item",d?null:"esri-editor__feature-list-item--disabled"),key:"create",onclick:this._handleAdd,onkeydown:this._handleAdd,role:"button",tabIndex:d?0:-1},A.tsx("span",{class:"esri-editor__feature-list-name"},a.addFeature),A.tsx("span",
{"aria-hidden":"true",class:this.classes("esri-editor__feature-list-icon",e)})):null)))};g.prototype.renderFeatureList=function(){var a=this,b=this.messagesTemplates,c=this.viewModel,d=c.editableItems,e=c.activeWorkflow.data.candidates,c=m.substitute(this.messages.multipleFeaturesTemplate,{total:e.length}),f=new r.default;e.map(function(b){return{label:a._getLabel(b),id:b.attributes[b.layer.objectIdField],data:b}}).filter(function(b){var c=b.label,d=b.data;b=a._filterText.toLowerCase();var e=d.layer.title;
return-1<a.viewModel.editableItems.find(function(a){return a.layer===d.layer}).supports.indexOf("update")&&(!b||-1<c.toLowerCase().indexOf(b)||-1<e.toLowerCase().indexOf(b))}).forEach(function(a){var b=a.data.layer;f.has(b)?f.get(b).items.push(a):f.set(b,{id:b.id,label:b.title,items:[a]})});d=d.filter(function(a){return f.has(a.layer)}).map(function(a){return f.get(a.layer)}).toArray();return A.tsx("div",{class:"esri-editor__temp-wrapper",key:"wrapper"},this.renderHeader(c,!0),A.tsx("div",{key:"content",
class:this.classes("esri-editor__content","esri-editor__scroller")},z.ItemList({id:this.id,filterText:this._filterText,items:d,messages:{filterPlaceholder:b.filterPlaceholder,noItems:b.noItems,noMatches:b.noMatches},onItemMouseEnter:function(b){return a._setCandidateFeature(b.data)},onItemMouseLeave:function(){return a._setCandidateFeature(null)},onItemSelect:function(b){return a._setCandidateFeature(b.data,!0)},onFilterChange:function(b){return a._filterText=b}})))};g.prototype._getSketchingTip=
function(a,b){var c=this.messages;if("point"===a)return c.tips.clickToAddPoint;if("polygon"===a||"polyline"===a){if(!b)return c.tips.clickToStart;b=b.geometry["polygon"===a?"rings":"paths"][0];return"polygon"===a&&4>b?c.tips.clickToContinue:c.tips.clickToContinueThenDoubleClickToEnd}return c.tips.clickToAddFeature};g.prototype._getLabel=function(a){var b=a.layer,d=b.objectIdField;a=a.attributes;return(b=c.getDisplayFieldName(b))&&""+a[b]||m.substitute(this.messages.untitledFeatureTemplate,{id:a[d]})};
g.prototype._handleDelete=function(){var a=this,b=this.messages;this._prompt={title:b.deleteWarningTitle,message:b.deleteWarningMessage,options:[{label:b.keepFeature,type:"neutral",action:function(){return a._prompt=null}},{label:this.messagesCommon.delete,type:"positive",action:function(){a.viewModel.deleteFeatureFromWorkflow();a._prompt=null}}]}};g.prototype._handleSave=function(){this.viewModel.activeWorkflow.commit()};g.prototype._handleAttachmentAdd=function(){var a=this.viewModel.activeWorkflow;
this._attachments.addAttachment().then(function(){return a.previous()})};g.prototype._handleAttachmentUpdate=function(){var a=this.viewModel.activeWorkflow;this._attachments.updateAttachment().then(function(){return a.previous()})};g.prototype._handleAttachmentDelete=function(){var a=this,b=this.messages;this._prompt={title:b.deleteAttachmentWarningTitle,message:b.deleteAttachmentWarningMessage,options:[{label:b.keepAttachment,type:"neutral",action:function(){return a._prompt=null}},{label:this.messagesCommon.delete,
type:"positive",action:function(){var b=a._attachments,c=a.viewModel.activeWorkflow;b.deleteAttachment(b.viewModel.activeAttachmentInfo).then(function(){c.previous();a._prompt=null})}}]}};g.prototype._handleAdd=function(){this.viewModel.canCreate&&this.viewModel.startCreateWorkflowAtFeatureTypeSelection()};g.prototype._handleEdit=function(){this.viewModel.canUpdate&&this.viewModel.startUpdateWorkflowAtFeatureSelection()};g.prototype._handleDone=function(){this.viewModel.cancelWorkflow({force:!0})};
g.prototype._handleBack=function(){var a=this,b=this.messages,c=this.viewModel.activeWorkflow,d=c.stepId,e=c.data,f=c.type,g=function(){c.hasPreviousStep?c.previous():a.viewModel.cancelWorkflow({force:!0})};"editing-new-feature"===d||"editing-existing-feature"===d&&e.edits.modified?this._prompt={title:"create"===f?b.cancelAddTitle:b.cancelEditTitle,message:"create"===f?b.cancelAddWarningMessage:b.cancelEditWarningMessage,options:[{label:"create"===f?b.continueAdding:b.continueEditing,type:"neutral",
action:function(){return a._prompt=null}},{label:"create"===f?b.discardFeature:b.discardEdits,type:"negative",action:function(){g();a._prompt=null}}]}:g()};e.__decorate([l.property()],g.prototype,"_attachments",void 0);e.__decorate([l.aliasOf("viewModel.activeWorkflow")],g.prototype,"activeWorkflow",void 0);e.__decorate([l.aliasOf("viewModel.allowedWorkflows")],g.prototype,"allowedWorkflows",void 0);e.__decorate([l.property()],g.prototype,"iconClass",void 0);e.__decorate([l.property({aliasOf:{source:"messages.widgetLabel",
overridable:!0}})],g.prototype,"label",void 0);e.__decorate([l.aliasOf("viewModel.layerInfos")],g.prototype,"layerInfos",void 0);e.__decorate([l.property(),A.renderable(),A.messageBundle("esri/widgets/Editor/t9n/Editor")],g.prototype,"messages",void 0);e.__decorate([l.property(),A.renderable(),A.messageBundle("esri/t9n/common")],g.prototype,"messagesCommon",void 0);e.__decorate([l.property(),A.renderable(),A.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],g.prototype,"messagesTemplates",
void 0);e.__decorate([l.property()],g.prototype,"supportingWidgetDefaults",void 0);e.__decorate([l.aliasOf("viewModel.view")],g.prototype,"view",void 0);e.__decorate([l.property(),A.renderable("viewModel.canCreate viewModel.canUpdate viewModel.failures viewModel.state viewModel.syncing viewModel.activeWorkflow.data.edits.modified".split(" ")),A.vmEvent(["workflow-cancel","workflow-commit"])],g.prototype,"viewModel",void 0);e.__decorate([A.accessibleHandler()],g.prototype,"_handleDelete",null);e.__decorate([A.accessibleHandler()],
g.prototype,"_handleAttachmentAdd",null);e.__decorate([A.accessibleHandler()],g.prototype,"_handleAttachmentUpdate",null);e.__decorate([A.accessibleHandler()],g.prototype,"_handleAttachmentDelete",null);e.__decorate([A.accessibleHandler()],g.prototype,"_handleAdd",null);e.__decorate([A.accessibleHandler()],g.prototype,"_handleEdit",null);e.__decorate([A.accessibleHandler()],g.prototype,"_handleDone",null);e.__decorate([A.accessibleHandler()],g.prototype,"_handleBack",null);return g=e.__decorate([l.subclass("esri.widgets.Editor")],
g)}(g.HandleOwnerMixin(t))});