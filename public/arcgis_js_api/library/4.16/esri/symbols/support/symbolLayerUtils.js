// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../request ../../core/Error ../../core/ItemCache ../../core/maybe ../../core/promiseUtils ../../geometry/support/aaBoundingBox ../../views/3d/layers/graphics/Graphics3DIconSymbolLayer ../../views/3d/layers/graphics/graphicUtils ../../views/3d/layers/graphics/objectResourceUtils ../../views/3d/layers/graphics/primitiveObjectSymbolUtils".split(" "),function(A,c,e,q,f,m,n,g,p,r,t,u,v){function h(a,b){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,
function(B){if(a.resource.href)return[2,w(a.resource.href).then(function(a){return[a.width,a.height]})];if(a.resource.primitive)return n.isSome(b)?[2,[b,b]]:[2,r.default.PRIMITIVE_SIZE];throw new f("symbol3d:invalid-symbol-layer","symbol layers of type Icon must have either an href or a primitive resource");})})}function x(a,b){return h(a,b).then(function(b){if(null==a.size)return b;b=b[0]/b[1];return 1<b?[a.size,a.size/b]:[a.size*b,a.size]})}function w(a){return q(a,{responseType:"image"}).then(function(a){return a.data})}
function k(a,b){return y(a,b).then(function(a){return p.size(a)})}function z(a,b){return k(a,b).then(function(b){return t.computeSizeWithResourceSize(b,a)})}function y(a,b){if(!a.isPrimitive){var c=a.resource.href;b=l.get(c);return void 0!==b?g.resolve(b):u.fetch(c,{disableTextures:!0}).then(function(a){l.put(c,a.referenceBoundingBox);return a.referenceBoundingBox})}var d=null;if(a.resource&&a.resource.primitive&&(d=p.create(v.primitiveBoundingBox(a.resource.primitive)),n.isSome(b)))for(a=0;a<d.length;a++)d[a]*=
b;return d?g.resolve(d):g.reject(new f("symbol:invalid-resource","The symbol does not have a valid resource"))}Object.defineProperty(c,"__esModule",{value:!0});var l=new m(50);c.clearBoundingBoxCache=function(){l=new m(50)};c.computeLayerResourceSize=function(a,b){if("icon"===a.type)return h(a,b);if("object"===a.type)return k(a,b);throw new f("symbol3d:unsupported-symbol-layer","computeLayerSize only works with symbol layers of type Icon and Object");};c.computeLayerSize=function(a,b){return e.__awaiter(this,
void 0,void 0,function(){return e.__generator(this,function(c){if("icon"===a.type)return[2,x(a,b)];if("object"===a.type)return[2,z(a,b)];throw new f("symbol3d:unsupported-symbol-layer","computeLayerSize only works with symbol layers of type Icon and Object");})})};c.computeIconLayerResourceSize=h;c.computeObjectLayerResourceSize=k});