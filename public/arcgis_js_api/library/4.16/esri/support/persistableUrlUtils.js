// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define(["require","exports","../core/maybe","../core/urlUtils"],function(p,e,h,d){function k(b,a){var c=a&&a.url&&a.url.path;b&&c&&(b=d.makeAbsolute(b,c,{preserveProtocolRelative:!0}),a.portalItem&&a.readResourcePaths&&(c=d.makeRelative(b,a.portalItem.itemUrl),m.test(c)&&a.readResourcePaths.push(a.portalItem.resourceFromPath(c).path)));return g(b,a&&a.portal)}function l(b,a){if(!b)return b;!d.isAbsolute(b)&&a&&a.blockedRelativeUrls&&a.blockedRelativeUrls.push(b);var c=d.makeAbsolute(b);if(a){var f=
a.verifyItemRelativeUrls&&a.verifyItemRelativeUrls.rootPath||a.url&&a.url.path;f&&(f=g(f,a.portal),c=d.makeRelative(g(c,a.portal),f,f),c!==b&&a.verifyItemRelativeUrls&&a.verifyItemRelativeUrls.writtenUrls.push(c))}b=c;c=(a=a&&a.portal)&&!a.isPortal&&a.urlKey&&a.customBaseUrl?d.changeDomain(b,a.urlKey+"."+a.customBaseUrl,a.portalHostname):b;d.isAbsolute(c)&&(c=d.normalize(c));return c}function g(b,a){if(!a||a.isPortal||!a.urlKey||!a.customBaseUrl)return b;var c=a.urlKey+"."+a.customBaseUrl;return d.hasSameOrigin(d.appUrl,
d.appUrl.scheme+"://"+c)?d.changeDomain(b,a.portalHostname,c):d.changeDomain(b,c,a.portalHostname)}Object.defineProperty(e,"__esModule",{value:!0});e.fromJSON=k;e.toJSON=l;e.read=function(b,a,c){return k(b,c)};e.write=function(b,a,c,d){b=l(b,d);void 0!==b&&(a[c]=b)};var n=/\/items\/([^\/]+)\/resources\//,m=/^\.\/resources\//;e.itemIdFromResourceUrl=function(b){b=h.isSome(b)?b.match(n):null;return h.isSome(b)?b[1]:null}});